const dcg = {};
var dcgSharedModule;

(() => {
  const __dcg_shared_module_source__ = "// shared.js\n  (() => {\n    const __dcg_chunk_exports__ = {};var tS=Object.create;var wc=Object.defineProperty,rS=Object.defineProperties,nS=Object.getOwnPropertyDescriptor,iS=Object.getOwnPropertyDescriptors,sS=Object.getOwnPropertyNames,Lc=Object.getOwnPropertySymbols,oS=Object.getPrototypeOf,Em=Object.prototype.hasOwnProperty,UT=Object.prototype.propertyIsEnumerable;var qT=(e,t,r)=>t in e?wc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$=(e,t)=>{for(var r in t||(t={}))Em.call(t,r)&&qT(e,r,t[r]);if(Lc)for(var r of Lc(t))UT.call(t,r)&&qT(e,r,t[r]);return e},se=(e,t)=>rS(e,iS(t));var dV=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var HT=(e,t)=>{var r={};for(var n in e)Em.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Lc)for(var n of Lc(e))t.indexOf(n)<0&&UT.call(e,n)&&(r[n]=e[n]);return r};var mV=(e,t)=>()=>(e&&(t=e(e=0)),t);var yV=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Yi=(e,t)=>{for(var r in t)wc(e,r,{get:t[r],enumerable:!0})},aS=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of sS(t))!Em.call(e,i)&&i!==r&&wc(e,i,{get:()=>t[i],enumerable:!(n=nS(t,i))||n.enumerable});return e};var gV=(e,t,r)=>(r=e!=null?tS(oS(e)):{},aS(t||!e||!e.__esModule?wc(r,\"default\",{value:e,enumerable:!0}):r,e));var hV=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return r=>{for(var n=r.length,i=new Uint8Array((n-(r[n-1]==\"=\")-(r[n-2]==\"=\"))*3/4|0),s=0,o=0;s<n;){var a=e[r.charCodeAt(s++)],u=e[r.charCodeAt(s++)],l=e[r.charCodeAt(s++)],c=e[r.charCodeAt(s++)];i[o++]=a<<2|u>>4,i[o++]=u<<4|l>>2,i[o++]=l<<6|c}return i}})();var kT=function(){{var e=function(){},t=[\"log\",\"info\",\"warn\",\"error\",\"assert\",\"dir\",\"clear\",\"profile\",\"profileEnd\",\"time\",\"timeEnd\",\"group\",\"groupCollapsed\",\"groupEnd\",\"trace\"],r={},n=function(i){typeof window!=\"undefined\"&&window.console&&window.console[i]?r[i]=function(){Function.prototype.apply.call(window.console[i],window.console,arguments)}:r[i]=e};return t.forEach(n),r}}(),xV=kT,{log:TV,warn:PV,error:IV,assert:MV,dir:EV,clear:vV,profile:OV,profileEnd:SV,time:DV,timeEnd:NV,group:AV,groupCollapsed:RV,groupEnd:CV,trace:LV}=kT;var Jc={};Yi(Jc,{getFrame:()=>aD});function Pn(e,t,r){return{input:e,start:t,end:r}}function Xi(e,t){return Pn(e,t,t)}function en(e,t){if(e.input!==t.input)throw new Error(\"Programming Error: cannot form a span on different inputs\");return Pn(e.input,e.start,t.end)}function Dr(e){return e.input.slice(e.start,e.end)}var Ws=()=>({type:\"empty\"}),Jr=()=>({type:\"unknown\"}),Zn=e=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?Ws():{type:\"known\",bounds:e},Xa=(e,t)=>{if(t===0)return e>0?Wi():Ws();let r=-e/t,n=t<0?[-1/0,r]:[r,1/0];return Zn(n)},Wi=()=>Zn([-1/0,1/0]),ln=(e,t)=>{if(e.type===\"empty\"||t.type===\"empty\")return Ws();if(e.type===\"unknown\"||t.type===\"unknown\")return Jr();let r=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])];return Zn(r)},YT=(e,t)=>{if(e.type===\"empty\")return t;if(t.type===\"empty\")return e;if(e.type===\"unknown\"||t.type===\"unknown\")return Jr();let r=[Math.min(e.bounds[0],t.bounds[0]),Math.max(e.bounds[1],t.bounds[1])];return Zn(r)};var De={};Yi(De,{Action:()=>Be,AngleMarker:()=>Ie,Any:()=>st,Arc:()=>ee,Bool:()=>me,Circle:()=>ue,DirectedAngleMarker:()=>ye,Distribution:()=>je,EmptyList:()=>Oe,ErrorType:()=>oi,Line:()=>oe,ListOfAngleMarker:()=>zt,ListOfAny:()=>wt,ListOfArc:()=>hr,ListOfBool:()=>Nr,ListOfCircle:()=>gr,ListOfColor:()=>Or,ListOfDirectedAngleMarker:()=>qt,ListOfDistribution:()=>Qt,ListOfLine:()=>br,ListOfNumber:()=>j,ListOfPoint:()=>Ue,ListOfPoint3D:()=>zr,ListOfPolygon:()=>ur,ListOfRay:()=>xr,ListOfSegment:()=>Kt,ListOfSegment3D:()=>qr,ListOfSphere3D:()=>Ur,ListOfTransformation:()=>Gr,ListOfTriangle3D:()=>Ar,ListOfVector:()=>Sr,Number:()=>b,Point:()=>N,Point3D:()=>z,Polygon:()=>Ee,RGBColor:()=>ot,Ray:()=>ve,SeedType:()=>He,Segment:()=>xe,Segment3D:()=>Tr,Sphere3D:()=>Pr,Transformation:()=>Ce,Triangle3D:()=>dr,Vector:()=>pe,allListTypes:()=>Zi,allValueTypes:()=>uS,assertTypeIsOneOf:()=>tl,broadcastable:()=>ai,broadcastableArg:()=>ia,elementType:()=>Fe,hasListType:()=>ui,isGeometryType:()=>Ku,isList:()=>q,isOneOf:()=>_c,isSubType:()=>ji,isSubTypeOrCoercible:()=>Is,isTypeOrListOfType:()=>re,isValidOnLogScales:()=>el,listType:()=>tn,maxArity:()=>Qu,minArity:()=>bo,prettyPrint:()=>ne,repr:()=>In,summableElementTypes:()=>Om});function M(e,t){return{key:e,vars:t}}var st=0,b=1,me=2,N=3,je=4,Be=5,wt=6,j=7,Nr=8,Ue=9,Qt=10,Oe=11,oi=12,He=13,ot=14,Or=15,Ee=16,ur=17,xe=18,Kt=19,ue=20,gr=21,ee=22,hr=23,oe=24,br=25,ve=26,xr=27,Ie=28,zt=29,ye=30,qt=31,Ce=32,Gr=33,pe=34,Sr=35,z=100,zr=101,Tr=102,qr=103,dr=104,Ar=105,Pr=106,Ur=107,uS=[st,b,me,N,z,je,Be,wt,j,Nr,Ue,zr,Qt,Oe,oi,He,ot,Or,Ee,ur,xe,Kt,ue,gr,ee,hr,oe,br,ve,xr,Ie,zt,ye,qt,Ce,Gr,Tr,qr,dr,Ar,Pr,Ur];function bo(e){return Array.isArray(e)?e.length:e.initial.length}function Qu(e){return Array.isArray(e)?e.length:1/0}function ia(e){if(typeof e==\"number\")return ui(e)?{meta:\"union\",types:[e,tn(e)]}:e;let t=[];for(let r of e.types){let n=ia(r);typeof n==\"number\"?t.push(n):t.push(...n.types)}return{meta:\"union\",types:t}}function ai(e){return Array.isArray(e)?e.map(ia):{type:\"variadic\",initial:e.initial.map(ia),rest:ia(e.rest)}}function In(e){switch(e){case st:return\"Any\";case b:return\"Number\";case me:return\"Bool\";case N:return\"Point\";case z:return\"Point3D\";case je:return\"Distribution\";case Be:return\"Action\";case wt:return\"ListOfAny\";case j:return\"ListOfNumber\";case Nr:return\"ListOfBool\";case Ue:return\"ListOfPoint\";case zr:return\"ListOfPoint3D\";case Qt:return\"ListOfDistribution\";case Oe:return\"EmptyList\";case oi:return\"ErrorType\";case He:return\"SeedType\";case ot:return\"RGBColor\";case Or:return\"ListOfColor\";case Ee:return\"Polygon\";case ur:return\"ListOfPolygon\";case xe:return\"Segment\";case Kt:return\"ListOfSegment\";case ue:return\"Circle\";case gr:return\"ListOfCircle\";case ee:return\"Arc\";case hr:return\"ListOfArc\";case oe:return\"Line\";case br:return\"ListOfLine\";case ve:return\"Ray\";case xr:return\"ListOfRay\";case pe:return\"Vector\";case Sr:return\"ListOfVector\";case Ie:return\"Angle\";case zt:return\"ListOfAngle\";case ye:return\"DirectedAngle\";case qt:return\"ListOfDirectedAngle\";case Ce:return\"Transformation\";case Gr:return\"ListOfTransformation\";case Tr:return\"Segment3D\";case qr:return\"ListOfSegment3D\";case dr:return\"Triangle3D\";case Ar:return\"ListOfTriangle3D\";case Pr:return\"Sphere3D\";case Ur:return\"ListOfSphere3D\";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function ne(e){switch(e){case st:return M(\"shared-calculator-label-value-type-any\");case b:return M(\"shared-calculator-label-value-type-number\");case me:return M(\"shared-calculator-label-value-type-bool\");case N:return M(\"shared-calculator-label-value-type-point\");case z:return M(\"shared-calculator-label-value-type-point3d\");case je:return M(\"shared-calculator-label-value-type-distribution\");case Be:return M(\"shared-calculator-label-value-type-action\");case wt:return M(\"shared-calculator-label-value-type-list-of-any\");case j:return M(\"shared-calculator-label-value-type-list-of-numbers\");case Nr:return M(\"shared-calculator-label-value-type-list-of-bool\");case Ue:return M(\"shared-calculator-label-value-type-list-of-points\");case zr:return M(\"shared-calculator-label-value-type-list-of-3d-points\");case Qt:return M(\"shared-calculator-label-value-type-list-of-distributions\");case Oe:return M(\"shared-calculator-label-value-type-empty-list\");case oi:return M(\"shared-calculator-label-value-type-error\");case He:return M(\"shared-calculator-label-value-type-seed\");case ot:return M(\"shared-calculator-label-value-type-color\");case Or:return M(\"shared-calculator-label-value-type-list-of-colors\");case Ee:return M(\"shared-calculator-label-value-type-polygon\");case ur:return M(\"shared-calculator-label-value-type-list-of-polygons\");case xe:return M(\"shared-calculator-label-value-type-segment\");case Kt:return M(\"shared-calculator-label-value-type-list-of-segments\");case ue:return M(\"shared-calculator-label-value-type-circle\");case gr:return M(\"shared-calculator-label-value-type-list-of-circles\");case ee:return M(\"shared-calculator-label-value-type-arc\");case hr:return M(\"shared-calculator-label-value-type-list-of-arcs\");case oe:return M(\"shared-calculator-label-value-type-line\");case br:return M(\"shared-calculator-label-value-type-list-of-lines\");case ve:return M(\"shared-calculator-label-value-type-ray\");case xr:return M(\"shared-calculator-label-value-type-list-of-rays\");case pe:return M(\"shared-calculator-label-value-type-vector\");case Sr:return M(\"shared-calculator-label-value-type-list-of-vectors\");case Ie:return M(\"shared-calculator-label-value-type-angle\");case zt:return M(\"shared-calculator-label-value-type-list-of-angles\");case ye:return M(\"shared-calculator-label-value-type-directed-angle\");case qt:return M(\"shared-calculator-label-value-type-list-of-directed-angles\");case Ce:return M(\"shared-calculator-label-value-type-transformation\");case Gr:return M(\"shared-calculator-label-value-type-list-of-transformations\");case Tr:return M(\"shared-calculator-label-value-type-segment3d\");case qr:return M(\"shared-calculator-label-value-type-list-of-segment3d\");case dr:return M(\"shared-calculator-label-value-type-triangle3d\");case Ar:return M(\"shared-calculator-label-value-type-list-of-triangle3d\");case Pr:return M(\"shared-calculator-label-value-type-sphere3d\");case Ur:return M(\"shared-calculator-label-value-type-list-of-sphere3d\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}var Zi=[wt,j,Nr,Ue,zr,Qt,Oe,Or,ur,Kt,gr,hr,br,xr,Sr,zt,qt,Gr,qr,Ar,Ur],_V={[wt]:st,[Oe]:b,[j]:b,[Nr]:me,[Ue]:N,[zr]:z,[Qt]:je,[Or]:ot,[ur]:Ee,[Kt]:xe,[gr]:ue,[hr]:ee,[br]:oe,[xr]:ve,[Sr]:pe,[zt]:Ie,[qt]:ye,[Gr]:Ce,[qr]:Tr,[Ar]:dr,[Ur]:Pr};function q(e){switch(e){case wt:case j:case Nr:case Ue:case zr:case Qt:case Or:case ur:case Kt:case gr:case hr:case br:case xr:case Sr:case zt:case qt:case Gr:case qr:case Ar:case Ur:case Oe:return!0;case st:case b:case me:case N:case z:case je:case oi:case He:case ot:case Be:case Ee:case xe:case ue:case ee:case oe:case ve:case pe:case Ie:case ye:case Ce:case Tr:case dr:case Pr:return!1;default:throw new Error(`Invalid type: ${e}`)}}function Fe(e){switch(e){case Oe:case j:return b;case Nr:return me;case Ue:return N;case zr:return z;case Qt:return je;case Or:return ot;case ur:return Ee;case qr:return Tr;case Ar:return dr;case Ur:return Pr;case wt:return st;case Kt:return xe;case gr:return ue;case hr:return ee;case br:return oe;case xr:return ve;case Sr:return pe;case zt:return Ie;case qt:return ye;case Gr:return Ce;case st:case b:case me:case N:case z:case je:case oi:case He:case ot:case Be:case Ee:case xe:case ue:case ee:case oe:case ve:case pe:case Ie:case ye:case Ce:case Tr:case dr:case Pr:throw new Error(\"Type \"+In(e)+\" does not implement elementType.\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function tn(e){switch(e){case st:return wt;case b:return j;case me:return Nr;case N:return Ue;case z:return zr;case je:return Qt;case ot:return Or;case Ee:return ur;case xe:return Kt;case ue:return gr;case ee:return hr;case oe:return br;case ve:return xr;case pe:return Sr;case Ie:return zt;case ye:return qt;case Ce:return Gr;case Tr:return qr;case dr:return Ar;case Pr:return Ur;case Oe:case j:case Nr:case Ue:case zr:case Qt:case Or:case ur:case Kt:case gr:case hr:case br:case xr:case Sr:case zt:case qt:case Gr:case qr:case Ar:case Ur:case wt:case oi:case He:case Be:throw new Error(\"Type \"+In(e)+\" does not implement listType.\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function ui(e){switch(e){case st:case b:case me:case N:case z:case je:case ot:case Ee:case xe:case ue:case ee:case oe:case ve:case pe:case Ie:case ye:case Ce:case Tr:case dr:case Pr:return!0;case Oe:case j:case Nr:case Ue:case zr:case Qt:case Or:case ur:case Kt:case gr:case hr:case br:case xr:case Sr:case zt:case qt:case Gr:case qr:case Ar:case Ur:case wt:case He:case Be:case oi:return!1;default:throw new Error(`Invalid type: ${e}`)}}function Ku(e){if(e===void 0)return!1;switch(e){case N:case Ee:case xe:case ue:case ee:case oe:case ve:case pe:case Ie:case ye:case Ce:return!0;default:return!1}}function el(e){switch(e){case b:case st:case me:case N:case je:case Be:case wt:case j:case Nr:case Ue:case Qt:case Oe:case oi:case He:case ot:case Or:return!0;case z:case zr:case Tr:case qr:case dr:case Ar:case Pr:case Ur:case Ee:case ur:case xe:case Kt:case ue:case gr:case ee:case hr:case oe:case br:case ve:case xr:case pe:case Sr:case Ie:case zt:case ye:case qt:case Ce:case Gr:return!1;default:let t=e;throw new Error(`Invalid type: ${t}`)}}function _c(e,t){for(let r of t)if(e===r)return!0;return!1}function ji(e,t){return e===Oe&&q(t)||t===wt&&q(e)||t===st&&!q(e)?!0:e===t}function Is(e,t){return ji(e,t)||(e===Ie||e===ye)&&t===b?!0:(e===zt||e===qt)&&t===j}var Om=[b,N,z];function re(e,t){return e===t?!0:q(e)?e===Oe?!0:Fe(e)===t:!1}function tl(e,t){if(!_c(e,t))throw new Error(`Programming error: expected one of ${t.map(ne)} but found ${e} instead.`)}var tt=class{constructor(){this.exportPenalty=0;this._dependencies=[],this._dummyDependencies=[],this._updateSymbols=[],this._substitutionSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],isSubstitutionBody:!1,scopes:[]},this._exports=[]}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?\"\":Dr(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty(\"index\")?[\"ans_\"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(var r=0;r<t.length;r++)this.addDependency(t[r])}addDummyDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t)}addDummyDependencies(t){for(var r=0;r<t.length;r++)this.addDummyDependency(t[r])}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionSymbol(t){this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t),this._substitutionSymbols.indexOf(t)===-1&&this._substitutionSymbols.push(t)}addSubstitutionDependencies(t){for(var r=0;r<t.length;r++){var n=t[r];if(this._dependencies.indexOf(n)===-1)throw new Error(\"Programming error: substitution dependency \"+n+\" must also be registered as a regular dependency\");this._scope.substitutionDependencies.indexOf(n)===-1&&this._scope.substitutionDependencies.push(n)}}mergeDependencies(...t){for(var r=0;r<t.length;r++){var n=t[r],i;for(i=0;i<n._dependencies.length;i++)this._dependencies.indexOf(n._dependencies[i])===-1&&this._dependencies.push(n._dependencies[i]);for(i=0;i<n._updateSymbols.length;i++)this._updateSymbols.indexOf(n._updateSymbols[i])===-1&&this._updateSymbols.push(n._updateSymbols[i]);for(i=0;i<n._substitutionSymbols.length;i++)this._substitutionSymbols.indexOf(n._substitutionSymbols[i])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[i]);for(i=0;i<n._scope.dependencies.length;i++)this._scope.dependencies.indexOf(n._scope.dependencies[i])===-1&&this._scope.dependencies.push(n._scope.dependencies[i]);for(i=0;i<n._scope.substitutionDependencies.length;i++)this._scope.substitutionDependencies.indexOf(n._scope.substitutionDependencies[i])===-1&&this._scope.substitutionDependencies.push(n._scope.substitutionDependencies[i]);this.addDummyDependencies(n.getDummyDependencies()),Array.prototype.push.apply(this._scope.scopes,n._scope.scopes)}}mergeDependenciesInScope(t,r,n){this.addDummyDependencies(t);var i=r.getScope(),s={definitions:t,dependencies:i.dependencies,substitutionDependencies:i.substitutionDependencies,scopes:i.scopes,isSubstitutionBody:!!(n&&n.isSubstitutionBody)};this._scope.scopes.push(s);for(var o=0;o<r._dependencies.length;o++)this._dependencies.indexOf(r._dependencies[o])===-1&&this._dependencies.push(r._dependencies[o]);for(o=0;o<r._updateSymbols.length;o++)this._updateSymbols.indexOf(r._updateSymbols[o])===-1&&this._updateSymbols.push(r._updateSymbols[o]);for(o=0;o<r._substitutionSymbols.length;o++)this._substitutionSymbols.indexOf(r._substitutionSymbols[o])===-1&&this._substitutionSymbols.push(r._substitutionSymbols[o]);this.addDummyDependencies(r.getDummyDependencies())}getDependencies(){return this._dependencies}graphmodeDependencies(t,r){return this.getDependencies()}getDummyDependencies(){return this._dummyDependencies}getUpdateSymbols(){return this._updateSymbols}getSubstitutionSymbols(){return this._substitutionSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(t){var r=this._exports||[];if(this.userData&&\"id\"in this.userData){var n=this.userData.id;r=r.concat([\"idref_\"+n])}return t.ansEnabled()&&(r=r.concat(this.getAnsVariable())),r}getLegalExports(t){return this.getExports(t).filter(function(r){return!t.assignmentForbidden(r)})}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,r,n){for(var i=this.getLegalExports(t),s=0;s<i.length;s++){var o=i[s];if(n[o])return;n[o]=r.blocksExport?r:this}}getOperator(){return this.operator||\"=\"}isInequality(){return!1}isShadeBetween(){return!1}getAllIds(){return this.userData?[this.userData.id]:[]}getEvaluationInfo(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,r,n){var i=t.sliderVariables(n!=null?n:r.getDependencies());return r.valueType===N||r.valueType===Ue?i.filter(function(s){return!t.validParametricVariable(s)}):i}getCompiledDerivative(){var t=this.getDependencies(),n=this.takeDerivative(t[0]||\"x\");return n.getCompiledFunction()}asValue(){}boundDomain(t){return Jr()}getCursorContext(){}polynomialOrder(t){}getPolynomialCoefficients(t){}asTypedValue(){}substitute(t){}getExpressionType(t,r){}tableInfo(t,r){}analyzeFourFunction(t,r,n){}analyzeScientific(t,r,n){}analyzeSingleExpressionScientific(t,r,n){}getGraphMode(t,r){}};var k=class extends tt{constructor(r,n){if(!Array.isArray(r))throw new TypeError(\"Argument to expression constructor must be an Array.\");super();this.args=r,(!n||!n.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(var r=0;r<this.args.length;r++)this.mergeDependencies(this.args[r])}copyWithArgs(r){return new this.constructor(r)}};function Zs(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let r,n=0,i=1,s=1,o=0,a,u;for(;r=Math.floor(e),a=r*i+n,u=r*o+s,!(u>t||(n=i,s=o,i=a,o=u,e===r));)e=1/(e-r);return{n:i,d:o}}function XT(e,t,r){if(e=Za(e),r>0){let n=Za(t);return e<n&&(e+=2*Math.PI),(e-n)/r}else{let n=Za(t+r);return e<n&&(e+=2*Math.PI),1+(e-n)/r}}function Fc(e,t,r){e=Za(e);let n=Za(t),i=Za(t+r);if(r<0){let s=n;n=i,i=s}return n<i?n<=e&&e<=i:n<=e||e<=i}function Za(e){let t=2*Math.PI;return(e%t+t)%t}var Ni=Math.hypot;function js(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function cS(e,t,r,n,i,s){return e*n+t*i+r*s}function Ji(e,t,r,n,i,s,o,a,u){let l=Ni(o-n,a-i,u-s);return l===0?0:cS((e-n)/l,(t-i)/l,(r-s)/l,(o-n)/l,(a-i)/l,(u-s)/l)}function pS(e,t,r,n,i,s){let o=Ji(e,t,0,r,n,0,i,s,0);return o<=0?[r,n]:o>=1?[i,s]:[r+o*(i-r),n+o*(s-n)]}function qV(e,t,r,n,i,s,o,a){let u=Ji(e,t,0,r,n,0,i,s,0);return u<=0&&!o?[r,n]:u>=1&&!a?[i,s]:[r+u*(i-r),n+u*(s-n)]}function WT(e,t,r,n,i,s){let o=pS(e,t,r,n,i,s);return Ni(e-o[0],t-o[1])}function UV(e,t,r,n,i,s,o){var a=Math.atan2(t-n,e-r);if(Fc(a,s,o-s))return[i*Math.cos(a)+r,i*Math.sin(a)+n]}function cn(e,t,r=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(r>50)throw new Error(\"Within \"+(52-r)+\" bits isn't really approximate any more\");let n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),i=r===1?.5:Math.pow(.5,r);return n===n+i*Math.abs(t-e)}function HV(e){return Math.round(e-.5)+.5}function sa(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let n=t;t=e,e=n}if(t===0)return e;let r=e%t;for(;r>0;)e=t,t=r,r=e%t;return t}function oa(e,t){if(!isFinite(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let r=Zs(t,100);return cn(r.n/r.d,t,2)&&r.d%2===1?(r.n%2===0?1:-1)*Math.pow(-e,t):NaN}function ja(e,t){return{n:e,d:t}}function er(e){return typeof e==\"object\"&&typeof e.n==\"number\"&&typeof e.d==\"number\"}var rl=Math.pow(2,53)-1;function aa(e){let t=e.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;let r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;let s=!!r;if(i){let o=i.replace(/0+$/,\"\"),a=o.length,u=Math.pow(10,a),l=parseInt(n||\"0\",10)*u+parseInt(o||\"0\",10);return l>rl||u>rl?parseFloat(e):Me(s?-l:l,u)}else{let o=parseInt(n,10);return o>rl?parseFloat(e):Me(s?-o:o,1)}}function B(e){return er(e)?e.n/e.d:+e}function jn(e){return er(e)?!1:isNaN(e)}function Me(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>rl||Math.abs(t)>rl)return e/t;t<0&&(e=-e,t=-t);let r=sa(e,t);return ja(e/r,t/r)}function li(e){return er(e)?ja(-e.n,e.d):-e}function ZT(e){return er(e)?ja(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function nl(e){return er(e)?e.n===0?e.d/e.n:ja(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function Ms(e,t){if(!er(e)||!er(t))return B(e)+B(t);var r=sa(e.d,t.d);return Me(e.n*(t.d/r)+t.n*(e.d/r),e.d/r*t.d)}function Es(e,t){if(!er(e)||!er(t))return B(e)*B(t);var r=sa(e.n,t.d),n=sa(t.n,e.d);return Me(e.n/r*(t.n/n),e.d/n*(t.d/r))}function Qi(e,t){return Ms(e,li(t))}function Ki(e,t){return!er(e)||!er(t)?B(e)/B(t):Es(e,nl(t))}function dS(e,t){let r=e,n=t;if(t.n<0&&(n=li(t),r=nl(e)),!er(r)||!er(n))return oa(B(e),B(t));if(e=r,t=n,t.d===1)return Me(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let i=e.n<0;if(i&&t.d%2!==1)return NaN;let o=(i?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(o,t.d)!==e.n||Math.pow(a,t.d)!==e.d?oa(B(e),B(t)):Me(Math.pow(o,t.n),Math.pow(a,t.n))}function Sm(e,t){if(!er(e)||!er(t))return oa(B(e),B(t));let r=dS(e,t);return er(r)?r:oa(B(e),B(t))}function jT(e){if(!er(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(B(e)):Me(t,r)}function Vc(e,t){return Sm(e,nl(t))}function JT(e,t){if(!er(e)||!er(t)){let r=B(e),n=B(t);return r-n*Math.floor(r/n)}return Qi(e,Es(t,ja(Math.floor(B(Ki(e,t))),1)))}function QT(e){let t=ja(0,1);for(let r of e)t=Ms(t,r);return t}var rr=class extends k{constructor(r){super([]);this.isConstant=!0;typeof r==\"number\"&&(r=Me(r,1)),this._constantValue=r}asValue(){let r=this._constantValue;return typeof r==\"boolean\"?r:B(r)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):\"(\"+String(this.asValue())+\")\"}getEvaluationInfo(){return[{val:this.asValue()}]}isNaN(){let r=this.asValue();return typeof r==\"number\"&&isNaN(r)}};var Qs={};Yi(Qs,{canDisplayAsFraction:()=>OP,formatSymbol:()=>Y,geoParentToLatex:()=>tD,identifierToHTML:()=>rD,identifierToLatex:()=>wr,latexToIdentifier:()=>vs,numericLabel:()=>Xc,point:()=>ZS,roundDecimal:()=>KS,trimLatex:()=>Os,truncatedHTMLLabel:()=>eD,truncatedLatexLabel:()=>Vm,truncatedPlainmathLabel:()=>Fm,value:()=>wm});var Bc=typeof self==\"object\"&&self.self===self&&self||typeof global==\"object\"&&global.global===global&&global||Function(\"return this\")()||{},qc=Array.prototype,Am=Object.prototype,KT=typeof Symbol!=\"undefined\"?Symbol.prototype:null,XV=qc.push,mS=qc.slice,Gc=Am.toString,yS=Am.hasOwnProperty,gS=Array.isArray,eP=Object.keys,tP=Object.create,sP=Bc.isNaN,hS=Bc.isFinite,Dm=function(){};function Hr(e){if(e instanceof Hr)return e;if(!(this instanceof Hr))return new Hr(e);this._wrapped=e}var WV=Hr.VERSION=\"1.10.2\";function Uc(e,t,r){if(t===void 0)return e;switch(r==null?3:r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,s){return e.call(t,n,i,s)};case 4:return function(n,i,s,o){return e.call(t,n,i,s,o)}}return function(){return e.apply(t,arguments)}}function oP(e,t,r){return e==null?$S:Js(e)?Uc(e,t,r):ru(e)&&!tu(e)?YS(e):bP(e)}Hr.iteratee=aP;function aP(e,t){return oP(e,t,1/0)}function es(e,t,r){return Hr.iteratee!==aP?Hr.iteratee(e,t):oP(e,t,r)}\
function ci(e,t){\
    return t=t==null?e.length-1:+t,\
        function(){\
            for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)\
                n[i]=arguments[i+t];\
            switch(t){\
                case 0:return e.call(this,n);\
                case 1:return e.call(this,arguments[0],n);\
                case 2:return e.call(this,arguments[0],arguments[1],n)\
            }\
            var s=Array(t+1);\
            for(i=0;i<t;i++)\
                s[i]=arguments[i];\
            return s[t]=n,\
                e.apply(this,s)\
        }\
}\
function bS(e){if(!ru(e))return{};if(tP)return tP(e);Dm.prototype=e;var t=new Dm;return Dm.prototype=null,t}function uP(e){return function(t){return t==null?void 0:t[e]}}function Qa(e,t){return e!=null&&yS.call(e,t)}function lP(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}var xS=Math.pow(2,53)-1,To=uP(\"length\");function pi(e){var t=To(e);return typeof t==\"number\"&&t>=0&&t<=xS}function Ka(e,t,r){t=Uc(t,r);var n,i;if(pi(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var s=Mn(e);for(n=0,i=s.length;n<i;n++)t(e[s[n]],s[n],e)}return e}function Hc(e,t,r){t=es(t,r);for(var n=!pi(e)&&Mn(e),i=(n||e).length,s=Array(i),o=0;o<i;o++){var a=n?n[o]:o;s[o]=t(e[a],a,e)}return s}function cP(e){var t=function(r,n,i,s){var o=!pi(r)&&Mn(r),a=(o||r).length,u=e>0?0:a-1;for(s||(i=r[o?o[u]:u],u+=e);u>=0&&u<a;u+=e){var l=o?o[u]:u;i=n(i,r[l],l,r)}return i};return function(r,n,i,s){var o=arguments.length>=3;return t(r,Uc(n,s,4),i,o)}}var ZV=cP(1),jV=cP(-1);function TS(e,t,r){var n=[];return t=es(t,r),Ka(e,function(i,s,o){t(i,s,o)&&n.push(i)}),n}function JV(e,t,r){t=es(t,r);for(var n=!pi(e)&&Mn(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(!t(e[o],o,e))return!1}return!0}function QV(e,t,r){t=es(t,r);for(var n=!pi(e)&&Mn(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(t(e[o],o,e))return!0}return!1}function Ja(e,t,r,n){return pi(e)||(e=il(e)),(typeof r!=\"number\"||n)&&(r=0),SS(e,t,r)>=0}var KV=ci(function(e,t,r){var n,i;return Js(t)?i=t:tu(t)&&(n=t.slice(0,-1),t=t[t.length-1]),Hc(e,function(s){var o=i;if(!o){if(n&&n.length&&(s=lP(s,n)),s==null)return;o=s[t]}return o==null?o:o.apply(s,r)})});function pP(e,t){return Hc(e,bP(t))}function PS(e,t,r){var n=-1/0,i=-1/0,s,o;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=pi(e)?e:il(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s>n&&(n=s)}else t=es(t,r),Ka(e,function(l,c,p){o=t(l,c,p),(o>i||o===-1/0&&n===-1/0)&&(n=l,i=o)});return n}function eB(e,t,r){var n=1/0,i=1/0,s,o;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=pi(e)?e:il(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s<n&&(n=s)}else t=es(t,r),Ka(e,function(l,c,p){o=t(l,c,p),(o<i||o===1/0&&n===1/0)&&(n=l,i=o)});return n}function tB(e){return IS(e,1/0)}function IS(e,t,r){if(t==null||r)return pi(e)||(e=il(e)),e[nP(e.length-1)];var n=pi(e)?FS(e):il(e),i=To(n);t=Math.max(Math.min(t,i),0);for(var s=i-1,o=0;o<t;o++){var a=nP(o,s),u=n[o];n[o]=n[a],n[a]=u}return n.slice(0,t)}function rB(e,t,r){var n=0;return t=es(t,r),pP(Hc(e,function(i,s,o){return{value:i,index:n++,criteria:t(i,s,o)}}).sort(function(i,s){var o=i.criteria,a=s.criteria;if(o!==a){if(o>a||o===void 0)return 1;if(o<a||a===void 0)return-1}return i.index-s.index}),\"value\")}function kc(e,t){return function(r,n,i){var s=t?[[],[]]:{};return n=es(n,i),Ka(r,function(o,a){var u=n(o,a,r);e(s,o,u)}),s}}var nB=kc(function(e,t,r){Qa(e,r)?e[r].push(t):e[r]=[t]}),iB=kc(function(e,t,r){e[r]=t}),sB=kc(function(e,t,r){Qa(e,r)?e[r]++:e[r]=1});function oB(e){return e==null?0:pi(e)?e.length:Mn(e).length}var aB=kc(function(e,t,r){e[r?0:1].push(t)},!0);function eu(e,t,r,n){n=n||[];for(var i=n.length,s=0,o=To(e);s<o;s++){var a=e[s];if(pi(a)&&(tu(a)||zc(a)))if(t)for(var u=0,l=a.length;u<l;)n[i++]=a[u++];else eu(a,t,r,n),i=n.length;else r||(n[i++]=a)}return n}var uB=ci(function(e,t){return Rm(e,t)});function sl(e,t,r,n){kS(t)||(n=r,r=t,t=!1),r!=null&&(r=es(r,n));for(var i=[],s=[],o=0,a=To(e);o<a;o++){var u=e[o],l=r?r(u,o,e):u;t&&!r?((!o||s!==l)&&i.push(u),s=l):r?Ja(s,l)||(s.push(l),i.push(u)):Ja(i,u)||i.push(u)}return i}var lB=ci(function(e){return sl(eu(e,!0,!0))});var Rm=ci(function(e,t){return t=eu(t,!0,!0),TS(e,function(r){return!Ja(t,r)})});function MS(e){for(var t=e&&PS(e,To).length||0,r=Array(t),n=0;n<t;n++)r[n]=pP(e,n);return r}var cB=ci(MS);function fP(e){return function(t,r,n){r=es(r,n);for(var i=To(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(r(t[s],s,t))return s;return-1}}var ES=fP(1),vS=fP(-1);function OS(e,t,r,n){r=es(r,n,1);for(var i=r(t),s=0,o=To(e);s<o;){var a=Math.floor((s+o)/2);r(e[a])<i?s=a+1:o=a}return s}function dP(e,t,r){return function(n,i,s){var o=0,a=To(n);if(typeof s==\"number\")e>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(r&&s&&a)return s=r(n,i),n[s]===i?s:-1;if(i!==i)return s=t(mS.call(n,o,a),HS),s>=0?s+o:-1;for(s=e>0?o:a-1;s>=0&&s<a;s+=e)if(n[s]===i)return s;return-1}}var SS=dP(1,ES,OS),pB=dP(-1,vS);function mP(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var s=bS(e.prototype),o=e.apply(s,i);return ru(o)?o:s}var DS=ci(function(e,t,r){if(!Js(e))throw new TypeError(\"Bind must be called on a function\");var n=ci(function(i){return mP(e,n,t,this,r.concat(i))});return n}),$c=ci(function(e,t){var r=$c.placeholder,n=function(){for(var i=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===r?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return mP(e,n,this,this,o)};return n});$c.placeholder=Hr;var fB=ci(function(e,t){t=eu(t,!1,!1);var r=t.length;if(r<1)throw new Error(\"bindAll must be passed function names\");for(;r--;){var n=t[r];e[n]=DS(e[n],e)}});var yP=ci(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),dB=$c(yP,Hr,1);function mB(e,t,r){var n,i,s,o,a=0;r||(r={});var u=function(){a=r.leading===!1?0:iP(),n=null,o=e.apply(i,s),n||(i=s=null)},l=function(){var c=iP();!a&&r.leading===!1&&(a=c);var p=t-(c-a);return i=this,s=arguments,p<=0||p>t?(n&&(clearTimeout(n),n=null),a=c,o=e.apply(i,s),n||(i=s=null)):!n&&r.trailing!==!1&&(n=setTimeout(u,p)),o};return l.cancel=function(){clearTimeout(n),a=0,n=i=s=null},l}\
function yB(e,t,r){\
    var n,\
        i,\
        s=function(a,u){\
            n=null,\
            u&&(i=e.apply(a,u))\
        },\
        o=ci(function(a){\
            if(n&&clearTimeout(n),r){\
                var u=!n;\
                n=setTimeout(s,t),\
                u&&(i=e.apply(this,a))\
            }else\
                n=yP(s,t,this,a);\
            return i\
        });\
    return o.cancel=function(){\
        clearTimeout(n),\
        n=null\
    },o\
}\
function NS(e){return function(){return!e.apply(this,arguments)}}function AS(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var gB=$c(AS,2),gP=!{toString:null}.propertyIsEnumerable(\"toString\"),rP=[\"valueOf\",\"isPrototypeOf\",\"toString\",\"propertyIsEnumerable\",\"hasOwnProperty\",\"toLocaleString\"];function hP(e,t){var r=rP.length,n=e.constructor,i=Js(n)&&n.prototype||Am,s=\"constructor\";for(Qa(e,s)&&!Ja(t,s)&&t.push(s);r--;)s=rP[r],s in e&&e[s]!==i[s]&&!Ja(t,s)&&t.push(s)}function Mn(e){if(!ru(e))return[];if(eP)return eP(e);var t=[];for(var r in e)Qa(e,r)&&t.push(r);return gP&&hP(e,t),t}function Cm(e){if(!ru(e))return[];var t=[];for(var r in e)t.push(r);return gP&&hP(e,t),t}function il(e){for(var t=Mn(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function RS(e){for(var t={},r=Mn(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function Lm(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var i=1;i<n;i++)for(var s=arguments[i],o=e(s),a=o.length,u=0;u<a;u++){var l=o[u];(!t||r[l]===void 0)&&(r[l]=s[l])}return r}}var CS=Lm(Cm),LS=Lm(Mn);function wS(e,t,r){return t in r}var _S=ci(function(e,t){var r={},n=t[0];if(e==null)return r;Js(n)?(t.length>1&&(n=Uc(n,t[1])),t=Cm(e)):(n=wS,t=eu(t,!1,!1),e=Object(e));for(var i=0,s=t.length;i<s;i++){var o=t[i],a=e[o];n(a,o,e)&&(r[o]=a)}return r}),hB=ci(function(e,t){var r=t[0],n;return Js(r)?(r=NS(r),t.length>1&&(n=t[1])):(t=Hc(eu(t,!1,!1),String),r=function(i,s){return!Ja(t,s)}),_S(e,r,n)}),bB=Lm(Cm,!0);function FS(e){return ru(e)?tu(e)?e.slice():CS({},e):e}function VS(e,t){var r=Mn(t),n=r.length;if(e==null)return!n;for(var i=Object(e),s=0;s<n;s++){var o=r[s];if(t[o]!==i[o]||!(o in i))return!1}return!0}function Nm(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!==\"function\"&&i!==\"object\"&&typeof t!=\"object\"?!1:BS(e,t,r,n)}function BS(e,t,r,n){e instanceof Hr&&(e=e._wrapped),t instanceof Hr&&(t=t._wrapped);var i=Gc.call(e);if(i!==Gc.call(t))return!1;switch(i){case\"[object RegExp]\":case\"[object String]\":return\"\"+e==\"\"+t;case\"[object Number]\":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case\"[object Date]\":case\"[object Boolean]\":return+e==+t;case\"[object Symbol]\":return KT.valueOf.call(e)===KT.valueOf.call(t)}var s=i===\"[object Array]\";if(!s){if(typeof e!=\"object\"||typeof t!=\"object\")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(Js(o)&&o instanceof o&&Js(a)&&a instanceof a)&&\"constructor\"in e&&\"constructor\"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),s){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!Nm(e[u],t[u],r,n))return!1}else{var l=Mn(e),c;if(u=l.length,Mn(t).length!==u)return!1;for(;u--;)if(c=l[u],!(Qa(t,c)&&Nm(e[c],t[c],r,n)))return!1}return r.pop(),n.pop(),!0}function Po(e,t){return Nm(e,t)}function xB(e){return e==null?!0:pi(e)&&(tu(e)||GS(e)||zc(e))?e.length===0:Mn(e).length===0}function fi(e){return function(t){return Gc.call(t)===\"[object \"+e+\"]\"}}var tu=gS||fi(\"Array\");function ru(e){var t=typeof e;return t===\"function\"||t===\"object\"&&!!e}var zc=fi(\"Arguments\"),Js=fi(\"Function\"),GS=fi(\"String\"),zS=fi(\"Number\"),TB=fi(\"Date\"),PB=fi(\"RegExp\"),IB=fi(\"Error\"),qS=fi(\"Symbol\"),MB=fi(\"Map\"),EB=fi(\"WeakMap\"),vB=fi(\"Set\"),OB=fi(\"WeakSet\");(function(){zc(arguments)||(zc=function(e){return Qa(e,\"callee\")})})();var US=Bc.document&&Bc.document.childNodes;typeof/./!=\"function\"&&typeof Int8Array!=\"object\"&&typeof US!=\"function\"&&(Js=function(e){return typeof e==\"function\"||!1});function SB(e){return!qS(e)&&hS(e)&&!sP(parseFloat(e))}function HS(e){return zS(e)&&sP(e)}function kS(e){return e===!0||e===!1||Gc.call(e)===\"[object Boolean]\"}function $S(e){return e}function bP(e){return tu(e)?function(t){return lP(t,e)}:uP(e)}function YS(e){return e=LS({},e),function(t){return VS(t,e)}}function nP(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var iP=Date.now||function(){return new Date().getTime()},xP={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"},XS=RS(xP);function TP(e){var t=function(s){return e[s]},r=\"(?:\"+Mn(e).join(\"|\")+\")\",n=RegExp(r),i=RegExp(r,\"g\");return function(s){return s=s==null?\"\":\"\"+s,n.test(s)?s.replace(i,t):s}}var PP=TP(xP),DB=TP(XS);var WS=0;function NB(e){var t=++WS+\"\";return e?e+t:t}var AB=Hr.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};function IP(e,t){return e._chain?Hr(t).chain():t}Ka([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(e){var t=qc[e];Hr.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),(e===\"shift\"||e===\"splice\")&&r.length===0&&delete r[0],IP(this,r)}});Ka([\"concat\",\"join\",\"slice\"],function(e){var t=qc[e];Hr.prototype[e]=function(){return IP(this,t.apply(this._wrapped,arguments))}});Hr.prototype.value=function(){return this._wrapped};Hr.prototype.valueOf=Hr.prototype.toJSON=Hr.prototype.value;Hr.prototype.toString=function(){return String(this._wrapped)};function wm(e,t=e,r=!1){if(isNaN(e)||!isFinite(e))return{string:\"undefined\",latex:\"undefined\",value:e};if(e===0)return{string:\"0\",latex:\"0\",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let n=Zs(e/Math.PI,24),i,s,o,a,u,l;if(MP(t)&&cn(n.n/n.d*Math.PI,e,3))return n.n===0?(i=\"0\",a=\"0\"):n.n===1?(i=\"\\u03C0\",a=\"\\\\pi\"):n.n===-1?(i=\"-\\u03C0\",a=\"-\\\\pi\"):(i=n.n.toString()+\"\\u03C0\",a=n.n.toString()+\"\\\\pi\"),n.d===1?(s=\"\",u=\"\"):(s=\"/\"+n.d.toString(),u=n.d.toString()),o=i+s,u===\"\"?l=a:a[0]===\"-\"?l=`-\\\\frac{${a.slice(1)}}{${u}}`:l=`\\\\frac{${a}}{${u}}`,{string:o,latex:l,value:n.n/n.d*Math.PI};if(!r&&MP(t)||QS(t))return o=JS(EP(e.toFixed(Yc(t)))),{string:o,latex:o,value:parseFloat(o)};{let p=_m(e.toExponential(Yc(t/e))).split(\"e\"),f=p[0]===\"1\"&&r?\"10\":p[0]+\"\\xD710\",d=p[1].replace(\"+\",\"\");return o=_m(e.toExponential(Yc(t/e))).replace(\"+\",\"\"),l=`${p[0]}\\\\times10^{${d}}`,{string:o,latex:l,mantissa:f,superscript:d,value:parseFloat(o)}}}function ZS(e,t,r,n){let i=wm(e,t),s=wm(n(i.value),r);return[i,s]}var jS=/\\.?0+$/;function EP(e){return e.indexOf(\".\")===-1?e:e.replace(jS,\"\")}function _m(e){let t=/\\.?0+e/;return e.replace(t,\"e\")}function JS(e){return e===\"-0\"?\"0\":e}function MP(e){return e=Math.abs(e),1e-4<e&&e<1e7}function QS(e){return e=Math.abs(e),.001<e&&e<1e4}function Yc(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function KS(e){return Math.abs(e)>=1e-20?parseFloat(e.toFixed(Yc(e))):e}function vP(e){return 1e6/Math.sqrt(Math.abs(e))}function OP(e){let t=vP(e);if(t<1||t>1e12)return!1;let{n:r,d:n}=Zs(e,t);return n===1?!1:e===e+Math.pow(2,-3)*Math.abs(r/n-e)}function Xc(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:\"undefined\"};if(e===0||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:\"decimal\",value:\"0\"};let r=t.smallCutoff||.001,n=t.bigCutoff||1e6,i=t.digits||10,o=_m(e.toExponential(i-2)).match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!o)return{type:\"undefined\"};let a=parseInt(o[2],10)>=i;if(OP(e)&&t.displayAsFraction){let l=Zs(e,vP(e));return{type:\"fraction\",numerator:l.n.toString(),denominator:l.d.toString()}}else{if(Math.abs(e)>n||Math.abs(e)<r||a)return{type:\"scientific\",mantissa:o[1],exponent:o[2]};{let l=EP(e.toPrecision(i));return e!==Number(l)&&t.addEllipses&&(l+=\"...\"),{type:\"decimal\",value:l}}}}function eD(e,t){let r=Xc(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\"<span class='dcg-cross'>\\xD7</span>10<sup>\"+r.exponent+\"</sup>\";case\"fraction\":return r.denominator===\"1\"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function Fm(e,t){let r=Xc(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\" * 10^\"+r.exponent;case\"fraction\":return r.denominator===\"1\"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function Vm(e,t){let r=Xc(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\"\\\\times10^{\"+r.exponent+\"}\";case\"fraction\":return r.denominator===\"1\"?r.numerator:r.numerator[0]===\"-\"?`-\\\\frac{${r.numerator.slice(1)}}{${r.denominator}}`:`\\\\frac{${r.numerator}}{${r.denominator}}`;default:return r}}function Y(e){e=e.replace(\"\\\\\",\"\");let t={pi:\"\\u03C0\",tau:\"\\u03C4\",theta:\"\\u03B8\",phi:\"\\u03D5\",div:\"\\xF7\",cdot:\"\\u22C5\",times:\"\\xD7\",lt:\"<\",gt:\">\",le:\"\\u2264\",ge:\"\\u2265\",sim:\"\\u223C\",ldots:\"\\u2026\",prime:\"\\u2032\",approx:\"\\u2248\",to:\"\\u2192\",\"->\":\"\\u2192\"};return t.hasOwnProperty(e)?t[e]:e}function tD(e){if(!e)return\"\";let t=wr(e[0]);return e[1]!==void 0&&(t+=\"\\\\left[\"+e[1]+\"\\\\right]\"),t}function wr(e){let t=e.match(/^\\$(\\d+)$/);if(t)return`\\\\token{${t[1]}}`;let r=e.split(\"_\"),n=\"\";return r[0].length>1&&(n+=\"\\\\\"),n+=r[0],r[1]&&(n+=\"_{\"+r[1]+\"}\"),n}function rD(e){if(!e)return\"\";let t=e.split(\"_\");t[0]=Y(t[0]);let r=t.map(PP);return r[1]&&(r[1]=\"<sub>\"+r[1]+\"</sub>\"),r.join(\"\")}function vs(e){let t=e.match(/\\\\token\\{(\\d+)\\}/);return t?`$${t[1]}`:(e=e.replace(/\\\\operatorname\\{(.*)\\}/,\"$1\"),e.replace(/[{}\\\\]/g,\"\"))}function Os(e){return e.replace(/^(\\\\ | |\\\\space)+/,\"\").replace(/(\\\\ | |\\\\space)+$/,\"\")}var rt=class extends k{constructor(r){super([]);this._symbol=vs(r),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(r){super.setInputSpan(r),this._errorSymbol=vs(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?Pn(this._symbol,0,this._symbol.length):this._inputSpan}};var dt={};Yi(dt,{Action:()=>ct,Add:()=>at,And:()=>Nt,BeginBroadcast:()=>Ge,BeginIntegral:()=>We,BeginLoop:()=>Xe,BlockVar:()=>ke,BroadcastResult:()=>he,Constant:()=>V,DeferredListAccess:()=>qe,Distribution:()=>it,Divide:()=>Tt,EndBroadcast:()=>vt,EndIntegral:()=>yt,EndLoop:()=>Et,Equal:()=>Ot,Exponent:()=>$e,ExtendSeed:()=>At,Greater:()=>St,GreaterEqual:()=>ht,InboundsListAccess:()=>Qe,Less:()=>gt,LessEqual:()=>ft,List:()=>ze,ListAccess:()=>Ze,LoadArg:()=>Je,MAX_LEAF_OPCODE:()=>Bm,Multiply:()=>nt,NativeFunction:()=>Ne,Negative:()=>Pt,Noop:()=>nr,Or:()=>Dt,OrderedPair:()=>ut,OrderedPairAccess:()=>It,OrderedTriple:()=>lt,OrderedTripleAccess:()=>Mt,Piecewise:()=>Re,RawExponent:()=>Ye,Subtract:()=>xt,SymbolicVar:()=>_r});var nr=0,V=1,Je=2,_r=3,Bm=3,at=8,xt=9,nt=10,Tt=11,$e=12,Ye=13,Pt=14,ut=15,lt=16,It=17,Mt=18,Xe=19,Et=20,We=21,yt=22,Ge=23,vt=24,Ot=25,gt=26,St=27,ft=28,ht=29,Dt=31,Nt=32,Re=33,Ne=37,ze=38,Ze=39,qe=40,Qe=41,it=42,At=44,ke=47,he=48,ct=49;function nD(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"never-broadcast\":return[b];case\"reducer\":return[j];case\"doubleReducer\":return[j,j];case\"parameterizedReducer\":return[j,b];case\"color\":return[b,b,b]}}function iD(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"doubleReducer\":case\"color\":case\"never-broadcast\":return!1;case\"reducer\":case\"parameterizedReducer\":return!0}}function sD(e,t,r){return e===\"reducer\"?1/0:t+r}function C(e,t,r){var c,p,f,d,m;let n=(c=r==null?void 0:r.tag)!=null?c:\"default\",i=(p=r==null?void 0:r.argumentTypes)!=null?p:nD(n),s=r!=null&&r.defaultArguments?r.defaultArguments.length:0,o=i.length-s,a=sD(n,o,s),u=(f=r==null?void 0:r.allowDotCall)!=null?f:iD(n),l=(d=r==null?void 0:r.noPeel)!=null?d:!1;return{module:e,symbol:t,argumentTypes:i,defaultArguments:r==null?void 0:r.defaultArguments,returnType:(m=r==null?void 0:r.returnType)!=null?m:b,tag:n,minArity:o,maxArity:a,allowDotCall:u,noPeel:l}}function Um(e){if(!er(e))throw new Error(\"Programming Error: numeric constants should be rational\");return{type:1,valueType:b,value:e}}var ua=Um(Me(0,1)),la=Um(Me(1,1)),qm=Um(Me(1,2));function Io(e){let t;return e in lr&&(t=lr[e].tag),t===\"trig\"||t===\"trig2\"||t===\"inverseTrig\"?!0:e===\"angle\"||e===\"angles\"||e===\"directedangle\"||e===\"directedangles\"||e===\"rotate\"}var lr={sin:C(\"BuiltIn\",\"sin\",{tag:\"trig\"}),cos:C(\"BuiltIn\",\"cos\",{tag:\"trig\"}),tan:C(\"BuiltIn\",\"tan\",{tag:\"trig\"}),cot:C(\"BuiltIn\",\"cot\",{tag:\"trig\"}),sec:C(\"BuiltIn\",\"sec\",{tag:\"trig\"}),csc:C(\"BuiltIn\",\"csc\",{tag:\"trig\"}),arcsin:C(\"Math\",\"asin\",{tag:\"inverseTrig\"}),arccos:C(\"Math\",\"acos\",{tag:\"inverseTrig\"}),arctan:C(\"Math\",\"atan2\",{argumentTypes:[b,b],defaultArguments:[la],tag:\"inverseTrig\"}),arccot:C(\"BuiltIn\",\"acot\",{tag:\"inverseTrig\"}),arcsec:C(\"BuiltIn\",\"asec\",{tag:\"inverseTrig\"}),arccsc:C(\"BuiltIn\",\"acsc\",{tag:\"inverseTrig\"}),sinh:C(\"BuiltIn\",\"sinh\"),cosh:C(\"BuiltIn\",\"cosh\"),tanh:C(\"BuiltIn\",\"tanh\"),coth:C(\"BuiltIn\",\"coth\"),sech:C(\"BuiltIn\",\"sech\"),csch:C(\"BuiltIn\",\"csch\"),arcsinh:C(\"BuiltIn\",\"asinh\"),arccosh:C(\"BuiltIn\",\"acosh\"),arctanh:C(\"BuiltIn\",\"atanh\"),arccoth:C(\"BuiltIn\",\"acoth\"),arcsech:C(\"BuiltIn\",\"asech\"),arccsch:C(\"BuiltIn\",\"acsch\"),sqrt:C(\"Math\",\"sqrt\"),rtxsqpone:C(\"BuiltIn\",\"sqrtxsqp1\"),rtxsqmone:C(\"BuiltIn\",\"sqrtxsqm1\"),nthroot:C(\"BuiltIn\",\"nthroot\",{argumentTypes:[b,b]}),hypot:C(\"BuiltIn\",\"hypot\",{argumentTypes:[b,b]}),log:C(\"BuiltIn\",\"common_log\"),logbase:C(\"BuiltIn\",\"log_base\",{argumentTypes:[b,b]}),ln:C(\"BuiltIn\",\"log\"),exp:C(\"Math\",\"exp\"),floor:C(\"Math\",\"floor\"),ceil:C(\"Math\",\"ceil\"),round:C(\"Math\",\"round\"),abs:C(\"Math\",\"abs\"),sign:C(\"BuiltIn\",\"sign\"),mod:C(\"BuiltIn\",\"mod\",{argumentTypes:[b,b]}),nCr:C(\"BuiltIn\",\"nCr\",{argumentTypes:[b,b]}),nPr:C(\"BuiltIn\",\"nPr\",{argumentTypes:[b,b]}),factorial:C(\"BuiltIn\",\"factorial\"),polyGamma:C(\"BuiltIn\",\"polyGamma\",{argumentTypes:[b,b]}),lcm:C(\"BuiltIn\",\"listLCM\",{tag:\"reducer\"}),gcd:C(\"BuiltIn\",\"listGCD\",{tag:\"reducer\"}),distance:C(\"BuiltIn\",\"distance\",{argumentTypes:[N,N]}),polygon:C(\"BuiltIn\",\"polygon\",{tag:\"reducer\",argumentTypes:[Ue],returnType:Ee}),area:C(\"BuiltIn\",\"polygonArea\",{argumentTypes:[Ee]}),perimeter:C(\"BuiltIn\",\"polygonPerimeter\",{argumentTypes:[Ee]}),pointDet:C(\"BuiltIn\",\"pointDet\",{argumentTypes:[N,N]}),pointDot:C(\"BuiltIn\",\"pointDot\",{argumentTypes:[N,N]}),pointPerp:C(\"BuiltIn\",\"pointPerp\",{argumentTypes:[N],returnType:N}),segment:C(\"BuiltIn\",\"segment\",{argumentTypes:[N,N],returnType:xe}),line:C(\"BuiltIn\",\"line\",{argumentTypes:[N,N],returnType:oe}),ray:C(\"BuiltIn\",\"ray\",{argumentTypes:[N,N],returnType:ve}),vector:C(\"BuiltIn\",\"vector\",{argumentTypes:[N,N],returnType:pe}),mathVector:C(\"BuiltIn\",\"mathVector\",{argumentTypes:[N,N],returnType:pe}),vectorDisplacementAsPoint:C(\"BuiltIn\",\"vectorDisplacementAsPoint\",{argumentTypes:[pe],returnType:N}),basePointFromVector:C(\"BuiltIn\",\"basePointFromVector\",{argumentTypes:[pe],returnType:N}),circle:C(\"BuiltIn\",\"circle\",{argumentTypes:[N,b],returnType:ue}),center:C(\"BuiltIn\",\"center\",{argumentTypes:[ue],returnType:N,allowDotCall:!0}),radius:C(\"BuiltIn\",\"radius\",{argumentTypes:[ue],returnType:b,allowDotCall:!0}),arc:C(\"BuiltIn\",\"arc\",{argumentTypes:[N,N,N],returnType:ee}),arcCenter:C(\"BuiltIn\",\"arcCenter\",{argumentTypes:[ee],returnType:N}),arcOmega:C(\"BuiltIn\",\"arcOmega\",{argumentTypes:[ee],returnType:b}),undirectedAngleMarker:C(\"BuiltIn\",\"undirectedAngleMarker\",{argumentTypes:[ye],returnType:Ie}),directedAngleMarker:C(\"BuiltIn\",\"directedAngleMarker\",{argumentTypes:[N,b,b,b],returnType:ye}),directedCoterminalAngle:C(\"BuiltIn\",\"directedCoterminalAngle\",{argumentTypes:[ye],returnType:ye}),undirectedCoterminalAngle:C(\"BuiltIn\",\"undirectedCoterminalAngle\",{argumentTypes:[Ie],returnType:Ie}),supplement:C(\"BuiltIn\",\"supplementAngle\",{argumentTypes:[ye],returnType:ye}),directedAngleMarkerRawDelta:C(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[ye],returnType:b}),undirectedAngleMarkerRawDelta:C(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[Ie],returnType:b}),directedAngleMarkerMultiplier:C(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[ye],returnType:b}),undirectedAngleMarkerMultiplier:C(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[Ie],returnType:b}),polygonInteriorUndirectedAngles:C(\"BuiltIn\",\"polygonInteriorUndirectedAngles\",{argumentTypes:[Ee,b],returnType:zt,allowDotCall:!0,tag:\"never-broadcast\"}),polygonInteriorDirectedAngles:C(\"BuiltIn\",\"polygonInteriorDirectedAngles\",{argumentTypes:[Ee,b],returnType:qt,allowDotCall:!0,tag:\"never-broadcast\"}),vertices:C(\"BuiltIn\",\"vertices\",{argumentTypes:[Ee],returnType:Ue,allowDotCall:!0,tag:\"never-broadcast\"}),segments:C(\"BuiltIn\",\"polygonEdges\",{argumentTypes:[Ee],returnType:Kt,allowDotCall:!0,tag:\"never-broadcast\"}),scaleTangentSegment:C(\"BuiltIn\",\"scaleTangentSegment\",{argumentTypes:[xe,b],returnType:xe}),scaleTangentLine:C(\"BuiltIn\",\"scaleTangentLine\",{argumentTypes:[oe,b],returnType:oe}),scaleTangentRay:C(\"BuiltIn\",\"scaleTangentRay\",{argumentTypes:[ve,b],returnType:ve}),scaleTangentCircle:C(\"BuiltIn\",\"scaleTangentCircle\",{argumentTypes:[ue,b],returnType:ue}),scaleTangentArc:C(\"BuiltIn\",\"scaleTangentArc\",{argumentTypes:[ee,b],returnType:ue}),scaleTangentDirectedAngleMarker:C(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[ye,b],returnType:ye}),scaleTangentUndirectedAngleMarker:C(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[Ie,b],returnType:Ie}),addTangentSegment:C(\"BuiltIn\",\"addTangentSegment\",{argumentTypes:[xe,xe],returnType:xe}),addTangentLine:C(\"BuiltIn\",\"addTangentLine\",{argumentTypes:[oe,oe],returnType:oe}),addTangentRay:C(\"BuiltIn\",\"addTangentRay\",{argumentTypes:[ve,ve],returnType:ve}),addTangentCircle:C(\"BuiltIn\",\"addTangentCircle\",{argumentTypes:[ue,ue],returnType:ue}),addTangentArc:C(\"BuiltIn\",\"addTangentArc\",{argumentTypes:[ee,ee],returnType:ee}),addTangentDirectedAngleMarker:C(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[ye,ye],returnType:ye}),addTangentUndirectedAngleMarker:C(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[Ie,Ie],returnType:Ie}),segmentGlider:C(\"BuiltIn\",\"segmentGlider\",{argumentTypes:[xe,b],returnType:N}),lineGlider:C(\"BuiltIn\",\"lineGlider\",{argumentTypes:[oe,b],returnType:N}),rayGlider:C(\"BuiltIn\",\"rayGlider\",{argumentTypes:[ve,b],returnType:N}),circleGlider:C(\"BuiltIn\",\"circleGlider\",{argumentTypes:[ue,b],returnType:N}),arcGlider:C(\"BuiltIn\",\"arcGlider\",{argumentTypes:[ee,b],returnType:N}),polygonGlider:C(\"BuiltIn\",\"polygonGlider\",{argumentTypes:[Ee,b],returnType:N}),chooseNonIncidentPoint:C(\"BuiltIn\",\"chooseNonIncidentPoint\",{argumentTypes:[N,N,N],returnType:N}),circleCircleIntersection:C(\"BuiltIn\",\"circleCircleIntersection\",{argumentTypes:[ue,ue,b],returnType:N}),circleArcIntersection:C(\"BuiltIn\",\"circleArcIntersection\",{argumentTypes:[ue,ee,b],returnType:N}),circleLineIntersection:C(\"BuiltIn\",\"circleLineIntersection\",{argumentTypes:[ue,oe,b],returnType:N}),arcCircleIntersection:C(\"BuiltIn\",\"arcCircleIntersection\",{argumentTypes:[ee,ue,b],returnType:N}),arcArcIntersection:C(\"BuiltIn\",\"arcArcIntersection\",{argumentTypes:[ee,ee,b],returnType:N}),arcLineIntersection:C(\"BuiltIn\",\"arcLineIntersection\",{argumentTypes:[ee,oe,b],returnType:N}),lineCircleIntersection:C(\"BuiltIn\",\"lineCircleIntersection\",{argumentTypes:[oe,ue,b],returnType:N}),lineArcIntersection:C(\"BuiltIn\",\"lineArcIntersection\",{argumentTypes:[oe,ee,b],returnType:N}),lineLineIntersection:C(\"BuiltIn\",\"lineLineIntersection\",{argumentTypes:[oe,oe,b],returnType:N}),lineFromSegment:C(\"BuiltIn\",\"identity\",{argumentTypes:[xe],returnType:oe}),lineFromRay:C(\"BuiltIn\",\"identity\",{argumentTypes:[ve],returnType:oe}),parallel:C(\"BuiltIn\",\"parallel\",{argumentTypes:[oe,N],returnType:oe}),perpendicular:C(\"BuiltIn\",\"perpendicular\",{argumentTypes:[oe,N],returnType:oe}),translation:C(\"BuiltIn\",\"translation\",{argumentTypes:[N],returnType:Ce}),dilation:C(\"BuiltIn\",\"dilation\",{argumentTypes:[N,b],returnType:Ce}),rotation:C(\"BuiltIn\",\"rotation\",{tag:\"trig2\",argumentTypes:[N,b],returnType:Ce}),reflection:C(\"BuiltIn\",\"reflection\",{argumentTypes:[oe],returnType:Ce}),compose:C(\"BuiltIn\",\"composeTransformation\",{argumentTypes:[Ce,Ce],returnType:Ce}),inverse:C(\"BuiltIn\",\"invertTransformation\",{argumentTypes:[Ce],returnType:Ce}),transformPoint:C(\"BuiltIn\",\"transformPoint\",{argumentTypes:[Ce,N],returnType:N}),transformSegment:C(\"BuiltIn\",\"transformSegment\",{argumentTypes:[Ce,xe],returnType:xe}),transformLine:C(\"BuiltIn\",\"transformLine\",{argumentTypes:[Ce,oe],returnType:oe}),transformRay:C(\"BuiltIn\",\"transformRay\",{argumentTypes:[Ce,ve],returnType:ve}),transformVector:C(\"BuiltIn\",\"transformVector\",{argumentTypes:[Ce,pe],returnType:pe}),transformCircle:C(\"BuiltIn\",\"transformCircle\",{argumentTypes:[Ce,ue],returnType:ue}),transformArc:C(\"BuiltIn\",\"transformArc\",{argumentTypes:[Ce,ee],returnType:ee}),transformPolygon:C(\"BuiltIn\",\"transformPolygon\",{argumentTypes:[Ce,Ee],returnType:Ee}),transformAngleMarker:C(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[Ce,Ie],returnType:Ie}),transformDirectedAngleMarker:C(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[Ce,ye],returnType:ye}),distance3d:C(\"BuiltIn\",\"distance3d\",{argumentTypes:[z,z]}),segment3d:C(\"BuiltIn\",\"segment3d\",{argumentTypes:[z,z],returnType:Tr}),triangle:C(\"BuiltIn\",\"triangle\",{argumentTypes:[z,z,z],returnType:dr}),sphere:C(\"BuiltIn\",\"sphere\",{argumentTypes:[z,b],returnType:Pr}),mean:C(\"BuiltIn\",\"mean\",{tag:\"reducer\"}),total:C(\"BuiltIn\",\"total\",{tag:\"reducer\"}),stdev:C(\"BuiltIn\",\"stdev\",{tag:\"reducer\"}),stdevp:C(\"BuiltIn\",\"stdevp\",{tag:\"reducer\"}),mad:C(\"BuiltIn\",\"mad\",{tag:\"reducer\"}),count:C(\"BuiltIn\",\"listLength\",{tag:\"reducer\",argumentTypes:[wt],noPeel:!0}),min:C(\"BuiltIn\",\"listMin\",{tag:\"reducer\"}),max:C(\"BuiltIn\",\"listMax\",{tag:\"reducer\"}),argmin:C(\"BuiltIn\",\"argMin\",{tag:\"reducer\",noPeel:!0}),argmax:C(\"BuiltIn\",\"argMax\",{tag:\"reducer\",noPeel:!0}),median:C(\"BuiltIn\",\"median\",{tag:\"reducer\"}),var:C(\"BuiltIn\",\"variance\",{tag:\"reducer\"}),varp:C(\"BuiltIn\",\"varp\",{tag:\"reducer\"}),cov:C(\"BuiltIn\",\"cov\",{tag:\"doubleReducer\"}),covp:C(\"BuiltIn\",\"covp\",{tag:\"doubleReducer\"}),corr:C(\"BuiltIn\",\"corr\",{tag:\"doubleReducer\"}),spearman:C(\"BuiltIn\",\"spearman\",{tag:\"doubleReducer\"}),quantile:C(\"BuiltIn\",\"quantile\",{tag:\"parameterizedReducer\"}),quartile:C(\"BuiltIn\",\"quartile\",{tag:\"parameterizedReducer\"}),upperQuantileIndex:C(\"BuiltIn\",\"upperQuantileIndex\",{tag:\"parameterizedReducer\"}),lowerQuantileIndex:C(\"BuiltIn\",\"lowerQuantileIndex\",{tag:\"parameterizedReducer\"}),quartileIndex:C(\"BuiltIn\",\"quartileIndex\",{tag:\"parameterizedReducer\"}),upperQuartileIndex:C(\"BuiltIn\",\"upperQuartileIndex\",{tag:\"parameterizedReducer\"}),lowerQuartileIndex:C(\"BuiltIn\",\"lowerQuartileIndex\",{tag:\"parameterizedReducer\"}),normalcdf:C(\"BuiltIn\",\"normalcdf\",{argumentTypes:[b,b,b,b],defaultArguments:[ua,la]}),normalpdf:C(\"BuiltIn\",\"normalpdf\",{argumentTypes:[b,b,b],defaultArguments:[ua,la]}),binomcdf:C(\"BuiltIn\",\"binomcdf\",{argumentTypes:[b,b,b,b],defaultArguments:[qm]}),binompdf:C(\"BuiltIn\",\"binompdf\",{argumentTypes:[b,b,b],defaultArguments:[qm]}),poissoncdf:C(\"BuiltIn\",\"poissoncdf\",{argumentTypes:[b,b,b]}),poissonpdf:C(\"BuiltIn\",\"poissonpdf\",{argumentTypes:[b,b,b]}),uniformcdf:C(\"BuiltIn\",\"uniformcdf\",{argumentTypes:[b,b,b,b],defaultArguments:[ua,la]}),uniformpdf:C(\"BuiltIn\",\"uniformpdf\",{argumentTypes:[b,b,b],defaultArguments:[ua,la]}),invT:C(\"BuiltIn\",\"invT\",{argumentTypes:[b,b]}),invPoisson:C(\"BuiltIn\",\"invPoisson\",{argumentTypes:[b,b]}),invBinom:C(\"BuiltIn\",\"invBinom\",{argumentTypes:[b,b,b]}),invUniform:C(\"BuiltIn\",\"invUniform\",{argumentTypes:[b,b,b]}),tpdf:C(\"BuiltIn\",\"tpdf\",{argumentTypes:[b,b]}),tcdf:C(\"BuiltIn\",\"tcdf\",{argumentTypes:[b,b,b]}),erf:C(\"BuiltIn\",\"erf\"),invNorm:C(\"BuiltIn\",\"invNorm\"),tscore:C(\"BuiltIn\",\"tscore\",{tag:\"parameterizedReducer\",defaultArguments:[ua]}),normalSample:C(\"BuiltIn\",\"normalSample\",{argumentTypes:[He,b,b]}),uniformSample:C(\"BuiltIn\",\"uniformSample\",{argumentTypes:[He,b,b]}),tSample:C(\"BuiltIn\",\"tSample\",{argumentTypes:[He,b]}),poissonSample:C(\"BuiltIn\",\"poissonSample\",{argumentTypes:[He,b]}),binomSample:C(\"BuiltIn\",\"binomSample\",{argumentTypes:[He,b,b]}),rgb:C(\"BuiltIn\",\"rgb\",{returnType:ot,tag:\"color\"}),hsv:C(\"BuiltIn\",\"hsv\",{returnType:ot,tag:\"color\"}),validateRangeLength:C(\"BuiltIn\",\"validateRangeLength\",{returnType:b,argumentTypes:[j,j,b,b],tag:\"never-broadcast\",noPeel:!0}),validateSampleCount:C(\"BuiltIn\",\"validateSampleCount\",{returnType:b,argumentTypes:[b]}),select:C(\"BuiltIn\",\"select\",{argumentTypes:[wt,Nr],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),shuffle:C(\"BuiltIn\",\"shuffle\",{argumentTypes:[He,wt],returnType:e=>e[1],tag:\"never-broadcast\"}),sortPerm:C(\"BuiltIn\",\"sortPerm\",{argumentTypes:[j],returnType:j,tag:\"never-broadcast\",noPeel:!0}),elementsAt:C(\"BuiltIn\",\"elementsAt\",{argumentTypes:[wt,j],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),uniquePerm:C(\"BuiltIn\",\"uniquePerm\",{argumentTypes:[wt],returnType:j,tag:\"never-broadcast\",noPeel:!0})};function Le(e,t){var m,y,g,h,P;let r=t==null?void 0:t.defaultArguments,n=1/0,i=0,s=(m=r==null?void 0:r.length)!=null?m:0;t!=null&&t.noBroadcast||(e=e.map(ai));for(let S of e){let A=bo(S)-s;A<n&&(n=A);let T=Qu(S);T>i&&(i=T)}let o=(y=t==null?void 0:t.fallthroughUnlessDistribution)!=null?y:!1,a=(g=t==null?void 0:t.allowDotCall)!=null?g:!1,u=(h=t==null?void 0:t.isSeeded)!=null?h:!1,l=t==null?void 0:t.minArityExampleArgs,c=t==null?void 0:t.maxArityExampleArgs,p=t==null?void 0:t.dotMinArityExampleArgs,f=t==null?void 0:t.dotMaxArityExampleArgs,d=(P=t==null?void 0:t.noPeel)!=null?P:!1;return{minArity:n,argumentTypes:e,maxArity:i,defaultArguments:r,fallthroughUnlessDistribution:o,minArityExampleArgs:l,maxArityExampleArgs:c,dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,allowDotCall:a,isSeeded:u,noPeel:d}}function ts(){return Le([{type:\"variadic\",initial:[],rest:st}],{})}var Wc={meta:\"union\",types:[xe,ue,oe,ve,ee]},Gm={meta:\"union\",types:[xe,oe,ve,pe]},nu={meta:\"union\",types:[N,xe,ue,oe,ve,pe,ee,Ee,Ie,ye,Ce]},zm={meta:\"union\",types:[...Zi.filter(e=>e!==Qt),je]},rs={midpoint:Le([[N,N],[z,z],[xe]],{allowDotCall:!0}),segment:Le([[N,N],[z,z]]),distance:Le([[N,N],[z,z]]),glider:Le([[{meta:\"union\",types:[xe,ue,oe,ve,ee,Ee]},b]]),circle:Le([[N,xe],[N,N],[N,b]],{}),center:Le([[ue],[ee]],{allowDotCall:!0}),radius:Le([[ue],[ee]],{allowDotCall:!0}),intersection:Le([[Wc,Wc]]),strictintersection:Le([[Wc,Wc]]),parallel:Le([[Gm,N]]),perpendicular:Le([[Gm,N]]),length:Le([[{meta:\"union\",types:Zi}],ai([xe]),ai([ee]),{type:\"variadic\",initial:[st],rest:st}],{allowDotCall:!0,noBroadcast:!0,noPeel:!0}),translate:Le([[nu,pe],[nu,N,N]]),dilate:Le([[nu,N,b]]),rotate:Le([[nu,N,b]]),reflect:Le([[nu,Gm]]),apply:Le([[Ce,nu]]),points:Le([]),lines:Le([]),circles:Le([]),arcs:Le([]),polygons:Le([]),rays:Le([]),vectors:Le([]),angle:Le([[N,N,N]]),directedangle:Le([[N,N,N]]),angles:Le([[Ee]],{allowDotCall:!0}),directedangles:Le([[Ee]],{allowDotCall:!0}),coterminal:Le([[Ie],[ye]]),round:Le([[b],[b,b]]),sort:Le([[{meta:\"union\",types:Zi}],[{meta:\"union\",types:Zi},j]],{minArityExampleArgs:\"([3,2,1])\",maxArityExampleArgs:\"([1,2,3],[3,2,1])\",dotMaxArityExampleArgs:\"([3,4])\",allowDotCall:!0}),shuffle:Le([[He,{meta:\"union\",types:Zi}],[He,{meta:\"union\",types:Zi},b]],{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3],2)\",dotMaxArityExampleArgs:\"(2)\",allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),join:Le([{type:\"variadic\",initial:[st,st],rest:st}],{minArityExampleArgs:\"([1,2],[3,4])\",dotMinArityExampleArgs:\"([3,4])\",allowDotCall:!0}),unique:Le([[{meta:\"union\",types:Zi.filter(e=>e!==Qt&&e!==wt)}]],{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3])\",allowDotCall:!0}),normaldist:Le([[b,b]],{defaultArguments:[ua,la]}),tdist:Le([[b]]),binomialdist:Le([[b,b]],{defaultArguments:[qm]}),poissondist:Le([[b]]),uniformdist:Le([[b,b]],{defaultArguments:[ua,la]}),pdf:Le([[je,b]],{allowDotCall:!0}),cdf:Le([[je,b],[je,b,b]],{allowDotCall:!0}),mean:Le([[je]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),median:Le([[je]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:Le([[je]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),var:Le([[je]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),quantile:Le([[je,b]],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:\"([1,2,3], 1)\",maxArityExampleArgs:\"([1,2,3], 1)\",dotMinArityExampleArgs:\"(x)\",dotMaxArityExampleArgs:\"(x)\"}),random:Le([[He],[He,b],[He,b,b],[He,zm],[He,zm,b],[He,zm,b,b]],{allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),polygon:Le([{type:\"variadic\",initial:[],rest:N},[Ue],[j,j],[b,j],[j,b]]),histogram:ts(),dotplot:ts(),boxplot:ts(),ttest:ts(),ittest:ts(),stats:ts(),det:ts(),inv:ts(),transpose:ts(),rref:ts(),trace:ts()};function iu(e){return!!rs[e]}function al(e){return!!lr[e]}function ul(e){let t=iu(e)?rs[e]:void 0;if(!t&&!al(e))return;let r=[];return t&&(r=[...t.argumentTypes]),al(e)&&(!t||t.fallthroughUnlessDistribution)&&r.push(...Hm(e)),r}function Hm(e){let t=[],r=lr[e];switch(r.tag){case\"reducer\":{if(Array.isArray(r.argumentTypes)&&typeof r.argumentTypes[0]==\"number\"&&q(r.argumentTypes[0])){let n=r.argumentTypes[0],i=Fe(n);t.push(ai({type:\"variadic\",initial:[i],rest:i}))}else throw new Error(`Programming error: declared argumentTypes for built-in function ${e} is not consistent with \"reducer\"`);break}case\"parameterizedReducer\":{t.push(r.argumentTypes),Array.isArray(r.argumentTypes)&&r.argumentTypes.length===2&&t.push([r.argumentTypes[0],ia(r.argumentTypes[1])]);break}case\"doubleReducer\":case\"never-broadcast\":{t.push(r.argumentTypes);break}default:{t.push(ai(r.argumentTypes));break}}return t}var Ir=class extends k{constructor(r,n){super(n,{skipRegisterDependencies:!0});typeof r==\"string\"&&(r=new rt(r)),this._identifier=r,this._symbol=r._symbol,this._errorSymbol=r._errorSymbol===\"logbase\"?\"log\":r._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),Io(this._symbol)&&this.addDependency(\"trigAngleMultiplier\")}copyWithArgs(r){return new this.constructor(new rt(this._symbol),r)}};var Ai=class extends k{};var Zc={pi:new rr(Math.PI),tau:new rr(2*Math.PI),e:new rr(Math.E),trigAngleMultiplier:new rr(Me(1,1)),infty:new rr(1/0),identityTransformation:new Ir(\"translation\",[new Ai([new rr(0),new rr(0)])])};var jc=class extends tt{constructor(){super(...arguments);this.isFunction=!0}},Ss,we={};for(Ss in Zc)Zc.hasOwnProperty(Ss)&&(we[Ss]=Zc[Ss]);for(Ss in lr)lr.hasOwnProperty(Ss)&&(we[Ss]=new jc);for(Ss in rs)rs.hasOwnProperty(Ss)&&(we[Ss]=new jc);function aD(e){var t={};return e.additionalFunctions&&e.additionalFunctions.indexOf(\"sqrt\")!==-1&&(t.sqrt=we.sqrt),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var km={};Yi(km,{getFrame:()=>uD});var SP=[\"pi\",\"e\",\"trigAngleMultiplier\"],DP=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"mean\",\"round\",\"stdev\",\"stdevp\",\"nCr\",\"nPr\",\"exp\",\"factorial\"];function NP(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}NP(SP,we);NP(DP,we);function uD(e){var t={};return SP.forEach(function(r){t[r]=we[r]}),DP.forEach(function(r){e.replaceRoundWithReciprocal&&r===\"round\"||(t[r]=we[r])}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var $m={};Yi($m,{getFrame:()=>lD});var AP=[\"pi\",\"e\",\"trigAngleMultiplier\"],RP=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"exp\",\"factorial\"];function CP(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}CP(AP,we);CP(RP,we);function lD(e){var t={};return AP.forEach(function(r){t[r]=we[r]}),RP.forEach(function(r){t[r]=we[r]}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var ll={};Yi(ll,{getFrame:()=>dD});var LP={count:!0,segment:!0,line:!0,ray:!0,circle:!0,arc:!0,vector:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0};var wP={segment:!0,triangle:!0,sphere:!0};var _P=[\"csc\",\"sec\",\"cot\",\"arccsc\",\"arcsec\",\"arccot\",\"csch\",\"sech\",\"coth\",\"arccsch\",\"arcsech\",\"arccoth\",\"mad\",\"cov\",\"covp\",\"distance\",\"midpoint\"],FP=[\"histogram\",\"dotplot\",\"boxplot\"],cD=[...FP,\"polygon\"],VP=[\"erf\",\"ttest\",\"tscore\",\"ittest\",\"normaldist\",\"tdist\",\"poissondist\",\"binomialdist\",\"pdf\",\"cdf\",\"random\",...FP],pD=[\"distance\",\"midpoint\"],fD=[\"det\",\"inv\",\"transpose\",\"rref\",\"trace\"],BP=Object.keys(LP).filter(function(e){return e!==\"construction\"});function Ym(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}Ym(_P,we);Ym(VP,we);Ym(BP,we);function dD(e){var t={},r;for(r in we){if(!we.hasOwnProperty(r)||e.restrictedFunctions===!0&&_P.indexOf(r)!==-1&&!(e.forceEnableGeometryFunctions===!0&&pD.indexOf(r)!==-1)||e.distributions===!1&&VP.indexOf(r)!==-1)continue;let n=BP.indexOf(r)!==-1,i=r in wP;if(n&&i){if(!(e.isGeometryCalculator||e.is3DCalculator))continue}else if(n){if(!e.isGeometryCalculator)continue}else if(i){if(!e.is3DCalculator)continue}else if(cD.indexOf(r)!==-1&&e.is3DCalculator)continue;fD.indexOf(r)===-1&&(t[r]=we[r])}return e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.globalRandomSeed&&(t.globalRandomSeed=e.globalRandomSeed),e.initialEvaluation&&(t.initialEvaluation=e.initialEvaluation),e.globalEventCount&&(t.globalEventCount=e.globalEventCount),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var qO={};Yi(qO,{parse:()=>zi,setInput:()=>xv});function GP(e){let t=function(...i){return new e(...i)};t.prototype=e.prototype;var r=Object.getOwnPropertyNames(e);for(var n of r){let i=e[n];if(typeof i==\"function\")try{t[n]=i}catch(s){}}return t}var O=class extends tt{constructor(r){super();this.isError=!0;this._msg=r,this.blocksExport=!0}evaluateOnce(r){return this._msg}getError(){return this._msg}setDependencies(r){return this.addDependencies(r),this}setActionValue(r){this.actionValue=r}allowExport(){return this.blocksExport=!1,this}setCursorContext(r){this.cursorContext=r}getCursorContext(){return this.cursorContext}};var Qc=class extends rr{constructor(){super(...arguments);this.is_mixed_number=!0}};var Kc=class extends rt{};function mD(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}var Xm=class extends k{constructor(r){super(r);this.isList=!0;this.length=r.length}asValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asValue());return r}asCompilerValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asCompilerValue());return r}getEvaluationInfo(){if(this.args.every(function(r){return r.isConstant}))return[{val:this.args.map(function(r){return r.asValue()})}]}},Ds=Xm;Ds.eachArgs=function(r,n){var i=mD(r);if(!isFinite(i)){n(r);return}for(var s=0;s<i;s++){for(var o=[],a=0;a<r.length;a++)o.push(r[a].isList||q(r[a].valueType)?r[a].elementAt(s):r[a]);n(o,s)}},Ds.wrap=function(r){return r.isList||q(r.valueType)?r:new Xm([r])};var ep=class extends k{constructor(r){super(r);this.beginning=r[0],this.end=r[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var su=class extends k{constructor(r){super(r);this.list=r[0],this.index=r[1]}};var di=class extends k{registerDependencies(){if(super.registerDependencies(),this.args[1].type===\"Identifier\"){var t=this.args[1]._symbol;Io(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var tp=class extends k{constructor(t){var r=t.map(function(n){return new rt(\"\\\\idref_{\"+n+\"}\")});super(r),this._exports.push(\"construction\")}};var rp=class extends Ai{constructor(r,n,i){super(r);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=n,this.defaultDragMode=i,this.valueType=N}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var ou=class extends k{constructor(r,n){super(n);this.symbol=r}copyWithArgs(r){return new ou(this.symbol,r)}};var au=class extends k{};var np=class extends k{};var Ri=class extends k{};var pn={\"<\":{inclusive:!1,direction:-1},\"!=\":{inclusive:!1,direction:0},\">\":{inclusive:!1,direction:1},\"<=\":{inclusive:!0,direction:-1},\"=\":{inclusive:!0,direction:0},\">=\":{inclusive:!0,direction:1}};function ca(e,t){switch(t){case-1:return e?\"<=\":\"<\";case 0:return e?\"=\":\"!=\";case 1:return e?\">=\":\">\";default:throw\"Programming error.  Comparators must have a direction of -1, 0, or 1\"}}var Ci=class extends k{constructor(r){super(r);this._difference=pn[this.operator].direction===-1?new Ri([r[1],r[0]]):new Ri([r[0],r[1]])}static create(r){class n extends Ci{}return n.prototype.operator=r,n}asComparator(){return this}isInequality(){return pn[this.operator].direction!==0}};var Ns={\"<\":Ci.create(\"<\"),\">\":Ci.create(\">\"),\"<=\":Ci.create(\"<=\"),\">=\":Ci.create(\">=\"),\"=\":Ci.create(\"=\")};var sp=class extends tt{constructor(r){super();let[n,i,s,o,a]=r;this.args=r,this._symbol=s._symbol,this._operators=[i,o],this._expressions=[n,a];var u=ca(pn[i].inclusive&&pn[r[3]].inclusive,pn[r[1]].direction);this._indicator=new Ns[u]([r[0],r[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}};var Mo=class extends k{constructor(r){super(r,{skipRegisterDependencies:!0});this._index=r[0],this.registerDependencies()}registerDependencies(){let r=this._index._symbol;this.addDummyDependency(r),this.mergeDependencies(this.args[1]),this.mergeDependencies(this.args[2]),this.mergeDependenciesInScope([r],this.args[3])}};var op=class extends Mo{constructor(){super(...arguments);this.in_place_operator=\"+=\";this.starting_value=0}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:n*r[2]}update(r,n){return r+n}};var ap=class extends Mo{constructor(){super(...arguments);this.in_place_operator=\"*=\";this.starting_value=1}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:Math.pow(r[2],n)}update(r,n){return r*n}};var up=class extends k{constructor(r){super(r,{skipRegisterDependencies:!0});this._differential=r[0],this.registerDependencies()}registerDependencies(){this.mergeDependencies(this.args[1]),this.mergeDependencies(this.args[2]),this.mergeDependenciesInScope([this._differential._symbol],this.args[3])}};var lp=class extends k{constructor(t){super(t),this._symbol=t[0]._symbol}};var cp=class extends k{constructor(r,n,i){super([r,n].concat(i),{skipRegisterDependencies:!0});this._index=r,this._body=n,this._inputLists=i,this.registerDependencies()}registerDependencies(){for(var r=[],n=0;n<this._inputLists.length;n++){var i=this._inputLists[n],s=i._symbol;this.addDummyDependency(s),r.push(s),this.mergeDependencies(i.args[1])}this.addDummyDependency(this._index._symbol),r.push(this._index._symbol),this.mergeDependenciesInScope(r,this._body)}};var pa=class extends Ir{constructor(r,n){super(r,n);this.seed=n[0]}};var pp=class extends k{registerDependencies(){if(super.registerDependencies(),this.args[0].type===\"Identifier\"){var t=this.args[0]._symbol;Io(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var fp=class extends k{registerDependencies(){if(this.addDependency(\"factorial\"),super.registerDependencies(),this.args[0].type===\"Identifier\"){var t=this.args[0]._symbol;Io(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var dp=class extends k{constructor(r,n){super(n);this.order=r}copyWithArgs(r){return new this.constructor(this.order,r)}};var ns=class extends k{static empty(){return new ns([new rr(!0),new rr(Me(1,1)),new rr(NaN)])}};var mp=class extends k{constructor(r,n){super(n);r instanceof rt?this._symbol=r._symbol:this._symbol=new rt(r)._symbol,this.addDependency(this._symbol)}};var yp=class extends k{constructor(r){super(r,{skipRegisterDependencies:!0});this._symbol=r[0]._symbol,this._expression=r[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var gp=class extends k{constructor(r,n){super([r].concat(n),{skipRegisterDependencies:!0});this._body=r,this._assignments=n,this.registerDependencies()}registerDependencies(){for(var r=[],n=0;n<this._assignments.length;n++){var i=this._assignments[n],s=i._symbol;this.addSubstitutionSymbol(s),r.push(s);var o=i.args[1];this.mergeDependencies(o),this.addSubstitutionDependencies(o.getDependencies())}this.mergeDependenciesInScope(r,this._body,{isSubstitutionBody:!0})}};var hp=class extends k{constructor(t){super(t),this._symbol=\"histogram\"}};var bp=class extends k{constructor(t){super(t),this._symbol=\"dotplot\"}};var xp=class extends k{constructor(t){super(t),this._symbol=\"boxplot\"}};var Tp=class extends k{constructor(t){super(t),this._symbol=\"ttest\"}};var Pp=class extends k{constructor(t){super(t),this._symbol=\"ittest\"}};var Ip=class extends k{constructor(t){super(t),this._symbol=\"stats\"}};var As=class extends tt{constructor(r,n){super();this.mergeDependencies(r,n),this._lhs=r,this._rhs=n,this._difference=new Ri([this._lhs,this._rhs])}asComparator(){return new Ns[\"=\"]([this._lhs,this._rhs])}};var Ks=class extends tt{constructor(r,n){super();r instanceof rt?this._symbol=r._symbol:this._symbol=r,this.mergeDependencies(n),this._expression=n,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){for(var r=this._symbol,n=this.getDependencies(),i=0;i<n.length;i++)if(n[i]===r)return[];return[r]}isEquation(r,n){return(this._symbol===\"r\"?this.graphmodeDependencies(r,n):this.getDependencies()).indexOf(this._symbol)!==-1}asEquation(){var r=new As(new rt(this._symbol),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}shouldPromoteToSlider(r){if(!this._expression.isConstant||this._expression.is_mixed_number)return!1;let n=this._expression.asValue();return typeof n!=\"number\"||!isFinite(n)?!1:r.isValidSlider(this._symbol)}};var Mp=class extends tt{constructor(r,n){super();this._symbols=r.args.map(i=>i._symbol),this._expression=n,this._concatenatedSymbol=this._symbols.join(\"\"),this.mergeDependencies(n)}asEquation(){let r=new As(new Ai(this._symbols.map(n=>new rt(n))),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}};var ir={};Yi(ir,{actionMergeFreeVariable:()=>Dy,addArgumentsToDefinition:()=>Ol,addTypeError:()=>Jm,adjacentMixedNumber:()=>Gp,adjacentNumbers:()=>Zy,andTypeError:()=>Op,ansUndefined:()=>dh,assignmentsUnsupported:()=>Cl,badImplicitCall:()=>Bp,badIntegralBoundDependency:()=>ch,badListComprehensionInputDependency:()=>bh,badLogExponent:()=>mg,badProductBoundDependency:()=>eh,badSampleSize:()=>fh,badSumBoundDependency:()=>Kg,badSymbolContext:()=>Al,badTrigExponent:()=>dg,badTupleDimensions:()=>Wy,binaryOperatorMissingOperand:()=>El,blankExpression:()=>bg,boxplotBreadthInvalid:()=>Fy,boxplotOffsetInvalid:()=>_y,cannotRedefine:()=>cu,cannotRestrict:()=>_g,cannotSubscript:()=>xg,cdfMaxInvalid:()=>Lg,cdfMaxLessThanMin:()=>wg,cdfMinInvalid:()=>Cg,cdfRequiresArguments:()=>By,cdfTooManyArguments:()=>Gy,clickableObjectAlreadyAssigned:()=>ID,clickableObjectAssignmentNotDefined:()=>PD,clickableObjectAssignmentNotIdentifier:()=>MD,clickableObjectInvalidExpression:()=>ED,colonMissingCondition:()=>hg,colorArity:()=>Hy,combineTypeError:()=>Lp,comparatorTypeError:()=>ry,complicatedDoubleInequality:()=>Zp,complicatedPolarImplicit:()=>qg,constantUnsupported:()=>ha,cycle:()=>Yp,deeplyNested:()=>Cy,dependsOnDeletedGeoObject:()=>Sh,derivativeMissingBody:()=>ah,derivativeTypeError:()=>gy,derivativeVariableTypeError:()=>hy,differentialWithSuperscript:()=>nh,distributionAsFunction:()=>Qp,divideTypeError:()=>Km,domainMaxInvalid:()=>Ag,domainMaxLessThanMin:()=>Rg,domainMinInvalid:()=>Ng,dotLHSTypeError:()=>oy,duplicateUpdateRules:()=>vy,emptyParen:()=>cg,emptyPipe:()=>fg,emptyRadical:()=>ug,emptyRadicalIndex:()=>lg,emptySquareBracket:()=>pg,emptySubscript:()=>zp,emptySuperscript:()=>ng,equationRequired:()=>jp,equationsUnsupported:()=>eo,eventHandlerTypeError:()=>hl,exponentTypeError:()=>ey,featureUnavailable:()=>Pa,fractionEmpty:()=>rg,fractionMissingDenominator:()=>tg,fractionMissingNumerator:()=>eg,fractionsUnavailable:()=>rf,functionDefinitionsUnsupported:()=>Ll,functionFreeVariable:()=>gD,functionNotDefined:()=>kp,functionTypeError:()=>En,functionUnsupported:()=>yi,geometryLengthTypeError:()=>Dp,gpuLongProduct:()=>wy,gpuLongSum:()=>Ly,gpuMaxListSize:()=>lu,gpuUnsupportedFunction:()=>Tl,gpuUnsupportedIntegral:()=>Fp,gpuVariableListLength:()=>ma,gpuVariableProduct:()=>_p,gpuVariableSum:()=>wp,heterogeneousList:()=>bl,identifierAsFunction:()=>Jy,illegalBinWidth:()=>Nl,illegalDotCall:()=>gl,implicitsDisabled:()=>zg,incorrectProductLowerBound:()=>Qg,incorrectSumLowerBound:()=>Jg,indexTypeError:()=>yl,inequalitiesDisabled:()=>Xp,inequalitiesUnsupported:()=>ba,inequalityChainTooLong:()=>Hp,integralArgumentTypeError:()=>yy,integralLowerBoundTypeError:()=>dy,integralMissingBody:()=>oh,integralMissingBound:()=>th,integralMissingDifferential:()=>rh,integralUpperBoundTypeError:()=>my,internal:()=>ae,invalidDependentFirstTableColumn:()=>yD,invalidDoubleInequalityVariables:()=>Wp,invalidFirstTableColumn:()=>kg,invalidHalfEmptyRange:()=>Wg,invalidImplicitVariables:()=>ga,invalidInequalityVariables:()=>Bg,invalidLHS:()=>Fg,invalidOperatorName:()=>sg,invalidRegressionParameter:()=>$g,invalidSubscript:()=>ig,invalidTableEntry:()=>fu,invalidTableHeader:()=>Hg,listComprehensionIncorrectInput:()=>gh,listComprehensionInputListTypeError:()=>yh,listTypeError:()=>da,logScaleBoxPlot:()=>Ry,logScaleDotPlot:()=>Ay,logScaleHistogram:()=>Ny,logScaleTypeError:()=>xl,logbaseUnsupported:()=>mh,malformedList:()=>Xy,malformedPoint:()=>Yy,matrixAddDimensions:()=>OD,matrixAssignment:()=>vD,matrixElementTypeError:()=>RD,matrixFractionalPower:()=>ND,matrixInvalidVariable:()=>CD,matrixMultiplyDimensions:()=>DD,matrixPowerDimensions:()=>AD,matrixSubtractDimensions:()=>SD,maxListSize:()=>Pl,methodRequiresList:()=>Li,mismatchedBraces:()=>uh,mismatchedDoubleInequality:()=>Ug,multiplyDefined:()=>pu,multiplyDefinedByTables:()=>Tg,multiplyTypeError:()=>pl,multiplyTypeError2D:()=>dl,multiplyTypeError3D:()=>ml,multiplyTypeErrorCross:()=>fl,negativeTypeError:()=>ty,nonArithmeticRange:()=>Dl,nonListDoubleReducer:()=>Sl,nonListParameterizedReducer:()=>Xg,nonSquareDeterminant:()=>hD,nonSquareInverse:()=>xD,nonSquareTrace:()=>bD,opaque:()=>cl,optimizationError:()=>Yg,orderedPairAccessTypeError:()=>iy,parameterAlreadyDefined:()=>$p,pdfWrongArity:()=>Vy,percentMissingOf:()=>ph,piecewiseBranchTypeError:()=>xy,piecewiseConditionTypeError:()=>by,piecewiseMissingCondition:()=>yg,piecewisePartMissingCondition:()=>gg,pointTypeError:()=>ny,pointsUnsupported:()=>Ta,polygonTwoNumbersError:()=>Il,primeWithoutParen:()=>Up,primedFunctionArity:()=>ya,productArgumentTypeError:()=>fy,productInfiniteBoundError:()=>Ap,productLowerBoundTypeError:()=>cy,productMissingBody:()=>sh,productMissingBound:()=>jg,productUpperBoundTypeError:()=>py,randomArity:()=>qy,randomFromBroadcastDistribution:()=>Uy,regressionTypeError:()=>Iy,regressionsUnsupported:()=>xa,selfReferentialFunction:()=>vl,setLogInternalErrors:()=>Zm,shadowedIndex:()=>Pg,shadowedIntegrationVariable:()=>lh,shadowedListComprehensionInput:()=>hh,singleVariableImplicitEquationsDisabled:()=>Gg,singularInverse:()=>TD,sliderLimitReferencesExport:()=>Eg,sliderMaxInvalid:()=>Og,sliderMaxLessThanMin:()=>Sg,sliderMinInvalid:()=>vg,sliderStepInvalid:()=>Dg,substitutionAmbiguousComma:()=>_l,substitutionBodyAction:()=>wD,substitutionBodyDependsOnLocalVariable:()=>vh,substitutionBodyDependsOnRegression:()=>Mh,substitutionDuplicateSymbol:()=>Oh,substitutionFunctionLHS:()=>af,substitutionIllegalLHS:()=>of,substitutionInvalidAssignments:()=>Ih,substitutionLocalLHS:()=>sf,substitutionNested:()=>uf,substitutionTypeError:()=>LD,substitutionUndefinedRHS:()=>Eh,subtractTypeError:()=>Qm,sumArgumentTypeError:()=>ly,sumInfiniteBoundError:()=>Np,sumLowerBoundTypeError:()=>ay,sumMissingBody:()=>ih,sumMissingBound:()=>Zg,sumUpperBoundTypeError:()=>uy,superscriptWithPrime:()=>ag,tableCycleWithoutGlobalDefinition:()=>Ig,tableEntryTypeError:()=>Py,tableHeaderTypeError:()=>Ty,tdistWrongArity:()=>zy,tickerMinStepNonNegativeNumber:()=>Mg,tokenWithSubscript:()=>jy,tooManyArguments:()=>Vp,tooManyVariables:()=>Ut,transformationDefinitionTypeError:()=>Sp,transformationTypeError:()=>sy,ttestListTooShort:()=>du,unaryOperatorMissingLeft:()=>Qy,unaryOperatorMissingRight:()=>Ky,unexpectedForKeyword:()=>nf,unexpectedInequality:()=>jm,unexpectedPrime:()=>qp,unexpectedSubscript:()=>og,unexpectedSymbol:()=>rn,unplottablePolarFunction:()=>Vg,unrecognizedSymbol:()=>vp,updateRuleFunctionLHS:()=>Rp,updateRuleIllegalLHS:()=>Sy,updateRuleLocalLHS:()=>Cp,updateRuleNonIdentifierLHS:()=>Ey,updateRuleTypeError:()=>My,updateRuleUndefinedLHS:()=>Oy,variableAsFunction:()=>Jp,variableLengthDistributionList:()=>wl,variableLengthProductBodyDependsOnIndex:()=>Ph,variableLengthSumBodyDependsOnIndex:()=>Th,variableLengthTopLevelList:()=>xh,variableSeed:()=>Kp,variableUnsupported:()=>tf,variablesUnsupported:()=>Rl,writeIntegral:()=>ef,wrongArity:()=>mi,wrongDoubleReducerArity:()=>Ml,wrongParameterizedReducerArity:()=>ky,zeroArgReducer:()=>$y});var qP=!1;function Zm(e){qP=e}function zP(...e){qP&&console.error(...e)}function ae(e){if(zP){let t=e instanceof Error?e:new Error(`${e}`);zP(t.stack)}return new O(M(\"shared-calculator-error-parse-error\"))}function cl(){return new O(M(\"shared-calculator-error-parse-error\"))}function vp(e){return e=Y(e),new O(M(\"shared-calculator-error-unrecognized-symbol\",{symbol:e}))}function jm(){return new O(M(\"shared-calculator-error-unexpected-inequality\"))}function rn(e){return e=Y(e),new O(M(\"shared-calculator-error-unexpected-symbol\",{symbol:e}))}function Jm(e){return new O(M(\"shared-calculator-error-add-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Qm(e){return new O(M(\"shared-calculator-error-subtract-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function pl(e){return new O(M(\"shared-calculator-error-multiply-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function fl(e){return new O(M(\"shared-calculator-error-multiply-type-error-cross\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function dl(e){return new O(M(\"shared-calculator-error-multiply-type-error-2d\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function ml(e){return new O(M(\"shared-calculator-error-multiply-type-error-3d\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Km(e){return new O(M(\"shared-calculator-error-divide-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function ey(e){return new O(M(\"shared-calculator-error-exponent-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function ty(e){return new O(M(\"shared-calculator-error-negative-type-error\",{symbol:e[0]})).allowExport()}function ry(e){return new O(M(\"shared-calculator-error-comparator-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Op(e){return new O(M(\"shared-calculator-error-and-type-error\",{symbol:\"and\",symbol1:e[0],symbol2:e[1]})).allowExport()}function da(e){return new O(M(\"shared-calculator-error-list-type-error\",{symbol1:e[0]})).allowExport()}function ny(e){return new O(M(\"shared-calculator-error-point-type-error\",{symbol1:e,symbol2:ne(N)})).allowExport()}function yl(e){return new O(M(\"shared-calculator-error-index-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function iy(e){return new O(M(\"shared-calculator-error-ordered-pair-access-type-error\",{symbol:e[0]})).allowExport()}function En(e,t){switch(t.length){case 1:return new O(M(\"shared-calculator-error-function-type-error-1\",{fn:Y(e),arg:t[0]})).allowExport();case 2:return new O(M(\"shared-calculator-error-function-type-error-2\",{fn:Y(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new O(M(\"shared-calculator-error-function-type-error-many\",{fn:Y(e)})).allowExport()}}var Wm={translate:\"translation\",rotate:\"rotation\",dilate:\"dilation\",reflect:\"reflection\"};function Sp(e,t,r){let n=[];if(!Array.isArray(r))return En(e,t);for(let s=1;s<r.length;s++){let o=r[s];typeof o==\"number\"?n.push(ne(o)):n.push(ne(o.types[0]))}let i=\"\";switch(n.length){case 1:i=M(t.length>n.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-1\":\"shared-calculator-error-transformation-definition-expected-types-1\",{arg:n[0]});break;case 2:i=M(t.length>n.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-2\":\"shared-calculator-error-transformation-definition-expected-types-2\",{arg1:n[0],arg2:n[1]});break}switch(t.length){case 1:return new O(M(t.length<n.length?\"shared-calculator-error-transformation-definition-type-error-use-more-1\":\"shared-calculator-error-transformation-definition-type-error-1\",{fn:Y(Wm[e]),arg:t[0],expectedTypeMessage:i}));case 2:return new O(M(t.length<n.length?\"shared-calculator-error-transformation-definition-type-error-use-more-2\":\"shared-calculator-error-transformation-definition-type-error-2\",{fn:Y(Wm[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:i}));default:return new O(M(\"shared-calculator-error-transformation-definition-type-error-many\",{fn:Y(Wm[e])}))}}function sy(e,t){switch(t.length){case 1:return new O(M(\"shared-calculator-error-transformation-type-error-1\",{fn:Y(e),arg:t[0]})).allowExport();case 2:return new O(M(\"shared-calculator-error-transformation-type-error-2\",{fn:Y(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new O(M(\"shared-calculator-error-transformation-type-error-many\",{fn:Y(e)})).allowExport()}}function Dp(e,t){let r=Y(e),n=Y(\"count\");return new O(M(\"shared-calculator-error-geometry-length-type-error\",{fn:r,alternativeFn:n,arg:t})).allowExport()}function gl(e){return new O(M(\"shared-calculator-error-illegal-dot-call\",{symbol:Y(e)}))}function oy(e,t){return new O(M(\"shared-calculator-error-dot-lhs-type-error\",{symbol:Y(e),type:t})).allowExport()}function ay(e){return new O(M(\"shared-calculator-error-sum-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function uy(e){return new O(M(\"shared-calculator-error-sum-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function Np(){return new O(M(\"shared-calculator-error-sum-infinite-bound-type-error\"))}function ly(e){return new O(M(\"shared-calculator-error-sum-argument-type-error\",{symbol:e[0]})).allowExport()}function cy(e){return new O(M(\"shared-calculator-error-product-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function py(e){return new O(M(\"shared-calculator-error-product-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function Ap(){return new O(M(\"shared-calculator-error-product-infinite-bound-type-error\"))}function fy(e){return new O(M(\"shared-calculator-error-product-argument-type-error\",{symbol:e[0]})).allowExport()}function dy(e){return new O(M(\"shared-calculator-error-integral-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function my(e){return new O(M(\"shared-calculator-error-integral-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function yy(e){return new O(M(\"shared-calculator-error-integral-argument-type-error\",{symbol:e[0]})).allowExport()}function gy(e){return new O(M(\"shared-calculator-error-derivative-type-error\",{symbol:e[0]})).allowExport()}function hy(e,t){return new O(M(\"shared-calculator-error-derivative-variable-type-error\",{symbol1:Y(e),symbol2:t[0]}))}function by(e){return new O(M(\"shared-calculator-error-piecewise-condition-type-error\",{symbol1:ne(me),symbol2:e[0]})).allowExport()}function xy(e){return new O(M(\"shared-calculator-error-piecewise-branch-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Ty(e){return new O(M(\"shared-calculator-error-table-header-type-error\",{symbol:e[0]}))}function Py(e){return new O(M(\"shared-calculator-error-table-entry-type-error\",{symbol:e[0]}))}function Iy(e){return new O(M(\"shared-calculator-error-regression-type-error\",{symbol1:e[0],symbol2:e[1]}))}function My(e){return new O(M(\"shared-calculator-error-update-rule-type-error\",{symbol:e}))}function Ey(){return new O(M(\"shared-calculator-error-update-rule-non-identifier-lhs\",{arrow:\"\\u2192\",example:\"a\"}))}function vy(e){return new O(M(\"shared-calculator-error-duplicate-update-rules\",{symbol:Y(e)}))}function Oy(e){return new O(M(\"shared-calculator-error-update-rule-undefined-lhs\",{symbol:Y(e)}))}function Sy(e){return new O(M(\"shared-calculator-error-update-rule-illegal-lhs\",{symbol:Y(e)}))}function Rp(e){return new O(M(\"shared-calculator-error-update-rule-function-lhs\",{symbol:Y(e)}))}function Cp(e){return new O(M(\"shared-calculator-error-update-rule-local-lhs\",{symbol:Y(e)}))}function Dy(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new O(M(\"shared-calculator-error-action-merge-free-variable\",{symbol:Y(t[0]||\"\")})).setDependencies(t).allowExport()}function hl(e){return new O(M(\"shared-calculator-error-event-handler-type-error\",{example:\"a\\u2192a+1\"}))}function bl(){return new O(M(\"shared-calculator-error-heterogeneous-list\")).allowExport()}function Lp(e){return new O(M(\"shared-calculator-error-combine-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function xl(e){return new O(M(\"shared-calculator-error-log-scale-type-error\",{symbol:e})).allowExport()}function Ny(){return new O(M(\"shared-calculator-error-log-scale-histogram\"))}function Ay(){return new O(M(\"shared-calculator-error-log-scale-dot-plot\"))}function Ry(){return new O(M(\"shared-calculator-error-log-scale-box-plot\"))}function Cy(){return new O(M(\"shared-calculator-error-deeply-nested\")).allowExport()}function ma(e){return new O(M(\"shared-calculator-error-gpu-variable-list-length\",{symbol:Y(e.filter(t=>t.symbol!==\"globalRandomSeed\")[0].symbol)}))}function wp(e){return new O(M(\"shared-calculator-error-gpu-variable-sum\",{symbol:Y(e[0].symbol)}))}function _p(e){return new O(M(\"shared-calculator-error-gpu-variable-product\",{symbol:Y(e[0].symbol)}))}function Tl(e){return new O(M(\"shared-calculator-error-gpu-function-unsupported\",{symbol:Y(e)}))}function Fp(){return new O(M(\"shared-calculator-error-gpu-integral-unsupported\"))}function Ly(){return new O(M(\"shared-calculator-error-gpu-long-sum\",{maxTermCount:1e3 .toLocaleString()}))}function wy(){return new O(M(\"shared-calculator-error-gpu-long-product\",{maxTermCount:1e3 .toLocaleString()}))}function lu(){return new O(M(\"shared-calculator-error-gpu-max-list-size\",{maxListSize:100 .toLocaleString()}))}function Pl(){return new O(M(\"shared-calculator-error-max-list-size\",{maxListSize:1e4 .toLocaleString()})).allowExport()}function Il(){return new O(M(\"shared-calculator-error-two-numbers-error\"))}function _y(){return new O(M(\"shared-calculator-error-boxplot-offset-invalid\"))}function Fy(){return new O(M(\"shared-calculator-error-boxplot-breadth-invalid\"))}function Vp(e,t){return new O(M(\"shared-calculator-error-too-many-arguments\",{symbol:e,max:t}))}function Vy(){var e=M(\"shared-calculator-error-pdf-wrong-arity-recommendation\"),t=M(\"shared-calculator-error-pdf-wrong-arity\",{recommendation:e});return new O(t)}function By(){var e=M(\"shared-calculator-error-cdf-wrong-arity-recommendation\"),t=M(\"shared-calculator-error-cdf-wrong-arity\",{recommendation:e});return new O(t)}function Gy(){var e=M(\"shared-calculator-error-cdf-too-many-arguments-recommendation\"),t=M(\"shared-calculator-error-cdf-too-many-arguments\",{recommendation:e});return new O(t)}function zy(){return new O(M(\"shared-calculator-error-tdist-wrong-arity\"))}function qy(){return new O(M(\"shared-calculator-error-random-arity\"))}function Uy(){return new O(M(\"shared-calculator-error-random-from-broadcast-distribution\"))}function Hy(e){var t=e===\"rgb\"?[150,30,100]:[180,.5,.5],r=M(\"shared-calculator-error-color-arity-recommendation\",{recommendation:Y(e)+\"(\"+t.join(\", \")+\")\"}),n=M(\"shared-calculator-error-color-arity\",{symbol:e,recommendation:r});return new O(n)}function mi(e,t,r,n){e=Y(e);var i,s;if(t===1)n||(n=e+\"(x)\"),s=M(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:n}),r>1?i=M(\"shared-calculator-error-wrong-arity-single-arg-too-many\",{dependency:e,supplement:s}):i=M(\"shared-calculator-error-wrong-arity-single-arg-too-few\",{dependency:e,supplement:s});else{var o=[];if(!n){for(var a=0;a<t;a++)o[a]=a+1;n=Y(e)+\"(\"+o.join(\", \")+\")\"}s=M(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:n}),i=M(\"shared-calculator-error-wrong-arity-many-arg\",{dependency:e,assignment_arity:t,supplement:s})}return new O(i)}function ky(e){return new O(M(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:Y(e),recommendation:Y(e)+\"([1,2,3], 1)\"}))}function Ml(e){return new O(M(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:Y(e),recommendation:Y(e)+\"([1,2,3], [3,2,1])\"}))}function ya(){return new O(M(\"shared-calculator-error-primed-function-arity\"))}function $y(e){return new O(M(\"shared-calculator-error-zero-arg-reducer\",{symbol:Y(e)}))}function Yy(){return new O(M(\"shared-calculator-error-malformed-point\"))}function Xy(){return new O(M(\"shared-calculator-error-malformed-list\"))}function Wy(e){return new O(M(\"shared-calculator-error-bad-tuple-dimensions\",{symbol:e}))}function Bp(e){return e=Y(e),new O(M(\"shared-calculator-error-bad-implicit-call\",{symbol:e}))}function Zy(e,t){return new O(M(\"shared-calculator-error-adjacent-numbers\",{left:e,right:t}))}function Gp(e){return new O(M(\"shared-calculator-error-adjacent-mixed-number\",{mixedNumber:e}))}function jy(){return new O(M(\"shared-calculator-error-token-with-subscript\"))}function Jy(e){return e=Y(e),new O(M(\"shared-calculator-error-identifier-as-function\",{symbol:e}))}function El(e){return e=Y(e),e===\"%\"&&(e=\"% of\"),new O(M(\"shared-calculator-error-binary-operator-missing-operand\",{symbol:e}))}function Qy(e){return e=Y(e),new O(M(\"shared-calculator-error-unary-operator-missing-left\",{symbol:e}))}function Ky(e){return e=Y(e),new O(M(\"shared-calculator-error-unary-operator-missing-right\",{symbol:e}))}function eg(){return new O(M(\"shared-calculator-error-fraction-missing-numerator\"))}function tg(){return new O(M(\"shared-calculator-error-fraction-missing-denominator\"))}function rg(){return new O(M(\"shared-calculator-error-fraction-empty\"))}function zp(){return new O(M(\"shared-calculator-error-empty-subscript\"))}function ng(){return new O(M(\"shared-calculator-error-empty-superscript\"))}function ig(e){return e=Y(e),new O(M(\"shared-calculator-error-invalid-subscript\",{symbol:e}))}function sg(){return new O(M(\"shared-calculator-error-invalid-operator-name\"))}function og(){return new O(M(\"shared-calculator-error-unexpected-subscript\"))}function ag(){return new O(M(\"shared-calculator-error-superscript-with-prime\"))}function qp(){return new O(M(\"shared-calculator-error-unexpected-prime\"))}function Up(){return new O(M(\"shared-calculator-error-prime-without-paren\"))}function ug(){return new O(M(\"shared-calculator-error-empty-radical\"))}function lg(){return new O(M(\"shared-calculator-error-empty-radical-index\"))}function cg(){return new O(M(\"shared-calculator-error-empty-paren\"))}function pg(){return new O(M(\"shared-calculator-error-empty-square-bracket\"))}function fg(){return new O(M(\"shared-calculator-error-empty-pipe\"))}function dg(e){var t=e+\"^2\",r=e+\"^-1\";return new O(M(\"shared-calculator-error-bad-trig-exponent\",{form1:t,form2:r}))}function mg(e){var t=e+\"^2\";return new O(M(\"shared-calculator-error-bad-log-exponent\",{form:t}))}function Hp(){return new O(M(\"shared-calculator-error-inequality-chain-too-long\"))}function yg(){return new O(M(\"shared-calculator-error-piecewise-missing-condition\"))}function gg(){return new O(M(\"shared-calculator-error-piecewise-part-missing-condition\"))}function hg(){return new O(M(\"shared-calculator-error-colon-missing-condition\"))}function bg(){return new O(M(\"shared-calculator-error-blank-expression\"))}function kp(e){return e=Y(e),new O(M(\"shared-calculator-error-function-not-defined\",{dependency:e}))}function $p(e){return e=Y(e),new O(M(\"shared-calculator-error-parameter-already-defined\",{dependency:e}))}function cu(e,t){return e=Y(e),t===void 0?new O(M(\"shared-calculator-error-cannot-redefine\",{symbol:e})):new O(M(\"shared-calculator-error-cannot-redefine-root\",{symbol:e,symbolRoot:t}))}function xg(e){return e=Y(e),new O(M(\"shared-calculator-error-cannot-subscript\",{symbol:e}))}function pu(e){return e=Y(e),new O(M(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function Tg(e){let t=pu(e);return t.isMultiplyDefinedByTables=!0,t}function Pg(e){return e=Y(e),new O(M(\"shared-calculator-error-shadowed-index\",{symbol:e}))}function Yp(e){e=e.map(Y);var t=e.pop()||\"\";return new O(M(\"shared-calculator-error-dependency-cycle\",{symbols:e.join(\"', '\"),lastSymbol:t}))}function Ig(e){let t=Yp(e);return t.isTableCycleWithoutGlobalDefinition=!0,t}function vl(e){return new O(M(\"shared-calculator-error-self-referential-function\",{symbol:Y(e)}))}function Mg(){return new O(M(\"shared-calculator-error-ticker-min-step-nonnegative\"))}function Eg(e){return new O(M(\"shared-calculator-error-slider-limit-references-export\",{symbol:Y(e)}))}function vg(){return new O(M(\"shared-calculator-error-slider-min-invalid\"))}function Og(){return new O(M(\"shared-calculator-error-slider-max-invalid\"))}function Sg(){return new O(M(\"shared-calculator-error-slider-max-less-than-min\"))}function Dg(){return new O(M(\"shared-calculator-error-slider-step-invalid\"))}function Ng(){return new O(M(\"shared-calculator-error-domain-min-invalid\"))}function Ag(){return new O(M(\"shared-calculator-error-domain-max-invalid\"))}function Rg(){return new O(M(\"shared-calculator-error-domain-max-less-than-min\"))}function Cg(){return new O(M(\"shared-calculator-error-cdf-min-invalid\"))}function Lg(){return new O(M(\"shared-calculator-error-cdf-max-invalid\"))}function wg(){return new O(M(\"shared-calculator-error-cdf-max-less-than-min\"))}function Ut(e){if(e=e.map(Y),e.length===0)return new O(M(\"shared-calculator-error-too-many-variables-no-symbols\"));var t=e.pop()||\"\";return e.length>0?new O(M(\"shared-calculator-error-too-many-variables-many-symbols\",{variables:e.join(\"', '\"),lastVariable:t})):new O(M(\"shared-calculator-error-too-many-variables-one-symbol\",{variable:t}))}function _g(e){return new O(M(\"shared-calculator-error-cannot-restrict\",{variable:Y(e)}))}function Ol(e,t,r){e=e.map(Y),t=Y(t),r=r.map(Y);var n=t+\"(\"+r.join(\",\")+\",\"+e.join(\",\")+\")\",i=e.pop()||\"\",s={symbols:e.join(\"', '\"),lastSymbol:i,newSignature:n};return e.length?new O(M(\"shared-calculator-error-add-arguments-to-definition-many\",s)):new O(M(\"shared-calculator-error-add-arguments-to-definition-one\",s))}function Fg(e){return e=Y(e),new O(M(\"shared-calculator-error-invalid-lhs\",{symbol:e}))}function Vg(){return new O(M(\"shared-calculator-error-unplottable-polar-function\"))}function Bg(){return new O(M(\"shared-calculator-error-invalid-inequality-variables\"))}function ga(){return new O(M(\"shared-calculator-error-invalid-implicit-variables\"))}function Gg(){return new O(M(\"shared-calculator-error-single-variable-implicit-equations-disabled\"))}function zg(){return new O(M(\"shared-calculator-error-implicits-disabled\"))}function Xp(){return new O(M(\"shared-calculator-error-inequalities-disabled\"))}function qg(){return new O(M(\"shared-calculator-error-complicated-polar-implicit\"))}function Wp(){return new O(M(\"shared-calculator-error-invalid-double-inequality-variables\"))}function Ug(){return new O(M(\"shared-calculator-error-mismatched-double-inequality\",{example:\"1 < y < 2\"}))}function Zp(){return new O(M(\"shared-calculator-error-complicated-double-inequality\"))}function jp(e){return e?(e=Y(e),new O(M(\"shared-calculator-error-equation-required-symbol\",{lhs:e+\"=\"}))):new O(M(\"shared-calculator-error-equation-required\"))}function Jp(e){return e=Y(e),new O(M(\"shared-calculator-error-variable-as-function\",{dependency:e}))}function Qp(e){return e=Y(e),new O(M(\"shared-calculator-error-distribution-as-function\",{symbol:e}))}function Hg(e){return new O(M(\"shared-calculator-error-invalid-table-header\",{supplement:e}))}function fu(e){return new O(M(\"shared-calculator-error-invalid-table-entry\",{supplement:e}))}function kg(){return new O(M(\"shared-calculator-error-invalid-first-table-column\",{most:\"'y', 'r',\",last:\"'\\u03B8'\"}))}function yD(){return new O(M(\"shared-calculator-error-invalid-dependent-first-table-column\"))}function $g(e){return new O(M(\"shared-calculator-error-invalid-regression-parameter\",{symbol:Y(e)}))}function Yg(){return new O(M(\"shared-calculator-error-optimization-error\"))}function Sl(e){return new O(M(\"shared-calculator-error-non-list-double-reducer\",{symbol:Y(e),recommendation:Y(e)+\"([1,2,3], [3,2,1])\"})).allowExport()}function Xg(e){return new O(M(\"shared-calculator-error-non-list-parameterized-reducer\",{symbol:Y(e),recommendation:Y(e)+\"([1,2,3], 1)\"})).allowExport()}function Li(e){return new O(M(\"shared-calculator-error-method-requires-list\",{symbol:Y(e),recommendation:Y(e)+\"([1,2,3])\"})).allowExport()}function gD(e,t){return new O(M(\"shared-calculator-error-variable-function-free-variable\",{functionSymbol:e,variableSymbol:t})).allowExport()}function Dl(){return new O(M(\"shared-calculator-error-non-arithmetic-range\")).allowExport()}function Wg(){return new O(M(\"shared-calculator-error-invalid-half-empty-range\"))}function Zg(){return new O(M(\"shared-calculator-error-sum-missing-bound\"))}function jg(){return new O(M(\"shared-calculator-error-product-missing-bound\"))}function Jg(){return new O(M(\"shared-calculator-error-incorrect-sum-lower-bound\"))}function Qg(){return new O(M(\"shared-calculator-error-incorrect-product-lower-bound\"))}function Kg(e){return new O(M(\"shared-calculator-error-bad-sum-bound-dependency\",{symbol:Y(e)}))}function eh(e){return new O(M(\"shared-calculator-error-bad-product-bound-dependency\",{symbol:Y(e)}))}function th(){return new O(M(\"shared-calculator-error-integral-missing-bound\"))}function rh(){return new O(M(\"shared-calculator-error-integral-missing-differential\"))}function nh(){return new O(M(\"shared-calculator-error-differential-with-superscript\"))}function ih(){return new O(M(\"shared-calculator-error-sum-missing-body\"))}function sh(){return new O(M(\"shared-calculator-error-product-missing-body\"))}function oh(){return new O(M(\"shared-calculator-error-integral-missing-body\"))}function ah(){return new O(M(\"shared-calculator-error-derivative-missing-body\"))}function uh(e,t){return e=Y(e),t=Y(t),new O(M(\"shared-calculator-error-mismatched-braces\",{symbol1:e,symbol2:t}))}function lh(e){return new O(M(\"shared-calculator-error-shadowed-integration-variable\",{symbol:Y(e)}))}function ch(e){return new O(M(\"shared-calculator-error-bad-integral-bound-dependency\",{symbol:Y(e)}))}function ph(){return new O(M(\"shared-calculator-error-percent-missing-of\"))}function Nl(e){return e=Y(e),new O(M(\"shared-calculator-error-illegal-bin-width\",{symbol:e}))}function du(e){return e=Y(e),new O(M(\"shared-calculator-error-ttest-list-too-short\",{symbol:e}))}function fh(){return new O(M(\"shared-calculator-error-bad-sample-size\"))}function Kp(e){return new O(M(\"shared-calculator-error-variable-seed\",{symbol:Y(e[0].symbol)})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol)).allowExport()}function Al(e){return new O(M(\"shared-calculator-error-bad-symbol-context\",{symbol:Y(e)}))}function ef(){return new O(M(\"shared-calculator-error-write-integral\",{command:\"integral\",symbol:\"\\u222B\"}))}function dh(){return new O(M(\"shared-calculator-error-ans-undefined\"))}function Rl(e){return new O(M(\"shared-calculator-error-variables-unsupported\",{variable:Y(e)}))}function yi(e){return new O(M(\"shared-calculator-error-function-unsupported\",{symbol:Y(e)}))}function mh(){return new O(M(\"shared-calculator-error-logbase-unsupported\"))}function ha(e){return new O(M(\"shared-calculator-error-constant-unsupported\",{symbol:Y(e)}))}function tf(e){return new O(M(\"shared-calculator-error-variable-unsupported\",{symbol:Y(e)}))}function Cl(){return new O(M(\"shared-calculator-error-assignments-unsupported\"))}function Ll(){return new O(M(\"shared-calculator-error-function-definition-unsupported\"))}function eo(){return new O(M(\"shared-calculator-error-equations-unsupported\"))}function ba(){return new O(M(\"shared-calculator-error-inequalities-unsupported\"))}function xa(){return new O(M(\"shared-calculator-error-regressions-unsupported\"))}function Ta(){return new O(M(\"shared-calculator-error-points-unsupported\"))}function Pa(){return new O(M(\"shared-calculator-error-feature-unavailable\"))}function rf(){return new O(M(\"basic-calculator-error-fractions-unavailable\"))}function hD(){return new O(M(\"shared-calculator-error-non-square-determinant\"))}function bD(){return new O(M(\"shared-calculator-error-non-square-trace\"))}function xD(){return new O(M(\"shared-calculator-error-non-square-inverse\"))}function TD(){return new O(M(\"shared-calculator-error-non-singular-inverse\"))}function PD(e){return new O(M(\"shared-calculator-error-clickable-object-assignment-not-defined\",{symbol:e}))}function ID(e){return new O(M(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function MD(){return new O(M(\"shared-calculator-error-clickable-object-assignment-not-identifier\"))}function ED(){return new O(M(\"shared-calculator-error-clickable-object-invalid-expression\"))}function vD(){return new O(M(\"shared-calculator-error-matrix-assignment\"))}function OD(){return new O(M(\"shared-calculator-error-matrix-add-dimensions\"))}function SD(){return new O(M(\"shared-calculator-error-matrix-subtract-dimensions\"))}function DD(){return new O(M(\"shared-calculator-error-matrix-multiply-dimensions\"))}function ND(){return new O(M(\"shared-calculator-error-matrix-fractional-power\"))}function AD(){return new O(M(\"shared-calculator-error-matrix-power-dimensions\"))}function RD(e){return new O(M(\"shared-calculator-error-matrix-element-type-error\",{arg:e[0]}))}function CD(e){return new O(M(\"shared-calculator-error-matrix-invalid-variable\",{symbol:Y(e)}))}function yh(e,t){return new O(M(\"shared-calculator-error-list-comprehension-input-type-error\",{identifier:e,actual:t})).allowExport()}function gh(){return new O(M(\"shared-calculator-error-incorrect-list-comprehension-input\"))}function nf(){return new O(M(\"shared-calculator-error-unexpected-for-keyword\"))}function hh(e){return e=Y(e),new O(M(\"shared-calculator-error-shadowed-list-comprehension-input\",{symbol:e}))}function bh(e){return e=Y(e),new O(M(\"shared-calculator-error-bad-list-comprehension-input-dependency\",{symbol:e}))}function xh(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new O(M(\"shared-calculator-error-variable-length-top-level-list\",{symbol:Y(t[0]||\"\")})).setDependencies(t).allowExport()}function wl(e){return new O(M(\"shared-calculator-error-variable-length-distribution-list\",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol))}function Th(e){return new O(M(\"shared-calculator-error-variable-length-sum-body-depends-on-index\",{symbol:e}))}function Ph(e){return new O(M(\"shared-calculator-error-variable-length-product-body-depends-on-index\",{symbol:e}))}function LD(e,t){return new O(M(\"shared-calculator-error-substitution-type-error\",{actual:ne(e),expected:ne(t)}))}function Ih(){return new O(M(\"shared-calculator-error-substitution-invalid-assignments\"))}function sf(e){return new O(M(\"shared-calculator-error-substitution-local-lhs\",{symbol:e}))}function of(e){return new O(M(\"shared-calculator-error-substitution-illegal-lhs\",{symbol:e}))}function af(e){return new O(M(\"shared-calculator-error-substitution-function-lhs\",{symbol:e}))}function Mh(e){return new O(M(\"shared-calculator-error-substitution-body-regression-parameter-dependency\",{symbol:e}))}function Eh(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new O(M(\"shared-calculator-error-substitution-undefined-rhs\",{symbol:t[0]})).setDependencies(t)}function vh(e){return new O(M(\"shared-calculator-error-substitution-body-local-variable-dependency\",{symbol:e}))}function wD(){return new O(M(\"shared-calculator-error-substitution-body-action\"))}function uf(){return new O(M(\"shared-calculator-error-substitution-nested\"))}function _l(){return new O(M(\"shared-calculator-error-substitution-ambiguous-comma\"))}function Oh(e){return new O(M(\"shared-calculator-error-substitution-duplicate-assignment\",{symbol:e}))}function Sh(){return new O(M(\"shared-calculator-error-depends-on-deleted-geo-object\"))}var to=class extends tt{constructor(r,n,i){super();this.isFunction=!0;this._symbol=r._symbol,this._argSymbols=n.map(function(s){return s._symbol}),this._exports=[this._symbol],this._expression=i,this.mergeDependenciesInScope(this._argSymbols,this._expression)}getConcreteInvocationTree(r,n,i,s){if(i.length!==this._argSymbols.length)throw mi(s,this._argSymbols.length,i.length);for(var o=Object.create(n),a=0;a<this._argSymbols.length;a++)o[this._argSymbols[a]]=i[a];return this._expression.getConcreteTree(r,o)}getSliderVariables(r,n){var i=this._argSymbols;return super.getSliderVariables(r,n).filter(function(s){return i.indexOf(s)===-1})}asEquation(){var r=this._argSymbols.map(function(i){return new rt(i)}),n=new As(new Ir(new rt(this._symbol),r),this._expression);return n.userData=this.userData,n.metaData=this.metaData,n}};var lf=class extends tt{constructor(r,n){super();this.isRegression=!0;this._lhs=r,this.isLhsSimple=r instanceof rt,this._logLhs=new Ir(\"ln\",[r]),this._rhs=n,this._difference=new Ri([r,n]),this._logDifference=new Ri([new Ir(\"ln\",[r]),new Ir(\"ln\",[n])]),this.mergeDependencies(r,n)}exportTo(r,n,i){if(!n.isError){for(var s in n.parameters)n.parameters.hasOwnProperty(s)&&(r.assignmentForbidden(s)||(i[s]=i[s]?pu(s):n.parameters[s]));r.assignmentForbidden(n.residualVariable)||(i[n.residualVariable]=n.residuals)}}getSliderVariables(){return[]}};var cf=class extends tt{constructor(r,n){super();this.isImage=!0;this.center=r.center,this.radianAngle=r.radianAngle,this.width=r.width,this.height=r.height,this.opacity=r.opacity,this.moveStrategy=n,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}};var pf=class extends tt{constructor(r){super();this.handler=r.handler,this.minStep=r.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var ff=class extends Ks{constructor(r,n){super(new rt(r._symbol),r._expression);this.isSlider=!0;this.setInputSpan(r._inputSpan),this.sliderAssignment=r,this.sliderMin=n.sliderMin,this.sliderMax=n.sliderMax,this.sliderSoftMin=n.sliderSoftMin,this.sliderSoftMax=n.sliderSoftMax,this.sliderStep=n.sliderStep,this.sliderIsPlayingOnce=n.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(r){return!1}asAssignment(){return new Ks(this._symbol,this._expression)}};var df=class extends k{constructor(r){let n=new rr(r);super([n]);this._constantNode=n}asValue(){return this._constantNode.asValue()}asCompilerValue(){return this._constantNode.asCompilerValue()}};var mf=class extends tt{constructor(r){super();this.exportPenalty=1;this.isTable=!0;this.columns=r,this.mergeDependencies.apply(this,r)}getExports(r){let n=[];for(var i=0;i<this.columns.length;i++)Array.prototype.push.apply(n,this.columns[i].getExports(r));return n}exportTo(r,n,i){for(var s=0;s<this.columns.length;s++){var o=this.columns[s].getExports(r);if(o.length){var a=o[0];r.assignmentForbidden(a)||i[a]||(n.isError?i[a]=n:this.columns[s].exportTo(r,n.columns[s],i))}}}getAllIds(){return this.columns.map(function(r){return r.header.userData.id})}};function _D(e){return e.isConstant?new rr(e.asCompilerValue()):new rr(NaN)}var Ia=class extends tt{constructor(r,n){super();this.header=r,this.values=n,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)}computeExports(){return this.header instanceof rt?[this.header._symbol]:[]}_exportSymbolsTo(r,n,i){if(r.length){var s=r[0];if(n.isError)i[s]=n;else try{i[s]=new Ds(n.values.map(_D))}catch(o){if(o instanceof tt)i[s]=o;else throw o}}}exportTo(r,n,i){var s=this.getLegalExports(r);this._exportSymbolsTo(s,n,i)}exportToLocal(r,n,i){this._exportSymbolsTo(this.getExports(r),n,i)}};var yf=class extends tt{constructor(r,n,i,s){super();this._symbol=r,this._expression=n,this.otherVariableSolutionData=i,this.mergeDependencies(n),this.branchMultiplier=s}};var gf=class extends tt{constructor(r,n,i,s,o){super();this.parameters=r,this.residuals=n,this.statistics=i,this.model=s,this.isModelValid=o.isModelValid,this.residualVariable=o.residualVariable,this.residualSuggestionId=o.residualSuggestionId,this.shouldSuggestLogMode=o.shouldSuggestLogMode,this.isLinear=o.isLinear,this.parameterWarning=o.parameterWarning,this._exports=[this.residualVariable];for(var a in r)r.hasOwnProperty(a)&&this._exports.push(a);this.mergeDependencies(s)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};var hf=class extends k{constructor(r){typeof r!=\"string\"&&(r=\"\"+r);super([]);this.isString=!0;this._stringValue=r}asValue(){return this._stringValue}};var bf=class extends k{constructor(r,n){super(n);this.seed=n[0],this.userSeed=n[1],this.tag=r}asValue(){return this.seed.asValue()+\"::\"+this.tag+this.userSeed.asValue()}copyWithArgs(r){return new this.constructor(this.tag,r)}};function Ma(e){return typeof e!=\"object\"||!e?!1:e.type===\"Action\"}function _t(e,t){let r=e.getInstruction(t);switch(r.type){case 1:return is(r.value);default:throw new Error(`Unexpected opcode ${r.type}.`)}}function is(e){if(Array.isArray(e))return e.map(is);switch(typeof e){case\"boolean\":case\"number\":case\"string\":return e;case\"object\":if(Ma(e)){let t={};for(let r in e.updateRules){let n=e.updateRules[r];t[r]={value:is(n.value),valueType:n.valueType}}return{type:\"Action\",updateRules:t}}else return B(e);default:throw new Error(\"Unexpected value: \"+e)}}function UP(e){switch(e){case me:case b:case N:case z:case Tr:case dr:case Pr:case Be:case ot:case Ee:case xe:case ue:case ee:case oe:case ve:case pe:case Ie:case ye:case Ce:return!0;case st:case je:case wt:case j:case Nr:case Ue:case zr:case qr:case Ar:case Ur:case Qt:case Oe:case oi:case He:case Or:case ur:case Kt:case gr:case hr:case br:case xr:case Sr:case zt:case qt:case Gr:return!1;default:let t=e;throw new Error(`Unexpected valueType: ${t}`)}}function gi(e){switch(e){case b:return NaN;case N:return[NaN,NaN];case z:return[NaN,NaN,NaN];case Tr:return[[NaN,NaN,NaN],[NaN,NaN,NaN]];case dr:return[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]];case Pr:return[[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]],NaN];case ot:return[NaN,NaN,NaN];case Be:return{type:\"Action\",updateRules:{}};case xe:case ve:case oe:return[[NaN,NaN],[NaN,NaN]];case pe:return[[NaN,NaN],[NaN,NaN]];case ue:return[[NaN,NaN],NaN];case ee:return[[NaN,NaN],[NaN,NaN],[NaN,NaN]];case me:return!1;case Ee:return[];case Ce:return[[NaN,NaN],[NaN,NaN],!1];case Ie:case ye:return[[NaN,NaN],NaN,NaN];default:let t=e;throw new Error(`${t} does not have a NaN type.`)}}function VD(e){for(var t=0;t<this.length;t++)e(this.elementAt(t),t)}function BD(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r),r));return t}var Zt=class extends tt{constructor(r){super();this.isError=!1;this.eachElement=VD;this.mapElements=BD;if(r.getError())throw new Error(\"Programming error: IRExpression should not be constructed with an error chunk\");if(this._chunk=r,this.valueType=r.getReturnType(),this.addDependencies(r.getLiveArgNames()),this.isList=q(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw xh(r.getListLengthDependencies());var n=r.isConstant();this.isConstant=n&&(this.valueType===b||this.valueType===me),this.isTypedConstant=n,this.isEmptyAction=n&&this.valueType===Be&&Object.keys(r.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(r){return this._chunk.getCompiledFunction(r)}getRestrictedFunctionForGLSL(r){return this._chunk.getRestrictedFunctionForGLSL(r)}polynomialOrder(r){return this._chunk.polynomialOrder(r,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(r){for(var n=this._chunk.getPolynomialCoefficients(r),i=n.chunk,s=n.coefficients,o=[],a=0;a<s.length;a++){var u=i.copy();u.setReturnIndex(s[a]),u.close(),o.push(new Zt(u))}return o}takeDerivative(r){var n=this._chunk.copy().takeDerivative(r).close();return new Zt(n)}gradient(r){var n=this._chunk.copy().gradient(r).close();return new Zt(n)}interpretWithParameters(r){let n,i=this._chunk.argNames;if(r.length===i.length)n=r;else{n=[];let s=this.getDependencies();for(let o=0,a=0;o<i.length;o++)s[a]===i[o]?(n.push(r[a]),a+=1):n.push(void 0)}return this._chunk.interpretWithParameters(n)}substituteConstantArguments(r){return new Zt(this._chunk.substituteConstantArguments(r))}boundDomain(r){return this._chunk.boundDomain(r)}asValue(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){for(var r=[],n=is(gi(Fe(this.valueType))),i=0;i<this.length;i++)r.push(n);return r}else return is(gi(this.valueType))}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()==\"number\"&&isNaN(this.asValue())}getEvaluationInfo(){return this._chunk.isConstant()&&this.getDependencies().length===0&&(re(this.valueType,b)||re(this.valueType,me))?[{val:this.asValue()}]:!1}findLinearSubset(r){return this._chunk.findLinearSubset(r)}deriveRegressionRestrictions(){var r=this._chunk.deriveRegressionRestrictions();return r===this._chunk?this:new Zt(r)}getCursorContext(){return this._chunk.getCursorContext()}};var xf=class extends k{};var Tf=class extends k{};var mu=class extends k{};var Pf=class extends k{};var If=class extends k{};var yu=class extends k{};var Mf=class extends k{};var Ef=class extends k{isInequality(){return this.args[0].isInequality()&&this.args[1].isInequality()}};var vf=class extends k{};var Of=class extends yu{};function Q(e,t){let r=GP(e);return r.prototype.type=t,r}var GD={Base:Q(tt,\"Base\"),Expression:Q(k,\"Expression\"),Error:Q(O,\"Error\"),Constant:Q(rr,\"Constant\"),MixedNumber:Q(Qc,\"MixedNumber\"),Identifier:Q(rt,\"Identifier\"),Ans:Q(Kc,\"Ans\"),List:Q(Ds,\"List\"),Range:Q(ep,\"Range\"),ListAccess:Q(su,\"ListAccess\"),DotAccess:Q(di,\"DotAccess\"),Construction:Q(tp,\"Construction\"),ParenSeq:Q(Ai,\"ParenSeq\"),MovablePoint:Q(rp,\"MovablePoint\"),NamedCoordinateAccess:Q(ou,\"NamedCoordinateAccess\"),BareSeq:Q(au,\"BareSeq\"),Norm:Q(np,\"Norm\"),BaseComparator:Q(Ci,\"BaseComparator\"),DoubleInequality:Q(sp,\"DoubleInequality\"),RepeatedOperator:Q(Mo,\"RepeatedOperator\"),Sum:Q(op,\"Sum\"),Product:Q(ap,\"Product\"),Integral:Q(up,\"Integral\"),AssignmentExpression:Q(lp,\"AssignmentExpression\"),ListComprehension:Q(cp,\"ListComprehension\"),FunctionCall:Q(Ir,\"FunctionCall\"),SeededFunctionCall:Q(pa,\"SeededFunctionCall\"),FunctionExponent:Q(pp,\"FunctionExponent\"),FunctionFactorial:Q(fp,\"FunctionFactorial\"),Prime:Q(dp,\"Prime\"),Piecewise:Q(ns,\"Piecewise\"),Derivative:Q(mp,\"Derivative\"),UpdateRule:Q(yp,\"UpdateRule\"),Substitution:Q(gp,\"Substitution\"),Histogram:Q(hp,\"Histogram\"),DotPlot:Q(bp,\"DotPlot\"),BoxPlot:Q(xp,\"BoxPlot\"),TTest:Q(Tp,\"TTest\"),IndependentTTest:Q(Pp,\"IndependentTTest\"),Stats:Q(Ip,\"Stats\"),Assignment:Q(Ks,\"Assignment\"),CoordinateEquation:Q(Mp,\"CoordinateEquation\"),FunctionDefinition:Q(to,\"FunctionDefinition\"),Equation:Q(As,\"Equation\"),Regression:Q(lf,\"Regression\"),Image:Q(cf,\"Image\"),Ticker:Q(pf,\"Ticker\"),Slider:Q(ff,\"Slider\"),RegressionParameter:Q(df,\"RegressionParameter\"),Table:Q(mf,\"Table\"),TableColumn:Q(Ia,\"TableColumn\"),SolvedEquation:Q(yf,\"SolvedEquation\"),OptimizedRegression:Q(gf,\"OptimizedRegression\"),Seed:Q(hf,\"Seed\"),ExtendSeed:Q(bf,\"ExtendSeed\"),IRExpression:Q(Zt,\"IRExpression\"),Add:Q(xf,\"Add\"),Subtract:Q(Ri,\"Subtract\"),Multiply:Q(Tf,\"Multiply\"),DotMultiply:Q(mu,\"DotMultiply\"),CrossMultiply:Q(Pf,\"CrossMultiply\"),Divide:Q(If,\"Divide\"),Exponent:Q(yu,\"Exponent\"),Negative:Q(Mf,\"Negative\"),And:Q(Ef,\"And\"),PercentOf:Q(vf,\"PercentOf\"),RawExponent:Q(Of,\"RawExponent\"),Comparator:{\"<\":Q(Ns[\"<\"],\"Comparator['<']\"),\">\":Q(Ns[\">\"],\"Comparator['>']\"),\"<=\":Q(Ns[\"<=\"],\"Comparator['<=']\"),\">=\":Q(Ns[\">=\"],\"Comparator['>=']\"),\"=\":Q(Ns[\"=\"],\"Comparator['=']\")}},x=GD;function Dh(e,t){let r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function Iq(e){let t=!0,r=!0,n=!0;return e.hardMin!==void 0&&e.target<e.hardMin&&(t=!1),e.hardMax!==void 0&&e.target>e.hardMax&&(r=!1),e.step&&Sf({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:r?e.hardMax:void 0})!==e.target&&(n=!1),{min:t,max:r,step:n}}function Sf(e){let{target:t,hardMin:r,hardMax:n,step:i}=e,s=1e-10;if(r!==void 0&&n!==void 0&&(s=Math.min(s,Math.abs(n-r)/1e3)),i&&(s=Math.min(s,i/10)),r!==void 0&&(r=Dh(r,s)),n!==void 0&&(n=Dh(n,s)),e.forceSliderToMax&&n!==void 0&&(t=n),r>n||t<=r)return r;if(t>=n)return n;if(i){let u=r!==void 0?r:0;var o=Math.round((t-u)/i);t=i*o+u}let a=Dh(t,s);return(i||r===a||n===a)&&(t=a),t<=r?r:t>=n?n:t}function HP(e){let{storedMax:t,sliderValue:r,hardMin:n,step:i}=e,s=10;if(t>s&&(s=t),r>s&&(s=r),n>s&&(s=n),i){let o=Sf({target:s,hardMin:n,hardMax:void 0,step:i});o>=s?s=o:s=o+i}return s}var Ah=x.Constant,qD=x.Identifier;x.Base.prototype.tryGetConcreteTree=function(e,t,r={}){var n;try{n=this.getConcreteTree(e,t,r)}catch(i){i instanceof x.Base?n=i:n=ae(i)}return n};x.Base.prototype.getConcreteTree=function(e,t,r={}){var i;var n=this.buildIRExpression(e,t,{selection:(i=this.parseOptions)==null?void 0:i.selection,coerceToNumber:r.coerceToNumber});if(n.isError)throw n;return n};x.DoubleInequality.prototype.getConcreteTree=function(e,t){return new this.constructor([new x.Piecewise([this._indicator,this._expressions[0],new Ah(NaN)]).getConcreteTree(e,t),this._operators[0],new qD(this._symbol),this._operators[1],new x.Piecewise([this._indicator,this._expressions[1],new Ah(NaN)]).getConcreteTree(e,t)])};x.Error.prototype.getConcreteTree=function(e,t){return this};function Fl(e,t){return e.isError?e:t.indexOf(e.valueType)===-1?cl():e}x.Image.prototype.getConcreteTree=function(e,t){var r=this.center.tryGetConcreteTree(e,t),n=this.radianAngle.tryGetConcreteTree(e,t),i=this.width.tryGetConcreteTree(e,t),s=this.height.tryGetConcreteTree(e,t),o=this.opacity.tryGetConcreteTree(e,t),a=[N,Ue,Oe],u=[b,j,Oe];return r=Fl(r,a),n=Fl(n,u),i=Fl(i,u),s=Fl(s,u),o=Fl(o,u),new x.Image({center:r,radianAngle:n,width:i,height:s,opacity:o},this.moveStrategy)};x.Ticker.prototype.getConcreteTree=function(e,t){var r=this.handler.tryGetConcreteTree(e,t);!r.isError&&r.valueType!==Be&&(r=hl(ne(r.valueType)));var n=r.getDependencies().filter(function(i){return!(e.graphingEnabled()&&e.validActionVariable(i))});return n.length&&(r=Ut(e.sliderVariables(n)).setDependencies(n)),new x.Ticker({handler:r,minStep:this.minStep.tryGetConcreteTree(e,t)})};function Nh(e,t,r){if(!t){r.valids[e]=!0;return}var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(n.length>0){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=+t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}function Df(e){return e&&e.valueType===j&&e.length===1&&e.args?e.args[0]:e}x.Slider.prototype.getConcreteTree=function(e,t){var r=this._expression.getConcreteTree(e,t),n=Df(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t)),i=Df(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t)),s=Df(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t)),o={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(Nh(\"min\",n,o),Nh(\"max\",i,o),Nh(\"step\",s,o),s&&o.valids.step&&(o.values.step===0?delete o.values.step:o.values.step=Math.abs(o.values.step)),o.errors.cycle?r=Eg(o.exportedSymbol):(o.errors.min||!o.valids.min?o.errMsg=vg():o.errors.max||!o.valids.max?o.errMsg=Og():(o.errors.step||!o.valids.step)&&(o.errMsg=Dg()),o.values.min>o.values.max&&(o.valids.min=!1,o.valids.max=!1,o.errMsg||(o.errMsg=Sg()))),r.isConstant){var a=t.initialEvaluation&&t.initialEvaluation.asValue(),u=a&&this.sliderIsPlayingOnce,l=o.values.max,c=+r.asValue(),p=o.values.min,f=o.values.step;if(u&&!isFinite(l)){var d=Df(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,t));d&&(l=HP({storedMax:+d.asValue(),sliderValue:c,step:f,hardMin:p}))}var m=Sf({target:c,hardMin:p,hardMax:l,step:f,forceSliderToMax:!!u}),y=aa(m.toString()),g=isFinite(B(y))?y:m;r=new Ah(g).getConcreteTree(e,t)}return r.sliderInfo=o,r};function kP(e,t){if(!t[this._symbol])throw yi(this._symbol);var r=this.args.map(function(i){return i.getConcreteTree(e,t)});if(r.length>0){if(r.length===1&&r.push(new x.Constant(1).getConcreteTree(e,t)),r[1].getDependencies().length)throw Nl(this._symbol).setDependencies(r[1].getDependencies());if(r[1].valueType!==b)throw Nl(this._symbol);var n=r[1].asValue();if(!isFinite(n)||n<=0)throw Nl(this._symbol)}return this.typeCheck(e,r),new this.constructor(r)}x.Histogram.prototype.getConcreteTree=kP;x.DotPlot.prototype.getConcreteTree=kP;x.BoxPlot.prototype.getConcreteTree=function(e,t){if(!t[this._symbol])throw yi(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),r.length===1&&(r[0].valueType===j||r[0].valueType===Oe)?new this.constructor(r):ae(\"Failed to copmile BoxPlot\")};function Rh(e,t){if(!t[this._symbol])throw yi(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),new this.constructor(r)}x.TTest.prototype.getConcreteTree=Rh;x.IndependentTTest.prototype.getConcreteTree=Rh;x.Stats.prototype.getConcreteTree=Rh;x.Table.prototype.getConcreteTree=function(e,t){for(var r=[],n=Object.create(t),i=0;i<this.columns.length;i++){var s=this.columns[i].getConcreteTree(e,n);s.isIndependent&&this.columns[i].exportToLocal(e,s,n),r.push(s)}return new this.constructor(r)};x.TableColumn.prototype.getConcreteTree=function(e,t){var u;var r=this.header.getConcreteTree(e,t),n,i,s=this.header instanceof x.Identifier&&!t[this.header._symbol];if(s){n=[];for(var o=0;o<this.values.length;o++){if(this.values[o].tableError()){n.push(fu(this.values[o].tableError()));continue}var a=this.values[o].tryGetConcreteTree(e,t);a.isError?n.push(a):a.tableError()?n.push(fu(a.tableError())):a.valueType===b?n.push(a):n.push(Py([ne(a.valueType)]))}return i=new this.constructor(r,n),i.isIndependent=!0,i}else return r.isList?n=r.mapElements(function(l){return l}):n=[],!r.isError&&r.valueType!==b&&r.valueType!==j&&r.valueType!==Oe&&(r=Ty([ne((u=r.valueType)!=null?u:st)])),i=new this.constructor(r,n),i};function Vl(e,t,r){return{symbolMap:e,symbolNodeMap:t,maxIndex:r}}function gu(e,t){return e.symbolMap[t]}function $P(e,t){return e.symbolNodeMap[t]}function Jn(e,t,r,n){e.symbolNodeMap[t]=n,e.symbolMap[t]=r,e.maxIndex=Math.max(e.maxIndex,r)}function Rs(e){return Vl(Object.create(e.symbolMap),Object.create(e.symbolNodeMap),e.maxIndex)}var us={};Yi(us,{acosh:()=>BI,acot:()=>vN,acoth:()=>LN,acsc:()=>ON,acsch:()=>CN,addTangentAngle:()=>WA,addTangentArc:()=>XA,addTangentCircle:()=>YA,addTangentLine:()=>kA,addTangentRay:()=>$A,addTangentSegment:()=>bb,angleMarkerMultiplier:()=>_A,angleMarkerRawDelta:()=>wA,arc:()=>CA,arcArcIntersection:()=>tR,arcCenter:()=>Ou,arcCircleIntersection:()=>eR,arcGlider:()=>b0,arcLineIntersection:()=>I0,arcOmega:()=>Su,argMax:()=>sA,argMin:()=>iA,asec:()=>SN,asech:()=>RN,asinh:()=>GI,atanh:()=>zI,basePointFromVector:()=>SA,bernoulliTable:()=>YI,binomSample:()=>$N,binomcdf:()=>XN,binompdf:()=>jf,center:()=>AA,chooseNonIncidentPoint:()=>JA,circle:()=>NA,circleArcIntersection:()=>KA,circleCircleIntersection:()=>jl,circleGlider:()=>ZA,circleLineIntersection:()=>Ib,clamp:()=>nn,common_log:()=>TN,composeTransformation:()=>mR,corr:()=>Qf,cos:()=>fn,cosh:()=>_I,cot:()=>EN,cotDerivative:()=>XI,coth:()=>AN,cov:()=>aA,covp:()=>c0,csc:()=>MN,csch:()=>NN,dilation:()=>pR,directedAngleMarker:()=>g0,directedCoterminalAngle:()=>h0,distance:()=>Mu,distance3d:()=>pA,elementsAt:()=>vR,erf:()=>jN,erfcx:()=>io,expm1:()=>pN,factorial:()=>Aa,gamma:()=>Zl,gcd:()=>rb,getArcDetails:()=>Kf,hsv:()=>fA,hypot:()=>as,identity:()=>DA,invBinom:()=>t0,invNorm:()=>ub,invPoisson:()=>e0,invT:()=>r0,invUniform:()=>QN,invertTransformation:()=>yR,isDegenerateArc:()=>gb,itscore:()=>i0,ittest:()=>cb,lcm:()=>HI,line:()=>EA,lineArcIntersection:()=>P0,lineCircleIntersection:()=>Pb,lineGlider:()=>xb,lineLineIntersection:()=>T0,listGCD:()=>yN,listLCM:()=>gN,listLength:()=>KN,listMax:()=>o0,listMin:()=>s0,lnGamma:()=>bN,log:()=>xN,log1p:()=>Jl,log_base:()=>ZI,lowerQuantileIndex:()=>tA,lowerQuartileIndex:()=>nA,mad:()=>oA,mathVector:()=>m0,md5Spyable:()=>wI,mean:()=>Fs,median:()=>u0,mod:()=>UI,nCr:()=>Do,nPr:()=>Uf,normalSample:()=>HN,normalcdf:()=>qN,normalpdf:()=>ib,nthroot:()=>PN,parallel:()=>sR,perpendicular:()=>oR,pointDet:()=>v0,pointDot:()=>aR,pointPerp:()=>uR,poissonSample:()=>YN,poissoncdf:()=>WN,poissonpdf:()=>Iu,polyGamma:()=>WI,polygon:()=>dA,polygonArea:()=>mb,polygonEdges:()=>bA,polygonGlider:()=>jA,polygonInteriorDirectedAngles:()=>MA,polygonInteriorUndirectedAngles:()=>IA,polygonPerimeter:()=>xA,pow:()=>qI,quad:()=>cA,quantile:()=>a0,quartile:()=>Ra,quartileIndex:()=>Jf,radius:()=>RA,random:()=>sb,randomPerm:()=>ob,rank:()=>Qh,ray:()=>vA,rayGlider:()=>Kh,reflection:()=>dR,rgb:()=>p0,rotation:()=>fR,scaleTangentAngle:()=>HA,scaleTangentArc:()=>UA,scaleTangentCircle:()=>qA,scaleTangentLine:()=>GA,scaleTangentRay:()=>zA,scaleTangentSegment:()=>hb,sec:()=>IN,sech:()=>DN,segment:()=>yb,segment3d:()=>mA,segmentGlider:()=>Tb,select:()=>ER,shuffle:()=>UN,sign:()=>tb,sin:()=>Fr,sinh:()=>FI,sortPerm:()=>Ca,spearman:()=>uA,sphere:()=>gA,sqrtxsqm1:()=>mN,sqrtxsqp1:()=>dN,stats:()=>pb,stdev:()=>Hf,stdevp:()=>lA,supplementAngle:()=>VA,tSample:()=>kN,tan:()=>JI,tanh:()=>VI,tcdf:()=>zf,toFraction:()=>fN,total:()=>wN,tpdf:()=>Zf,transformAngleMarker:()=>MR,transformArc:()=>PR,transformCircle:()=>TR,transformLine:()=>hR,transformPoint:()=>_s,transformPolygon:()=>IR,transformRay:()=>bR,transformSegment:()=>ed,transformVector:()=>xR,transformation:()=>lR,translation:()=>cR,triangle:()=>yA,tscore:()=>n0,ttest:()=>lb,undirectedAngleMarker:()=>LA,undirectedCoterminalAngle:()=>FA,uniformSample:()=>No,uniformcdf:()=>ZN,uniformpdf:()=>ab,uniquePerm:()=>OR,upperQuantileIndex:()=>eA,upperQuartileIndex:()=>rA,validateRangeLength:()=>fb,validateSampleCount:()=>db,variance:()=>l0,varp:()=>Ql,vector:()=>d0,vectorDisplacementAsPoint:()=>OA,vertices:()=>hA});var XP=function(){\"use strict\";function e(y,g){var h=(y&65535)+(g&65535),P=(y>>16)+(g>>16)+(h>>16);return P<<16|h&65535}function t(y,g){return y<<g|y>>>32-g}function r(y,g,h,P,S,A){return e(t(e(e(g,y),e(P,A)),S),h)}function n(y,g,h,P,S,A,T){return r(g&h|~g&P,y,g,S,A,T)}function i(y,g,h,P,S,A,T){return r(g&P|h&~P,y,g,S,A,T)}function s(y,g,h,P,S,A,T){return r(g^h^P,y,g,S,A,T)}function o(y,g,h,P,S,A,T){return r(h^(g|~P),y,g,S,A,T)}function a(y,g){y[g>>5]|=128<<g%32,y[(g+64>>>9<<4)+14]=g;var h,P,S,A,T,I=1732584193,E=-271733879,v=-1732584194,D=271733878;for(h=0;h<y.length;h+=16)P=I,S=E,A=v,T=D,I=n(I,E,v,D,y[h],7,-680876936),D=n(D,I,E,v,y[h+1],12,-389564586),v=n(v,D,I,E,y[h+2],17,606105819),E=n(E,v,D,I,y[h+3],22,-1044525330),I=n(I,E,v,D,y[h+4],7,-176418897),D=n(D,I,E,v,y[h+5],12,1200080426),v=n(v,D,I,E,y[h+6],17,-1473231341),E=n(E,v,D,I,y[h+7],22,-45705983),I=n(I,E,v,D,y[h+8],7,1770035416),D=n(D,I,E,v,y[h+9],12,-1958414417),v=n(v,D,I,E,y[h+10],17,-42063),E=n(E,v,D,I,y[h+11],22,-1990404162),I=n(I,E,v,D,y[h+12],7,1804603682),D=n(D,I,E,v,y[h+13],12,-40341101),v=n(v,D,I,E,y[h+14],17,-1502002290),E=n(E,v,D,I,y[h+15],22,1236535329),I=i(I,E,v,D,y[h+1],5,-165796510),D=i(D,I,E,v,y[h+6],9,-1069501632),v=i(v,D,I,E,y[h+11],14,643717713),E=i(E,v,D,I,y[h],20,-373897302),I=i(I,E,v,D,y[h+5],5,-701558691),D=i(D,I,E,v,y[h+10],9,38016083),v=i(v,D,I,E,y[h+15],14,-660478335),E=i(E,v,D,I,y[h+4],20,-405537848),I=i(I,E,v,D,y[h+9],5,568446438),D=i(D,I,E,v,y[h+14],9,-1019803690),v=i(v,D,I,E,y[h+3],14,-187363961),E=i(E,v,D,I,y[h+8],20,1163531501),I=i(I,E,v,D,y[h+13],5,-1444681467),D=i(D,I,E,v,y[h+2],9,-51403784),v=i(v,D,I,E,y[h+7],14,1735328473),E=i(E,v,D,I,y[h+12],20,-1926607734),I=s(I,E,v,D,y[h+5],4,-378558),D=s(D,I,E,v,y[h+8],11,-2022574463),v=s(v,D,I,E,y[h+11],16,1839030562),E=s(E,v,D,I,y[h+14],23,-35309556),I=s(I,E,v,D,y[h+1],4,-1530992060),D=s(D,I,E,v,y[h+4],11,1272893353),v=s(v,D,I,E,y[h+7],16,-155497632),E=s(E,v,D,I,y[h+10],23,-1094730640),I=s(I,E,v,D,y[h+13],4,681279174),D=s(D,I,E,v,y[h],11,-358537222),v=s(v,D,I,E,y[h+3],16,-722521979),E=s(E,v,D,I,y[h+6],23,76029189),I=s(I,E,v,D,y[h+9],4,-640364487),D=s(D,I,E,v,y[h+12],11,-421815835),v=s(v,D,I,E,y[h+15],16,530742520),E=s(E,v,D,I,y[h+2],23,-995338651),I=o(I,E,v,D,y[h],6,-198630844),D=o(D,I,E,v,y[h+7],10,1126891415),v=o(v,D,I,E,y[h+14],15,-1416354905),E=o(E,v,D,I,y[h+5],21,-57434055),I=o(I,E,v,D,y[h+12],6,1700485571),D=o(D,I,E,v,y[h+3],10,-1894986606),v=o(v,D,I,E,y[h+10],15,-1051523),E=o(E,v,D,I,y[h+1],21,-2054922799),I=o(I,E,v,D,y[h+8],6,1873313359),D=o(D,I,E,v,y[h+15],10,-30611744),v=o(v,D,I,E,y[h+6],15,-1560198380),E=o(E,v,D,I,y[h+13],21,1309151649),I=o(I,E,v,D,y[h+4],6,-145523070),D=o(D,I,E,v,y[h+11],10,-1120210379),v=o(v,D,I,E,y[h+2],15,718787259),E=o(E,v,D,I,y[h+9],21,-343485551),I=e(I,P),E=e(E,S),v=e(v,A),D=e(D,T);return[I,E,v,D]}function u(y){var g,h=\"\",P=y.length*32;for(g=0;g<P;g+=8)h+=String.fromCharCode(y[g>>5]>>>g%32&255);return h}function l(y){var g,h=[];for(h[(y.length>>2)-1]=void 0,g=0;g<h.length;g+=1)h[g]=0;var P=y.length*8;for(g=0;g<P;g+=8)h[g>>5]|=(y.charCodeAt(g/8)&255)<<g%32;return h}function c(y){return u(a(l(y),y.length*8))}function p(y){var g=\"0123456789abcdef\",h=\"\",P,S;for(S=0;S<y.length;S+=1)P=y.charCodeAt(S),h+=g.charAt(P>>>4&15)+g.charAt(P&15);return h}function f(y){return unescape(encodeURIComponent(y))}function d(y){return c(f(y))}function m(y){return p(d(y))}return m}();function ro(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Eo(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Ls(){}var vo=.7,Oa=1/vo,hu=\"\\\\s*([+-]?\\\\d+)\\\\s*\",Bl=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",Cs=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",UD=/^#([0-9a-f]{3,8})$/,HD=new RegExp(`^rgb\\\\(${hu},${hu},${hu}\\\\)$`),kD=new RegExp(`^rgb\\\\(${Cs},${Cs},${Cs}\\\\)$`),$D=new RegExp(`^rgba\\\\(${hu},${hu},${hu},${Bl}\\\\)$`),YD=new RegExp(`^rgba\\\\(${Cs},${Cs},${Cs},${Bl}\\\\)$`),XD=new RegExp(`^hsl\\\\(${Bl},${Cs},${Cs}\\\\)$`),WD=new RegExp(`^hsla\\\\(${Bl},${Cs},${Cs},${Bl}\\\\)$`),WP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ro(Ls,Gl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ZP,formatHex:ZP,formatHex8:ZD,formatHsl:jD,formatRgb:jP,toString:jP});function ZP(){return this.rgb().formatHex()}function ZD(){return this.rgb().formatHex8()}function jD(){return rI(this).formatHsl()}function jP(){return this.rgb().formatRgb()}function Gl(e){var t,r;return e=(e+\"\").trim().toLowerCase(),(t=UD.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?JP(t):r===3?new kr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Nf(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Nf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=HD.exec(e))?new kr(t[1],t[2],t[3],1):(t=kD.exec(e))?new kr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$D.exec(e))?Nf(t[1],t[2],t[3],t[4]):(t=YD.exec(e))?Nf(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=XD.exec(e))?eI(t[1],t[2]/100,t[3]/100,1):(t=WD.exec(e))?eI(t[1],t[2]/100,t[3]/100,t[4]):WP.hasOwnProperty(e)?JP(WP[e]):e===\"transparent\"?new kr(NaN,NaN,NaN,0):null}function JP(e){return new kr(e>>16&255,e>>8&255,e&255,1)}function Nf(e,t,r,n){return n<=0&&(e=t=r=NaN),new kr(e,t,r,n)}function zl(e){return e instanceof Ls||(e=Gl(e)),e?(e=e.rgb(),new kr(e.r,e.g,e.b,e.opacity)):new kr}function Sa(e,t,r,n){return arguments.length===1?zl(e):new kr(e,t,r,n==null?1:n)}function kr(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ro(kr,Sa,Eo(Ls,{brighter(e){return e=e==null?Oa:Math.pow(Oa,e),new kr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vo:Math.pow(vo,e),new kr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new kr(va(this.r),va(this.g),va(this.b),Rf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:QP,formatHex:QP,formatHex8:JD,formatRgb:KP,toString:KP}));function QP(){return`#${Ea(this.r)}${Ea(this.g)}${Ea(this.b)}`}function JD(){return`#${Ea(this.r)}${Ea(this.g)}${Ea(this.b)}${Ea((isNaN(this.opacity)?1:this.opacity)*255)}`}function KP(){let e=Rf(this.opacity);return`${e===1?\"rgb(\":\"rgba(\"}${va(this.r)}, ${va(this.g)}, ${va(this.b)}${e===1?\")\":`, ${e})`}`}function Rf(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function va(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ea(e){return e=va(e),(e<16?\"0\":\"\")+e.toString(16)}function eI(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ss(e,t,r,n)}function rI(e){if(e instanceof ss)return new ss(e.h,e.s,e.l,e.opacity);if(e instanceof Ls||(e=Gl(e)),!e)return new ss;if(e instanceof ss)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(r-n)/a+(r<n)*6:r===s?o=(n-t)/a+2:o=(t-r)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new ss(o,a,u,e.opacity)}function Cf(e,t,r,n){return arguments.length===1?rI(e):new ss(e,t,r,n==null?1:n)}function ss(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ro(ss,Cf,Eo(Ls,{brighter(e){return e=e==null?Oa:Math.pow(Oa,e),new ss(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vo:Math.pow(vo,e),new ss(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new kr(Ch(e>=240?e-240:e+120,i,n),Ch(e,i,n),Ch(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ss(tI(this.h),Af(this.s),Af(this.l),Rf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Rf(this.opacity);return`${e===1?\"hsl(\":\"hsla(\"}${tI(this.h)}, ${Af(this.s)*100}%, ${Af(this.l)*100}%${e===1?\")\":`, ${e})`}`}}));function tI(e){return e=(e||0)%360,e<0?e+360:e}function Af(e){return Math.max(0,Math.min(1,e||0))}function Ch(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var Lf=Math.PI/180,wf=180/Math.PI;var _f=18,nI=.96422,iI=1,sI=.82521,oI=4/29,bu=6/29,aI=3*bu*bu,QD=bu*bu*bu;function uI(e){if(e instanceof ws)return new ws(e.l,e.a,e.b,e.opacity);if(e instanceof no)return cI(e);e instanceof kr||(e=zl(e));var t=Fh(e.r),r=Fh(e.g),n=Fh(e.b),i=Lh((.2225045*t+.7168786*r+.0606169*n)/iI),s,o;return t===r&&r===n?s=o=i:(s=Lh((.4360747*t+.3850649*r+.1430804*n)/nI),o=Lh((.0139322*t+.0971045*r+.7141733*n)/sI)),new ws(116*i-16,500*(s-i),200*(i-o),e.opacity)}function Vh(e,t,r,n){return arguments.length===1?uI(e):new ws(e,t,r,n==null?1:n)}function ws(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}ro(ws,Vh,Eo(Ls,{brighter(e){return new ws(this.l+_f*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new ws(this.l-_f*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=nI*wh(t),e=iI*wh(e),r=sI*wh(r),new kr(_h(3.1338561*t-1.6168667*e-.4906146*r),_h(-.9787684*t+1.9161415*e+.033454*r),_h(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function Lh(e){return e>QD?Math.pow(e,1/3):e/aI+oI}function wh(e){return e>bu?e*e*e:aI*(e-oI)}function _h(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Fh(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function KD(e){if(e instanceof no)return new no(e.h,e.c,e.l,e.opacity);if(e instanceof ws||(e=uI(e)),e.a===0&&e.b===0)return new no(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*wf;return new no(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function lI(e,t,r,n){return arguments.length===1?KD(e):new no(e,t,r,n==null?1:n)}function no(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function cI(e){if(isNaN(e.h))return new ws(e.l,0,0,e.opacity);var t=e.h*Lf;return new ws(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ro(no,lI,Eo(Ls,{brighter(e){return new no(this.h,this.c,this.l+_f*(e==null?1:e),this.opacity)},darker(e){return new no(this.h,this.c,this.l-_f*(e==null?1:e),this.opacity)},rgb(){return cI(this).rgb()}}));var mI=-.14861,Bh=1.78277,Gh=-.29227,Ff=-.90649,ql=1.97294,pI=ql*Ff,fI=ql*Bh,dI=Bh*Gh-Ff*mI;function eN(e){if(e instanceof Da)return new Da(e.h,e.s,e.l,e.opacity);e instanceof kr||(e=zl(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(dI*n+pI*t-fI*r)/(dI+pI-fI),s=n-i,o=(ql*(r-i)-Gh*s)/Ff,a=Math.sqrt(o*o+s*s)/(ql*i*(1-i)),u=a?Math.atan2(o,s)*wf-120:NaN;return new Da(u<0?u+360:u,a,i,e.opacity)}function zh(e,t,r,n){return arguments.length===1?eN(e):new Da(e,t,r,n==null?1:n)}function Da(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ro(Da,zh,Eo(Ls,{brighter(e){return e=e==null?Oa:Math.pow(Oa,e),new Da(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vo:Math.pow(vo,e),new Da(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Lf,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new kr(255*(t+r*(mI*n+Bh*i)),255*(t+r*(Gh*n+Ff*i)),255*(t+r*(ql*n)),this.opacity)}}));function xi(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return js(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let a=n?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:js(e,t)}function kh(e,t,r,n,i){if(!(isNaN(t)||isNaN(n)||t<0==n<0))for(;;){let s=xi(e,r),o=i(s);if(!isFinite(o))return;if(s===e||s===r)return Math.abs(t)<=Math.abs(n)?[e,t]:[r,n];if(o===0)return Ul(e,t,s,o,r,n,i);t<0!=o<0?(r=s,n=o):(e=s,t=o)}}function TI(e,t,r,n,i){if(!(qh(t)||qh(n))&&Uh(t,n))for(;;){let s=xi(e,r),o=i(s);if(qh(o))return;if(s===e||s===r)return s;if(Uh(t,o))r=s,n=o;else if(Uh(o,n))e=s,t=o;else return}}function qh(e){for(let t of e)if(isNaN(t))return!0;return!1}function Uh(e,t){for(let r=0;r<e.length;r++)if(!tN(e[r],t[r]))return!1;return!0}function tN(e,t){return e<=0&&t>=0||e>=0&&t<=0}function Ul(e,t,r,n,i,s,o){let a;if(!isFinite(n))return;isFinite(t)||(a=hi(e,t,r,n,o),a!==void 0&&(e=a,t=o(e))),isFinite(s)||(a=hi(r,n,i,s,o),a!==void 0&&(i=a,s=o(a)));let u,l;t===n?u=[e,t]:u=yI(e,t,r,n,o,n),s===n?l=[i,s]:l=yI(r,n,i,s,o,n);let c;return u&&l&&(c=xi(u[0],l[0])),c!==void 0?[c,o(c)]:void 0}function hi(e,t,r,n,i){if(isFinite(t)!==isFinite(n))for(;;){let s=xi(e,r),o=i(s);if(s===e||s===r)return isFinite(t)?e:r;isFinite(o)!==isFinite(t)?(r=s,n=o):(e=s,t=o)}}function yI(e,t,r,n,i,s){if(t===s!=(n===s))for(;;){let o=xi(e,r),a=i(o);if(o===e||o===r)return t===s?[e,t]:[r,n];a===s!=(t===s)?(r=o,n=a):(e=o,t=a)}}function PI(e,t,r,n,i,s,o){if(e<r&&r<i&&isFinite(t)&&isFinite(n)&&isFinite(s)&&t!==n&&n!==s&&n>t==n>s)for(;;){let a=xi(e,r),u=o(a),l=xi(r,i),c=o(l);if(!isFinite(u)||!isFinite(c))return;if(a===e||a===r||l===r||l===i)return u>n==n>t?[a,u]:c>n==n>t?[l,c]:[r,n];if(u===n||c===n)return Ul(e,t,r,n,i,s,o);n>t&&u>t&&u>n||n<t&&u<t&&u<n?(i=r,s=n,r=a,n=u):n>t&&c>n&&c>s||n<t&&c<n&&c<s?(e=r,t=n,r=l,n=c):(e=a,t=u,i=l,s=c)}}function bi([e,t],[r,n]){return(r-e)*(r-e)+(n-t)*(n-t)}function gI(e,t,r,n,i,s){let o=s(e),a=s(t),u=s(r),l=bi(o,n),c=bi(a,n),p=bi(u,n);if(!(t<=e||r<=t)&&!(!isFinite(l)||!isFinite(c)||!isFinite(p))&&!(c>=l||c>=p))for(;;){if(Math.abs(u[0]-o[0])<i&&Math.abs(u[1]-o[1])<i)return[e,r];let f=xi(e,t),d=s(f),m=bi(d,n),y=xi(t,r),g=s(y),h=bi(g,n);if(!isFinite(m)||!isFinite(h))return;if(f===e||f===t||y===t||y===r)return m<c&&m<h?[f,f]:h<m&&h<c?[y,y]:[t,t];if((m===c||h===c)&&(t=.5*(f+t),a=s(t),c=bi(a,n),m===c||h===c))return[e,r];m<c&&m<h?([r,t]=[t,f],[u,a]=[a,d],[p,c]=[c,m]):h<m&&h<c?([e,t]=[t,y],[o,a]=[a,g],[l,c]=[c,h]):([e,r]=[f,y],[o,u]=[d,g],[l,p]=[m,h])}}function hI(e,t,r){return t===void 0&&(t=-1/0),r===void 0&&(r=1/0),Math.min(r,Math.max(t,e))}function Hh(e,t,r,n,i,s){let o;if(n!==void 0&&i!==void 0){let p=.5*(n+i);o=r+.01*(r<p?i-n:n-i)}else o=Math.abs(r)>1?r*1.00001:r+1e-5;let a=e(r),u=e(o),l=bi(a,t),c=bi(u,t);if(!(!isFinite(l)||!isFinite(c))){if(l===c)return[r,o];for(c>l&&([r,o]=[o,r],[a,u]=[u,a],[l,c]=[c,l]);isFinite(r)&&isFinite(o)&&r!==o;){if(i!==void 0&&o>i)return[i,i];if(n!==void 0&&o<n)return[n,n];let p=r+3*(o-r),f=e(p),d=bi(f,t);if(!isFinite(d))return[r,o];if(d===c)return[r,o];if(d>c){let m=o>r?gI(r,o,p,t,s,e):gI(p,o,r,t,s,e);return m&&[hI(m[0],n,i),hI(m[1],n,i)]}[r,l,o,c]=[o,c,p,d]}return[r,o]}}function bI(e,t,r,n){return r?n?Math.min(bi(e(n[0]),t),bi(e(n[1]),t))<Math.min(bi(e(r[0]),t),bi(e(r[1]),t)):!1:!0}function Hq(e,t,r,n,i,s){let o=Hh(e,t,r,n,i,s);if(n!==void 0){let a=Hh(e,t,n,n,i,s);bI(e,t,o,a)&&(o=a)}if(i!==void 0){let a=Hh(e,t,i,n,i,s);bI(e,t,o,a)&&(o=a)}return o}function xI(e,t,r,n,i,s,o,a){let u=Math.abs(n-t),l=Math.abs(s-n),c=Math.abs(a-s);return u>l&&u>c?[e,r]:c>l&&c>u?[i,o]:[r,i]}function xu(e,t,r,n,i,s,o,a=0){if(!((r-e)*(i-r)<=0)&&!(!isFinite(e)||!isFinite(r)||!isFinite(i))&&!(!isFinite(t)||!isFinite(s))){if(!isFinite(n)){let u=hi(e,t,r,n,o),l=hi(r,n,i,s,o);return u===void 0||l===void 0?void 0:[u,l]}if(!(Math.abs(n-((i-r)*t+(r-e)*s)/(i-e))<a))for(;;){let u=xi(e,r),l=o(u),c=xi(r,i),p=o(c),f=Math.abs(l-js(t,n)),d=Math.abs(n-js(l,p)),m=Math.abs(p-js(n,s));if(f<=a&&d<=a&&m<=a)return;if(!isFinite(l)){let y=hi(e,t,u,l,o),g=hi(u,l,i,s,o);return y===void 0||g===void 0?void 0:[y,g]}if(!isFinite(p)){let y=hi(e,t,c,p,o),g=hi(c,p,i,s,o);return y===void 0||g===void 0?void 0:[y,g]}if((u===e||u===r)&&(c===r||c===i))return Math.abs(n-t)>Math.abs(s-n)?[e,r]:[r,i];if(u===e||u===r)return xI(e,t,r,n,c,p,i,s);if(c===r||c===i)return xI(e,t,u,l,r,n,i,s);f>m&&f>=d?(i=r,s=n,r=u,n=l):m>f&&m>=d?(e=r,t=n,r=c,n=p):(e=u,t=l,i=c,s=p)}}}var nN=xu,Vf=hi,iN=3.154019550531224,II=Math.pow(2,-13),Oo=II*II,MI=Oo*Oo,$h=Oo,Xh=32,os=[],So=[];function sN(e,t){for(var r=Xh;r>0;r--){var n=iN/Xh*r,i=Math.sinh(n),s=Math.cosh(Math.PI/2*i),o=1/(Math.exp(Math.PI/2*i)*s),a=Math.cosh(n)/(s*s);e.push(o),t.push(a)}}sN(os,So);var OI=0;for(Bf=0;Bf<So.length;Bf++)OI+=So[Bf];var Bf,Gf=1/(1+2*OI);function vn(e,t,r){return .5*(t*(2-r)+e*r)}function oN(e,t,r){var n=.5*(t+r),i=nN(t,e(t),n,e(n),r,e(r),e);return i?.5*(i[0]+i[1]):n}function Hl(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function EI(e,t,r){var n=Math.abs(e(vn(t,r,Oo))),i=Math.abs(e(vn(t,r,2*Oo))),s=Math.abs(e(vn(t,r,4*Oo)));return n<Oo||i<Oo?!1:n>1.95*i&&i>1.95*s}function Yh(e,t,r){var n=vn(r,t,os[0]),i=vn(t,r,os[0]),s=e(n),o=e(i),a=vn(t,r,1),u=e(a),l,c;if(isFinite(u)&&!isFinite(s)){if(l=Vf(n,s,a,u,e),Math.abs((l-t)/(r-t))>$h)return Hl(t,r,NaN,NaN,NaN);t=l,s=e(t)}if(isFinite(u)&&!isFinite(o)){if(c=Vf(a,u,i,o,e),Math.abs((c-r)/(r-t))>$h)return Hl(t,r,NaN,NaN,NaN);r=c,o=e(r)}if(isFinite(s)&&isFinite(o)&&!isFinite(u)){if(l=Vf(n,s,a,u,e),c=Vf(a,u,i,o,e),Math.abs((c-l)/(r-t))>$h)return Hl(t,r,NaN,NaN,NaN);u=.5*(l+c)}if(EI(e,t,r)||EI(e,r,t))return Hl(t,r,NaN,NaN,NaN);for(var p=u,f=0,d=0,m=0,y=0,g=0,h=0,P=0;P<Xh;P+=4)g=e(vn(t,r,os[P])),h=e(vn(r,t,os[P])),y=Math.max(y,Math.abs(g),Math.abs(h)),f+=So[P]*(g+h),g=e(vn(t,r,os[P+1])),h=e(vn(r,t,os[P+1])),y=Math.max(y,Math.abs(g),Math.abs(h)),m+=So[P+1]*(g+h),g=e(vn(t,r,os[P+2])),h=e(vn(r,t,os[P+2])),y=Math.max(y,Math.abs(g),Math.abs(h)),d+=So[P+2]*(g+h),g=e(vn(t,r,os[P+3])),h=e(vn(r,t,os[P+3])),y=Math.max(y,Math.abs(g),Math.abs(h)),m+=So[P+3]*(g+h);var S=p+f,A=S+d,T=A+m,I=Math.abs(d-S),E=Math.abs(m-A),v=Gf*(r-t)*T,D=Gf*Math.abs(r-t)*y*So[0],R;return I===0?R=Gf*Math.abs(r-t)*E:R=Gf*Math.abs(r-t)*E*(E/I)*(E/I),R=Math.max(R,D),Hl(t,r,v,R,D)}function vI(e){for(var t=-1/0,r=-1/0,n=-1,i=0,s=0;s<e.length;s++){var o=e[s];i+=o.value,o.error>t&&(t=o.error,n=s),o.minerror>r&&(r=o.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}function kl(e,t,r,n=32){if(isNaN(t)||isNaN(r))return NaN;var i=1;if(t>r){var s=t;t=r,r=s,i=-1}if(t===1/0&&r===1/0)return NaN;if(t===-1/0&&r===-1/0)return NaN;if(t===-1/0&&r===1/0)return i*kl(function(f){return e(f/((1+f)*(1-f)))*(1+f*f)/((1+f)*(1+f)*(1-f)*(1-f))},-1,1,n);if(t===-1/0)return i*kl(function(f){return-e(r-f/(1-f))/((1-f)*(1-f))},1,0,n);if(r===1/0)return i*kl(function(f){return e(t+f/(1-f))/((1-f)*(1-f))},0,1,n);for(var o=[Yh(e,t,r)],a=vI(o),u=1;u<n&&!(Math.abs(a.maxerror/a.totalvalue)<=32*MI||a.maxerror<=32*MI||a.maxerror<=32*a.maxminerror||!isFinite(a.maxerror)||!isFinite(a.maxminerror));u++){var l=o[o.length-1];o[o.length-1]=o[a.maxindex],o[a.maxindex]=l;var c=o.pop(),p=oN(e,vn(c.x2,c.x1,.125),vn(c.x1,c.x2,.125));o.push(Yh(e,c.x1,p)),o.push(Yh(e,p,c.x2)),a=vI(o)}return!isFinite(a.maxerror)||!isFinite(a.maxminerror)?NaN:Math.abs(a.totalvalue)<=10*a.maxminerror?0:i*a.totalvalue}var $l=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let r=this._data.length;for(this._data.push(t);r>0;){let n=r-1>>>1;if(this.comparator(this._data[r],this._data[n])<0){let i=this._data[n];this._data[n]=this._data[r],this._data[r]=i,r=n}else break}}dequeue(){let t=this._data[0],r=this._data.pop();if(this._data.length>0&&r!==void 0){this._data[0]=r;let n=0,i=this._data.length-1;for(;;){let s=(n<<1)+1,o=s+1,a=n;if(s<=i&&this.comparator(this._data[s],this._data[a])<0&&(a=s),o<=i&&this.comparator(this._data[o],this._data[a])<0&&(a=o),a!==n){let u=this._data[a];this._data[a]=this._data[n],this._data[n]=u,n=a}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function uN(e,t){let r=e.start[1]-e.end[1],n=e.end[0]-e.start[0],i=t.start[1]-t.end[1],s=t.end[0]-t.start[0],o=r*e.end[0]+n*e.end[1],a=i*t.end[0]+s*t.end[1],u=r*s-i*n;if(u!==0)return(r*a-i*o)/u}function lN(e,t,r){if(r.xSlope>=t.xSlope)return;if(t.scanlineX===r.scanlineX)return e;let n=t.start[1]>t.end[1]?t.start:t.end,i=r.start[1]>r.end[1]?r.start:r.end,s=n[1];if(i[1]<n[1]){if(s=i[1],Wh(s,t)<i[0])return}else if(n[1]<i[1]){let a=Wh(s,r);if(n[0]<a)return}else if(n[0]<i[0])return;let o=uN(t,r);if(o!==void 0)return Math.max(Math.min(o,s),e)}function Wh(e,t){let r=t.end[0],n=t.start[0],i=t.end[1],s=t.start[1];if(i===e)return r;if(s===e)return n;{let o=(e-i)/(s-i),a=(1-o)*r+o*n;if(r<n){if(a<=r)return r;if(n<=a)return n}else{if(a<=n)return n;if(r<=a)return r}return a}}function Zh(e){let t=0,r=0,n=!1,i=0;for(let{scanlineX:s,isClockwise:o}of e)o?i+=1:i-=1,i!==0&&!n?(n=!0,r=s):i===0&&n&&(n=!1,t+=s-r);return t}var Yl=class{constructor(t){this.scanlineY=-1/0;let r=1;this.activeEdges=[],this.events=new $l(function(n,i){return n.y-i.y}),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let n=t.length-1;n>=1;n--){let i=t[n],s=t[n-1],o={id:r++,index:n-1,end:i,start:s,scanlineX:0,xSlope:1/0,isClockwise:s[1]>i[1],skipIntersectionWith:{}};s[1]>i[1]?(this.events.queue({type:\"+\",y:i[1],edge:o}),this.events.queue({type:\"-\",y:s[1],edge:o}),o.xSlope=(s[0]-i[0])/(s[1]-i[1]),o.scanlineX=i[0]):i[1]>s[1]?(this.events.queue({type:\"+\",y:s[1],edge:o}),this.events.queue({type:\"-\",y:i[1],edge:o}),o.xSlope=(i[0]-s[0])/(i[1]-s[1]),o.scanlineX=s[0]):this.events.queue({type:\"h\",y:s[1],edge:o})}}nextScanline(){var s;let t,r=this.events.peek();if(!r)return;if(r.y<=this.scanlineY)throw new Error(\"Programming error: expected next event to begin a new scanline\");this.scanlineY=r.y,this.updateActiveEdgeScanlineIntersections();let n=Zh(this.activeEdges),i=[];for(;t=this.events.dequeue();)if(t.type===\"x\"?this.swapActiveEdges(t):t.type===\"+\"?this.insertActiveEdge(t):t.type===\"-\"&&this.removeActiveEdge(t),i.push(t),((s=this.events.peek())==null?void 0:s.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:n,events:i}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let r of this.activeEdges){let n=Wh(this.scanlineY,r);n<t?n=t:t=n,r.scanlineX=n}}insertActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,{xSlope:s,scanlineX:o}=n;for(var a=0;a<r.length;a++){let u=r[a];if(o<u.scanlineX||o===u.scanlineX&&s<=u.xSlope)break}r.splice(a,0,n),this.checkIntersection(i,r[a-1],n),this.checkIntersection(i,n,r[a+1])}checkIntersection(t,r,n){if(!r||!n||r.index===(n.index+1)%this.polygonLength||n.index===(r.index+1)%this.polygonLength)return;if(r.id<n.id){if(r.skipIntersectionWith[n.id])return}else if(n.skipIntersectionWith[r.id])return;let i=lN(t,r,n);if(i===void 0)return;r.id<n.id?r.skipIntersectionWith[n.id]=!0:n.skipIntersectionWith[r.id]=!0;let s={type:\"x\",y:i,edge1:r,edge2:n};this.events.queue(s)}removeActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,s=r.indexOf(n);r.splice(s,1),this.checkIntersection(i,r[s-1],r[s])}swapActiveEdges(t){let r=this.activeEdges,n=t.edge1,i=t.edge2,s=t.y,o=r.indexOf(n),a=o+1;o===-1||r[a]!==i?n.id<i.id?delete n.skipIntersectionWith[i.id]:delete i.skipIntersectionWith[n.id]:(r[o]=i,r[a]=n,this.checkIntersection(s,r[o-1],i),this.checkIntersection(s,n,r[a+1]))}static debugEvent(t){let r=`y=${t.y} `;return r+=t.type===\"x\"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,r}debugState(){return`y=${this.scanlineY}\n${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function cN(e){let t=e.slice(0,2),r=e.slice(-2);return t[0]!==r[0]||t[1]!==r[1]?[...e,...t]:e}function Wq(e,t){if(!e)return!1;let r=cN(e),[n,i]=t,s=0;for(var o=r.length-1;o>=3;o-=2){let a=r[o-3],u=r[o-2],l=r[o-1],c=r[o];u>i!=c>i&&n<(l-a)*(i-u)/(c-u)+a&&(u>c?s+=1:u<c&&(s-=1))}return s!==0}function DI(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new Yl(e),r,n=0,i;for(;i=t.nextScanline();){let s=i.lengthBeforeProcessingEvents;r&&(n+=.5*(i.y-r.y)*(s+r.length)),r={y:i.y,length:Zh(i.activeEdges)}}return n}function NI(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error(\"Programming error: expected last point to be a duplicate of the first point.\");for(let f=0;f<e.length-1;f++)if(e[f][0]===e[f+1][0]&&e[f][1]===e[f+1][1])throw new Error(`Programming error: unexpected duplicate point at ${f+1}`);let t=new Yl(e),r=e.slice(0,-1).map(()=>0),n;for(;n=t.nextScanline();)for(let f of n.events){let d={};if(f.type===\"h\"){let m=f.edge;d[m.index]={xMin:Math.min(m.end[0],m.start[0]),xMax:Math.max(m.end[0],m.start[0]),dx:m.end[0]-m.start[0]}}else if(f.type===\"x\"){let m=f.edge1,y=f.edge2,g=SI([m.start,m.end],[y.start,y.end]),h=g>0?-1:g<0?1:0;r[m.index]+=h,r[y.index]-=h}for(let m of n.activeEdges){let y=m.end[1]-m.start[1];for(let g in d){let{xMin:h,xMax:P,dx:S}=d[g];if(h<m.scanlineX&&m.scanlineX<P){let A=S*y,T=A>0?-1:A<0?1:0;r[g]+=T,r[m.index]-=T}}}}let i=e.slice(0,-1).map(()=>0),s=e[0][1],o=0;for(let f=1;f<e.length;f++)e[f][1]<s&&(s=e[f][1],o=f);let a=e.length-1,u=o>0?o-1:a-1,l=(o+1)%a,p=SI([e[u],e[o]],[e[o],e[l]])>0?1:0;i[o]=p>0?-1:1;for(let f=0;f<a-1;f++){let d=(o+f)%a;p+=r[d],i[(d+1)%a]=p>0?-1:1}return i}function SI(e,t){let r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],i=t[1][0]-t[0][0],s=t[1][1]-t[0][1];return r*s-n*i}var wI={spy:XP},{cosh:_I,sinh:FI,tanh:VI,acosh:BI,asinh:GI,atanh:zI,expm1:pN,log1p:Jl,sign:tb,hypot:as}=Math,fN=Zs,rb=sa,qI=oa,dN=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},mN=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)};function nn(e,t,r){return Math.max(t,Math.min(r,e))}function UI(e,t){let r=e%t;return e*t<0&&r!==0?r+t:r}function HI(e,t){e=Math.round(e),t=Math.round(t);let r=rb(e,t);return Math.abs(e/r*t)}function yN(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=rb(t,e[r]);return t}function gN(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=HI(t,e[r]);return t}function Do(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return wi(t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return r&&n?0:wi(e-t)*wi(t)/(wi(e)*Do(-e,-t));if(e<0&&t>0&&e-t<0)return r&&n?Math.pow(-1,t)*Do(t-e-1,t):wi(e-t)/wi(e)*Do(-(e-t),t);if(e<0&&t<0&&e-t>0)return r&&n?Math.pow(-1,e-t)*Do(-t-1,e-t):wi(t)/wi(e)*Do(-t,-e);if(e>0&&t<0&&e-t>0){let a=Math.abs(e)>Math.abs(t)?-t:e;return wi(t)/Do(e-t,a)}if(e>0&&t>0&&e-t<0)return wi(e-t)/Do(t,e);if(e<0||t<0||e-t<0||e<15&&t<15&&e-t<15)return Uf(e,t)/Aa(t);let i=Qn(e)-Qn(t)-Qn(e-t)-(e-t)*Jl(-t/e),s=Math.sqrt(e/(2*Math.PI*t*(e-t)))*Math.pow(e/t,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function Uf(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/Aa(-t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return r&&n?Math.pow(-1,t)*Uf(t-e-1,t):wi(e-t)/wi(e)*Uf(-(e-t),t);if(e<0||e-t<0||e<15&&e-t<15)return Aa(e)/Aa(e-t);let i=Qn(e)-Qn(e-t)-(e-t)*Jl(-t/e),s=Math.sqrt(e/(e-t))*Math.pow(e/Math.E,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function Aa(e){return Zl(e+1)}function Zl(e){if(e===-1/0)return NaN;let t=Math.round(e)===e;if(e<0)return t?1/0:Math.PI/(QI(e)*Zl(1-e));if(e>170)return 1/0;let r;return e<15?r=kI(e):e<120?r=hN(e):r=Math.exp($I(e)),t?Math.round(r):r}function kI(e){let t=4.077131788261185,r=7.024675027156382,n=6.657107767450176,i=3.766266976716022,s=1.2792371666711133,o=.24304596436338005,a=.020049769312165774,u=4.154347453162709,l=7.270007565107539,c=6.97805297331391,p=3.989651532924167,f=1.367176195613119,d=.26175627691546965,m=.021742722739397567,y=1+e*(t+e*(r+e*(n+e*(i+e*(s+e*(o+e*a)))))),g=1+e*(u+e*(l+e*(c+e*(p+e*(f+e*(d+e*m))))));return Math.E*Math.pow((1+e)/Math.E,1+e)/(e*Math.sqrt(1+e))*(y/g)}function hN(e){let t=e-1;return Math.pow(t,t)*Math.exp(nb(t)-t)*Math.sqrt(2*Math.PI*t)}function $I(e){let t=e-1;return t*(Math.log(t)-1)+.5*Math.log(2*Math.PI*t)+nb(t)}function bN(e){return e<0?NaN:e<15?Math.log(kI(e)):$I(e)}var YI=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function XI(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/JI(t);let r=Fr(t);if(e===1)return-1/(r*r);let n=fn(t);if(e===2)return 2*n/(r*r*r);let i=[0,2],s=[];for(let a=3;a<=e;a++){s=[];for(let u=0;u<a;u++){let l=0,c=0;u>0&&(l=(a-u+1)*i[u-1]),u+2<a&&(c=(u+1)*i[u+1]),s.push(-(l+c))}i=s}let o=0;for(let a=e-1;a>=0;a--)o=s[a]+n*o;return o/Math.pow(r,e+1)}function WI(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let r=e%2===0?-1:1;if(t<0)return-r*WI(e,1-t)-Math.pow(Math.PI,e+1)*XI(e,Math.PI*t);let n=Aa(e),i=0,s=Math.pow(t,-(e+1));for(;t<10;)i+=s,t++,s=Math.pow(t,-(e+1));i+=e===0?-Math.log(t):s*t/e,i+=.5*s;let o=YI,a=e+1,u=2,l=s*t*a/u,c=1/(t*t);for(let p=1;p<=14;p++)l*=c,i+=l*o[p-1],a++,u++,l*=a/u,a++,u++,l*=a/u;return n*r*i}function xN(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function ZI(e,t){if(t===0)return NaN;let r;return t===Math.E?r=Math.log(e):t===2&&Math.log2?r=Math.log2(e):t===10&&Math.log10?r=Math.log10(e):r=Math.log(e)/Math.log(t),Math.pow(t,Math.round(r))===e?Math.round(r):r}function TN(e){return ZI(e,10)}function PN(e,t){return qI(e,1/t)}var jI=1/Math.PI;function Xf(e){return e>1e12?!1:Math.round(jI*e)*Math.PI===e}function Wf(e){if(e>1e12)return!1;let t=Math.round(2*jI*e);return t%2===1&&t*Math.PI===2*e}function Fr(e){return Xf(Math.abs(e))?0:Math.sin(e)}function fn(e){return Wf(Math.abs(e))?0:Math.cos(e)}function JI(e){let t=Math.abs(e);return Xf(t)?0:Wf(t)?1/0:Math.tan(e)}function IN(e){return Wf(Math.abs(e))?1/0:1/Math.cos(e)}function MN(e){return Xf(Math.abs(e))?1/0:1/Math.sin(e)}function EN(e){let t=Math.abs(e);return Xf(t)?1/0:Wf(t)?0:1/Math.tan(e)}function vN(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function ON(e){return Math.asin(1/e)}function SN(e){return Math.acos(1/e)}function DN(e){return 1/_I(e)}function NN(e){return 1/FI(e)}function AN(e){return 1/VI(e)}function RN(e){return BI(1/e)}function CN(e){return GI(1/e)}function LN(e){return zI(1/e)}function QI(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),r=-.5*t+e,n=t&2?-1:1,i=t&1?Math.cos(Math.PI*r):Math.sin(Math.PI*r);return n*i}function wi(e){return e===1/0||e===-1/0?0:e===0?1:QI(e)/(Math.PI*e)}function Fs(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function wN(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function Jh(e){return e>50?Math.exp(.5*((1-e)*Jl(-1/(e-1))-1)+Qn(.5*(e-1))-Qn(.5*(e-2)))*Math.sqrt((1-1/e)/(2*Math.PI)):Zl((e+1)/2)/(Zl(e/2)*Math.sqrt(e*Math.PI))}function Pu(e,t,r=e-t){if(Math.abs(r)<.1*(e+t)){let n=r/(e+t),i=r*r/(e+t),s=2*e*n;for(let o=1;o<10;o++){s*=n*n;let a=i+s/(2*o+1);if(a==i)return a;i=a}}return e*Math.log(e/t)+t-e}var _N=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function Qn(e){return e>15?nb(e):e<0?NaN:e===Math.floor(e)?_N[e]:Math.log(Aa(e)/(Math.pow(e,e)*Math.exp(-e)*Math.sqrt(2*Math.PI*e)))}function nb(e){let t=.08333333333333333,r=.002777777777777778,n=.0007936507936507937,i=.0005952380952380953,s=.0008417508417508417,o=e*e;return(t-(r-(n-(i-s/o)/o)/o)/o)/e}function Zf(e,t){return t<=0?NaN:Jh(t)*Math.pow(1+e*e/t,-((t+1)/2))}function Na(e,t){if(t>0)return 1-Na(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=40&&t>-1)return .5+Jh(e)*FN(e,t);if(t/e<-1e3){let n=t*t;return Jh(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*n))/(2*n))}let r=Math.sqrt(t*t+e);return VN((t+r)/(2*r),e/2,e/2)}function FN(e,t){let r=t*t/e,n=t,i=n;for(let s=1;s<=15;s++)n*=-(2*s-1)/(2*s+1)*(.5*(e+1)+s-1)/s*r,i+=n;return i}function zf(e,t,r){return r<=0?NaN:e===-1/0?Na(r,t):e>0&&t>0?Na(r,-e)-Na(r,-t):Na(r,t)-Na(r,e)}function VN(e,t,r){if(e<0||e>1)throw new RangeError(\"First argument must be between 0 and 1.\");if(t===1&&r===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(r===0)return 0;{let n=Qn(t+r)-Qn(t)-Qn(r)-Pu(t,(t+r)*e)-Pu(r,(t+r)*(1-e),(t+r)*e-t),i=Math.exp(n)*Math.sqrt(t*r/(2*Math.PI*(t+r)));return e<(t+1)/(t+r+2)?i*AI(e,t,r)/t:1-i*AI(1-e,r,t)/r}}function AI(e,t,r){let n=Math.pow(2,-52),i=1e-300,s=t+r,o=t+1,a=t-1,u=1,l=1-s*e/o;Math.abs(l)<i&&(l=i),l=1/l;let c=l;for(let p=1;p<=100;p++){let f=2*p,d=p*(r-p)*e/((a+f)*(t+f));l=1+d*l,Math.abs(l)<i&&(l=i),u=1+d/u,Math.abs(u)<i&&(u=i),l=1/l,c*=l*u,d=-(t+p)*(s+p)*e/((t+f)*(o+f)),l=1+d*l,Math.abs(l)<i&&(l=i),u=1+d/u,Math.abs(u)<i&&(u=i),l=1/l;let m=l*u;if(c*=m,Math.abs(m-1)<=n)return c}return c}function BN(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=e,o=i/s,a=i/n,u=1/s,l=2,c=0,p=s,f=-(e-1),d=0;do f-=1,p+=1,u=u*f*t+p,u===0&&(u=n),a=p+f*t/a,a===0&&(a=n),u=1/u,c=a*u,o=o*c,d+=1,p+=1,u=u*d*t+p,u===0&&(u=n),a=p+d*t/a,a===0&&(a=n),u=1/u,c=a*u,o*=c,l+=2;while(l<100&&Math.abs(c-1)>r);return o}function GN(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=t+1-e,o=i/s,a=i/n,u=1/s,l=2,c=0,p=s;do{let f=-(l-1)*(l-e-1);p+=2,u=u*f+p,u===0&&(u=n),a=p+f/a,a===0&&(a=n),u=1/u,c=a*u,o*=c,l+=1}while(l<100&&Math.abs(c-1)>r);return o}function zN(e,t){let r=t/e,n=tb(t-e)*Math.sqrt(2*Pu(1,r)),i=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],s=i.length-2,o=0,a=0,u=0,l=0;for(;s>=0;s--)u=(s+2)*o/e+i[s+1],l=n*l+u,o=a,a=u;if(l=e/(e+o)*l,t<e){let c=Math.exp(-.5*e*n*n)*(.5*io(-n*Math.sqrt(e/2))-l/Math.sqrt(2*Math.PI*e));return isFinite(c)?1-c:1}else{let c=Math.exp(-.5*e*n*n)*(.5*io(n*Math.sqrt(e/2))+l/Math.sqrt(2*Math.PI*e));return isFinite(c)?c:0}}function RI(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))}function Xl(e){return e<0?.5*Math.exp(-e*e)*io(-e):1-.5*Math.exp(-e*e)*io(e)}function qN(e,t,r,n){let i=RI(t,r,n);if(e===-1/0)return Xl(i);let s=RI(e,r,n);return e>0&&t>0?Xl(-s)-Xl(-i):Xl(i)-Xl(s)}function ib(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))}function sb(e){let t=wI.spy(e),r=parseInt(t.slice(0,8),16)&2097151,n=parseInt(t.slice(8,16),16);return(r*4294967296+n)/9007199254740992}function KI(e,t){for(let r=t.length-1;r>0;r--){let n=e+\"::sc\"+r,i=Math.floor(sb(n)*(r+1)),s=t[r];t[r]=t[i],t[i]=s}}function UN(e,t){let r=t.slice();return KI(e,r),r}function ob(e,t){let r=[];for(let n=0;n<t;n++)r.push(n);return KI(e,r),r}function No(e,t,r){return sb(e)*(r-t)+t}function HN(e,t,r){let n=0,i,s,o,a;do i=e+\"::sc\"+n,n+=1,s=No(i,0,1)*2-1,i=e+\"::sc\"+n,n+=1,o=No(i,0,1)*2-1,a=s*s+o*o;while(a>=1||a===0);let u=Math.sqrt(-2*Math.log(a)/a);return t+r*s*u}function kN(e,t){if(t<=0)return NaN;let r=0,n,i,s,o;do n=e+\"::sc\"+r,r+=1,i=No(n,0,1)*2-1,n=e+\"::sc\"+r,r+=1,s=No(n,0,1)*2-1,o=i*i+s*s;while(o>1);let a=i*i/o,u=t*(Math.pow(o,-2/t)-1);return n=e+\"::sc\"+r,r+=1,(No(n,0,1)<.5?-1:1)*Math.sqrt(a*u)}function $N(e,t,r){return t=nn(Math.round(t),0,1/0),t===1/0?NaN:(r=nn(r,0,1),t0(No(e,0,1),t,r))}function YN(e,t){return t<0?NaN:e0(No(e,0,1),t)}function qf(e,t,r){return e>=t?1:e<0?0:e<Math.floor((t+1)*r)?CI(e,t,r):1-CI(t-e-1,t,1-r)}function CI(e,t,r){let n=(1-r)/r,i=jf(e,t,r),s=i;for(;e>0&&(i*=e/(t-e+1)*n,s+i!==s);e--)s+=i;return s}function XN(e,t,r,n){return r=nn(Math.round(r),0,1/0),r===1/0?NaN:(n=nn(n,0,1),t<0?0:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?qf(t,r,n):qf(t,r,n)-qf(e-1,r,n)))}function jf(e,t,r){if(e=Math.round(e),t=nn(Math.round(t),0,1/0),t===1/0)return NaN;if(r=nn(r,0,1),e<0||e>t)return 0;if(r===0)return e===0?1:0;if(r===1)return e===t?1:0;if(e===0)return Math.exp(t*Jl(-r));if(e===t)return Math.pow(r,t);let n=Qn(t)-Qn(e)-Qn(t-e)-Pu(e,t*r)-Pu(t-e,t*(1-r),t*r-e);return Math.exp(n)*Math.sqrt(t/(2*Math.PI*e*(t-e)))}function Iu(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Math.exp(-Qn(e)-Pu(e,t))/Math.sqrt(2*Math.PI*e))}function Wl(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===1/0)return 1;if(e=Math.floor(e),e<0)return 0;if(t===0)return 1;if(e+1>12&&2.35*(e+1)>t&&.3*(e+1)<t)return zN(e+1,t);if(e+1>=t){let r=BN(e+1,t);return isFinite(r)?1-t*Iu(e,t)*r:1}else{let r=GN(e+1,t);return isFinite(r)?t*Iu(e,t)*r:0}}function WN(e,t,r){return r<0?NaN:(e=Math.ceil(e),t=Math.floor(t),t<0?0:e===-1/0?Wl(t,r):Wl(t,r)-Wl(e-1,r))}function ab(e,t,r){return r<=t?NaN:e<t||e>r?0:1/(r-t)}function LI(e,t,r){return r<=t?NaN:e<t?0:e>r?1:(e-t)/(r-t)}function ZN(e,t,r,n){return LI(t,r,n)-LI(e,r,n)}function jN(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*io(e):e<=-.065?Math.exp(t)*io(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function io(e){let t=.9999999999999999,r=2.224574423459406,n=2.444115549920689,i=1.7057986861852539,s=.8257463703357973,o=.28647031042892007,a=.07124513844341643,u=.012296749268608364,l=.001347817214557592,c=7263959403471071e-20,p=1,f=3.352953590554884,d=5.227518529742423,m=5.003720878235473,y=3.266590890998987,g=1.5255421920765353,h=.5185887413188858,P=.12747319185915415,S=.02185979575963238,A=.0023889438122503674,T=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-io(-e);if(e>50){let I=.5641895835477563,E=e*e;return e>5e7?I/e:I*(E*(E+4.5)+2)/(e*(E*(E+5)+3.75))}else{let I=t+e*(r+e*(n+e*(i+e*(s+e*(o+e*(a+e*(u+e*(l+e*c)))))))),E=p+e*(f+e*(d+e*(m+e*(y+e*(g+e*(h+e*(P+e*(S+e*(A+e*T)))))))));return I/E}}function ub(e){let t=-39.6968302866538,r=220.946098424521,n=-275.928510446969,i=138.357751867269,s=-30.6647980661472,o=2.50662827745924,a=-54.4760987982241,u=161.585836858041,l=-155.698979859887,c=66.8013118877197,p=-13.2806815528857,f=-.00778489400243029,d=-.322396458041136,m=-2.40075827716184,y=-2.54973253934373,g=4.37466414146497,h=2.93816398269878,P=.00778469570904146,S=.32246712907004,A=2.445134137143,T=3.75440866190742,I=.02425,E,v,D;return e>.5?-ub(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<I?(E=Math.sqrt(-2*Math.log(e)),D=(((((f*E+d)*E+m)*E+y)*E+g)*E+h)/((((P*E+S)*E+A)*E+T)*E+1)):(E=e-.5,v=E*E,D=(((((t*v+r)*v+n)*v+i)*v+s)*v+o)*E/(((((a*v+u)*v+l)*v+c)*v+p)*v+1)),D-Math.sqrt(2*Math.PI)*(.5*io(-D/Math.SQRT2)-Math.exp(.5*D*D)*e))}function e0(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let r=-1,n=Math.ceil(t);for(;Wl(n,t)<e;)n=2*n;let i=Math.floor(r+(n-r)/2);for(;r<i&&i<n;)Wl(i,t)<e?r=i:n=i,i=Math.floor(r+(n-r)/2);return n}function t0(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||r>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(r===1)return t;if(r===0)return 0;let n=-1,i=t,s=Math.floor(n+(i-n)/2);for(;n<s&&s<i;)qf(s,t,r)<e?n=s:i=s,s=Math.floor(n+(i-n)/2);return i}function r0(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return jh(t,e);let r,n;if(e===.5)return 0;if(e>.5)r=t>1?ub(e):jh(1,e),n=t>1?jh(1,e):Math.pow(Zf(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-r0(1-e,t);return JN(t,e,r,n)}function jh(e,t){let r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:let n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return tb(t-.5)*2*Math.sqrt(n-1);default:throw new Error(\"_invTSimple() must be called with 1, 2, or 4 df.\")}}function JN(e,t,r,n){if(!isFinite(r)||!isFinite(n))return NaN;let i=r,s=n;for(;;){let o=xi(i,s),a=Na(e,o);if(o===i||o===s)return a>t?i:s;a<t?i=o:s=o}}function QN(e,t,r){return e<0||e>1||r<=t?NaN:e===0?t:e===1?r:t+e*(r-t)}function n0(e,t){let r=Hf(e);return(Fs(e)-t)*Math.sqrt(e.length)/r}function i0(e,t){let r=e.length,n=Fs(e),i=Hf(e),s=t.length,o=Fs(t),a=Hf(t),u=Math.sqrt(((r-1)*i*i+(s-1)*a*a)/(r+s-2));return(n-o)/(u*Math.sqrt(1/r+1/s))}function Tu(e,t,r){return r<0?zf(-1/0,e,t):r>0?zf(-1/0,-e,t):2*zf(-1/0,-Math.abs(e),t)}function lb(e,t){arguments.length===1&&(t=0);let r=n0(e,t),n=e.length-1;return{lessThan:Tu(r,n,-1),greaterThan:Tu(r,n,1),notEqual:Tu(r,n,0)}}function cb(e,t){let r=i0(e,t),n=e.length+t.length-2;return{lessThan:Tu(r,n,-1),greaterThan:Tu(r,n,1),notEqual:Tu(r,n,0)}}function pb(e){return{min:s0(e),q1:Ra(e,1),median:u0(e),q3:Ra(e,3),max:o0(e)}}function KN(e){return e.length}function s0(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t}function o0(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t}function a0(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let r=e.length,n=Ca(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]}function Ra(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let r=Ca(e),n=Jf(e,t),i=Math.floor(n),s=Math.ceil(n);return(e[r[i]]+e[r[s]])/2}function Ca(e){let t=e.length,r=[];for(let n=0;n<t;n++)r.push(n);return r.sort(function(n,i){return B(Qi(e[n],e[i]))}),r}function Jf(e,t){t=Math.round(t);let r=e.length,n=r%2===1,i;return r===1?0:(t===0&&(i=0),t===2&&(i=(r-1)/2),t===4&&(i=r-1),t===1&&(i=n?(r+1)/4-1:(r+2)/4-1),t===3&&(i=n?(3*r+3)/4-1:(3*r+2)/4-1),i===void 0?NaN:i)}function eA(e,t){return Ca(e)[Math.ceil(t*(e.length-1))]+1}function tA(e,t){return Ca(e)[Math.floor(t*(e.length-1))]+1}function rA(e,t){return Ca(e)[Math.ceil(Jf(e,t))]+1}function nA(e,t){return Ca(e)[Math.floor(Jf(e,t))]+1}function u0(e){return a0(e,.5)}function iA(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(r=n,t=e[n])}return r+1}function sA(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;r=n,t=e[n]}return r+1}function Ql(e){let t=Fs(e),r=0;for(let n=0;n<e.length;n++){let i=e[n]-t;r+=i*i}return r/e.length}function oA(e){let t=Fs(e),r=0;for(let n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length}function l0(e){let t=e.length;return Ql(e)*t/(t-1)}function c0(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=Fs(e),i=Fs(t),s=0;for(let o=0;o<r;o++)s+=(e[o]-n)*(t[o]-i);return s/r}function aA(e,t){let r=Math.min(e.length,t.length);return c0(e,t)*r/(r-1)}function Qf(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=Fs(e),i=Fs(t),s=0,o=0,a=0;for(let u=0;u<r;u++){let l=e[u]-n,c=t[u]-i;s+=l*l,o+=c*c,a+=l*c}return a/Math.sqrt(s*o)}function fb(e,t,r,n){let i=e[0];for(let o=2;o<e.length;o++){let a=B(Ki(Qi(e[o],i),r));if(!cn(a,o,10))return 0}let s=B(n);for(let o=0;o<t.length-1;o++){let a=B(Ki(Qi(t[o],i),r));if(!cn(a,s-t.length+o,10))return 0}return!isFinite(s)||s<e.length||s<t.length?0:s}function db(e){return e<0||!isFinite(e)?0:e}function Qh(e){let t=e.length;if(t===0)return[];let r=[],n=[];for(let a=0;a<t;a++)n.push([e[a],a]);n.sort(function(a,u){let l=a[0],c=u[0];return l===1/0&&c===1/0||l===-1/0&&c===-1/0?0:l-c});let i=0,s=1,o=1;for(;i<t;){let a=i;for(;a<t-1&&n[a][0]===n[a+1][0];)a+=1;o=a-i+1;let u;for(a=0;a<o;a++)u=n[i+a][1],r[u]=isNaN(e[u])?NaN:s+.5*(o-1);s+=o,i+=o}return r}function uA(e,t){let r=Math.min(e.length,t.length);return e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r)),Qf(Qh(e),Qh(t))}function Hf(e){return Math.sqrt(l0(e))}function lA(e){return Math.sqrt(Ql(e))}var cA=kl;function Mu(e,t){return as(t[0]-e[0],t[1]-e[1])}function pA(e,t){return as(t[0]-e[0],as(t[1]-e[1],t[2]-e[2]))}function p0(e,t,r){return[nn(Math.round(e),0,255),nn(Math.round(t),0,255),nn(Math.round(r),0,255)]}function fA(e,t,r){e=nn(e,0,360),t=nn(t,0,1),r=nn(r,0,1);let n=r*(1-t/2);n===0||n===1?t=0:t=(r-n)/Math.min(n,1-n);let{r:i,g:s,b:o}=Cf(e,t,n).rgb();return p0(i,s,o)}function dA(e){return e}function mA(e,t){return[e,t]}function yA(e,t,r){return[e,t,r]}function gA(e,t){return[e,t]}function hA(e){return e}function bA(e){let t=[];if(e.length===0)return[];for(let r=0;r<e.length-1;r++)t.push([e[r],e[r+1]]);return t.push([e[e.length-1],e[0]]),t}function mb(e){if(e.length==0)return 0;let t=[...e,e[0]];return DI(t)}function xA(e){let t=0;for(let r=0;r<e.length-1;r++){let[n,i]=e[r],[s,o]=e[r+1];t+=Ni(s-n,o-i)}if(e.length>1){let[r,n]=e[e.length-1],[i,s]=e[0];t+=Ni(i-r,s-n)}return t}function TA(e){let t=!1;for(let r=0;r<e.length;r++){let n=(r+1)%e.length;e[r][0]===e[n][0]&&e[r][1]===e[n][1]&&(t=!0)}return t?e.filter((r,n)=>{let i=e[n===0?e.length-1:n-1];return r[0]!==i[0]||r[1]!==i[1]}):e}function PA(e){let[t,r,n,i]=e;return[t,n>=0?r:r+n,n>=0?n:-n,i]}function f0(e,t,r){if(e.length===0)return[];e=TA(e);let n=NI([...e,e[0]]),i=[];for(let s=0;s<e.length;s++){let o=e[s>0?s-1:e.length-1],a=e[s],u=e[s<e.length-1?s+1:0],l=n[s]===1,c=BA(o,a,u,l?\"counterclockwise\":\"clockwise\",r);i.push(t?c:PA(c))}return i}function IA(e,t){return f0(e,!1,t)}function MA(e,t){return f0(e,!0,t)}function yb(e,t){return[e,t]}var EA=yb,vA=yb;function d0(e,t){let r=[t[0]-e[0],t[1]-e[1]],n=[e[0],e[1]];return m0(r,n)}function m0(e,t){return[e,t]}function OA(e){return e[0]}function SA(e){return e[1]}function DA(e){return e}function NA(e,t){return[e,t]}function AA(e){return e[0]}function RA(e){return e[1]}function CA(e,t,r){return[e,t,r]}function Ou([e,t,r]){let[n,i]=e,[s,o]=t,[a,u]=r,l=s*s+o*o,c=(n*n+i*i-l)/2,p=(l-a*a-u*u)/2,f=(n-s)*(o-u)-(s-a)*(i-o);f=1/f;let d=(c*(o-u)-p*(i-o))*f,m=((n-s)*p-(s-a)*c)*f;return[d,m]}function Su(e){let[[t,r],[n,i],[s,o]]=e,a=n-t,u=i-r,l=s-n,c=o-i;return 2*Math.atan2(a*c-l*u,a*l+u*c)}function gb(e){let t=Math.abs(Su(e));return t<1e-9||t>2*Math.PI-1e-9}function y0(e){return Math.abs(e)===Math.PI?Math.PI:UI(e+Math.PI,2*Math.PI)-Math.PI}function g0(e,t,r,n){return[e,y0(t),r,n]}function LA([e,t,r,n]){return[e,t,r,n]}function wA(e){return e[2]}function _A(e){return e[3]}function h0(e){let[t,r,n,i]=e,s=Math.PI*2,o=n===0?s:n>0?n-s:n+s;return[t,r,o,i]}function FA(e){let[t,r,n,i]=h0(e);return[t,r,n,i]}function VA(e){let[t,r,n,i]=e,s=n>=0?Math.PI-n:-Math.PI-n;return[t,y0(r+n),s,i]}function BA(e,t,r,n,i){let s=e[0]-t[0],o=e[1]-t[1],a=r[0]-t[0],u=r[1]-t[1],l=Math.atan2(o,s),c=Math.atan2(s*u-o*a,s*a+o*u),p=2*Math.PI;return n===\"clockwise\"?c-=c<0?0:p:n===\"counterclockwise\"&&(c+=c<0?p:0),g0(t,l,c,i)}function hb(e,t){let[[r,n],[i,s]]=e;return[[t*r,t*n],[t*i,t*s]]}var GA=hb,zA=hb;function qA(e,t){let[[r,n],i]=e;return[[t*r,t*n],t*i]}function UA(e,t){let[[r,n],[i,s],[o,a]]=e;return[[t*r,t*n],[t*i,t*s],[t*o,t*a]]}function HA(e,t){let[[r,n],i,s,o]=e;return[[t*r,t*n],t*i,t*s,o]}function bb(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,l]]=t;return[[r+o,n+a],[i+u,s+l]]}var kA=bb,$A=bb;function YA(e,t){let[[r,n],i]=e,[[s,o],a]=t;return[[r+s,n+o],i+a]}function XA(e,t){let[[r,n],[i,s],[o,a]]=e,[[u,l],[c,p],[f,d]]=t;return[[r+u,n+l],[i+c,s+p],[o+f,a+d]]}function WA(e,t){let[[r,n],i,s,o]=e,[[a,u],l,c]=t;return[[r+a,n+u],i+l,s+c,o]}function xb(e,t){let[[r,n],[i,s]]=e;return[(1-t)*r+t*i,(1-t)*n+t*s]}function Tb(e,t){return xb(e,nn(t,0,1))}function Kh(e,t){return xb(e,nn(t,0,1/0))}function ZA(e,t){let[[r,n],i]=e,s=Math.min(1,Math.max(0,t));return[r+i*Math.cos(2*Math.PI*s),n+i*Math.sin(2*Math.PI*s)]}function b0(e,t){let r=Kf(e);if(!r)return[NaN,NaN];if(r.type===\"segment\")return Tb([e[0],e[2]],t);if(r.type===\"rays\")return t<=0?Kh([r.start1,r.end1],-t):t>=1?Kh([r.start2,r.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let n=Ou(e),i=Su(e),s=Math.atan2(e[0][1]-n[1],e[0][0]-n[0]),o=Mu(n,e[0]),a=s+t*i;return[n[0]+o*Math.cos(a),n[1]+o*Math.sin(a)]}function jA(e,t){if(isNaN(t))return[NaN,NaN];if(t<0||t>=e.length)return e[0];let r=Math.floor(t);return Tb([e[r],e[(r+1)%e.length]],t-r)}function Kf(e){let[t,r,n]=e,[[i,s],[o,a],[u,l]]=[t,r,n];if(isNaN(i)||isNaN(s)||isNaN(o)||isNaN(a)||isNaN(u)||isNaN(l))return;let c=Ou([t,r,n]),p=Mu(c,t);if(isFinite(p)&&!gb([t,r,n])){let f=Math.atan2(t[1]-c[1],t[0]-c[0]),d=f+Su([t,r,n]);return{type:\"arc\",center:c,radius:p,startAngle:f,endAngle:d}}else{let f=Ji(o,a,0,i,s,0,u,l,0);return f<0||f>1?{type:\"rays\",start1:[i,s],end1:[i+(i-u),s+(s-l)],start2:[u,l],end2:[u+(u-i),l+(l-s)]}:{type:\"segment\",start:[i,s],end:[u,l]}}}function JA(e,t,r){return Mu(e,t)>1e-9?t:Mu(e,r)>1e-9?r:e}function jl(e,t){let[[r,n],i]=e,[[s,o],a]=t,u=as(s-r,o-n),l=i+a,c=i-a,p=u*u,f=Math.sqrt((u+l)*(-u+l)*(u-c)*(u+c))/4,d=i*i,m=a*a;return[(s+r)/2+(s-r)*(d-m)/(2*p)+-2*(o-n)*f/p,(o+n)/2+(o-n)*(d-m)/(2*p)+2*(s-r)*f/p]}function x0(e,t,r){let[[n,i],s]=e,[[o,a],[u,l]]=t,c=o-n,p=u-n,f=a-i,d=l-i,m=p-c,y=d-f,g=m*m+y*y,h=c*d-p*f,P=s*s*g-h*h;if(P<0)return[NaN,NaN];let S=Math.sqrt(P);return S<0?[NaN,NaN]:[n+(h*y+r*m*S)/g,i+(-h*m+r*y*S)/g]}function QA(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,l]]=t,c=s-n,p=r-i,f=l-a,d=o-u,m=c*r+p*n,y=f*o+d*a,g=c*d-f*p;return g===0?[NaN,NaN]:[(d*m-p*y)/g,(c*y-f*m)/g]}function Pb(e,t,r=0){let n=x0(t,e,-1);return vu(n,e,r,!0)?n:[NaN,NaN]}function Ib(e,t,r=0){let n=x0(e,t,1);return vu(n,t,r,!1)?n:[NaN,NaN]}function T0(e,t,r=0){let n=QA(e,t);return!vu(n,e,r,!0)||!vu(n,t,r,!1)?[NaN,NaN]:n}function KA(e,t,r=0){let n=M0(t,e,r,-1);return Eu(n,t,r,!1)?n:[NaN,NaN]}function P0(e,t,r=0){let n=E0(t,e,r,-1);return!vu(n,e,r,!0)||!Eu(n,t,r,!1)?[NaN,NaN]:n}function eR(e,t,r=0){let n=M0(e,t,r,1);return Eu(n,e,r,!0)?n:[NaN,NaN]}function I0(e,t,r=0){let n=E0(e,t,r,1);return!Eu(n,e,r,!0)||!vu(n,t,r,!1)?[NaN,NaN]:n}function tR(e,t,r=0){let n=rR(e,t,r);return!Eu(n,e,r,!0)||!Eu(n,t,r,!1)?[NaN,NaN]:n}function rR(e,t,r){let n=$f(e);if(Yf(n))return P0(n,t,r);let i=$f(t);return Yf(i)?I0(e,i,r):Mb(()=>jl(n,i),()=>jl(i,n),s=>Eb(-1,kf(e,s),kf(t,s)))}function M0(e,t,r,n){let i=$f(e);return Yf(i)?n>0?Ib(t,i,r):Pb(i,t,r):Mb(()=>jl(i,t),()=>jl(t,i),s=>Eb(n,kf(e,s),nR(t,s)))}function E0(e,t,r,n){let i=$f(e);return Yf(i)?T0(i,t,r):Mb(()=>Ib(i,t,r),()=>Pb(t,i,r),s=>Eb(n,kf(e,s),iR(t)))}function Mb(e,t,r){let n=e();if(r(n))return n;let i=t();return r(i)?i:[NaN,NaN]}function Eb(e,t,r){return e*v0(t,r)>0}function kf(e,[t,r]){let[n,i]=Ou(e);return Su(e)>0?[i-r,t-n]:[r-i,n-t]}function nR([[e,t]],[r,n]){return[t-n,r-e]}function iR([[e,t],[r,n]]){return[r-e,n-t]}function $f(e){let t=Ou(e),r=Mu(t,b0(e,0));return isFinite(r)&&!gb(e)?[t,r]:[e[0],e[2]]}function Yf(e){return Array.isArray(e[1])}function Eu([e,t],r,n,i){let[s,o]=Ou(r);return(i?(n&3)===0:(n&12)===0)||Fc(Math.atan2(t-o,e-s),Math.atan2(r[0][1]-o,r[0][0]-s),Su(r))}function vu([e,t],[[r,n],[i,s]],o,a){let u=Ji(e,t,0,r,n,0,i,s,0),[l,c]=a?[(o&1)===0,(o&2)===0]:[(o&4)===0,(o&8)===0];return!isNaN(u)&&(u>=0||l)&&(u<=1||c)}function sR(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(i-r),a+(s-n)]]}function oR(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(s-n),a-(i-r)]]}function v0(e,t){let[r,n]=e,[i,s]=t;return r*s-i*n}function aR(e,t){let[r,n]=e,[i,s]=t;return r*i+n*s}function uR(e){let[t,r]=e;return[-r,t]}function lR(e,t,r){return[e,t,r]}function cR(e){return[[1,0],e,!1]}function pR(e,t){let[r,n]=e;return[[t,0],[(1-t)*r,(1-t)*n],!1]}function fR(e,t){let[r,n]=e,i=Math.cos(t),s=Math.sin(t);return[[i,s],[r*(1-i)+n*s,n*(1-i)-r*s],!1]}function dR(e){let[[t,r],[n,i]]=e,s=n-t,o=i-r,a=s*s+o*o;return[[(s*s-o*o)/a,2*s*o/a],[(1-(s*s-o*o)/a)*t-2*s*o/a*r,(1+(s*s-o*o)/a)*r-2*s*o/a*t],!0]}function mR(e,t){let[[r,n],[i,s],o]=e,[[a,u],[l,c],p]=t;return o&&(u=-u,c=-c,p=!p),[[a*r-u*n,a*n+u*r],[i+r*l-n*c,s+r*c+n*l],p]}function yR(e){let[[t,r],[n,i],s]=e,o=t*t+r*r,a=t/o,u=-r/o,l=-(t/o*n+r/o*i),c=-(t/o*i-r/o*n);return s&&(u=-u,c=-c),[[a,u],[l,c],s]}function _s(e,t){let[[r,n],[i,s],o]=e,[a,u]=t;return o&&(u=-u),[r*a-n*u+i,r*u+n*a+s]}function gR(e,t){let[r,n,i]=e;return i?-t:t}function ed(e,t){let[r,n]=t;return[_s(e,r),_s(e,n)]}var hR=ed,bR=ed;function xR(e,t){let[r,n]=t,i=[n,[n[0]+r[0],n[1]+r[1]]],s=ed(e,i);return d0(s[0],s[1])}function TR(e,t){let[r,n]=t,[[i,s]]=e;return[_s(e,r),as(i,s)*n]}function PR(e,t){let[r,n,i]=t;return[_s(e,r),_s(e,n),_s(e,i)]}function IR(e,t){let r=[];for(let n of t)r.push(_s(e,n));return r}function MR(e,t){let[r,n,i]=t,s=_s(e,r),[o,a,u]=e,[l,c]=_s([o,[0,0],u],[Math.cos(n),Math.sin(n)]),p=Math.atan2(c,l),f=gR(e,i);return[s,p,f,t[3]]}function ER(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function vR(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function OR(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],s=eb(i);r.hasOwnProperty(s)||(r[s]=!0,t.push(n))}return t}function eb(e){if(Array.isArray(e))return`[${e.map(eb).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(SR(e)){let r=[];for(let n in e.updateRules)r.push(`\"${n}\": ${eb(e.updateRules[n].value)}`);return`{${r.join(\",\")}}`}else return B(e).toString();default:return e}}function SR(e){return typeof e!=\"object\"||!e?!1:e.type===\"Action\"}function dn(e){if(!ls(e))throw new Error(\"Programming error: expected an array but found \"+typeof e)}function ls(e){return Array.isArray(e)}function O0(e){if(ls(e))for(let{compiled:t}of e)t&&vb(t)}function iU(e){if(ls(e))for(let{compiled:t}of e)t&&DR(t)}function vb(e){delete e.fn}function DR(e){e.fn=Ob(e.args,e.source,e.constants)}function Ob(e,t,r){let i=\"return (function(\"+e.join(\",\")+'){\"use strict\"; '+t+\"})\";return new Function(\"BuiltIn\",\"ErrorMsg\",\"_C\",i)(us,ir,r)}function be(e){return e.type<=3}function S0(e){return!be(e)}function On(e){switch(e.type){case 21:case 23:case 19:return!0;default:return!1}}function $r(e){switch(e.type){case 20:case 22:case 24:return!0;default:return!1}}function N0(e){let t=\"\",r=(e.instructionsLength()-1).toString().length,n=0,i=!1;for(let s=0;s<e.instructionsLength();s++){let o=e.getInstruction(s),a=e.comments[s]||\"\",u=o.type===0&&o.removedInstructionForDebuggingOnly;if(($r(o)||u&&$r(u))&&(n-=1),o.type===0&&!u)i||(t+=`${D0(s,r)}: ${Nb(2*n)}...\n`),i=!0;else{i=!1;let l=u?\" [X]\":\"    \";t+=`${D0(s,r)}:${l} ${Nb(2*n)}${La(e,s)}${a?`\t\t# ${a}`:\"\"}\n`}(On(o)||u&&On(u))&&(n+=1)}return t}function La(e,t){let r=e.getInstruction(t);switch(r.type===0&&r.removedInstructionForDebuggingOnly&&(r=r.removedInstructionForDebuggingOnly),r.type){case 0:return Kn(r.type);case 2:return`${Kn(r.type)} ${In(r.valueType)} ${e.argNames[t]}`;case 3:return`${Kn(r.type)} ${In(r.valueType)}`;case 1:return`${Kn(r.type)} ${In(r.valueType)} ${Db(r.value)}`;case 37:case 42:return`${Kn(r.type)} ${In(r.valueType)} ${r.symbol} ${r.args.join(\" \")}`;case 44:return`${Kn(r.type)} ${In(r.valueType)} ${r.tag} ${r.args.join(\" \")}`;case 48:return`${Kn(r.type)} ${In(r.valueType)} ${r.args.join(\" \")}${r.isConstantBroadcast?\" (constant)\":\"\"}`;case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 33:case 38:case 39:case 40:case 41:case 47:case 49:return`${Kn(r.type)} ${In(r.valueType)} ${r.args.join(\" \")}`;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}function Kn(e){switch(e){case 0:return\"Noop\";case 1:return\"Constant\";case 8:return\"Add\";case 9:return\"Subtract\";case 10:return\"Multiply\";case 11:return\"Divide\";case 12:return\"Exponent\";case 13:return\"RawExponent\";case 14:return\"Negative\";case 15:return\"OrderedPair\";case 17:return\"OrderedPairAccess\";case 16:return\"OrderedTriple\";case 18:return\"OrderedTripleAccess\";case 19:return\"BeginLoop\";case 20:return\"EndLoop\";case 21:return\"BeginIntegral\";case 22:return\"EndIntegral\";case 23:return\"BeginBroadcast\";case 24:return\"EndBroadcast\";case 25:return\"Equal\";case 26:return\"Less\";case 27:return\"Greater\";case 28:return\"LessEqual\";case 29:return\"GreaterEqual\";case 31:return\"Or\";case 32:return\"And\";case 33:return\"Piecewise\";case 38:return\"List\";case 39:return\"ListAccess\";case 40:return\"DeferredListAccess\";case 41:return\"InboundsListAccess\";case 37:return\"NativeFunction\";case 42:return\"Distribution\";case 2:return\"LoadArg\";case 47:return\"BlockVar\";case 48:return\"BroadcastResult\";case 3:return\"SymbolicVar\";case 44:return\"ExtendSeed\";case 49:return\"Action\";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function Db(e){if(Array.isArray(e))return`[${e.map(Db).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(Ma(e)){let t=[];for(let r in e.updateRules)t.push(`\"${r}\": ${Db(e.updateRules[r].value)}`);return`{${t.join(\", \")}}`}else return`${e.n}/${e.d}`;default:throw new Error(\"Unexpected value: \"+e)}}function D0(e,t){let r=e.toString();return Nb(t-r.length)+r}function Nb(e){let t=\"\";for(let r=0;r<e;r++)t+=\" \";return t}function Gt(e){return e.type===1}function A0(e){if(!Gt(e))throw new Error(`Programming error: expected constant instruction but found ${Kn(e.type)} instead.`)}function NR(e){return e.type===48&&e.isConstantBroadcast}function Ao(e){return Gt(e)||NR(e)}function td(e,t,r){let n=e.getInstruction(r);if(!be(n)){for(let o of n.args)if(!Ao(e.getInstruction(o)))return!0}if(t<r)return!Ao(e.getInstruction(t));let i=[!0];for(let o=r+1;o<=t;o++)i.push(!1);let s=[t];for(;s.length;){let o=s.pop();if(i[o-r])continue;i[o-r]=!0;let a=e.getInstruction(o);if(!be(a))for(let u of a.args)if(u<r){if(!Ao(e.getInstruction(u)))return!0}else i[u-r]||s.push(u)}return!1}function Ab(e,t,r){if(q(t)){let n=[];for(let i=0;i<r.length;i++)n.push(Ab(e,Fe(t),r[i]));return e.ConstantOfType(t,n)}switch(t){case b:return e.Constant(r);case me:return e.ConstantOfType(t,r);case N:return e.ConstantOfType(t,r);case z:return e.ConstantOfType(t,r);case ot:return e.ConstantOfType(t,r);default:throw new Error(\"Cannot reconstitute value of a \"+ne(t)+\".\")}}function cs(e,t,r){let n=sr(e,t);if(n===void 0)throw new Error(`${r}\nNon-constant instruction: \"${La(e,Qr(e,t))}\"`);return n}function sr(e,t){let r=Du(e,t);if(!(r<0))return r}function Du(e,t,r){var o;let n=r&&r[t];if(n)return n;let i=e.getInstruction(t),s;switch(i.type){case 38:s=i.args.length;break;case 1:s=i.value.length;break;case 48:{s=(o=i.constantLength)!=null?o:-1;break}}return s===void 0&&(r=r||{},s=AR(e,i,r)),r&&(r[t]=s),s}function AR(e,t,r){switch(t.type){case 33:{let n=Du(e,t.args[1],r),i=Du(e,t.args[2],r);return n===i?n:-1}case 37:switch(t.symbol){case\"elementsAt\":return Du(e,t.args[1],r);case\"sortPerm\":return Du(e,t.args[0],r);case\"shuffle\":return Du(e,t.args[1],r);default:return-1}default:{if(q(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${Kn(t.type)} ${ne(t.valueType)}.`)}}}function Qr(e,t){let r=e.getInstruction(t);if(!q(r.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(r.type){case 38:return e.Constant(r.args.length);case 1:return e.Constant(r.value.length);case 48:{let n=e.getInstruction(r.args[0]);return e.getInstruction(n.args[0]).args[0]}case 37:switch(r.symbol){case\"elementsAt\":return Qr(e,r.args[1]);case\"sortPerm\":return Qr(e,r.args[0]);case\"shuffle\":return Qr(e,r.args[1])}}return e.SyntheticNativeFunction(\"count\",[t])}function ec(e,t){let r=[];for(let o of t)q(e.getInstruction(o).valueType)&&r.push(o);if(r.length===0)return;if(r.length===1)return Qr(e,r[0]);let n=[];for(let o of r)n.push(sr(e,o));let i,s=1/0;for(let o=0;o<n.length;o++){let a=r[o],u=n[o];if(u===void 0)return e.SyntheticNativeFunction(\"min\",[e.List(r.map(l=>Qr(e,l)))]);u<s&&(i=a,s=u)}return i!==void 0?Qr(e,i):e.Constant(s)}function R0(e,t){if(q(e)){let r=Fe(e);for(let n=0;n<t.length;n++)if(Ti(r,t[n]))return!0;return!1}return Ti(e,t)}function Ti(e,t){switch(e){case b:return jn(t);case N:{let[r,n]=t;return jn(r)||jn(n)}case z:{let[r,n,i]=t;return jn(r)||jn(n)||jn(i)}case ot:{let[r,n,i]=t;return jn(r)||jn(n)||jn(i)}case Ee:{for(let r of t)if(Ti(N,r))return!0;return!1}case xe:case oe:case ve:case pe:{let[r,n]=t;return Ti(N,r)||Ti(N,n)}case ue:{let[r,n]=t;return Ti(N,r)||Ti(b,n)}case ee:{let[r,n,i]=t;return Ti(N,r)||Ti(N,n)||Ti(N,i)}case Ie:case ye:{let[r,n,i]=t;return Ti(N,r)||Ti(b,n)||Ti(b,i)}case Be:return Object.keys(t.updateRules).length===0;case me:return!1;default:throw new Error(\"Type cannot contain a NaN value: \"+ne(e)+\".\")}}function Rb(e,t){return Ms(e,t)}function Cb(e,t){return Qi(e,t)}function Lb(e,t){return Es(e,t)}function wb(e,t){return Ki(e,t)}function tc(e,t){return B(e)===Math.E?Math.exp(B(t)):Sm(e,t)}var RR=tc;function _b(e){return li(e)}function CR(e,t){return[e,t]}function LR(e,t){return e[B(t)-1]}function wR(e,t,r){return[e,t,r]}function _R(e,t){return e[B(t)-1]}function Fb(e,t){return B(e)===B(t)}function Vb(e,t){return B(e)<B(t)}function Bb(e,t){return B(e)>B(t)}function Gb(e,t){return B(e)<=B(t)}function zb(e,t){return B(e)>=B(t)}function C0(e,t){return e||t}function L0(e,t){return e&&t}function FR(e,t,r){let n=Math.floor(B(r))-1;return!isFinite(n)||n<0||n>=t.length?gi(e):t[n]}function qb(e,t,r){return er(r)&&(r=B(r)),`${t}::${e}${r}`}function Ub(e,t){switch(e){case\"mod\":return JT(t[0],t[1]);case\"abs\":return ZT(t[0]);case\"sqrt\":return jT(t[0]);case\"nthroot\":return Vc(t[0],t[1]);case\"total\":return QT(t[0]);case\"count\":return t[0].length;case\"validateRangeLength\":{let r=t[0],n=t[1],i=t[2],s=t[3],o=fb(r,n,i,s);if(o===0)throw Dl();return o}case\"validateSampleCount\":{let r=is(t[0]),n=db(r);if(n===0&&r!==0)throw fh();return n}case\"select\":case\"elementsAt\":case\"uniquePerm\":case\"sortPerm\":{let r=lr[e];return us[r.symbol].apply(null,t)}default:{let r=lr[e];return(r.module===\"Math\"?Math:us)[r.symbol].apply(null,is(t))}}}function rd(e,t){let r=Array(t+1);return Ae(e,t,r)}function w0(e,t,r){let n=Array(t+1);for(let i=0;i<r.length;i++)n[i]=r[i];return Ae(e,t,n)}function _0(e,t,r){let n=Array(t+1);return nd(e,t,r,n)}function F0(e,t,r){let n=Array(t+1),i=[];for(let s of r)i.push(nd(e,t,s,n));return i}function V0(e,t,r){if(t.constantLength)return t.constantLength;let n=t.args[0],s=e.getInstruction(n).args[0],o=e.getInstruction(s);return B(Ae(e,o.args[0],r))}function nd(e,t,r,n){let i=e.getInstruction(t),s=V0(e,i,n);if(!isFinite(r)||r<0||r>=s)return gi(Fe(i.valueType));let o=i.args[0],a=t-o,u=e.getInstruction(o),l=u.args[0],c=u.args[a];n[l]=r+1;let p=Ae(e,c,n);for(let f=l;f<=o;f++)n[f]=void 0;return p}function VR(e,t,r){let n=e.getInstruction(t),i=V0(e,n,r),s=[];for(let o=i-1;o>=0;o--)s[o]=nd(e,t,o,r);return s}function B0(e,t,r){let n=Ae(e,t.args[1],r),i=t.args[0],s=e.getInstruction(i);if(s.type===48)return nd(e,i,B(n)-1,r);if(s.type===33){let o=Ae(e,s.args[0],r);return B0(e,se($({},t),{args:[o?s.args[1]:s.args[2],t.args[1]]}),r)}else{let o=Ae(e,t.args[0],r);return FR(t.valueType,o,n)}}function Ae(e,t,r){let n=r[t];if(n!==void 0)return n;let i=BR(e,t,r);return typeof i==\"number\"&&i===Math.floor(i)&&(i=Me(i,1)),r[t]=i,i}function BR(e,t,r){let n=e.getInstruction(t);switch(n.type){case 1:return n.value;case 8:return Rb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 9:return Cb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 10:return Lb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 11:return wb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 12:return tc(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 13:return RR(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 14:return _b(Ae(e,n.args[0],r));case 15:return CR(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 16:return wR(Ae(e,n.args[0],r),Ae(e,n.args[1],r),Ae(e,n.args[2],r));case 17:return LR(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 18:return _R(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 25:return Fb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 26:return Vb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 27:return Bb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 28:return Gb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 29:return zb(Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 31:return Ae(e,n.args[0],r)||Ae(e,n.args[1],r);case 32:return Ae(e,n.args[0],r)&&Ae(e,n.args[1],r);case 44:return qb(n.tag,Ae(e,n.args[0],r),Ae(e,n.args[1],r));case 33:return Ae(e,n.args[0],r)?Ae(e,n.args[1],r):Ae(e,n.args[2],r);case 37:{let s=[];for(let o of n.args)s.push(Ae(e,o,r));return Ub(n.symbol,s)}case 38:{let s=[];for(let o of n.args)s.push(Ae(e,o,r));return s}case 39:case 40:case 41:return B0(e,n,r);case 48:return VR(e,t,r);case 47:{let s=n.args[0],o=e.getInstruction(s).args[0],a=t-s,l=e.getInstruction(s).args[a],c=[];c[l]=!0;for(let d=l;d>=o;d--){if(!c[d])continue;let m=e.getInstruction(d);if(!be(m))for(let y of m.args)y<o?Ae(e,y,r):c[y]=!0}let p=e.copy();p.truncate(o);for(let d=0;d<o;d++){let m=r[d],y=e.getInstruction(d);if(m!==void 0){let g=y.valueType;p.replaceInstructionWithConstant(d,{type:1,valueType:g,value:m})}}p.reopenAllBlocks();let f=[];for(let d=o;d<t;d++){let m=e.getInstruction(d);if(be(m))f.push(p.copyInstruction(m));else{let y=[];for(let g of m.args)y.push(g<o?g:f[g-o]);m.type===40?f.push(p.InboundsListAccess(y)):f.push(p.copyInstructionWithArgs(m,y))}}return p.Noop(),p.replaceInstructionWithBlockVar(p.getReturnIndex(),{type:47,valueType:n.valueType,args:[s<o?s:f[s-o]]}),p.close().getCompiledFunction().fn()}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:throw new Error(`Programming Error: cannot interpret opcode ${n.type}`);default:let i=n;throw new Error(`Programming Error: unexpected opcode ${i.type}`)}}function sn(e,t){let r=[],n=[];for(let i=0;i<t;i++)n.push(!1);n.push(!0);for(let i=t;i>=0;i--){if(!n[i])continue;let s=e.getInstruction(i);if(s.type===2)r.push({symbol:e.argNames[i],scope:\"free\"});else if(On(s))switch(s.type){case 21:r.push({symbol:s.callData.indexSymbol,scope:\"integral\"});break;case 19:r.push({symbol:s.callData.indexSymbol,scope:s.callData.type});break;case 23:if(s.listComprehensionCallData)for(let a of s.listComprehensionCallData.inputListSymbols)r.push({symbol:a,scope:\"comprehension\"});break;default:let o=s;throw new Error(`Programming Error: unexpected loop instruction ${o.type}`)}else s.type===3&&s.symbol&&r.push({symbol:s.symbol,scope:\"symbolic-var\"});if(!be(s))for(let o of s.args)n[o]=!0}return r.reverse()}function Vr(e,t){let r=e.getInstruction(t);if(r.type!==48)return t;if(r.isConstantBroadcast)return G0(e,t,r);let n=r.args[0],i=e.getInstruction(n),s=i.args[0],o=!1;for(let l=s+1;l<n;l++){let c=e.getInstruction(l);if(c.type===40&&c.args[1]===s){o=!0;break}}if(!o)return t;let a=[];for(let l=s;l<=n+i.args.length-1;l++){let c=e.getInstruction(l);if(be(c))a.push(e.copyInstruction(c));else{let p=[];for(let f of c.args)p.push(f>=s?a[f-s]:f);c.type===40?a.push(e.InboundsListAccess(p)):a.push(e.copyInstructionWithArgs(c,p))}}let u=e.getInstruction(e.getReturnIndex());return u.type===48&&u.isConstantBroadcast?G0(e,e.getReturnIndex(),u):e.getReturnIndex()}function G0(e,t,r){if(r.valueType===Qt){let i=sr(e,t);if(i==null)throw wl(sn(e,t));let s=[];for(let o=0;o<i;o++){let a=e.InboundsListAccess([t,e.Constant(o+1)]);s.push(a)}return e.List(s)}let n=rd(e,t);return t===e.getReturnIndex()&&e.popInstruction(),e.ConstantOfType(r.valueType,n)}function rc(e,t,r){let n=e.getInstruction(t);if(q(n.valueType)){let i=sr(e,t);if(r=Math.floor(r),isNaN(r)||r<0||i!==void 0&&r>=i){let s=Fe(n.valueType);return e.NanOfType(s)}return n.type===38?n.args[r]:n.type===1&&q(n.valueType)?e.ConstantOfType(Fe(n.valueType),n.value[r]):n.type===48&&n.isConstantBroadcast?e.ConstantOfType(Fe(n.valueType),_0(e,t,r)):i!==void 0?e.InboundsListAccess([t,e.Constant(r+1)]):e.ListAccess([t,e.Constant(r+1)])}else{if(n.valueType===N)return isNaN(r)||r<0||r>2?e.Constant(NaN):n.type===15?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedPairAccess([t,e.Constant(r+1)]);if(n.valueType===z)return isNaN(r)||r<0||r>3?e.Constant(NaN):n.type===16?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedTripleAccess([t,e.Constant(r+1)]);throw new Error(`Cannot access elements of ${ne(n.valueType)}`)}}function id(e,t,r){let n=e.getInstruction(t);if(r.length===0)return e.ConstantOfType(n.valueType,[]);if(n.type===1&&q(n.valueType)){let i=[],s=Fe(n.valueType);for(let o of r){let a=Math.floor(o);isNaN(a)||a<0||a>=cs(e,t,\"Programming error: expected Constant list instruction to have constant length.\")?i.push(gi(s)):i.push(n.value[a])}return e.ConstantOfType(n.valueType,i)}else if(n.type===38){let i=[];for(let s of r){let o=Math.floor(s);if(isNaN(o)||o<0||o>=cs(e,t,\"Programming error: expected List instruction to have constant length.\")){let a=Fe(n.valueType);i.push(e.NanOfType(a))}else i.push(n.args[o])}return e.List(i)}else{if(n.type===48&&n.isConstantBroadcast)return e.ConstantOfType(n.valueType,F0(e,t,r));{let i=[],s=!0,o=sr(e,t);for(let u of r){let l=Math.floor(u);i.push(e.Constant(l+1)),(isNaN(l)||l<0||o===void 0||l>=o)&&(s=!1)}let a=[t,e.List(i)];return s?e.InboundsListAccess(a):e.ListAccess(a)}}}function q0(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be constant collapsed\");let t=e.getInstruction(e.getReturnIndex());if(be(t))return e.getReturnIndex();switch(t.type){case 8:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(Rb(n.value,i.value))):n.type===1&&B(n.value)===0?(e.popInstruction(),t.args[1]):i.type===1&&B(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(Cb(n.value,i.value))):n.type===1&&B(n.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):i.type===1&&B(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(Lb(n.value,i.value))):n.type===1&&B(n.value)===1?(e.popInstruction(),t.args[1]):i.type===1&&B(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(wb(n.value,i.value))):i.type===1&&B(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);if(n.type===1&&i.type===1)return e.popInstruction(),e.Constant(tc(n.value,i.value));if(n.type===1&&n.valueType===b){let s=B(n.value);if(s===Math.E)return e.popInstruction(),e.SyntheticNativeFunction(\"exp\",[t.args[1]]);if(s>0)return e.popInstruction(),e.RawExponent(t.args)}if(i.type===1&&i.valueType===b){let s=B(i.value);if(s===1)return e.popInstruction(),t.args[0];if(s===Math.floor(s))return e.popInstruction(),e.RawExponent(t.args);if(er(i.value)){let{n:o,d:a}=i.value;if(a%2===1){e.popInstruction();let u=e.RawExponent([e.SyntheticNativeFunction(\"abs\",[t.args[0]]),t.args[1]]);return o%2===0?u:e.Multiply([e.SyntheticNativeFunction(\"sign\",[t.args[0]]),u])}}}return e.getReturnIndex()}case 13:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(tc(n.value,i.value))):i.type===1&&B(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),e.Constant(_b(n.value))):e.getReturnIndex()}case 25:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,Fb(n.value,i.value))):e.getReturnIndex()}case 26:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,Vb(n.value,i.value))):e.getReturnIndex()}case 27:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,Bb(n.value,i.value))):e.getReturnIndex()}case 28:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,Gb(n.value,i.value))):e.getReturnIndex()}case 29:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,zb(n.value,i.value))):e.getReturnIndex()}case 31:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,C0(n.value,i.value))):e.getReturnIndex()}case 32:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(me,L0(n.value,i.value))):e.getReturnIndex()}case 33:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 17:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===15&&i.type===1?(e.popInstruction(),n.args[B(i.value)-1]):n.type===1&&n.valueType===N&&i.type===1?(e.popInstruction(),e.Constant(n.value[B(i.value)-1])):e.getReturnIndex()}case 18:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===16&&i.type===1?(e.popInstruction(),n.args[B(i.value)-1]):n.type===1&&n.valueType===z&&i.type===1?(e.popInstruction(),e.Constant(n.value[B(i.value)-1])):e.getReturnIndex()}case 38:{if(zR(e,t.args)){e.popInstruction();let n=[];for(let i of t.args)n.push(e.getInstruction(i).value);return e.ConstantOfType(t.valueType,n)}return e.getReturnIndex()}case 39:case 41:{let n=t.args[0],i=e.getInstruction(n),s=e.getInstruction(t.args[1]);if(i.type===33&&s.type===1){let o=t.type===39?e.ListAccess([i.args[1],t.args[1]]):e.InboundsListAccess([i.args[1],t.args[1]]),a=t.type===39?e.ListAccess([i.args[2],t.args[1]]):e.InboundsListAccess([i.args[2],t.args[1]]);return e.Piecewise([i.args[0],o,a])}if(i.type===48){if(s.type===1&&i.isConstantBroadcast&&i.valueType!==Qt)return e.ConstantOfType(t.valueType,rd(e,e.getReturnIndex()));e.popInstruction();let o=i.args[0],a=n-o,u=e.getInstruction(o),l=u.args[0],c,p;if(t.type===41)c=t.args[1];else{let d=sr(e,n);if(s.type===1&&s.valueType===b&&d!==void 0){let m=B(s.value),y=Math.floor(m);if(y<1||y>d)return e.NanOfType(t.valueType);c=m===y?t.args[1]:e.Constant(y)}else{let m=e.Constant(1),g=e.getInstruction(l).args[0],h=e.SyntheticNativeFunction(\"floor\",[t.args[1]]),P=e.GreaterEqual([h,m]),S=e.LessEqual([h,g]);c=e.Piecewise([P,e.Piecewise([S,h,g]),m]),p={one:m,lengthIndex:g,roundedIndex:h,greaterEqualIndex:P,lessEqualIndex:S}}}if(u.args[a]<l)return u.args[a];let f=[c];for(let d=l+1;d<=u.args[a];d++){let m=e.getInstruction(d);if(be(m))f.push(e.copyInstruction(m));else{let y=[];for(let g of m.args)y.push(g>=l?f[g-l]:g);m.type===40?f.push(e.InboundsListAccess(y)):f.push(e.copyInstructionWithArgs(m,y))}}if(p){let{greaterEqualIndex:d,lessEqualIndex:m,lengthIndex:y,one:g}=p,h=Fe(i.valueType),P=e.NanOfType(h),S=f[f.length-1],A=e.And([e.And([d,m]),e.GreaterEqual([y,g])]);return e.Piecewise([A,S,P])}else return f[f.length-1]}else if(s.type===1&&s.valueType===b)if(i.type===38){e.popInstruction();let o=Math.floor(B(s.value))-1;return isNaN(o)||o<0||o>=i.args.length?e.NanOfType(t.valueType):i.args[o]}else if(i.type===1){e.popInstruction();let o=Math.floor(B(s.value))-1;return isNaN(o)||o<0||o>=i.value.length?e.NanOfType(t.valueType):e.ConstantOfType(Fe(i.valueType),i.value[o])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let n=e.getInstruction(t.args[0]);if(!$r(n)||td(e,e.getReturnIndex(),n.args[0]))return e.getReturnIndex();let i=e.copy();i.close();let s=i.getCompiledFunction().fn();return e.popInstruction(),Ab(e,t.valueType,s)}case 37:switch(t.symbol){case\"nthroot\":{let n=z0(e,t.args);if(n!==void 0)return e.Constant(Vc(n[0],n[1]));{let i=e.getInstruction(t.args[1]);if(i.type===1&&i.valueType===b)return e.Exponent([t.args[0],e.Constant(nl(i.value))])}return e.getReturnIndex()}case\"count\":{let n=sr(e,t.args[0]);return n!==void 0?(e.popInstruction(),e.Constant(n)):e.getReturnIndex()}case\"select\":if(Gt(e.getInstruction(t.args[1]))){e.popInstruction();let n=_t(e,t.args[1]),i=[];for(let s=0;s<n.length;s++)n[s]&&i.push(s);return id(e,t.args[0],i)}else return e.getReturnIndex();case\"shuffle\":{let n=t.args[0],i=t.args[1],s=sr(e,i);if(s!==void 0&&Gt(e.getInstruction(n))){e.popInstruction();let o=ob(_t(e,n),s);return id(e,i,o)}else return e.getReturnIndex()}case\"elementsAt\":{let n=t.args[0],i=t.args[1];if(Gt(e.getInstruction(i))){e.popInstruction();let s=_t(e,i);return id(e,n,s)}return e.getReturnIndex()}default:{let n=z0(e,t.args);return n===void 0?e.getReturnIndex():(e.popInstruction(),e.ConstantOfType(t.valueType,Ub(t.symbol,n)))}}case 44:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return Gt(n)&&Gt(i)?e.ConstantOfType(He,qb(t.tag,_t(e,t.args[0]),_t(e,t.args[1]))):e.getReturnIndex()}case 15:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&n.valueType===b&&i.type===1&&i.valueType===b?e.ConstantOfType(N,[n.value,i.value]):e.getReturnIndex()}case 16:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]),s=e.getInstruction(t.args[2]);return n.type===1&&n.valueType===b&&i.type===1&&i.valueType===b&&s.type===1&&s.valueType===b?e.ConstantOfType(z,[n.value,i.value,s.value]):e.getReturnIndex()}case 48:{let n=sr(e,e.getReturnIndex());return n!==void 0&&n===0?(e.popInstruction(),e.ConstantOfType(t.valueType,[])):e.getReturnIndex()}case 49:{for(let i of t.args)if(!Ao(e.getInstruction(i)))return e.getReturnIndex();e.popInstruction();let n={};for(let i=0;i<t.symbols.length;i++){let s=t.symbols[i],o=e.getInstruction(t.args[i]);if(o.type===48&&(o=e.getInstruction(Vr(e,t.args[i]))),o.type!==1)throw new Error(\"Expected instruction to be constant\");let{valueType:a,value:u}=o;R0(a,u)||(n[s]={value:u,valueType:a})}return e.ConstantOfType(Be,{type:\"Action\",updateRules:n})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function zR(e,t){for(let r of t){let n=e.getInstruction(r);if(!Gt(n))return!1}return!0}function z0(e,t){let r=[];for(let n of t){let i=e.getInstruction(n);if(Gt(i))r.push(i.value);else return}return r}function Ft(e,t,r){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 17:case 18:case 21:case 19:case 23:return b;case 25:case 26:case 27:case 28:case 29:case 31:case 32:return me;case 33:{let i=e.getInstruction(r[1]).valueType,s=e.getInstruction(r[2]).valueType;return i===Oe&&q(s)?s:(i===Ie||i===ye)&&s===b?b:(i===zt||i===qt)&&s===j?j:i}case 15:return N;case 16:return z;case 38:{if(r.length===0)return Oe;let i=e.getInstruction(r[0]).valueType;if(i===Ie||i===ye){let s=!1,o=!0;for(let a of r){let u=e.getInstruction(a).valueType;if(u===b&&(s=!0),u!==b&&u!==Ie&&u!==ye){o=!1;break}}s&&o&&(i=b)}return ui(i)?tn(i):wt}case 39:case 40:case 41:{let i=e.getInstruction(r[0]).valueType;return q(i)?Fe(i):st}case 44:return He;case 49:return Be;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:return st;default:let n=t;throw new Error(`Unexpected opcode ${n}`)}}var U0={segment:!0,ray:!0,vector:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0,from:!0};function qR(e){return e!==void 0&&e in U0}function od(e){return qR(e)?e===\"rotate\"||e===\"dilate\"||e===\"translate\"||e===\"reflect\"?!0:!1:!1}function sd(e){if(e.type===\"ListAccess\"&&e.list.type===\"Identifier\"&&e.index.type===\"Constant\")return[e.list._symbol,e.index.asValue()];if(e.type===\"Identifier\")return[e._symbol,void 0]}function ad(e){let t={},r=e;if((r instanceof Ks||r instanceof to)&&(t.identifier=r._symbol,r=r._expression),r instanceof su&&r.index instanceof rr&&(t.listAccess=r.index.asValue(),r=r.list),t.identifier&&r instanceof rt){let n=r._symbol,i=t.listAccess;t.assignmentRhsReference=[n,i]}if(r instanceof Ir){let n=r._symbol,i=r.args[0]instanceof rt?r.args[0]._symbol:void 0;if(od(n)&&e instanceof to&&i&&e._argSymbols.some(s=>s===i))t.tree={symbol:n,parents:r.args.slice(1).map(sd)};else if(!od(n)&&U0[n])t.tree={symbol:n,parents:r.args.map(sd)};else{let s=[r._symbol,void 0];t.tree={symbol:\"apply\",parents:[s,...r.args.map(sd)]}}}else if(r instanceof di){let n=r.args.map(sd);n.length===2&&n[1]&&n[1][0]===\"segments\"&&(t.tree={symbol:\"segment\",parents:[n[0]]})}return t}function k0(e,t,r,n,i){var h,P,S,A;if(!iu(t)&&!al(t)||od(t))return;let s,o=!1,a=!1,u=0,l=[],c=[],p=n.map(T=>e.getInstruction(T).valueType),f=iu(t)?rs[t]:void 0;if(f&&(o=f.isSeeded,s=void 0,l.push(...f.argumentTypes),u=(P=(h=f.defaultArguments)==null?void 0:h.length)!=null?P:0,c=H0(l,p,u),a=f.allowDotCall),al(t)&&c.length===0&&!(f!=null&&f.fallthroughUnlessDistribution&&p.length>0&&re(p[0],je))){let T=lr[t];s=T.tag,l.push(...Hm(t)),u=(A=(S=T.defaultArguments)==null?void 0:S.length)!=null?A:0,c=H0(l,p,u),a=a||T.allowDotCall}let d=Math.min(...l.map(bo)),m=Math.max(...l.map(Qu)),y=n,g=n;if(o&&(g=y=n.slice(1),d-=1,m-=1),i){if(!a)throw gl(r);let T=e.getInstruction(y[0]).valueType;if(!q(T)&&T!==je&&(T===N||!Ku(T)))throw oy(r,ne(T));r=\".\"+r,g=y.slice(1),d-=1,m-=1}if(!(c.length>0))throw UR(e,{symbol:t,errorSymbol:r,providedArgs:g,argsWithoutSeed:y,isDotCall:i,minArity:d,maxArity:m,defaultArgumentCount:u,builtInTag:s})}function UR(e,{symbol:t,errorSymbol:r,providedArgs:n,argsWithoutSeed:i,isDotCall:s,minArity:o,maxArity:a,defaultArgumentCount:u,builtInTag:l}){if(l===\"doubleReducer\"&&n.length===2){if(!q(e.getInstruction(n[0]).valueType)||!q(e.getInstruction(n[1]).valueType))throw Sl(t)}else if(l===\"parameterizedReducer\"&&n.length===2&&!q(e.getInstruction(n[0]).valueType))throw Xg(t);if(t===\"logbase\"&&n.length!==2)return mi(\"log\",1,n.length-1);if(t===\"random\")return qy();if(n.length<o||n.length>a){let{dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,minArityExampleArgs:d,maxArityExampleArgs:m}=HR(t),y,g;if(n.length<o?(g=o-u,s&&p?y=r+p:d&&(y=r+d)):(g=a,s&&f?y=r+f:m&&(y=r+m)),l===\"reducer\"&&n.length===0)return $y(r);if(l===\"doubleReducer\")return Ml(r);if(l===\"parameterizedReducer\")return ky(r);if(l===\"color\")return Hy(r);if(iu(t))switch(t){case\"pdf\":return s?mi(r,g,n.length,y):Vy();case\"cdf\":return s?mi(r,g,n.length,y):n.length<o?By():Gy();case\"tdist\":return zy();case\"length\":case\"round\":case\"midpoint\":case\"segment\":case\"distance\":case\"circle\":case\"center\":case\"radius\":case\"glider\":case\"intersection\":case\"strictintersection\":case\"parallel\":case\"perpendicular\":case\"angle\":case\"directedangle\":case\"angles\":case\"directedangles\":case\"apply\":case\"translate\":case\"reflect\":case\"dilate\":case\"rotate\":case\"normaldist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":case\"mean\":case\"median\":case\"stdev\":case\"var\":case\"quantile\":case\"sort\":case\"shuffle\":case\"join\":case\"unique\":case\"polygon\":case\"coterminal\":return mi(r,g,n.length,y);case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"vectors\":case\"arcs\":throw rn(r);case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ttest\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":throw ae(`Unexpected arity error for ${t}`);default:let h=t;throw new Error(`Unexpected compiler function ${h}`)}return mi(r,g,n.length)}if(t===\"polygon\"&&n.length===2&&e.getInstruction(n[0]).valueType===b&&e.getInstruction(n[1]).valueType===b)return Il();let c=[];for(let p=0;p<i.length;p++){let f=i[p],d=l!==void 0&&l!==\"doubleReducer\"&&l!==\"never-broadcast\"&&!(l===\"parameterizedReducer\"&&p===0)&&t!==\"polygon\",m=e.getInstruction(f).valueType;q(m)&&d&&(m=Fe(m)),c.push(ne(m))}return En(r,c)}function HR(e){return iu(e)?rs[e]:{}}function H0(e,t,r){return so(e,t).filter(n=>t.length+r>=bo(n))}var wa=_i([[b,b]]),kR=_i([[{meta:\"union\",types:Zi},{meta:\"union\",types:[me,b]}]]),Hb={Negative:_i([[b],[N],[pe],[z]]),Add:_i([[b,b],[N,N],[pe,pe],[z,z]]),Subtract:_i([[b,b],[N,N],[pe,pe],[z,z]]),Multiply:_i([[b,b],[N,b],[b,N],[b,pe],[pe,b],[z,b],[b,z]]),DotMultiply:_i([[b,b],[N,b],[b,N],[pe,pe],[b,pe],[pe,b],[z,b],[b,z],[z,z]]),CrossMultiply:_i([[b,b],[N,b],[b,N],[pe,b],[b,pe],[z,z]]),Divide:_i([[b,b],[N,b],[pe,b],[z,b]]),Exponent:wa,\"Comparator['=']\":wa,\"Comparator['>']\":wa,\"Comparator['<']\":wa,\"Comparator['>=']\":wa,PercentOf:wa,\"Comparator['<=']\":wa,And:_i([[me,me]]),NamedCoordinateAccess:_i([[N],[z]]),Norm:_i([[b],[N],[z],[pe]]),ListAccess:kR};function ps(e,t){let r=[];for(let n of t)r.push(ne(e.getInstruction(n).valueType));return r}function _a(e,t){let r=[];for(let n of t){let i=e.getInstruction(n).valueType,s=q(i)?Fe(i):i;r.push(ne(s))}return r}function U(e,t,r){return re(e.getInstruction(t).valueType,r)}function ud(e,t){return Array.isArray(e)?t>e.length-1?void 0:e[t]:t<e.initial.length?e.initial[t]:e.rest}function Ro(e,t,r,n){var l,c;let i=r.type;if(i===\"FunctionCall\"||i===\"SeededFunctionCall\"||i===\"DotAccess\"){let p,f;if(r instanceof di&&(r.args[1]instanceof rt||r.args[1]instanceof Ir))p=r.args[1]._symbol,f=(l=r.args[1]._errorSymbol)!=null?l:p;else if(r instanceof Ir||r instanceof pa)p=r._symbol,f=(c=r._errorSymbol)!=null?c:p;else return;k0(e,p,f,n,r instanceof di);return}let s=$b(e,t,r,n);if(!s)return;let o=Math.min(...s.map(bo));if(s.length>0&&n.length>=o)return;let a=n.map(p=>e.getInstruction(p).valueType),u=$R(i,a);switch(i){case\"Add\":throw Jm(u);case\"Subtract\":throw Qm(u);case\"CrossMultiply\":throw t.is3dProduct()&&a.length===2&&(re(a[0],N)&&re(a[1],N)||re(a[0],b)&&re(a[1],z)||re(a[0],z)&&re(a[1],b))?fl(u):pl(u);case\"DotMultiply\":throw pl(u);case\"Multiply\":{if(t.is3dProduct()&&a.length===2){if(re(a[0],z)&&re(a[1],z))throw ml(u);if(re(a[0],N)&&re(a[1],N))throw dl(u)}throw pl(u)}case\"Divide\":throw Km(u);case\"Exponent\":throw ey(u);case\"Negative\":throw ty(u);case\"Comparator['=']\":case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":throw ry(u);case\"And\":throw Op(u);case\"Piecewise\":throw re(a[0],me)?xy([ne(e.getInstruction(n[1]).valueType),ne(e.getInstruction(n[2]).valueType)]):by(u);case\"List\":{$0(e,n);break}case\"ListAccess\":throw yl(u);case\"Norm\":throw En(\"abs\",u);case\"ParenSeq\":{let p=a.indexOf(Be)!==-1,f=a.some(m=>m!==Be);if(p&&f)throw Lp([ne(a[0]),ne(a[1])]);if(a.length!==2&&(!t.is3dProduct()||a.length!==3)){let m=t.is3dPolicy()?3:2;throw Wy(m)}let d=a.find(m=>!re(m,b));throw d!==void 0?ny(ne(d)):ae(\"Unexpected error type checking ParenSeq\")}case\"BareSeq\":{if(a.length<2)throw rn(\",\");let p=a[0],f=a.find(d=>d!==p);if(f)throw Lp([ne(p),ne(f)]);if(p===b)throw n.length===2?Yy():Xy();$0(e,n);break}case\"Ans\":case\"Constant\":case\"Assignment\":case\"MixedNumber\":case\"Identifier\":case\"Construction\":case\"Range\":case\"NamedCoordinateAccess\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"CoordinateEquation\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"PercentOf\":return;default:{let p=i;throw new Error(`Unexpected node type: ${p}`)}}}function $0(e,t){if(t.length===0)return;let r=e.getInstruction(t[0]).valueType;if(!ui(r))throw da([ne(r)]);for(let n of t){let i=e.getInstruction(n).valueType;if(!ui(i))throw da([ne(i)]);if(i!==r)throw bl()}}function $R(e,t){let r=n=>q(n)?Fe(n):n;switch(e){case\"Add\":case\"Subtract\":case\"Multiply\":case\"Divide\":case\"Exponent\":case\"Negative\":case\"Comparator['<']\":case\"Comparator['>']\":case\"Comparator['=']\":case\"Comparator['<=']\":case\"Comparator['>=']\":case\"NamedCoordinateAccess\":return t.map(r).map(ne);case\"ListAccess\":case\"Constant\":case\"MixedNumber\":case\"Identifier\":case\"Ans\":case\"List\":case\"Range\":case\"Construction\":case\"ParenSeq\":case\"BareSeq\":case\"Norm\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Piecewise\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"Assignment\":case\"CoordinateEquation\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"DotMultiply\":case\"CrossMultiply\":case\"And\":case\"PercentOf\":return t.map(ne);default:{let n=e;throw new Error(`Unexpected node type: ${n}`)}}}function X0(e,t){let r=e.getInstruction(t);if(be(r))return;let n=kb(e,r).expectedTypes;if(r.type===49){for(let a of r.args){let u=e.getInstruction(a).valueType;if(!re(u,b)&&!re(u,N)&&!re(u,z)&&!re(u,ot)&&!re(u,Ee)&&!re(u,xe)&&!re(u,oe)&&!re(u,ve)&&!re(u,pe)&&!re(u,ue)&&!re(u,ee)&&!re(u,Ie)&&!re(u,ye))throw My(ne(u))}let o={};for(let a of r.symbols){if(o[a])throw vy(a);o[a]=!0}return}let i=[];for(let o=0;o<r.args.length;o++){let a=e.getInstruction(r.args[o]).valueType,u=ud(n,o);(u===void 0||!Yb(a,u))&&i.push(r.args[o])}if(i.length===0)return;let s=ps(e,r.args);switch(r.type){case 32:throw Op(s);case 17:case 18:throw iy(s);case 21:{let o=e.getInstruction(r.args[0]).valueType,a=e.getInstruction(r.args[1]).valueType;if(o!==b)throw dy([ne(o)]);if(a!==b)throw my([ne(a)]);return}case 22:{let o=e.getInstruction(r.args[1]).valueType;throw yy([ne(o)])}case 44:{if(e.getInstruction(r.args[0]).valueType!==He||e.getInstruction(r.args[1]).valueType!==He&&e.getInstruction(r.args[1]).valueType!==b)throw ae(`Unexpected arg types for ExtendSeed: ${ps(e,r.args).map(o=>o.key).join(\", \")}`);return}case 31:case 15:case 16:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 25:case 26:case 27:case 28:case 29:case 38:case 39:case 40:case 41:case 37:case 42:case 33:case 48:case 47:case 23:case 24:case 19:case 20:throw ae(`Invalid argument types for opcode ${r.type}`);default:{let o=r;throw new Error(`Unexpected opcode: ${o.type}`)}}}function kb(e,t,r=!1){switch(t.type){case 8:case 9:case 10:case 11:return r&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===N?{expectedTypes:[N,N]}:{expectedTypes:[b,b]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[b,b]};case 14:return{expectedTypes:[b]};case 31:return{expectedTypes:[me,me]};case 32:return{expectedTypes:[me,me]};case 33:return{expectedTypes:[me,t.valueType,t.valueType]};case 15:case 16:return{expectedTypes:t.args.map(()=>b)};case 17:return{expectedTypes:[N,b]};case 18:return{expectedTypes:[z,b]};case 21:return{expectedTypes:[b,b]};case 22:{let n=e.getInstruction(t.args[1]).valueType;return n===N||n===z?{expectedTypes:[b,n]}:{expectedTypes:[b,b]}}case 38:{let n=t.valueType,i=Fe(n);return{expectedTypes:{type:\"variadic\",initial:[],rest:i}}}case 39:case 40:case 41:return{expectedTypes:[wt,b]};case 37:{let n=t.symbol,i=lr[n],s=i.argumentTypes;if(i.tag===\"reducer\"&&!YR(e,t.args)&&Array.isArray(s)&&typeof s[0]==\"number\"&&q(s[0]))return{isReducerWithNoListArgs:!0,expectedTypes:{type:\"variadic\",initial:[],rest:Fe(s[0])}};if(Array.isArray(s))return{expectedTypes:s};{let{initial:o,rest:a}=s,u=t.args.length-o.length,l=[...o];for(let c=0;c<u;c++)l.push(a);return{expectedTypes:l}}}case 44:return e.getInstruction(t.args[0]).valueType===He&&e.getInstruction(t.args[1]).valueType!==He?{expectedTypes:[He,b]}:{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 47:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 23:return{expectedTypes:[b]};case 19:return{expectedTypes:t.args.map(n=>{let i=e.getInstruction(n).valueType;return i===me||t.callData.type===\"sum\"&&(i===N||i===z)?i:b})};case 24:case 20:{let n=[b];for(let i=1;i<t.args.length;i++)n.push(e.getInstruction(t.args[i]).valueType);return{expectedTypes:n}}case 42:return{expectedTypes:t.args.map(()=>b)};case 48:case 49:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};default:{let n=t;throw new Error(`Unexpected opcode: ${n.type}`)}}}function $b(e,t,r,n){let i=[];for(let s of n)i.push(s===void 0?void 0:e.getInstruction(s).valueType);if(r instanceof Ds){let s=n.filter(a=>a!==void 0);if(s.length===0)return;let o=Ft(e,38,s);return q(o)&&o!==wt?so([{type:\"variadic\",initial:[],rest:Fe(o)}],i):[]}else if(r instanceof Ir||r instanceof pa||r instanceof di){let s=r instanceof di?r.args[1]._symbol:r._symbol;if(!s)return;let o=ul(s);return o?so(o,i):void 0}else if(r instanceof ns){let[s,o,a]=n,u=o&&e.getInstruction(o),l=u==null?void 0:u.valueType,c=a&&e.getInstruction(a),p=c==null?void 0:c.valueType;!(l!==void 0&&p!==void 0&&(Is(l,p)||Is(p,l)))&&c&&Gt(c)&&c.valueType==b&&jn(c.value)&&(a=void 0,c=void 0,p=void 0);let d;if(l===Oe&&p!==void 0&&q(p))d=p;else if(l!==void 0&&(Is(l,b)||Is(l,j)))d=b;else if(l!==void 0)d=l;else if(p!==void 0)d=p;else return;return q(d)&&(d=Fe(d)),so([ai([me,d,d])],[i[0],l,p])}else if(t.is3dProduct()&&r instanceof mu){let s=[...Hb.DotMultiply,ai([N,N])];return so(s,i)}else if(r instanceof Ai){let s=[{type:\"variadic\",initial:[Be],rest:Be},ai([b,b])];return t.is3dProduct()&&s.push(ai([b,b,b])),so(s,i)}else if(r instanceof au){let s=[{type:\"variadic\",initial:[Be],rest:Be}],o=n.filter(a=>a!==void 0&&e.getInstruction(a).valueType!==b);if(o.length>0){let a=Ft(e,38,o);q(a)&&a!==wt&&s.push({type:\"variadic\",initial:[],rest:Fe(a)})}return so(s,i)}else if(r.type in Hb&&i.some(s=>s!==void 0)){let s=Hb[r.type];return s?so(s,i):void 0}}function so(e,t){let r=[];for(let n of e)Array.isArray(n)&&n.length<t.length||t.every((i,s)=>{if(i===void 0)return!0;let o=ud(n,s);return o===void 0?!1:XR(i,o)})&&r.push(n);return r}function YR(e,t){for(let r of t)if(q(e.getInstruction(r).valueType))return!0;return!1}function Yb(e,t){return typeof t==\"number\"?ji(e,t):t.types.some(r=>ji(e,r))}function XR(e,t){return typeof t==\"number\"?Is(e,t):t.types.some(r=>Is(e,r))}function ld(e,t){let r=new Set;for(let n of e){let i;if(Array.isArray(n)){if(t>=n.length)continue;i=Y0(n[t])}else i=Y0(t<n.initial.length?n.initial[t]:n.rest);for(let s of i)r.add(s)}return[...r]}function Y0(e){return typeof e==\"number\"?[e]:e.types}function _i(e){return e.map(ai)}function cd(e){let t=[];for(let r=0;r<e.instructionsLength();r++){t.push(0);let n=e.getInstruction(r);if(!be(n))if($r(n)&&n.type!==22)for(let i of n.args)t[i]=1/0;else for(let i of n.args)t[i]+=1}return t}var nc=Xb([tr(\"sin\",\"isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)\"),tr(\"cos\",\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)\"),oo(\"tan\",Rt`float a=abs(x);\n    return isinf(x) || isnan(x) ? NaN\n      : dcg_isPiMultiple(a) ? 0.0\n      : dcg_isOddHalfPiMultiple(a) ? Infinity\n      : tan(x);`),oo(\"cot\",Rt`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : dcg_isPiMultiple(a) ? Infinity\n        : dcg_isOddHalfPiMultiple(a) ? 0.0\n        : 1.0 / tan(x);`),tr(\"sec\",\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)\"),tr(\"csc\",\"isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? Infinity: 1.0 / sin(x)\"),oo(\"arcsin\",Rt`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return dcg_PI/2.0; }\n    if (x == -1.0) { return -dcg_PI/2.0; }\n    float y0 = asin(x);\n    return y0 + (x - sin(y0)) / cos(y0);`),oo(\"arccos\",Rt`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return 0.0; }\n    if (x == -1.0) { return dcg_PI; }\n    float y0 = acos(x);\n    return y0 + (cos(y0) - x) / sin(y0);`),tr(\"arctan\",\"isnan(x) ? NaN : atan(x)\"),pd(\"arctan\",\"isnan(x) || isnan(y) ? NaN : atan(x, y)\"),tr(\"arccot\",\"isnan(x) ? NaN : dcg_PI/2.0 - atan(x)\"),tr(\"arcsec\",\"isnan(x) ? NaN : dcg_arccos(1.0/x)\"),tr(\"arccsc\",\"isnan(x) ? NaN : dcg_arcsin(1.0/x)\"),tr(\"sinh\",\"isinf(x) ? x : isnan(x) ? NaN : sinh(x)\"),tr(\"cosh\",\"isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)\"),tr(\"tanh\",\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)\"),tr(\"coth\",\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)\"),tr(\"sech\",\"isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)\"),tr(\"csch\",\"isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)\"),oo(\"arcsinh\",Rt`float a=abs(x);\n      return isnan(x) ? NaN : sign(x) * (\n        1.0 + x * x == 1.0\n          ? dcg_log1p(a)\n          : log(a + dcg_rtxsqpone(a))\n      );`),tr(\"arccosh\",\"x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))\"),oo(\"arctanh\",Rt`if (isnan(x) || abs(x) > 1.0) { return NaN; }\n      if (x == 1.0) { return Infinity; }\n      if (x == -1.0) { return -Infinity; }\n      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));\n      float c = cosh(y0);\n      return y0 + (x - tanh(y0)) * c * c;`),tr(\"arccoth\",\"abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN\"),tr(\"arcsech\",\"0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN\"),tr(\"arccsch\",\"isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)\"),tr(\"sqrt\",\"x >= 0.0 ? sqrt(x) : NaN\"),tr(\"rtxsqpone\",\"dcg_hypot(x, 1.0)\"),oo(\"rtxsqmone\",\"float t = x*x; return isnan(x) ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);\"),pd(\"nthroot\",\"isnan(x) || isnan(y) ? NaN : pow(x, 1.0/y)\"),eM(\"hypot\",Rt`if (isnan(x) || isnan(y)) return NaN;\n      if (isinf(x) || isinf(y)) return Infinity;\n      x = abs(x);\n      y = abs(y);\n      float m = max(x,y);\n      x /= m;\n      y /= m;\n      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),tr(\"log\",\"x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN\"),pd(\"logbase\",\"y > 0.0 ? (x > 0.0 ? log(x)/log(y) : x == 0.0 && !isinf(y) ? -Infinity : NaN) : NaN\"),tr(\"ln\",\"x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN\"),tr(\"exp\",\"isnan(x) ? NaN : exp(x)\"),tr(\"floor\",\"isnan(x) ? NaN : floor(x)\"),tr(\"ceil\",\"isnan(x) ? NaN : ceil(x)\"),tr(\"round\",\"isnan(x) ? NaN : floor(0.5 + x)\"),tr(\"abs\",\"isnan(x) ? NaN : abs(x)\"),tr(\"sign\",\"isnan(x) ? NaN : sign(x)\"),pd(\"mod\",\"isnan(x) || isnan(y) ? NaN : mod(x, y)\"),Nu(\"distance\",\"float\",\"vec2 a, vec2 b\",\"vec2 d = a-b; return dcg_hypot(d.x, d.y);\"),Nu(\"distance3d\",\"float\",\"vec3 a, vec3 b\",\"vec3 d = a-b; return dcg_hypot(dcg_hypot(d.x, d.y), d.z);\"),Nu(\"hsv\",\"vec3\",\"float h, float s, float v\",Rt`if (isnan(h) || isnan(s) || isnan(v)) {discard;}\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);\n      return vec3(v * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), s));`),Nu(\"rgb\",\"vec3\",\"float r, float g, float b\",Rt`if (isnan(r) || isnan(g) || isnan(b)) {discard;}\n    return vec3(r / 255.0, g / 255.0, b / 255.0);`),oo(\"erf\",`float t = abs(x);\n      float n = x*x;\n      float r = -n;\n      return sign(x) * (\n        r < -750.0\n          ? 1.0\n          : t >= 0.065\n          ? 1.0 - exp(r) * (\n            t > 50000000.0\n              ? r / t\n              : t > 50.0\n              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))\n              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+\n                t*(1.7057986861852539+t*(0.8257463703357973+\n                  t*(0.28647031042892007+t*(0.07124513844341643+\n                    t*(0.012296749268608364+t*(0.001347817214557592+\n                      0.00007263959403471071*t))))))))\n                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+\n                  t*(5.003720878235473+t*(3.266590890998987+\n                    t*(1.5255421920765353+t*(0.5185887413188858+\n                      t*(0.12747319185915415+t*(0.02185979575963238+\n                        t*(0.0023889438122503674+0.00012875032817508128*t\n                ))))))))))\n              )\n          )\n          : t*(1.1283791670955126+r*(0.37612638903183754+\n              r*(0.11283791670955126+r*(0.026866170645131252+\n                0.005223977625442188*r))))\n      );`)]);function Xb(e){let t={};for(let[r,n]of e)t[r]=n;return t}function Nu(e,t,r,n){return[e,`${t} dcg_${e}(${r}){ ${n} }`]}function oo(e,t){return Nu(e,\"float\",\"float x\",t)}function tr(e,t){return oo(e,`return ${t};`)}function eM(e,t){return Nu(e,\"float\",\"float x, float y\",t)}function pd(e,t){return eM(e,`return ${t};`)}function Ln(e,t,r=()=>\"float\"){return[e,n=>`${r(n)} dcg_${e}(float[${n}] L) { ${t(n)} }`]}function fd(e,t,r=()=>\"float\"){return[e,(n,i)=>{let s=Math.min(n,i),o=r(s),a=t(s);return`${o} dcg_${e}(float[${n}] X, float[${i}] Y) { ${a} }`}]}var dd=Xb([Ln(\"lcm\",e=>Rt`float g = abs(dcg_round(L[0]));\n      if (isinf(g)) return Infinity;\n      if (isnan(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float v = abs(dcg_round(L[i]));\n        if (isinf(v)) return Infinity;\n        if (isnan(v)) return NaN;\n        g *= dcg_round(v / dcg_gcd2(g, v));\n      }\n      return g;`),Ln(\"gcd\",e=>Rt`float g = abs(dcg_round(L[0]));\n      if (isnan(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x)) return NaN;\n        g = dcg_gcd2(g, abs(dcg_round(x)));\n      }\n      return g;`),Ln(\"mean\",e=>Rt`float m = L[0];\n      for (int i=1; i<${e}; i++) { m += L[i]; }\n      return m / ${e}.0;`),Ln(\"total\",e=>Rt`float tot = L[0];\n      for (int i=1; i<${e}; i++) { tot += L[i]; }\n      return tot;`),Ln(\"stdev\",e=>Z0(e,e-1)),Ln(\"stdevp\",e=>Z0(e,e)),Ln(\"mad\",e=>Rt`float mean = dcg_mean(L);\n      float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        tot += abs(L[i] - mean);\n      }\n      return tot / ${e}.0;`),Ln(\"min\",e=>j0(e,\"min\")),Ln(\"max\",e=>j0(e,\"max\")),Ln(\"argmin\",e=>J0(e,\"<\")),Ln(\"argmax\",e=>J0(e,\">=\")),Ln(\"median\",e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])-1];`:Rt`float[${e}] perm = dcg_sortPerm(L);\n          return 0.5*(L[int(perm[${e/2}])-1]+L[int(perm[${e/2-1}])-1]);`),Ln(\"varp\",e=>W0(e,e)),Ln(\"var\",e=>W0(e,e-1)),Ln(\"sortPerm\",e=>{if(e>100)throw lu();return Rt`int[${e}] perm;\n        int[${e}] nextPerm;\n        for (int i=0; i<${e}; i++)\n          perm[i] = i;\n        float lastMin = -Infinity;\n        int lastIndex = -1;\n        for (int i=0; i<${e}; i++) {\n          float currMin = Infinity;\n          int currIndex = -1;\n          int j;\n          for (j=0; j<${e}; j++) {\n            float e = L[j];\n            if (\n              (e > lastMin || (e == lastMin && j > lastIndex))\n              && e < currMin\n            ) {\n              currMin = e;\n              currIndex = j;\n            }\n          }\n          perm[i] = currIndex;\n          lastMin = currMin;\n          lastIndex = currIndex;\n        }\n        float[${e}] permFloat;\n        for (int i=0; i<${e}; i++)\n          permFloat[i] = float(perm[i] + 1);\n        return permFloat;`},e=>`float[${e}]`)]);function W0(e,t){return t===0?\"return NaN;\":Rt`float mean = dcg_mean(L);\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float delta = L[i] - mean;\n      tot += delta * delta;\n    }\n    return tot / ${t}.0;`}function Z0(e,t){return t===0?\"return NaN;\":Rt`float mean = dcg_mean(L);\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float delta = L[i] - mean;\n      tot = dcg_hypot(tot, delta);\n    }\n    return tot / ${md(Math.sqrt(t))};`}function j0(e,t){return Rt`float m = L[0];\n    if (isnan(m)) return NaN;\n    for (int i=1; i<${e}; i++) {\n      float x = L[i];\n      if (isnan(x)) return NaN;\n      m = ${t}(m, x);\n    }\n    return m;`}function J0(e,t){return Rt`if (isnan(L[0])) return 0.0;\n    int arg = 0;\n    float best = L[0];\n    for (int i=1; i<${e}; i++) {\n      float e = L[i];\n      if (isnan(e)) return 0.0;\n      if (e ${t} best) {\n        arg = i;\n        best = e;\n      }\n    }\n    return float(arg + 1);`}var tM={median:[\"sortPerm\"],stdev:[\"mean\"],stdevp:[\"mean\"],mad:[\"mean\"],var:[\"mean\"],varp:[\"mean\"]},Wb=Xb([fd(\"elementsAt\",e=>`float[${e}] outList;\n      for (int i=0; i<${e}; i++) {\n        outList[i] = X[int(Y[i])-1];\n      }\n      return outList;`,e=>`float[${e}]`),fd(\"cov\",e=>Q0(e,e-1)),fd(\"covp\",e=>Q0(e,e)),fd(\"corr\",e=>Rt`${rM(e)}\n      float t1 = 0.0;\n      float t2 = 0.0;\n      float tc = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float d1 = X[i] - m1;\n        float d2 = Y[i] - m2;\n        t1 = dcg_hypot(t1, d1);\n        t2 = dcg_hypot(t2, d2);\n        tc += d1 * d2;\n      }\n      return tc / (t1 * t2);`)]);function Q0(e,t){return Rt`${rM(e)}\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot += (X[i] - m1) * (Y[i] - m2);\n    }\n    return tot / ${t}.0;`}function rM(e){return Rt`float m1 = X[0];\n    for (int i=1; i<${e}; i++) { m1 += X[i]; }\n    m1 /= ${e}.0;\n    float m2 = Y[0];\n    for (int i=1; i<${e}; i++) { m2 += Y[i]; }\n    m2 /= ${e}.0;`}var WR=[Rt`float dcg_rawpow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (x > 0.0) return pow(x, y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      if (y == 0.0) return 1.0;\n      if (y < 0.0) return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 1.0) return -pow(-x, y);\n      else return pow(-x, y);\n    }\n  }`,Rt`float dcg_pow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (isinf(y)) {\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x,y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      if (y == 0.0) return 1.0;\n      if (y < 0.0) return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 0.0) return pow(-x, y);\n      else if (m == 1.0) return -pow(-x, y);\n      else {${\"\"}\n        vec2 a0 = vec2(0.0, 1.0);\n        vec2 a1 = vec2(1.0, 0.0);\n        float approx = y;\n        for (int i=0; i<12; i+=1) {\n          float whole = floor(approx);\n          vec2 a = whole * a1 + a0;\n          if (a.y > 100.0) break;\n          a0 = a1; a1 = a;\n          if (approx == whole) break;\n          approx = 1.0 / (approx - whole);\n        }${\"\"}\n        float r = a1.x / a1.y;\n        float m = max(max(abs(y), abs(r)), 1.0);\n        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {\n          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);\n        } else {\n          return NaN;\n        }\n      }\n    }\n  }`,Rt`float dcg_add(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != y ? NaN\n      : x + y;\n  }`,Rt`float dcg_sub(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != -y ? NaN\n      : x - y;\n  }`,Rt`float dcg_mul(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && y == 0.0 ? NaN\n      : x == 0.0 && isinf(y) ? NaN\n      : x * y;\n  }`,Rt`float dcg_div(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : x == 0.0 && y == 0.0 ? NaN\n      : x / y;\n  }`,Rt`float dcg_gcd2(float u, float v) {\n    if (isinf(u)) return v;\n    if (isinf(v)) return u;\n    for (int i=0; i<95; i++) {\n      if (v == 0.0) break;\n      u = mod(u, v);\n      if (u == 0.0) break;\n      v = mod(v, u);\n    }\n    return u+v;\n  }`,Rt`float dcg_log1p(float x) {\n    return x - 0.5 * x * x == x ? x : log(1.0 + x);\n  }`,Rt`bool dcg_isPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;\n  }`,Rt`bool dcg_isOddHalfPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);\n    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;\n  }`].join(`\n`),K0=[\"factorial\",\"round\",\"hypot\",\"rtxsqpone\",\"rtxsqmone\"],ZR=K0.map(e=>nc[e]).join(`\n`)+Object.keys(nc).filter(e=>K0.indexOf(e)===-1).map(e=>nc[e]).join(`\n`),B8=Rt`uniform float NaN;\n    uniform float Infinity;\n    float dcg_const_bust = 1.0;\n    #define dcg_PI 3.141592653589793\n    #define dcg_PI_INV 0.3183098861837907\n    ${WR}\\n`+ZR;function Rt(e,...t){let r=e[0];for(let n=0;n<t.length;n++)r+=t[n],r+=e[n+1];return jR(r)}function jR(e){let t=e.split(`\n`);if(/^\\s/.test(t[0][0]))throw new Error(\"Programming error: Expected un-indented first line\");if(t.length<=1)return e;let r=Math.min(...t.slice(1).map(n=>n.match(/^\\s*/)[0].length));return t[0]+`\n`+t.slice(1).map(n=>n.slice(r)).join(`\n`)}function wn(e){return`_${e}`}function Pe(e,t){let r=t[e];return r!==void 0?r:wn(e)}function nM(e){return iM(e,!1)}function gd(e){return iM(e,!0)}function iM(e,t){let r=cd(e),n=[],i=[],s=oM(e,e.argNames.length,e.instructionsLength()-1,r,t),o=0;for(;o<e.instructionsLength();){let a=e.getInstruction(o),{source:u,nextIdx:l}=sM(e,a,o,r,n,i,t);s+=u,o=l}return s+=`return ${Pe(e.getReturnIndex(),n)};`,{source:s,constants:i,shaderFunctions:t?KR(e):{}}}function sM(e,t,r,n,i,s,o){let a=r+1;switch(t.type){case 0:case 47:case 48:case 22:case 49:return{source:\"\",nextIdx:a};case 21:if(o)throw Fp();return{source:QR(e,t,r,n,i,s),nextIdx:t.endIndex};case 2:return i[r]=e.argNames[r],{source:\"\",nextIdx:a};case 23:return{source:eC(e,t,r,i,o),nextIdx:a};case 24:return{source:tC(e,t,r,i,o),nextIdx:a};case 19:return{source:rC(e,t,r,i,o),nextIdx:a};case 20:return{source:nC(e,t,r,i),nextIdx:a};default:{let u=iC(e,t,i,s,o);return n[r]<=1?(i[r]=`(${u})`,{source:\"\",nextIdx:a}):{source:`${wn(r)}=${u};\n`,nextIdx:a}}}}function JR(e,t,r,n,i,s){let{endIndex:o}=t,a=!1,u=`function(${wn(r)}) {\n`;u+=oM(e,r+1,o-1,n,a);let l=r+1;for(;l<o;){let p=e.getInstruction(l),{source:f,nextIdx:d}=sM(e,p,l,n,i,s,a);u+=f,l=d}let c=e.getInstruction(o);return u+=`return ${Pe(c.args[1],i)};\n}`,u}function QR(e,t,r,n,i,s){let o=\"BuiltIn.quad(\";o+=JR(e,t,r,n,i,s),o+=`,${Pe(t.args[0],i)},${Pe(t.args[1],i)})`;let{endIndex:a}=t;return n[a+1]<=1?(i[a+1]=o,\"\"):`${wn(a+1)}=${o};`}\
function KR(e){\
    var i;\
    let t=e.argNames.length,\
        r=e.instructionsLength()-1,\
        n={};\
    for(let s=t;s<=r;s++){\
        let o=e.getInstruction(s);\
        if(o.type===33){\
            if(q(o.valueType)){\
                let a=lM(e,s),\
                    u=`${a} dcg_ternary(bool x, ${a} y, ${a} z) { if (x) return y; return z; }`;\
                n[u]=!0\
            }\
        }else if(o.type===37){\
            let a;\
            if((a=dd[o.symbol])!==void 0){\
                let u=o.args[0],\
                    l=sr(e,u);\
                if(l===void 0)\
                    throw ma(sn(e,u));\
                for(let c of(i=tM[o.symbol])!=null?i:[])\
                    n[dd[c](l)]=!0;\
                n[a(l)]=!0\
            }else if((a=Wb[o.symbol])!==void 0){\
                let u=o.args[0],\
                    l=o.args[1],\
                    c=sr(e,u),\
                    p=sr(e,l);\
                if(c===void 0)\
                    throw ma(sn(e,u));\
                if(p===void 0)\
                    throw ma(sn(e,l));\
                n[a(c,p)]=!0\
            }\
        }\
    }\
    return n\
}\
function oM(e,t,r,n,i){let s=\"\",o=!1;for(let a=t;a<=r;a++){let u=e.getInstruction(a);if(!(u.type===0||u.type===24||u.type===20)){if(u.type===21){if(i)throw Fp();let{endIndex:l}=u;a=n[l+1]<=1?l+1:l;continue}n[a]<=1&&!On(u)&&!$r(u)&&u.type!==47&&u.type!==48||(i?(o&&(s+=\";\"),s+=lM(e,a)+\" \"+wn(a)):(s+=o?\",\":\"var \",s+=wn(a)),o=!0)}}return o&&(s+=`;\n`),s}function eC(e,t,r,n,i){let s=wn(r),o=e.getInstruction(t.endIndex),a=Pe(t.args[0],n),u=\"\";for(let c=1;c<o.args.length;c++){let p=t.endIndex+c;if(e.getInstruction(p).type!==48)continue;let d=wn(p);i||(u+=`${d}=[];\n`)}return i||(u+=`if(${a}>${1e4}) throw ErrorMsg.maxListSize();\n`),u+=`for(${s}=1${i?\".0\":\"\"};${s}<=${a};${s}++){\n`,u}function tC(e,t,r,n,i){let s=\"\";for(let o=1;o<t.args.length;o++){let a=r+o;if(a>=e.instructionsLength()||e.getInstruction(a).type!==48)continue;let u=wn(r+o),l=Pe(t.args[o],n);if(i){let c=Pe(t.args[0],n);s+=`${u}[int(${c})-1]=${l};\n`}else s+=`${u}.push(${l});\n`}return s+=`}\n`,s}function rC(e,t,r,n,i){let s=wn(r);if(i){let l=e.getInstruction(t.args[0]),c=e.getInstruction(t.args[1]),p=t.callData.type===\"sum\";if(l.type!==1){let m=sn(e,t.args[0]);throw p?wp(m):_p(m)}if(c.type!==1){let m=sn(e,t.args[1]);throw p?wp(m):_p(m)}if(l.valueType!==b||c.valueType!==b)throw new Error(\"Programming error: non-number in summation bounds\");let f=B(l.value),d=B(c.value);if(!isFinite(d-f)||d-f>=1e3)throw p?Ly():wy()}let o=`${Pe(t.args[0],n)}`,a=`${Pe(t.args[1],n)}`,u=`if(${o}>${a}){\n`;for(let l=2;l<t.args.length;l++){let c=t.endIndex+l-1;if(c>=e.instructionsLength()||e.getInstruction(c).type!==47)continue;let p=wn(c);u+=`${p}=${Pe(t.args[l],n)};\n`}if(!i){u+=`}else if(!isFinite(${a}-${o})){\n`;for(let l=2;l<t.args.length;l++){let c=t.endIndex+l-1;if(c>=e.instructionsLength())continue;let p=e.getInstruction(c);if(p.type!==47)continue;let f=wn(c);u+=`${f}=${Zb(gi(p.valueType),i,t.valueType)};\n`}}u+=`}else{\n`;for(let l=2;l<t.args.length;l++){let c=r+l-1;if(e.getInstruction(c).type!==47)continue;let p=wn(c);u+=`${p}=${Pe(t.args[l],n)};\n`}return u+=`for(${s}=${o};${s}<=${a};${s}++){\n`,u}function nC(e,t,r,n){let i=\"\";for(let s=1;s<t.args.length;s++){let o=t.args[0]+s;if(e.getInstruction(o).type!==47)continue;let a=wn(o);i+=`${a}=${Pe(t.args[s],n)};\n`}i+=`}\n`;for(let s=1;s<t.args.length;s++){let o=r+s;if(o>=e.instructionsLength()||e.getInstruction(o).type!==47)continue;let a=wn(o);i+=`${a}=${Pe(t.args[s],n)};\n`}return i+=`}\n`,i}function iC(e,t,r,n,i){switch(t.type){case 1:return i||t.valueType===b||t.valueType===me||t.valueType===N||t.valueType===z?Zb(t.value,i,t.valueType):(n.push(is(t.value)),`_C[${n.length-1}]`);case 8:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r);return i?`dcg_add(${l},${c})`:`${l}+${c}`}case 9:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r);return i?`dcg_sub(${l},${c})`:`${l}-${c}`}case 10:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r);return i?`dcg_mul(${l},${c})`:`${l}*${c}`}case 11:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r);return i?`dcg_div(${l},${c})`:`${l}/${c}`}case 12:return`${i?\"dcg_\":\"BuiltIn.\"}pow(${Pe(t.args[0],r)},${Pe(t.args[1],r)})`;case 13:return`${i?\"dcg_rawpow\":\"Math.pow\"}(${Pe(t.args[0],r)},${Pe(t.args[1],r)})`;case 14:return`-${Pe(t.args[0],r)}`;case 25:return Pe(t.args[0],r)+(i?\"==\":\"===\")+Pe(t.args[1],r);case 26:return`${Pe(t.args[0],r)}<${Pe(t.args[1],r)}`;case 27:return`${Pe(t.args[0],r)}>${Pe(t.args[1],r)}`;case 28:return`${Pe(t.args[0],r)}<=${Pe(t.args[1],r)}`;case 29:return`${Pe(t.args[0],r)}>=${Pe(t.args[1],r)}`;case 31:return`${Pe(t.args[0],r)}||${Pe(t.args[1],r)}`;case 32:return`${Pe(t.args[0],r)}&&${Pe(t.args[1],r)}`;case 33:let s=Pe(t.args[0],r),o=Pe(t.args[1],r),a=Pe(t.args[2],r);return i&&q(t.valueType)?`dcg_ternary(${s},${o},${a})`:`${s}?${o}:${a}`;case 15:return(i?\"vec2(\":\"[\")+Pe(t.args[0],r)+\",\"+Pe(t.args[1],r)+(i?\")\":\"]\");case 16:return(i?\"vec3(\":\"[\")+Pe(t.args[0],r)+\",\"+Pe(t.args[1],r)+\",\"+Pe(t.args[2],r)+(i?\")\":\"]\");case 17:case 18:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r);return i?`${l}.${c===\"(1.0)\"?\"x\":c===\"(2.0)\"?\"y\":\"z\"}`:`${l}[${c}-1]`}case 38:return(i?yd(t.valueType)+`[${t.args.length}](`:\"[\")+t.args.map(l=>Pe(l,r)).join(\",\")+(i?\")\":\"]\");case 40:case 42:case 3:throw new Error(`Programming Error: expect ${Kn(t.type)} to be removed before emitting code.`);case 39:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r),p=i?\"int\":\"Math.floor\",f=i?sr(e,t.args[0]):`${l}.length`;if(f===void 0)throw ma(sn(e,t.args[0]));let d=t.valueType;return`(${p}(${c})>=1&&${p}(${c})<=${f})?${l}[${p}(${c})-1]:${Zb(gi(d),i,d)}`}case 41:{let l=Pe(t.args[0],r),c=Pe(t.args[1],r);return i?`${l}[int(${c})-1]`:`${l}[${c}-1]`}case 37:{let l=t.args.map(c=>Pe(c,r)).join(\",\");if(i){if(!nc[t.symbol]&&!dd[t.symbol]&&!Wb[t.symbol])throw Tl(t.symbol);return`dcg_${t.symbol}(${l})`}else{let c=lr[t.symbol];return`${c.module}.${c.symbol}(${l})`}}case 44:{if(i)throw Tl(\"random\");return`${Pe(t.args[0],r)}+'::${t.tag}'+${Pe(t.args[1],r)}`}case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:throw new Error(`Unexpected opcode ${t.type}`);default:let u=t;throw new Error(`Unexpected opcode ${u.type}`)}}function Zb(e,t,r){return t?uM(e,r):aM(e)}function aM(e){if(Array.isArray(e))return`[${e.map(aM).join(\",\")}]`;switch(typeof e){case\"boolean\":case\"number\":return e.toString();case\"string\":return`${JSON.stringify(e)}`;case\"object\":if(Ma(e))throw new Error(\"Action values cannot be compiled\");return B(e).toString();default:throw new Error(\"Unexpected value: \"+e)}}function uM(e,t){if(Array.isArray(e)){if(e.length>100)throw lu();let r=q(t)?`[${e.length}]`:\"\",n=q(t)?Fe(t):t,i=\"dcg_const_bust*\"+e.map(s=>uM(s,n)).join(\",\");return yd(t)+r+\"(\"+i+\")\"}switch(typeof e){case\"boolean\":return e.toString();case\"number\":return md(e);case\"string\":throw Tl(\"random\");case\"object\":if(Ma(e))throw new Error(\"Action values cannot be compiled\");return md(B(e));default:throw new Error(\"Unexpected value: \"+e)}}function md(e){let t=e.toString();return/^-?\\d+$/.test(t)?t+\".0\":t}function yd(e){switch(q(e)?Fe(e):e){case me:return\"bool\";case b:return\"float\";case N:return\"vec2\";case ot:case z:return\"vec3\";default:throw new Error(\"Unexpected type: \"+In(e))}}function lM(e,t){let r=e.getInstruction(t);if(q(r.valueType)){let n=sr(e,t);if(n===void 0)throw ma(sn(e,t));if(n>100)throw lu();return`${yd(r.valueType)}[${n}]`}else return yd(r.valueType)}function cM(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);t[e.getReturnIndex()]=!0;for(let r=e.instructionsLength()-1;r>=0;r--){if(!t[r]){e.replaceInstructionWithNoop(r);continue}let n=e.getInstruction(r);if(!be(n))for(let i of n.args)t[i]=!0}}function Fi(e,t){return e.pushLeafInstruction(t)}function or(e,t,r){switch(t.type){case 8:return e.Add(r);case 9:return e.Subtract(r);case 10:return e.Multiply(r);case 11:return e.Divide(r);case 12:return e.Exponent(r);case 13:return e.RawExponent(r);case 14:return e.Negative(r);case 25:return e.Equal(r);case 26:return e.Less(r);case 27:return e.Greater(r);case 28:return e.LessEqual(r);case 29:return e.GreaterEqual(r);case 31:return e.Or(r);case 32:return e.And(r);case 33:return e.Piecewise(r);case 47:return e.BlockVar(t.valueType,r);case 48:return e.BroadcastResult(t.valueType,r);case 15:return e.OrderedPair(r);case 16:return e.OrderedTriple(r);case 17:return e.OrderedPairAccess(r);case 18:return e.OrderedTripleAccess(r);case 37:return e.NativeFunction(t.symbol,t.callData,r);case 42:return e.Distribution(t.symbol,r);case 21:return e.BeginIntegral(t.callData,r);case 22:return e.EndIntegral(r);case 23:return e.BeginBroadcast(r);case 24:return e.EndBroadcast(r);case 19:return e.BeginLoop(t.callData,r);case 20:return e.EndLoop(r);case 38:return e.List(r);case 39:return e.ListAccess(r);case 40:return e.DeferredListAccess(r);case 41:return e.InboundsListAccess(r);case 44:return e.ExtendSeed(t.tag,r);case 49:return e.Action(t.symbols,r);default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function pM(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be converted to broadcast\");let t=e.getInstruction(e.getReturnIndex());if(be(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:case 15:case 16:case 14:case 33:case 17:case 18:return Au(e,t);case 42:return Vr(e,Au(e,t));case 37:{let n=lr[t.symbol];switch(n.tag){case\"default\":case\"trig\":case\"trig2\":case\"inverseTrig\":case\"color\":return Au(e,t);case\"never-broadcast\":{let i=[],s=!1;for(let o of t.args){let a=Vr(e,o);a!==o?(s=!0,i.push(a)):i.push(o)}return s?e.copyInstructionWithArgs(t,i):e.getReturnIndex()}case\"reducer\":if(sC(e,t.args))if(t.args.length===1){let i=t.args[0],s=Vr(e,i);return s!==i?e.copyInstructionWithArgs(t,[s]):e.getReturnIndex()}else return Au(e,t);else return e.getReturnIndex();case\"doubleReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let i=Vr(e,t.args[0]),s=Vr(e,t.args[1]);return i!==t.args[0]||s!==t.args[1]?e.copyInstructionWithArgs(t,[i,s]):e.getReturnIndex()}case\"parameterizedReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let i=Vr(e,t.args[0]);return i===t.args[0]?Au(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[i,t.args[1]])}default:{let i=n.tag;throw new Error(`Programming Error: unexpected tag ${i}`)}}}case 39:case 40:case 41:return Au(e,t,[!1,!0]);case 21:case 22:case 19:case 20:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function sC(e,t){for(let r of t)if(q(e.getInstruction(r).valueType))return!0;return!1}function Au(e,t,r){let n=t.args,i=!1,s=[];for(let d=0;d<n.length;d++){if(r&&!r[d])continue;let m=n[d],y=e.getInstruction(m).valueType;q(y)&&s.indexOf(m)===-1&&s.push(m),y===Oe&&(i=!0)}if(s.length===0)return e.getReturnIndex();if(t.type===33&&s.indexOf(t.args[0])==-1&&s.indexOf(t.args[1])>=0&&s.indexOf(t.args[2])>=0){let d=Vr(e,t.args[1]),m=Vr(e,t.args[2]);return d!==t.args[1]||m!==t.args[2]?or(e,t,[t.args[0],d,m]):e.getReturnIndex()}e.popInstruction();let o=ec(e,s);if(o===void 0)throw new Error(\"Programming Error: expected minListLength to be defined for \"+s.length+\" lists\");let a=o;if(Gt(e.getInstruction(a))&&_t(e,a)===0&&i)return e.ConstantOfType(Oe,[]);let u=e.BeginBroadcast([a]),l=[];for(let d of s)l.push(Co(e,d,u));let c=[];for(let d=0;d<n.length;d++){let m=n[d];if(r&&!r[d])c.push(m);else{let y=s.indexOf(m);c.push(y===-1?m:l[y])}}let p=e.copyInstructionWithArgs(t,c),f=e.EndBroadcast([u,p]);return e.BroadcastResult(tn(e.getInstruction(p).valueType),[f])}function Co(e,t,r){return e.getInstruction(t).type==48?e.DeferredListAccess([t,r]):e.InboundsListAccess([t,r])}function fM(e){let t=[];t.push(\"digraph {\");for(let r=0;r<e.instructionsLength();r++)e.getInstruction(r).type!==0&&t.push(`${r} [label=\"${r}: ${La(e,r)}\"];`);for(let r=0;r<e.instructionsLength();r++){let n=e.getInstruction(r);if(S0(n))for(let i of n.args)t.push(`${r} -> ${i};`)}return t.push(\"}\"),t.join(`\n`)}function Lo(e,t){let r=[];for(let n=0;n<e.instructionsLength();n++)r.push(!1);r[t]=!0;for(let n=0;n<=1;n++){let i=!1;for(let s=t+1;s<e.instructionsLength();s++){let o=e.getInstruction(s);if(be(o)||r[s])continue;let a=!1;for(let u of o.args)if(r[u]){a=!0;break}r[s]=a,a&&$r(o)&&!r[o.args[0]]&&(r[o.args[0]]=!0,i=!0)}if(!i)break}return r}function dM(e,t,r){let n=e.argNames.indexOf(t);if(n===-1)return 0;let i=_n(e,n,r);return cr(i,e.getReturnIndex())}function _n(e,t,{allowRestriction:r,allowClosedBlockReferences:n}){return{chunk:e,argIndex:t,orderTable:[],mask:Lo(e,t),allowRestriction:r,allowClosedBlockReferences:n}}function cr(e,t){let r=e.orderTable[t];if(r!==void 0)return r;let n=oC(e,t);return e.orderTable[t]=n,n}function oC(e,t){let{chunk:r,mask:n,argIndex:i,allowRestriction:s,allowClosedBlockReferences:o}=e;if(!o&&r.isInClosedBlock(t))return 1/0;if(t===i)return 1;let a=r.getInstruction(t);if(On(a)||$r(a))return 1/0;switch(a.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[l,c]=a.args;return Math.max(cr(e,l),cr(e,c))}case 10:{let[l,c]=a.args;return cr(e,l)+cr(e,c)}case 14:return cr(e,a.args[0]);case 11:{let[l,c]=a.args;return cr(e,c)>0?1/0:cr(e,l)}case 12:case 13:{let[l,c]=a.args,p=r.getInstruction(c);if(cr(e,l)===0&&cr(e,c)===0)return 0;if(p.type===1){let f=B(p.value);return f===Math.round(f)&&f>0?cr(e,l)*f:1/0}else return 1/0}case 33:{if(!n[t])return 0;let l=r.getInstruction(a.args[2]);return s&&l.type===1&&isNaN(B(l.value))?cr(e,a.args[1]):1/0}case 2:case 0:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 48:case 47:case 3:case 44:case 49:return n[t]?1/0:0;default:let u=a;throw new Error(`Unexpected opcode ${u.type}`)}}function mM(e,t){let r=e.argNames.indexOf(t),n=Vi(_n(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}));if(cr(n.orderCtx,e.getReturnIndex())>2)throw new Error(\"Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2\");let i=Mr(n,e.getReturnIndex()),s=!1;for(let o=0;o<e.instructionsLength();o++)e.getInstruction(o).type===33&&n.mask[o]&&(s=!0);return{chunk:n.newChunk,coefficients:i,mappedArgIndex:n.valueMap[r],mappedReturnIndex:n.valueMap[e.getReturnIndex()],isRestrictedPolynomial:s}}function Vi(e){let{chunk:t,argIndex:r}=e;if(t.isInClosedBlock(r))throw new Error(\"Programming Error: cannot find polynomial coefficients of an instruction in a closed block\");let n,i;r>=0&&r<t.argNames.length?(n=t.argNames.slice(),i=t.argTypes.slice(),n.splice(r,1),i.splice(r,1)):(n=t.argNames,i=t.argTypes);let s=new Bi({argNames:n,argTypes:i}),o=[];for(let p=0;p<t.instructionsLength();p++){let f=t.getInstruction(p);if(f.type===2)p<r||r<0?o.push(p):p===r?o.push(s.SymbolicVar(t.argTypes[p])):o.push(p-1);else if(be(f))o.push(Fi(s,f));else{let d=[];for(let m of f.args)d.push(o[m]);o.push(or(s,f,d))}}let a=[],u=s.Constant(0),l=s.Constant(1),c=s.Constant(NaN);return{chunk:t,newChunk:s,orderCtx:e,coefficientTable:a,mask:e.mask,valueMap:o,argIndex:r,zero:u,one:l,nan:c}}function Mr(e,t){let{newChunk:r,orderCtx:n,coefficientTable:i,mask:s,valueMap:o,argIndex:a,zero:u,one:l,nan:c}=e,p=i[t];if(p!==void 0)return p;let f;for(s[t]?t===a?f=[u,l]:cr(n,t)>2?f=[c]:f=aC(e,t):f=[o[t]];f.length>1;){let d=r.getInstruction(f[f.length-1]);if(d.type===1&&B(d.value)===0)f.pop();else break}if(f.length===0)throw new Error(\"Programming Error: coefficients cannot be empty\");return i[t]=f,f}function aC(e,t){let r=e.chunk.getInstruction(t),{newChunk:n}=e;switch(r.type){case 8:{let[s,o]=r.args,a=Mr(e,s),u=Mr(e,o),l=a.length-1,c=u.length-1,p=[];for(let f=0;f<=Math.max(l,c);f++)l>=f&&c>=f?p.push(n.Add([a[f],u[f]])):p.push(l>c?a[f]:u[f]);return p}case 9:case 26:case 28:case 27:case 29:{let[s,o]=r.args;(r.type===26||r.type==28)&&([s,o]=[o,s]);let a=Mr(e,s),u=Mr(e,o),l=a.length-1,c=u.length-1,p=[];for(let f=0;f<=Math.max(l,c);f++)l>=f&&c>=f?p.push(n.Subtract([a[f],u[f]])):p.push(l>c?a[f]:n.Negative([u[f]]));return p}case 14:{let s=r.args[0],o=Mr(e,s),a=[];for(let u=0;u<o.length;u++)a.push(n.Negative([o[u]]));return a}case 10:{let[s,o]=r.args,a=Mr(e,s),u=Mr(e,o),l=a.length-1,c=u.length-1,p=[];for(let f=0;f<=l;f++)for(let d=0;d<=c;d++){if(f+d>2)continue;let m=n.Multiply([a[f],u[d]]),y=p[f+d];y===void 0?p[f+d]=m:p[f+d]=n.Add([y,m])}return p}case 11:{let[s,o]=r.args,a=Mr(e,s),u=Mr(e,o),l=[];for(let c=0;c<a.length;c++)l.push(n.Divide([a[c],u[0]]));return l}case 12:case 13:{let[s,o]=r.args,a=Mr(e,s),u=Mr(e,o);if(a.length-1===0)return[n.RawExponent([a[0],u[0]])];let c=n.getInstruction(u[0]);switch(B(c.value)){case 0:return[n.Constant(0)];case 1:return a;case 2:return[n.Multiply([a[0],a[0]]),n.Multiply([n.Constant(2),n.Multiply([a[0],a[1]])]),n.Multiply([a[1],a[1]])]}}case 33:return Mr(e,r.args[1]);case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:throw new Error(`Cannot find polynomial coefficients of opcode ${r.type} that depends on symbol.`);default:let i=r;throw new Error(`Unexpected opcode ${i.type}`)}}function yM(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be converted to broadcast\");let t=e.getInstruction(e.getReturnIndex());if(be(t))return e.getReturnIndex();switch(t.type){case 8:if(wo(e,t.args[0])&&wo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Add([e.OrderedPairAccess([t.args[0],n]),e.OrderedPairAccess([t.args[1],n])]),e.Add([e.OrderedPairAccess([t.args[0],i]),e.OrderedPairAccess([t.args[1],i])])])}else if(Fo(e,t.args[0])&&Fo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Add([e.OrderedTripleAccess([t.args[0],n]),e.OrderedTripleAccess([t.args[1],n])]),e.Add([e.OrderedTripleAccess([t.args[0],i]),e.OrderedTripleAccess([t.args[1],i])]),e.Add([e.OrderedTripleAccess([t.args[0],s]),e.OrderedTripleAccess([t.args[1],s])])])}else return _o(e,t.args[0])&&_o(e,t.args[1])?e.SyntheticNativeFunction(\"mathVector\",[e.Add([e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[0]]),e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[1]])]),e.SyntheticNativeFunction(\"basePointFromVector\",[t.args[0]])]):e.getReturnIndex();case 9:if(wo(e,t.args[0])&&wo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Subtract([e.OrderedPairAccess([t.args[0],n]),e.OrderedPairAccess([t.args[1],n])]),e.Subtract([e.OrderedPairAccess([t.args[0],i]),e.OrderedPairAccess([t.args[1],i])])])}else if(Fo(e,t.args[0])&&Fo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Subtract([e.OrderedTripleAccess([t.args[0],n]),e.OrderedTripleAccess([t.args[1],n])]),e.Subtract([e.OrderedTripleAccess([t.args[0],i]),e.OrderedTripleAccess([t.args[1],i])]),e.Subtract([e.OrderedTripleAccess([t.args[0],s]),e.OrderedTripleAccess([t.args[1],s])])])}else return _o(e,t.args[0])&&_o(e,t.args[1])?e.SyntheticNativeFunction(\"mathVector\",[e.Subtract([e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[0]]),e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[1]])]),e.SyntheticNativeFunction(\"basePointFromVector\",[t.args[0]])]):e.getReturnIndex();case 14:if(wo(e,t.args[0])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Negative([e.OrderedPairAccess([t.args[0],n])]),e.Negative([e.OrderedPairAccess([t.args[0],i])])])}else if(Fo(e,t.args[0])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Negative([e.OrderedTripleAccess([t.args[0],n])]),e.Negative([e.OrderedTripleAccess([t.args[0],i])]),e.Negative([e.OrderedTripleAccess([t.args[0],s])])])}else return _o(e,t.args[0])?e.SyntheticNativeFunction(\"mathVector\",[e.Negative([e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[0]])]),e.SyntheticNativeFunction(\"basePointFromVector\",[t.args[0]])]):e.getReturnIndex();case 10:if(wo(e,t.args[0])&&ao(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([e.OrderedPairAccess([t.args[0],n]),t.args[1]]),e.Multiply([e.OrderedPairAccess([t.args[0],i]),t.args[1]])])}else if(ao(e,t.args[0])&&wo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([t.args[0],e.OrderedPairAccess([t.args[1],n])]),e.Multiply([t.args[0],e.OrderedPairAccess([t.args[1],i])])])}else{if(_o(e,t.args[0])&&ao(e,t.args[1]))return e.SyntheticNativeFunction(\"mathVector\",[e.Multiply([e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[0]]),t.args[1]]),e.SyntheticNativeFunction(\"basePointFromVector\",[t.args[0]])]);if(ao(e,t.args[0])&&_o(e,t.args[1]))return e.SyntheticNativeFunction(\"mathVector\",[e.Multiply([t.args[0],e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[1]])]),e.SyntheticNativeFunction(\"basePointFromVector\",[t.args[1]])]);if(Fo(e,t.args[0])&&ao(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Multiply([e.OrderedTripleAccess([t.args[0],n]),t.args[1]]),e.Multiply([e.OrderedTripleAccess([t.args[0],i]),t.args[1]]),e.Multiply([e.OrderedTripleAccess([t.args[0],s]),t.args[1]])])}else if(ao(e,t.args[0])&&Fo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],n])]),e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],i])]),e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],s])])])}else return e.getReturnIndex()}case 11:if(wo(e,t.args[0])&&ao(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Divide([e.OrderedPairAccess([t.args[0],n]),t.args[1]]),e.Divide([e.OrderedPairAccess([t.args[0],i]),t.args[1]])])}else{if(_o(e,t.args[0])&&ao(e,t.args[1]))return e.SyntheticNativeFunction(\"mathVector\",[e.Divide([e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t.args[0]]),t.args[1]]),e.SyntheticNativeFunction(\"basePointFromVector\",[t.args[0]])]);if(Fo(e,t.args[0])&&ao(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Divide([e.OrderedTripleAccess([t.args[0],n]),t.args[1]]),e.Divide([e.OrderedTripleAccess([t.args[0],i]),t.args[1]]),e.Divide([e.OrderedTripleAccess([t.args[0],s]),t.args[1]])])}else return e.getReturnIndex()}case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 15:case 16:case 33:case 17:case 18:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function wo(e,t){return e.getInstruction(t).valueType===N}function _o(e,t){return e.getInstruction(t).valueType===pe}function Fo(e,t){return e.getInstruction(t).valueType===z}function ao(e,t){return e.getInstruction(t).valueType===b}var uC=[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Exponent\",\"PercentOf\",\"FunctionDefinition\",\"UpdateRule\",\"Substitution\"],hd={isGeometryEnabled(){return!1},is3dProduct(){return!1},is3dPolicy(){return!1},isBeta3d(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},substitutionForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return uC},dimensionVarsEnabled(){return!1}};function gM(e){return 48<=e&&e<=57}function lC(e){return 97<=e&&e<=122}function cC(e){return 65<=e&&e<=90}function bd(e){return lC(e)||cC(e)}function xd(e){return e===92}function jb(e){return e===39}function hM(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}function Bo(e,t){return en(e.token.span,t.prevSpan)}function Vo(e,t,r){return{type:e,span:t,val:r}}function pC(e,t,r,n){return{input:e,prevSpan:t,pos:r,token:n}}function bM(e){return xM(e,0,Xi(e,0))}function xM(e,t,r){for(;hM(e.charCodeAt(t));)t+=1;let n=mC(e,t);return pC(e,r,t,n)}function fs(e){return xM(e.input,e.token.span.end,e.token.span)}function Fn(e){return e.token}function Vs(e,t){if(Fn(e).type!==t)throw`Parse Error: expected ${t}.`;return fs(e)}function TM(e,t){return Fn(e).type===t}function Td(e){return e.pos>=e.input.length}var fC={\"\\\\left\":\"Left\",\"\\\\right\":\"Right\",\"\\\\sqrt\":\"Sqrt\",\"\\\\frac\":\"Frac\",\"\\\\operatorname\":\"OperatorName\",\"\\\\token\":\"Token\"},dC={\"[\":\"[\",\"]\":\"]\",\"{\":\"{\",\"}\":\"}\",\"^\":\"^\",_:\"_\"};function mC(e,t){let r=t;if(t>=e.length)return Vo(\"End\",Xi(e,t),\"\");let n=e.charCodeAt(t);if(gM(n)){let i=Pn(e,r,t+1);return Vo(\"Digit\",i,e.charAt(r))}else if(bd(n)){let i=Pn(e,r,t+1);return Vo(\"Letter\",i,e.charAt(r))}else if(xd(n))if(t+=1,bd(e.charCodeAt(t))){for(;bd(e.charCodeAt(t));)t+=1;let i=Pn(e,r,t),s=Dr(i),o=fC[s]||\"Cmd\";return Vo(o,i,s)}else{t+=1;let i=Pn(e,r,t),s=Dr(i);return Vo(\"EscapedSymbol\",i,s)}else if(jb(n)){for(t+=1;jb(e.charCodeAt(t));)t+=1;if(e.charAt(t)===\"^\"){t+=1;let i=Pn(e,r,t),s=Dr(i);return Vo(\"Primes^\",i,s)}else{let i=Pn(e,r,t),s=Dr(i);return Vo(\"Primes\",i,s)}}else{let i=Pn(e,r,t+1),s=e.charAt(r),o=dC[s]||\"Symbol\";return Vo(o,i,s)}}function Jb(e,t){return{type:\"Group\",span:e,args:t}}function PM(e,t,r){return{type:\"Sqrt\",span:e,optArg:t,arg:r}}function IM(e,t,r){return{type:\"Frac\",span:e,num:t,den:r}}function MM(e,t,r,n){return{type:\"SupSub\",span:e,sup:t,sub:r,nprimes:n}}function EM(e,t,r,n){return{type:\"LeftRight\",span:e,left:t,right:r,arg:n}}function vM(e,t){return{type:\"OperatorName\",span:e,arg:t}}function OM(e,t){return{type:\"TokenNode\",span:e,arg:t}}function SM(e,t){return{type:\"Symbol\",span:e,val:t}}function DM(e){switch(e){case\"Frac\":return 2;case\"^\":case\"_\":case\"Primes^\":case\"Left\":case\"Sqrt\":case\"OperatorName\":case\"Token\":return 1;default:return 0}}function NM(e){let{state:t,tree:r}=Pd(bM(e),!1);if(!Td(t))throw`Parse error: unexpected ${Dr(Fn(t).span)}.`;return r}function Gi(e,t){return{state:e,tree:t}}function Pd(e,t){let r=e,n=[];e:for(;!Td(e);){let s=Fn(e);switch(s.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":case\"[\":case\"{\":case\"^\":case\"_\":case\"Primes\":case\"Primes^\":case\"Left\":case\"Frac\":case\"Sqrt\":case\"OperatorName\":case\"Token\":case\"]\":{if(s.type===\"]\"&&t)break e;let a;if({state:e,tree:a}=AM(e),a.type===\"Group\")for(let u of a.args)n.push(u);else n.push(a);break}case\"}\":case\"Right\":case\"End\":break e;default:throw`Unexpected token type ${s.type}.`}}let i=Bo(r,e);return Gi(e,Jb(i,n))}function AM(e){let t=Fn(e);switch(t.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":return e=fs(e),Gi(e,t);case\"[\":case\"]\":return e=fs(e),Gi(e,SM(t.span,t.val));case\"{\":{e=fs(e);let n;return{state:e,tree:n}=Pd(e,!1),e=Vs(e,\"}\"),Gi(e,n)}case\"^\":case\"_\":case\"Primes\":case\"Primes^\":return PC(e);case\"Left\":return TC(e);case\"Frac\":return xC(e);case\"Sqrt\":return bC(e);case\"OperatorName\":return gC(e);case\"Token\":return hC(e);case\"}\":case\"Right\":throw`Parse Error: unexpected ${t.val}.`;case\"End\":throw\"Parse Error: unexpected end.\";default:throw`Unexpected token type ${t.type}.`}}function gC(e){let t=e,r=Fn(e);e=Vs(e,\"OperatorName\");let n;({state:e,tree:n}=Go(e,r));let i=Bo(t,e);return Gi(e,vM(i,n))}function hC(e){let t=e,r=Fn(e);e=Vs(e,\"Token\");let n;({state:e,tree:n}=Go(e,r));let i=Bo(t,e);return Gi(e,OM(i,n))}function bC(e){let t=e,r=Fn(e);e=Vs(e,\"Sqrt\");let n;TM(e,\"[\")&&({state:e,tree:n}=IC(e));let i;({state:e,tree:i}=Go(e,r));let s=Bo(t,e);return Gi(e,PM(s,n,i))}function xC(e){let t=e,r=Fn(e);e=Vs(e,\"Frac\");let n;({state:e,tree:n}=Go(e,r));let i;({state:e,tree:i}=Go(e,r));let s=Bo(t,e);return Gi(e,IM(s,n,i))}function TC(e){let t=e;e=Vs(e,\"Left\");let r=Fn(e);e=fs(e);let n;({state:e,tree:n}=Pd(e,!1)),e=Vs(e,\"Right\");let i=Fn(e);e=fs(e);let s=Bo(t,e);return Gi(e,EM(s,r,i,n))}function PC(e){let t=e,r,n,i=0;e:for(;!Td(e);){let o=Fn(e);switch(o.type){case\"^\":if(e=fs(e),r)throw\"Parse Error: double superscript.\";({state:e,tree:r}=Go(e,o));break;case\"_\":if(e=fs(e),n)throw\"Parse Error: double subscript.\";({state:e,tree:n}=Go(e,o));break;case\"Primes\":if(e=fs(e),i>0)throw\"Parse Error: double primes.\";i=o.val.length;break;case\"Primes^\":if(e=fs(e),i>0)throw\"Parse Error: double primes.\";if(r)throw\"Parse Error: double superscript\";i=o.val.length-1,{state:e,tree:r}=Go(e,o);break;default:break e}}let s=Bo(t,e);return Gi(e,MM(s,r,n,i))}function Go(e,t){let r=DM(t.type),n;if(r<=0)throw new Error(\"Programming Error: greediness must be greater than 0.\");let i=DM(Fn(e).type);if(i>0&&i<=r){let s=Dr(t.span);throw`Parse Error: can't use ${Dr(Fn(e).span)} as argument of ${s}. Use {}.`}return{state:e,tree:n}=AM(e),n.type!==\"Group\"&&(n=Jb(n.span,[n])),Gi(e,n)}function IC(e){e=Vs(e,\"[\");let t;return{state:e,tree:t}=Pd(e,!0),e=Vs(e,\"]\"),Gi(e,t)}var MC={mcd:\"gcd\",gcf:\"gcd\",mcm:\"lcm\",signum:\"sign\",sgn:\"sign\",stdDevP:\"stdevp\",stddevp:\"stdevp\",stdDev:\"stdev\",stddev:\"stdev\",variance:\"var\",TTest:\"ttest\",TScore:\"tscore\",IndependentTTest:\"ittest\",iTTest:\"ittest\",inverseCdf:\"quantile\",inversecdf:\"quantile\",arsinh:\"arcsinh\",arcosh:\"arccosh\",artanh:\"arctanh\",arcsch:\"arccsch\",arsech:\"arcsech\",arcoth:\"arccoth\"};function RM(e){let t=0;for(;xd(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),MC[e]||e}function CM(e,t){return{type:\"Equals\",span:e,args:t}}function ic(e,t,r){return{type:\"Inequality\",span:e,symbol:t,args:r}}function LM(e,t,r){return{type:\"TrailingInequalityPiece\",span:e,symbol:t,args:r}}function wM(e,t,r){return{type:\"InequalityChain\",span:e,first:t,chain:r}}function _M(e,t){return{type:\"Tilde\",span:e,args:t}}function FM(e,t){return{type:\"Pos\",span:e,args:t}}function VM(e,t){return{type:\"Neg\",span:e,args:t}}function BM(e,t){return{type:\"Add\",span:e,args:t}}function GM(e,t){return{type:\"Sub\",span:e,args:t}}function zM(e,t){return{type:\"Mul\",span:e,args:t}}function qM(e,t){return{type:\"DotMul\",span:e,args:t}}function UM(e,t){return{type:\"CrossMul\",span:e,args:t}}function HM(e,t){return{type:\"Div\",span:e,args:t}}function kM(e,t){return{type:\"Bang\",span:e,args:t}}function sc(e,t){return{type:\"Call\",span:e,args:t}}function Qb(e,t){return{type:\"ImplicitCall\",span:e,args:t}}function $M(e,t){return{type:\"Index\",span:e,args:t}}function Kb(e,t){return{type:\"Paren\",span:e,args:t}}function ex(e,t){return{type:\"List\",span:e,args:t}}function YM(e,t){return{type:\"Pipes\",span:e,args:t}}function tx(e,t){return{type:\"Subscript\",span:e,args:t}}function Id(e,t){return{type:\"Superscript\",span:e,args:t}}function oc(e,t,r){return{type:\"Prime\",span:e,nprimes:t,args:r}}function Md(e,t){return{type:\"Seq\",span:e,args:t}}function XM(e,t){return{type:\"Sqrt\",span:e,args:t}}function WM(e,t){return{type:\"Nthroot\",span:e,args:t}}function ZM(e,t){return{type:\"Frac\",span:e,args:t}}function jM(e,t){return{type:\"Derivative\",span:e,args:t}}function JM(e,t){return{type:\"Integral\",span:e,args:t}}function QM(e,t){return{type:\"EmptyIntegral\",span:e,args:t}}function KM(e,t){return{type:\"Sum\",span:e,args:t}}function eE(e,t){return{type:\"Product\",span:e,args:t}}function tE(e,t){return{type:\"Piecewise\",span:e,args:t}}function rE(e){return{type:\"EmptyPiecewise\",span:e}}function nE(e){return{type:\"EmptyRangeEnd\",span:e}}function iE(e,t){return{type:\"Colon\",span:e,args:t}}function rx(e,t){return{type:\"Ellipsis\",span:e,args:t}}function sE(e,t){return{type:\"For\",span:e,args:t}}function oE(e,t){return{type:\"With\",span:e,args:t}}function aE(e,t){return{type:\"Dot\",span:e,args:t}}function uE(e,t){return{type:\"PercentOf\",span:e,args:t}}function lE(e,t){return{type:\"RightArrow\",span:e,args:t}}function nx(e,t){return{type:\"Juxt\",span:e,args:t}}function cE(e,t){return{type:\"Letter\",span:e,val:t}}function Ed(e,t){return{type:\"Decimal\",span:e,val:t}}function Fa(e,t){return{type:\"Cmd\",span:e,val:RM(t)}}function pE(e,t){return{type:\"Alphanumeric\",span:e,val:t}}function fE(e,t,r,n){return{type:\"MixedNumber\",span:e,whole:t,num:r,den:n}}function Yr(e){if(e.type===\"Subscript\"){if(e.args[1].type!==\"Alphanumeric\")return!1;e=e.args[0]}switch(e.type){case\"Cmd\":return!0;case\"Letter\":return!0;default:return!1}}function dE(e){return e.type!==\"Superscript\"?!1:Yr(e.args[0])}function mE(e,t){if(e.type!==\"Letter\"||e.val!==\"d\"||t.type!==\"Juxt\")return!1;let[r,n]=t.args;return r.type!==\"Letter\"||r.val!==\"d\"?!1:Yr(n)}function Xr(e){return e.type===\"Seq\"?e.args:[e]}function fe(e,t){return{type:\"Err\",span:e,error:t}}function ix(){return{type:\"UnexpectedParseError\"}}function yE(){return{type:\"EmptyInput\"}}function gE(){return{type:\"EmptyGroup\"}}function sx(){return{type:\"EmptySubscript\"}}function hE(){return{type:\"EmptySuperscript\"}}function ox(){return{type:\"EmptyRadical\"}}function bE(){return{type:\"EmptySquareBracket\"}}function xE(){return{type:\"EmptyPipe\"}}function TE(){return{type:\"EmptyRadicalIndex\"}}function ax(){return{type:\"UnexpectedEnd\"}}function zo(e){return{type:\"BinaryOperatorMissingRight\",val:e}}function PE(e){return{type:\"BinaryOperatorMissingLeft\",val:e}}function ux(e){return{type:\"UnaryOperatorMissingRight\",val:e}}function lx(e){return{type:\"UnaryOperatorMissingLeft\",val:e}}function IE(e,t){return{type:\"MissingCloseDelimiter\",open:e,close:t}}function ac(e,t){return{type:\"UnexpectedCloseDelimiter\",open:e,close:t}}function ME(){return{type:\"UnexpectedDifferential\"}}function EE(e){return{type:\"UnrecognizedSymbol\",val:e}}function vE(e){return{type:\"InvalidSubscript\",val:e}}function OE(e){return{type:\"UnexpectedSubscript\",base:e}}function cx(e){return{type:\"FunctionMissingArgument\",val:e}}function SE(){return{type:\"PercentMissingOf\"}}function px(){return{type:\"PrimeWithoutParen\"}}function DE(){return{type:\"SuperscriptWithPrime\"}}function vd(){return{type:\"UnexpectedPrime\"}}function NE(){return{type:\"SumMissingBound\"}}function AE(){return{type:\"ProductMissingBound\"}}function fx(){return{type:\"MissingBound\"}}function RE(){return{type:\"IntegralMissingBound\"}}function CE(){return{type:\"SumMissingBody\"}}function LE(){return{type:\"ProductMissingBody\"}}function wE(){return{type:\"IntegralMissingBody\"}}function _E(){return{type:\"DerivativeMissingBody\"}}function FE(){return{type:\"IntegralMissingDifferential\"}}function VE(){return{type:\"DifferentialWithSuperscript\"}}function BE(){return{type:\"FractionMissingNumerator\"}}function GE(){return{type:\"FractionMissingDenominator\"}}function zE(){return{type:\"FractionEmpty\"}}function dx(e){return{type:\"AdjacentNumbers\",args:e}}function qE(){return{type:\"UnexpectedFor\"}}function UE(){return{type:\"TokenWithSubscript\"}}var OC={\"+\":!0,\"-\":!0,\"*\":!0,\"\\\\cdot\":!0,\"\\\\times\":!0,\"/\":!0,\"!\":!0,\"(\":!0,\")\":!0,\"\\\\{\":!0,\"\\\\}\":!0,\"(|\":!0,\"|)\":!0,\"[\":!0,\"]\":!0,\",\":!0,\"...\":!0,\":\":!0,\"=\":!0,\">\":!0,\"<\":!0,\">=\":!0,\"<=\":!0,\"->\":!0,\"~\":!0,\"%\":!0,\".\":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0},qo={\"\\\\lt\":\"<\",\"\\\\gt\":\">\",\"\\\\le\":\"<=\",\"\\\\ge\":\">=\",\"\\\\leq\":\"<=\",\"\\\\geq\":\">=\",\"\\\\ldots\":\"...\",\"\\\\sim\":\"~\",\"\\\\to\":\"->\",\"\\\\cdot\":\"\\\\cdot\",\"\\\\times\":\"\\\\times\",\"\\\\div\":\"/\",\"\\\\ln\":\"Ln\",\"\\\\log\":\"Log\",\"\\\\int\":\"Int\",\"\\\\sum\":\"Sum\",\"\\\\prod\":\"Prod\",\"\\\\backslash\":\"Err\",\"\\\\for\":\"for\",\"\\\\with\":\"with\"},SC=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\"];for(let e of SC)qo[\"\\\\\"+e]=\"Trig\",qo[\"\\\\\"+e+\"h\"]=\"Trig\",qo[\"\\\\arc\"+e]=\"Trig\",qo[\"\\\\arc\"+e+\"h\"]=\"Trig\",qo[\"\\\\ar\"+e+\"h\"]=\"Trig\";var mx={\"+\":\"+\",\"-\":\"-\",\"*\":\"*\",\"/\":\"/\",\"!\":\"!\",\"(\":\"(\",\")\":\")\",\"[\":\"[\",\"]\":\"]\",\",\":\",\",\"...\":\"...\",\":\":\":\",\"=\":\"=\",\">=\":\">=\",\"<=\":\"<=\",\">\":\">\",\"<\":\"<\",\"~\":\"~\",\".\":\".\"},HE={\"\\\\{\":\"\\\\{\",\"\\\\}\":\"\\\\}\",\"\\\\%\":\"%\"},kE={\"|\":\"(|\",\"\\\\{\":\"\\\\{\",\"[\":\"[\",\"(\":\"(\"},$E={\"|\":\"|)\",\"\\\\}\":\"\\\\}\",\"]\":\"]\",\")\":\")\"},YE=Object.keys(OC);function XE(e,t,r,n,i,s,o,a){return{opts:e,input:t,prevSpan:r,startIndex:n,endIndex:i,token:s,mode:o,parent:a}}function te(e,t){return en(e.token.span,t.prevSpan)}function mr(e,t){return en(e,t.prevSpan)}function gx(e){return Xi(e.token.span.input,e.token.span.start)}function DC(e,t){return{type:\"Differential\",span:e,val:t}}function mn(e,t,r){return{type:e,span:t,val:r}}function uo(e,t){let r=Xi(e.span.input,e.span.start);return hx(t,e,0,r,void 0,void 0)}function hx(e,t,r,n,i,s){let o=t.args;if(r>o.length&&s)return WE(s,n);r=uc(o,r);let{token:a,endIndex:u}=ZE(t,r,i);if(a.type===\"End\"&&s){let l=s.input.args[s.startIndex];if(l.type===\"LeftRight\"){let c=l.right,p=$E[c.val]||\"Err\",f=mn(p,c.span,c.val);return XE(e,t,n,r,u,f,i,s)}}else a.type===\"Int\"?i=NC(i):a.type===\"Differential\"&&(i=AC(i));return XE(e,t,n,r,u,a,i,s)}function Te(e){let t=e.input.args[e.startIndex],r=e.token.span;return t&&t.type===\"LeftRight\"?hx(e.opts,t.arg,0,r,e.mode,e):WE(e,r)}function WE(e,t){let{input:r,endIndex:n,mode:i,parent:s}=e;return hx(e.opts,r,n+1,t,i,s)}function Wr(e){return e.token}function NC(e){return{type:\"integral\",parent:e}}function AC(e){if(!e||e.type!==\"integral\")throw new Error(\"Programming Error: expected lexer to be in integral mode.\");return e.parent}function Zr(e,t){return Wr(e).type===t}function Dd(e){return e.startIndex>=e.input.args.length}function bx(e,t){return t.token.span.start>e.token.span.start}function Cr(e,t){return{token:t,endIndex:e}}function ZE(e,t,r){let n=e.args;if(t>=n.length){let o=Xi(e.span.input,e.span.end);return Cr(t,mn(\"End\",o,\"\"))}let i=e.args[t];switch(i.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":return Cr(t,i);case\"Letter\":{if(!r||r.type!==\"integral\"||i.val!=\"d\")return Cr(t,i);let{endIndex:c,token:p}=ZE(e,t+1,r);if(p.type===\"Letter\"||p.type===\"Cmd\"){let f=DC(en(i.span,p.span),p.val);return Cr(c,f)}else return Cr(t,i)}case\"LeftRight\":{let c=i.left,p=kE[c.val]||\"Err\";var s=en(i.span,c.span);return Cr(t,mn(p,s,c.val))}case\"OperatorName\":let o=[];for(let c of i.arg.args){if(c.type!==\"Letter\")return Cr(t,mn(\"Err\",i.span,Dr(i.arg.span)));o.push(c.val)}let a=\"\\\\\"+o.join(\"\"),u=qo[a]||\"Cmd\";return Cr(t,mn(u,i.span,a));case\"TokenNode\":{let c=\"$\";if(i.arg.args.length===0)return Cr(t,mn(\"Err\",i.span,Dr(i.arg.span)));for(let p of i.arg.args){if(p.type!==\"Digit\")return Cr(t,mn(\"Err\",i.span,Dr(i.arg.span)));c+=p.val}return Cr(t,mn(\"TokenNode\",i.span,c))}case\"Cmd\":{let c=qo[i.val]||\"Cmd\";return Cr(t,mn(c,i.span,i.val))}case\"EscapedSymbol\":{let c=HE[i.val]||\"Err\";return Cr(t,mn(c,i.span,i.val))}case\"Symbol\":return RC(e,t,i);case\"Digit\":return jE(e,t);default:throw`Unexpected atom ${i.type}.`}}function RC(e,t,r){switch(r.val){case\".\":return CC(e,t);case\"-\":{let i=e.args[t+1];if(i&&Od(i,\">\")){let s=mn(\"->\",en(r.span,i.span),\"->\");return Cr(t+1,s)}break}case\"<\":{let i=e.args[t+1];if(i&&Od(i,\"=\")){let s=mn(\"<=\",en(r.span,i.span),\"<=\");return Cr(t+1,s)}break}case\">\":{let i=e.args[t+1];if(i&&Od(i,\"=\")){let s=mn(\">=\",en(r.span,i.span),\">=\");return Cr(t+1,s)}break}}let n=mx[r.val]||\"Err\";return Cr(t,mn(n,r.span,r.val))}function CC(e,t){let r=e.args[t];if(r.type!==\"Symbol\"||r.val!==\".\")throw new Error(\"Programming Error: expected '.'\");if(t+2<e.args.length&&Sd(e.args[t+1])&&Sd(e.args[t+2])){let s=en(r.span,e.args[t+2].span);return Cr(t+2,mn(\"...\",s,Dr(s)))}let n=uc(e.args,t+1);if(n<e.args.length&&e.args[n].type===\"Digit\")return jE(e,t);let i=mx[r.val]||\"Err\";return Cr(t,mn(i,r.span,r.val))}function jE(e,t){let r=LC(e,t);if(r)return r;let n=e.args,i=e.args[t].span,s=[],o=!1,a=!1;for(;t<n.length;t++){let l=uc(n,t);if(l>=n.length)break;let c=n[l];if(c.type===\"Digit\")t=l,o=!0,s.push(c.val);else if(!a&&Sd(c)){if(l+1<n.length&&Sd(e.args[l+1]))break;t=l,a=!0,s.push(\".\")}else break}if(!o)throw new Error(\"Programming Error: decimals must have at least one digit.\");let u=en(i,e.args[t-1].span);return Cr(t-1,mn(\"Decimal\",u,s.join(\"\")))}function LC(e,t){let r=e.args,n=r[t].span,i=[];for(;t<r.length;t++){let l=uc(r,t);if(l>=r.length)break;let c=r[l];if(c.type!==\"Digit\")break;t=l,i.push(c.val)}if(t=uc(r,t),t>=r.length)return;let s=r[t];if(s.type!==\"Frac\")return;let o=[],a=[];for(let l of s.num.args)if(!yx(l)){if(l.type!==\"Digit\")return;o.push(l.val)}for(let l of s.den.args)if(!yx(l)){if(l.type!==\"Digit\")return;a.push(l.val)}let u=en(n,s.span);return Cr(t,fE(u,i.join(\"\"),o.join(\"\"),a.join(\"\")))}function yx(e){switch(e.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":case\"LeftRight\":case\"OperatorName\":case\"TokenNode\":case\"Symbol\":case\"Letter\":case\"Digit\":return!1;case\"Cmd\":return e.val===\"\\\\space\";case\"EscapedSymbol\":return e.val===\"\\\\ \"||e.val===\"\\\\:\"||e.val===\"\\\\,\"||e.val===\"\\\\;\";default:throw`Unexpected atom ${e.type}.`}}function uc(e,t){for(;t<e.length&&yx(e[t]);)t+=1;return t}function Sd(e){return Od(e,\".\")}function Od(e,t){return e.type===\"Symbol\"&&e.val===t}function Ru(e){return{type:\"initial\",tokenType:e}}function lc(e){return{type:\"l\",tokenType:e}}function cc(e){return{type:\"r\",tokenType:e}}function pt(e){return{type:\"la\",tokenType:e}}function Cu(e){return{type:\"ra\",tokenType:e}}function JE(e,t){for(let r of YE)if(t[r]===void 0)throw new Error(`Programming Error: token ${r} must be a assigned a ${e} precedence`)}function Va(e,t,r,n){if(t[r]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${r}.`);t[r]=n}function QE(e){let t={},r={},n={};for(let a=0;a<e.length;a++){let u=e[a];for(let{type:l,tokenType:c}of u)switch(l){case\"initial\":Va(\"initial\",t,c,a);break;case\"l\":Va(\"left\",r,c,a);break;case\"r\":Va(\"right\",n,c,a);break;case\"la\":Va(\"left\",r,c,a),Va(\"right\",n,c,a);break;case\"ra\":Va(\"left\",r,c,a),Va(\"right\",n,c,a-1);break}}JE(\"left\",r),JE(\"right\",n);function i(a){return n[a]}function s(a){return r[a]}function o(a){let u=t[a];return u===void 0?i(a):u}return{rightPrec:i,leftPrec:s,initialPrec:o}}var Lu={},wC=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\",\"sinh\",\"cosh\",\"tanh\",\"coth\",\"sech\",\"csch\"];wC.forEach(function(e){Lu[e]=\"arc\"+e,Lu[\"arc\"+e]=e});var _C=0;function rv(e,t){return FC(e,t)}function Ve(e,t){let r=[];for(let n=0;n<t.length;n++)r.push($t(e,t[n]));return r}function FC(e,t){return e.setInput(VC(e,t),t.span)}function nv(e){if(e.type!==\"Call\")return;let[t,r]=e.args,n=Xr(r);if(Yr(t)&&n.every(Yr))return{base:t,args:n}}function iv(e){return nv(e)!==void 0}function sv(e){return e.type===\"Paren\"&&e.args[0].type===\"Seq\"&&e.args[0].args.every(Yr)}function Tx(e){return Yr(e)||sv(e)}function VC(e,t){let r=e.nodes;switch(t.type){case\"Equals\":{let[n,i]=t.args,s=nv(n);if(s){let{base:o,args:a}=s;return r.FunctionDefinition($t(e,o),Ve(e,a),$t(e,i))}else if(Tx(n)){let o=$t(e,i);return sv(n)?r.CoordinateEquation($t(e,n),o):r.Assignment($t(e,n),o)}return r.Equation($t(e,n),$t(e,i))}case\"Tilde\":{let[n,i]=Ve(e,t.args);return r.Regression(n,i)}case\"Inequality\":return Ba(e,t);case\"InequalityChain\":{if(t.chain.length>1)throw Hp();let{first:{symbol:n,args:[i,s]},chain:[{symbol:o,args:[a]}]}=t;return Yr(s)?r.DoubleInequality([$t(e,i),n,$t(e,s),o,$t(e,a)]):Ba(e,t)}case\"Call\":{let[n,i]=t.args;if(n.type===\"Cmd\")switch(n.val){case\"histogram\":return r.Histogram(Ve(e,Xr(i)));case\"dotplot\":return r.DotPlot(Ve(e,Xr(i)));case\"boxplot\":return r.BoxPlot(Ve(e,Xr(i)));case\"ttest\":return r.TTest(Ve(e,Xr(i)));case\"ittest\":return r.IndependentTTest(Ve(e,Xr(i)));case\"stats\":return r.Stats(Ve(e,Xr(i)));default:return pc(e,t)}return pc(e,t)}default:return pc(e,t)}}function ov(e){if(e.type!==\"Paren\")return!1;let[t]=e.args;return t.type!==\"Seq\"?!1:t.args.length===2||t.args.length===3}function $t(e,t){return e.setInput(pc(e,t),t.span)}function pc(e,t){let r=e.nodes;switch(t.type){case\"Pos\":return $t(e,t.args[0]);case\"Neg\":let n=-1,i=t.args[0];for(;;)if(i.type===\"Pos\"||i.type===\"Paren\"&&!ov(i))i=i.args[0];else if(i.type===\"Neg\")i=i.args[0],n*=-1;else break;switch(i.type){case\"Decimal\":{let o=ev(i);return r.Constant(n===-1?li(o):o)}case\"MixedNumber\":{let o=tv(i);return r.MixedNumber(n===-1?li(o):o)}default:return n===-1?r.Negative([$t(e,i)]):$t(e,i)}case\"Add\":return r.Add(Ve(e,t.args));case\"Sub\":return r.Subtract(Ve(e,t.args));case\"Mul\":return r.Multiply(Ve(e,t.args));case\"DotMul\":return r.DotMultiply(Ve(e,t.args));case\"CrossMul\":return r.CrossMultiply(Ve(e,t.args));case\"Div\":return r.Divide(Ve(e,t.args));case\"Bang\":{let[o]=t.args;return o.type===\"Call\"?r.FunctionFactorial(Ve(e,o.args)):r.FunctionCall(\"\\\\factorial\",Ve(e,t.args))}case\"PercentOf\":return r.PercentOf(Ve(e,t.args));case\"Call\":return KE(e,t);case\"ImplicitCall\":return HC(t),KE(e,t);case\"Dot\":{let o=t.args[1],[a,u]=Ve(e,t.args);if(lv(o)){let l=Xi(o.span.input,o.span.end),c=e.setInput(cv(e),l);u=e.setInput(r.SeededFunctionCall(u,[c]),o.span)}else if(o.type===\"Letter\")switch(o.val){case\"x\":case\"y\":case\"z\":return r.NamedCoordinateAccess(o.val,[a]);default:break}else if(o.type===\"Call\"){let l=o.args[0];if(l.type===\"Letter\")switch(l.val){case\"x\":case\"y\":case\"z\":return r.Multiply([e.setInput(r.NamedCoordinateAccess(l.val,[a]),en(t.args[0].span,l.span)),$t(e,o.args[1])])}}return r.DotAccess([a,u])}case\"Prime\":{let[o]=t.args;if(o.type===\"Call\"){let[a,u]=o.args,l=Xr(u).length;if(a.type===\"Cmd\"&&a.val===\"logbase\"){if(l!==2)throw ya()}else if(l!==1)throw ya();return r.Prime(t.nprimes,Ve(e,t.args))}else throw o.type===\"ImplicitCall\"?Up():qp()}case\"Index\":{let[o,a]=t.args;if(a.type===\"Seq\")return r.ListAccess([$t(e,o),e.setInput(r.List(Ve(e,a.args)),void 0)]);if(a.type===\"Ellipsis\"){let[u,l]=a.args;return r.ListAccess([$t(e,o),e.setInput(r.Range([e.setInput(r.List(Ve(e,Xr(u))),void 0),e.setInput(r.List(l.type===\"EmptyRangeEnd\"?[]:Ve(e,Xr(l))),void 0)]),void 0)])}return uv(a)?r.ListAccess([$t(e,o),e.setInput(Ba(e,a),void 0)]):r.ListAccess(Ve(e,t.args))}case\"Paren\":{let[o]=t.args;if(o.type===\"Seq\"){if(o.args.length===0)throw cg();return r.ParenSeq(Ve(e,o.args))}else return $t(e,o)}case\"List\":{if(t.args.length===0)return r.List([]);let o=t.args[0];if(o.type===\"Ellipsis\"){let[a,u]=o.args;return r.Range([e.setInput(r.List(Ve(e,Xr(a))),void 0),e.setInput(r.List(Ve(e,Xr(u))),void 0)])}else if(o.type===\"For\"){let[a,u]=o.args,l=e.setInput(r.Identifier(`_comprehensionIndex_${_C++}`),void 0),c=$t(Nd(e,{prefix:\"li\",expr:l}),a),p=[];for(let f of Xr(u)){if(!fc(f))throw gh();p.push(e.setInput(r.AssignmentExpression(Ve(e,f.args)),f.span))}return r.ListComprehension(l,c,p)}return r.List(Ve(e,Xr(o)))}case\"Pipes\":{let[o]=t.args;return r.Norm([$t(e,o)])}case\"Subscript\":{let[o,a]=t.args;if(a.val.length===0)throw zp();let u;switch(o.type){case\"Letter\":u=o.val;break;case\"Cmd\":u=o.val;break;default:throw og()}if(u===\"ans\")throw rn(\"ans\");return r.Identifier(`${u}_${a.val}`)}case\"Superscript\":{let[o,a]=t.args;if(o.type===\"Call\"&&o.args[1].type!==\"Seq\"&&!kC(o))return r.FunctionExponent(Ve(e,[o.args[0],o.args[1],a]));if(o.type===\"Dot\"){let u=o.args[1],[l,c]=Ve(e,o.args),p=$t(e,a);if(u.type===\"Letter\")switch(u.val){case\"x\":case\"y\":case\"z\":return r.Exponent([e.setInput(r.NamedCoordinateAccess(u.val,[l]),o.span),p]);default:break}else if(u.type===\"Call\"){let f=u.args[0];if(f.type===\"Letter\")switch(f.val){case\"x\":case\"y\":case\"z\":return r.Multiply([e.setInput(r.NamedCoordinateAccess(f.val,[l]),en(o.args[0].span,f.span)),e.setInput(r.Exponent([$t(e,u.args[1]),p]),Pn(t.span.input,u.args[0].span.end,a.span.end))]);default:break}}return r.Exponent([e.setInput(r.DotAccess([l,c]),o.span),p])}else return r.Exponent(Ve(e,t.args))}case\"Sqrt\":return r.FunctionCall(\"sqrt\",Ve(e,t.args));case\"Nthroot\":return r.FunctionCall(\"nthroot\",Ve(e,[t.args[1],t.args[0]]));case\"Frac\":return r.Divide(Ve(e,t.args));case\"Derivative\":{let o=Ve(e,t.args);if(!Yr(t.args[0]))throw ae(`Expected identifier in derivative, but found ${t.args[0].type}`);return r.Derivative(o[0],[o[1]])}case\"Integral\":{let[o,a,u,l]=t.args,c=Ve(e,[o,a,u,l]);return r.Integral(c)}case\"EmptyIntegral\":{let[o,a,u]=Ve(e,t.args),l=e.setInput(r.Constant(Me(1,1)),void 0);return r.Integral([o,a,u,l])}case\"Sum\":{let[o,a,u]=t.args;if(!fc(a))throw Jg();let l=Ve(e,[a.args[0],a.args[1],u]),c=$t(Nd(e,{prefix:\"ro\",expr:l[0]}),o);return r.Sum(l.concat(c))}case\"Product\":{let[o,a,u]=t.args;if(!fc(a))throw Qg();let l=Ve(e,[a.args[0],a.args[1],u]),c=$t(Nd(e,{prefix:\"ro\",expr:l[0]}),o);return r.Product(l.concat(c))}case\"Juxt\":{if(e.writeIntegral){let[u,l]=t.args;if(l.type===\"Letter\"&&l.val===\"t\"&&u.type===\"Juxt\"&&([u,l]=u.args,l.type===\"Letter\"&&l.val===\"n\")){if(u.type===\"Juxt\"){if([u,l]=u.args,l.type===\"Letter\"&&l.val===\"i\")throw ef()}else if(u.type===\"Letter\"&&u.val===\"i\")throw ef()}}let[o,a]=t.args;if(o.type===\"MixedNumber\"&&!(Yr(a)||a.type===\"Piecewise\"||a.type===\"Call\"||a.type===\"Paren\"))throw Gp(Ad(o));if(a.type===\"MixedNumber\")throw Gp(Ad(a));return r.Multiply(Ve(e,t.args))}case\"Letter\":return r.Identifier(t.val);case\"Cmd\":{let o=t.val;switch(o){case\"ans\":{if(e.currentIndex===void 0)throw Al(\"ans\");return r.Ans(`ans_{${e.currentIndex-1}}`)}case\"approx\":throw vp(o);case\"dt\":{if(!e.allowDt)throw Al(o);return r.Identifier(o)}case\"index\":{if(!e.allowIndex)throw Al(o);return r.Identifier(o)}default:return r.Identifier(o)}}case\"With\":{if(e.isSubstitutionRHS)throw uf();let[o,a]=t.args,u=se($({},e),{isSubstitutionRHS:!0});return r.Substitution($t(u,o),zC(u,a))}case\"Decimal\":return r.Constant(ev(t));case\"MixedNumber\":return r.MixedNumber(tv(t));case\"Piecewise\":return UC(e,t);case\"RightArrow\":return qC(e,t);case\"Seq\":return r.BareSeq(Ve(e,t.args));case\"EmptyPiecewise\":if(!r.Piecewise.empty)throw Pa();return r.Piecewise.empty();case\"Equals\":throw rn(\"=\");case\"Inequality\":case\"InequalityChain\":throw jm();case\"Tilde\":throw rn(\"~\");case\"Colon\":throw rn(\":\");case\"Ellipsis\":throw rn(\"...\");case\"For\":throw nf();case\"EmptyRangeEnd\":throw Wg();case\"Err\":throw $C(t.error);default:throw`Unexpected surface node ${t.type}.`}}function xx(e){return Lu.hasOwnProperty(e)}function av(e){return e===\"ln\"||e===\"log\"||e===\"logbase\"}function BC(e){return e.type===\"Decimal\"&&e.val===\"2\"}function GC(e){return e.type!==\"Neg\"?!1:(e=e.args[0],e.type===\"Decimal\"&&e.val===\"1\")}function KE(e,t){let r=e.nodes,[n,i]=t.args,s=$t(e,n),o=Xr(i),a=Ve(e,o);if(lv(n)){let u=Xi(i.span.input,i.span.start),l=e.setInput(cv(e),u);return r.SeededFunctionCall(s,[l].concat(a))}if(Yr(n))return r.FunctionCall(s,a);if(n.type===\"Superscript\"){let[u,l]=n.args;if(u.type===\"Cmd\"){let c=u.val;if(xx(c)||av(c)){if(BC(l))return r.Exponent([e.setInput(r.FunctionCall(c,a),void 0),$t(e,l)]);if(GC(l)&&Lu[c]!==void 0)return r.FunctionCall(Lu[c],a);throw xx(c)?dg(c):mg(c===\"logbase\"?\"log\":c)}}}return r.Multiply([s,$t(e,i)])}function zC(e,t){let r=e.nodes;if(t.type===\"Seq\"){let o=!1,a=!1;for(let u=0;u<t.args.length;u++){if(t.args[u].type===\"With\")throw _l();fc(t.args[u])?o=!0:a=!0}if(o&&a)throw _l()}if(t.type===\"With\")throw uf();let n=Xr(t),i=[],s=[];for(let o of n){if(!fc(o))throw Ih();let a=e.setInput(r.AssignmentExpression(Ve(e,o.args)),o.span),u=a._symbol;if(s.indexOf(u)>=0)throw Oh(u);s.push(u),i.push(a)}return i}function qC(e,t){let r=e.nodes;if(!Yr(t.args[0]))throw Ey();return e=Nd(e,{prefix:\"ec\",expr:e.setInput(r.Identifier(\"globalEventCount\"),void 0)}),r.UpdateRule(Ve(e,t.args))}function UC(e,t){let r=e.nodes,[n]=t.args,i=Xr(n),s,o=[];e:for(s=0;s<i.length;s++){let f=i[s];switch(f.type){case\"Colon\":{let[d,m]=f.args;if(!uv(d))throw hg();if(m.type===\"With\"&&m.args[1].type===\"Seq\")throw _l();o.push({condition:e.setInput(Ba(e,d),d.span),if_expr:$t(e,m)});break}case\"Equals\":case\"Inequality\":case\"InequalityChain\":o.push({condition:e.setInput(Ba(e,f),f.span),if_expr:e.setInput(r.Constant(Me(1,1)),Pn(\"1\",0,1))});break;default:break e}}if(s===0)throw yg();if(s<i.length-1)throw gg();let a,u;s===i.length-1?(a=pc(e,i[s]),u=i[s]):a=r.Constant(NaN);let l=a,c=u==null?void 0:u.span,p;for(;o.length;)p=o.pop(),l=r.Piecewise([p.condition,p.if_expr,e.setInput(l,c)]),c=void 0;return l}function uv(e){return e.type===\"Equals\"||e.type===\"Inequality\"||e.type===\"InequalityChain\"}function Ba(e,t){let r=e.nodes;switch(t.type){case\"Equals\":return r.Comparator[\"=\"](Ve(e,t.args));case\"Inequality\":return r.Comparator[t.symbol](Ve(e,t.args));case\"InequalityChain\":if(t.chain.length>1)throw Hp();let{first:{symbol:n,args:[i,s]},chain:[{symbol:o,args:[a]}]}=t,u=Xi(t.span.input,t.span.start);return r.And([e.setInput(Ba(e,ic(u,n,[i,s])),en(i.span,s.span)),e.setInput(Ba(e,ic(u,o,[s,a])),en(s.span,a.span))]);default:throw ae(`Unexpected type for condition: ${t.type}`)}}function HC(e){let[t,r]=e.args;if(t.type===\"Superscript\"&&(t=t.args[0]),t.type===\"Cmd\"&&t.val===\"logbase\"&&r.type===\"Seq\"&&r.args.length===2){if(!ds(r.args[0]))throw Bp(\"log\")}else if(!ds(r))throw t.type===\"Cmd\"?Bp(t.val):ae(`Unexpected type for args of implicit call: ${r.type}`)}function ev(e){return aa(e.val)}function tv(e){let t=aa(e.whole),r=aa(e.num),n=aa(e.den);return Ms(t,Ki(r,n))}function kC(e){if(e.type!==\"Call\")return!1;let t=e.args[0];for(;t.type===\"Superscript\"||t.type===\"Subscript\"||t.type===\"Prime\";)t=t.args[0];return t.type!==\"Cmd\"?!1:xx(t.val)||av(t.val)}function fc(e){return e.type===\"Equals\"&&Yr(e.args[0])}function $C(e){switch(e.type){case\"UnexpectedParseError\":case\"MissingBound\":case\"EmptyGroup\":case\"UnexpectedDifferential\":case\"UnexpectedEnd\":return ae(`Unexpected error type: ${e.type}`);case\"InvalidOperatorName\":return sg();case\"UnexpectedCloseDelimiter\":case\"MissingCloseDelimiter\":return uh(e.open,e.close);case\"UnrecognizedSymbol\":return e.val===\".\"?rn(e.val):vp(e.val);case\"EmptyInput\":return bg();case\"BinaryOperatorMissingRight\":case\"BinaryOperatorMissingLeft\":return El(e.val===\"%\"?\"% of\":e.val);case\"UnaryOperatorMissingLeft\":return Qy(e.val);case\"UnaryOperatorMissingRight\":return Ky(e.val);case\"UnexpectedSubscript\":return xg(e.base);case\"PercentMissingOf\":return ph();case\"SumMissingBound\":return Zg();case\"ProductMissingBound\":return jg();case\"IntegralMissingBound\":return th();case\"SumMissingBody\":return ih();case\"ProductMissingBody\":return sh();case\"IntegralMissingBody\":return oh();case\"DerivativeMissingBody\":return ah();case\"IntegralMissingDifferential\":return rh();case\"DifferentialWithSuperscript\":return nh();case\"FractionMissingNumerator\":return eg();case\"FractionMissingDenominator\":return tg();case\"FractionEmpty\":return rg();case\"EmptySuperscript\":return ng();case\"EmptySubscript\":return zp();case\"InvalidSubscript\":return ig(e.val);case\"SuperscriptWithPrime\":return ag();case\"PrimeWithoutParen\":return Up();case\"UnexpectedPrime\":return qp();case\"EmptyRadical\":return ug();case\"EmptyRadicalIndex\":return lg();case\"EmptySquareBracket\":return pg();case\"EmptyPipe\":return fg();case\"FunctionMissingArgument\":return mi(e.val,1,0);case\"AdjacentNumbers\":return Zy(Ad(e.args[0]),Ad(e.args[1]));case\"TokenWithSubscript\":return jy();case\"UnexpectedFor\":return nf();default:throw`Unexpected surface node ${e.type}.`}}function Ad(e){switch(e.type){case\"Decimal\":return e.val;case\"MixedNumber\":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function ds(e){switch(e.type){case\"Letter\":case\"Decimal\":case\"MixedNumber\":case\"Cmd\":case\"EmptyPiecewise\":return!0;case\"Neg\":{let r=e.args[0];for(;;)if(r.type===\"Pos\"||r.type===\"Paren\"&&!ov(r))r=r.args[0];else if(r.type===\"Neg\")r=r.args[0];else break;return r.type===\"Decimal\"||r.type===\"MixedNumber\"}case\"Pos\":return ds(e.args[0]);case\"Paren\":return ds(e.args[0]);case\"Juxt\":case\"Mul\":case\"DotMul\":case\"CrossMul\":case\"Div\":return ds(e.args[0])&&ds(e.args[1]);case\"Subscript\":return ds(e.args[0]);case\"Superscript\":case\"Frac\":case\"Add\":case\"Sub\":return ds(e.args[0])&&ds(e.args[1]);case\"Piecewise\":{let[r]=e.args;return r.type===\"Equals\"||r.type===\"Inequality\"||r.type===\"InequalityChain\"}case\"Call\":{let[r,n]=e.args;return Yr(r)||dE(r)?!1:ds(r)&&ds(n)}case\"Derivative\":case\"Sqrt\":case\"Nthroot\":case\"Pipes\":case\"Bang\":return!1;case\"Equals\":case\"Inequality\":case\"InequalityChain\":case\"Tilde\":case\"ImplicitCall\":case\"Index\":case\"List\":case\"Seq\":case\"Integral\":case\"EmptyIntegral\":case\"Sum\":case\"Product\":case\"Colon\":case\"Ellipsis\":case\"For\":case\"With\":case\"Dot\":case\"PercentOf\":case\"Prime\":case\"EmptyRangeEnd\":case\"RightArrow\":return!1;default:throw`Unexpected surface node ${e.type}.`}}function lv(e){return e.type!==\"Cmd\"?!1:e.val===\"random\"||e.val===\"shuffle\"}function cv(e){let t=e.nodes.ExtendSeed(\"\",[e.setInput(e.nodes.Identifier(\"globalRandomSeed\"),void 0),e.setInput(e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:r,expr:n}of e.seedExtensions)t=e.nodes.ExtendSeed(r,[e.setInput(t,void 0),n]);return t}function Nd(e,t){let r=e.seedExtensions||[];return se($({},e),{seedExtensions:r.concat(t)})}var YC=[[Ru(\"(\"),pt(\")\"),Ru(\"\\\\{\"),pt(\"\\\\}\"),cc(\"[\"),pt(\"]\"),Ru(\"(|\"),pt(\"|)\"),pt(\"Differential\"),pt(\"End\")],[pt(\"for\")],[cc(\"with\")],[Cu(\"...\")],[pt(\",\")],[Cu(\":\")],[cc(\"->\")],[lc(\"with\")],[pt(\"=\"),pt(\">\"),pt(\"<\"),pt(\">=\"),pt(\"<=\"),pt(\"~\")],[lc(\"->\")],[pt(\"+\"),pt(\"-\")],[pt(\"*\"),pt(\"\\\\cdot\"),pt(\"\\\\times\"),pt(\"/\"),pt(\"Decimal\"),pt(\"MixedNumber\"),pt(\"Letter\"),pt(\"Cmd\"),pt(\"TokenNode\"),pt(\"%\"),cc(\"(\"),pt(\"\\\\{\"),pt(\"(|\"),pt(\"Frac\"),pt(\"Sqrt\"),pt(\"Trig\"),pt(\"Ln\"),pt(\"Log\"),Cu(\"Int\"),Cu(\"Sum\"),Cu(\"Prod\")],[Ru(\"+\"),Ru(\"-\")],[pt(\"!\")],[pt(\"SupSub\")],[lc(\"[\"),pt(\".\")],[lc(\"(\")],[pt(\"Err\")]],{leftPrec:Rd,rightPrec:pv,initialPrec:yv}=QE(YC),fv={trailingComma:!1};function gv(e,t){let r=t?$($({},fv),t):fv,n=uo(e,r),i=XC(n);return i.type===\"Err\"&&i.error.type===\"EmptyGroup\"?fe(i.span,yE()):i}function XC(e){return Uo(e,{isToplevel:!0})}function Uo(e,{isToplevel:t}={isToplevel:!1}){if(Dd(e))return fe(te(e,e),gE());let{state:r,tree:n}=Er(e,0,{isToplevel:t});return n.type!==\"Err\"&&!Dd(r)?Ix(r).tree:n}function F(e,t){return{state:e,tree:t}}function Er(e,t,{isToplevel:r}={isToplevel:!1}){let n=e,i;if({state:n,tree:i}=WC(n),i.type===\"Err\")return F(n,i);if(!bx(e,n))throw new Error(\"Programming Error: parseInitial did not advance state.\");for(;!Dd(n);){let s;if(Zr(n,\"(\")&&!JC(i)?s=pv(\"(\"):s=Rd(Wr(n).type),t>=s)break;let o=n,a=ZC(n,i,r)?Rd(\",\")-1:pv(Wr(n).type);if({state:n,tree:i}=jC(n,i,a),i.type===\"Err\")return F(n,i);if(!bx(o,n))throw new Error(\"Programming Error: parseSuccessor did not advance state.\")}return F(n,i)}function Vn(e){return e.type===\"UnexpectedDifferential\"||e.type===\"UnexpectedCloseDelimiter\"||e.type===\"UnexpectedEnd\"||e.type===\"BinaryOperatorMissingLeft\"}function WC(e){let t=e,r=Wr(e),n=yv(r.type),i;switch(r.type){case\"+\":{if(e=Te(e),{state:e,tree:i}=Er(e,n),i.type===\"Err\"){if(!Vn(i.error))return F(e,i);let o=te(t,e),a=fe(o,ux(r.val));return F(e,a)}return F(e,FM(te(t,e),[i]))}case\"-\":if(e=Te(e),{state:e,tree:i}=Er(e,n),i.type===\"Err\"){if(!Vn(i.error))return F(e,i);let o=te(t,e),a=fe(o,ux(r.val));return F(e,a)}else return F(e,VM(te(t,e),[i]));case\"(\":return dc(e);case\"\\\\{\":return e=Te(e),Zr(e,\"\\\\}\")?(e=Te(e),F(e,rE(te(t,e)))):({state:e,tree:i}=Er(e,n),{state:e,tree:i}=mc(t,e,i,\"\\\\{\",\"\\\\}\"),i.type===\"Err\"?F(e,i):F(e,tE(te(t,e),[i])));case\"[\":return e=Te(e),Zr(e,\"]\")?(e=Te(e),F(e,ex(te(t,e),[]))):({state:e,tree:i}=Er(e,n),{state:e,tree:i}=mc(t,e,i,\"[\",\"]\"),i.type===\"Err\"?F(e,i):F(e,ex(te(t,e),[i])));case\"(|\":{if(e=Te(e),Zr(e,\"|)\")){e=Te(e);let o=te(t,e);return F(e,fe(o,xE()))}return{state:e,tree:i}=Er(e,n),{state:e,tree:i}=mc(t,e,i,\"(|\",\"|)\"),i.type===\"Err\"?F(e,i):F(e,YM(te(t,e),[i]))}case\"Frac\":{if(e.opts.disallowFrac)throw rf();e=Te(e);let o=Uo(uo(r.num,e.opts)),a=Uo(uo(r.den,e.opts));if(o.type===\"Err\"&&o.error.type===\"EmptyGroup\"&&a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=te(t,e),l=fe(u,zE());return F(e,l)}if(o.type===\"Err\"&&o.error.type===\"EmptyGroup\"){let u=te(t,e),l=fe(u,BE());return F(e,l)}if(a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=te(t,e),l=fe(u,GE());return F(e,l)}if(o.type===\"Err\")return F(e,o);if(a.type===\"Err\")return F(e,a);if(mE(o,a)&&a.type===\"Juxt\"){let u=a.args[1],l;if({state:e,tree:l}=Er(e,Rd(\"*\")-1),l.type===\"Err\"){if(Vn(l.error)){let c=te(t,e);return F(e,fe(c,_E()))}return F(e,l)}return F(e,jM(te(t,e),[u,l]))}return F(e,ZM(te(t,e),[o,a]))}case\"Sqrt\":if(e=Te(e),r.optArg){let o=Uo(uo(r.optArg,e.opts));if(o.type===\"Err\")return o.error.type===\"EmptyGroup\"?F(e,fe(o.span,TE())):F(e,o);let a=Uo(uo(r.arg,e.opts));return a.type===\"Err\"?a.error.type===\"EmptyGroup\"?F(e,fe(a.span,ox())):F(e,a):F(e,WM(te(t,e),[o,a]))}else{let o=Uo(uo(r.arg,e.opts));return o.type===\"Err\"?o.error.type===\"EmptyGroup\"?F(e,fe(o.span,ox())):F(e,o):F(e,XM(te(t,e),[o]))}case\"Trig\":case\"Ln\":{e=Te(e);let o=Fa(te(t,e),r.val),a=0,u=Wr(e);if(u.type===\"SupSub\"){if(e=Te(e),u.sub){let p=te(t,e),f=fe(p,OE(o.val));return F(e,f)}let c=Cd(u,e.opts);if(c){if(c.type===\"Err\")return F(e,c);o=Id(te(t,e),[o,c])}a=u.nprimes}let l=Zr(e,\"(\");if(l){if({state:e,tree:i}=dc(e),i.type===\"Err\")return F(e,i);i=sc(te(t,e),[o,i.args[0]])}else{if({state:e,tree:i}=Er(e,n-1),i.type===\"Err\")return Vn(i.error)?F(e,fe(te(t,e),cx(r.val))):F(e,i);i=Qb(te(t,e),[o,i])}if(a>0){let c=te(t,e);if(!l){let p=fe(c,px());return F(e,p)}i=oc(c,a,[i])}return F(e,i)}case\"Log\":{e=Te(e);let o=te(t,e),a=Fa(o,r.val),u=0,l,c,p=Wr(e);if(p.type===\"SupSub\"&&(e=Te(e),l=hv(p,e.opts),c=Cd(p,e.opts),u=p.nprimes),l&&l.type===\"Err\")return F(e,l);if(c&&c.type===\"Err\")return F(e,c);let f=Zr(e,\"(\");if(f){if({state:e,tree:i}=dc(e),i.type===\"Err\")return F(e,i);i=i.args[0]}else if({state:e,tree:i}=Er(e,n-1),i.type===\"Err\")return Vn(i.error)?F(e,fe(te(t,e),cx(r.val))):F(e,i);let d=l?Fa(o,\"\\\\logbase\"):a,m=l?Md(te(t,e),Xr(i).concat(l)):i;if(c&&(d=Id(te(t,e),[d,c])),f?i=sc(te(t,e),[d,m]):i=Qb(te(t,e),[d,m]),u>0){let y=te(t,e);if(!f){let g=fe(y,px());return F(e,g)}i=oc(y,u,[i])}return F(e,i)}case\"Int\":{e=Te(e);let o=Wr(e);e=Te(e);let a=Px(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?F(e,fe(a.span,RE())):F(e,a);let{sup:u,sub:l}=a,c;if(Zr(e,\"Differential\"))return{state:e,tree:c}=mv(e),c.type===\"Err\"?F(e,c):F(e,QM(te(t,e),[c,l,u]));if({state:e,tree:i}=Er(e,n),i.type===\"Err\")return Vn(i.error)?F(e,fe(i.span,wE())):F(e,i);let p=i;return Zr(e,\"Differential\")?({state:e,tree:c}=mv(e),c.type===\"Err\"?F(e,c):F(e,JM(te(t,e),[c,l,u,p]))):F(e,fe(te(t,e),FE()))}case\"Sum\":{e=Te(e);let o=Wr(e);e=Te(e);let a=Px(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?F(e,fe(a.span,NE())):F(e,a);let{sup:u,sub:l}=a;return{state:e,tree:i}=Er(e,n),i.type===\"Err\"?Vn(i.error)?F(e,fe(i.span,CE())):F(e,i):F(e,KM(te(t,e),[i,l,u]))}case\"Prod\":{e=Te(e);let o=Wr(e);e=Te(e);let a=Px(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?F(e,fe(a.span,AE())):F(e,a);let{sup:u,sub:l}=a;return{state:e,tree:i}=Er(e,n),i.type===\"Err\"?Vn(i.error)?F(e,fe(i.span,LE())):F(e,i):F(e,eE(te(t,e),[i,l,u]))}case\"Cmd\":return e=Te(e),i=Fa(te(t,e),r.val),F(e,i);case\"TokenNode\":{e=Te(e);let o=Wr(e);return o.type===\"SupSub\"&&o.sub?(e=Te(e),F(e,fe(te(t,e),UE()))):(i=Fa(te(t,e),r.val),F(e,i))}case\"Letter\":return e=Te(e),i=cE(te(t,e),r.val),F(e,i);case\"Decimal\":{e=Te(e);let o=Ed(te(t,e),r.val),a=e.token;if(a.type===\"Decimal\"||a.type===\"MixedNumber\"){let u=e;e=Te(e);let l=te(t,e),c=a.type===\"MixedNumber\"?a:Ed(te(u,e),a.val);return F(e,fe(l,dx([o,c])))}return F(e,o)}case\"MixedNumber\":{if(e.opts.disallowFrac)throw rf();e=Te(e);let o=e.token;if(o.type===\"Decimal\"||o.type===\"MixedNumber\"){let a=e;e=Te(e);let u=te(t,e),l=o.type===\"MixedNumber\"?o:Ed(te(a,e),o.val);return F(e,fe(u,dx([r,l])))}return F(e,r)}case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\",\":case\"=\":case\">\":case\"<\":case\">=\":case\"<=\":case\"->\":case\"~\":case\":\":case\"...\":case\"%\":case\".\":{e=Te(e);let o=te(t,e),a=fe(o,PE(r.val));return F(e,a)}case\"for\":{e=Te(e);let o=te(t,e),a=fe(o,qE());return F(e,a)}case\"with\":{e=Te(e);let o=te(t,e),a=fe(o,ix());return F(e,a)}case\"!\":{e=Te(e);let o=te(t,e),a=fe(o,lx(r.val));return F(e,a)}case\"SupSub\":{e=Te(e);let o=\"supsub\";r.sub?o=\"subscript\":r.sup?o=\"superscript\":r.nprimes>0&&(o=\"prime\");let a=te(t,e),u=fe(a,lx(o));return F(e,u)}case\")\":case\"\\\\}\":case\"]\":case\"|)\":case\"Differential\":return Ix(e);case\"Err\":{e=Te(e);let o=te(t,e),a=fe(o,EE(r.val));return F(e,a)}case\"End\":{let o=te(t,e),a=fe(o,ax());return F(e,a)}default:throw`Unexpected token type ${r.type}.`}}function ZC(e,t,r){return Zr(e,\"=\")&&r&&(iv(t)||Tx(t))}function jC(e,t,r){let n=Wr(e),i;switch(n.type){case\"+\":case\"-\":case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\"=\":case\"~\":case\":\":case\".\":case\"->\":case\"for\":{if(e=Te(e),{state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let o=mr(t.span,e),a=fe(o,zo(n.val));return F(e,a)}else return F(e,i);return F(e,dv(n.type,mr(t.span,e),[t,i]))}case\"with\":{if(e=Te(e),{state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let o=mr(t.span,e),a=fe(o,zo(n.val));return F(e,a)}else return F(e,i);return F(e,dv(n.type,mr(t.span,e),[t,i]))}case\"%\":{e=Te(e);let o=Wr(e);if(o.type!==\"Cmd\"||o.val!==\"of\"&&o.val!==\"\\\\of\"){let a=fe(n.span,SE());return F(e,a)}if(e=Te(e),{state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let a=mr(t.span,e),u=fe(a,zo(n.val));return F(e,u)}else return F(e,i);return F(e,uE(mr(t.span,e),[t,i]))}case\">=\":case\"<=\":case\">\":case\"<\":{let o=n.type;if(e=Te(e),{state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let c=mr(t.span,e),p=fe(c,zo(n.val));return F(e,p)}else return F(e,i);let a=ic(mr(t.span,e),o,[t,i]),u=[],l=Wr(e).type;for(;l===\">=\"||l===\"<=\"||l===\">\"||l===\"<\";){let c=e;if(o=l,e=Te(e),{state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let p=mr(t.span,e),f=fe(p,zo(n.val));return F(e,f)}else return F(e,i);u.push(LM(te(c,e),o,[i])),l=Wr(e).type}return u.length?F(e,wM(mr(t.span,e),a,u)):F(e,a)}case\"!\":return e=Te(e),F(e,kM(mr(t.span,e),[t]));case\"[\":{let o=e;if(e=Te(e),Zr(e,\"]\")){e=Te(e);let a=te(o,e);return F(e,fe(a,bE()))}return{state:e,tree:i}=Er(e,r),{state:e,tree:i}=mc(o,e,i,\"[\",\"]\"),i.type===\"Err\"?F(e,i):F(e,$M(mr(t.span,e),[t,i]))}case\"Sqrt\":case\"Frac\":case\"Letter\":case\"Cmd\":case\"TokenNode\":case\"Trig\":case\"Ln\":case\"Log\":case\"Sum\":case\"Int\":case\"Prod\":case\"Decimal\":case\"MixedNumber\":case\"\\\\{\":case\"(|\":return{state:e,tree:i}=Er(e,r),i.type===\"Err\"?F(e,i):F(e,nx(mr(t.span,e),[t,i]));case\"(\":if(Yr(t)){if({state:e,tree:i}=dc(e),i.type===\"Err\")return F(e,i);let o=mr(t.span,e);return F(e,sc(o,[t,i.args[0]]))}else if(t.type===\"Prime\"&&Yr(t.args[0])){if({state:e,tree:i}=dc(e),i.type===\"Err\")return F(e,i);let o=mr(t.span,e);return F(e,oc(o,t.nprimes,[sc(o,[t.args[0],i.args[0]])]))}else return{state:e,tree:i}=Er(e,r),i.type===\"Err\"?F(e,i):F(e,nx(mr(t.span,e),[t,i]));case\"SupSub\":{e=Te(e);let o=bv(n),a=Cd(n,e.opts);if(o&&o.type===\"Err\")return F(e,o);if(a&&a.type===\"Err\")return F(e,a);if(o&&(t=tx(mr(t.span,e),[t,o])),a&&(t=Id(mr(t.span,e),[t,a])),n.nprimes>0){let u=mr(t.span,e);if(!Yr(t)){let l=fe(u,vd());return F(e,l)}t=oc(u,n.nprimes,[t])}return F(e,t)}case\",\":{let o=[t];for(;Zr(e,\",\")&&(e=Te(e),!(Zr(e,\"...\")||e.opts.trailingComma&&QC(e)));){if({state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let a=mr(t.span,e),u=fe(a,zo(n.val));return F(e,u)}else return F(e,i);o.push(i)}return F(e,Md(mr(t.span,e),o))}case\"...\":{if(e=Te(e),Zr(e,\",\")&&(e=Te(e)),r>=Rd(Wr(e).type))return F(e,rx(mr(t.span,e),[t,nE(gx(e))]));if({state:e,tree:i}=Er(e,r),i.type===\"Err\")if(Vn(i.error)){let o=mr(t.span,e),a=fe(o,zo(n.val));return F(e,a)}else return F(e,i);return F(e,rx(mr(t.span,e),[t,i]))}case\"]\":case\")\":case\"\\\\}\":case\"|)\":case\"Differential\":return Ix(e);case\"Err\":return Er(e,r);case\"End\":{let o=te(e,e),a=fe(o,ax());return F(e,a)}default:throw`Unexpected token type ${n.type}.`}}function JC(e){return!!(Yr(e)||e.type===\"Prime\"&&Yr(e.args[0]))}function dv(e,t,r){switch(e){case\"+\":return BM(t,r);case\"-\":return GM(t,r);case\"*\":return zM(t,r);case\"\\\\cdot\":return qM(t,r);case\"\\\\times\":return UM(t,r);case\"/\":return HM(t,r);case\"=\":return CM(t,r);case\"~\":return _M(t,r);case\":\":return iE(t,r);case\".\":return aE(t,r);case\"->\":return lE(t,r);case\"for\":return sE(t,r);case\"with\":return oE(t,r);default:throw`Unexpected token type ${e}.`}}function hv(e,t){if(!e.sub)return;let r=e.sub,n=Uo(uo(r,t));return n.type===\"Err\"&&n.error.type===\"EmptyGroup\"?fe(n.span,sx()):n}function bv(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return fe(t.span,sx());let r=[];for(let n of t.args)if(n.type===\"Digit\"||n.type===\"Letter\")r.push(n.val);else{let i=n.span;return fe(i,vE(Dr(i)))}return pE(t.span,r.join(\"\"))}function Cd(e,t){if(!e.sup)return;let r=Uo(uo(e.sup,t));return r.type===\"Err\"?r.error.type===\"EmptyGroup\"?fe(r.span,hE()):r:e.nprimes>0?fe(e.span,DE()):r}function Px(e,t,r){if(e.type!==\"SupSub\"){let s=te(t,r);return fe(s,fx())}if(e.nprimes>0){let s=te(t,r);return fe(s,vd())}let n=hv(e,r.opts),i=Cd(e,r.opts);if(!n||n.type===\"Err\"&&n.error.type===\"EmptySubscript\"||!i||i.type===\"Err\"&&i.error.type===\"EmptySuperscript\"){let s=te(t,r);return fe(s,fx())}return n.type===\"Err\"?n:i.type===\"Err\"?i:{type:\"Bounds\",sup:i,sub:n}}function dc(e){let t=e,r=Wr(e),n=yv(r.type);if(Zr(e,\"(\"))e=Te(e);else throw new Error(\"Programming Error: expected '(' at start of parseParen.\");if(Zr(e,\")\")){let s=Md(gx(e),[]);e=Te(e);let o=te(t,e);return F(e,Kb(o,[s]))}let i;return{state:e,tree:i}=Er(e,n),{state:e,tree:i}=mc(t,e,i,\"(\",\")\"),i.type===\"Err\"?F(e,i):F(e,Kb(te(t,e),[i]))}function mv(e){let t=e,r=Wr(e);if(r.type!==\"Differential\")throw new Error(\"Programming Error: expected differential\");e=Te(e);let n=Fa(r.span,r.val),i=Wr(e);if(i.type===\"SupSub\"){e=Te(e);let s=te(t,e),o=bv(i);if(o){if(o.type===\"Err\")return F(e,o);n=tx(s,[n,o])}if(i.sup)return F(e,fe(s,VE()));if(i.nprimes>0)return F(e,fe(s,vd()))}return F(e,n)}function mc(e,t,r,n,i){if(r.type===\"Err\"&&r.error.type!==\"UnexpectedEnd\")return F(t,r);if(r.type===\"Err\"||!Zr(t,i)){let s=te(e,t),o=fe(s,IE(n,i));return F(t,o)}return t=Te(t),F(t,r)}function Ix(e){let t=e;switch(Wr(e).type){case\")\":{e=Te(e);let n=te(t,e);return F(e,fe(n,ac(\"(\",\")\")))}case\"]\":{e=Te(e);let n=te(t,e);return F(e,fe(n,ac(\"[\",\"]\")))}case\"\\\\}\":{e=Te(e);let n=te(t,e);return F(e,fe(n,ac(\"\\\\{\",\"\\\\}\")))}case\"|)\":{e=Te(e);let n=te(t,e);return F(e,fe(n,ac(\"|\",\"|\")))}case\"Differential\":{e=Te(e);let n=te(t,e);return F(e,fe(n,ME()))}default:{e=Te(e);let n=te(t,e);return F(e,fe(n,ix()))}}}function QC(e){return Zr(e,\")\")||Zr(e,\"]\")||Zr(e,\"\\\\}\")}function KC(){throw Pa()}function xv(e,t){return t&&!e._inputSpan&&e.setInputSpan(t),e}function zi(e,t={}){let r=typeof e;if(r!==\"string\")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${r}`);let n=x;if(t.disabledFeatures){n=Object.create(n);for(let l of t.disabledFeatures){if(!n[l])throw new Error(`Programming Error: ${l} cannot be disabled because it is not a parsenode.`);n[l]=KC}}let i=t.seedPrefix===void 0?\"\":t.seedPrefix,s=0,o=()=>{let l=`${i}::vc${s}`;return s+=1,l},a={nodes:n,currentIndex:t.index,setInput:xv,nextSeed:o,allowDt:!!t.allowDt,allowIndex:!!t.allowIndex,writeIntegral:!!t.writeIntegral},u={};t.trailingComma!==void 0&&(u.trailingComma=t.trailingComma),t.disallowFrac&&(u.disallowFrac=!0);try{let l=NM(e),c=gv(l,u),p=rv(a,c);return p.parseOptions=t,p}catch(l){let c;return l instanceof x.Error?c=l:typeof l==\"string\"?c=new x.Error(l):c=ae(l),c.parseOptions=t,c}}function tL(e,t,r){return{chunk:e,argMap:t,start:r}}function Ho(e,t,r,n){let i=tL(e,[t],r);return yc(i,n)}function yc(e,t){let{chunk:r,argMap:n,start:i}=e;if(t<i)return t;let s=n[t-i];if(s!==void 0)return s;let o=rL(e,t);e.argMap[t-i]=o;let a=r.getInstruction(t);if(On(a))switch(a.type){case 23:case 21:break;case 19:{let l=a.args.length-2;for(let c=0;c<l;c++)yc(e,t+1+c);break}default:let u=a;throw new Error(`Programming Error. Unexpected OpCode: ${u.type}`)}else if($r(a)){let u=a.args.length-1;for(let l=0;l<u;l++)yc(e,t+1+l)}return o}function rL(e,t){let{chunk:r,start:n}=e,i=r.getInstruction(t);if($r(i)){let a=i.args[0];for(let u=a;u<=t;u++){let l=r.getInstruction(u);if(!be(l))for(let c of l.args)c<a&&yc(e,c)}}if(be(i))return Fi(r,i);let s=[];for(let a of i.args)s.push(yc(e,a));let o=e.argMap[t-n];return o!==void 0?o:or(r,i,s)}var jt=Symbol(\"FRAME_SENTINEL\");function wu(e,t){return Mx(e,t).freeDependencies}function Mx(e,t){let r={};return t.type===\"FunctionDefinition\"&&(t=t._expression),Ex(e,t,r)}function Tv(e,t,r){let n=[],i=[],s=[],o=[],a=[];for(let u of t.scopes){let l=Tv(e,u,r);for(let c of l.freeDependencies)n.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&n.push(c);for(let c of l.substitutionDependencies)o.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&o.push(c);for(let c of l.substitutionBodyDependencies)a.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&a.push(c);for(let c of l.updateSymbols)i.indexOf(c)===-1&&i.push(c);for(let c of l.substitutionSymbols)s.indexOf(c)===-1&&s.push(c)}for(let u of t.dependencies){if(t.definitions.indexOf(u)!==-1)continue;let l=nL(e,u,r),c=t.substitutionDependencies.indexOf(u)!==-1;for(let p of l.freeDependencies)n.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&n.push(p),c&&o.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&o.push(p),t.isSubstitutionBody&&a.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&a.push(p);for(let p of l.substitutionDependencies)o.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&o.push(p);for(let p of l.updateSymbols)i.indexOf(p)===-1&&i.push(p);for(let p of l.substitutionSymbols)s.indexOf(p)===-1&&s.push(p)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:s,substitutionDependencies:o,substitutionBodyDependencies:a}}function Ex(e,t,r){if(t.type===\"Slider\"||t.type===\"Assignment\")return Ex(e,t._expression,r);{let{freeDependencies:n,substitutionDependencies:i,updateSymbols:s,substitutionSymbols:o,substitutionBodyDependencies:a}=Tv(e,t.getScope(),r),u=t.getUpdateSymbols();if(u.length>0){s=s.slice();for(let c of u)s.indexOf(c)===-1&&s.push(c)}let l=t.getSubstitutionSymbols();if(l.length>0){o=o.slice();for(let c of l)o.indexOf(c)===-1&&o.push(c)}return{freeDependencies:n,updateSymbols:s,substitutionSymbols:o,substitutionDependencies:i,substitutionBodyDependencies:a}}}function nL(e,t,r){if(r[t])return r[t];if(we[t])return r[t]={freeDependencies:[],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t];let n=e[t];if(n===jt)throw new Error(\"Programming error: _getSymbolFreeDependencies called with a symbol that is defined in a local scope\");return n?(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t]=Ex(e,n,r),r[t]):(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t])}function Pv(e,t){for(var r={},n=t.getDependencies().slice();n.length;){var i=n.pop();if(!r.hasOwnProperty(i)){var s=e[i];if(s===jt)return;r[i]=s,s&&s.getDependencies&&Array.prototype.push.apply(n,s.getDependencies())}}return iL(r)}function iL(e){let t=[];for(let r in e)t.push([r,e[r]]);return t}function _u(e,t,r){let n=e.getInstruction(t);if(!re(n.valueType,b)&&!re(n.valueType,N)&&!re(n.valueType,z))throw gy([ne(n.valueType)]);let i=e.getInstruction(r);if(!re(i.valueType,b)&&i.type!==0)throw ae(`Unexpected derivative var type ${i.valueType}`);let s=e.Constant(0);if(t<r)return s;let o=e.Constant(1),a=e.Constant(NaN),u=Lo(e,r),l=dL(e,t);e.derivativeMaps[r]||(e.derivativeMaps[r]={maxValidReference:e.instructionsLength()-1,map:[]});let{map:c,maxValidReference:p}=e.derivativeMaps[r];for(let y=0;y<c.length;y++){let g=c[y];g!==void 0&&g>p&&(c[y]=void 0)}let f=[],d=!1;for(let y=0;y<r;y++)f[y]=y,c[y]=s;return vx({chunk:e,derivativeVarIndex:r,forwardMask:u,backwardMask:l,valueMap:f,derivativeMap:c,mustCopy:d,ZERO:s,ONE:o,NAN:a},r,t),e.derivativeMaps[r].maxValidReference=e.instructionsLength()-1,c[t]}function vx(e,t,r){let{chunk:n,valueMap:i,derivativeMap:s,backwardMask:o}=e;for(let a=t;a<=r;a++){let u=s[a];if(u!==void 0)if(n.getInstruction(u).type===0)s[a]=void 0;else{i[a]=Ld(e,a);continue}if(!o[a]){i[a]=Ld(e,a);continue}let l=n.getInstruction(a);if(On(l)&&l.endIndex!==-1)switch(l.type){case 21:{a=sL(e,a);continue}case 19:case 23:{a=uL(e,a);continue}}i[a]=Ld(e,a),s[a]=lL(e,a)}return r}function sL(e,t){let{chunk:r,forwardMask:n,valueMap:i,derivativeMap:s,ZERO:o}=e,a=r.getInstruction(t),u=a.endIndex,l=r.getInstruction(u),c=o;if(n[a.args[1]]){let p=i[a.args[1]];c=r.Add([c,r.Multiply([s[a.args[1]],Ho(r,p,t,l.args[1])])])}if(n[a.args[0]]){let p=i[a.args[0]];c=r.Subtract([c,r.Multiply([s[a.args[0]],Ho(r,p,t,l.args[1])])])}if(oL(r,t,n)){let p=i.slice();p[t]=or(r,a,[p[a.args[0]],p[a.args[1]]]),s[t]=o,vx(se($({},e),{valueMap:p,mustCopy:!0}),t+1,u-1);let f=or(r,l,[p[l.args[0]],s[l.args[1]]]);s[u]=f,c=r.Add([c,or(r,r.getInstruction(u+1),[f])])}else for(let p=t;p<=u;p++)s[p]=o;if(aL(r,t,i)){let p=se($({},e),{mustCopy:!0});for(let f=t;f<=u+1;f++)i[f]=Ld(p,f)}else for(let p=t;p<=u+1;p++)i[p]=p;return s[u+1]=c,u+l.args.length-1}function oL(e,t,r){let n=e.getInstruction(t),i=e.getInstruction(n.endIndex);if(i.args[1]<t+1)return r[i.args[1]];for(let s=t+1;s<=i.args[1];s++){let o=e.getInstruction(s);if(!be(o)){for(let a of o.args)if(a<t&&r[a])return!0}}return!1}function aL(e,t,r){let n=e.getInstruction(t);for(let i=t;i<=n.endIndex;i++){let s=e.getInstruction(i);if(!be(s)){for(let o of s.args)if(r[o]!==o)return!0}}return!1}function uL(e,t){let{chunk:r,derivativeMap:n,valueMap:i,ZERO:s}=e,o=r.getInstruction(t),a=o.endIndex,u=r.getInstruction(a),l;if(o.type===23)i[t]=or(r,o,[i[o.args[0]]]),n[t]=s,l=t+1;else{let p=[];p.push(i[o.args[0]],i[o.args[1]]);for(let f=2;f<o.args.length;f++)p.push(i[o.args[f]],n[o.args[f]]);i[t]=or(r,o,p),n[t]=s;for(let f=2;f<o.args.length;f++)i[t+f-1]=or(r,r.getInstruction(t+f-1),[i[t]]),n[t+f-1]=or(r,r.getInstruction(t+f-1),[i[t]]);l=t+o.args.length-1}vx(se($({},e),{mustCopy:!0}),l,a-1);let c=[];c.push(i[u.args[0]]);for(let p=1;p<u.args.length;p++)c.push(i[u.args[p]],n[u.args[p]]);i[a]=or(r,u,c),n[a]=s;for(let p=1;p<u.args.length;p++)i[a+p]=or(r,r.getInstruction(a+p),[i[a]]),n[a+p]=or(r,r.getInstruction(a+p),[i[a]]);return a+u.args.length-1}function Ld(e,t){let{chunk:r,valueMap:n,mustCopy:i}=e,s=r.getInstruction(t);if(be(s))return i?Fi(r,s):t;{let o=[],a=!1;for(let u of s.args)o.push(n[u]),n[u]!==u&&(a=!0);return a||i?or(r,s,o):t}}function lL(e,t){let{chunk:r,derivativeVarIndex:n,forwardMask:i,valueMap:s,derivativeMap:o,ZERO:a,ONE:u,NAN:l}=e,c=r.getInstruction(t);if(t===n)if(q(c.valueType)){let f=Qr(r,t),d=r.BeginBroadcast([f]),m=r.EndBroadcast([d,u]);return r.BroadcastResult(j,[m])}else return u;if(On(c)||$r(c)||c.type===47||c.type===48||c.type===25||c.type===27||c.type===26||c.type===29||c.type===28||c.type===32||c.type===31||c.type===42||c.type===44||c.type===49)return a;if(!i[t]||be(c))return c.valueType!==b?pL(r,[s[t],a]):c.type!==1||isFinite(B(c.value))?a:l;if(c.type===38||c.type===15||c.type===16){let f=[];for(let d of c.args)f.push(o[d]);return or(r,c,f)}if(c.type===33)return or(r,c,[s[c.args[0]],o[c.args[1]],o[c.args[2]]]);let p=a;for(let f=0;f<c.args.length;f++){if(!i[c.args[f]])continue;let d=o[c.args[f]];if(d===a)continue;let m=cL(e,s[t],f,d);m!==a&&(p=p===a?m:fL(r,[m,p]))}return p}function cL(e,t,r,n){let{chunk:i,ZERO:s,ONE:o,NAN:a}=e,u=i.getInstruction(t);switch(u.type){case 8:return n;case 9:switch(r){case 0:return n;default:return i.Negative([n])}case 10:switch(r){case 0:return i.Multiply([n,u.args[1]]);default:return i.Multiply([u.args[0],n])}case 11:switch(r){case 0:return i.Divide([n,u.args[1]]);default:return i.Multiply([u.args[0],i.Divide([i.Negative([n]),i.Multiply([u.args[1],u.args[1]])])])}case 14:return i.Negative([n]);case 12:case 13:switch(r){case 0:return i.Multiply([i.Multiply([u.args[1],i.Exponent([u.args[0],i.Subtract([u.args[1],o])])]),n]);default:return i.Multiply([i.Piecewise([i.Equal([u.args[0],s]),i.Piecewise([i.GreaterEqual([u.args[1],s]),s,a]),i.Multiply([i.SyntheticNativeFunction(\"ln\",[u.args[0]]),t])]),n])}case 37:return mL(i,t,Mv[u.symbol][r],n);case 39:case 40:case 41:case 17:case 18:switch(r){case 0:return or(i,u,[n,u.args[1]]);default:return s}default:{let l=u;throw new Error(`Unimplemented derivative for opcode ${l.type}`)}}}function pL(e,t){switch(e.getInstruction(t[0]).valueType){case xe:return e.SyntheticNativeFunction(\"scaleTangentSegment\",t);case oe:return e.SyntheticNativeFunction(\"scaleTangentLine\",t);case ve:return e.SyntheticNativeFunction(\"scaleTangentRay\",t);case ue:return e.SyntheticNativeFunction(\"scaleTangentCircle\",t);case ee:return e.SyntheticNativeFunction(\"scaleTangentArc\",t);case Ie:return e.SyntheticNativeFunction(\"scaleTangentUndirectedAngleMarker\",t);case ye:return e.SyntheticNativeFunction(\"scaleTangentDirectedAngleMarker\",t);default:return e.Multiply(t)}}function fL(e,t){switch(e.getInstruction(t[0]).valueType){case xe:return e.SyntheticNativeFunction(\"addTangentSegment\",t);case oe:return e.SyntheticNativeFunction(\"addTangentLine\",t);case ve:return e.SyntheticNativeFunction(\"addTangentRay\",t);case ue:return e.SyntheticNativeFunction(\"addTangentCircle\",t);case ee:return e.SyntheticNativeFunction(\"addTangentArc\",t);case Ie:return e.SyntheticNativeFunction(\"addTangentUndirectedAngleMarker\",t);case ye:return e.SyntheticNativeFunction(\"addTangentDirectedAngleMarker\",t);default:return e.Add(t)}}function dL(e,t){let r=[];for(let n=0;n<t;n++)r.push(!1);r.push(!0);for(let n=t;n>=0;n--){if(!r[n])continue;let i=e.getInstruction(n);if(!be(i))if(i.type===33)r[i.args[1]]=!0,r[i.args[2]]=!0;else for(let s of i.args)r[s]=!0}return r}function mL(e,t,r,n){let i=Object.create(we),s=Vl({},{},-1),a=e.getInstruction(t).args;for(let u=0;u<a.length;u++){let l=yL[u];Jn(s,l,a[u]),i[l]=jt}return Jn(s,\"x_1\",n),i.x_1=jt,Jn(s,\"q\",t),i.q=jt,Se(Bn(hd,i,e,s,void 0,{},void 0),r)}var yL=[\"x\",\"y\",\"z\",\"u\"],Iv={exp:[\"q*x_1\"],ln:[\"\\\\{x >= 0: x_1/x \\\\}\"],log:[\"\\\\{x >= 0: x_1/(x*\\\\ln(10)) \\\\}\"],sqrt:[\"x_1/(2*q)\"],rtxsqpone:[\"x*x_1/q\"],rtxsqmone:[\"x*x_1/q\"],sin:[\"\\\\cos(x)*x_1\"],cos:[\"-\\\\sin(x)*x_1\"],tan:[\"(1+q^2)*x_1\"],arcsin:[\"x_1/\\\\sqrt{1 - x^2}\"],arccos:[\"-x_1/\\\\sqrt{1 - x^2}\"],sinh:[\"\\\\cosh(x)*x_1\"],cosh:[\"\\\\sinh(x)*x_1\"],tanh:[\"(\\\\sech(x))^2*x_1\"],arcsinh:[\"x_1/\\\\rtxsqpone(x)\"],arccosh:[\"\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}\"],arctanh:[\"\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}\"],csc:[\"-\\\\cot(x)*q*x_1\"],sec:[\"\\\\tan(x)*q*x_1\"],cot:[\"-(1+q^2)*x_1\"],arccsc:[\"-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],arcsec:[\"x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],arccot:[\"-x_1/(1+x^2)\"],csch:[\"-\\\\coth(x)*q*x_1\"],sech:[\"-\\\\tanh(x)*q*x_1\"],coth:[\"-(\\\\csch(x))^2*x_1\"],arccsch:[\"-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))\"],arcsech:[\"\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}\"],arccoth:[\"\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}\"],factorial:[\"q*\\\\polyGamma(0, x + 1)*x_1\"],floor:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],ceil:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],round:[\"\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}\"],abs:[\"\\\\{ x=0: 0/0, \\\\sign(x)*x_1 \\\\}\"],sign:[\"\\\\{ x=0: 0/0, 0*x_1 \\\\}\"],distance:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\"],distance3d:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\"],segment3d:[\"\\\\segment(x_1,(0,0,0))\",\"\\\\segment((0,0,0),x_1)\"],triangle:[\"\\\\triangle(x_1,(0,0,0),(0,0,0))\",\"\\\\triangle((0,0,0),x_1,(0,0,0))\",\"\\\\triangle((0,0,0),(0,0,0),x_1)\"],sphere:[\"\\\\sphere(x_1,0)\",\"\\\\sphere((0,0,0),x_1)\"],pointDet:[\"\\\\pointDet(x_1,y)\",\"\\\\pointDet(x,x_1)\"],pointDot:[\"\\\\pointDot(x_1,y)\",\"\\\\pointDot(x,x_1)\"],pointPerp:[\"\\\\pointPerp(x_1)\"],segment:[\"\\\\segment(x_1,(0,0))\",\"\\\\segment((0,0),x_1)\"],line:[\"\\\\line(x_1,(0,0))\",\"\\\\line((0,0),x_1)\"],ray:[\"\\\\ray(x_1,(0,0))\",\"\\\\ray((0,0),x_1)\"],vector:[\"\\\\vector(x_1, (0,0))\",\"\\\\vector((0,0), x_1)\"],mathVector:[\"\\\\mathVector(x_1,(0,0))\",\"\\\\mathVector((0,0),x_1)\"],vectorDisplacementAsPoint:[\"\\\\vectorDisplacementAsPoint(x_1)\"],basePointFromVector:[\"\\\\basePointFromVector(x_1)\"],circle:[\"\\\\circle(x_1,0)\",\"\\\\circle((0,0),x_1)\"],arc:[\"\\\\arc(x_1,(0,0),(0,0))\",\"\\\\arc((0,0),x_1,(0,0))\",\"\\\\arc((0,0),(0,0),x_1)\"],arcCenter:[\"(0/0,0/0)\"],arcOmega:[\"0/0\"],center:[\"\\\\center(x_1)\"],radius:[\"\\\\radius(x_1)\"],undirectedAngleMarker:[\"\\\\undirectedAngleMarker(x_1)\"],directedAngleMarker:[\"\\\\directedAngleMarker(x_1,0,0,0)\",\"\\\\directedAngleMarker((0,0),x_1,0,0)\",\"\\\\directedAngleMarker((0,0),0,x_1,0)\",\"\\\\directedAngleMarker((0,0),0,0,x_1)\"],directedCoterminalAngle:[\"\\\\directedCoterminalAngle(x_1)\"],undirectedCoterminalAngle:[\"\\\\undirectedCoterminalAngle(x_1)\"],supplement:[\"\\\\supplement(x_1)\"],directedAngleMarkerMultiplier:[\"\\\\directedAngleMarkerMultiplier(x_1)\"],undirectedAngleMarkerMultiplier:[\"\\\\undirectedAngleMarkerMultiplier(x_1)\"],directedAngleMarkerRawDelta:[\"\\\\directedAngleMarkerRawDelta(x_1)\"],undirectedAngleMarkerRawDelta:[\"\\\\undirectedAngleMarkerRawDelta(x_1)\"],polygonInteriorUndirectedAngles:[\"\\\\polygonInteriorUndirectedAngles(x_1)\"],polygonInteriorDirectedAngles:[\"\\\\polygonInteriorDirectedAngles(x_1)\"],lineFromSegment:[\"x_1\"],lineFromRay:[\"x_1\"],segmentGlider:[\"\\\\segmentGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentGlider(x,1)-\\\\segmentGlider(x,0))*x_1,(0,0)\\\\}\"],rayGlider:[\"\\\\rayGlider(x_1,y)\",\"\\\\{0<y:(\\\\rayGlider(x,1)-\\\\rayGlider(x,0))*x_1,(0,0)\\\\}\"],lineGlider:[\"\\\\lineGlider(x_1,y)\",\"(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))*x_1\"],circleGlider:[\"\\\\circleGlider(x_1,y)\",\"2*\\\\pi*\\\\pointPerp(q-\\\\center(x))*x_1\"],arcGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],polygonGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],chooseNonIncidentPoint:[\"(0/0,0/0)\"],circleCircleIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(y)),q-\\\\center(x))*\\\\pointPerp(q-\\\\center(y))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(x)),q-\\\\center(y))*\\\\pointPerp(q-\\\\center(x))\"],circleArcIntersection:[\"(0/0,0/0)\"],circleLineIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot((\\\\lineGlider(y,1)-\\\\lineGlider(y,0)),q-\\\\center(x))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(x)),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\pointPerp(q-\\\\center(x)))\"],arcCircleIntersection:[\"(0/0,0/0)\"],arcArcIntersection:[\"(0/0,0/0)\"],arcLineIntersection:[\"(0/0,0/0)\"],lineCircleIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(y)),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\pointPerp(q-\\\\center(y)))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot((\\\\lineGlider(x,1)-\\\\lineGlider(x,0)),q-\\\\center(y))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],lineArcIntersection:[\"(0/0,0/0)\"],lineLineIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(y,1)-\\\\lineGlider(y,0),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(x,1)-\\\\lineGlider(x,0),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],parallel:[\"\\\\parallel(x_1,(0,0))\",\"\\\\parallel(\\\\line((0,0),(0,0)),x_1)\"],perpendicular:[\"\\\\perpendicular(x_1,(0,0))\",\"\\\\perpendicular(\\\\line((0,0),(0,0)),x_1)\"],scaleTangentSegment:[\"\\\\scaleTangentSegment(x_1, y)\",\"\\\\scaleTangentSegment(x, x_1)\"],scaleTangentLine:[\"\\\\scaleTangentLine(x_1, y)\",\"\\\\scaleTangentLine(x, x_1)\"],scaleTangentRay:[\"\\\\scaleTangentRay(x_1, y)\",\"\\\\scaleTangentRay(x, x_1)\"],scaleTangentCircle:[\"\\\\scaleTangentCircle(x_1, y)\",\"\\\\scaleTangentCircle(x, x_1)\"],scaleTangentArc:[\"\\\\scaleTangentArc(x_1, y)\",\"\\\\scaleTangentArc(x, x_1)\"],scaleTangentDirectedAngleMarker:[\"\\\\scaleTangentDirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentDirectedAngleMarker(x, x_1)\"],scaleTangentUndirectedAngleMarker:[\"\\\\scaleTangentUndirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentUndirectedAngleMarker(x, x_1)\"],addTangentSegment:[\"\\\\addTangentSegment(x_1, y)\",\"\\\\addTangentSegment(x, x_1)\"],addTangentLine:[\"\\\\addTangentLine(x_1, y)\",\"\\\\addTangentLine(x, x_1)\"],addTangentRay:[\"\\\\addTangentRay(x_1, y)\",\"\\\\addTangentRay(x, x_1)\"],addTangentCircle:[\"\\\\addTangentCircle(x_1, y)\",\"\\\\addTangentCircle(x, x_1)\"],addTangentArc:[\"\\\\addTangentArc(x_1, y)\",\"\\\\addTangentArc(x, x_1)\"],addTangentDirectedAngleMarker:[\"\\\\addTangentDirectedAngleMarker(x_1, y)\",\"\\\\addTangentDirectedAngleMarker(x, x_1)\"],addTangentUndirectedAngleMarker:[\"\\\\addTangentUndirectedAngleMarker(x_1, y)\",\"\\\\addTangentUndirectedAngleMarker(x, x_1)\"],translation:[\"\\\\translation(x_1)\"],dilation:[\"\\\\dilation(x_1, y)\",\"\\\\dilation(x, x_1)\"],reflection:[\"\\\\reflection(x_1)\"],rotation:[\"\\\\rotation((0/0,0/0),0/0]\"],compose:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\",\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],inverse:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],transformPoint:[\"(0/0,0/0)\",\"(0/0,0/0)\"],transformSegment:[\"\\\\segment((0/0,0/0),(0/0,0/0))\",\"\\\\segment((0/0,0/0),(0/0,0/0))\"],transformVector:[\"\\\\vector((0/0,0/0),(0/0,0/0))\",\"\\\\vector((0/0,0/0),(0/0,0/0))\"],transformLine:[\"\\\\line((0/0,0/0),(0/0,0/0))\",\"\\\\line((0/0,0/0),(0/0,0/0))\"],transformRay:[\"\\\\ray((0/0,0/0),(0/0,0/0))\",\"\\\\ray((0/0,0/0),(0/0,0/0))\"],transformCircle:[\"\\\\circle((0/0,0/0),0/0)\",\"\\\\circle((0/0,0/0),0/0)\"],transformArc:[\"\\\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))\",\"\\\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))\"],transformPolygon:[\"\\\\polygon([])\",\"\\\\polygon([])\"],transformAngleMarker:[\"\\\\undirectedAngleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))\",\"\\\\undirectedangleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))\"],transformDirectedAngleMarker:[\"\\\\directedAngleMarker([0/0,0/0],0/0,0/0,0/0)\",\"\\\\directedangleMarker([0/0,0/0],0/0,0/0,0/0)\"],mean:[\"\\\\mean(x_1)\"],total:[\"\\\\total(x_1)\"],count:[\"0\"],var:[\"2*\\\\cov(x, x_1)\"],varp:[\"2*\\\\cov(x, x_1)*(\\\\count(x)-1)/\\\\count(x)\"],stdev:[\"\\\\cov(x, x_1)/q\"],stdevp:[\"\\\\covp(x, x_1)/q\"],mad:[\"\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))\"],min:[\"x_1[\\\\argmin(x)]\"],max:[\"x_1[\\\\argmax(x)]\"],median:[\"0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])\"],argmin:[\"0/0\"],argmax:[\"0/0\"],gcd:[\"0/0\"],lcm:[\"0/0\"],erf:[\"\\\\frac{2x_1}{\\\\sqrt{\\\\pi }}\\\\exp(-x^2)\"],invNorm:[\"\\\\frac{x_1}{\\\\pdf(\\\\normaldist(0,1),q)}\"],logbase:[\"\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)} \\\\}\",\"\\\\frac{-q*x_1}{y*\\\\ln(y)}\"],nthroot:[\"x^{1/y - 1}/y*x_1\",\"-\\\\frac{q*\\\\ln(x)*x_1}{y^2}\"],hypot:[\"x_1*x/q\",\"x_1*y/q\"],polyGamma:[\"0/0\",\"\\\\polyGamma(1 + x, y)*x_1\"],mod:[\"\\\\{ q=0: 0/0, x_1 \\\\}\",\"\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*x_1 \\\\}\"],cov:[\"\\\\cov(x_1, y)\",\"\\\\cov(x, x_1)\"],covp:[\"\\\\covp(x_1, y)\",\"\\\\covp(x, x_1)\"],corr:[\"(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))\",\"(\\\\cov(x, x_1) - (\\\\cov(x, y)*\\\\cov(y, x_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))\"],spearman:[\"0/0\",\"0/0\"],quantile:[\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) = y*(\\\\count(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\count(x)-1)) - y*(\\\\count(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\count(x)-1) - \\\\floor(y*(\\\\count(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}\",\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) < y*(\\\\count(x)-1) :   (\\\\count(x)-1)*(x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*x_1\\\\}\"],quartile:[\"0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])\",\"0/0\"],tscore:[\"\\\\frac{\\\\sqrt{\\\\count(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}\",\"-x_1*\\\\sqrt{\\\\count(x)}/\\\\stdev(x)\"],quartileIndex:[\"0/0\",\"0/0\"],upperQuartileIndex:[\"0/0\",\"0/0\"],lowerQuartileIndex:[\"0/0\",\"0/0\"],upperQuantileIndex:[\"0/0\",\"0/0\"],lowerQuantileIndex:[\"0/0\",\"0/0\"],nCr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*(\\\\polyGamma(0, 1 + x - y) - \\\\polyGamma(0, 1 + y))\"],nPr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*\\\\polyGamma(0, 1 + x - y)\"],arctan:[\"x_1*y/(y^2+x^2)\",\"-x_1*x/(y^2+x^2)\"],poissonpdf:[\"0/0\",\"x_1\\\\frac{\\\\exp(-y)(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{(\\\\floor(x))!}\"],invPoisson:[\"0/0\",\"0/0\"],tpdf:[\"x_1*q*\\\\frac{-(y+1)*x}{y+x^2}\",\"x_1*\\\\frac{1}{2}q*(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))\"],invT:[\"x_1/\\\\pdf(\\\\tdist(y),q)\",\"0/0\"],tcdf:[\"-x_1*\\\\pdf(\\\\tdist(z),x)\",\"x_1*\\\\pdf(\\\\tdist(z),y)\",\"0/0\"],poissoncdf:[\"0/0\",\"0/0\",\"x_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{\\\\exp(-z)(n-z)z^{(n-1)}}{n!}\"],normalpdf:[\"-x_1*\\\\frac{x-y}{z^2} q\",\"x_1*\\\\frac{x-y}{z^2} q\",\"x_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) q\"],binompdf:[\"0/0\",\"0/0\",\"\\\\{0<=z<=1: x_1*q*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z}), 0 \\\\}\"],invBinom:[\"0/0\",\"0/0\",\"0/0\"],uniformpdf:[\"0\",\"\\\\{y<=x: \\\\frac{x_1}{(z-y)^2}, 0\\\\}\",\"\\\\{z>=x: -\\\\frac{x_1}{(z-y)^2}, 0\\\\}\"],invUniform:[\"\\\\{y<=x<=z: x_1*(z-y), 0\\\\}\",\"\\\\{y<=x<=z: x_1*(1-x), 0\\\\}\",\"\\\\{y<=x<=z: x_1*x, 0\\\\}\"],normalcdf:[\"-x_1\\\\pdf(\\\\normaldist(z,u), x)\",\"x_1\\\\pdf(\\\\normaldist(z,u), y)\",\"-x_1*(\\\\pdf(\\\\normaldist(z,u), y) - \\\\pdf(\\\\normaldist(z,u), x))\",\"x_1*(  \\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normaldist(z,u),y)\\\\} -   \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normaldist(z,u),x)\\\\})\"],binomcdf:[\"0/0\",\"0/0\",\"0/0\",\"\\\\{0<=u<=1: x_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomialdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u})), 0 \\\\}\"],uniformcdf:[\"\\\\{z>u: 0/0, -x_1\\\\pdf(\\\\uniformdist(z,u), x)\\\\}\",\"\\\\{z>u: 0/0, x_1\\\\pdf(\\\\uniformdist(z,u), y)\\\\}\",\"\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:u-x,0\\\\} + \\\\{z<y<u:y-u,0\\\\}}{(u-z)^2})\\\\}\",\"\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:x-z,0\\\\} + \\\\{z<y<u:z-y,0\\\\}}{(u-z)^2})\\\\}\"],normalSample:[\"0/0\",\"0/0\",\"0/0\"],uniformSample:[\"0/0\",\"0/0\",\"0/0\"],tSample:[\"0/0\",\"0/0\"],poissonSample:[\"0/0\",\"0/0\"],binomSample:[\"0/0\",\"0/0\",\"0/0\"],rgb:[\"0/0\",\"0/0\",\"0/0\"],hsv:[\"0/0\",\"0/0\",\"0/0\"],polygon:[\"\\\\polygon(x_1)\"],area:[\"0/0\"],perimeter:[\"0/0\"],vertices:[\"\\\\vertices(x_1)\"],segments:[\"\\\\segments(x_1)\"],validateRangeLength:[\"0\",\"0\",\"0\",\"\\\\{q \\\\ge 1: x_1, 0\\\\}\"],validateSampleCount:[\"\\\\{x<0:0,1\\\\}*x_1\"],select:[\"\\\\select(x_1, y)\",\"0*q\"],shuffle:[\"0*y\",\"\\\\shuffle(x, x_1)\"],sortPerm:[\"0*x\"],elementsAt:[\"\\\\elementsAt(x_1, y)\",\"0*q\"],uniquePerm:[\"0*q\"]},Mv={};for(let e in Iv){let t=e,r=Iv[t],n=[];for(let i=0;i<r.length;i++){let s=r[i];n.push(zi(s,{}))}Mv[t]=n}function Ev(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}function vv(e,t,r){let n=e.argNames.indexOf(t);if(n===-1){let o=e.getInstruction(r);return o.type===1&&o.valueType===b&&isNaN(B(o.value))?Ws():Wi()}let i=_n(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),s=gL(i);return lo(s,r)}function gL(e){let{chunk:t,mask:r}=e;return{chunk:t,mask:r,orderCtx:e,domainTable:[]}}function lo(e,t){let{domainTable:r}=e,n=r[t];if(n!==void 0)return n;let i=hL(e,t);return r[t]=i,i}function hL(e,t){let{chunk:r,mask:n,orderCtx:i}=e,s=r.getInstruction(t);if(be(s)){if(s.type===1){if(s.valueType==b){if(isNaN(B(s.value)))return Ws()}else if(s.valueType===j){for(let o of s.value)if(isNaN(B(o)))return Jr()}}return Wi()}switch(s.type){case 31:return YT(lo(e,s.args[0]),lo(e,s.args[1]));case 32:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 47:case 48:case 15:case 17:case 16:case 18:case 37:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 49:{let o=Wi();for(let a of s.args)o=ln(o,lo(e,a));return o}case 38:{if(!n[t])return Wi();let o=lo(e,s.args[0]);if(o.type!==\"known\")return Jr();for(let a=1;a<s.args.length;a++){let u=lo(e,s.args[a]);if(u.type!==\"known\")return Jr();if(u.bounds[0]!==o.bounds[0]||u.bounds[1]!==o.bounds[1])return Jr()}return o}case 25:return n[t]?Jr():Wi();case 33:{let o=r.getInstruction(s.args[2]);return o.type!==1||o.valueType!==b||!isNaN(B(o.value))?Jr():ln(lo(e,s.args[0]),lo(e,s.args[1]))}case 26:case 27:case 28:case 29:{if(!n[t])return Wi();if(cr(i,t)>1)return Jr();let o=e.coefficientCtx;o===void 0&&(o=Vi(i),e.coefficientCtx=o);let a=o.newChunk,u=Mr(o,t),[l,c]=u;if(!Gt(a.getInstruction(l)))return Jr();let p=_t(a,l);if(isNaN(p))return Ws();let f=Wi();for(let d of s.args)f=ln(f,lo(e,d));if(c===void 0)return s.type===28||s.type===29?p>=0?f:Ws():p>0?f:Ws();{let d=_t(a,c);return ln(f,Xa(p,d))}}}}function Sv(e){let t=[],r=[];for(let n=0;n<e.argNames.length;n++){let i=[],s=[];for(let o=0;o<e.argNames.length;o++)i.push(e.argTypes[o]===b),s.push(n===o);r.push(s),t.push(i)}for(let n=e.argNames.length;n<=e.getReturnIndex();n++)r.push(bL(e,r,n)),t.push(xL(e,r,t,n));return t[e.getReturnIndex()]}function bL(e,t,r){let n=e.getInstruction(r),i=TL(e.argNames.length);if(be(n))return i;for(let s of n.args){let o=t[s];for(let a=0;a<o.length;a++)i[a]=i[a]||o[a]}return i}function xL(e,t,r,n){let i=e.getInstruction(n);if(be(i))return Ov(e.argNames.length);switch(i.type){case 8:case 9:case 14:case 38:{let a=Ov(e.argNames.length);for(let u=0;u<i.args.length;u++){let l=r[i.args[u]];for(let c=0;c<l.length;c++)a[c]=a[c]&&l[c]}return a}case 11:{let a=[],u=r[i.args[0]],l=t[i.args[1]];for(let c=0;c<u.length;c++)a.push(u[c]&&!l[c]);return a}case 10:{let a=r[i.args[0]].slice(),u=r[i.args[1]].slice(),l=t[i.args[0]],c=t[i.args[1]],p=0,f=0;for(let d=0;d<a.length;d++){let m=a[d]&&!c[d],y=u[d]&&!l[d];a[d]=m,u[d]=y,m&&(p+=1),y&&(f+=1)}return p>=f?a:u}case 33:{let a=t[i.args[0]],u=r[i.args[1]],l=r[i.args[2]];for(var s=[],n=0;n<a.length;n++)s.push(!a[n]&&u[n]&&l[n]);return s}case 39:case 40:case 41:{let a=r[i.args[0]],u=t[i.args[1]],l=[];for(var n=0;n<u.length;n++)l.push(a[n]&&!u[n]);return l}case 48:{let a=i.args[0],u=e.getInstruction(a),l=n-a;return r[u.args[l]]}case 15:case 17:case 16:case 18:case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 31:case 37:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:{let a=t[n],u=[];for(let l of a)u.push(!l);return u}default:let o=i;throw new Error(`Unexpected opcode ${o.type}`)}}function TL(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function Ov(e){let t=[];for(let r=0;r<e;r++)t.push(!0);return t}function Nv(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return e;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r),s=i.args[0],o=i.args[n],a=[],u=[];a.push(s);let l=cs(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\");u.push({min:1,max:l,length:l});let c=!1,p=!1;for(let T=s+1;T<=o;T++){let I=e.getInstruction(T);if(I.type===39||I.type===41||I.type===40){if(I.args[1]!==s)continue;let E=I.args[0];if(e.getInstruction(E).valueType!==j||!Gt(e.getInstruction(E)))continue;let v=_t(e,E),D=ML(v);if(!isFinite(D.min)||!isFinite(D.max))continue;a.push(T),u.push(D)}else Dv(I)?c=!0:(I.type===12||I.type===13)&&(p=!0)}if(a.length===0||!p&&!c)return e;let f=[],d=[];for(let T=0;T<e.argNames.length;T++)d.push(T),f.push(Wi());let m=[],y=[];for(let T=0;T<=o;T++)m.push(Ox(e,d,m,T)),y.push(Ox(e,a,y,T));for(let T=0;T<=o;T++){let I=e.getInstruction(T);if(I.type===33){let E=m[T];for(let v=0;v<E.length;v++)E[v]&&(f[v]=Jr())}else if(I.type===12||I.type===13){let E=!1,v=!1;for(let ge=0;ge<a.length;ge++)y[I.args[0]][ge]&&(E=!0),y[I.args[1]][ge]&&(v=!0);if(E||!v)continue;let D=m[I.args[0]],R=0,L;for(let ge=0;ge<D.length;ge++)D[ge]&&(L=ge,R+=1);if(R!==1||L===void 0)continue;let w=d[L],X=_n(e.copy().reopenFinalBlock(),w,{allowRestriction:!1,allowClosedBlockReferences:!1});if(cr(X,I.args[0])!==1)continue;let H=Vi(X),[Z,K]=Mr(H,I.args[0]);if(K===void 0)continue;let J=_t(H.newChunk,K),ce=_t(H.newChunk,Z);f[L]=ln(f[L],Xa(ce,J))}}if(c){let T=e.copy().reopenFinalBlock();for(let I=0;I<a.length;I++){let E=_n(T,a[I],{allowRestriction:!1,allowClosedBlockReferences:!1}),v=Vi(E);for(let D=s+1;D<=o;D++){let R=T.getInstruction(D);if(Dv(R)){let L=R.args[0];if(cr(E,L)!==1)continue;let w=Mr(v,L)[1];if(w===void 0)continue;let X=IL(v.newChunk,w),H,Z=0;for(let Ct=0;Ct<X.length;Ct++)X[Ct]&&(H=Ct,Z+=1);if(Z!==1||H===void 0)continue;let K=_n(v.newChunk,H,{allowRestriction:!1,allowClosedBlockReferences:!1});if(cr(K,w)!==1)continue;let J=Vi(K),[ce,ge]=Mr(J,w);if(ge===void 0||!Gt(J.newChunk.getInstruction(ce))||!Gt(J.newChunk.getInstruction(ge)))continue;let ie=_t(J.newChunk,ce),W=_t(J.newChunk,ge),_e=(u[I].max-u[I].min)/Math.min(u[I].length-1,31),et=Math.PI/_e;if(!isFinite(et)||et<=0)continue;f[H]=ln(f[H],Xa(ie,W)),f[H]=ln(f[H],Xa(et-ie,-W))}}}}let g=!1;for(let T of f){if(T.type!==\"known\")return e;(T.bounds[0]!==-1/0||T.bounds[1]!==1/0)&&(g=!0)}if(!g)return e;let h=e.copy(),P=e.getReturnIndex(),S=h.Constant(1),A=h.Constant(NaN);for(let T=0;T<h.argNames.length;T++)P=PL(h,f[T],P,T,S,A);return h.close(),h}function PL(e,t,r,n,i,s){if(t.type!==\"known\"||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return r;let o=e.And([e.LessEqual([e.Constant(t.bounds[0]),n]),e.LessEqual([n,e.Constant(t.bounds[1])])]);return e.Multiply([r,e.Piecewise([o,i,s])])}function IL(e,t){let r=[];for(let i=0;i<e.argNames.length;i++)r.push(i);let n=[];for(let i=0;i<=t;i++)n.push(Ox(e,r,n,i));return n[t]}function Dv(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function ML(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function Ox(e,t,r,n){let i=e.getInstruction(n),s=EL(t.length);for(let o=0;o<t.length;o++)if(t[o]===n)return s[o]=!0,s;if(be(i))return s;for(let o of i.args){let a=r[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function EL(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function Av(e){let t=e.getInstruction(e.getReturnIndex());if(be(t))return e.getReturnIndex();let r=kb(e,t),n=r.expectedTypes,i=Sx(e,t.args,[n]);if(r.isReducerWithNoListArgs){let s=vL(e,i.didCoerce?i.args:t.args),o=tn(r.expectedTypes.rest);if(ji(s,o)){i.didCoerce||e.popInstruction();let a=e.List(t.args);return e.copyInstructionWithArgs(t,[a])}}else i.didCoerce&&e.copyInstructionWithArgs(t,i.args);return e.getReturnIndex()}function Sx(e,t,r){let n=!1,i=[];for(let s=0;s<t.length;s++){let o=ld(r,s),a=t[s],u=e.getInstruction(a).valueType,l=a;o.every(c=>!ji(u,c))&&re(o[0],b)&&(l=Ga(e,a)),l!==a&&(n=!0),i.push(l)}return n?{didCoerce:n,args:i}:{didCoerce:!1}}function Ga(e,t){let r=e.getInstruction(t);return r.valueType===Oe?t:re(r.valueType,Ie)?Cv(e,t):re(r.valueType,ye)?Rv(e,t):t}function vL(e,t){let r=e.getInstruction(t[0]).valueType;if(!ui(r))return wt;for(let n of t)if(e.getInstruction(n).valueType!==r)return wt;return tn(r)}function qi(e){var t=e;if(t&&typeof t.toJSON==\"function\"&&(t=t.toJSON()),!t||typeof t!=\"object\")return t;if(Array.isArray(t))return t.map(qi);var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=qi(t[n]));return r}function Lv(e,t){let r=[],n=[],i=[];for(let o=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])||(r.push(e.argNames[o]),n.push(e.argTypes[o]));let s=new Bi({argNames:r,argTypes:n});for(let o=0,a=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])?i[o]=s.ConstantOfType(e.argTypes[o],t[e.argNames[o]]):(i[o]=a,a+=1);for(let o=e.argNames.length;o<e.instructionsLength();o++){let a=e.getInstruction(o);if(be(a))i.push(Fi(s,a));else{let u=[];for(let l of a.args)u.push(i[l]);i.push(or(s,a,u))}}return s}function _v(e,t){let r=new Bi({argNames:e.argNames,argTypes:e.argTypes}),n=r.ConstantOfType(me,!0),i=DL(e);AL(e,i,t);let s={chunk:e,newChunk:r,peelable:i,oldIPtoNewIP:[],oldIPToRestriction:[],startTrue:n};Fv(s,0,e.instructionsLength()-1);let o=s.oldIPToRestriction[e.getReturnIndex()];return{chunk:s.newChunk,returnIndex:s.oldIPtoNewIP[e.getReturnIndex()],restrictionIndex:n===o?void 0:o}}function Fv(e,t,r){let{chunk:n,newChunk:i,peelable:s,oldIPtoNewIP:o,oldIPToRestriction:a}=e;for(let u=t;u<=r;u++){let l=n.getInstruction(u);if(l.type===19)u=SL(e,u);else if(l.type===2)o[u]=u,a[u]=e.startTrue;else if(be(l))o[u]=i.copyInstruction(l),a[u]=e.startTrue;else if(s[u]&&gc(n,l)){o[u]=o[l.args[1]];let c=RL(e,l);a[u]=Dx(e,l.args.map(p=>a[p]).concat(c))}else o[u]=i.copyInstructionWithArgs(l,l.args.map(c=>o[c])),a[u]=Dx(e,l.args.map(c=>a[c]))}}function Dx(e,t){let n=[...new Set(t)].filter(i=>!OL(e.newChunk,i));return n.length?n.reduce((i,s)=>e.newChunk.And([i,s])):e.startTrue}function OL(e,t){let r=e.getInstruction(t);return r.type===1&&r.valueType===me&&r.value}function SL(e,t){let{chunk:r,newChunk:n,oldIPtoNewIP:i,oldIPToRestriction:s,startTrue:o}=e,a=r.getInstruction(t),u=a.endIndex,l=r.getInstruction(u),c,p;if(a.type===23)i[t]=n.copyInstructionWithArgs(a,[i[a.args[0]]]),s[t]=o,p=t+1,c=o;else{let m=a.args.map(y=>i[y]);m.push(n.ConstantOfType(me,!0)),i[t]=n.copyInstructionWithArgs(a,m),s[t]=o;for(let y=2;y<a.args.length;y++){let g=t+y-1;i[g]=n.copyInstructionWithArgs(r.getInstruction(g),[i[t]]),s[g]=o}c=n.BlockVar(me,[i[t]]),p=t+a.args.length-1}Fv(e,p,u-1);let f=l.args.map(m=>i[m]),d=c;a.type!==23&&(d=Dx(e,[c,s[l.args[1]]]),f.push(d)),i[u]=n.copyInstructionWithArgs(l,f),s[u]=o;for(let m=1;m<l.args.length;m++)i[u+m]=n.copyInstructionWithArgs(r.getInstruction(u+m),[i[u]]);if(a.type!==23){let m=n.BlockVar(me,[i[u]]);c===d&&(m=o);for(let y=1;y<l.args.length;y++)s[u+y]=m}return u+l.args.length-1}function DL(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);t[e.getReturnIndex()]=!0;let r=e.instructionsLength()-1;for(let n=r;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(!be(i))for(let s of NL(e,i))t[s]=!0}return t}function NL(e,t){switch(t.type){case 14:case 8:case 9:case 26:case 28:case 27:case 29:case 10:case 11:case 12:case 13:case 25:case 32:case 15:case 16:case 38:case 47:case 19:return t.args;case 33:return gc(e,t)?Vv(e,t).concat([t.args[1]]):[];case 37:return lr[t.symbol].noPeel?[]:t.args;case 20:return t.args.slice(1);case 31:return[];case 17:case 18:case 39:case 40:case 41:case 23:case 24:case 48:case 42:case 21:case 22:case 44:case 49:return[];default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function AL(e,t,r){let n=[];for(let i=0;i<e.argNames.length;i++){let s=e.argNames[i];r.indexOf(s)<0&&n.push(i)}for(let i of n){let s=Lo(e,i);for(let o=0;o<e.instructionsLength();o++)t[i]&&(t[i]=!s[o])}}function gc(e,t){if(t.type!==33)return!1;let r=e.getInstruction(t.args[2]);return r.type===1&&r.valueType===b&&isNaN(B(r.value))||gc(e,r)&&wv(e,t.args[1])&&wv(e,r.args[1])}function RL(e,t){return Vv(e.chunk,t).map(n=>e.oldIPtoNewIP[n]).reduce((n,i)=>e.newChunk.Or([n,i]))}function Vv(e,t){let r=[];for(;t.type===33;)r.push(t.args[0]),t=e.getInstruction(t.args[2]);return r}function wv(e,t){let r=e.getInstruction(t);return r.type===1&&r.valueType===b&&B(r.value)===1}var Bi=class{constructor(t){this.derivativeMaps={};if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error(\"Programming Error: length of argNames must match length of argTypes\");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let r=0;r<this.argTypes.length;r++){let n=this.argTypes[r];this.LoadArg(n)}this.returnIndex=this.Constant(NaN)}setError(t){this.error=t}getError(){return this.error}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let r in t){let n=this.comments[r]||\"\";this.comments[r]=n+t[r]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.truncate(this.instructions.length-1)}truncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length);for(let r in this.derivativeMaps)+r>=t?delete this.derivativeMaps[r]:Ev(this.derivativeMaps[r],t);this.setReturnIndex(this.instructions.length-1)}pushInstructionChecked(t){if(this.instructions.length>=32768)throw Cy();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(pM(this)),this.setReturnIndex(yM(this)),this.setReturnIndex(Av(this)),X0(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(q0(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let r of t.args)if(this.blockMask[r])throw new Error(\"Programming Error: cannot reference an instruction in a closed block\")}markClosedBlock(t,r){for(let n=t;n<r;n++)this.blockMask[n]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,r){return this.pushInstruction({type:47,valueType:t,args:r})}SymbolicVar(t,r){return this.pushLeafInstruction({type:3,valueType:t,symbol:r})}BroadcastResult(t,r){let n=r[0],i=this.instructions[n],s=i.args[0],o=this.instructions.length-n,a=i.args[o],u=!td(this,a,s),c=this.getInstruction(s).args[0],p=this.getInstruction(c);return this.pushInstruction({type:48,valueType:t,args:r,isConstantBroadcast:u,constantLength:Gt(p)?_t(this,c):void 0})}Constant(t){return this.ConstantOfType(b,t)}ConstantOfType(t,r){if(typeof r==\"number\"&&(r=Me(r,1)),q(t)&&r.length>1e4)throw Pl();return this.pushLeafInstruction({type:1,valueType:t,value:r})}NanOfType(t){if(t===je){let r=this.Constant(NaN);return this.Distribution(\"uniformdist\",[r,r])}else return this.ConstantOfType(t,gi(t))}Add(t){let r=8,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Subtract(t){let r=9,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Multiply(t){let r=10,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Divide(t){let r=11,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Exponent(t){let r=12,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}RawExponent(t){let r=13,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Negative(t){let r=14,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Equal(t){let r=25,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Less(t){let r=26,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Greater(t){let r=27,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}LessEqual(t){let r=28,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}GreaterEqual(t){let r=29,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Or(t){let r=31,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}And(t){let r=32,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Piecewise(t){let r=33,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPair(t){let r=15,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPairAccess(t){let r=17,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTriple(t){let r=16,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTripleAccess(t){let r=18,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}List(t){let r=38,n=Ft(this,r,t);if(t.length>1e4)throw Pl();return this.pushInstruction({type:r,valueType:n,args:t})}ListAccess(t){let r=39,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}DeferredListAccess(t){let r=40,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}InboundsListAccess(t){let r=41,n=Ft(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}NativeFunction(t,r,n){let i=37,s=lr[t].returnType,o=typeof s==\"function\"?s(n.map(a=>this.getInstruction(a).valueType)):s;return this.pushInstruction({type:i,valueType:o,args:n,symbol:t,callData:r})}SyntheticNativeFunction(t,r){let n=37,i=lr[t].returnType,s=typeof i==\"function\"?i(r.map(a=>this.getInstruction(a).valueType)):i,o={errorSymbol:t,providedArity:r.length,isDotCall:!1};return this.pushInstruction({type:n,valueType:s,args:r,symbol:t,callData:o})}Distribution(t,r){let n=42,i=je;return this.pushInstruction({type:n,valueType:i,args:r,symbol:t})}BeginIntegral(t,r){let n=21,i=Ft(this,n,[]);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndIntegral(t){let r=22,n=Ft(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}BeginBroadcast(t,r){let n=23,i=Ft(this,n,[]),s=this.getInstruction(t[0]);if(Gt(s)&&_t(this,t[0])>1e4)throw Pl();return this.pushInstruction({type:n,valueType:i,endIndex:-1,args:t,listComprehensionCallData:r})}EndBroadcast(t){let r=24,n=Ft(this,r,t),i=t[0],s=this.getInstruction(i),o={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};this.instructions[i]=o;let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}BeginLoop(t,r){let n=19,i=Ft(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndLoop(t){let r=20,n=Ft(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}ExtendSeed(t,r){let n=44,i=He;return this.pushInstruction({type:n,valueType:i,args:r,tag:t})}Noop(){let t=0,r=st;return this.pushLeafInstruction({type:t,valueType:r})}Action(t,r){return this.pushInstruction({type:49,valueType:Be,args:r,symbols:t})}replaceInstructionWithConstant(t,r){this.instructions[t]=r,this.blockMask[t]=void 0}replaceInstructionWithBlockVar(t,r){this.instructions[t]=r}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let r=t.args[0],i=this.getInstruction(r).args[0];for(let s=i;s<r;s++)this.blockMask[s]=void 0;return this.truncate(r),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new Bi({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=qi(this.derivativeMaps),t.setReturnIndex(this.getReturnIndex()),t}close(){return this.setReturnIndex(Vr(this,this.getReturnIndex())),cM(this),this}copyInstruction(t){return Fi(this,t)}copyInstructionWithArgs(t,r){return or(this,t,r)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:st}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return Gt(this.instructions[this.getReturnIndex()])}asValue(){return _t(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return sr(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),r=Qr(t,t.getReturnIndex());return sn(t,r)}elementAt(t){let r=this.copy(),n=r.getReturnIndex();return r.setReturnIndex(rc(r,n,t)),r.close(),r}substituteConstantArguments(t){return Lv(this,t)}interpretWithParameters(t){return w0(this,this.getReturnIndex(),t)}getCompiledFunction(t){let r;if(t){r=t.slice();for(let s of this.argNames)r.indexOf(s)===-1&&r.push(s)}else r=this.argNames;let{source:n,constants:i}=nM(this);return{args:r,source:n,constants:i,fn:Ob(r,n,i)}}getRestrictedFunctionForGLSL(t){let r=_v(this,t),n;if(r.restrictionIndex!==void 0)try{let i=r.chunk.copy();i.setReturnIndex(r.restrictionIndex),i.close(),n=gd(i)}catch(i){}if(n===void 0)return{concrete:new Zt(this),restriction:void 0};{let i=r.chunk;return i.setReturnIndex(r.returnIndex),i.close(),{concrete:new Zt(i),restriction:n}}}polynomialOrder(t,r){return dM(this,t,r)}getPolynomialCoefficients(t){return mM(this,t)}takeDerivative(t){let r=this.argNames.indexOf(t);return r===-1?this.Constant(0):this.setReturnIndex(_u(this,this.getReturnIndex(),r)),this}gradient(t){let r=[],n=this.getReturnIndex();for(let i of t){let s=this.argNames.indexOf(i);s===-1?r.push(this.Constant(0)):r.push(_u(this,n,s))}return this.List(r),this}deriveRegressionRestrictions(){return Nv(this)}boundDomain(t){return vv(this,t,this.getReturnIndex())}findLinearSubset(t){let r=Sv(this),n=[];for(let i of t){let s=this.argNames.indexOf(i);if(s===-1)throw new Error(\"Programming Error: findLinearSubset called with a non-dependency\");n.push(r[s])}return n}print(){return N0(this)}printInstruction(t){return La(this,t)}toDot(){return fM(this)}getLiveArgNames(){let t=[];for(let r=0;r<this.argNames.length;r++)this.instructions[r].type===2&&t.push(this.argNames[r]);return t}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}};var Bs={normaldist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalcdf\",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){return Bs.normaldist.mean(e,t,r)},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"abs\",[n.args[1]])},var:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[1],n.args[1]])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.Add([e.Multiply([e.SyntheticNativeFunction(\"invNorm\",r),e.SyntheticNativeFunction(\"abs\",[n.args[1]])]),n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalSample\",[r[0],n.args[0],n.args[1]])}},tdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tcdf\",r.concat(n.args))},mean:function(e,t,r){return e.Constant(0)},median:function(e,t,r){return e.Constant(0)},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[Bs.tdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Constant(2),s=n.args[0];return e.Piecewise([e.GreaterEqual([s,i]),e.Divide([s,e.Subtract([s,i])]),e.Constant(NaN)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invT\",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tSample\",[r[0],n.args[0]])}},poissondist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissonpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissoncdf\",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invPoisson\",[e.Constant(.5),n.args[0]])},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"sqrt\",[n.args[0]])},var:function(e,t,r){return Bs.poissondist.mean(e,t,r)},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invPoisson\",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissonSample\",[r[0],n.args[0]])}},binomialdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binompdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binomcdf\",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[0],n.args[1]])},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invBinom\",[e.Constant(.5),n.args[0],n.args[1]])},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[Bs.binomialdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),[i,s]=n.args;return e.Multiply([i,e.Multiply([s,e.Subtract([e.Constant(1),s])])])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invBinom\",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binomSample\",[r[0],n.args[0],n.args[1]])}},uniformdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformcdf\",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Divide([e.Add([n.args[0],n.args[1]]),e.Constant(2)])},median:function(e,t,r){return Bs.uniformdist.mean(e,t,r)},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[Bs.uniformdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Subtract([n.args[1],n.args[0]]);return e.Divide([e.Multiply([i,i]),e.Constant(12)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invUniform\",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformSample\",[r[0],n.args[0],n.args[1]])}}};function Bv(e,t,r){let n=r[0],i=e.Constant(0),s=e.Constant(1);if(sr(e,t)===0)return e.Constant(NaN);let a=Qr(e,t);return e.InboundsListAccess([t,e.Add([e.SyntheticNativeFunction(\"floor\",[e.Multiply([e.SyntheticNativeFunction(\"uniformSample\",[n,i,s]),a])]),s])])}function wd(e,t,r){if(t===r)return!0;if(t<r)return!1;let n=[!0];for(let s=r+1;s<=t;s++)n.push(!1);let i=[t];for(;i.length;){let s=i.pop();if(n[s-r])continue;n[s-r]=!0;let o=e.getInstruction(s);if(!be(o))for(let a of o.args){if(a===r)return!0;a<r||n[a-r]||i.push(a)}}return!1}var co;function Gv(e){co=e}function zv(){co&&(co.cacheHits+=1)}function qv(){co&&(co.cacheMisses+=1)}function Uv(){co&&(co.cacheWrites+=1)}function Hv(){co&&(co.cacheReads+=1)}function Yv(e,t,r,n,i){let s=re(r,ue)||re(r,ee),o=re(i,ue)||re(i,ee);if(!s&&!o)return;let a=$v(e,t,r),u=$v(e,n,i),l=a.filter(c=>u.some(p=>Nx(c,p))&&!!e.lookup(c[0]));for(let c of a)kv(e,c,n)&&l.every(p=>!Nx(c,p))&&l.push(c);for(let c of u)kv(e,c,t)&&l.every(p=>!Nx(c,p))&&l.push(c);if(l.length===1)return l[0]}function Nx(e,t){return e[0]===t[0]&&e[1]===t[1]}function kv(e,[t,r],n){let i=e.lookup(t),s=i&&e.getGeometryTree(i);return((s==null?void 0:s.symbol)===\"glider\"||(s==null?void 0:s.symbol)===\"intersection\"||(s==null?void 0:s.symbol)===\"strictintersection\"||(s==null?void 0:s.symbol)===\"midpoint\")&&(s==null?void 0:s.parents.some(o=>o&&e.resolvesTo(o[0],n)&&(r===void 0||o[1]===void 0||o[1]===r)))}function $v(e,t,r){var s;let n=[],i=((s=e.getGeometryTree(t))==null?void 0:s.parents)||[];for(let o=0;o<i.length;o++){let a=i[o];if(re(r,ue)&&o===0||!a)continue;let u=e.lookup(a[0]);u&&e.isPointOrListOfPoints(u)&&n.push(a)}return n}function Ax(e,t,r){if(!t)return;let n=Xv(t,r._expression);n===\"start-to-end\"?e.setCursorContext({type:r.type===\"Assignment\"?\"assignment-rhs\":\"function-definition-body\",allowedTypes:[st]}):n===\"empty-list\"&&e.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:[st]})}function Fu(e,t,r,n,i){let s=CL(e,t,r,n,i);s&&e.setCursorContext(s)}function Xv(e,t){let r=t.getInputSpan();return r?e.start===r.start&&e.end===r.end?\"start-to-end\":e.start===e.end&&e.start===r.end?\"end\":e.start===e.end&&e.start===r.start?\"start\":e.start===e.end&&t.type===\"List\"&&t.args.length===0?\"empty-list\":\"not-aligned\":\"not-aligned\"}function Rx(e,t){if(!e)return;let r=!1;t instanceof di&&t.args[1]instanceof Ir&&(r=!0,t=t.args[1]);let n=t.args;if(n){if(n.length===0){let i=t.getInputSpan();if(!i)return;let s=Dr(i),o=-1;return t.type===\"List\"?o=s.indexOf(\"[\"):(t.type===\"FunctionCall\"||t.type===\"SeededFunctionCall\")&&(o=s.indexOf(\"(\")),o<0?void 0:e.start===i.start+o+1?{argIndex:0,positionWithinArg:\"start-to-end\",isDotCall:r}:void 0}for(let i=0;i<n.length;i++){let s=n[i],o=s.getInputSpan();if((o==null?void 0:o.input)!==e.input)continue;if(e.start<o.start)break;let a=Xv(e,s);if(a!==\"not-aligned\")return{argIndex:i,positionWithinArg:a,isDotCall:r}}}}function CL(e,t,r,n,i){if(!r||!n.args)return;let s=Rx(r,n);if(s===void 0)return;s.isDotCall&&(n=n.args[1]);let o=s.positionWithinArg===\"end\"?s.argIndex+1:s.argIndex;s.isDotCall&&(o+=1);let a;s.positionWithinArg===\"empty-list\"||s.positionWithinArg===\"start-to-end\"?a=[...i.slice(0,o),void 0,...i.slice(o+1)]:n instanceof ns?a=o===1?[i[0],void 0,i[1]]:[i[0],i[1],void 0]:a=[...i.slice(0,o),void 0,...i.slice(o)],a=a.map(c=>{if(!(c===void 0||e.getInstruction(c).type===2))return c});let u=$b(e,t,n,a),l=u&&ld(u,o);if(s.positionWithinArg===\"empty-list\"){let c=l==null?void 0:l.filter(q).map(Fe);return(c==null?void 0:c.length)===0?void 0:{type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:c!=null?c:[st]}}else{if((l==null?void 0:l.length)===0)return;let c=!1;if(u){let d=0;for(let m of u){let y=Array.isArray(m)?m.length-1:1/0;d=Math.max(d,y)}c=s.positionWithinArg===\"end\"&&s.argIndex===d-1||s.positionWithinArg===\"start-to-end\"&&s.argIndex===d}let p=n.args.length;if(n instanceof ns&&n.args.length===3){let d=n.args[2];d instanceof rr&&d.isNaN()&&(p=2)}let f={type:\"expression-arguments\",expressionType:n.type,argIndex:s.argIndex,argCount:p,isLastValidArg:c,positionWithinArg:s.positionWithinArg,allowedTypesForInsertedArg:l!=null?l:[st]};if(n instanceof Ir&&(f.functionSymbol=n._symbol,f.isDotCall=s.isDotCall,n instanceof Ir&&n._symbol===\"polygon\")){let d=n.args.filter(m=>!(m instanceof rt&&m._symbol===\"cursor\"));if(d.length>0){let m=d[0].getInputSpan(),y=d[d.length-1].getInputSpan();f.polygonVertices=m&&y?{firstLatex:Dr(m),lastLatex:Dr(y)}:void 0}}return f}}function Wv(e){return e.type===\"FunctionDefinition\"}function _d(e){return e.type===\"Identifier\"}function Ui(e){return e.type===\"Table\"}function Fd(e){return e.type===\"Image\"}function ms(e){return e.type===\"Error\"}function Vu(e){return e.type===\"Regression\"}function LL(e){let t=Vl({},{},-1);for(let r=0;r<e.argNames.length;r++)Jn(t,e.argNames[r],r);return t}function Bn(e,t,r,n,i,s,o){return{policy:e,frame:t,chunk:r,scope:n,parentNode:i,substitutionContext:s,selection:o}}function Fx(e){let{policy:t,frame:r,argNames:n,argTypes:i,selection:s}=e,o=new Bi({argNames:n,argTypes:i}),a=LL(o);return Bn(t,r,o,a,void 0,{},s)}function Gu(e,t){let{policy:r,frame:n,argNames:i,argTypes:s,selection:o}=e,a=Mx(n,t),{freeDependencies:u,updateSymbols:l}=a;if(i||(i=u),!s){s=[];for(let p=0;p<i.length;p++)s.push(b)}let c=Fx({policy:r,frame:n,argNames:i,argTypes:s,selection:o});try{Se(c,t),e.coerceToNumber&&Ga(c.chunk,c.chunk.getReturnIndex()),e.wrapInList&&!q(c.chunk.getReturnType())&&c.chunk.List([c.chunk.getReturnIndex()]),c.chunk.close(),_L(c,t,a),wL(c,t,l)}catch(p){let f=p instanceof O?p:ae(p);f.setCursorContext(c.chunk.getCursorContext()),c.chunk.setError(f)}return c.chunk}function wL(e,t,r){if(t.type===\"FunctionDefinition\")for(let i of r){if(t._argSymbols.indexOf(i)!==-1||t._symbol===i)throw Cp(i);if(t._sybmol===i)throw Rp(i)}let n=[];for(let i of r)e.frame[i]||n.push(i);if(n.length){let i=r1(e,n[0]).setDependencies(e.chunk.argNames.concat(n));throw e.chunk.isConstant()&&e.chunk.getReturnType()===Be&&i.setActionValue(e.chunk.asValue()),i}}function _L(e,t,{substitutionSymbols:r,substitutionBodyDependencies:n}){if(t.type===\"FunctionDefinition\"){for(let s of r){if(t._argSymbols.indexOf(s)!==-1||t._symbol===s)throw sf(s);if(t._sybmol===s)throw af(s)}for(let s of n)if(t._argSymbols.indexOf(s)!==-1||t._symbol===s)throw vh(s)}let i=[];for(let s of r)e.frame[s]||i.push(s);if(i.length){let s=i[0];if(e.policy.substitutionForbidden(s))throw of(s)}}function Se(e,t){let r;if(Hv(),BL(e,t))zv(),r=e.chunk.copyInstruction(t.__IRCache.instruction);else{qv();let n=e.chunk.instructionsLength(),{policy:i,frame:s,chunk:o,scope:a,parentNode:u,substitutionContext:l,selection:c}=e,p=Bn(i,s,o,a,t,l,c);if(r=GL(p,t),!Qv(t,u)){let f=o.getInstruction(r);f.type===48&&f.isConstantBroadcast&&(r=Vr(o,r))}r=FL(e,n,r),VL(e,t,r)}return e.chunk.setReturnIndex(r),r}function FL(e,t,r){let{chunk:n,scope:i}=e;if(r<=t)return r;let s=n.getInstruction(r);return Gt(s)?(n.truncate(Math.max(t,i.maxIndex+1)),Fi(n,s)):r}function Qv(e,t){if(!t||!e.getScope||!t.getScope)return!1;let r=t.getScope().dependencies,n=e.getScope().dependencies;if(n.length===r.length)return!0;let i=0;for(let o of n)we[o]||(i+=1);let s=0;for(let o of r)we[o]||(s+=1);return i===s}function VL(e,t,r){let{frame:n,chunk:i,parentNode:s}=e,o=i.getInstruction(r);if(!Gt(o)||Qv(t,s))return;let a=Pv(n,t);a&&(Uv(),t.__IRCache={keys:a,instruction:o})}function BL(e,t){let{frame:r,substitutionContext:n}=e;if(!t.__IRCache)return!1;let i=t.__IRCache.keys;for(let[s,o]of i){let a=r[s];if(a!==o||a&&a.type===\"RegressionParameter\"&&n.body)return!1}return!0}function GL(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,l=t.type;switch(l){case\"Constant\":{let d=t._constantValue,m=typeof d==\"boolean\"?me:b;return i.ConstantOfType(m,d)}case\"RegressionParameter\":return i.Constant(t._constantNode._constantValue);case\"MixedNumber\":return i.Constant(t._constantValue);case\"Negative\":return i.Negative(Cx(e,t,t.args));case\"Add\":return i.Add(yn(e,t,t.args));case\"Subtract\":return i.Subtract(yn(e,t,t.args));case\"Multiply\":{let d=yn(e,t,t.args);if(e.policy.is3dProduct()){let m=i.getInstruction(d[0]).valueType,y=i.getInstruction(d[1]).valueType;if(re(m,z)&&re(y,z))throw ml([ne(m),ne(y)]);if(re(m,N)&&re(y,N))throw dl([ne(m),ne(y)])}return i.Multiply(d)}case\"DotMultiply\":{let[d,m]=yn(e,t,t.args);if(e.policy.is3dProduct()&&U(i,d,N)&&U(i,m,N)){let y=i.Constant(1),g=i.Constant(2);return i.Add([i.Multiply([i.OrderedPairAccess([d,y]),i.OrderedPairAccess([m,y])]),i.Multiply([i.OrderedPairAccess([d,g]),i.OrderedPairAccess([m,g])])])}else if(e.policy.is3dProduct()&&U(i,d,z)&&U(i,m,z)){let y=i.Constant(1),g=i.Constant(2),h=i.Constant(3);return i.Add([i.Add([i.Multiply([i.OrderedTripleAccess([d,y]),i.OrderedTripleAccess([m,y])]),i.Multiply([i.OrderedTripleAccess([d,g]),i.OrderedTripleAccess([m,g])])]),i.Multiply([i.OrderedTripleAccess([d,h]),i.OrderedTripleAccess([m,h])])])}else if(U(i,d,pe)&&U(i,m,pe)){let y=i.Constant(1),g=i.Constant(2),h=i.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[d]),P=i.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[m]);return i.Add([i.Multiply([i.OrderedPairAccess([h,y]),i.OrderedPairAccess([P,y])]),i.Multiply([i.OrderedPairAccess([h,g]),i.OrderedPairAccess([P,g])])])}else return i.Multiply([d,m])}case\"CrossMultiply\":{let[d,m]=yn(e,t,t.args);if(e.policy.is3dProduct()&&U(i,d,z)&&U(i,m,z)){let[y,g]=yn(e,t,t.args),h=i.Constant(1),P=i.Constant(2),S=i.Constant(3),A=i.OrderedTripleAccess([y,h]),T=i.OrderedTripleAccess([y,P]),I=i.OrderedTripleAccess([y,S]),E=i.OrderedTripleAccess([g,h]),v=i.OrderedTripleAccess([g,P]),D=i.OrderedTripleAccess([g,S]);return i.OrderedTriple([i.Subtract([i.Multiply([T,D]),i.Multiply([I,v])]),i.Subtract([i.Multiply([I,E]),i.Multiply([A,D])]),i.Subtract([i.Multiply([A,v]),i.Multiply([T,E])])])}else if(e.policy.is3dProduct()&&(U(i,d,N)&&U(i,m,N)||U(i,d,b)&&U(i,m,z)||U(i,d,z)&&U(i,m,b))){let y=i.getInstruction(d).valueType,g=i.getInstruction(m).valueType;throw fl([ne(y),ne(g)])}else return i.Multiply([d,m])}case\"Divide\":return i.Divide(yn(e,t,t.args));case\"Exponent\":return i.Exponent(yn(e,t,t.args));case\"Comparator['=']\":return i.Equal(yn(e,t,t.args));case\"Comparator['>']\":return i.Greater(yn(e,t,t.args));case\"Comparator['<']\":return i.Less(yn(e,t,t.args));case\"Comparator['>=']\":return i.GreaterEqual(yn(e,t,t.args));case\"Comparator['<=']\":return i.LessEqual(yn(e,t,t.args));case\"And\":return i.And(yn(e,t,t.args));case\"PercentOf\":return i.Divide([i.Multiply(yn(e,t,t.args)),i.Constant(100)]);case\"ParenSeq\":return HL(e,t);case\"BareSeq\":return kL(e,t);case\"NamedCoordinateAccess\":{let[d]=Cx(e,t,t.args),m=t.symbol,y=U(i,d,z),g;switch(m){case\"x\":g=i.Constant(1);break;case\"y\":g=i.Constant(2);break;case\"z\":{if(!y)throw rn(\".\");g=i.Constant(3);break}default:{let h=m;throw new Error(`Programming Error: unexpected named coordinate: '${h}'.`)}}return y?i.OrderedTripleAccess([d,g]):i.OrderedPairAccess([d,g])}case\"Norm\":{let d=Cx(e,t,t.args)[0];if(U(i,d,z))return i.SyntheticNativeFunction(\"hypot\",[i.OrderedTripleAccess([d,i.Constant(1)]),i.SyntheticNativeFunction(\"hypot\",[i.OrderedTripleAccess([d,i.Constant(2)]),i.OrderedTripleAccess([d,i.Constant(3)])])]);if(U(i,d,N))return i.SyntheticNativeFunction(\"hypot\",[i.OrderedPairAccess([d,i.Constant(1)]),i.OrderedPairAccess([d,i.Constant(2)])]);if(U(i,d,pe)){let m=i.Constant(0),y=i.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[d]),g=i.OrderedPair([m,m]);return i.SyntheticNativeFunction(\"distance\",[g,y])}else return i.SyntheticNativeFunction(\"abs\",[d])}case\"UpdateRule\":{let d=t._symbol;var c=n[d];if(c!==void 0){if(c!==jt&&c.isError)throw c;if(c===jt||c.type!==\"Assignment\"&&c.type!==\"Slider\")throw r1(e,d)}let m=Se(Bn(r,n,i,s,o,a,u),t.args[1]);return i.Action([d],[m])}case\"List\":{let d;if(t.getDependencies().length>0)dn(t.args),d=i.List(Bu(e,t,t.args));else if(t.args.length===0)Fu(i,r,u,t,[]),d=i.ConstantOfType(Oe,[]);else{let m=i.instructionsLength(),y=[],g,h;dn(t.args);for(let S of t.args){let A=Se(e,S),T=i.getInstruction(A);if(g===void 0){if(g=T.valueType,!ui(g))throw da([ne(g)]);h=tn(g)}else if(T.valueType!==g)throw bl();if(T.type!==1)throw new Error(\"Programming error: expected list with no dependencies to constant collapse.\");y.push(T.value),i.truncate(m)}let P=Rx(e.selection,t);if(e.selection&&P!==void 0&&h!==void 0&&P.positionWithinArg!==\"empty-list\"){let S=Fe(h);i.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:P.argIndex,argCount:t.args.length,isLastValidArg:!1,positionWithinArg:P.positionWithinArg,allowedTypesForInsertedArg:[S]})}d=i.ConstantOfType(h,y)}return d}case\"ListAccess\":{let d=Se(e,t.args[0]),m=i.getInstruction(d);if(t.args[1].type===\"Range\"&&t.args[1].args[1].length===0){if(!q(m.valueType))throw yl([ne(m.valueType),ne(b)]);let y=Qr(i,d),g=wx(e,Se(e,t.args[1].args[0]),i.List([y]),{stepMustBePositive:!0});return i.ListAccess([d,g])}else{let y=Se(e,t.args[1]),g=i.getInstruction(y);return Ro(i,r,t,[d,y]),g.valueType===Nr?i.SyntheticNativeFunction(\"select\",[d,y]):i.ListAccess([d,y])}}case\"Range\":{let[d,m]=yn(e,t,t.args);return wx(e,d,m,{stepMustBePositive:!1})}case\"ListComprehension\":return $L(e,t);case\"Piecewise\":{let d=zL(e,t,t.args),m=i.getInstruction(d[0]),y=i.getInstruction(d[1]),g=i.getInstruction(d[2]),h=ji(y.valueType,g.valueType)||ji(g.valueType,y.valueType);if(m.type===1&&m.valueType===me&&h){let P=d[m.value?1:2],S=i.getInstruction(P),A=y.valueType!==Oe?y.valueType:g.valueType;return S.valueType===Oe&&A!==Oe?i.ConstantOfType(A,[]):P}if(!h&&Gt(g)&&g.valueType===b&&jn(g.value)&&UP(y.valueType)){let P=i.NanOfType(y.valueType);d=[d[0],d[1],P]}return i.Piecewise(d)}case\"Ans\":case\"Identifier\":{let d=t._symbol,m=t._errorSymbol;if(t.type===\"Ans\"&&i.argNames.indexOf(d)!==-1)throw dh();let y=gu(s,d),g=n[d];if(y!==void 0&&(s.symbolMap.hasOwnProperty(d)||g===void 0||g===jt))return y;if(g===void 0)throw we[d]?we[d].isFunction?yi(m):ha(m):new Error(`Programming Error: reached undefined symbol ${d}`);if(g!==jt&&ms(g))throw g;if(g===jt||g.isFunction)throw Jy(m);if(a.body&&g.type===\"RegressionParameter\")throw Mh(m);let h=Bn(r,n,i,s,void 0,a,u),P=Se(h,g);return Jn(s,d,P,g),P}case\"FunctionCall\":case\"SeededFunctionCall\":{dn(t.args);let d=Bu(e,t,t.args);return dn(d),Vd(e,t._symbol,t._errorSymbol,d,t.args)}case\"Substitution\":return WL(e,t);case\"FunctionExponent\":{let d=t.args[0]._symbol,m=n[d];return m!==jt&&(m!=null&&m.isFunction)?Se(e,new x.Exponent([new x.FunctionCall(d,[t.args[1]]),t.args[2]])):Se(e,new x.Multiply([t.args[0],new x.Exponent([t.args[1],t.args[2]])]))}case\"FunctionFactorial\":{let d=t.args[0]._symbol,m=n[d];return m!==jt&&(m!=null&&m.isFunction)?Se(e,new x.FunctionCall(\"\\\\factorial\",[new x.FunctionCall(d,[t.args[1]])])):Se(e,new x.Multiply([t.args[0],new x.FunctionCall(\"\\\\factorial\",[t.args[1]])]))}case\"DotAccess\":{let d=t.args[0],m=t.args[1],y=n[m._symbol];if(d.type===\"Identifier\"&&d._symbol===\"construction\")return ZL(e,m);if((m.type===\"Identifier\"||m.type===\"FunctionCall\")&&y!==jt&&(y!=null&&y.isFunction)){let g=m._symbol,h=m._errorSymbol,P=m.type===\"Identifier\"?[d]:[d].concat(m.args),S=Bu(e,t,P);return Vd(e,g,h,S,P,{dotLHSIndex:S[0]})}else if(m.type===\"SeededFunctionCall\"){let g=m._symbol,h=m._errorSymbol,P=[m.seed,d].concat(m.args.slice(1)),S=Bu(e,t,P);return Vd(e,g,h,S,P,{dotLHSIndex:S[1]})}else throw rn(\".\")}case\"Seed\":return i.ConstantOfType(He,t._stringValue);case\"ExtendSeed\":return i.ExtendSeed(t.tag,yn(e,t,t.args));case\"Integral\":{let d=t._differential._symbol,m=gu(s,d);if(n[d]!==void 0||m!==void 0&&i.getInstruction(m).type!==2)throw lh(d);let y=Object.create(n);y[d]=ch(d);let g=Rs(s),h=Bn(r,y,i,g,o,a,u),P=Se(h,t.args[1]),S=Se(h,t.args[2]),A=i.getInstruction(P),T=i.getInstruction(S),I=i.SymbolicVar(b,d),E=Rs(s);Jn(E,d,I);let v=Object.create(n);v[d]=jt;let D=Se(Bn(r,v,i,E,o,a,u),t.args[3]);if(!wd(i,D,I))return i.Multiply([D,i.Subtract([S,P])]);let R=ec(i,[P,S,D]),L=R!==void 0?i.BeginBroadcast([R]):void 0,w=P;L!==void 0&&q(A.valueType)&&(w=Co(i,P,L));let X=S;L!==void 0&&q(T.valueType)&&(X=Co(i,S,L));let H=i.getInstruction(D).valueType,Z=q(H)?Fe(H):H,K=Z===N?i.BeginBroadcast([i.Constant(2)]):Z===z?i.BeginBroadcast([i.Constant(3)]):void 0,J=i.BeginIntegral({indexSymbol:d},[w,X]),ce=Ho(i,J,I,D),ge=i.getInstruction(ce);L!==void 0&&q(ge.valueType)&&(ce=Co(i,ce,L)),K!==void 0&&(ce=Z===N?i.OrderedPairAccess([ce,K]):i.OrderedTripleAccess([ce,K]));let ie=i.EndIntegral([J,ce]),W=i.BlockVar(b,[ie]);if(K!==void 0){let _e=i.EndBroadcast([K,W]);W=i.BroadcastResult(Z,[_e])}if(L!==void 0){let _e=i.EndBroadcast([L,W]);return i.BroadcastResult(tn(Z),[_e])}else return W}case\"Sum\":case\"Product\":{let d=t._index._symbol,m=gu(s,d);if(n[d]!==void 0||m!==void 0&&i.getInstruction(m).type!==2)throw Pg(d);let y=t.type===\"Sum\",g=Object.create(n);g[d]=y?Kg(d):eh(d);let h=Rs(s),P=Bn(r,g,i,h,o,a,u),S=Se(P,t.args[1]);S=Ga(P.chunk,S);let A=Se(P,t.args[2]);if(A=Ga(P.chunk,A),!U(i,S,b)){let Lt=_a(i,[S]);throw y?ay(Lt):cy(Lt)}if(!U(i,A,b)){let Lt=_a(i,[A]);throw y?uy(Lt):py(Lt)}let T=i.SyntheticNativeFunction(\"round\",[S]),I=i.SyntheticNativeFunction(\"round\",[A]),E=i.getInstruction(T),v=i.getInstruction(I);if(E.type===1&&E.valueType===b&&!isFinite(B(E.value)))throw y?Np():Ap();if(v.type===1&&v.valueType===b&&!isFinite(B(v.value)))throw y?Np():Ap();let D=i.SymbolicVar(b,d),R=Rs(s);Jn(R,d,D);let L=Object.create(n);L[d]=jt;let w=Se(Bn(r,L,i,R,o,a,u),t.args[3]),X=i.getInstruction(w).valueType,H=q(X)?Fe(X):X,K=(t.type===\"Sum\"?Om:[b]).find(Lt=>Is(H,Lt));if(K===void 0){let Lt=_a(i,[w]);throw y?ly(Lt):fy(Lt)}if(!wd(i,w,D)){let Lt=i.Add([i.Subtract([I,T]),i.Constant(1)]);Lt=i.SyntheticNativeFunction(\"max\",[Lt,i.Constant(0)]);let de=y?i.Multiply([w,Lt]):i.Exponent([w,Lt]);return i.Piecewise([i.Less([Lt,i.Constant(1/0)]),de,i.NanOfType(K)])}let J=ec(i,[T,I,w]);if(J!==void 0&&wd(i,J,D))throw y?Th(d):Ph(d);let ce=J!==void 0?i.BeginBroadcast([J]):void 0,ge=T;ce!==void 0&&q(E.valueType)&&(ge=Co(i,T,ce));let ie=I;ce!=null&&q(v.valueType)&&(ie=Co(i,I,ce));let W=i.Constant(y?0:1),_e=K===N?i.OrderedPair([W,W]):K===z?i.OrderedTriple([W,W,W]):W,et=i.BeginLoop({type:y?\"sum\":\"product\",indexSymbol:d},[ge,ie,_e]),Ct=i.BlockVar(K,[et]),Jt=Ho(i,et,D,w),Lr=i.getInstruction(Jt);ce!==void 0&&q(Lr.valueType)&&(Jt=Co(i,Jt,ce));let un=y?i.Add([Ct,Jt]):i.Multiply([Ct,Jt]),xn=i.EndLoop([et,un]),yr=i.BlockVar(K,[xn]);if(ce!==void 0){let Lt=i.EndBroadcast([ce,yr]);return i.BroadcastResult(tn(K),[Lt])}else return yr}case\"Derivative\":{let d=t._symbol,m=Se(e,new x.Identifier(d));if(!U(i,m,b))throw hy(d,_a(i,[m]));let y=i.getInstruction(m),g,h,P=!1;if((y.type===2||y.type===3)&&y.valueType===b)g=e,h=m;else{let I=Rs(s);h=i.SymbolicVar(y.valueType),Jn(I,d,h),P=!0;let E=Object.create(n);E[d]=jt,g=Bn(r,E,i,I,o,a,u)}let S=1;for(;t.args[0].type===\"Derivative\"&&t.args[0]._symbol===t._symbol;)S+=1,t=t.args[0];let T=Vr(i,Se(g,t.args[0]));for(let I=0;I<S;I++)T=_u(i,T,h);return h===m?T:(P&&delete i.derivativeMaps[h],Ho(i,m,h,T))}case\"Prime\":{let d=t.args[0];if(!n[d._symbol])throw kp(d._symbol);let m=Se(e,d.args[0]),y=i.getInstruction(m),g=!1,h;(y.type===2||y.type===3)&&y.valueType===b?h=m:(h=i.SymbolicVar(y.valueType),g=!0);let P,S;if(d._symbol===\"logbase\"){if(d.args.length!==2)throw ya();P=[h,Se(e,d.args[1])],S=[d.args[0],d.args[1]]}else{if(d.args.length!==1)throw ya();P=[h],S=[d.args[0]]}let T=Vr(i,Vd(e,d._symbol,d._errorSymbol,P,S));for(let I=0;I<t.order;I++)T=_u(i,T,h);return h===m?T:(g&&delete i.derivativeMaps[h],Ho(i,m,h,T))}case\"Slider\":return e.chunk.Constant(t.getConcreteTree(r,n).asCompilerValue());case\"Assignment\":return Ax(i,e.selection,t),Se(e,t._expression);case\"CoordinateEquation\":return Se(e,t._expression);case\"FunctionDefinition\":{Ax(i,e.selection,t);for(var p=0;p<t._argSymbols.length;p++){if(n[t._argSymbols[p]])throw $p(t._argSymbols[p]);if(t._argSymbols[p]===t._symbol)throw $p(t._argSymbols[p])}return Se(e,t._expression)}case\"Construction\":throw rn(\"construction\");default:let f=l;throw new Error(`Programming error, unimplemented node type ${f}`)}}function Cx(e,t,r){let n=[Se(e,r[0])];return Fu(e.chunk,e.policy,e.selection,t,n),Ro(e.chunk,e.policy,t,n),n}function yn(e,t,r){let n=[Se(e,r[0]),Se(e,r[1])];return Fu(e.chunk,e.policy,e.selection,t,n),Ro(e.chunk,e.policy,t,n),n}function zL(e,t,r){let n=[Se(e,r[0]),Se(e,r[1]),Se(e,r[2])];return Fu(e.chunk,e.policy,e.selection,t,n),Ro(e.chunk,e.policy,t,n),n}function Bu(e,t,r){let n=[];for(let i of r)n.push(Se(e,i));return Fu(e.chunk,e.policy,e.selection,t,n),Ro(e.chunk,e.policy,t,n),n}function Vd(e,t,r,n,i,s){let{policy:o,frame:a,chunk:u,scope:l,parentNode:c,substitutionContext:p,selection:f}=e,d=gu(l,t);if(d!==void 0){if(re(u.getInstruction(d).valueType,Ce))return Gd(e.chunk,[d,...n],r,!0);if(n.length==1)return u.Multiply([d,n[0]]);throw u.getInstruction(d).type===2?kp(r):u.getInstruction(d).valueType===je?Qp(r):Jp(r)}let m=a[t];if(m!==jt&&(m!=null&&m.isError))throw m;if(m===void 0||m===jt||!m.isFunction){if(we[t]&&we[t].isFunction)throw t===\"logbase\"&&a.ln&&a.log?mh():yi(r);if(m&&m!==jt){let y=Se(e,m);if(u.getInstruction(y).valueType===je)throw Qp(r);if(re(u.getInstruction(y).valueType,Ce))return Gd(e.chunk,[y,...n],r,!0)}if(n.length==1)return u.Multiply([Se(e,new x.Identifier(t)),n[0]]);throw m?Jp(r):new Error(`Programming Error: reached undefined symbol ${t}`)}if(Wv(m)){if(s&&s.dotLHSIndex!==void 0)throw gl(r);if(n.length!==m._argSymbols.length)throw mi(r,m._argSymbols.length,n.length);let y=Rs(l),g=Object.create(a);for(let h=0;h<m._argSymbols.length;h++)Jn(y,m._argSymbols[h],n[h],i[h]),g[m._argSymbols[h]]=jt;return Se(Bn(o,g,u,y,c,p,f),m._expression)}else{if(rs.hasOwnProperty(t))return UL(e,t,r,n,i,s);if(lr.hasOwnProperty(t))return Kv(e,t,r,n,s);throw yi(r)}}function qL(e,t){return e.SyntheticNativeFunction(\"segment\",[e.SyntheticNativeFunction(\"basePointFromVector\",t),e.Add([e.SyntheticNativeFunction(\"basePointFromVector\",t),e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",t)])])}function Kv(e,t,r,n,i){let{chunk:s}=e,o=lr[t],a=!!(i&&i.dotLHSIndex!==void 0),u=n.length,{minArity:l,maxArity:c}=o;if(u>c||u<l)throw ae(\"Unexpected arity mismatch\");let p=e1(s,n,o),f={errorSymbol:r,providedArity:u,isDotCall:a};switch(o.tag){case\"default\":case\"reducer\":case\"doubleReducer\":case\"parameterizedReducer\":case\"color\":case\"never-broadcast\":return s.NativeFunction(t,f,p);case\"trig\":{let d=Se(e,new x.Identifier(\"trigAngleMultiplier\")),m=s.Multiply([p[0],d]);return s.NativeFunction(t,f,[m])}case\"trig2\":{let d=Se(e,new x.Identifier(\"trigAngleMultiplier\")),m=s.Multiply([p[1],d]);return s.NativeFunction(t,f,[p[0],m])}case\"inverseTrig\":{let d=Se(e,new x.Identifier(\"trigAngleMultiplier\")),m=s.NativeFunction(t,f,p);return s.Divide([m,d])}default:{let d=o.tag;throw new Error(`Programming Error: unexpected tag ${d}`)}}}function e1(e,t,{minArity:r,defaultArguments:n}){if(!n||!(t.length-r<n.length))return t;let i=t.slice();for(;i.length-r<n.length;)i.push(e.copyInstruction(n[i.length-r]));return i}function UL(e,t,r,n,i,s){let{chunk:o,policy:a}=e,u=rs[t];if(u.fallthroughUnlessDistribution&&(n.length===0||o.getInstruction(n[0]).valueType===Oe||!re(o.getInstruction(n[0]).valueType,je)))return Kv(e,t,r,n,s);let{minArity:l,maxArity:c}=u,p=n.length;if(p<l||p>c)throw new Error(\"Programming Error: unexpected arity mismatch\");let f;if(t===\"cdf\")p===2?f=[n[0],o.Constant(-1/0),n[1]]:f=n;else if(t===\"random\")if(p===1||p<4&&!q(o.getInstruction(n[1]).valueType)&&o.getInstruction(n[1]).valueType!==je){let m=o.Distribution(\"uniformdist\",[o.Constant(0),o.Constant(1)]);f=[n[0],m].concat(n.slice(1))}else f=n;else f=e1(o,n,u);let d=ul(t);if(d){let m=Sx(o,f,d);m.didCoerce&&(f=m.args)}switch(t){case\"length\":if(a.isGeometryEnabled()){if(f.length!==1)throw En(r,ps(o,f));let m=f[0];if(o.getInstruction(m).valueType===Oe)throw Dp(r,ps(o,f)[0]);if(U(o,m,xe)){let y=o.Constant(0),g=o.Constant(1);return o.SyntheticNativeFunction(\"distance\",[o.SyntheticNativeFunction(\"segmentGlider\",[m,y]),o.SyntheticNativeFunction(\"segmentGlider\",[f[0],g])])}else if(U(o,m,ee)){let y=o.SyntheticNativeFunction(\"abs\",[o.SyntheticNativeFunction(\"arcOmega\",[f[0]])]),{radius:g,startPoint:h}=_x(o,f[0]),P=o.SyntheticNativeFunction(\"arcGlider\",[f[0],o.Constant(1)]);return o.Piecewise([o.Equal([y,o.Constant(0)]),o.SyntheticNativeFunction(\"distance\",[h,P]),o.Multiply([g,y])])}else if(U(o,m,pe)){let y=o.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[m]),g=o.OrderedPair([o.Constant(0),o.Constant(0)]);return o.SyntheticNativeFunction(\"distance\",[g,y])}else throw q(o.getInstruction(m).valueType)?Dp(r,ps(o,f)[0]):En(r,ps(o,f))}else return o.SyntheticNativeFunction(\"count\",f);case\"round\":{if(f.length===1)return o.SyntheticNativeFunction(\"round\",f);if(!U(o,f[0],b)||!U(o,f[1],b))throw ae('Unexpected args for \"round\"');let m=o.SyntheticNativeFunction(\"round\",[f[1]]),y=o.RawExponent([o.Constant(10),m]);return o.Divide([o.SyntheticNativeFunction(\"round\",[o.Multiply([f[0],y])]),y])}case\"midpoint\":if(f.length===1&&U(o,f[0],xe)){let m=o.Constant(Me(1,2));return o.SyntheticNativeFunction(\"segmentGlider\",[f[0],m])}else if(f.length===1&&U(o,f[0],ee)){let m=o.Constant(Me(1,2));return o.SyntheticNativeFunction(\"arcGlider\",[f[0],m])}else if(f.length===2&&(U(o,f[0],N)&&U(o,f[1],N)||U(o,f[0],z)&&U(o,f[1],z))){let m=o.Constant(Me(1,2));return o.Multiply([m,o.Add(f)])}else throw ae('Unexpected args for \"midpoint\"');case\"circle\":if(f.length===1){if(!U(o,f[0],ee))throw ae('Unexpected args for \"circle\"');let{center:m,radius:y}=_x(o,f[0]);return o.SyntheticNativeFunction(\"circle\",[m,y])}else if(U(o,f[1],xe)){let m=o.Constant(0),y=o.Constant(1);return o.SyntheticNativeFunction(\"circle\",[f[0],o.SyntheticNativeFunction(\"distance\",[o.SyntheticNativeFunction(\"segmentGlider\",[f[1],m]),o.SyntheticNativeFunction(\"segmentGlider\",[f[1],y])])])}else return U(o,f[1],N)?o.SyntheticNativeFunction(\"circle\",[f[0],o.SyntheticNativeFunction(\"distance\",f)]):o.SyntheticNativeFunction(\"circle\",f);case\"segment\":return U(o,f[0],z)&&U(o,f[0],z)?o.SyntheticNativeFunction(\"segment3d\",f):o.SyntheticNativeFunction(\"segment\",f);case\"distance\":return U(o,f[0],z)&&U(o,f[0],z)?o.SyntheticNativeFunction(\"distance3d\",f):o.SyntheticNativeFunction(\"distance\",f);case\"center\":{let m=Zv(o,f[0]);return o.SyntheticNativeFunction(\"center\",[m])}case\"radius\":{let m=Zv(o,f[0]);return o.SyntheticNativeFunction(\"radius\",[m])}case\"glider\":{if(!U(o,f[1],b))throw ae('Unexpected args for \"glider\"');if(U(o,f[0],xe))return o.SyntheticNativeFunction(\"segmentGlider\",f);if(U(o,f[0],oe))return o.SyntheticNativeFunction(\"lineGlider\",f);if(U(o,f[0],ve))return o.SyntheticNativeFunction(\"rayGlider\",f);if(U(o,f[0],ue))return o.SyntheticNativeFunction(\"circleGlider\",f);if(U(o,f[0],ee))return o.SyntheticNativeFunction(\"arcGlider\",f);if(U(o,f[0],Ee))return o.SyntheticNativeFunction(\"polygonGlider\",f);throw ae('Unexpected args for \"glider\"')}case\"intersection\":case\"strictintersection\":{let m=0;t===\"strictintersection\"&&((U(o,f[0],xe)||U(o,f[0],ee))&&(m+=3),(U(o,f[1],xe)||U(o,f[1],ee))&&(m+=12)),U(o,f[0],ve)&&(m+=1),U(o,f[1],ve)&&(m+=4);let y=XL(e,i,f);if(!y)return Lx(o,f,m);let g=Se(e,new x.Identifier(y[0]));return y[1]!==void 0&&(g=o.ListAccess([g,o.Constant(y[1])])),o.SyntheticNativeFunction(\"chooseNonIncidentPoint\",[g,Lx(o,[f[0],f[1]],m),Lx(o,[f[1],f[0]],m<<2&12|m>>2&3)])}case\"parallel\":case\"perpendicular\":{let m=Bd(o,f[0]),y=[m,f[1]];if(U(o,m,oe)&&U(o,f[1],N))return o.SyntheticNativeFunction(t,y);throw ae('Unexpected args for \"parallel\"')}case\"translate\":case\"reflect\":case\"rotate\":case\"dilate\":return YL(e,t,f);case\"apply\":return Gd(o,f,r,!1);case\"normaldist\":case\"tdist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":return o.Distribution(t,f);case\"pdf\":case\"cdf\":case\"mean\":case\"median\":case\"stdev\":case\"var\":case\"quantile\":{let m=f[0],y=o.getInstruction(m);if(!re(y.valueType,je))throw ae(`Unexpected args for \"${t}\"`);let g=f.slice(1);for(let h of g)if(!re(o.getInstruction(h).valueType,b))throw ae(`Unexpected args for \"${t}\"`);if(q(y.valueType)){let h=[],P=1/0;for(let A of f){let T=Vr(o,A);h.push(T);let I=o.getInstruction(T);if(q(I.valueType)){let E=sr(o,T);if(E===void 0)throw wl(sn(o,T));P=Math.min(P,E)}}let S=[];for(let A=0;A<P;A++){let T=rc(o,h[0],A),I=o.getInstruction(T);if(I.type!==42)throw ae(`Unexpected opcode for distribution arg: ${I.type}`);let E=[];for(let v of h.slice(1))q(o.getInstruction(v).valueType)?E.push(rc(o,v,A)):E.push(v);S.push(Bs[I.symbol][t](o,T,E))}return o.List(S)}else{if(y.type!==42)throw ae(`Unexpected opcode for distribution arg: ${y.type}`);return Bs[y.symbol][t](o,m,g)}}case\"random\":{let m=f[0],y=f[1],g=o.getInstruction(f[0]),h=o.getInstruction(y);if(g.valueType!==He)throw ae(`Unexpected value type for seed arg: ${g.valueType}`);if(h.valueType===Qt)throw Uy();let P;if(q(h.valueType))P=Bv;else{if(h.type!==42||h.valueType!==je)throw ae('Expected distribution argument to \"random\"');P=Bs[h.symbol][t]}if(f.length>2){let S=f[2],A=o.getInstruction(S);if(A.valueType!==b)throw ae(`Expected numSamples argument to random() to be a number but got ${A.valueType}`);if(f.length===4){let R=o.getInstruction(f[3]);if(R.valueType!==b)throw ae(`Expected userSeed argument to random() to be a number but got ${A.valueType}`);if(!Gt(R))throw Kp(sn(o,f[3]));m=o.ExtendSeed(\"us\",[m,f[3]])}let T=o.Constant(1),I=o.SyntheticNativeFunction(\"round\",[o.SyntheticNativeFunction(\"validateSampleCount\",[S])]),E=o.BeginBroadcast([I]);m=o.ExtendSeed(\"lc\",[m,o.Subtract([E,T])]);let v=P(o,y,[m]),D=o.EndBroadcast([E,v]);return o.BroadcastResult(tn(o.getInstruction(v).valueType),[D])}return P(o,y,[m])}case\"shuffle\":{let m=f[0],y=f[1],g=f[2];if(!q(o.getInstruction(y).valueType)||g!==void 0&&o.getInstruction(g).valueType!==b)throw ae(`Unexpected args for \"${t}\"`);if(g!==void 0){if(!Gt(o.getInstruction(g)))throw Kp(sn(o,g));m=o.ExtendSeed(\"us\",[m,g])}return o.SyntheticNativeFunction(\"shuffle\",[m,y])}case\"sort\":{let m=f.length===2?f[1]:f[0],y=o.getInstruction(m);if(!q(o.getInstruction(f[0]).valueType)||y.valueType!==j&&y.valueType!==Oe)throw ae(`Unexpected args for \"${t}\"`);if(sr(o,m)===0)return m;let h=o.SyntheticNativeFunction(\"min\",[Qr(o,f[0]),Qr(o,m)]);return m=o.ListAccess([m,wx(e,o.List([o.Constant(1)]),o.List([h]),{stepMustBePositive:!0})]),o.SyntheticNativeFunction(\"elementsAt\",[f[0],o.SyntheticNativeFunction(\"sortPerm\",[m])])}case\"join\":{let m=[],y=!0;for(let R of f){let L=o.getInstruction(R);Ao(L)||(y=!1);let w=L.valueType;if(w!==Oe)if(q(w))m.push({isList:!0,index:R,elementType:Fe(w)});else if(ui(w))m.push({isList:!1,index:R,elementType:w});else throw En(r,ps(o,n))}if(m.length===0)return o.ConstantOfType(Oe,[]);for(let R of m)if(R.elementType!==m[0].elementType)throw En(r,ps(o,n));if(y){let R=[];for(let L of m){let w=o.getInstruction(Vr(o,L.index));A0(w),L.isList?R.push(...w.value):R.push(w.value)}return o.ConstantOfType(tn(m[0].elementType),R)}let g=o.Constant(0),h=o.Constant(1),P={};for(let R of m)R.isList&&P[R.index]===void 0&&(P[R.index]=Qr(o,R.index));let S=o.SyntheticNativeFunction(\"total\",m.map(R=>R.isList?P[R.index]:h)),A=o.BeginBroadcast([S]),T=g,I=[],E=[];for(let R of m){let L=R.isList?o.ListAccess([R.index,o.Subtract([A,T])]):R.index;if(E.push(L),R!==m[m.length-1]){let w=R.isList?P[R.index]:h;T=o.Add([T,w]),I.push(o.LessEqual([A,T]))}}let v=E[E.length-1];for(let R=E.length-2;R>=0;R--)v=o.Piecewise([I[R],E[R],v]);let D=o.EndBroadcast([A,v]);return o.BroadcastResult(tn(m[0].elementType),[D])}case\"unique\":{let m=f[0],y=o.getInstruction(m);if(!q(y.valueType)||y.valueType===Qt)throw ae(`Unexpected types for ${t}`);return o.SyntheticNativeFunction(\"elementsAt\",[m,o.SyntheticNativeFunction(\"uniquePerm\",[m])])}case\"polygon\":{let m=f.map(y=>o.getInstruction(y));if(m.length===0){let y=o.ConstantOfType(Ue,[]);return o.SyntheticNativeFunction(\"polygon\",[y])}else if(m.length===2&&re(m[0].valueType,b)&&re(m[1].valueType,b)){if(m[0].valueType===b&&m[1].valueType===b)throw Il();let y=o.OrderedPair(f);return o.SyntheticNativeFunction(\"polygon\",[y])}else return o.SyntheticNativeFunction(\"polygon\",f)}case\"directedangle\":return jv(e,f,r);case\"angle\":return o.SyntheticNativeFunction(\"undirectedAngleMarker\",[jv(e,f,r)]);case\"angles\":return o.SyntheticNativeFunction(\"polygonInteriorUndirectedAngles\",[f[0],Se(e,new x.Identifier(\"trigAngleMultiplier\"))]);case\"directedangles\":return o.SyntheticNativeFunction(\"polygonInteriorDirectedAngles\",[f[0],Se(e,new x.Identifier(\"trigAngleMultiplier\"))]);case\"coterminal\":{if(U(o,f[0],ye))return o.SyntheticNativeFunction(\"directedCoterminalAngle\",f);if(U(o,f[0],Ie))return o.SyntheticNativeFunction(\"undirectedCoterminalAngle\",f);throw ae(`Unexpected types for ${t}`)}case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ttest\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"arcs\":case\"vectors\":throw rn(r);default:{let m=t;throw new Error(`Programming Error: unexpected compiler function ${m}`)}}}function HL(e,t){let{chunk:r}=e;dn(t.args);let n=Bu(e,t,t.args),i=!1,s=!1;for(let o=0;o<n.length;o++){let u=r.getInstruction(n[o]).valueType;i=i||u===Be,s=s||u!==Be}if(i&&s)throw ae(\"Unexpected mix of actions and non-actions\");if(i)return t1(e,n);if(n.length===2)return r.OrderedPair(n);if(n.length==3)return r.OrderedTriple(n);throw ae(`Unexpected tuple dimensions: ${n.length}`)}function kL(e,t){let{chunk:r}=e;dn(t.args);let n=Bu(e,t,t.args);if(n.length<1)throw ae(\"Empty bare sequence\");let i=r.getInstruction(n[0]).valueType;if(i===b)throw ae(\"Ambiguous bare sequence\");return i===Be?t1(e,n):r.List(n)}function t1(e,t){let{chunk:r}=e,n=[],i=[];for(let o of t){let a=r.getInstruction(o);switch(a.type){case 49:{Array.prototype.push.apply(n,a.symbols),Array.prototype.push.apply(i,a.args);break}case 1:{let l=a.value.updateRules;for(let c in l)n.push(c),i.push(r.ConstantOfType(l[c].valueType,l[c].value));break}default:{var s=sn(r,o);throw s.length>0?Dy(s):ae(`Unexpected opcode for action: ${a.type}`)}}}return r.Action(n,i)}function r1(e,t){var r=e.frame[t];return r===jt?Cp(t):e.policy.assignmentForbidden(t)?Sy(t):r&&r.type===\"FunctionDefinition\"?Rp(t):Oy(t).allowExport()}function $L(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,l=t._body,c=[],p=i.Constant(1),f=Object.create(n);dn(t._inputLists);for(let{_symbol:I}of t._inputLists)f[I]=bh(I);let d=Rs(s);for(let I=t._inputLists.length-1;I>=0;I--){let E=t._inputLists[I],v=E._symbol,D=Se(Bn(r,f,i,d,o,a,u),E.args[1]),R=i.getInstruction(D);if(!q(R.valueType))throw yh(v,ne(R.valueType));let L=Qr(i,D);c.push({symbol:v,assignedList:D,lengthIndex:L}),p=i.Multiply([p,L])}let m=i.Constant(1),y=i.BeginBroadcast([p],{inputListSymbols:c.map(I=>I.symbol)}),g=Rs(s);Jn(g,t._index._symbol,y);let h=m;for(let I=c.length-1;I>=0;I--){let{symbol:E,assignedList:v,lengthIndex:D}=c[I],R;if(c.length===1)R=y;else{let w=i.SyntheticNativeFunction(\"floor\",[i.Divide([i.Subtract([y,m]),h])]);R=i.Add([i.SyntheticNativeFunction(\"mod\",[w,D]),m]),I>0&&(h=i.Multiply([h,D]))}let L=gu(g,E);if(n[E]!==void 0||L!==void 0&&i.getInstruction(L).type!==2)throw hh(E);Jn(g,E,i.ListAccess([v,R]))}let P=Object.create(n);for(let I of c)P[I.symbol]=jt;let S=Se(Bn(r,P,i,g,o,a,u),l),A=i.getInstruction(S);if(!ui(A.valueType))throw da([ne(A.valueType)]);let T=i.EndBroadcast([y,S]);return i.BroadcastResult(tn(A.valueType),[T])}function wx(e,t,r,n){let{stepMustBePositive:i}=n,{chunk:s}=e;t=Ga(s,t),r=Ga(s,r);let o=s.getInstruction(t),a=s.getInstruction(r),u=cs(s,t,\"Programming error: expected range start list to have constant length.\"),l=cs(s,r,\"Programming error: expected range start list to have constant length.\");if(o.valueType!==j||a.valueType!==j)throw Dl();let c=s.Constant(1),p=s.Constant(0),f=s.ListAccess([t,c]),d=s.ListAccess([t,s.Constant(2)]),m=s.ListAccess([r,s.Constant(l)]),y=s.Subtract([m,f]),g=u>1?s.Subtract([d,f]):s.Piecewise([s.GreaterEqual([y,p]),c,s.Constant(-1)]),h=s.Add([c,s.SyntheticNativeFunction(\"round\",[s.Divide([y,g])])]),P=s.SyntheticNativeFunction(\"validateRangeLength\",[t,r,g,h]);i&&(P=s.Piecewise([s.GreaterEqual([g,p]),P,p]));let S=s.BeginBroadcast([P]),A=s.Add([f,s.Multiply([g,s.Subtract([S,c])])]),T=s.EndBroadcast([S,A]);return s.addComments({[f]:\"start\",[d]:\"second\",[m]:\"last\",[h]:\"proposedLength\",[g]:\"step\",[A]:\"body\"}),s.BroadcastResult(tn(s.getInstruction(A).valueType),[T])}function Bd(e,t){return U(e,t,xe)?e.SyntheticNativeFunction(\"lineFromSegment\",[t]):U(e,t,pe)?e.SyntheticNativeFunction(\"lineFromSegment\",[qL(e,[t])]):U(e,t,ve)?e.SyntheticNativeFunction(\"lineFromRay\",[t]):t}function Zv(e,t){if(U(e,t,ee)){let{center:r,radius:n}=_x(e,t);return e.SyntheticNativeFunction(\"circle\",[r,n])}return t}function _x(e,t){let r=e.SyntheticNativeFunction(\"arcCenter\",[t]),n=e.SyntheticNativeFunction(\"arcGlider\",[t,e.Constant(0)]),i=e.SyntheticNativeFunction(\"distance\",[r,n]);return{center:r,radius:i,startPoint:n}}function jv(e,t,r){let{chunk:n}=e;if(t.length===3&&U(n,t[0],N)&&U(n,t[1],N)&&U(n,t[2],N)){let i=n.Constant(1),s=n.Constant(2),o=t[0],a=t[1],u=t[2],l=n.Subtract([o,a]),c=n.Subtract([u,a]),p=n.OrderedPairAccess([l,i]),f=n.OrderedPairAccess([l,s]),d=n.OrderedPairAccess([c,i]),m=n.OrderedPairAccess([c,s]),y=n.SyntheticNativeFunction(\"arctan\",[f,p]),g=n.Subtract([n.Multiply([p,m]),n.Multiply([f,d])]),h=n.Add([n.Multiply([p,d]),n.Multiply([f,m])]),P=n.SyntheticNativeFunction(\"arctan\",[g,h]),S=n.SyntheticNativeFunction(\"abs\",[P]),A=n.Constant(Math.PI),T=n.Constant(Math.PI*2);return P=n.Piecewise([n.Equal([S,A]),A,n.Piecewise([n.Less([S,A]),P,n.Multiply([n.Multiply([n.SyntheticNativeFunction(\"sign\",[P]),n.Constant(-1)]),n.Subtract([T,S])])])]),n.SyntheticNativeFunction(\"directedAngleMarker\",[a,y,P,Se(e,new x.Identifier(\"trigAngleMultiplier\"))])}else throw ae(`Unexpected types for ${r}`)}function Rv(e,t){return e.Divide([e.SyntheticNativeFunction(\"directedAngleMarkerRawDelta\",[t]),e.SyntheticNativeFunction(\"directedAngleMarkerMultiplier\",[t])])}function Cv(e,t){return e.SyntheticNativeFunction(\"abs\",[e.Divide([e.SyntheticNativeFunction(\"undirectedAngleMarkerRawDelta\",[t]),e.SyntheticNativeFunction(\"undirectedAngleMarkerMultiplier\",[t])])])}function YL(e,t,r){let{chunk:n}=e,i=r.slice(1),s=ul(t);if(!s)throw new Error(`Unexpected transformation type: ${t}`);let o=s.map(u=>{let l=0;for(let c=1;c<r.length;c++){let p=n.getInstruction(r[c]).valueType,f=ud(u,c);f&&Yb(p,f)&&l++}return{signature:u,matchedArgsCount:l,signatureArgsCount:Array.isArray(u)?u.length-1:u.initial.length+1,providedArgsCount:r.length-1}}).sort((u,l)=>l.matchedArgsCount!==u.matchedArgsCount?l.matchedArgsCount-u.matchedArgsCount:u.signatureArgsCount-l.signatureArgsCount);if(!o.some(u=>u.matchedArgsCount===u.signatureArgsCount&&u.matchedArgsCount===u.providedArgsCount))throw Sp(t,ps(n,i),o[0].signature);let a;switch(t){case\"translate\":{i.length===1&&U(n,i[0],N)?a=n.SyntheticNativeFunction(\"translation\",i):i.length===1&&U(n,i[0],pe)?a=n.SyntheticNativeFunction(\"translation\",[n.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",i)]):i.length===2&&U(n,i[0],N)&&U(n,i[1],N)?a=n.SyntheticNativeFunction(\"translation\",[n.Subtract([i[1],i[0]])]):i.length===2&&U(n,i[0],b)&&U(n,i[1],b)&&(a=n.SyntheticNativeFunction(\"translation\",[n.OrderedPair(i)]));break}case\"reflect\":{let u=Bd(n,i[0]);U(n,u,oe)&&(a=n.SyntheticNativeFunction(\"reflection\",[u]));break}case\"rotate\":{if(i.length===2){let u=Se(e,new x.Identifier(\"trigAngleMultiplier\"));a=n.SyntheticNativeFunction(\"rotation\",[i[0],n.Multiply([i[1],u])])}break}case\"dilate\":{i.length===2&&(a=n.SyntheticNativeFunction(\"dilation\",[i[0],i[1]]));break}default:{let u=t;throw new Error(`Programming error: exhaustive check failed: ${u}`)}}if(!a)throw Sp(t,ps(n,i),o[0].signature);return Gd(n,[a,r[0]],t,!0)}function Gd(e,t,r,n){if(t.length===2&&U(e,t[0],Ce)){if(U(e,t[1],Ce))return e.SyntheticNativeFunction(\"compose\",t);if(U(e,t[1],N))return e.SyntheticNativeFunction(\"transformPoint\",t);if(U(e,t[1],xe))return e.SyntheticNativeFunction(\"transformSegment\",t);if(U(e,t[1],oe))return e.SyntheticNativeFunction(\"transformLine\",t);if(U(e,t[1],ve))return e.SyntheticNativeFunction(\"transformRay\",t);if(U(e,t[1],pe))return e.SyntheticNativeFunction(\"transformVector\",t);if(U(e,t[1],ue))return e.SyntheticNativeFunction(\"transformCircle\",t);if(U(e,t[1],ee))return e.SyntheticNativeFunction(\"transformArc\",t);if(U(e,t[1],Ee))return e.SyntheticNativeFunction(\"transformPolygon\",t);if(U(e,t[1],Ie))return e.SyntheticNativeFunction(\"transformAngleMarker\",t);if(U(e,t[1],ye))return e.SyntheticNativeFunction(\"transformDirectedAngleMarker\",t)}throw n?sy(r,_a(e,t.slice(1))):En(r,_a(e,t))}function Lx(e,t,r){let n=Bd(e,t[0]),i=Bd(e,t[1]),s=[n,i,e.ConstantOfType(b,r)];if(U(e,n,ue)){if(U(e,i,ue))return e.SyntheticNativeFunction(\"circleCircleIntersection\",s);if(U(e,i,ee))return e.SyntheticNativeFunction(\"circleArcIntersection\",s);if(U(e,i,oe))return e.SyntheticNativeFunction(\"circleLineIntersection\",s)}if(U(e,n,ee)){if(U(e,i,ue))return e.SyntheticNativeFunction(\"arcCircleIntersection\",s);if(U(e,i,ee))return e.SyntheticNativeFunction(\"arcArcIntersection\",s);if(U(e,i,oe))return e.SyntheticNativeFunction(\"arcLineIntersection\",s)}if(U(e,n,oe)){if(U(e,i,ue))return e.SyntheticNativeFunction(\"lineCircleIntersection\",s);if(U(e,i,ee))return e.SyntheticNativeFunction(\"lineArcIntersection\",s);if(U(e,i,oe))return e.SyntheticNativeFunction(\"lineLineIntersection\",s)}throw ae(\"Invalid intersection types\")}function XL(e,[t,r],[n,i]){let{chunk:s,frame:o}=e,a=s.getInstruction(n).valueType,u=s.getInstruction(i).valueType,l=f=>{let d=o[f];return d&&d!==jt?d:$P(e.scope,f)},c=_d(t)?l(t._symbol):t,p=_d(r)?l(r._symbol):r;if(!(!c||!p))return Yv({getGeometryTree:f=>ad(f).tree,lookup:l,isPointOrListOfPoints:f=>{if(f.isFunction)return!1;let d=Se(e,f);return re(s.getInstruction(d).valueType,N)},resolvesTo:(f,d)=>o[f]===d},c,a,p,u)}function WL(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,l=t._body,c=Rs(s),p=Object.create(n);for(let d=0;d<t._assignments.length;d++){let m=t._assignments[d]._symbol,y=t._assignments[d].args[1],g=n[m];if(g){if(g!==jt&&g.isError)throw g;if(g!==jt&&g.type===\"FunctionDefinition\")throw af(m);if(g===jt)throw sf(m);if(r.assignmentForbidden(m))throw of(m)}let h=Se(e,y),P=sn(i,h);for(let S of P)if(S.scope===\"free\")throw Eh(P).allowExport();Jn(c,m,h,y),p[m]=jt}return Se(Bn(r,p,i,c,o,se($({},a),{body:!0}),u),l)}var Jv={points:Ue,lines:br,segments:Kt,polygons:ur,circles:gr,arcs:hr,angles:zt,directedangles:qt,rays:xr,vectors:Sr};function ZL(e,t){let{chunk:r,frame:n}=e,i=n.construction;if(i.isError)throw i;if(i.type!==\"Construction\")throw ae(`Expected construction node but found ${i.type}}`);if(!_d(t))throw ae(`Expected identifier but found ${t.type}`);let s=t._symbol;if(!(s in Jv))throw rn(\"construction\");let o=Jv[s];if(i.args.length===0)return r.ConstantOfType(o,[]);let a=Fe(o),u=[];for(let l of i.args)try{let c=Se(e,l);r.getInstruction(c).valueType===a&&u.push(c)}catch(c){if(c instanceof x.Base)continue;throw c}return r.List(u)}tt.prototype.buildIRExpression=function(e,t,r){var i;var n=Gu({policy:e,frame:t,wrapInList:r&&r.wrapInList,coerceToNumber:r&&r.coerceToNumber,selection:r&&r.selection},this);if(e.isGeometryEnabled()&&n.getLiveArgNames().some(s=>s[0]===\"$\"))throw Sh();return(i=n.getError())!=null?i:new Zt(n)};O.prototype.buildIRExpression=function(e,t,r){return this};var n1=_c;function Vx(e){for(var t=[],r=0;r<e.length;r++)t.push(ne(e[r].valueType));return t}function i1(e,t){var r=t.length,n=t[0];if(r<2)throw Li(this._symbol);if(!n1(n.valueType,[j,Oe]))throw Li(this._symbol);if(r>2)throw Vp(this._symbol,2)}x.Histogram.prototype.typeCheck=i1;x.DotPlot.prototype.typeCheck=i1;x.BoxPlot.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw Li(this._symbol);if(!n1(n.valueType,[j,Oe]))throw Li(this._symbol);if(r>1)throw Li(this._symbol)};x.TTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length===0)throw Li(r);if(t[0].valueType===Oe)throw du(r);if(t[0].valueType!==j)throw Li(r);if(t.length>2)throw Vp(r,2);if(t[0].length<2)throw du(r);if(t[1]&&t[1].valueType!==b)throw En(r,Vx(t))};x.IndependentTTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length!==2)throw Ml(r);if(!q(t[0].valueType)||!q(t[1].valueType))throw Sl(r);if(t[0].valueType===Oe||t[1].valueType===Oe)throw du(\"ittest\");if(t[0].valueType!==j||t[1].valueType!==j)throw En(r,Vx(t));if(t[0].length<2||t[1].length<2)throw du(\"ittest\")},x.Stats.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw Li(this._symbol);if(n.valueType===Oe)throw En(this._symbol,Vx(t));if(n.valueType!==j)throw Li(this._symbol);if(r>1)throw Li(this._symbol)};var za=function(e,t,r){r=r||0;var n=Array(r+1).join(\"  \"),i=n+\"  \";return`[\n`+i+e.map(function(s){return s.repr(t,r+1)}).join(`,\n`+i)+`\n`+n+\"]\"},jr=function(e,t){return t=t||\"\",\"\"+t+e};x.Expression.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+za(this.args,e,t)+\")\"};x.IRExpression.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join(\"  \"),n=r+\"  \",i=this._chunk.print().split(`\n`);return i.pop(),jr(this.type,e)+\"(`\\n\"+n+i.join(`\n`+n)+`\n`+r+\"`)\"};x.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join(\"  \"),n=r+\"  \";return jr(this.type,e)+`([\n`+n+this.args[0].repr(e,t+1)+`,\n`+n+\"'\"+this.args[1]+`',\n`+n+this.args[2].repr(e,t+1)+`,\n`+n+\"'\"+this.args[3]+`',\n`+n+this.args[4].repr(e,t+1)+`\n`+r+\"])\"};x.Identifier.prototype.repr=function(e){return jr(this.type,e)+\"('\"+this._symbol+\"')\"};x.Constant.prototype.repr=function(e){return jr(this.type,e)+\"(\"+this.asValue()+\")\"};x.ExtendSeed.prototype.repr=function(e,t){return jr(this.type,e)+\"('\"+this.tag+\"', \"+za(this.args,e,t)+\")\"};x.Seed.prototype.repr=function(e){return jr(this.type,e)+\"(\"+this.asValue()+\")\"};x.FunctionCall.prototype.repr=function(e,t){return jr(this.type,e)+\"('\"+this._symbol+\"', \"+za(this.args,e,t)+\")\"};x.Assignment.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+new x.Identifier(this._symbol).repr(e,t)+\", \"+this._expression.repr(e,t)+\")\"};x.CoordinateEquation.prototype.repr=function(e,t){return this.asEquation().repr(e,t)};x.Regression.prototype.repr=x.Equation.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+this._lhs.repr(e,t)+\", \"+this._rhs.repr(e,t)+\")\"};x.FunctionDefinition.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+new x.Identifier(this._symbol).repr(e,t)+\", \"+za(this._argSymbols.map(function(r){return new x.Identifier(r)}),e,t)+\", \"+this._expression.repr(e,t)+\")\"};x.Error.prototype.repr=function(e,t){return jr(this.type,e)+\"('\"+this._msg+\"')\"};x.Derivative.prototype.repr=function(e,t){return jr(this.type,e)+\"('\"+this._symbol+\"', \"+za(this.args,e,t)+\")\"};x.SolvedEquation.prototype.repr=function(e,t){return jr(this.type,e)+\"('\"+this._symbol+\"', \"+this._expression.repr(e,t)+\")\"};x.OptimizedRegression.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+JSON.stringify(this.parameters)+\", \"+JSON.stringify(this.residuals)+\", \"+JSON.stringify(this.statistics)+\", \"+this.model.repr(e,t+1)+\", \"+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+\")\"};x.Table.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+za(this.columns,e,t)+\")\"};x.TableColumn.prototype.repr=function(e,t){return jr(this.type,e)+\"(\"+this.header.repr(e,t)+\", \"+this.length+\", \"+za(this.values,e,t)+\")\"};x.Image.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return jr(this.type,e)+`({\n`+n+\"center: \"+this.center.repr(e,t+1)+`,\n`+n+\"radianAngle: \"+this.radianAngle.repr(e,t+1)+`,\n`+n+\"width: \"+this.width.repr(e,t+1)+`,\n`+n+\"height: \"+this.height.repr(e,t+1)+`},\n`+n+\"opacity: \"+this.opacity.repr(e,t+1)+`,\n`+n+JSON.stringify(this.moveStrategy)+`\n`+r+\"})\"};x.Ticker.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return jr(this.type,e)+`({\n`+n+\"handler: \"+this.handler.repr(e,t+1)+`,\n`+n+\"minStep: \"+this.minStep.repr(e,t+1)+`\n`+r+\"})\"};x.Slider.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return jr(this.type,e)+`({\n`+n+\"sliderAssignment: \"+this.sliderAssignment.repr(e,t+1)+`,\n`+n+\"sliderMin: \"+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,\n`+n+\"sliderMax: \"+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,\n`+n+\"sliderStep: \"+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},\n`+r+\")\"};var zd=function(e,t){return e.map(function(r){return r.substitute(t)})};x.Identifier.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};x.FunctionCall.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new x.FunctionCall(t,zd(this.args,e));if(t.type===\"Constant\")return new x.Multiply([t,this.args.length===1?this.args[0].substitute(e):new x.Constant(NaN)])}return x.Expression.prototype.substitute.call(this,e)};x.Constant.prototype.substitute=function(e){return this};x.Expression.prototype.substitute=function(e){return this.copyWithArgs(zd(this.args,e))};x.Derivative.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new x.Derivative(t,zd(this.args,e));throw new Error(\"Cannot substitute for a derivative variable with a non-Identifier\")}return new x.Derivative(this._symbol,zd(this.args,e))};x.Expression.prototype.simpleFunctionExpression=function(){return this};x.Assignment.prototype.simpleFunctionExpression=function(){return this._expression};x.CoordinateEquation.prototype.simpleFunctionExpression=function(){return this.asEquation().simpleFunctionExpression()};x.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};x.Equation.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};function Gs(e){return e>=100}var qd={normaldist:{type:\"distribution\",symbol:\"normaldist\",params:[\"mean\",\"stdev\"],defaults:[\"0\",\"1\"],discrete:!1},tdist:{type:\"distribution\",symbol:\"tdist\",params:[\"dof\"],defaults:[void 0],discrete:!1},binomialdist:{type:\"distribution\",symbol:\"binomialdist\",params:[\"trials\",\"probsuccess\"],defaults:[void 0,\"0.5\"],discrete:!0},poissondist:{type:\"distribution\",symbol:\"poissondist\",params:[\"mean\"],defaults:[void 0],discrete:!0},uniformdist:{type:\"distribution\",symbol:\"uniformdist\",params:[\"min\",\"max\"],defaults:[\"0\",\"1\"],discrete:!1}},jL={Histogram:{type:\"visualization\",symbol:\"histogram\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},DotPlot:{type:\"visualization\",symbol:\"dotplot\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},BoxPlot:{type:\"visualization\",symbol:\"boxplot\",params:[\"data\"],defaults:[void 0]}};function s1(e){let t=zi(e,{trailingComma:!0});return ko(t)}function ko(e){let t=e,r=jL[t.type];if(!r)switch(t.type===\"Assignment\"&&(t=t._expression),t.type){case\"FunctionCall\":{r=qd[t._symbol];break}default:return}if(!r)return;let n={},i=r.params,s=t.args;for(let o=0;o<i.length;o++){let a=s[o];n[i[o]]=a&&a.getInputString()||\"\"}return se($({},r),{span:t.getInputSpan(),values:n})}function zs(e){if(typeof e==\"string\")return e;if(e===void 0)return\"\";if(isNaN(e))return\"\\\\frac{0}{0}\";if(e===1/0)return\"\\\\infty\";if(e===-1/0)return\"-\\\\infty\";let t=e+\"\";return t=t.replace(/^1e\\+?([-\\d]+)/,\"10^{$1}\"),t=t.replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,\"$1\\\\cdot 10^{$2}\"),t}function QL(e){let t=e+\"\";if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(t)){let n=\"0\",i=String(t).toLowerCase().split(\"e\"),s=parseFloat(i[0]),o=parseInt(i[1],10),a=Math.abs(o),u=Math.abs(s).toString().split(\".\");if(o<0)t=\"0.\"+new Array(a).join(n)+u.join(\"\");else{var r=u[1];r&&(a=a-r.length),t=u.join(\"\")+new Array(a+1).join(n)}s<0&&(t=\"-\"+t)}return t}function d$(e,t=2){var r=QL(e),n=r.indexOf(\".\");if(n===-1)return r;for(var i,s=n+1;s<r.length;s++)if(i){if(r[s]!==i)break}else if(r[s]===\"0\"||r[s]===\"9\")i=r[s];else break;return r.substr(0,Math.max(n+5,s+t))}function pr(e,t){if(q(e)){let r=[];for(let n=0;n<t.length;n++)r.push(pr(Fe(e),t[n]));return`\\\\left[${r.join(\",\")}\\\\right]`}switch(e){case b:return zs(t);case N:{let[s,o]=t;return`\\\\left(${zs(s)},${zs(o)}\\\\right)`}case z:{let[s,o,a]=t;return`\\\\left(${zs(s)},${zs(o)},${zs(a)}\\\\right)`}case ot:return\"\\\\operatorname{rgb}\\\\left(\"+[pr(b,t[0]),pr(b,t[1]),pr(b,t[2])].join(\",\")+\"\\\\right)\";case Ee:{let s=[];for(let o of t)s.push(pr(N,o));return\"\\\\operatorname{polygon}\\\\left(\"+s.join(\",\")+\"\\\\right)\"}case xe:return\"\\\\operatorname{segment}\\\\left(\"+[pr(N,t[0]),pr(N,t[1])].join(\",\")+\"\\\\right)\";case oe:return\"\\\\operatorname{line}\\\\left(\"+[pr(N,t[0]),pr(N,t[1])].join(\",\")+\"\\\\right)\";case ve:return\"\\\\operatorname{ray}\\\\left(\"+[pr(N,t[0]),pr(N,t[1])].join(\",\")+\"\\\\right)\";case pe:let r=t[0],n=t[1],i=[n[0]+r[0],n[1]+r[1]];return`\\\\operatorname{vector}\\\\left(${pr(N,n)},${pr(N,i)}\\\\right)`;case ue:return\"\\\\operatorname{circle}\\\\left(\"+[pr(N,t[0]),pr(b,t[1])].join(\",\")+\"\\\\right)\";case ee:return\"\\\\operatorname{arc}\\\\left(\"+[pr(N,t[0]),pr(N,t[1]),pr(N,t[2])].join(\",\")+\"\\\\right)\";case Ie:return\"\\\\operatorname{angle}\\\\left(\"+[pr(N,t[0]),pr(b,t[1]),pr(b,t[2])].join(\",\")+\"\\\\right)\";case ye:return\"\\\\operatorname{directedangle}\\\\left(\"+[pr(N,t[0]),pr(b,t[1]),pr(b,t[2])].join(\",\")+\"\\\\right)\";default:throw new Error(\"Cannot serialize a value of type \"+ne(e)+\".\")}}function Bx(e){let t={};for(let r in e.updateRules)t[r]=Gx(e,r);return t}function Gx(e,t){let{valueType:r,value:n}=e.updateRules[t];return`${wr(t)}=${pr(r,n)}`}var zu=class{constructor({enableGeometry:t,enable3d:r,beta3d:n,scales:i}){this._isGeometry=!1;this._is3dProduct=!1;this._isBeta3d=!1;this._isGeometry=t,this._is3dProduct=r,this._isBeta3d=n,this._scales=i}isGeometryEnabled(){return this._isGeometry}is3dProduct(){return this._is3dProduct}is3dPolicy(){return!1}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return this._scales?this._scales.xAxisScale===\"linear\"&&this._scales.yAxisScale===\"linear\":!0}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"theta\"||this.substitutionForbidden(t)}substitutionForbidden(t){return t===\"index\"||t===\"dt\"||t.slice(0,3)===\"tmp\"||we.hasOwnProperty(t)}isValidSlider(t){return t===\"x\"||t===\"y\"?!0:!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}sliderVariables(t){return t.indexOf(\"theta\")!==-1&&(t=t.filter(function(r){return r!==\"r\"})),t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)===\"ans\"||r.slice(0,6)===\"idref_\"||r[0]===\"_\"||this.isGeometryEnabled()&&r[0]===\"$\"))}tooManySliderVariables(t,r,n){return n?t.length>=1:t.length>=2&&r.length>=1}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}validRegressionParameter(t){return t!==\"x\"&&t!==\"y\"}validLHS(t){return t!==\"theta\"&&t.slice(0,6)!==\"idref_\"}unplottablePolarFunction(t,r){return t!==\"theta\"?!1:r.indexOf(\"r\")!==-1}validDoubleInequalitySymbol(t){return t===\"x\"||t===\"y\"}validDoubleInequalityVariables(t){return t.length>2?!1:t.every(this.validDoubleInequalitySymbol)}validExpressionVariables(t){return t.length===1&&t[0]===\"x\"}validSolvedVariable(t){return t===\"x\"||t===\"y\"||t===\"r\"}validImplicitVariables(t){switch(t.length){case 0:return!0;case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return t[0]===\"x\"&&t[1]===\"y\"||t[0]===\"y\"&&t[1]===\"x\"||t[0]===\"r\"&&t[1]===\"theta\"||t[0]===\"theta\"&&t[1]===\"r\";default:return!1}}graphableListVariables(t,r){return t===\"x\"||t===\"y\"||t===\"r\"||r===\"x\"||r===\"y\"}validParametricVariable(t){return t===\"t\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])}validInequalityVariables(t){switch(t.length){case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return this.validImplicitVariables(t);default:return!1}}validFirstColumnVariable(t){return t!==\"y\"&&t!==\"r\"&&t!==\"theta\"&&!t.match(/y_(\\d+)/)}validActionVariable(t){return t===\"dt\"||t===\"index\"}validCoordinateEquationSymbol(t){return!1}complicatedPolarImplicit(t,r){return t===\"theta\"||t===\"r\"&&r!==1}graphMode(t,r,n){if(r.length===0)return t===\"x\"?1:t===\"r\"?6:t===\"y\"?2:10;let i=r[0];return i===\"y\"?1:t===\"x\"?1:t===\"r\"&&i===\"theta\"?6:2}functionDefinitionGraphMode(t,r){return this.graphMode(t,r)}tableableAsConstant(t){return!(t===\"x\"||t===\"r\"||t===\"theta\")}implicitIndependent(t){return\"x\"}implicitDependency(t){return t.length!==1?\"y\":t[0]===\"y\"?\"x\":t[0]===\"theta\"?\"r\":\"y\"}disabledFeatures(){return[]}};function $o(){return new zu({enableGeometry:!1,enable3d:!0,beta3d:!1,scales:{xAxisScale:\"linear\",yAxisScale:\"linear\"}})}var qu=class{constructor(t){this._isBeta3d=!1;this._isBeta3d=t}isGeometryEnabled(){return!1}is3dProduct(){return!0}is3dPolicy(){return!0}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return!0}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}substitutionForbidden(t){return $o().substitutionForbidden(t)}validInequalityVariables(t){return $o().validInequalityVariables(t)}validFirstColumnVariable(t){return $o().validFirstColumnVariable(t)}validActionVariable(t){return $o().validActionVariable(t)}tableableAsConstant(t){return $o().tableableAsConstant(t)}implicitIndependent(t){return $o().implicitIndependent(t)}validRegressionParameter(t){return $o().validRegressionParameter(t)}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||t===\"theta\"||t===\"phi\"||this.substitutionForbidden(t)}sliderVariables(t){return t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)===\"ans\"||r.slice(0,6)===\"idref_\"||r[0]===\"_\"))}tooManySliderVariables(t,r,n){return n?this.isBeta3d()?r.length>=1:t.length>=1:r.length>=1}isValidSlider(t){return t===\"x\"||t===\"y\"||t===\"z\"?!0:!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}validLHS(t){return t!==\"phi\"&&$o().validLHS(t)}unplottablePolarFunction(t,r){return!1}complicatedPolarImplicit(t,r){return!1}validDoubleInequalitySymbol(t){return!1}validDoubleInequalityVariables(t){return!1}validExpressionVariables(t){return t.length===2&&t.every(r=>r==\"x\"||r==\"y\")}validSolvedVariable(t){return qx(t)||t===\"r\"}validImplicitVariables(t){return t.every(qx)}graphableListVariables(t,r){return t===\"x\"||t===\"y\"||t===\"r\"||r===\"x\"||r===\"y\"}validParametricVariable(t){return t===\"t\"||t===\"u\"||t===\"v\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])||t.length===2&&t.every(zx)}validCoordinateEquationSymbol(t){return this.isBeta3d()?t===\"rthetaphi\"||t===\"rthetaz\":!1}functionDefinitionGraphMode(t,r){if(r.length===1)switch(r[0]){case\"x\":return 120;case\"y\":return 119;default:return 10}else if(r.length===2&&r.every(n=>n==\"x\"||n==\"y\"))return 106;return 10}graphMode(t,r,n){var s;let i=(s=n==null?void 0:n.allDependencies)!=null?s:r;if(r.length===0)switch(t){case\"z\":return i.some(o=>o===\"r\"||o===\"theta\")?109:106;case\"y\":return 122;case\"x\":return 121;case\"r\":return i.indexOf(\"r\")>-1?10:o1(n,{prefer:\"Spherical\"});case\"rthetaz\":return this.isBeta3d()?114:10;case\"rthetaphi\":return this.isBeta3d()?115:10;default:return 10}switch(t){case\"z\":return r.every(o=>o==\"x\"||o==\"y\")?106:r.every(o=>o==\"r\"||o==\"theta\")?109:10;case\"y\":return r.every(o=>o==\"x\")?i.some(o=>o===\"z\")?108:120:r.every(o=>o==\"x\"||o==\"z\")?108:10;case\"x\":return r.every(o=>o==\"y\")?i.some(o=>o===\"z\")?107:119:r.every(o=>o==\"y\"||o==\"z\")?107:10;case\"r\":return r.every(o=>o==\"theta\")?o1(n,{prefer:\"Cylindrical\"}):r.every(o=>o==\"theta\"||o==\"z\")?110:r.every(o=>o==\"theta\"||o==\"phi\")?111:10;case\"rthetaz\":return this.isBeta3d()?r.length===1&&r[0]===\"t\"?101:r.every(zx)?104:10:10;case\"rthetaphi\":return this.isBeta3d()?r.length===1&&r[0]===\"t\"?102:r.every(zx)?105:10:10;default:return 10}}implicitDependency(t){if(t.length!==2)return\"z\";let r=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return r===\"xy\"?\"z\":r===\"xz\"?\"y\":r===\"yz\"?\"x\":\"z\"}disabledFeatures(){return[]}},qx=e=>e===\"x\"||e===\"y\"||e===\"z\",zx=e=>e===\"u\"||e===\"v\";function o1(e,{prefer:t}){let r=e.allDependencies.some(i=>qx(i)||i===\"r\"),n=(e==null?void 0:e.polarCoordinateSystem)||t;switch(n){case\"Spherical\":return r?111:124;case\"Cylindrical\":return r?110:123;default:return 10}}var po=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,r,n){this.map&&(t=this.map(t),r=this.map(r),n=this.map(n));var i=Ji(n[0],n[1],n[2]||0,t[0],t[1],t[2]||0,r[0],r[1],r[2]||0);if(i<1)return!1;var s=[t[0]+i*(r[0]-t[0]),t[1]+i*(r[1]-t[1]),t.length===3?t[2]+i*(r[2]-t[2]):0];return Math.abs(n[0]-s[0])<=this.xtolerance&&Math.abs(n[1]-s[1])<=this.ytolerance&&(t.length===2||Math.abs(n[2]-s[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let r=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(r,this.pivotPoint,t)||Ni(r[0]-t[0],r[1]-t[1],(r[2]||0)-(t[2]||0))<Ni(r[0]-this.pendingPoint[0],r[1]-this.pendingPoint[1],(r[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var u1=5,KL=Math.pow(2,14);function l1(e,t){let r=ew(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}}function ew(e,t){let r=Math.pow(2,-u1),n=a1(t,r),i=a1(t,2*r),s=tw(e,n,i),o=uw(s.root,e,n),a=dw(o,e,n);return{paddedDomain:n,rootDomain:i,quadTree:s,triangles:o,contours:a}}function Hu(e,t,r){return{x:e,y:t,z:r}}function Ud(e,t,r){return{x:e,y:t,isZero:r}}function Hd(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function a1(e,t){let{mathToPixels:r}=e,n=r.interpolateX(e.xmin,e.xmax,-t),i=r.interpolateX(e.xmax,e.xmin,-t),s=r.interpolateY(e.ymin,e.ymax,-t),o=r.interpolateY(e.ymax,e.ymin,-t);return se($({},e),{xmin:n,ymin:s,xmax:i,ymax:o})}function hc(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function Ux(e,t,r){e.center=c1(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function tw(e,t,r){let n=rw(e,r),i=[],s=[];s.push(n);let o=1,a=!0;e:for(;s.length;){let u=i;i=s,s=u;let l;for(;l=i.pop();)if(iw(l,e,t)){if(nw(l,e,t),!l.children){a=!1;break e}if(s.push(l.children[0]),s.push(l.children[1]),s.push(l.children[2]),s.push(l.children[3]),o+=3,o>=KL){a=!1;break e}}else Ux(l,e,t)}for(let u=0;u<i.length;u++)Ux(i[u],e,t);for(let u=0;u<s.length;u++)Ux(s[u],e,t);return{root:n,resolved:a}}function rw(e,t){let r=t.xmin,n=t.xmax,i=t.ymin,s=t.ymax;return hc(0,[Uu(r,s,e),Uu(n,s,e),Uu(n,i,e),Uu(r,i,e)])}function nw(e,t,r){let n=e.depth+1,i=e.vertices[0],s=e.vertices[1],o=e.vertices[2],a=e.vertices[3],u=gn(i,s,t,r),l=gn(s,o,t,r),c=gn(o,a,t,r),p=gn(a,i,t,r),f=gn(i,o,t,r);e.children=[hc(n,[i,u,f,p]),hc(n,[u,s,l,f]),hc(n,[f,l,o,c]),hc(n,[p,f,c,a])]}function iw(e,t,r){if(e.depth<u1)return!0;if(ow(e,r)||sw(e,r))return!1;let n=e.vertices[0],i=e.vertices[1],s=e.vertices[2],o=e.vertices[3];if(isNaN(n.z)&&isNaN(i.z)&&isNaN(s.z)&&isNaN(o.z))return!1;if(isNaN(n.z)||isNaN(i.z)||isNaN(s.z)||isNaN(o.z))return!0;let a=c1(n,i,s,o,t,r),u=Us(n,i,t,r),l=Us(i,s,t,r),c=Us(s,o,t,r),p=Us(o,n,t,r);return Xo(n,u,t,r)||Xo(i,u,t,r)||Xo(i,l,t,r)||Xo(s,l,t,r)||Xo(s,c,t,r)||Xo(o,c,t,r)||Xo(o,p,t,r)||Xo(n,p,t,r)||Yo(n,u,a,t,r)||Yo(u,i,a,t,r)||Yo(i,l,a,t,r)||Yo(l,s,a,t,r)||Yo(s,c,a,t,r)||Yo(c,o,a,t,r)||Yo(o,p,a,t,r)||Yo(p,n,a,t,r)}function Yo(e,t,r,n,i){if(e.z>0==t.z>0&&t.z>0==r.z>0)return!1;let s,o,a,u;if(e.z>0==t.z>0){if(s=gn(e,t,n,i),s.z>0!=e.z>0)return!0;o=qs(e,r,n,i),a=qs(t,r,n,i),u=qs(s,r,n,i)}else if(t.z>0==r.z>0){if(s=gn(t,r,n,i),s.z>0!=t.z>0)return!0;o=qs(t,e,n,i),a=qs(r,e,n,i),u=qs(s,e,n,i)}else{if(s=gn(r,e,n,i),s.z>0!=r.z>0)return!0;o=qs(r,t,n,i),a=qs(e,t,n,i),u=qs(s,t,n,i)}let{mathToPixels:l}=i,[c,p]=l.mapCoordinatePair([u.x,u.y]),[f,d]=l.mapCoordinatePair([o.x,o.y]),[m,y]=l.mapCoordinatePair([a.x,a.y]);return WT(c,p,f,d,m,y)>i.tolerance}function Xo(e,t,r,n){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let s=4*gn(e,t,r,n).z-t.z-3*e.z,o=1e-4,a=(r((1-o)*e.x+o*t.x,(1-o)*e.y+o*t.y)-e.z)/o,u=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(s-a)>.125*u}function sw(e,t){let{mathToPixels:r}=t,[n,i]=r.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[s,o]=r.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[a,u]=r.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);return Math.abs(n-s)<10*t.tolerance||Math.abs(o-u)<10*t.tolerance}function ow(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function ku(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function Uu(e,t,r){return Hu(e,t,r(e,t))}function gn(e,t,r,n){let{mathToPixels:i}=n;return Uu(i.interpolateX(e.x,t.x,.5),i.interpolateY(e.y,t.y,.5),r)}function Us(e,t,r,n){if(ku(e,n)||ku(t,n))return gn(e,t,r,n);if(isNaN(e.z)||isNaN(t.z))return aw(e,t,r,n);if(e.z>0!=t.z>0)return gn(e,t,r,n);let i=.01,s=r((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z,o=t.z-r(i*e.x+(1-i)*t.x,i*e.y+(1-i)*t.y);return isNaN(s)||isNaN(o)||s>0==o>0?gn(e,t,r,n):p1(Hu(e.x,e.y,s),Hu(t.x,t.y,o),r,n)}function c1(e,t,r,n,i,s){let o=Us(e,r,i,s);return e.z>0==r.z>0&&o.z>0!=e.z>0||(o=Us(t,n,i,s),t.z>0==n.z>0&&o.z>0!=t.z>0)?o:gn(e,r,i,s)}function p1(e,t,r,n){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return gn(e,t,r,n);if(isFinite(e.z))if(isFinite(t.z)){let i=1-e.z/t.z,s=1-t.z/e.z;return Uu(e.x/i+t.x/s,e.y/i+t.y/s,r)}else return e;else return t}function qs(e,t,r,n){let{mathToPixels:i}=n,s=e.x,o=t.x,a=e.y,u=t.y,l=e.z,c=t.z;if(ku(e,n)||ku(t,n)){let y=gn(e,t,r,n);return Ud(y.x,y.y,!1)}let[p,f]=i.mapCoordinatePair([s,a]),[d,m]=i.mapCoordinatePair([o,u]);for(;Math.abs(p-d)>n.tolerance||Math.abs(f-m)>n.tolerance;){let y=.5*(s+o),g=.5*(a+u),h=r(y,g);h>0==l>0?(s=y,a=g,l=h):(o=y,u=g,c=h),[p,f]=i.mapCoordinatePair([s,a]),[d,m]=i.mapCoordinatePair([o,u])}if(isNaN(l))return Ud(o,u,!1);if(isNaN(c))return Ud(s,a,!1);{let y=p1(Hu(s,a,l),Hu(o,u,c),r,n),g=l===0||c===0||y.z===0||y.z>=l==c>=y.z&&Math.abs(y.z)<1e250;return Ud(y.x,y.y,g)}}function aw(e,t,r,n){let{mathToPixels:i}=n;if(isNaN(e.z)===isNaN(t.z))return gn(e,t,r,n);if(isNaN(e.z)){let m=e;e=t,t=m}let s=e.x,o=t.x,a=e.y,u=t.y,l=e.z,[c,p]=i.mapCoordinatePair([s,a]),[f,d]=i.mapCoordinatePair([o,u]);for(;Math.abs(c-f)>n.tolerance||Math.abs(p-d)>n.tolerance;){let m=.5*(s+o),y=.5*(a+u),g=r(m,y);isNaN(g)===isNaN(l)?(s=m,a=y,l=g):(o=m,u=y),[c,p]=i.mapCoordinatePair([s,a]),[f,d]=i.mapCoordinatePair([o,u])}return Hu(s,a,l)}function uw(e,t,r){let n={triangles:[],edgeCache:{},domain:r,fn:t};return bc(e,n),n.triangles}function bc(e,t){e.children&&(bc(e.children[0],t),bc(e.children[1],t),bc(e.children[2],t),bc(e.children[3],t),Wo(e.children[0],e.children[1],t),Wo(e.children[3],e.children[2],t),Zo(e.children[1],e.children[2],t),Zo(e.children[0],e.children[3],t))}function Wo(e,t,r){e.children&&t.children?(Wo(e.children[1],t.children[0],r),Wo(e.children[2],t.children[3],r)):e.children?(Wo(e.children[1],t,r),Wo(e.children[2],t,r)):t.children?(Wo(e,t.children[0],r),Wo(e,t.children[3],r)):lw(e,t,r)}function Zo(e,t,r){e.children&&t.children?(Zo(e.children[2],t.children[1],r),Zo(e.children[3],t.children[0],r)):e.children?(Zo(e.children[2],t,r),Zo(e.children[3],t,r)):t.children?(Zo(e,t.children[1],r),Zo(e,t.children[0],r)):cw(e,t,r)}function lw(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=Us(e.vertices[1],e.vertices[2],r.fn,r.domain),i=Yd(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=Us(t.vertices[0],t.vertices[3],r.fn,r.domain),i=Yd(t.vertices[0],t.center,t.vertices[3],e.center,n)),f1(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function cw(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=Us(e.vertices[3],e.vertices[2],r.fn,r.domain),i=Yd(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=Us(t.vertices[1],t.vertices[0],r.fn,r.domain),i=Yd(t.vertices[1],t.center,t.vertices[0],e.center,n)),f1(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function Yd(e,t,r,n,i){return[Hd(e,i,t),Hd(t,i,r),Hd(r,i,n),Hd(n,i,e)]}function xc(e,t,r){return e.z>0&&!ku(e,r)&&(!(t.z>0)||ku(t,r))}function kd(e,t){return\"\"+e.x+\",\"+e.y+\",\"+t.x+\",\"+t.y}function f1(e,t,r){$d(e[0],e[1],e[2],kd(e[1].vertices[2],e[1].vertices[0]),t,r),$d(e[1],e[2],e[3],kd(e[2].vertices[0],e[2].vertices[2]),t,r),$d(e[2],e[3],e[0],kd(e[3].vertices[2],e[3].vertices[0]),t,r),$d(e[3],e[0],e[1],kd(e[0].vertices[0],e[0].vertices[2]),t,r)}function $d(e,t,r,n,i,s){let o=t.vertices[0],a=t.vertices[1],u=t.vertices[2];xc(a,u,s)&&(t.next=r),xc(o,a,s)&&(t.next=e),xc(u,o,s)&&fw(t,n,i),xc(o,u,s)&&pw(t,n,i)}function pw(e,t,r){r[t]?r[t].next=e:r[t]=e}function fw(e,t,r){r[t]?e.next=r[t]:r[t]=e}function dw(e,t,r){let{tolerance:n,mathToPixels:i}=r,s={tolerance:n,map:a=>i.mapCoordinatePair(a)},o={fillAccumulator:new po(s),strokeAccumulator:new po(s),fn:t,domain:r};for(let a=0;a<e.length;a++){let u=e[a];u.next&&!u.visited&&mw(u,o)}return{strokeSegments:o.strokeAccumulator.finish().segments,fillSegments:o.fillAccumulator.finish().segments}}function mw(e,t){for(;;){let r=e.vertices[0],n=e.vertices[1],i=e.vertices[2];if(Hx(r,n,t),Hx(n,i,t),Hx(i,r,t),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function Hx(e,t,r){if(xc(e,t,r.domain)){let n=qs(e,t,r.fn,r.domain);r.fillAccumulator.addPoint([n.x,n.y]),n.isZero?r.strokeAccumulator.addPoint([n.x,n.y]):r.strokeAccumulator.breakSegment()}}var ii={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};function kx(e){return Math.abs(e)<5e-8}var Tc=class extends po{constructor(r,n,i){let{tolerance:s,mathToPixels:o}=r;super({tolerance:s,map:a=>o.mapCoordinatePair(a)});this.fn=n,this.mappedFn=a=>o.mapY(n(a)),this.derivative=i,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return ii.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(r){this.segment.length===0&&kx(r[1])&&(this.poiData.zeros.x.push(r[0]),this.poiData.zeros.y.push(r[1])),this.updateZeroBuffer(r),this.updateExtremumBuffer(r),super.addPoint(r)}updateZeroBuffer(r){let[n,i]=this.map?this.map(r):r;if(!isFinite(n)||!isFinite(i)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(kx(r[1]))return;this.zeroBuffer.push(r);return}case 1:if(r[1]===0){this.zeroBuffer.push(r);return}else if(r[1]>0!=this.zeroBuffer[0][1]>0){let s=kh(this.zeroBuffer[0][0],this.zeroBuffer[0][1],r[0],r[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}case 2:{if(r[1]===0)return;if(r[1]>0!=this.zeroBuffer[0][1]>0){let s=Ul(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],r[0],r[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}}}}updateExtremumBuffer(r){let[n,i]=this.map?this.map(r):r;if(!isFinite(n)||!isFinite(i)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(r);return}case 1:{r[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(r);return}case 2:if(r[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(r);return}else if(r[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],r[0],r[1]);s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1]),!xu(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),s[0],this.mappedFn(s[0]),r[0],this.mappedFn(r[0]),this.mappedFn,this.ytolerance)&&s[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=s)),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}case 3:{if(r[1]===this.extremumBuffer[1][1])return;if(r[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s,o=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),a=this.fn(o);a===this.extremumBuffer[1][1]?s=Ul(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],r[0],r[1],this.fn):s=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],o,a,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}}}}bisectExtremumUsingDerivative(r,n,i,s,o,a){let u;if(this.derivative){let l=this.derivative(r),c=this.derivative(o);if(!isNaN(l)&&!isNaN(c)&&(s>n&&l>0&&c<0||s<n&&l<0&&c>0)){let p=kh(r,l,o,c,this.derivative);p&&(u=[p[0],this.fn(p[0])])}}return u||(u=PI(r,n,i,s,o,a,this.fn)),u}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),kx(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(r){if(!r)return{x:[],y:[]};let n=r(0);return isFinite(n)?{x:[0],y:[r(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var yw=e=>{for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}},Hi=yw;var{sin:gw,cos:hw}=Math,Vt=class{constructor(t=0,r=0,n=0){this.x=t;this.y=r;this.z=n}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,r,n){return this.x=t,this.y=r,this.z=n,this}clone(){return new Vt(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let n=t.x,i=t.y,s=t.z,o=r.x,a=r.y,u=r.z;return this.x=i*u-s*a,this.y=s*o-n*u,this.z=n*a-i*o,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,r){let n=bw(t,r);return new Vt(n[0]*this.x+n[1]*this.y+n[2]*this.z,n[3]*this.x+n[4]*this.y+n[5]*this.z,n[6]*this.x+n[7]*this.y+n[8]*this.z)}};function bw(e,t){let r=e.x,n=e.y,i=e.z,s=gw(t),o=hw(t),a=1-o;return[a*r*r+o,a*r*n+s*i,a*r*i-s*n,a*n*r-s*i,a*n*n+o,a*n*i+s*r,a*i*r+s*n,a*i*n-s*r,a*i*i+o]}var Ht=class{constructor(t,r){this.min=t;this.max=r}get width(){return this.max-this.min}};var{abs:Xd}=Math,{EPSILON:Wd}=Number;function d1(e,t,r,n,i,s){if(i==0)return{x:t.min,y:r.min,z:n.min};if(s==0)return{x:t.max,y:r.max,z:n.max};let o=0,a=0,u=1,l=i,c=s;for(let f=0;f<=15&&!(Xd(c/l)<Wd||Xd(l/c)<Wd);f++){let d=a-(u-a)*l/(c-l),m=ki(t,d),y=ki(r,d),g=ki(n,d),h=e(m,y,g);if(isNaN(h))return;h*l>0?(a=d,l=h):(u=d,c=h);let P=d-o;if(o=d,Xd(P)<o*Wd||h==0)return{x:ki(t,o),y:ki(r,o),z:ki(n,o)}}let p=l<0?u-a:a-u;o=l<0?a:u;for(let f=0;f<52;f++){p*=.5;let d=o+p,m=ki(t,d),y=ki(r,d),g=ki(n,d),h=e(m,y,g);if(isNaN(h))return;if(h<=0&&(o=d),Xd(p)<o*Wd||h==0)break}return{x:ki(t,o),y:ki(r,o),z:ki(n,o)}}function ki(e,t){return e.min+t*e.width}var m1=80,jd=30;function Hs(e,t,r,n,i,s){let o=i,a=r.width/(o-1),u=n.width/(o-1),l=a/1e3,c=u/1e3,p=Array(o*o),f=Array(3*o*o),d=Array(3*o*o),m=Array(2*o*o),y=Array(s*o*o),g=[];var h=!0;let P=(t.xmin+t.xmax)/2,S=(t.ymin+t.ymax)/2,A=(t.zmin+t.zmax)/2;for(let R=0;R<o*o;R++)p[R]=!1;for(let R=0;R<o*o;R++)f[3*R+0]=P,f[3*R+1]=S,f[3*R+2]=A;for(let R=0;R<3*o*o;R++)d[R]=0;for(let R=0;R<o;R++)for(let L=0;L<o;L++){let w=R*o+L,X=r.min+R*a,H=n.min+L*u,Z=e(X,H),[K,J,ce]=Z,ge=isFinite(K)&&isFinite(J)&&isFinite(ce);p[w]=ge,m[2*w+0]=X,m[2*w+1]=H;for(let ie=0;ie<s;ie++)y[s*w+ie]=Z[3+ie];if(ge){f[3*w+0]=K,f[3*w+1]=J,f[3*w+2]=ce;let[ie,W,_e]=e(X+l,H),[et,Ct,Jt]=e(X,H+c);ie-=K,W-=J,_e-=ce,et-=K,Ct-=J,Jt-=ce;let Lr=W*Jt-_e*Ct,un=_e*et-ie*Jt,xn=ie*Ct-W*et,yr=Math.sqrt(Lr*Lr+un*un+xn*xn),Lt=Lr/yr,de=un/yr,Bt=xn/yr;Zd(Lt,de,Bt)?(d[3*w+0]=Lt,d[3*w+1]=de,d[3*w+2]=Bt):h=!1}}function T(R,L,w){let X=L*o+w;p[X]&&(R.x=f[3*X+0],R.y=f[3*X+1],R.z=f[3*X+2])}function I(R,L){return R>=0&&R<o&&L>=0&&L<o&&p[R*o+L]}if(!h)for(let R=0;R<o;R++)for(let L=0;L<o;L++){let w=R*o+L,X=new Vt(d[3*w+0],d[3*w+1],d[3*w+2]);if(p[w]&&X.isZero()){let H=new Vt(f[3*w+0],f[3*w+1],f[3*w+2]);var E=H.clone(),v=H.clone(),D=1;R<o-1&&(I(R+1,L)||I(R+1,L+1)||I(R+1,L-1))?(T(E,R+1,L),H.equals(E)&&L<o-1&&T(E,R+1,L+1),H.equals(E)&&L>0&&T(E,R+1,L-1),D=1):R>0&&(T(E,R-1,L),H.equals(E)&&L<o-1&&T(E,R-1,L+1),H.equals(E)&&L>0&&T(E,R-1,L-1),D=-1),L<o-1&&(I(R,L+1)||I(R+1,L+1)||I(R-1,L+1))?(T(v,R,L+1),H.equals(v)&&R<o-1&&T(v,R+1,L+1),H.equals(v)&&R>0&&T(v,R-1,L+1)):L>0&&(T(v,R,L-1),H.equals(v)&&R<o-1&&T(v,R+1,L-1),H.equals(v)&&R>0&&T(v,R-1,L-1),D*=-1);let Z=((H.z-E.z)*(v.y-H.y)-(H.y-E.y)*(v.z-H.z))*D,K=((H.x-E.x)*(v.z-H.z)-(H.z-E.z)*(v.x-H.x))*D,J=((H.y-E.y)*(v.x-H.x)-(H.x-E.x)*(v.y-H.y))*D;Zd(Z,K,J)&&(d[3*w+0]=Z,d[3*w+1]=K,d[3*w+2]=J)}}for(let R=0;R<o-1;R++)for(let L=0;L<o-1;L++){let w=R*o+L,X=R*o+L+1,H=(R+1)*o+L,Z=(R+1)*o+L+1,K=p[w],J=p[X],ce=p[H],ge=p[Z];K&&ge&&J&&g.push(w,Z,X),K&&ce&&ge&&g.push(w,H,Z),K&&J&&ce&&!ge&&g.push(w,H,X),J&&ce&&ge&&!K&&g.push(X,H,Z)}return{positions:f,normals:d,faces:g,uvs:m,extraAttrs:y}}function Zd(e,t,r){e=Math.fround(e),t=Math.fround(t),r=Math.fround(r);let n=Math.fround(e*e+t*t+r*r);return isFinite(n)&&n!=0}var y1=50;function $x(e=0,t=0,r=0){return{edge0:e,edge1:t,edge2:r}}var Pc=[[0,1],[0,2],[0,3],[1,2],[2,3],[0,4],[0,7],[3,7],[4,7],[0,5],[1,5],[4,5],[1,6],[2,6],[5,6],[3,6],[6,7],[4,6],[0,8],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8],[7,8]];function g1(e,t,r,n){let i=new Yx(e,t,new Ht(r.xmin,r.xmax),new Ht(r.ymin,r.ymax),new Ht(r.zmin,r.zmax),n);return i.setupGrids(),i.loopOverUnitCubes()}var Yx=class{constructor(t,r,n,i,s,o){this.cubeVertexValue=new Array(9);this.cubeEdge=new Array(26);this.readEdge=new Array(26);this.edgesWithSurface=new Array(26);this.planeA=[];this.planeB=[];this.planeC=[];this.face=$x();this.i=0;this.j=0;this.k=0;this.p=new Vt;this.normalsAreGood=!0;this.positions=[];this.normals=[];this.triangles=[];this.offset=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]];this.tetrahedronList=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[7,15,16,24,25,21],[11,14,17,24,22,23],[8,16,17,24,22,25]];this.gridsize=o,this.f=t,this.gradient=r,this.x=n,this.y=i,this.z=s,this.size=new Vt(this.x.width/o,this.y.width/o,this.z.width/o),this.sheet=Array((o+1)*(o+1)),this.strip=Array(o+1);for(let a=0;a<(o+1)*(o+1);a++)this.sheet[a]=$x();for(let a=0;a<o+1;a++)this.strip[a]=$x()}loopOverUnitCubes(){this.positions=[],this.normals=[],this.triangles=[];let t=this.gridsize;function r(u,l){return l*(t+1)+u}for(let u=0;u<t;u++){this.k=u,this.computeLatticeVerticesOnPlanes();for(let l=0;l<t;l++){this.j=l;for(let c=0;c<t;c++){this.i=c,this.normalsAreGood=!0;for(let p=0;p<26;p++)this.cubeEdge[p]=0;this.cubeVertexValue[0]=this.planeA[r(c,l)],this.cubeVertexValue[1]=this.planeA[r(c,l+1)],this.cubeVertexValue[2]=this.planeA[r(c+1,l+1)],this.cubeVertexValue[3]=this.planeA[r(c+1,l)],this.cubeVertexValue[4]=this.planeB[r(c,l)],this.cubeVertexValue[5]=this.planeB[r(c,l+1)],this.cubeVertexValue[6]=this.planeB[r(c+1,l+1)],this.cubeVertexValue[7]=this.planeB[r(c+1,l)],this.cubeVertexValue[8]=this.planeC[l*t+c],this.p.set(this.x.min+c*this.size.x,this.y.min+l*this.size.y,this.z.min+u*this.size.z),this.setEdges(),this.saveEdges(),this.generateTriangles()}}}let{x:n,y:i,positions:s,normals:o}=this,a=[];for(let u=0;u<s.length/3;u++)a.push((s[3*u+0]-n.min)/n.width,(s[3*u+1]-i.min)/i.width);return{positions:s,normals:o,faces:this.triangles,uvs:a,extraAttrs:[]}}setupGrids(){let t=this.gridsize;this.cornersGrid=new Jd(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,t+1,t+1,t+1),this.centersGrid=new Jd(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,t,t,t)}computeLatticeVerticesOnPlanes(){this.cornersGrid===void 0||this.centersGrid===void 0||(this.planeA=this.k==0?this.evaluateArray(this.cornersGrid,0):this.planeB,this.planeB=this.evaluateArray(this.cornersGrid,this.k+1),this.planeC=this.evaluateArray(this.centersGrid,this.k))}evaluateArray(t,r){let n=Array(t.numX*t.numY),i=t.z0+r*t.dz;for(let s=0;s<t.numX;s++)for(let o=0;o<t.numY;o++){let a=t.x0+s*t.dx,u=t.y0+o*t.dy;n[o*t.numX+s]=this.f(a,u,i)}return n}setEdges(){let{i:t,j:r,k:n,gridsize:i}=this,s=this.sheet[(t+0)*(i+1)+r+0],o=this.sheet[(t+1)*(i+1)+r+0],a=this.sheet[(t+0)*(i+1)+r+1];for(let u=0;u<26;u++)this.readEdge[u]=!1;if(n>0){this.cubeEdge[0]=s.edge0,this.cubeEdge[1]=s.edge1,this.cubeEdge[2]=s.edge2,this.cubeEdge[3]=a.edge2,this.cubeEdge[4]=o.edge0;for(let u=0;u<=4;u++)this.readEdge[u]=!0}if(r>0){this.cubeEdge[5]=this.strip[t].edge0,this.cubeEdge[6]=this.strip[t].edge1,this.cubeEdge[7]=this.strip[t+1].edge0,this.cubeEdge[8]=this.strip[t].edge2;for(let u=5;u<=8;u++)this.readEdge[u]=!0;n==0&&(this.cubeEdge[2]=s.edge2,this.readEdge[2]=!0)}if(t>0){this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2;for(let u=9;u<=11;u++)this.readEdge[u]=!0;n==0&&(this.cubeEdge[0]=s.edge0,this.readEdge[0]=!0),r==0&&(this.cubeEdge[5]=this.strip[t].edge0,this.readEdge[5]=!0)}for(let u=0;u<26;u++){if(this.readEdge[u])continue;let l=Pc[u],c=this.cubeVertexValue[l[0]],p=this.cubeVertexValue[l[1]];if(c<0&&0<=p||p<0&&0<=c){let f=this.findSurfaceCrossing(u);if(f!==void 0){let[d,m,y,g,h,P]=f;this.positions.push(d,m,y),this.normals.push(g,h,P),this.cubeEdge[u]=this.positions.length/3,g===0&&h===0&&P===0&&(this.normalsAreGood=!1)}}}}saveEdges(){let{i:t,j:r,k:n,gridsize:i}=this;n<i-1&&(this.sheet[(t+0)*(i+1)+r+0].edge0=this.cubeEdge[11],this.sheet[(t+0)*(i+1)+r+0].edge1=this.cubeEdge[17],this.sheet[(t+0)*(i+1)+r+0].edge2=this.cubeEdge[8]),r<i-1&&(this.strip[t].edge0=this.cubeEdge[10],this.strip[t].edge1=this.cubeEdge[12],this.strip[t].edge2=this.cubeEdge[14]),t<i-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),n==0&&(this.sheet[(t+0)*(i+1)+r+1].edge2=this.cubeEdge[3],this.sheet[(t+1)*(i+1)+r+0].edge0=this.cubeEdge[4]),r==0&&(this.strip[t+1].edge0=this.cubeEdge[7]),r==i-1&&(this.sheet[t*(i+1)+i].edge2=this.cubeEdge[14]),t==i-1&&(this.sheet[(i+0)*(i+1)+r].edge0=this.cubeEdge[16],this.strip[i].edge0=this.cubeEdge[13])}cubeVertex(t){return new Vt(this.p.x+this.offset[t][0]*this.size.x,this.p.y+this.offset[t][1]*this.size.y,this.p.z+this.offset[t][2]*this.size.z)}findSurfaceCrossing(t){let r=this.cubeVertex(Pc[t][0]),n=this.cubeVertex(Pc[t][1]),i=d1(this.f,new Ht(r.x,n.x),new Ht(r.y,n.y),new Ht(r.z,n.z),this.cubeVertexValue[Pc[t][0]],this.cubeVertexValue[Pc[t][1]]);if(i===void 0||!(isFinite(i.x)&&isFinite(i.y)&&isFinite(i.z)))return;let[s,o,a]=this.gradient?this.gradient(i.x,i.y,i.z):[this.f(i.x+.1*this.size.x,i.y,i.z),this.f(i.x,i.y+.1*this.size.y,i.z),this.f(i.x,i.y,i.z+.1*this.size.z)];return Zd(s,o,a)||([s,o,a]=[0,0,0]),[i.x,i.y,i.z,s,o,a]}generateTriangles(){for(let i=0;i<12;i++){var t=0;for(let s=0;s<6;s++)this.cubeEdge[this.tetrahedronList[i][s]]!=0&&(this.edgesWithSurface[t]=this.tetrahedronList[i][s],t+=1);if(t>2){let s=this.cubeEdge[this.edgesWithSurface[0]]-1;var r=this.cubeEdge[this.edgesWithSurface[1]]-1,n=this.cubeEdge[this.edgesWithSurface[2]]-1;this.normalsAreGood||this.fixBadNormals(s,r,n),this.checkWindingOrder(s,r,n)&&([r,n]=[n,r]),this.triangles.push(s,r,n)}if(t==4){let s=this.cubeEdge[this.edgesWithSurface[0]]-1;var r=this.cubeEdge[this.edgesWithSurface[2]]-1,n=this.cubeEdge[this.edgesWithSurface[3]]-1;this.normalsAreGood||this.fixBadNormals(s,r,n),this.checkWindingOrder(s,r,n)&&([r,n]=[n,r]),this.triangles.push(s,r,n)}}}isZeroNormal(t){let r=this.normals;return r[3*t]===0&&r[3*t+1]===0&&r[3*t+2]===0}fixBadNormals(t,r,n){this.isZeroNormal(t)&&this.fixNormal(t,t,r,n),this.isZeroNormal(r)&&this.fixNormal(r,t,r,n),this.isZeroNormal(n)&&this.fixNormal(n,t,r,n)}fixNormal(t,r,n,i){let s=this.positions,o=this.normals,a=!this.isZeroNormal(r),u=!this.isZeroNormal(n),l=!this.isZeroNormal(i),c=new Vt(s[3*r],s[3*r+1],s[3*r+2]),p=new Vt(s[3*n],s[3*n+1],s[3*n+2]),f=new Vt(s[3*i],s[3*i+1],s[3*i+2]),d=new Vt(o[3*r],o[3*r+1],o[3*r+2]),m=new Vt(o[3*n],o[3*n+1],o[3*n+2]),y=new Vt(o[3*i],o[3*i+1],o[3*i+2]),g=new Vt().subVectors(f,c),h=new Vt().subVectors(c,p);var P=g.cross(h).normalize();a?P.dot(d)<0&&P.multiply(-1):u?P.dot(m)<0&&P.multiply(-1):l?P.dot(y)<0&&P.multiply(-1):P.dot(c)<0&&P.multiply(-1),P.isFinite()||P.set(0,0,0),o[3*t+0]=P.x,o[3*t+1]=P.y,o[3*t+2]=P.z}checkWindingOrder(t,r,n){let i=this.positions,s=this.normals,o=i[3*n]-i[3*t],a=i[3*n+1]-i[3*t+1],u=i[3*n+2]-i[3*t+2],l=i[3*t]-i[3*r],c=i[3*t+1]-i[3*r+1],p=i[3*t+2]-i[3*r+2],f=a*p-u*c,d=u*l-o*p,m=o*c-a*l,y=s[3*t],g=s[3*t+1],h=s[3*t+2];return f*y+d*g+m*h<0}},Jd=class{constructor(t,r,n,i,s,o,a,u,l){this.x0=t;this.y0=r;this.z0=n;this.dx=i;this.dy=s;this.dz=o;this.numX=a;this.numY=u;this.numZ=l}};var h1=600;function Qd(e,t,r){let n=t.width/(r-1),i=[];for(let s=0;s<r;s++){let o=t.min+s*n,[a,u,l]=e(o);i.push(a,u,l)}return i}function b1(e,t,r){return Qd(n=>{let i=e(n),s=i[0],o=i[1],a=i[2];return[s*fn(o),s*Fr(o),a]},t,r)}function x1(e,t,r){return Qd(n=>{let i=e(n),s=i[0],o=i[1],a=i[2];return[s*Fr(a)*fn(o),s*Fr(a)*Fr(o),s*fn(a)]},t,r)}function T1(e,t){return{type:\"linear\",s:e,t}}function P1(e,t){return{type:\"logarithmic\",s:e,t}}function I1(e,t){return{type:\"exponential\",s:e,t}}function xw([e,t],[r,n]){let i=(n-r)/(t-e),s=(t*r-e*n)/(t-e);return T1(i,s)}function Tw([e,t],[r,n]){let i=(n-r)/(Math.log(t)-Math.log(e)),s=(Math.log(t)*r-Math.log(e)*n)/(Math.log(t)-Math.log(e));return P1(i,s)}function Pw([e,t],[r,n]){let i=(Math.log(n)-Math.log(r))/(t-e),s=(t*Math.log(r)-e*Math.log(n))/(t-e);return I1(i,s)}function Xx(e,t,r){switch(e){case\"linear\":return xw(t,r);case\"logarithmic\":return Tw(t,r);case\"exponential\":return Pw(t,r);default:{let n=e;throw new Error(\"Unexpected scale type: \"+n)}}}function Wx({type:e,s:t,t:r},n){switch(e){case\"linear\":return t*n+r;case\"logarithmic\":return t*Math.log(n)+r;case\"exponential\":return Math.exp(t*n+r);default:let i=e;throw new Error(\"Unexpected scale type: \"+i)}}function Zx(e,t,r,n){switch(e){case\"linear\":return Iw(t,r,n);case\"logarithmic\":return Math.pow(t,1-n)*Math.pow(r,n);case\"exponential\":return n===0?t:n===1?r:Math.log((1-n)*Math.exp(t)+n*Math.exp(r));default:let i=e;throw new Error(\"Unexpected scale type: \"+i)}}function Iw(e,t,r){return(1-r)*e+r*t}function jx({type:e,s:t,t:r}){switch(e){case\"linear\":return T1(1/t,-r/t);case\"logarithmic\":return I1(1/t,-r/t);case\"exponential\":return P1(1/t,-r/t);default:let n=e;throw new Error(\"Unexpected scale type: \"+n)}}function M1({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function E1({xmin:e,xmax:t,ymin:r,ymax:n}){return{left:e,right:t,bottom:r,top:n}}var jo=class{constructor(t,r){this.xScale=t,this.yScale=r}static fromRects(t,r,{xAxisScale:n,yAxisScale:i}){return new jo(Xx(n,[t.left,t.right],[r.left,r.right]),Xx(i,[t.bottom,t.top],[r.bottom,r.top]))}inverse(){return new jo(jx(this.xScale),jx(this.yScale))}mapX(t){return Wx(this.xScale,t)}mapY(t){return Wx(this.yScale,t)}mapPoint({x:t,y:r}){return{x:this.mapX(t),y:this.mapY(r)}}mapCoordinatePair([t,r]){return[this.mapX(t),this.mapY(r)]}mapRect({top:t,bottom:r,left:n,right:i}){return{left:this.mapX(n),right:this.mapX(i),bottom:this.mapY(r),top:this.mapY(t)}}interpolateX(t,r,n){return Zx(this.xScale.type,t,r,n)}interpolateY(t,r,n){return Zx(this.yScale.type,t,r,n)}dangerouslyGetXScaleFactor(){if(this.xScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.xScale.type}' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.yScale.type}' scale`);return this.yScale.s}};var{floor:v1}=Math,O1=1e4;var Ew=0;function gs(){return\"result_\"+Ew++}function vw(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function R1(e){return{graphMode:15,error:e,segments:[]}}function Qx(e,t){let r=e[0]+t.min*e[1],n=e[0]+t.max*e[1],i={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(r)||!isFinite(n))return{segments:[],poi:i,resolved:!0};let s=[[t.min,r,t.max,n]],o=-e[0]/e[1];return!isNaN(o)&&o>=t.min&&o<=t.max&&(i.zeros.x.push(o),i.zeros.y.push(0)),0>=t.min&&0<=t.max&&(i.intercept.x.push(0),i.intercept.y.push(e[0])),{segments:s,poi:i,resolved:!0}}function Ow(e,t){let r=Qx(e[0],t),n=Qx(e[1],t);return r.segments.length&&n.segments.length&&r.segments[0].length===4&&n.segments[0].length===4?{segments:[[r.segments[0][1],n.segments[0][1],r.segments[0][3],n.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function Sw(e,t){let r=e(t);return{segments:[[...r,...r]],resolved:!0}}function S1(e,t,r){let{mappedFn:n,jumpTolerance:i,screen:s}=r,[o,a]=e,[u,l]=t,c=js(o,u),p=n(c),f=s.height;if(!(a<0&&l<0&&(a>=p||l>=p))&&!(a>f&&l>f&&(a<=p||l<=p)))return xu(o,a,c,p,u,l,n,i)}var Jx=(e,t,r)=>{let{fn:n,mappedFn:i,jumpTolerance:s,accumulator:o}=r;if(!isFinite(s)||s<=0)return;let a=S1(e,t,r);if(!a)return;let u=(t[0]-e[0])/10,l=[-u,u],c;for(let p=0;p<l.length;p++){let f=e[0]+l[p],d=i(f);isFinite(d)||([f,d]=e,f=e[0],d=e[1]);let m=t[0]+l[p],y=i(m);if(isFinite(y)?c=m:[m,y]=t,S1([f,d],[m,y],r)){let[g,h]=a;o.addPoint([g,n(g)]),o.breakSegment(),o.addPoint([h,n(h)]);return}}return c},Kx=class{constructor(t,r,n){let i=s=>r.mathToPixels.mapY(t(s));this.derivative=n,this.accumulator=new Tc(r,t,n),this.fn=t,this.mathToPixels=r.mathToPixels,this.mappedFn=i,this.jumpTolerance=r.tolerance||0,this.screen=r.screen}};function D1(e,t,r,n){let i=r,s=e(i),o=t.mapY(s);return isFinite(o)||(i=r+n,s=e(i),o=t.mapY(s)),isFinite(o)||(i=r-n,s=e(i),o=t.mapY(s)),[i,s,o]}function tT(e,t,r){let n=new Kx(e,t,r),{mathToPixels:i,mappedFn:s}=n,o=t.nInitialSamples,a=Math.abs(i.interpolateX(t.min,t.max,1/(o-1))-t.min)/10,[u,l,c]=D1(e,i,t.min,a);isFinite(c)&&n.accumulator.addPoint([u,l]);for(var p=1;p<o;p++){let f=i.interpolateX(t.min,t.max,p/(o-1)),d=Math.abs(u-f)/10,[m,y,g]=D1(e,i,f,d);if(isFinite(g)&&isFinite(c)){let h=Jx([u,c],[m,g],n);h!==void 0&&(m=h,y=e(m),g=i.mapY(y)),n.accumulator.addPoint([m,y])}else if(isFinite(g)&&!isFinite(c)){let h=hi(u,c,m,g,s);if(h!==void 0){h!==m&&n.accumulator.addPoint([h,e(h)]);let P=Jx([h,s(h)],[m,g],n);P!==void 0&&(m=P,y=e(m),g=i.mapY(y)),n.accumulator.addPoint([m,y])}}else if(!isFinite(g)&&isFinite(c)){let h=hi(u,c,m,g,s);if(h!==void 0){let P=Jx([u,c],[h,s(h)],n);P!==void 0&&(h=P),h!==u&&n.accumulator.addPoint([h,e(h)]),n.accumulator.breakSegment()}}u=m,l=y,c=g}return n.accumulator.finish()}function Dw(e){let{fn:t,min:r,max:n}=e,i=Math.floor(r),s=Math.ceil(n),o=!0;s-i+1>O1&&(s=i+(O1-1),o=!1);let a=[];for(let u=i;u<=s;u++){let l=t(u);!isFinite(u)||!isFinite(l)||a.push([u,l])}return{segments:a,resolved:o}}function Nw(e,t,r,n){let i=t.min,s=t.max-t.min,o=t.rtoleranceMath,a=Math.floor(s/(Math.PI/r)),u,l,c;function p(f,d){let m=d%2===0?1:-1;if(!n&&m===-1)return!1;let y=d*(Math.PI/r),g=[i,i+1,i+2,i+3],h=!1;for(let P=0,S=g.length;P<S;P++){let A=f(g[P]),T=f(g[P]+y);if(isFinite(A)&&isFinite(T)&&(h=!0),isFinite(A)!==isFinite(T)||Math.abs(A-m*T)>o)return!1}return!!h}for(u=1;u<=a;u++)if(p(e,u)){for(c=u,l=2;l*u<=a;l++)p(e,l*u)||(c=void 0);if(c)break}return c?c*(Math.PI/r):null}function C1(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function N1(e,t){if(t.max<t.min)return{segments:[],resolved:!0};let{xtolerance:r,ytolerance:n,ztolerance:i,map:s}=t,o=new po({xtolerance:r,ytolerance:n,ztolerance:i,map:s}),a=10,u=t.min,l=e(u);isFinite(l[0])&&isFinite(l[1])&&o.addPoint(l);let c=t.nInitialSamples;for(let p=1;p<c;p++){let f=p/(c-1),d=(1-f)*t.min+f*t.max,m=e(d);Ic(e,u,l,d,m,a,o,t.screen),u=d,l=m}return o.finish()}function Aw(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Ic(e,t,r,n,i,s,o,a){if(n===t)return;let{xtolerance:u,ytolerance:l,ztolerance:c,map:p}=o,f=js(t,n),d=e(f),m=p(r),y=p(i),g=p(d),h=isFinite(m[0])&&isFinite(m[1])&&(m.length===2||isFinite(m[2])),P=isFinite(y[0])&&isFinite(y[1])&&(y.length===2||isFinite(y[2])),S=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2]));if(s===0||f===t||f===n){o.breakSegment(),P&&o.addPoint(i);return}if(!(!h&&!P)){if(h!==P){let A=t,T=n,I=r,E=i;for(;t!==f&&f!==n;)S==h?(t=f,r=d,m=g,h=S):(n=f,i=d,y=g,P=S),f=t+(n-t)/2,d=e(f),g=p(d),S=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2]));h?(Ic(e,A,I,t,r,s-1,o,a),o.breakSegment()):(o.breakSegment(),o.addPoint(i),Ic(e,n,i,T,E,s-1,o,a));return}if(h&&S&&P){let A=Aw(m,y),T=Ji(g[0],g[1],g[2]||0,m[0],m[1],m[2]||0,y[0],y[1],y[2]||0),I=T>.2&&T<.8&&Math.abs(g[0]-(m[0]+T*(y[0]-m[0])))<=u&&Math.abs(g[1]-(m[1]+T*(y[1]-m[1])))<=l&&(m.length===2||Math.abs(g[2]-(m[2]+T*(y[2]-m[2])))<=c);if(A||I||a&&Rw(m,g,y,a)){o.addPoint(i);return}}Ic(e,t,r,f,d,s-1,o,a),Ic(e,f,d,n,i,s-1,o,a)}}function Rw(e,t,r,{width:n,height:i}){return e[0]<0&&r[0]<0&&(e[0]>=t[0]||r[0]>=t[0])||e[0]>n&&r[0]>n&&(e[0]<=t[0]||r[0]<=t[0])||e[1]<0&&r[1]<0&&(e[1]>=t[1]||r[1]>=t[1])||e[1]>i&&r[1]>i&&(e[1]<=t[1]||r[1]<=t[1])}function Cw(){return bs({positions:[],normals:[],faces:[],uvs:[],extraAttrs:[]})}function Lw(e,t,r,n){let i=g1(e.fn,t,r,n);return bs(i)}function ww(e,t,r,n,i){let s=Hs(e.fn,t,r,n,i,0);return bs(s)}function _w(e,t,r,n,i){let s=e.fn,o=Hs((a,u)=>{let[l,c,p]=s(a,u);return[l*fn(c),l*Fr(c),p,l,c]},t,r,n,i,2);return bs(o)}function Fw(e,t,r,n,i){let s=e.fn,o=Hs((a,u)=>{let[l,c,p]=s(a,u);return[l*Fr(p)*fn(c),l*Fr(p)*Fr(c),l*fn(p),l,c,p]},t,r,n,i,3);return bs(o)}function Vw(e,t,r){let n=e.fn,i=Hs((s,o)=>[s,o,n(s,o)],t,new Ht(t.xmin,t.xmax),new Ht(t.ymin,t.ymax),r,0);return bs(i)}function Bw(e,t,r){let n=e.fn,i=Hs((s,o)=>[n(s,o),s,o],t,new Ht(t.ymin,t.ymax),new Ht(t.zmin,t.zmax),r,0);return bs(i)}function Gw(e,t,r){let n=e.fn,i=Hs((s,o)=>[s,n(s,o),o],t,new Ht(t.xmin,t.xmax),new Ht(t.zmin,t.zmax),r,0);return bs(i)}function zw(e,t,r,n,i){let s=e.fn,o=Hs((a,u)=>[a*fn(u),a*Fr(u),s(a,u)],t,r,n,i,0);return bs(o)}function qw(e,t,r,n,i){let s=e.fn,o=Hs((a,u)=>{let l=s(a,u);return[l*fn(a),l*Fr(a),u,l]},t,r,n,i,1);return bs(o)}function Uw(e,t,r,n,i){let s=e.fn,o=Hs((a,u)=>{let l=s(a,u);return[l*Fr(u)*fn(a),l*Fr(u)*Fr(a),l*fn(u),l]},t,r,n,i,1);return bs(o)}function bs(e){let{positions:t,normals:r,faces:n,uvs:i,extraAttrs:s}=e;return{guid:gs(),positions:new Float32Array(t),normals:new Float32Array(r),faces:new Uint32Array(n),uvs:new Float32Array(i),extraAttrs:new Float32Array(s)}}function A1(e){for(let t of e)if(t!==0)return!1;return!0}function L1(e,t){let{min:r,max:n,mathToPixels:i,nInitialSamples:s}=t,o=i.interpolateX(r,n,0),a=e(o),u=A1(a),l=!1,c=[];for(var p=1;p<s;p++){let f=i.interpolateX(r,n,p/(s-1)),d=e(f),m=A1(d);if(u){o=f,a=d,m||(u=!1);continue}if(m){l?(u=!0,l=!1):l=!0;continue}let y=TI(o,a,f,d,e);y!==void 0&&c.push(y),o=f,a=d}return c}function w1(e){if(!e)return!1;let t=e.viewport.xmin,r=e.viewport.xmax,n=e.viewport.ymin,i=e.viewport.ymax;return!(!isFinite(t)||!isFinite(r)||r<=t||!isFinite(n)||!isFinite(i)||i<=n||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)}function Hw(e,t){let r=t-e;return 1+Math.ceil(r/(r/1e3))}function $u(e,t,r){var L,w,X,H,Z,K,J;let{viewport:n,screen:i,xAxisScale:s,yAxisScale:o}=e,a=e.viewport.xmin,u=e.viewport.xmax,l=e.viewport.ymin,c=e.viewport.ymax,p=(L=e.viewport.zmin)!=null?L:-2,f=(w=e.viewport.zmax)!=null?w:2,d=((X=t.domain)==null?void 0:X.type)===\"2d\",{uMin:m,uMax:y,vMin:g,vMax:h}=((H=t.domain)==null?void 0:H.type)===\"2d\"?t.domain:{uMin:0,uMax:1,vMin:0,vMax:1};var P=t.lineWidth;if(t.willConvertTo3D||P>3){let ce=t.willConvertTo3D?200:e.screen.width;var S=P*(u-a)/ce;let ge=t.willConvertTo3D?200:e.screen.height;var A=P*(c-l)/ge;a-=S,u+=S,l-=A,c+=A}let I=1/4,E=t.domainBound,v,D=jo.fromRects(E1(n),M1(i),{xAxisScale:s,yAxisScale:o}),R={xmin:a,xmax:u,ymin:l,ymax:c,zmin:p,zmax:f};switch(t.graphMode){case 1:switch(v=ln(Zn([l,c]),E),v.type){case\"empty\":return!1;case\"known\":l=v.bounds[0],c=v.bounds[1]}let ce=1+Math.ceil(Math.abs(D.mapY(c)-D.mapY(l))/I),ge=new jo(D.yScale,D.xScale);return{min:l,max:c,tolerance:I,nInitialSamples:ce,mathToPixels:ge,screen:{width:i.height,height:i.width}};case 2:{switch(v=ln(Zn([a,u]),E),v.type){case\"empty\":return!1;case\"known\":a=v.bounds[0],u=v.bounds[1]}let ie=1+Math.ceil(Math.abs(D.mapX(u)-D.mapX(a))/I);return{min:a,max:u,tolerance:I,nInitialSamples:ie,mathToPixels:D,screen:i}}case 6:{let ie=e.degreeMode?Math.PI/180:1;if(((Z=t.domain)==null?void 0:Z.type)!==\"1d\")throw new Error(\"Expected polar graph to have domain\");let{min:W,max:_e}=t.domain;switch(v=ln(Zn([W,_e]),E),v.type){case\"empty\":return!1;case\"known\":W=v.bounds[0],_e=v.bounds[1]}let et=1+Math.min(Math.ceil(ie*Math.abs(_e-W)/(2*Math.PI)*1e3),12e3),Ct=Math.abs(D.mapX(u)-D.mapX(a)),Jt=Math.abs(D.mapY(c)-D.mapY(l)),Lr=Math.hypot(Ct,Jt),xn=Math.hypot(u-a,c-l)/Lr,yr={min:W,max:_e,screen:i,nInitialSamples:et,xtolerance:I,ytolerance:I,rtoleranceMath:xn,map:([Lt,de])=>D.mapCoordinatePair(C1([Lt,de]))};if(!t.domain.isExplicit){let Lt=Nw(r,yr,ie,t.operator===\"=\");Lt&&(yr.max=yr.min+Lt,yr.nInitialSamples=1+Math.min(Math.ceil(ie*Math.abs(yr.max-yr.min)/(2*Math.PI)*1e3),12e3))}return yr}case 5:case 100:case 101:case 102:{let ie={min:0,max:1},{min:W,max:_e}=((K=t.domain)==null?void 0:K.type)===\"1d\"?t.domain:ie;switch(v=ln(Zn([W,_e]),E),v.type){case\"empty\":return!1;case\"known\":W=v.bounds[0],_e=v.bounds[1]}return{min:W,max:_e,screen:i,nInitialSamples:Hw(W,_e),xtolerance:I,ytolerance:I,ztolerance:I,map:([et,Ct])=>D.mapCoordinatePair([et,Ct])}}case 8:return{xmin:a,xmax:u,ymin:l,ymax:c,mathToPixels:D,tolerance:I};case 106:return se($({},R),{u:new Ht(a,u),v:new Ht(l,c)});case 119:case 121:case 107:return se($({},R),{u:new Ht(l,c),v:new Ht(p,f)});case 120:case 122:case 108:return se($({},R),{u:new Ht(a,u),v:new Ht(p,f)});case 109:return se($({},R),{u:new Ht(m,d?y:Math.max(a,u,l,c)),v:new Ht(g,d?h:2*Math.PI)});case 123:case 110:{let{min:ie,max:W}=((J=t.domain)==null?void 0:J.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return se($({},R),{u:new Ht(ie,W),v:new Ht(p,f)})}case 124:case 111:return se($({},R),{u:new Ht(m,d?y:2*Math.PI),v:new Ht(g,d?h:Math.PI)});case 116:case 117:case 118:case 103:case 104:case 105:case 112:case 125:case 113:case 114:case 115:return se($({},R),{u:new Ht(m,y),v:new Ht(g,h)});default:return!1}}function Kd(e){let{viewState:t,graphInfo:r,compiled:n,maxOverride:i,showPoint:s}=e,o=n.fn,a=$u(t,r,o),u;a||(u={segments:[],resolved:!0});let{min:l,max:c}=a;u=Dw({fn:o,min:Math.max(l,0),max:i!==void 0?Math.min(i,c):c});let{points:p,droppedIndices:f}=Mc(u.segments);return{segments:[p],droppedIndices:f,graphMode:3,color:r.color,style:r.pointStyle,poi:Hi(u.segments),showPoint:s}}function kw(e){switch(e){case 119:case 121:return 107;case 120:case 122:return 108;case 123:return 110;case 124:return 111;case 125:return 112;default:return e}}function fo(e){var m,y,g,h;let{viewState:t,graphInfo:r,compiled:n,derivative:i}=e,s=n.fn,o=$u(t,r,s),a,u,l,c=kw(r.graphMode),p=t.xAxisScale===\"linear\"&&t.yAxisScale===\"linear\";if(!o)a={segments:[],resolved:!0};else{switch(c){case 1:case 2:let P=i?i.fn:void 0;a=r.isLinear&&p&&ls(r.linearCoefficients)?Qx(r.linearCoefficients,o):tT(s,o,P);break;case 6:a=N1(R=>[R,s(R)],o);break;case 8:a=l1(s,o);break;case 5:o.max===o.min?a=Sw(s,o.min):a=r.isLinear&&p&&ls(r.linearCoefficients)?Ow(r.linearCoefficients,o):N1(s,o);break;case 113:{var f=n.fn;let R=f();return{graphMode:113,position:R,radius:.02*r.lineWidth,guid:gs(),color:r.color}}case 114:{var f=n.fn;let L=f(),w=L[0],X=L[1],H=L[2];return{graphMode:113,position:[w*fn(X),w*Fr(X),H],radius:.02*r.lineWidth,guid:gs(),color:r.color}}case 115:{var f=n.fn;let L=f(),w=L[0],X=L[1],H=L[2];return{graphMode:113,position:[w*Fr(H)*fn(X),w*Fr(H)*Fr(X),w*fn(H)],radius:.02*r.lineWidth,guid:gs(),color:r.color}}case 100:case 101:case 102:let{min:S,max:A}=((m=r.domain)==null?void 0:m.type)===\"1d\"?r.domain:{min:0,max:1},T=new Ht(S,A),I=r.resolution,E=h1,v=I===void 0||isNaN(I)?E:nn(v1(I),2,2e3),D=[];switch(c){case 100:D=Qd(n.fn,T,v);break;case 101:D=b1(n.fn,T,v);break;case 102:D=x1(n.fn,T,v);break}return{graphMode:100,guid:gs(),points:D,color:r.color,thickness:r.lineWidth};case 112:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:{let R=o,{u:L,v:w}=R,X=c===112?y1:m1,H=r.resolution,Z=H===void 0||isNaN(H)?X:nn(v1(H),2,100),K=Zn([L.min,L.max]).type!==\"empty\"&&Zn([w.min,w.max]).type!==\"empty\",J;switch(K&&c){case 103:J=ww(n,R,L,w,Z);break;case 104:J=_w(n,R,L,w,Z);break;case 105:J=Fw(n,R,L,w,Z);break;case 106:J=Vw(n,R,Z);break;case 107:J=Bw(n,R,Z);break;case 108:J=Gw(n,R,Z);break;case 109:J=zw(n,R,L,w,Z);break;case 110:J=qw(n,R,L,w,Z);break;case 111:J=Uw(n,R,L,w,Z);break;case 112:J=Lw(n,e.gradient,o,Z);break;case!1:J=Cw();break}return{meshData:J,color:r.color,uvRange:[L,w],uvArgs:(y=Ec[r.graphMode])!=null?y:[],extraMeshArgs:(g=rT[r.graphMode])!=null?g:[],checkers:(h=r.checkers)!=null?h:jd,graphMode:c,compiled:n,restrictionShader:e.restrictionShader3d}}default:throw new Error(\"Programming Error: unexpected graphmode \"+c)}l=a.poi}if((!l||l.zeros.x.length+l.extrema.x.length+l.intercept.x.length>250)&&(l=vw()),c===1)for(let P in l){if(!l.hasOwnProperty(P))continue;let S=P;u=l[S].y,l[S].y=l[S].x,l[S].x=u}let d={segments:a.segments,resolved:a.resolved,graphMode:c,color:r.color,style:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,poi:l,compiled:n};if(c===6){let P=o;d.sampledDomain={min:P.min,max:P.max}}return a.fillSegments&&(d.fillSegments=a.fillSegments),d}function $w(e,t,r){let n,i,s,o,a=[],u=null;switch(r){case 6:u=C1;break;case 1:u=function(l){return[l[1],l[0]]};break}for(n=0;n<e.length;n++)for(o=e[n],i=0;i<o.length;i+=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);for(n=t.length-1;n>=0;n--)for(o=t[n],i=o.length-2;i>=0;i-=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);return a}function em(e,t,r){let n=p=>{let f=p[p.length-1];return f[f.length-2]},i=[],s=0,o=0,a=[],u=[],l=-1/0,c=-1/0;for(;;){if(l<=c){if(s>=t.length)break;u.push(t[s++])}if(c<=l){if(o>=e.length)break;a.push(e[o++])}if(l=n(u),c=n(a),cn(l,c,4)){i.push($w(a,u,r)),u=[],a=[];let p=Math.max(l,c);l=p,c=p}}return i}function Mc(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],[s,o]=i;!isNaN(s)&&!isNaN(o)?t.push(i):r[n]=!0}return{points:t,droppedIndices:r}}var Ec={[8]:[\"x\",\"y\"],[106]:[\"x\",\"y\"],[119]:[\"y\",\"z\"],[121]:[\"y\",\"z\"],[107]:[\"y\",\"z\"],[120]:[\"x\",\"z\"],[122]:[\"x\",\"z\"],[108]:[\"x\",\"z\"],[109]:[\"r\",\"theta\"],[123]:[\"theta\",\"z\"],[110]:[\"theta\",\"z\"],[124]:[\"theta\",\"phi\"],[111]:[\"theta\",\"phi\"],[103]:[\"u\",\"v\"],[104]:[\"u\",\"v\"],[105]:[\"u\",\"v\"],[125]:[\"x\",\"y\"],[112]:[\"x\",\"y\",\"z\"]},rT={[110]:[\"r\"],[111]:[\"r\"],[104]:[\"r\",\"theta\"],[105]:[\"r\",\"theta\",\"phi\"]};function Yw(e){return!e||e[0].type===\"none\"&&e[1].type===\"none\"?\"NONE\":e[1].type===\"none\"?\"X\":e[0].type===\"none\"?\"Y\":\"XY\"}function _1(e,t){var r=Yw(t);switch(e){case\"NONE\":return\"NONE\";case\"AUTO\":return r;case\"XY\":return r;case\"X\":return r===\"X\"||r===\"XY\"?\"X\":\"NONE\";case\"Y\":return r===\"Y\"||r===\"XY\"?\"Y\":\"NONE\";default:return\"NONE\"}}var Xw={X_OR_Y:{points:!1,lines:!0,fill:!1,surfaces:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1,surfaces:!1},POINT_LIST:{points:!0,lines:!1,fill:!1,surfaces:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1,surfaces:!1},POLAR:{points:!1,lines:!0,fill:!1,surfaces:!1},IMPLICIT:{points:!1,lines:!0,fill:!1,surfaces:!1},POLYGON:{points:!1,lines:!0,fill:!0,surfaces:!1},HISTOGRAM:{points:!1,lines:!0,fill:!0,surfaces:!1},DOTPLOT:{points:!0,lines:!1,fill:!1,surfaces:!1},BOXPLOT:{points:!1,lines:!0,fill:!1,surfaces:!1},TTEST:{points:!1,lines:!1,fill:!1,surfaces:!1},STATS:{points:!1,lines:!1,fill:!1,surfaces:!1},POINT3D:{points:!0,lines:!1,fill:!1,surfaces:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1,surfaces:!1},SURFACE_xyz_uv:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_z_r\\u03B8:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_r_\\u03B8z:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_r_\\u03B8\\u03C6:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_r_\\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1,surfaces:!1},SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE:{points:!1,lines:!1,fill:!1,surfaces:!0},TRIANGLE3D:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1,surfaces:!1},SURFACE_CONSTANT_AMBIGUOUS:{points:!1,lines:!1,fill:!1,surfaces:!0},IMPLICIT_SURFACE:{points:!1,lines:!1,fill:!1,surfaces:!0},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1,surfaces:!1}};function F1(e,t){var n,i,s,o,a,u,l,c,p;if(e===void 0)return{points:!1,lines:!1,fill:!1,surfaces:!1};let r=Xw[e];switch(e){case\"SINGLE_POINT\":return{points:!0,lines:!1,fill:!1,surfaces:!1};case\"POINT_LIST\":case\"DOTPLOT\":return{points:(n=t.points)!=null?n:r.points,lines:(i=t.lines)!=null?i:r.lines,fill:!1,surfaces:!1};case\"POINT3D\":return{points:(s=t.points)!=null?s:r.points,lines:!1,fill:!1,surfaces:!1};case\"PARAMETRIC\":case\"POLYGON\":case\"X_OR_Y\":case\"POLAR\":case\"IMPLICIT\":case\"HISTOGRAM\":case\"BOXPLOT\":case\"TTEST\":case\"STATS\":case\"CURVE3D_xyz_t\":return{points:!1,lines:(o=t.lines)!=null?o:r.lines,fill:(a=t.fill)!=null?a:r.fill,surfaces:(u=t.surfaces)!=null?u:r.surfaces};case\"TRIANGLE3D\":case\"SURFACE\":case\"SURFACE_r_\\u03B8z\":case\"SURFACE_z_r\\u03B8\":case\"SURFACE_r_\\u03B8\\u03C6\":case\"SURFACE_xyz_uv\":case\"IMPLICIT_SURFACE\":return{points:!1,lines:!1,fill:!1,surfaces:(l=t.surfaces)!=null?l:r.surfaces};case\"SURFACE_AMBIGUOUS\":case\"SURFACE_CONSTANT_AMBIGUOUS\":case\"SURFACE_r_\\u03B8z_AMBIGUOUS\":case\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\":case\"IMPLICIT_SURFACE_AMBIGUOUS\":return{points:!1,lines:(c=t.lines)!=null?c:r.lines,fill:!1,surfaces:(p=t.surfaces)!=null?p:r.surfaces};default:return e}}function V1(e){if(e===void 0)return!1;switch(e){case\"SINGLE_POINT\":case\"POINT_LIST\":case\"PARAMETRIC\":case\"POLYGON\":case\"X_OR_Y\":case\"POLAR\":case\"SURFACE\":case\"SURFACE_AMBIGUOUS\":case\"SURFACE_CONSTANT_AMBIGUOUS\":case\"SURFACE_r_\\u03B8z\":case\"SURFACE_r_\\u03B8z_AMBIGUOUS\":case\"SURFACE_z_r\\u03B8\":case\"SURFACE_r_\\u03B8\\u03C6\":case\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\":case\"SURFACE_xyz_uv\":case\"IMPLICIT_SURFACE\":case\"IMPLICIT_SURFACE_AMBIGUOUS\":case\"CURVE3D_xyz_t\":case\"IMPLICIT\":case\"POINT3D\":case\"TRIANGLE3D\":return!0;case\"HISTOGRAM\":case\"BOXPLOT\":case\"DOTPLOT\":case\"TTEST\":case\"STATS\":return!1;default:return e}}var Ww=(e,t)=>{let r=e.segments[0],n=t.segments[0],i=[[...r,...n]];return se($({},e),{segments:i})};function Zw(e){let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,o=qi(r),a=ln(r.domainBound,Zn(s));if(a.type===\"known\")return o.domainBound=a,o.lineStyle=\"SOLID\",fo({graphInfo:o,viewState:t,compiled:n,derivative:i})}function Jo(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,included:s,showPoint:o}=e,a=qi(r),u=ln(r.domainBound,Zn(i));if(u.type===\"known\")return a.domainBound=u,a.pointStyle=s?\"POINT\":\"OPEN\",Kd({graphInfo:a,viewState:t,compiled:n,showPoint:o,maxOverride:void 0})}function z1(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,maxOverride:s,showPoint:o}=e,[a,u]=i,l=[],c;a=Math.ceil(a),u=Math.floor(u);let p=s!==void 0?s:1/0;if(a===-1/0&&u>=p)c=Jo({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),l.push(c);else if(a===-1/0&&u<1/0)c=Jo({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),l.push(c),l.push(Jo({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}));else if(a>-1/0&&u>=p)c=Jo({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),l.push(Jo({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o})),l.push(c);else{c=Jo({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o});let f=Jo({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}),d=Jo({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o});l.push(c);let m;f&&d&&(m=Ww(f,d),l.push(m))}return{cdfTopBranch:c,topBranches:l}}var q1=e=>{let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,[o,a]=s,u=Zw({bounds:[o,a],viewState:t,graphInfo:r,compiled:n,derivative:i}),l=[fo({viewState:t,graphInfo:r,compiled:n,derivative:i})];return{cdfTopBranch:u,topBranches:l}};function L6(e){switch(e){case\"LOOP_FORWARD\":return\"dcg-icon-arrow-one-way\";case\"LOOP_FORWARD_REVERSE\":return\"dcg-icon-arrow-two-way\";case\"PLAY_ONCE\":return\"dcg-icon-arrow-once\";case\"PLAY_INDEFINITELY\":return\"dcg-icon-arrow-infinite\"}}function vc(e,t){let r={};for(let n in t)t.hasOwnProperty(n)&&(Po(e[n],t[n])||(r[n]=t[n]));return r}function rm(e,t){let r,n={};for(let i in t)t.hasOwnProperty(i)&&(Po(e[i],t[i])||(n[i]=t[i],r=n));return r}function V6(e,t){t||(t={});let r={};for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(r[n]=qi(e[n]));for(let n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function G6({from:e,to:t,props:r}){for(var n in r)r[n]&&e.hasOwnProperty(n)&&(t[n]=qi(e[n]))}function z6(e,t){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function H1(e,t){let r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=e[n]);return r}function q6(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}var jw=(n=>(n.NONE=\"NONE\",n.POSITIVE=\"POSITIVE\",n.BOTH=\"BOTH\",n))(jw||{});var k1={collapsed:!1,hidden:!1,secret:!1,readonly:!1,title:\"\"};function k6(e){return $($({},k1),e)}function $6(e){return vc(k1,e)}var $1=\"**dcg_geo_folder**\";var iT={show:!1,min:\"\",max:\"\"},sT={breadth:\"\",axisOffset:\"\",alignedAxis:\"x\",showBoxplotOutliers:!0,binAlignment:\"center\",dotplotXMode:\"exact\",histogramMode:\"\"},oT={enabled:!1,latex:\"\"};var Jw=4e3,nm={polarDomain:{min:\"\",max:\"\"},parametricDomain:{min:\"\",max:\"\"},parametricDomain3Du:{min:\"\",max:\"\"},parametricDomain3Dv:{min:\"\",max:\"\"},cdf:iT,colorLatex:\"\",description:\"\",fillOpacity:\"\",lineOpacity:\"\",pointOpacity:\"\",pointSize:\"\",lineWidth:\"\",resolution:\"\",checkers:\"\",polarCoordinateSystem:\"\",labelAngle:\"\",vizProps:sT,clickableInfo:oT},Y1=se($({folderId:\"\",latex:\"\",color:\"\",showLabel:!1,showAngleLabel:!0,label:\"\",hidden:!1,secret:!1,readonly:!1,dragMode:\"AUTO\",labelSize:\"\",labelOrientation:\"default\",suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:\"NONE\",residualVariable:\"\",isLogModeRegression:!1,pointStyle:\"POINT\",lineStyle:\"SOLID\",arrowMode:\"DEFAULT\",regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1},nm),{points:void 0,lines:void 0,fill:void 0,surfaces:void 0}),X1={hardMin:!1,hardMax:!1,animationPeriod:Jw,loopMode:\"LOOP_FORWARD_REVERSE\",playDirection:1,isPlaying:!1,min:\"-10\",max:\"10\",step:\"\"};function i7(e){return se($($({},Y1),e),{slider:$($({},X1),e.slider),cdf:$($({},iT),e.cdf),vizProps:$($({},sT),e.vizProps),clickableInfo:$($({},oT),e.clickableInfo)})}function s7(e){var t=vc(Y1,se($({},e),{slider:vc(X1,e.slider)})),r=rm(iT,e.cdf);r===void 0?delete t.cdf:t.cdf=r;var n=rm(sT,e.vizProps);n===void 0?delete t.vizProps:t.vizProps=n;var i=rm(oT,e.clickableInfo);return i===void 0?delete t.clickableInfo:t.clickableInfo=i,t}function Qw(e){return H1(e,nm)}function o7(e,t){for(var r in nm)if(nm.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0}function a7(e){return $({type:\"statement\",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,surfaces:e.surfaces,pointStyle:e.pointStyle,lineStyle:e.lineStyle,arrowMode:e.arrowMode,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,showAngleLabel:e.showAngleLabel,shouldGraph:e.hidden,slider:{min:e.slider.hardMin?e.slider.min:\"\",max:e.slider.hardMax?e.slider.max:\"\",softMin:e.slider.hardMin?\"\":e.slider.min,softMax:e.slider.hardMax?\"\":e.slider.max,step:e.slider.step,isPlayingOnce:e.slider.isPlaying&&e.slider.loopMode===\"PLAY_ONCE\"},strictIntersection:e.strictIntersection,isInConstructionsFolder:e.folderId===$1},Qw(e))}var i_={};Yi(i_,{colors:()=>qa,colors3d:()=>n_,getDisplayColor:()=>Ys,invertColor:()=>e_,isValidHexColor:()=>im,mutateOpacity:()=>r_,normalizeColor:()=>aT,parseHex:()=>t_,shadeColor:()=>Kw});function aT(e){return im(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e=\"#\"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function im(e){return typeof e==\"string\"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function Kw(e,t){if(e=aT(e),!im(e))return e;t>1&&(t=1),t<-1&&(t=-1);var r=parseInt(e.slice(1),16),n=t<0?0:255,i=t<0?t*-1:t,s=r>>16,o=r>>8&255,a=r&255;return\"#\"+(16777216+(Math.round((n-s)*i)+s)*65536+(Math.round((n-o)*i)+o)*256+(Math.round((n-a)*i)+a)).toString(16).slice(1)}function e_(e){if(e=aT(e),!im(e))return e;let t=\"0123456789abcdef\";return\"#\"+e.slice(1).split(\"\").map(r=>t[15-t.indexOf(r)]).join(\"\")}function t_(e){if(e=e.replace(/#/,\"\"),e.length===3)var t=parseInt(e.slice(0,1)+e.slice(0,1),16),r=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16);else if(e.length===6)var t=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);else var t=0,r=0,n=0;return{r:t,g:r,b:n}}function r_(e,t){let r=/(rgba\\([\\d]+\\,\\ ?[\\d]+\\,\\ ?[\\d]+\\,\\ ?)[\\d.]+(\\))/;return e.match(r)?e.replace(r,`$1${t}$2`):e}function Ys(e,t){if(t&&t.colorLatexValue){var r=t.colorLatexValue;return Array.isArray(r)?r[0]:r}return e.color}var qa={RED:\"#c74440\",BLUE:\"#2d70b3\",GREEN:\"#388c46\",PURPLE:\"#6042a6\",ORANGE:\"#fa7e19\",BLACK:\"#000000\",GRAY:\"#aaaaaa\"},n_={RED:qa.RED,BLUE:qa.BLUE,GREEN:qa.GREEN,ORANGE:qa.ORANGE,PURPLE:qa.PURPLE,GRAY:qa.GRAY};function uT(e,t){let r;switch(t){case\"solvedEquation\":r=2;break;case\"baseComparator\":r=4;break;default:r=1;break}return Math.floor(e/r)}function J1(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);let r=[];t[e.getReturnIndex()]=!0;for(let n=e.instructionsLength()-1;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(i.type===2&&r.push(e.argNames[n]),be(i))continue;let s=gc(e,i)?[i.args[1]]:i.args;for(let o of s)t[o]=!0}return r}x.Base.prototype.getGraphMode=function(e,t){return 10};x.Base.prototype.graphmodeDependencies=Si;function Si(e,t){let r=t.getDependencies();if(e.is3dProduct()&&t instanceof Zt){let n=new Set(J1(t._chunk));return r.filter(i=>n.has(i))}else return r}function s_(e,t){var r;return e&&e.hasOwnProperty(\"dragMode\")?e.dragMode===\"AUTO\"?r=t.defaultDragMode:r=e.dragMode:r=t.defaultDragMode,_1(r,t.moveStrategy)}function Q1(e,t){let r=e.is3dPolicy();if(t.isMovablePoint&&!r&&s_(this.userData,t)!==\"NONE\")return 4;var n=Si(e,t);switch(t.valueType){case zr:case z:if(r){if(n.length===0)return 113;if(e.validParametricVariables(n))return n.length==1?100:103}return 10;case Tr:case qr:return r?118:10;case dr:case Ar:return r?116:10;case Pr:case Ur:return r?117:10;case N:case Ue:return n.length===0?3:e.validParametricVariables(n)?5:10;case b:case j:return!e.is3dPolicy()&&n.length===1?2:r&&n.length===2&&n.indexOf(\"x\")>-1&&n.indexOf(\"y\")>-1?106:10;case Ee:case ur:return 16;case ue:case gr:return 20;case ee:case hr:return 21;case xe:case Kt:return 17;case oe:case br:return 18;case ve:case xr:return 19;case pe:case Sr:return this instanceof rt&&this.getDependencies().length===1?10:24;case Ie:case zt:case ye:case qt:return 23;default:return 10}}x.Expression.prototype.getGraphMode=Q1;function K1(e,t){var r=t._expression.getDependencies();if(r.length>1)return 10;if(t._expression.isList&&t._expression.length===0)return 10;var n=t._symbol;return e.graphMode(n,r,{allDependencies:t.getDependencies()})}x.Equation.prototype.getGraphMode=x.BaseComparator.prototype.getGraphMode=function(e,t){if(t.isError)return 10;var r=Si(e,t);return e.is3dPolicy()?r.length>0&&this.type===\"Equation\"?r.indexOf(\"z\")>-1?112:125:10:t.isConstant?10:t instanceof x.SolvedEquation?K1(e,t):r.length===1||r.length===2?8:10};x.DoubleInequality.prototype.getGraphMode=function(e,t){return e.graphMode(t._symbol,[],{allDependencies:t.getDependencies()})};x.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof x.SolvedEquation)return K1(e,t);if(this.isEquation(e,t))return this.asEquation().getGraphMode(e,t);let r=Si(e,t),n=this._symbol,i=this.userData&&this.userData.polarCoordinateSystem?this.userData.polarCoordinateSystem:\"\",s=t.getDependencies(),o={polarCoordinateSystem:i,allDependencies:s};switch(t.valueType){case b:case j:case Oe:switch(r.length){case 0:return e.graphMode(n,[],o);case 1:return t.valueType===j&&!e.graphableListVariables(n,r[0])?10:this.isSlider?10:e.graphMode(n,r,o);default:return e.is3dPolicy()?e.graphMode(n,r,o):10}case z:if(e.assignmentForbidden(n)||r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:return 113;case 1:return 100;case 2:return 103;default:return 10}default:return Q1.call(this,e,t)}};x.CoordinateEquation.prototype.getGraphMode=function(e,t){var r=Si(e,t);let n=this._concatenatedSymbol;if(t.valueType!==z)return 10;if(r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:switch(n){case\"rthetaphi\":return 115;case\"rthetaz\":return 114;default:return 10}case 1:switch(n){case\"rthetaphi\":return 102;case\"rthetaz\":return 101;default:return 10}case 2:switch(n){case\"rthetaphi\":return 105;case\"rthetaz\":return 104;default:return 10}default:return 10}};x.FunctionDefinition.prototype.getGraphMode=function(e,t){let r=e.is3dPolicy();if(this._argSymbols.length!==1&&!r)return 10;var n=e.functionDefinitionGraphMode(this._symbol,this._argSymbols),i=Si(e,t);switch(t.valueType){case b:case j:if(r)return n;switch(i.length){case 0:return n;case 1:return i[0]!==this._argSymbols[0]?10:n;default:return 10}break;default:return 10}};x.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function cT(e,t){return t.isError?10:11}x.Histogram.prototype.getGraphMode=cT;x.DotPlot.prototype.getGraphMode=cT;x.BoxPlot.prototype.getGraphMode=cT;x.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?10:3:10};function Zu(e,t,r){var a,u;if(!e.is3dProduct())return r;function n(l,c){let p=c.filter(f=>l.indexOf(f)<0);if(p.length)return _g(p[0]).allowExport().setDependencies(p)}function i(){let l=lm(o),c=o_(e,r);return n(l,c)}function s(){let l=eO(o),c=a_(e,r,o);return n(l,c)}let o=t.getGraphMode(e,r);return(u=(a=i())!=null?a:s())!=null?u:r}function o_(e,t){let r=Si(e,t);return t.getDependencies().filter(i=>r.indexOf(i)<0)}function a_(e,t,r){let n=Si(e,t),i=t.getDependencies(),s=new Set;return n.length<i.length&&x.List.wrap(t).eachElement(o=>{let u=o.getRestrictedFunctionForGLSL(lm(r)).concrete;for(let l of u.getDependencies())n.indexOf(l)>-1||s.add(l)}),[...s]}function lm(e){var r;if(!Gs(e))return[];let t=u_(e)?[\"x\",\"y\",\"z\"]:[];return t.push(...(r=rT[e])!=null?r:[]),t.push(...eO(e).filter(n=>t.indexOf(n)<0)),t}function u_(e){return l_(e)}function l_(e){if(!Gs(e))return!1;switch(e){case 106:case 107:case 108:case 110:case 111:case 109:case 121:case 122:case 112:case 103:case 104:case 105:return!0;case 123:case 124:case 119:case 120:case 125:case 113:case 114:case 115:case 116:case 117:case 118:case 126:case 100:case 101:case 102:return!1;default:return!1}}function eO(e){var t;return Gs(e)?(t=Ec[e])!=null?t:[]:[]}var p_=!1,fm=x.List;function Br(){return{}}function f_(){return{segments:[],poi:{},graphMode:1,color:\"\"}}function ka(e,t,r){let n=1/0;for(let s of t){let o=e[s];Array.isArray(o)&&o.length<n&&(n=o.length)}let i=1;return r===\"solvedEquation\"?i=2:r===\"baseComparator\"&&(i=4),i*n}function mo(e,t,r){return Array.isArray(e)?e[uT(t,r)]:e}function d_(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=Ni(r,n),s=Ni(30,30),o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+\"\";{let a=Math.pow(10,o);return Math.round(e*a)/a+\"\"}}function m_(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=r*n,s=30*30,o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+\"\";{let a=Math.pow(10,o);return Math.round(e*a)/a+\"\"}}function y_(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+\"\\xB0\":Math.round(e*100)/100+\"\"}function $a(e,t,r){let n=uT(t,r),i=e.userData.lineStyle,s=mo(e.metaData.computedLineWidth,t,r),o=mo(e.metaData.computedLineOpacity,t,r),a=mo(e.metaData.computedFillOpacity,t,r),u=e.metaData.colorLatexValue?mo(e.metaData.colorLatexValue,t,r):e.userData.color,l=mo(e.metaData.computedResolution,t,r),c=mo(e.metaData.computedCheckers,t,r);return{listIndex:n,style:i,lineWidth:s,lineOpacity:o,fillOpacity:a,color:u,resolution:l,checkers:c}}x.Base.prototype._graph=g_;function g_(e,t,r,n,i,s){var c;if(t instanceof x.SolvedEquation){let p=this._graph(e,t._expression,r,n,i,t.branchMultiplier===2?\"solvedEquation\":void 0),f=sO(this,t,r,e);return f&&(p||(p=[]),Array.prototype.push.apply(p,f)),p}function o(p){let f=p.editableLabelMode;return f===\"TEXT\"||f===\"MATH\"}function a(p,f){return\"colorLatex\"in p&&h_(p.colorLatex)?p.colorLatex:f}let u=t.getExpressionType(n.graphMode,t.valueType),l=F1(u,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill,surfaces:this.userData.surfaces});switch(n.graphMode){case 4:let{points:p,droppedIndices:f}=Mc([t.asValue()]),d=this.userData.shouldGraph&&l.points,m=this.userData.showLabel&&!d;return d?[{segments:[p],graphMode:n.graphMode,droppedIndices:f,color:Ys(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:Hi(p),movablePointInfo:[]}]:m?[{segments:[p],graphMode:3,color:Ys(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:Hi(p),showPoint:!1}]:[];case 3:{let g=[],h=this.userData.shouldGraph&&l.points,P=this.userData.shouldGraph&&l.lines,S=[\"colorLatexValue\"];h&&S.push(\"computedPointOpacity\",\"computedPointSize\"),(this.userData.showLabel||h)&&S.push(\"computedLabelSize\",\"computedLabelAngle\");let A=ka(this.metaData,S,s),T=fm.wrap(t).asValue();dn(T),T.length>A&&(T.length=A);let I=this.userData.showLabel&&!h&&!P,E=Mc(T);return(this.userData.showLabel||h)&&g.push({segments:[E.points],graphMode:n.graphMode,droppedIndices:E.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:h,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:o(this.userData),nakedLabel:I,labels:this.computedLabels||[],poi:Hi(T)}),P&&g.push({segments:iO(T),graphMode:5,color:Ys(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:this.metaData.computedLineWidth,lineOpacity:this.metaData.computedLineOpacity,poi:Br()}),g}case 5:case 116:case 118:case 117:case 113:case 114:case 115:case 100:case 101:case 102:{let g=this.userData,h=this.metaData,P=[],S=[\"colorLatexValue\"];l.lines&&S.push(\"computedLineOpacity\",\"computedLineWidth\"),l.fill&&S.push(\"computedFillOpacity\");let A=ka(this.metaData,S,s),T=[],I=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===Ar&&I){let v=[],D=[],R=[],L=[],w=(c=this.metaData.colorLatexValue)!=null?c:this.userData.color;t.eachElement((H,Z)=>{if(!(Z>=A)&&H.valueType===dr){let[[K,J,ce],[ge,ie,W],[_e,et,Ct]]=H.asValue();if(isNaN(K)||isNaN(J)||isNaN(ce)||isNaN(ge)||isNaN(ie)||isNaN(W)||isNaN(_e)||isNaN(et)||isNaN(Ct))return;let Jt=v.length/3;v.push(K,J,ce,ge,ie,W,_e,et,Ct);let Lr=new Vt(K,J,ce),un=new Vt(ge,ie,W),xn=new Vt(_e,et,Ct),yr=new Vt().subVectors(Lr,xn),Lt=new Vt().subVectors(un,Lr),de=new Vt().crossVectors(yr,Lt);D.push(de.x,de.y,de.z,de.x,de.y,de.z,de.x,de.y,de.z),R.push(Jt,Jt+1,Jt+2),L.push(0,0,0,1,1,0)}}),T=[{meshData:{guid:gs(),positions:new Float32Array(v),normals:new Float32Array(D),faces:new Uint32Array(R),uvs:new Float32Array(L),extraAttrs:new Float32Array([])},color:a(g,w),graphMode:116}]}else T=fm.wrap(t).mapElements((v,D)=>{var ce;if(D>=A)return f_();let{listIndex:R,lineWidth:L,lineOpacity:w,color:X,resolution:H,checkers:Z}=$a(this,D,s);if(v.valueType===dr){let[[ge,ie,W],[_e,et,Ct],[Jt,Lr,un]]=v.asValue();if(isNaN(ge)||isNaN(ie)||isNaN(W)||isNaN(_e)||isNaN(et)||isNaN(Ct)||isNaN(Jt)||isNaN(Lr)||isNaN(un))return;let xn=[ge,ie,W,_e,et,Ct,Jt,Lr,un],yr=new Vt(ge,ie,W),Lt=new Vt(_e,et,Ct),de=new Vt(Jt,Lr,un),Bt=new Vt().subVectors(yr,de),bt=new Vt().subVectors(Lt,yr),Xt=new Vt().crossVectors(Bt,bt),Wt=[Xt.x,Xt.y,Xt.z,Xt.x,Xt.y,Xt.z,Xt.x,Xt.y,Xt.z];return{meshData:{guid:gs(),positions:new Float32Array(xn),normals:new Float32Array(Wt),faces:new Uint32Array([0,1,2]),uvs:new Float32Array([0,0,0,1,1,0]),extraAttrs:new Float32Array([])},color:a(g,X),graphMode:116}}if(v.valueType===Pr){let ge=v.asValue(),[[ie,W,_e],et]=ge;return isNaN(ie)||isNaN(W)||isNaN(_e)||isNaN(et)?void 0:{graphMode:117,position:[ie,W,_e],radius:et,resolution:H,guid:gs(),color:a(g,X)}}if(v.valueType===Tr){let ge=v.asValue(),[[ie,W,_e],[et,Ct,Jt]]=ge;return isNaN(ie)||isNaN(W)||isNaN(_e)||isNaN(et)||isNaN(Ct)||isNaN(Jt)?void 0:{graphMode:118,guid:gs(),points:[ie,W,_e,et,Ct,Jt],color:a(g,X),thickness:L}}let K=v.getDependencies(),J=this.getGraphInfo(e,v).graphMode;if(J===113||J===114||J===115){let ge=mo(this.metaData.computedPointSize,D,s),ie=v.getCompiledFunction(),W=this.getGraphInfo(e,v);return W.graphMode=J,W.lineWidth=ge,W.color=X,W.checkers=Z,W.listIndex=R,fo({viewState:r,graphInfo:W,compiled:ie})}else if(K.length===0){let{points:ge,droppedIndices:ie}=Mc([v.asValue()]);return{segments:[ge],graphMode:3,droppedIndices:ie,color:Ys(g,h),style:g.lineStyle,lineWidth:L,lineOpacity:w,poi:Hi(ge)}}else{let ge=v.getCompiledFunction(),ie=this.getGraphInfo(e,v);ie.graphMode=n.graphMode,ie.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax},ie.style=this.userData.lineStyle,ie.lineWidth=L,ie.lineOpacity=w,ie.resolution=H,ie.checkers=Z,ie.color=X,ie.listIndex=R;let W=fo({viewState:r,graphInfo:ie,compiled:ge});return e.is3dPolicy()&&dm(W.graphMode)?tO(W,r.viewport,(ce=ie.lineWidth)!=null?ce:1):W}});let E=[];for(let v of T)v&&E.push(v);if(l.fill)if(E.forEach((v,D)=>{if(D>=A)return;let{color:R,fillOpacity:L,listIndex:w}=$a(this,D,s);P.push({segments:v.segments,color:R,fillOpacity:L,listIndex:w,graphMode:7,poi:Br()})}),l.lines)E=E.concat(P);else return P;return E}case 1:case 2:case 8:case 112:case 125:case 6:case 20:case 21:case 18:case 19:case 24:case 17:case 23:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 119:case 120:case 121:case 122:case 123:case 124:{let g=[],h=t.valueType===b,P=ka(this.metaData,[\"computedLineOpacity\",\"computedLineWidth\",\"colorLatexValue\",\"fillOpacity\"],s);return fm.wrap(t).eachElement((S,A)=>{var _e,et,Ct,Jt,Lr,un,xn,yr;if(A>=P)return;let T=this.getGraphInfo(e,S);T.graphMode=n.graphMode;let{listIndex:I,style:E,lineWidth:v,lineOpacity:D,fillOpacity:R,color:L,resolution:w,checkers:X}=$a(this,A,s);if(T.listIndex=I,T.style=E,T.lineWidth=v,T.lineOpacity=D,T.fillOpacity=R,T.color=a(this.userData,L),T.resolution=w,T.checkers=X,(n.graphMode===6||n.graphMode===110||n.graphMode===123)&&(T.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain}),(n.graphMode==103||n.graphMode==104||n.graphMode==105||n.graphMode==111||n.graphMode==109||n.graphMode==124)&&(T.domain={type:\"2d\",uMin:this.metaData.evaluatedDomain3DuMin,uMax:this.metaData.evaluatedDomain3DuMax,vMin:this.metaData.evaluatedDomain3DvMin,vMax:this.metaData.evaluatedDomain3DvMax}),n.graphMode===20){let[[de,Bt],bt]=S.asValue();if(isNaN(de)||isNaN(Bt)||isNaN(bt))return;g.push({segments:[[de,Bt,bt]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:T.operator,poi:Br()});return}else if(n.graphMode===21){let de=Kf(S.asValue());if(!de)return;let Bt=[];de.type===\"arc\"?Bt.push({graphMode:n.graphMode,segments:[[de.center[0],de.center[1],de.radius,de.startAngle,de.endAngle]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()}):de.type===\"rays\"?Bt.push({graphMode:19,segments:[[de.start1[0],de.start1[1],de.end1[0],de.end1[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()},{graphMode:19,segments:[[de.start2[0],de.start2[1],de.end2[0],de.end2[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()}):Bt.push({graphMode:17,segments:[[de.start[0],de.start[1],de.end[0],de.end[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()}),g.push(...Bt),g.push(...rO(Bt,i));return}else if(n.graphMode===17||n.graphMode===18||n.graphMode===19){let[[de,Bt],[bt,Xt]]=S.asValue();if(isNaN(de)||isNaN(Bt)||isNaN(bt)||isNaN(Xt))return;let Wt={segments:[[de,Bt,bt,Xt]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,arrowMode:T.arrowMode,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()};if(g.push(Wt),g.push(...rO([Wt],i)),this.userData.showLabel&&n.graphMode===17){let mt=T.listIndex,kt=this.computedLabels&&this.computedLabels[mt||0];g.push({graphMode:22,objectType:17,segments:[[de,Bt,bt,Xt]],color:T.color,listIndex:mt,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:kt?[kt]:[d_(Ni(bt-de,Xt-Bt),r)]})}return}else if(n.graphMode===24){let[de,Bt]=S.asValue(),[[bt,Xt],[Wt,mt]]=[Bt,[Bt[0]+de[0],Bt[1]+de[1]]];if(isNaN(Wt)||isNaN(mt)||isNaN(bt)||isNaN(Xt))return;let kt={segments:[[bt,Xt,Wt,mt]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,arrowMode:T.arrowMode,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()};g.push(kt)}else if(n.graphMode===23){let{value:de,valueType:Bt}=S.asTypedValue(),[[bt,Xt],Wt,mt]=de;if(isNaN(bt)||isNaN(Xt)||isNaN(Wt)||isNaN(mt))return;let kt=T.listIndex,Tn=Bt===ye,ho=Tn?mt:Math.abs(mt);if(g.push({graphMode:23,segments:[[bt,Xt,Wt,mt,Tn?1:0]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:kt,operator:n.operator,poi:Br()}),this.userData.showAngleLabel){let Ju=this.computedLabels&&this.computedLabels[kt||0];g.push({graphMode:22,objectType:23,segments:[[bt,Xt,Wt,mt]],color:L,listIndex:kt,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:Ju?[Ju]:[y_(ho,r)]})}return}let H=(_e=Ec[n.graphMode])!=null?_e:[],Z=S.getCompiledFunction(H),K=ko(this),J=K&&K.discrete,ce=x_(K,S),ge;try{ge=S.getCompiledDerivative()}catch(de){}let ie=this.metaData.evaluatedCDFMin,W=this.metaData.evaluatedCDFMax;if(ie!==void 0&&W!==void 0&&!isNaN(ie)&&!isNaN(W)&&h)if(J){let de={viewState:r,graphInfo:T,compiled:Z,bounds:[ie,W],maxOverride:nO(K,S),showPoint:this.userData.shouldGraph},Bt=z1(de),bt=Bt.cdfTopBranch,Xt=Bt.topBranches;if(Xt.forEach(function(Wt){!Wt||!ce||(Wt.boundingBox=ce)}),Xt.every(Wt=>Wt!==void 0)&&(g=Xt,bt&&bt.segments[0].length)){let Wt=[];bt.segments[0].forEach(function(mt){!isNaN(mt[0])&&!isNaN(mt[1])&&Wt.push([mt[0],0,mt[0],mt[1]])}),g.push({graphMode:5,segments:Wt,boundingBox:ce,poi:Br(),color:L})}}else{let Bt=q1({viewState:r,graphInfo:T,compiled:Z,derivative:ge,bounds:[ie,W]}),bt=Bt.cdfTopBranch,Xt=Bt.topBranches;if(Xt.forEach(function(Wt){!Wt||!ce||(Wt.boundingBox=ce)}),g=Xt,bt&&bt.segments.length){let Wt,mt;for(let kt=0;kt<bt.segments.length;kt++){let Tn=bt.segments[kt];if(Tn.length>=4){Wt=Tn[0];break}}for(let kt=bt.segments.length-1;kt>=0;kt--){let Tn=bt.segments[kt];if(Tn.length>=4){mt=Tn[Tn.length-2];break}}if(Wt!==void 0&&mt!==void 0&&isFinite(Wt)&&isFinite(mt)){let kt=em(bt.segments,[[Wt,0,mt,0]],bt.graphMode);g.push({graphMode:7,segments:kt,poi:Br(),color:L})}}}else if(J){let de=Kd({viewState:r,graphInfo:T,compiled:Z,showPoint:this.userData.shouldGraph,maxOverride:nO(K,S)});ce&&(de.boundingBox=ce),g.push(de)}else{let de=T.graphMode===120||T.graphMode===119||T.graphMode===123||T.graphMode===125,Bt=!e.is3dPolicy()||de,bt=(et=this.userData.lines)!=null?et:Bt;if(((Ct=this.userData.surfaces)!=null?Ct:!de)&&Gs(T.graphMode)){let mt=S.getRestrictedFunctionForGLSL(lm(T.graphMode)),kt;if(T.graphMode===112||T.graphMode===125)try{kt=mt.concrete.gradient([\"x\",\"y\",\"z\"]).getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(Ju){}let Tn={viewState:r,graphInfo:T,compiled:mt.concrete.getCompiledFunction(H),restrictionShader3d:mt.restriction,derivative:ge,gradient:kt},ho=fo(Tn);g.push(ho)}let Wt=T.graphMode===120||T.graphMode===119||T.graphMode===122||T.graphMode===121||T.graphMode===123||T.graphMode===124||T.graphMode===125;if(!Gs(T.graphMode)||Wt&&bt){let mt={viewState:r,graphInfo:T,compiled:Z,derivative:ge};switch(T.graphMode){case 120:case 122:{mt.graphInfo.graphMode=2,T.willConvertTo3D=!0,(Jt=T.lineWidth)!=null||(T.lineWidth=1);break}case 119:case 121:{mt.graphInfo.graphMode=1,T.willConvertTo3D=!0,(Lr=T.lineWidth)!=null||(T.lineWidth=1);break}case 123:let{min:Tn,max:ho}=((un=T.domain)==null?void 0:un.type)===\"1d\"?T.domain:{min:0,max:2*Math.PI};mt.graphInfo.graphMode=6,mt.graphInfo.domain={type:\"1d\",min:Tn,max:ho,isExplicit:this.metaData.isExplicitDomain};break;case 124:let{uMin:Ju,uMax:eS}=((xn=T.domain)==null?void 0:xn.type)===\"2d\"?T.domain:{uMin:0,uMax:2*Math.PI};mt.graphInfo.graphMode=6,mt.graphInfo.domain={type:\"1d\",min:Ju,max:eS,isExplicit:this.metaData.isExplicitDomain};break;case 125:mt.graphInfo.graphMode=8;break}let kt=fo(mt);if(ce&&(kt.boundingBox=ce),e.is3dPolicy()&&bt&&dm(kt.graphMode)){let Tn=(yr=T.lineWidth)!=null?yr:1;g.push(tO(kt,r.viewport,Tn))}else if(kt.fillSegments){let Lt=kt,{fillSegments:Tn}=Lt,ho=HT(Lt,[\"fillSegments\"]);bt||(ho.lineWidth=0),g.push(ho)}else bt||(kt.lineWidth=0),(bt||!Gs(n.graphMode))&&g.push(kt);T.graphMode===8&&T.operator!==\"=\"&&g.push({graphMode:7,segments:kt.fillSegments,poi:Br(),listIndex:T.listIndex,color:L,fillOpacity:R})}}}),g}case 16:{let g=[],h=this.userData.lines===void 0?!0:this.userData.lines,P=this.userData.fill===void 0?!0:this.userData.fill;if(!P&&!h)return g;let S=ka(this.metaData,[\"computedLineOpacity\",\"computedLineWidth\",\"colorLatexValue\",\"fillOpacity\"],s),A=t.asValue();q(t.valueType)||(A=[A]);for(let T=0;T<A.length;T++){if(T>S-1)continue;let I=A[T];if(!I.length)continue;let E=this.getGraphInfo(e,t),{listIndex:v,lineWidth:D,lineOpacity:R,fillOpacity:L,color:w}=$a(this,T,s);this.userData.shouldOmitLastPolygonSegment||(I=[...I,I[0]]),dn(I);let X=iO(I);if(X.length&&(P&&g.push({segments:X,graphMode:7,poi:Br(),color:w,fillOpacity:L,style:E.style,listIndex:v}),h&&g.push({segments:X,graphMode:5,poi:Br(),color:w,style:this.userData.lineStyle,lineWidth:D,lineOpacity:R,listIndex:v}),p_&&this.userData.showLabel)){let H=this.computedLabels&&this.computedLabels[v||0];g.push({graphMode:22,objectType:16,segments:X,color:w,listIndex:v,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:H?[H]:[m_(mb(I),r)]})}}return g}case 7:case 11:case 10:case 15:case 22:case 126:return!1;default:let y=n.graphMode;throw new Error(`Unexpected graphMode: ${y}`)}}function dm(e){switch(e){case 1:case 2:case 6:case 8:return!0;default:return!1}}function tO(e,t,r){var m;function n(y,g){return e.graphMode===1?[g,y]:e.graphMode===6?[g*Math.cos(y),g*Math.sin(y)]:[y,g]}let i=[];for(let y=0;y<e.segments.length;y++){let g=e.segments[y];for(let h=0;h<g.length/2;h++){let[P,S]=n(g[2*h],g[2*h+1]);i.push(P,S)}y<e.segments.length-1&&i.push(NaN,NaN)}let{xmin:s,xmax:o,ymin:a,ymax:u}=t,l=o-s,c=u-a,p=[],f=i.length/2,d=r/200;for(let y=0;y<f;y++){let[g,h]=[i[2*y],i[2*y+1]];if(y>0&&y<f-1){let[P,S]=[i[2*y-2],i[2*y-1]],[A,T]=[i[2*y+2],i[2*y+3]],I=(g-P)/l,E=(A-g)/l,v=(h-S)/c,D=(T-h)/c,R=as(I,v),L=as(E,D);if((E*I+D*v)/(R*L)<.7&&R>2*d&&L>2*d){let X=.5*(d/R),H=.5*(d/L),Z=Qo(P,g,1-X),K=Qo(S,h,1-X),J=Qo(g,A,H),ce=Qo(h,T,H);p.push(Z,K,0),p.push(Qo(Z,g,.5),Qo(K,h,.5),0),p.push(g,h,0),p.push(Qo(g,J,.5),Qo(h,ce,.5),0),p.push(J,ce,0)}else p.push(g,h,0)}else p.push(g,h,0)}return{graphMode:126,guid:gs(),points:p,color:e.color,thickness:(m=e.lineWidth)!=null?m:1}}function Qo(e,t,r){return(1-r)*e+r*t}function h_(e){return e===\"gradient_u\"||e===\"gradient_v\"||e===\"checkers\"||e.startsWith(\"shader:\")||e.startsWith(\"data:image\")}function pm(e,t,r){return{resolved:!0,graphMode:t,segments:r,operator:e.operator,poi:Br(),color:e.color,style:\"DASHED\",lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function rO(e,t){var n,i;if(!t)return[];let r=[];for(let s of e)if(s.graphMode===17){let o=t[(n=s.listIndex)!=null?n:0];if(!o)continue;let a=0,u,l=1,c,[p,f,d,m]=s.segments[0];for(let y=0;y<o.length;y++){let[g,h]=o[y],P=Ji(g,h,0,p,f,0,d,m,0);P<a&&(a=P,u=y),s.graphMode===17&&P>l&&(l=P,c=y)}u!==void 0&&r.push(pm(s,17,[[p,f,o[u][0],o[u][1]]])),c!==void 0&&r.push(pm(s,17,[[d,m,o[c][0],o[c][1]]]))}else if(s.graphMode===21){let o=t[(i=s.listIndex)!=null?i:0];if(!o)continue;let[a,u,l,c,p]=s.segments[0],f=p-c+(p<c?1:-1)*2*Math.PI,d=[];for(let m of o){let[y,g]=m,h=Math.atan2(g-u,y-a),P=XT(h,c,f);0<P&&P<1&&d.push(P)}if(d.length){d.push(0,1),d.sort();let m=0,y=0;for(let P=0;P<d.length-1;P++){let S=d[P+1]-d[P];(m===void 0||S>m)&&(m=S,y=P)}let g=d[y],h=d[y+1];g>0&&r.push(pm(s,21,[[a,u,l,c,c+g*f]])),h<1&&r.push(pm(s,21,[[a,u,l,p,p-(1-h)*f]]))}}return r}function b_(){throw new Error(\"Programming error: this function is not expected to be called\")}function sO(e,t,r,n){let i=[];for(let s=0;s<t.otherVariableSolutionData.length;s++){let o=t.otherVariableSolutionData[s];if(!o)continue;let{coefficients:a,restriction:u}=o,l=a.argNames[0];if(l!==\"x\"&&l!==\"y\")continue;let c=a.getCompiledFunction().fn,p,f;l===\"y\"?(p=1,f=2):(p=2,f=1);let d=void 0,{listIndex:m,style:y,lineWidth:g,lineOpacity:h,color:P}=$a(e,s,d),S=$u(r,{graphMode:p,domainBound:Jr(),lineWidth:g,operator:\"=\"},b_);if(!S)continue;let A=L1(c,S);for(let T of A){let I=new Zt(u.substituteConstantArguments({[l]:T})),E=e.getGraphInfo(n,I);E=se($({},E),{graphMode:f,lineWidth:g});let v=void 0,D=e._graph(n,I,r,E,v,t.branchMultiplier===2?\"solvedEquation\":void 0);if(ls(D))for(let R of D)i.push(se($({},R),{listIndex:m,style:y,lineWidth:g,lineOpacity:h,color:P}))}}return i.length>0?i:!1}x.Base.prototype.tryGraph=function(e,t,r,n){try{return this.graph(e,t,r,n)}catch(i){let s=i instanceof x.Error?i.getError():ae(i).getError();return[R1(s)]}};x.Base.prototype.graph=function(e,t,r,n){let i=this.getGraphInfo(e,t);return this._graph(e,t,r,i,n)};x.BaseComparator.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=n.graphMode,s=\"baseComparator\",o=this.userData.lines===void 0?!0:this.userData.lines;if(i===8)return this._graph(e,t,r,n);if(i===10||!(t instanceof x.SolvedEquation))return!1;let a=this.getOperator(),u=[],l=[],c=!0;t._expression.eachElement(function(g){u.push(g.getCompiledFunction());try{l.push(g.getCompiledDerivative())}catch(h){c=!1}}),c||(l=void 0);let p=[],f=[-1,0,0,1],d=ka(this.metaData,[\"computedLineWidth\",\"computedLineOpacity\",\"computedFillOpacity\",\"colorLatexValue\"],s),m=Math.min(u.length,d);for(let g=0;g<m;g++){let h=this.getGraphInfo(e,t._expression.args[g]);h.graphMode=i;let{listIndex:P,style:S,color:A,lineWidth:T,lineOpacity:I,fillOpacity:E}=$a(this,g,s);h.listIndex=P,h.style=S,h.color=A,n.graphMode===6&&(h.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let v=fo({viewState:r,graphInfo:h,compiled:u[g],derivative:l?l[g]:void 0});v.lineWidth=T,v.lineOpacity=I,v.fillOpacity=E,v.operator=ca(pn[a].inclusive,f[g%4]),o||(v.lineWidth=0),p.push(v)}for(let g=0;g<m;g+=4){let h=em(p[g+1].segments,p[g+2].segments,i);p.push({graphMode:7,listIndex:p[g].listIndex,segments:h,poi:Br(),fillOpacity:p[g].fillOpacity,color:p[g].color})}let y=sO(this,t,r,e);if(y){for(let g of y)g.operator=ca(pn[a].inclusive,0);Array.prototype.push.apply(p,y)}return p};x.DoubleInequality.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);if(n.graphMode===10)return!1;let i=[],s=ca(pn[this._operators[0]].inclusive,0),o=ca(pn[this._operators[1]].inclusive,0),a=this.userData,u=this.metaData,l=a.lines===void 0?!0:a.lines,c=[\"colorLatexValue\",\"computedFillOpacity\"];l&&c.push(\"computedLineWidth\",\"computedLineOpacity\");let p=ka(u,c),f=t._expressions;return dn(f),fm.eachArgs(f,(d,m)=>{let y=m;if(y>=p)return;d[0].userData=d[1].userData=a,d[0].metaData=d[1].metaData=u;let g=void 0,{color:h,lineWidth:P,lineOpacity:S,fillOpacity:A}=$a(this,y,g),T=this._graph(e,d[0],r,n)[0];T.listIndex=y,T.operator=s,T.color=h,T.lineWidth=P,T.lineOpacity=S,i.push(T);let I=this._graph(e,d[1],r,n)[0];I.listIndex=y,I.operator=o,I.color=h,I.lineWidth=P,I.lineOpacity=S,i.push(I);let E=T.segments,v=I.segments;dn(E),dn(v);let D=em(E,v,T.graphMode);l||(T.lineWidth=0,I.lineWidth=0),i.push({graphMode:7,listIndex:T.listIndex,segments:D,lineOpacity:S,fillOpacity:A,poi:Br(),color:h})}),i};x.Regression.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)};function fT(e,t){let r=1/0,n=-1/0,i=1/0,s=-1/0;for(let a of t)for(var o=0;o<a.length;o+=2){let u=a[o],l=a[o+1];u<r&&(r=u),u>n&&(n=u),l<i&&(i=l),l>s&&(s=l)}if(isFinite(r)&&isFinite(i))return{type:e,xmin:r,ymin:i,xmax:n,ymax:s}}function x_(e,t){if(!e||!(t instanceof Zt))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type!==37)return;let i=e.discrete?\"discreteDistribution\":\"continuousDistribution\";if(e.symbol===\"binomialdist\"&&n.symbol===\"binompdf\"){let s=_t(r,n.args[1]),o=_t(r,n.args[2]),a=jf(o*s,s,o);return{type:i,xmin:0,xmax:s,ymin:0,ymax:a}}if(e.symbol===\"poissondist\"&&n.symbol===\"poissonpdf\"){let s=_t(r,n.args[1]),o=Math.max(Iu(Math.floor(s),s),Iu(Math.ceil(s),s));return{type:i,xmin:0,xmax:2.5*s,ymin:0,ymax:o}}if(e.symbol===\"normaldist\"&&n.symbol===\"normalpdf\"){let s=_t(r,n.args[1]),o=_t(r,n.args[2]),a=ib(s,s,o);return{type:i,xmin:s-2*Math.abs(o),xmax:s+2*Math.abs(o),ymin:0,ymax:a}}if(e.symbol===\"uniformdist\"&&n.symbol===\"uniformpdf\"){let s=_t(r,n.args[1]),o=_t(r,n.args[2]),a=(s+o)/2,u=o-s,l=ab(a,s,o);return{type:i,xmin:s-u/3,xmax:o+u/3,ymin:0,ymax:l}}if(e.symbol===\"tdist\"&&n.symbol===\"tpdf\"){let s=_t(r,n.args[1]),o=Zf(0,s);return{type:i,xmin:-3,xmax:3,ymin:0,ymax:o}}}function nO(e,t){if(e===void 0||e.symbol!==\"binomialdist\"||!(t instanceof Zt))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type===37&&n.symbol===\"binompdf\")return _t(r,n.args[1])}function oO(e,t,r){let n={};r-=.5*t;for(var i=e.length-1;i>=0;i--){let s=e[i],o=Math.floor((s-r)/t);n[o]?n[o].data.push(s):n[o]={id:o,data:[s],min:o*t+r,max:o*t+r+t,center:o*t+r+t/2}}return n}x.Histogram.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[0].asValue(),s=t.args[1].asValue(),o=this.userData.vizProps&&this.userData.vizProps.binAlignment===\"left\"?s/2:0;dn(i);let a=oO(i,s,o),u=1;this.userData.vizProps&&this.userData.vizProps.histogramMode===\"density\"?u=1/(i.length*s):this.userData.vizProps&&this.userData.vizProps.histogramMode===\"relative\"&&(u=1/i.length);let l=[],c=[];for(let f in a){let d=a[f],m=d.data.length;c.push([d.min,0*u,d.min,m*u,d.max,m*u,d.max,0*u]);let y=0;a[d.id+1]&&(y=a[d.id+1].data.length);let g=[d.min,0*u,d.min,m*u,d.max,m*u];y<m&&g.push(d.max,y*u),l.push(g)}let p=fT(\"histogram\",c);return p&&s&&(p.binWidth=s),[{segments:c,graphMode:7,boundingBox:p,poi:Br(),color:n.color,fillOpacity:.4},{segments:l,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:n.color}]};x.DotPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[1].asValue(),s=this.userData.vizProps&&this.userData.vizProps.binAlignment===\"left\"?i/2:0,o=t.args[0].asValue();dn(o);let a=oO(o,i,s),u=!1,l,c=[];for(let h in a){let P=a[h];for(var p=P.data.length-1;p>=0;p--)P.center!==P.data[p]&&(u=!0)}if(this.userData.vizProps&&this.userData.vizProps.dotplotXMode===\"exact\")for(let h in a){l=a[h].data,l.reverse();for(let S=0;S<l.length;S++)c.push([l[S],S+1])}else for(let h in a){let P=a[h];l=P.data;for(let S=0;S<l.length;S++)c.push([P.center,S+1])}let f=fT(\"dotplot\",c);f&&i&&(f.ymin=0,f.xmin-=.5*i,f.xmax+=.5*i,f.binWidth=i);let{computedPointOpacity:d,computedPointSize:m}=this.metaData,y=mo(d,0),g=this.userData.pointSize?mo(m,0):14;return[{segments:[c],graphMode:3,boundingBox:f,poi:Hi(c),color:n.color,style:this.userData.pointStyle,pointSize:g,pointOpacity:y,showPoint:!0,needsDotplotXMode:u}]};x.BoxPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=this.metaData.evaluatedAxisOffset,s=this.metaData.evaluatedBreadth,o=t.args[0].asValue();if(dn(o),isNaN(s)||isNaN(i))return!1;let a=Math.min.apply(null,o),u=Math.max.apply(null,o),l=Ra(o,1),c=Ra(o,2),p=Ra(o,3),f=i,d=f-s/2,m=f+s/2,y=s/10,g=[];if(this.userData.vizProps.showBoxplotOutliers){let A=p-l,T=l-1.5*A,I=p+1.5*A;a=1/0,u=-1/0,o.forEach(function(E){T<=E&&E<a&&(a=E),u<E&&E<=I&&(u=E),(E<T||E>I)&&g.push([E,f])})}let h=[[l,d,p,d,p,m,l,m,l,d],[c,d,c,m],[l,f,a,f],[p,f,u,f],[a,f-y,a,f+y],[u,f-y,u,f+y]];if(this.userData.vizProps&&this.userData.vizProps.alignedAxis===\"y\"){for(let A of h)for(var P=0;P<A.length;P+=2){let T=A[P];A[P]=A[P+1],A[P+1]=T}for(let A of g){let T=A[0];A[0]=A[1],A[1]=T}}let S=[{segments:h,graphMode:5,boundingBox:fT(\"boxplot\",h.concat(g)),poi:Br(),color:n.color}];return g.length&&S.push({segments:[g],graphMode:3,color:n.color,style:\"OPEN\",showPoint:!0,poi:Hi(g)}),S};function T_(e){return Array.prototype.concat.apply([],e)}x.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;let i=this.columns[t].values,s=i&&i[r];return!!(s&&isFinite(s.asValue())&&s.getDependencies().length===0)};x.Table.prototype.graph=function(e,t,r){let n={};if(t.columns[0].isError)return n;let s=t.columns[0].values;for(let o=1;o<this.columns.length;o++){let a=t.columns[o];if(a.isError)continue;let u=this.columns[o].header.userData,l=this.columns[o].header.metaData;if(u.hidden)continue;let c=ka(l,[\"colorLatexValue\",\"computedPointSize\",\"computedPointOpacity\"]),p=u.dragMode,f=p===\"X\"||p===\"XY\",d=p===\"Y\"||p===\"XY\",m=!!u.points,y=!!u.lines,g=[],h=[],P=[],S=[],A=[],T=[],I=1/0,E=-1/0,v=1/0,D=-1/0,R={};for(let w=0;w<s.length;w++){let X=s[w],H=a.values[w];if(!X||!H||!isFinite(X.asValue())||!isFinite(H.asValue())){R[w]=!0,y&&(T.length>1&&A.push(T),T=[]);continue}let Z=X.asValue(),K=H.asValue();if(m){if(w>=c)continue;let J=f&&this.isValueDraggable(t,0,w),ce=d&&this.isValueDraggable(t,o,w);J||ce?(P.push([Z,K]),S.push({index:w,dragX:J,dragY:ce})):h.push([Z,K])}y&&T.push([Z,K]),Z<I&&(I=Z),Z>E&&(E=Z),K<v&&(v=K),K>D&&(D=K)}let L={type:\"table\",xmin:I,xmax:E,ymin:v,ymax:D};P.length&&g.push({graphMode:4,segments:[P],color:l.colorLatexValue||u.color,tableId:u.tableId,poi:Hi(P),movablePointInfo:S,boundingBox:L,pointOpacity:l.computedPointOpacity}),h.length&&g.push({segments:[h],droppedIndices:R,graphMode:3,showPoint:!0,poi:Hi(h),color:l.colorLatexValue||u.color,pointSize:l.computedPointSize,pointOpacity:l.computedPointOpacity,style:u.pointStyle,tableId:u.tableId,boundingBox:L}),(A.length||T.length)&&(A.push(T),g.push({segments:A.map(T_),graphMode:5,poi:Br(),color:Ys(u,l),style:u.lineStyle,lineWidth:Array.isArray(l.computedLineWidth)?l.computedLineWidth[0]:l.computedLineWidth,lineOpacity:Array.isArray(l.computedLineOpacity)?l.computedLineOpacity[0]:l.computedLineOpacity,tableId:u.tableId,boundingBox:L})),g.length&&(n[u.id]=g)}return n};function P_(e,t,r){return e?t===0&&r===0?e[2].type!==\"none\"||e[3].type!==\"none\":t!==0&&r!==0?e[0].type!==\"none\"&&e[1].type!==\"none\":t!==0?e[0].type!==\"none\":r!==0?e[1].type!==\"none\":!1:!1}x.Image.prototype.graph=function(e,t,r){let n=[];if(t.center.valueType!==N||t.center.getDependencies().length!==0||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return n;let i=[],s=[],o=t.width.asValue()/2,a=t.height.asValue()/2,u=t.radianAngle.asValue();for(var l=-1;l<=1;l++)for(var c=-1;c<=1;c++){let[p,f]=t.center.asValue(),d=[p+l*o*Math.cos(u)+c*a*Math.sin(u),f-l*o*Math.sin(u)+c*a*Math.cos(u)];P_(t.moveStrategy,l,c)&&(i.push(d),s.push([l,c]))}return n.push({segments:[i],scaleFactors:[s],graphMode:4,color:Ys(this.userData,this.metaData),style:this.userData.style,poi:Hi(i),movablePointInfo:[],pointOpacity:1}),n};function iO(e){let t=[],r=[];for(let[n,i]of e)!isNaN(n)&&!isNaN(i)?t.push(n,i):(t.length>=4&&r.push(t),t=[]);return t.length>=4&&r.push(t),r}function I_(e){return e.isError?e.getError():e.asValue()===void 0?\"\":+e.asValue()}function M_(e,t,r){let n=[];for(var i=0;i<t.columns.length;i++){let s=r.columns[i],o=s.isError?[]:s.values.map(I_),a={dependent:!s.isIndependent,discrete:!!s.isIndependent,values:o};s.isError&&(a.error=s.getError()),n.push(a)}return{column_data:n}}function E_(e,t,r){let n={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(n.errorMap.scale=!0),r.center.isError&&(n.errorMap.center=!0),r.radianAngle.isError&&(n.errorMap.angle=!0),r.width.isError&&(n.errorMap.width=!0),r.height.isError&&(n.errorMap.height=!0),r.opacity.isError&&(n.errorMap.opacity=!0),Object.keys(n.errorMap).length>0)return n.variables=t.getSliderVariables(e,r),n;n.dimensions.x=[],n.dimensions.y=[],n.dimensions.radianAngle=[],n.dimensions.width=[],n.dimensions.height=[],n.dimensions.opacity=[];let i=[r.center,r.radianAngle,r.width,r.height,r.opacity];return i.some(o=>o&&o.valueType&&q(o.valueType))&&(n.is_concrete_list=!0),x.List.eachArgs(i,function(o){let a=o[0].asValue(),u=+o[1].asValue(),l=Math.atan2(Math.sin(u),Math.cos(u));n.dimensions.x.push(+a[0]),n.dimensions.y.push(+a[1]),n.dimensions.radianAngle.push(l),n.dimensions.width.push(+o[2].asValue()),n.dimensions.height.push(+o[3].asValue()),n.dimensions.opacity.push(Math.max(0,Math.min(1,+o[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,r):10)!==10&&(n.is_graphable=!0),r.moveStrategy&&(n.move_strategy=r.moveStrategy),t.center&&(t.center.type===\"Identifier\"?(n.center_reference_id=t.center.referencedStatementId,n.center_reference_symbol=t.center._symbol):t.center.type===\"ParenSeq\"&&r.center.valueType===N&&(n.center_is_point_literal=!0)),n}function v_(e,t,r){let n=r.handler,i=r.minStep,s={},o={};for(let p of n.getDependencies())e.validActionVariable(p)||(s[p]=!0);for(let p of i.getDependencies())o[p]=!0;let a;if(ms(i))a={status:\"error\",error:i.getError()};else{let p=i.asValue();typeof p==\"number\"&&!isNaN(p)&&p>=0?a={status:\"valid\",value:p}:a={status:\"error\",error:Mg().getError()}}let u=Object.keys(s);u.length>0&&(n=Ut(u).setDependencies(n.getDependencies()));let l;n.isError&&!mT(e,n)?l={status:\"error\",error:n.getError()}:n.isEmptyAction?l={status:\"empty\"}:l={status:\"maybe-valid\"};let c={handler:l,minStep:a,variables:[]};return ea(c,e,$($({},s),o)),c}function O_(){return{operator:\"=\",variables:[]}}function aO(e,t,r,n){var l;if(Ui(r))return M_(e,r,n);if(Fd(r))return E_(e,r,n);let i=O_();if(r instanceof x.Ticker)return e.graphingEnabled()?v_(e,r,n):(i.error=ae(\"Ticker without graphing\").getError(),i);if(e.is3dProduct()&&(i.graphMode3d=r.getGraphMode(new qu(e.isBeta3d()),n)),(i.graphMode3d===100||i.graphMode3d===101||i.graphMode3d===102)&&n.getDependencies().length===1){let c=n.getDependencies()[0];(c===\"t\"||c===\"u\"||c===\"v\")&&(i.dependency=c)}if((l=r.parseOptions)!=null&&l.selection){let c=n.getCursorContext();if(c)i.cursor_context=se($({},c),{selection:r.parseOptions.selection});else if(ms(n)){let p=D_(e,t,r);p&&(i.cursor_context=se($({},p),{selection:r.parseOptions.selection}))}}if(n.isError&&!(r instanceof x.FunctionDefinition&&!n.blocksExport)){i.error=n.getError(),i.variables=r.getSliderVariables(e,n),i.is_single_identifier=r instanceof x.Identifier,n.actionValue&&(i.action_value=Bx(n.actionValue));let c=dT(e,t,r,n);return Object.keys(c).length>0&&(i.geometry=dT(e,t,r,n)),i}if(n.valueType===ot&&n.getDependencies().length===0){let c=n.asValue();i.rgb_value=Sa(c[0],c[1],c[2]).formatHex()}n.valueType===Be&&n.getDependencies().length===0&&(i.action_value=Bx(n.asValue())),n.moveStrategy&&(i.move_strategy=n.moveStrategy,i.default_drag_mode=n.defaultDragMode),r.isInequality()&&(i.is_inequality=!0),i.operator=r.getOperator(),n instanceof x.SolvedEquation?n._expression.asValue()!==!0&&n._expression.asValue()!==!1&&(i.assignment=n._symbol):r instanceof x.Assignment&&(i.assignment=r._symbol);let s=e.graphingEnabled()?r.getGraphMode(e,n):10;if(e.graphingEnabled()&&e.is3dPolicy()&&!Gs(s)&&!dm(s)&&(s=10),s!==10){i.is_graphable=!0,i.expression_type=r.getExpressionType(s,n.valueType),n.isShadeBetween()&&(i.is_shade_between=!0);let c=r.tableInfo(e,n);c&&(i.is_tableable=!0,i.table_info=c)}if(n.valueType!==void 0&&q(n.valueType)&&(i.is_concrete_list=!0,n.valueType===Or&&n.getDependencies().length===0)){let c=n.asValue();c&&(i.rgb_value=c.map(p=>Sa(p[0],p[1],p[2]).formatHex()))}if(i.variables=i.is_graphable?[]:r.getSliderVariables(e,n),i.is_single_identifier=r instanceof x.Identifier,n.isTypedConstant){let c=n.asTypedValue();i.typed_constant_value=c,(c.valueType===b||c.valueType===me)&&(i.constant_value=c.value),S_(c.valueType)&&(i.geometry=dT(e,t,r,n))}let o=n.getEvaluationInfo();if(o&&i.operator===\"=\"&&!r.isConstant&&!r.isFunction&&n.valueType!==me&&n.valueType!==Nr&&!(r instanceof x.Equation)&&!(r instanceof x.And)&&(i.is_evaluable=!0,i.zero_values=o),n instanceof x.OptimizedRegression){let c=n,p={};for(var a in c.parameters)c.parameters.hasOwnProperty(a)&&(p[wr(a)]=+c.parameters[a].asValue());i.is_regression=!0,i.regression={parameters:p,residualVariable:wr(c.residualVariable),residualSuggestionId:c.residualSuggestionId,shouldSuggestLogMode:c.shouldSuggestLogMode,isLinear:c.isLinear,statistics:c.statistics,parameterWarning:c.parameterWarning}}let u=ko(r);return u&&u.discrete&&(i.is_discrete_distribution=!0),i}function S_(e){switch(e){case N:case Ue:case oe:case br:case xe:case Kt:case ve:case xr:case pe:case Sr:case ue:case gr:case ee:case hr:case Ee:case ur:case Ie:case zt:case ye:case qt:case Ce:case Gr:return!0;default:return!1}}function dT(e,t,r,n){let i={};n.valueType!==void 0&&(i.valueType=n.valueType),i.valueType&&re(i.valueType,N)&&e.graphingEnabled()&&r.getGraphMode(e,n)===4&&(i.isMovablePoint=!0);let{identifier:s,listAccess:o,assignmentRhsReference:a,tree:u}=ad(r);if(s&&(i.identifier=s),o&&(i.listAccess=o),a&&(i.assignmentRhsReference=a),u&&(i.call=u,n.valueType&&re(n.valueType,Ce)&&r instanceof to)){let c=r._expression;i.transformation_preview_info={type:u.symbol,args:c.args.slice(1).map(p=>p.tryGetConcreteTree(e,t).asTypedValue())}}let l=n.moveStrategy&&n.moveStrategy[0];return l&&\"initialValue\"in l&&l.initialValue!==void 0&&(i.gliderParameter=l.initialValue),i}function D_(e,t,r){let n=r.parseOptions;if(!(n!=null&&n.selection))return;let{start:i,end:s,input:o}=n.selection;if(o.trim()===\"\")return{type:\"empty\",allowedTypes:[st]};let a=\"\\\\cursor\",u=o.slice(0,i)+a+\" \"+o.slice(s),l={input:u,start:i,end:i+a.length},c=zi(u,se($({},r.parseOptions),{selection:l}));return c.isError?void 0:Gu({policy:e,frame:t,selection:l},c).getCursorContext()}function ea(e,t,r){let n=e.variables;if(n&&n.length){let i={};for(let s of n)i[s]=!0;for(let s in r)i[s]=!0;r=i}e.variables=t.sliderVariables(Object.keys(r))}function mT(e,t){if(t.blocksExport)return!1;let r=t.getDependencies();if(r.length===0)return!1;for(let n of r)if(!e.validActionVariable(n))return!1;return!0}var G=class{constructor(t,r,n,i){this.policy=t,this.rawTree=n,this.concreteTree=i,this.evaluationState=aO(t,r,n,i)}exportTo(t,r){this.rawTree.exportTo(t,this.concreteTree,r)}graph(t,r){return this.rawTree.tryGraph(this.policy,this.concreteTree,t,r)}getGraphMode(){return this.policy.graphingEnabled()?this.rawTree.getGraphMode(this.policy,this.concreteTree):10}getGraphInfo(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!ii.pointsOfInterest)return!1;var t=this.getGraphMode();return t===1||t===2}};function uO(e,t){let{mappedArgIndex:r,mappedReturnIndex:n,solutionIndex:i}=t,s=[],o=Lo(e,r),a=A_(e,o,n),u=i,l=e.NanOfType(e.getReturnType());for(let c=0;c<n;c++){let p=e.getInstruction(c);if(c===r){s.push(i);continue}if(!o[c]&&!e.isInClosedBlock(c)){s.push(c);continue}if(be(p))s.push(e.copyInstruction(p));else{let f=N_(s,p.args);s.push(e.copyInstructionWithArgs(p,f)),p.type===33&&a[c]&&(u=e.Piecewise([f[0],u,l]))}}return u}function N_(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function A_(e,t,r){let n=[];for(let i=0;i<r;i++)n.push(!1);n[r]=t[r];for(let i=r;i>=0;i--){if(!n[i]||!t[i])continue;let s=e.getInstruction(i);if(s.type===33)n[s.args[1]]=!0;else if(!be(s))for(let o of s.args)n[o]=!0}return n}function lO(e,t){try{return R_(e,t)}catch(r){return r instanceof x.Base?r:ae(r)}}function R_({policy:e,frame:t},r){let n=wu(t,r),i=[];for(let A=0;A<n.length;A++)i.push(b);let s=Fx({policy:e,frame:t,argNames:n,argTypes:i,selection:void 0}),{chunk:o}=s,a=Se(s,r.args[0]),u=Se(s,r.args[1]),l=r.getOperator(),c=l!==\"=\";switch(Ro(o,e,r,[a,u]),l){case\"<\":o.Less([a,u]);break;case\">\":o.Greater([a,u]);break;case\"<=\":o.LessEqual([a,u]);break;case\">=\":o.GreaterEqual([a,u]);break;case\"=\":o.Equal([a,u]);break}if(o.setReturnIndex(Vr(o,o.getReturnIndex())),o.isConstant())return new Zt(o.close());let f=o.getInstruction(a).type!==2||wu(t,r.args[1]).indexOf(o.argNames[a])!==-1;if(!ii.plotImplicits&&f)throw zg();pn[l].direction===-1?o.Subtract([u,a]):o.Subtract([a,u]),o.close();let d=o.getLiveArgNames();if(d.length===0)throw ae(`Unexpected: non-constant node with dependencies: ${d}`);if(d.length===1&&!c&&!ii.plotSingleVariableImplicitEquations)return Gg();if(d.length>(e.is3dPolicy()?3:2))return Ut(e.sliderVariables(d)).setDependencies(d);if(c&&!e.validInequalityVariables(d))return Bg().setDependencies(d);let{localFrames:m,effectiveOrder:y,variableOfInterest:g}=C_(s,c);if(e.complicatedPolarImplicit(g,y))return qg().setDependencies(d);if(!e.validImplicitVariables(d))return ga();if(y>2||e.is3dPolicy())return new Zt(o.close());let h=[],P=[],S=1;for(let A=0;A<m.length;A++){let T=m[A],I=L_(T,c);S=I.length;for(let v of I){let D=T.chunk.copy();if(D.setReturnIndex(v),T.isRestrictedPolynomial){let{mappedArgIndex:R,mappedReturnIndex:L}=T;D.setReturnIndex(uO(D,{mappedArgIndex:R,mappedReturnIndex:L,solutionIndex:D.getReturnIndex()}))}D.close(),h.push(new Zt(D))}let E=!1;for(let v of T.coefficients){let D=T.chunk.getInstruction(v);D.type===1&&D.value!==0&&(E=!0)}if(o.argNames.length!==2||E)P.push(void 0);else{let v=T.chunk.copy(),D=T.coefficients.slice();v.List(D),v.close();let R=q(o.getReturnType())?o.elementAt(A):o.copy(),w=R.argNames.indexOf(g)===0?1:0,X=R.getReturnIndex();R.Add([w,R.Multiply([R.Constant(0),X])]),P.push({coefficients:v,restriction:R})}}return new x.SolvedEquation(g,new x.List(h),P,S)}function C_(e,t){let r=e.chunk,n=e.policy,i=r.argNames,s=q(r.getReturnType()),o=[];e:for(let a=0;a<i.length;a++){let u=i[a],l=i.length>1&&!n.validSolvedVariable(u);o[a]={localFrames:[],effectiveOrder:0,variableOfInterest:u};let c=!t;if(l){o[a].effectiveOrder=1/0;continue}let p=s?r.getConstantListLength():1;if(p==null)throw new Error(\"Programming error: cannot solve a variable-length list expression\");for(let f=0;f<p;f++){let d=s?r.elementAt(f):r;if(d.polynomialOrder(u,{allowRestriction:c,allowClosedBlockReferences:!1})>2){o[a].effectiveOrder=1/0;continue e}let y=d.getPolynomialCoefficients(u);o[a].localFrames.push(y),o[a].effectiveOrder=Math.max(o[a].effectiveOrder,y.coefficients.length-1)}}return i.length===1?o[0]:(i[0]===\"y\"&&(o=[o[1],o[0]]),o[0].effectiveOrder===0?o[1]:o[1].effectiveOrder===0?o[0]:o[o[0].effectiveOrder<o[1].effectiveOrder?0:1])}function L_(e,t){return t?__(e):w_(e)}function w_({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(Me(0,1)),o=e.Constant(NaN);if(i===void 0){n===void 0&&(n=s);let a=e.Negative([e.Divide([r,n])]),u=e.Equal([n,s]);return[e.Piecewise([u,o,a])]}else{let a=e.Constant(Me(2,1)),u=e.Multiply([a,i]),l=e.Negative([n]),c=e.Subtract([e.Multiply([n,n]),e.Multiply([a,e.Multiply([u,r])])]),p=e.Equal([i,s]),f=e.getInstruction(c);if(f.type===1&&B(f.value)===0)return[e.Piecewise([p,o,e.Divide([l,u])])];{let d=e.SyntheticNativeFunction(\"sqrt\",[c]),m=e.Less([n,s]),y=e.Greater([n,s]),g=e.Divide([e.Add([l,d]),u]),h=e.Divide([e.Subtract([l,d]),u]),P=e.Negative([e.Divide([r,n])]);return[e.Piecewise([p,e.Piecewise([m,P,o]),h]),e.Piecewise([p,e.Piecewise([y,P,o]),g])]}}}function __({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(Me(0,1));i===void 0&&(i=s),n===void 0&&(n=s),r===void 0&&(r=s);let o=e.Constant(Me(2,1)),a=e.Constant(NaN),u=e.Constant(Me(1e305,1)),l=e.Negative([u]),c=e.Multiply([o,i]),p=e.Negative([n]),f=e.Subtract([e.Multiply([n,n]),e.Multiply([o,e.Multiply([c,r])])]),d=e.SyntheticNativeFunction(\"sqrt\",[f]),m=e.Divide([e.Add([p,d]),c]),y=e.Divide([e.Subtract([p,d]),c]),g=e.Negative([e.Divide([r,n])]),h=e.Equal([i,s]),P=e.Greater([i,s]),S=e.Equal([n,s]),A=e.Greater([n,s]),T=e.Less([n,s]),I=e.Greater([r,s]),E=e.Less([f,s]);return[e.Piecewise([h,e.Piecewise([T,g,a]),e.Piecewise([P,y,a])]),e.Piecewise([h,e.Piecewise([S,e.Piecewise([I,l,a]),a]),e.Piecewise([P,e.Piecewise([E,l,a]),m])]),e.Piecewise([h,e.Piecewise([S,e.Piecewise([I,u,a]),a]),e.Piecewise([P,e.Piecewise([E,u,a]),y])]),e.Piecewise([h,e.Piecewise([A,g,a]),e.Piecewise([P,m,a])])]}var _=function(){};_.version=\"1.2.6\";_._myIndexOf=function(t){var r=this.length,n;for(n=0;n<r;++n)if(this[n]===t)return n;return-1};_.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:_._myIndexOf;_.precision=4;_.largeArray=50;_.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t=\"return function (\"+e.join(\",\")+\") {\"+t+\"}\",new Function([\"numeric\"],t)(_)};_._dim=function(t){for(var r=[];typeof t==\"object\";)r.push(t.length),t=t[0];return r};_.dim=function(t){var r,n;return typeof t==\"object\"?(r=t[0],typeof r==\"object\"?(n=r[0],typeof n==\"object\"?_._dim(t):[t.length,r.length]):[t.length]):[]};_.mapreduce=function(t,r){return _.compile(\"x\",\"accum\",\"_s\",\"_k\",'if(typeof accum === \"undefined\") accum = '+r+`;\nif(typeof x === \"number\") { var xi = x; `+t+`; return accum; }\nif(typeof _s === \"undefined\") _s = numeric.dim(x);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    `+t+`;\n    xi = x[i-1];\n    `+t+`;\n}\nif(i === 0) {\n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};_.mapreduce2=function(t,r){return _.compile(\"x\",`var n = x.length;\nvar i,xi;\n`+r+`\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};_.rep=function(t,r,n){typeof n==\"undefined\"&&(n=0);var i=t[n],s=Array(i),o;if(n===t.length-1){for(o=i-2;o>=0;o-=2)s[o+1]=r,s[o]=r;return o===-1&&(s[0]=r),s}for(o=i-1;o>=0;o--)s[o]=_.rep(t,r,n+1);return s};_.dotMMsmall=function(t,r){var n,i,s,o,a,u,l,c,p,f,d,m,y,g;for(o=t.length,a=r.length,u=r[0].length,l=Array(o),n=o-1;n>=0;n--){for(c=Array(u),p=t[n],s=u-1;s>=0;s--){for(f=p[a-1]*r[a-1][s],i=a-2;i>=1;i-=2)d=i-1,f+=p[i]*r[i][s]+p[d]*r[d][s];i===0&&(f+=p[0]*r[0][s]),c[s]=f}l[n]=c}return l};_._getCol=function(t,r,n){var i=t.length,s;for(s=i-1;s>0;--s)n[s]=t[s][r],--s,n[s]=t[s][r];s===0&&(n[0]=t[0][r])};_.dotMMbig=function(t,r){var n=_._getCol,i=r.length,s=Array(i),o=t.length,a=r[0].length,u=new Array(o),l,c=_.dotVV,p,f,d,m;for(--i,--o,p=o;p!==-1;--p)u[p]=Array(a);for(--a,p=a;p!==-1;--p)for(n(r,p,s),f=o;f!==-1;--f)m=0,l=t[f],u[f][p]=c(l,s);return u};_.dotMV=function(t,r){var n=t.length,i=r.length,s,o=Array(n),a=_.dotVV;for(s=n-1;s>=0;s--)o[s]=a(t[s],r);return o};_.dotVM=function(t,r){var n,i,s,o,a,u,l,c,p,f,d,m,y,g,h,P,S,A,T;for(o=t.length,a=r[0].length,l=Array(a),s=a-1;s>=0;s--){for(f=t[o-1]*r[o-1][s],i=o-2;i>=1;i-=2)d=i-1,f+=t[i]*r[i][s]+t[d]*r[d][s];i===0&&(f+=t[0]*r[0][s]),l[s]=f}return l};_.dotVV=function(t,r){var n,i=t.length,s,o=t[i-1]*r[i-1];for(n=i-2;n>=1;n-=2)s=n-1,o+=t[n]*r[n]+t[s]*r[s];return n===0&&(o+=t[0]*r[0]),o};_.dot=function(t,r){var n=_.dim;switch(n(t).length*1e3+n(r).length){case 2002:return r.length<10?_.dotMMsmall(t,r):_.dotMMbig(t,r);case 2001:return _.dotMV(t,r);case 1002:return _.dotVM(t,r);case 1001:return _.dotVV(t,r);case 1e3:return _.mulVS(t,r);case 1:return _.mulSV(t,r);case 0:return t*r;default:throw new Error(\"numeric.dot only works on vectors and matrices\")}};_.diag=function(t){var r,n,i,s=t.length,o=Array(s),a;for(r=s-1;r>=0;r--){for(a=Array(s),n=r+2,i=s-1;i>=n;i-=2)a[i]=0,a[i-1]=0;for(i>r&&(a[i]=0),a[r]=t[r],i=r-1;i>=1;i-=2)a[i]=0,a[i-1]=0;i===0&&(a[0]=0),o[r]=a}return o};_.getDiag=function(e){var t=Math.min(e.length,e[0].length),r,n=Array(t);for(r=t-1;r>=1;--r)n[r]=e[r][r],--r,n[r]=e[r][r];return r===0&&(n[0]=e[0][0]),n};_.identity=function(t){return _.diag(_.rep([t],1))};_.pointwise=function(t,r,n){typeof n==\"undefined\"&&(n=\"\");var i=[],s,o=/\\[i\\]$/,a,u=\"\",l=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a===\"ret\"&&(l=!0),i.push(a);return i[t.length]=\"_s\",i[t.length+1]=\"_k\",i[t.length+2]='if(typeof _s === \"undefined\") _s = numeric.dim('+u+`);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i`+(l?\"\":\", ret = Array(_n)\")+`;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(\",\")+`,_s,_k+1);\n    return ret;\n}\n`+n+`\nfor(i=_n-1;i!==-1;--i) {\n    `+r+`\n}\nreturn ret;`,_.compile.apply(null,i)};_.pointwise2=function(t,r,n){typeof n==\"undefined\"&&(n=\"\");var i=[],s,o=/\\[i\\]$/,a,u=\"\",l=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a===\"ret\"&&(l=!0),i.push(a);return i[t.length]=\"var _n = \"+u+`.length;\nvar i`+(l?\"\":\", ret = Array(_n)\")+`;\n`+n+`\nfor(i=_n-1;i!==-1;--i) {\n`+r+`\n}\nreturn ret;`,_.compile.apply(null,i)};_._biforeach=function e(t,r,n,i,s){if(i===n.length-1){s(t,r);return}var o,a=n[i];for(o=a-1;o>=0;o--)e(typeof t==\"object\"?t[o]:t,typeof r==\"object\"?r[o]:r,n,i+1,s)};_._biforeach2=function e(t,r,n,i,s){if(i===n.length-1)return s(t,r);var o,a=n[i],u=Array(a);for(o=a-1;o>=0;--o)u[o]=e(typeof t==\"object\"?t[o]:t,typeof r==\"object\"?r[o]:r,n,i+1,s);return u};_._foreach=function e(t,r,n,i){if(n===r.length-1){i(t);return}var s,o=r[n];for(s=o-1;s>=0;s--)e(t[s],r,n+1,i)};_._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var s,o=r[n],a=Array(o);for(s=o-1;s>=0;s--)a[s]=e(t[s],r,n+1,i);return a};_.ops2={add:\"+\",sub:\"-\",mul:\"*\",div:\"/\",mod:\"%\",and:\"&&\",or:\"||\",eq:\"===\",neq:\"!==\",lt:\"<\",gt:\">\",leq:\"<=\",geq:\">=\",band:\"&\",bor:\"|\",bxor:\"^\",lshift:\"<<\",rshift:\">>\",rrshift:\">>>\"};_.opseq={addeq:\"+=\",subeq:\"-=\",muleq:\"*=\",diveq:\"/=\",modeq:\"%=\",lshifteq:\"<<=\",rshifteq:\">>=\",rrshifteq:\">>>=\",bandeq:\"&=\",boreq:\"|=\",bxoreq:\"^=\"};_.mathfuns=[\"abs\",\"acos\",\"asin\",\"atan\",\"ceil\",\"cos\",\"exp\",\"floor\",\"log\",\"round\",\"sin\",\"sqrt\",\"tan\",\"isNaN\",\"isFinite\"];_.mathfuns2=[\"atan2\",\"pow\",\"max\",\"min\"];_.ops1={neg:\"-\",not:\"!\",bnot:\"~\",clone:\"\"};_.mapreducers={any:[\"if(xi) return true;\",\"var accum = false;\"],all:[\"if(!xi) return false;\",\"var accum = true;\"],sum:[\"accum += xi;\",\"var accum = 0;\"],prod:[\"accum *= xi;\",\"var accum = 1;\"],norm2Squared:[\"accum += xi*xi;\",\"var accum = 0;\"],norminf:[\"accum = max(accum,abs(xi));\",\"var accum = 0, max = Math.max, abs = Math.abs;\"],norm1:[\"accum += abs(xi);\",\"var accum = 0, abs = Math.abs;\"],sup:[\"accum = max(accum,xi);\",\"var accum = -Infinity, max = Math.max;\"],inf:[\"accum = min(accum,xi);\",\"var accum = Infinity, min = Math.min;\"]};(function(){var e,t;for(e=0;e<_.mathfuns2.length;++e)t=_.mathfuns2[e],_.ops2[t]=t;for(e in _.ops2)if(_.ops2.hasOwnProperty(e)){t=_.ops2[e];var r,n,i=\"\";_.myIndexOf.call(_.mathfuns2,e)!==-1?(i=\"var \"+t+\" = Math.\"+t+`;\n`,r=function(s,o,a){return s+\" = \"+t+\"(\"+o+\",\"+a+\")\"},n=function(s,o){return s+\" = \"+t+\"(\"+s+\",\"+o+\")\"}):(r=function(s,o,a){return s+\" = \"+o+\" \"+t+\" \"+a},_.opseq.hasOwnProperty(e+\"eq\")?n=function(s,o){return s+\" \"+t+\"= \"+o}:n=function(s,o){return s+\" = \"+s+\" \"+t+\" \"+o}),_[e+\"VV\"]=_.pointwise2([\"x[i]\",\"y[i]\"],r(\"ret[i]\",\"x[i]\",\"y[i]\"),i),_[e+\"SV\"]=_.pointwise2([\"x\",\"y[i]\"],r(\"ret[i]\",\"x\",\"y[i]\"),i),_[e+\"VS\"]=_.pointwise2([\"x[i]\",\"y\"],r(\"ret[i]\",\"x[i]\",\"y\"),i),_[e]=_.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric.`+e+\"VV, VS = numeric.\"+e+\"VS, SV = numeric.\"+e+`SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === \"object\") {\n      if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else `+n(\"x\",\"y\")+`\n}\nreturn x;\n`),_[t]=_[e],_[e+\"eqV\"]=_.pointwise2([\"ret[i]\",\"x[i]\"],n(\"ret[i]\",\"x[i]\"),i),_[e+\"eqS\"]=_.pointwise2([\"ret[i]\",\"x\"],n(\"ret[i]\",\"x\"),i),_[e+\"eq\"]=_.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric.`+e+\"eqV, S = numeric.\"+e+`eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === \"object\") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n`)}for(e=0;e<_.mathfuns2.length;++e)t=_.mathfuns2[e],delete _.ops2[t];for(e=0;e<_.mathfuns.length;++e)t=_.mathfuns[e],_.ops1[t]=t;for(e in _.ops1)_.ops1.hasOwnProperty(e)&&(i=\"\",t=_.ops1[e],_.myIndexOf.call(_.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(i=\"var \"+t+\" = Math.\"+t+`;\n`),_[e+\"eqV\"]=_.pointwise2([\"ret[i]\"],\"ret[i] = \"+t+\"(ret[i]);\",i),_[e+\"eq\"]=_.compile(\"x\",'if(typeof x !== \"object\") return '+t+`x\nvar i;\nvar V = numeric.`+e+`eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n`),_[e+\"V\"]=_.pointwise2([\"x[i]\"],\"ret[i] = \"+t+\"(x[i]);\",i),_[e]=_.compile(\"x\",'if(typeof x !== \"object\") return '+t+`(x)\nvar i;\nvar V = numeric.`+e+`V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n`));for(e=0;e<_.mathfuns.length;++e)t=_.mathfuns[e],delete _.ops1[t];for(e in _.mapreducers)_.mapreducers.hasOwnProperty(e)&&(t=_.mapreducers[e],_[e+\"V\"]=_.mapreduce2(t[0],t[1]),_[e]=_.compile(\"x\",\"s\",\"k\",t[1]+`if(typeof x !== \"object\") {    xi = x;\n`+t[0]+`\n    return accum;\n}if(typeof s === \"undefined\") s = numeric.dim(x);\nif(typeof k === \"undefined\") k = 0;\nif(k === s.length-1) return numeric.`+e+`V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n`+t[0]+`\n}\nreturn accum;\n`))})();_.inv=function(y){var r=_.dim(y),n=Math.abs,i=r[0],s=r[1],o=_.clone(y),a,u,l=_.identity(i),c,p,f,d,m,y;for(d=0;d<s;++d){var g=-1,h=-1;for(f=d;f!==i;++f)m=n(o[f][d]),m>h&&(g=f,h=m);for(u=o[g],o[g]=o[d],o[d]=u,p=l[g],l[g]=l[d],l[d]=p,y=u[d],m=d;m!==s;++m)u[m]/=y;for(m=s-1;m!==-1;--m)p[m]/=y;for(f=i-1;f!==-1;--f)if(f!==d){for(a=o[f],c=l[f],y=a[d],m=d+1;m!==s;++m)a[m]-=u[m]*y;for(m=s-1;m>0;--m)c[m]-=p[m]*y,--m,c[m]-=p[m]*y;m===0&&(c[0]-=p[0]*y)}}return l};_.det=function(t){var r=_.dim(t);if(r.length!==2||r[0]!==r[1])throw new Error(\"numeric: det() only works on square matrices\");var n=r[0],i=1,s,o,a,u=_.clone(t),l,c,p,f,d,m,y;for(o=0;o<n-1;o++){for(a=o,s=o+1;s<n;s++)Math.abs(u[s][o])>Math.abs(u[a][o])&&(a=s);for(a!==o&&(f=u[a],u[a]=u[o],u[o]=f,i*=-1),l=u[o],s=o+1;s<n;s++){for(c=u[s],p=c[o]/l[o],a=o+1;a<n-1;a+=2)d=a+1,c[a]-=l[a]*p,c[d]-=l[d]*p;a!==n&&(c[a]-=l[a]*p)}if(l[o]===0)return 0;i*=l[o]}return i*u[o][o]};_.transpose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,l;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)l=o[n],l[r]=u[n],l[r-1]=a[n],--n,l=o[n],l[r]=u[n],l[r-1]=a[n];n===0&&(l=o[0],l[r]=u[0],l[r-1]=a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=a[n],--n,o[n][0]=a[n];n===0&&(o[0][0]=a[0])}return o};_.negtranspose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,l;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)l=o[n],l[r]=-u[n],l[r-1]=-a[n],--n,l=o[n],l[r]=-u[n],l[r-1]=-a[n];n===0&&(l=o[0],l[r]=-u[0],l[r-1]=-a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=-a[n],--n,o[n][0]=-a[n];n===0&&(o[0][0]=-a[0])}return o};_.norm2=function(t){return Math.sqrt(_.norm2Squared(t))};_.linspace=function(t,r,n){if(typeof n==\"undefined\"&&(n=Math.max(Math.round(r-t)+1,1)),n<2)return n===1?[t]:[];var i,s=Array(n);for(n--,i=n;i>=0;i--)s[i]=(i*r+(n-i)*t)/n;return s};_.getBlock=function(t,r,n){var i=_.dim(t);function s(o,a){var u,l=r[a],c=n[a]-l,p=Array(c);if(a===i.length-1){for(u=c;u>=0;u--)p[u]=o[u+l];return p}for(u=c;u>=0;u--)p[u]=s(o[u+l],a+1);return p}return s(t,0)};_.setBlock=function(t,r,n,i){var s=_.dim(t);function o(a,u,l){var c,p=r[l],f=n[l]-p;if(l===s.length-1)for(c=f;c>=0;c--)a[c+p]=u[c];for(c=f;c>=0;c--)o(a[c+p],u[c],l+1)}return o(t,i,0),t};_.getRange=function(t,r,n){var i=r.length,s=n.length,o,a,u=Array(i),l,c;for(o=i-1;o!==-1;--o)for(u[o]=Array(s),l=u[o],c=t[r[o]],a=s-1;a!==-1;--a)l[a]=c[n[a]];return u};_.blockMatrix=function(t){var r=_.dim(t);if(r.length<4)return _.blockMatrix([t]);var n=r[0],i=r[1],s,o,a,u,l;for(s=0,o=0,a=0;a<n;++a)s+=t[a][0].length;for(u=0;u<i;++u)o+=t[0][u][0].length;var c=Array(s);for(a=0;a<s;++a)c[a]=Array(o);var p=0,f,d,m,y,g;for(a=0;a<n;++a){for(f=o,u=i-1;u!==-1;--u)for(l=t[a][u],f-=l[0].length,m=l.length-1;m!==-1;--m)for(g=l[m],d=c[p+m],y=g.length-1;y!==-1;--y)d[f+y]=g[y];p+=t[a][0].length}return c};_.tensor=function(t,r){if(typeof t==\"number\"||typeof r==\"number\")return _.mul(t,r);var n=_.dim(t),i=_.dim(r);if(n.length!==1||i.length!==1)throw new Error(\"numeric: tensor product is only defined for vectors\");var s=n[0],o=i[0],a=Array(s),u,l,c,p;for(l=s-1;l>=0;l--){for(u=Array(o),p=t[l],c=o-1;c>=3;--c)u[c]=p*r[c],--c,u[c]=p*r[c],--c,u[c]=p*r[c],--c,u[c]=p*r[c];for(;c>=0;)u[c]=p*r[c],--c;a[l]=u}return a};_.epsilon=2220446049250313e-31;_.LU=function(e,t){t=t||!1;var r=Math.abs,n,i,s,o,a,u,l,c,p,f=e.length,d=f-1,m=new Array(f);for(t||(e=_.clone(e)),s=0;s<f;++s){for(l=s,u=e[s],p=r(u[s]),i=s+1;i<f;++i)o=r(e[i][s]),p<o&&(p=o,l=i);for(m[s]=l,l!=s&&(e[s]=e[l],e[l]=u,u=e[s]),a=u[s],n=s+1;n<f;++n)e[n][s]/=a;for(n=s+1;n<f;++n){for(c=e[n],i=s+1;i<d;++i)c[i]-=c[s]*u[i],++i,c[i]-=c[s]*u[i];i===d&&(c[i]-=c[s]*u[i])}}return{LU:e,P:m}};_.LUsolve=function(t,r){var n,i,s=t.LU,o=s.length,a=_.clone(r),u=t.P,l,c,p,f;for(n=o-1;n!==-1;--n)a[n]=r[n];for(n=0;n<o;++n)for(l=u[n],u[n]!==n&&(f=a[n],a[n]=a[l],a[l]=f),c=s[n],i=0;i<n;++i)a[n]-=a[i]*c[i];for(n=o-1;n>=0;--n){for(c=s[n],i=n+1;i<o;++i)a[n]-=a[i]*c[i];a[n]/=c[n]}return a};_.solve=function(t,r,n){return _.LUsolve(_.LU(t,n),r)};var ar=_;function F_(e,t){let r=e.length,n=t.length,i=0,s=0;for(let a=n-r;a<n;a++)i+=e[a+r-n]*t[a],s+=e[a+r-n]*e[a+r-n];let o=i/s;for(let a=n-r;a<n;a++)t[a]=2*o*e[a+r-n]-t[a]}function V_(e,t,r){let n=e.length,i=t.length,s=0,o=0;for(let u=i-n;u<i;u++)s+=e[u+n-i]*t[u][r],o+=e[u+n-i]*e[u+n-i];let a=s/o;for(let u=i-n;u<i;u++)t[u][r]=2*a*e[u+n-i]-t[u][r]}function B_(e,t,r,n){let i=Array(e.length-t);if(i.length===1)return i[0]=1,i;if(n===0){i[0]=1;for(let o=1;o<i.length;o++)i[o]=0;return i}let s=e[t][r]<0?-1:1;i[0]=e[t][r]+s*Math.sqrt(n);for(let o=t+1;o<e.length;o++)i[o-t]=e[o][r];return i}function G_(e,t,r){let n=0;for(;t<e.length;t++)n+=e[t][r]*e[t][r];return n}function mm(e,t){if(!t||!t.mutateInput){let s=e;e=Array(e.length);for(let o=0;o<s.length;o++)e[o]=s[o].slice()}let r=Math.min(e.length,e[0].length),n=Array(r),i=[];for(let s=0;s<r;s++){let o=-1/0,a=s;for(let l=s;l<e[s].length;l++){let c=G_(e,s,l);c>o&&(o=c,a=l)}if(n[s]=a,a!==s)for(let l=0;l<e.length;l++){let c=e[l][a];e[l][a]=e[l][s],e[l][s]=c}let u=B_(e,s,s,o);for(let l=s;l<e[s].length;l++)V_(u,e,l);i.push(u)}return{reflectors:i,r:e,p:n}}function cO(e,t,r){let{reflectors:n,r:i,p:s}=e,o=t.slice();for(let l=0;l<n.length;l++)F_(n[l],o);for(let l=n.length;l<i[0].length;l++)o[l]=0;o.length=i[0].length;let a=Math.pow(2,-52),u=r.regularize?a*Math.abs(i[0][0])*Math.max(i.length,i[0].length):0;for(let l=n.length-1;l>=0;l--){let c=i[l];if(Math.abs(c[l])<=u)o[l]=0;else{for(let p=l+1;p<n.length;p++)o[l]-=o[p]*c[p];o[l]/=c[l]}}for(let l=s.length-1;l>=0;l--)if(s[l]!==l){let c=o[l];o[l]=o[s[l]],o[s[l]]=c}return o}function z_(e,t,r){let n=Array(e.r[0].length);for(let s=0;s<n.length;s++)n[s]=Array(t[0].length);let i=Array(t.length);for(let s=0;s<t[0].length;s++){for(let a=0;a<t.length;a++)i[a]=t[a][s];let o=cO(e,i,r);for(let a=0;a<o.length;a++)n[a][s]=o[a]}return n}function Ya(e,t,r){return Array.isArray(t[0])?z_(e,t,r):cO(e,t,r)}function q_(e){let t=e.r,r=Math.min(t.length,t[0].length),n=t[0][0],i=t[r-1][r-1];return n===0?1/0:Math.abs(n/i)}function pO(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*q_(e)<1}var U_=Math.pow(2,-52);function gm(e){for(let t of e)for(let r of t)if(!er(r))return!1;return!0}function H_(e){let t=[];for(let r of e)t.push(r.slice());return t}function dO(e){let{numRows:t,numCols:r}=ym(e),n=[];for(let i=0;i<r;i++)n.push([]);for(let i=0;i<t;i++)for(let s=0;s<r;s++)n[s].push(e[i][s]);return n}function ym(e){let t=e.length,r=t>0?e[0].length:0;return{numRows:t,numCols:r}}function k_(){throw new Error(\"Matrix dimension mismatch\")}function yT(e,t){let r=ym(e),n=ym(t);r.numCols!==n.numRows&&k_();let i=[];for(let s=0;s<r.numRows;s++){let o=[];for(let a=0;a<n.numCols;a++){let u=Me(0,1);for(let l=0;l<e[s].length;l++)u=Ms(u,Es(e[s][l],t[l][a]));o.push(u)}i.push(o)}return i}function mO(e){let t=H_(e);return Y_(t),t}function $_(e){let t=0;for(let r of e)for(let n of r){let i=Math.abs(B(n));if(!isFinite(i))return NaN;i>t&&(t=i)}return t}function fO(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=NaN}function Y_(e){let{numRows:t,numCols:r}=ym(e),n=$_(e);if(!isFinite(n))return fO(e),{determinant:NaN,rank:0};let i=Math.max(t,r)*n*U_,s=Me(1,1),o=0,a=0;for(;o<t&&a<r;){let u=o,l=Math.abs(B(e[o][a]));for(let p=o+1;p<t;p++){let f=Math.abs(B(e[p][a]));(!isFinite(f)||f>l)&&(l=f,u=p)}if(!isFinite(l))return fO(e),{determinant:NaN,rank:0};if(l===0){s=Me(0,1),a+=1;continue}if(!er(e[u][a])&&l<i){for(let p=o;p<t;p++)e[o][p]=0;s=0,a+=1;continue}if(u!==o){s=li(s);let p=e[o];e[o]=e[u],e[u]=p}for(let p=0;p<t;p++){if(p===o)continue;let f=Ki(e[p][a],e[o][a]);e[p][a]=Me(0,1);for(let d=a+1;d<r;d++)e[p][d]=Qi(e[p][d],Es(f,e[o][d]))}let c=e[o][a];s=Es(s,c),e[o][a]=Me(1,1);for(let p=a+1;p<r;p++)e[o][p]=Ki(e[o][p],c);o+=1,a+=1}return{rank:o,determinant:o===t&&o===r?s:Me(0,1)}}function bm(e,t){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function ra(e,t){let r=ta(e,t),n=0;for(let i of r){let s=i;n+=s*s}return n/r.length}function ta(e,t){return e.apply(void 0,t)}function hm(e,t){let r=[];for(let n of e){let i=n.apply(void 0,t);r.push(i)}return r}function yO(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function gT(e,t,r){let n=[];for(let i=0,s=0;i<e.length;i++){let o=0;r[i]&&(o=t[s],s+=1),n.push(e[i]+o)}return n}function xT(e,t){let r=t.solution.map(u=>Math.abs(u)<1e-6?0:u),n=t.solution.map(()=>0),i=ra(e,r),s=ta(e,r),o=ta(e,n),a=0;for(let u=0;u<s.length;u++){let l=o[u]*1e-15;a+=Math.abs(s[u]*l)+l*l}return a/=s.length,isFinite(a)||(a=0),isFinite(t.MSE)&&!isFinite(i)?t:i<=t.MSE+a?{solution:r,MSE:i}:t}function TT(e,t){if(!gm(t)||!gm([e]))return;let r=dO(t),n=yT([e],r)[0],i=yT(t,r);for(let l=0;l<n.length;l++)i[l].push(li(n[l]));let s=mO(i);if(!gm(s))return;let o=[],a=n.length,u=0;for(let l of s)for(;u<a;)if(B(l[u])===1){o.push(l[l.length-1]),u++;break}else o.push(Me(0,1)),u++;for(;u<a;)o.push(Me(0,1)),u++;return o}function PT(e,t){let r=bm(0,t.length),n=hm(t,r),i=mm(ar.transpose(n),{mutateInput:!0});for(var s=0;s<2;s++){let l=ta(e,r),c=ar.neg(Ya(i,l,{regularize:!1}));r=ar.add(r,c)}let o=ra(e,r);if(pO(i))return{solution:r,MSE:o};let a=bm(0,t.length);for(var s=0;s<2;s++){let c=ta(e,a),p=ar.neg(Ya(i,c,{regularize:!0}));a=ar.add(a,p)}let u=ra(e,a);return .999*u<=o?{solution:a,MSE:u}:{solution:r,MSE:o}}function hT(e,t,r,n){let i=n.maxIterations,s=n.linearSubset||bm(!1,r.length),o=ar.not(s),a=yO(t,s),u=yO(t,o),l=2,c=.1,p=r,f=0,d=.001,m;if(ar.any(s)){let h=ar.transpose(hm(a,p)),P=mm(h);m={Jv:h,F:P};let S=ta(e,p),A=ar.neg(Ya(P,S,{regularize:!0}));p=gT(p,A,s)}let y=!1,g=ra(e,p);for(;f<i&&!y&&isFinite(g);){let h=ta(e,p),P=hm(u,p),S=ar.transpose(P),A,T;if(m){let{F:v,Jv:D}=m;A=ar.dot(P,ar.sub(h,ar.dot(D,Ya(v,h,{regularize:!0})))),T=ar.dot(P,ar.sub(S,ar.dot(D,Ya(v,S,{regularize:!0}))))}else A=ar.dot(P,h),T=ar.dot(P,S);let I=p,E=!1;for(;f<i&&!y&&!E;){f+=1;let v=ar.add(T,ar.diag(bm(d,u.length))),D=ar.neg(ar.solve(v,A,!0));I=gT(p,D,o),y=ar.all(ar.eq(I,p));let R;if(m){let w=ar.transpose(hm(a,I)),X=mm(w);R={Jv:w,F:X};let H=ta(e,I),Z=ar.neg(Ya(X,H,{regularize:!0}));I=gT(I,Z,s)}let L=ra(e,I);E=L<g,E?(p=I,g=L,m=R,d*=c):(d=Math.max(d,1e-64),d*=l)}}return{solution:p,MSE:g}}var bT=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500],W_=function(e){let t=e*503%bT.length;return bT[t]},Z_=function(e){let t=[];for(let r=0;r<bT.length;r++){let n=[];for(let i=0;i<e;i++)r===0&&e!==1?n[i]=0:r===1&&e!==1?n[i]=1:n[i]=W_(r*e+i);t.push(n)}return t},gO=function(e,t,r,n,i){let s=[];for(let a of r)s.push({soln:hT(e,t,a,i),initialGuess:a});s.sort(function(a,u){return isNaN(a.soln.MSE)?1:isNaN(u.soln.MSE)?-1:a.soln.MSE-u.soln.MSE});let o=[];for(let a=0;a<n;a++)o.push(s[a].initialGuess);return o};function j_(e,t,r,n){if(!t||t.type!==\"known\")return e;let i=t.bounds;return i[0]===-1/0&&i[1]===1/0?e:i[0]===-1/0?i[1]-Math.exp(-e):i[1]===1/0?i[0]+Math.exp(e):r/(n-1)*i[1]+(n-1-r)/(n-1)*i[0]}var hO=[3,5,7,11,13,17,19];function J_(e,t){let r=[];for(let i=0;i<e.length;i++){let s=e[i],o=[];for(let a=0;a<s.length;a++){var n=hO[a%hO.length]*i%e.length;o.push(j_(s[a],t[a],n,e.length))}r.push(o)}return r}function bO(e,t,r){r||(r={});let{linearSubset:n,bounds:i,preferredInitialGuess:s}=r,o=Z_(t.length);i&&(o=J_(o,i));let a=gO(e,t,o,5,{maxIterations:3,linearSubset:n}),u=gO(e,t,a,1,{maxIterations:60,linearSubset:n}),l=hT(e,t,u[0],{maxIterations:250,linearSubset:n});if(!s)return l;let c=hT(e,t,s,{maxIterations:100,linearSubset:n});return isFinite(c.MSE)&&(c.MSE<l.MSE||cn(c.MSE,l.MSE,8))?c:l}function IT(e){return{chunk:e,isLazy:!0}}function xO(e){return e.slice()}function Tm(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:xO,reverseParameterMap:xO,isLazy:!1,valueMap:nF(e.chunk.instructionsLength()),replacementMask:ju(e.chunk.argNames.length)}}function TO(e){let{chunk:t,forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s,replacementMask:o,didShiftScale:a}=e;return{chunk:t.copy(),forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s.slice(),replacementMask:o.slice(),didShiftScale:a}}function Q_(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function MO(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r);if(i.args.length!==2)return;let s=i.args[0],o=i.args[n],a=[],u=[];a.push(s),u.push({min:1,max:cs(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\"),length:cs(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\")});let l=!1,c=!1;for(let g=s+1;g<=o;g++){let h=e.getInstruction(g);if(h.type===39||h.type===41||h.type===40){if(h.args[1]!==s)continue;let P=h.args[0];if(e.getInstruction(P).valueType!==j||!Gt(e.getInstruction(P)))continue;let S=_t(e,P),A=Q_(S);if(!isFinite(A.min)||!isFinite(A.max))continue;a.push(g),u.push(A)}else if(h.type===37)h.symbol===\"exp\"?c=!0:IO(h)&&(l=!0);else if(h.type===12||h.type===13)c=!0;else if(On(h)||$r(h))return}if(a.length===0||!c&&!l)return;let p=[];for(let g=0;g<=o;g++){let h=a.indexOf(g);if(h!==-1){let P=ju(a.length);P[h]=!0,p.push(P)}else p.push(xm(e,p,a.length,g))}let f=[];for(let g=0;g<=e.getReturnIndex();g++)if(e.getInstruction(g).type===2){let P=ju(e.argNames.length);P[g]=!0,f.push(P)}else f.push(xm(e,f,e.argNames.length,g));let d={listAccessDependencyTable:p,listAccesses:a,listStatisticsTable:u},m;for(let g=s+1;g<=e.getReturnIndex();g++){let h=e.getInstruction(g);switch(h.type){case 37:{if(h.symbol===\"exp\"){let Z=h.args[0],K=MT(d,Z);if(K===void 0){yo(e,f,m,g);break}let{listStatistics:J,listAccessIndex:ce}=K,ge=Oc(IT(e),g,Z,ce,J);ge?m=[ge]:yo(e,f,m,g)}break}case 12:case 13:{let[Z,K]=h.args,J=MT(d,K);if(J===void 0||PO(d,Z)){yo(e,f,m,g);break}let{listStatistics:ce,listAccessIndex:ge}=J,ie=eF(IT(e),g,ge,ce);ie?m=[ie]:yo(e,f,m,g);break}case 10:if(m&&m.length>1){yo(e,f,m,g);break}let P=m&&m.length>0?m[0]:IT(e),[S,A]=h.args,T=P.isLazy?S:P.valueMap[S],I=P.isLazy?A:P.valueMap[A],E=P.chunk.getInstruction(T),v=P.chunk.getInstruction(I),D,R,L;if(E.type===37)D=S,L=E,R=A;else if(v.type===37)D=A,L=v,R=S;else{yo(e,f,m,g);break}let w=MT(d,D);if(w===void 0||PO(d,R)){yo(e,f,m,g);break}let{listAccessIndex:X,listStatistics:H}=w;if(L.symbol===\"exp\"){let Z=tF(P,g,R,D,X,H);if(Z){m=Z;break}}else if(IO(L)){let Z=K_(P,g,R,D,X);if(Z){m=[Z];break}}yo(e,f,m,g);break;default:{yo(e,f,m,g);break}}}if(m===void 0||m.length===0)return;let y=[];for(let g of m)y.push({chunk:g.chunk.close(),forwardParameterMap:g.forwardParameterMap,reverseParameterMap:g.reverseParameterMap});return y}function yo(e,t,r,n){if(r===void 0)return;let i=e.getInstruction(n);if(be(i))for(let s of r)s.valueMap[n]=n;else for(let s of r){let{chunk:o,valueMap:a}=s,u=[],l=0;for(let c of i.args){if(a[c]!==c){if(l+=1,l>1){r.length=0;return}}else{let p=t[c];for(let f=0;f<p.length;f++)if(p[f]&&s.replacementMask[f]){r.length=0;return}}u.push(a[c])}a[n]=l>0?or(o,i,u):n}}function MT(e,t){let{listAccessDependencyTable:r,listAccesses:n,listStatisticsTable:i}=e,s,o=r[t];for(let a=0;a<o.length;a++)if(o[a]){if(s)return;s={listAccessIndex:n[a],listStatistics:i[a]}}return s}function PO(e,t){let{listAccessDependencyTable:r}=e,n=r[t];for(let i of n)if(i)return!0;return!1}function ET(e,t){let r=[];for(let s=0;s<=t;s++)if(e.getInstruction(s).type===2){let a=ju(e.argNames.length);a[s]=!0,r.push(a)}else r.push(xm(e,r,e.argNames.length,s));let n,i=r[t];for(let s=0;s<i.length;s++)if(i[s]){if(n!==void 0)return;n=s}return n}function K_(e,t,r,n,i){let s=e.chunk,o=ET(s,r);if(o===void 0)return;let a=vT(e,r,o);if(a===void 0)return;let u=s.getInstruction(n),l=u.args[0];if(a=EO(a,l,i),a===void 0)return;let{chunk:c,valueMap:p}=a,f=c.getInstruction(p[l]);if(f.type!==8)return;let d=f.args[1],m=c.getInstruction(f.args[0]);if(m.type!==10)return;let[y,g]=m.args,h=o,P=d,S=y,A=g,T=c.Multiply([S,A]),I=c.SyntheticNativeFunction(\"cos\",[T]),E=c.SyntheticNativeFunction(\"sin\",[T]),v=u.symbol===\"sin\"?c.Add([c.Multiply([h,E]),c.Multiply([P,I])]):c.Subtract([c.Multiply([h,I]),c.Multiply([P,E])]);p[t]=v;function D(w){let X=a.forwardParameterMap(w),H=X[o],Z=X[d],K=H*Math.cos(Z),J=H*Math.sin(Z);return X[o]=K,X[d]=J,X}function R(w){let X=w.slice(),H=w[o],Z=w[d],K=as(H,Z),J=Math.atan2(Z,H);return X[o]=K,X[d]=J,a.reverseParameterMap(X)}let L=a.replacementMask.slice();return L[o]=!0,L[y]=!0,L[d]=!0,{chunk:c,forwardParameterMap:D,reverseParameterMap:R,valueMap:p,replacementMask:L,isLazy:!1}}function eF(e,t,r,n){let i=e.chunk,s=i.getInstruction(t),[o,a]=s.args,u=i.getInstruction(o);if(u.type===1&&u.valueType===b&&B(u.value)>0){let P=Tm(e),{chunk:S,valueMap:A}=P,T=S.Multiply([S.SyntheticNativeFunction(\"ln\",[A[o]]),A[a]]);return A[a]=T,A[t]=S.SyntheticNativeFunction(\"exp\",[T]),Oc(P,t,a,r,n)||P}let l=ET(i,o);if(l===void 0)return;let c=vT(e,o,l);if(c===void 0)return;let{chunk:p,valueMap:f}=c,d=p.Multiply([f[o],f[a]]);f[a]=d,f[t]=p.SyntheticNativeFunction(\"exp\",[d]);function m(P){let S=c.forwardParameterMap(P),A=S[l],T=Math.log(A);return S[l]=T,S}function y(P){let S=P.slice(),A=S[l],T=Math.exp(A);return S[l]=T,c.reverseParameterMap(S)}let g=c.replacementMask.slice();g[l]=!0;let h={chunk:p,forwardParameterMap:m,reverseParameterMap:y,isLazy:!1,valueMap:f,replacementMask:g};return Oc(h,t,a,r,n)||h}function tF(e,t,r,n,i,s){if(!e.isLazy&&e.didShiftScale)return;let o=e.isLazy?e:TO(e),a=e.chunk,u=ET(a,r);if(u===void 0)return;let l=vT(e,r,u);if(l===void 0)return;let{chunk:c,valueMap:p}=l,f=c.getInstruction(p[n]).args[0],d=c.Add([f,p[r]]);p[r]=d,p[t]=c.SyntheticNativeFunction(\"exp\",[d]);function m(I){let E=l.forwardParameterMap(I),v=E[u],D=Math.log(v);return E[u]=D,E}function y(I){let E=I.slice(),v=E[u],D=Math.exp(v);return E[u]=D,l.reverseParameterMap(E)}function g(I){let E=l.forwardParameterMap(I),v=E[u],D=Math.log(-v);return E[u]=D,E}function h(I){let E=I.slice(),v=E[u],D=-Math.exp(v);return E[u]=D,l.reverseParameterMap(E)}let P=l.replacementMask.slice();P[u]=!0;let S=Tm(o);S.valueMap[t]=S.chunk.Multiply([S.valueMap[r],S.valueMap[n]]);let A={chunk:c,forwardParameterMap:m,reverseParameterMap:y,isLazy:!1,valueMap:p,replacementMask:P},T=TO(A);return T.forwardParameterMap=g,T.reverseParameterMap=h,A=Oc(A,t,r,i,s)||A,T=Oc(T,t,r,i,s)||T,T.valueMap[t]=T.chunk.Negative([T.valueMap[t]]),[S,A,T]}function Oc(e,t,r,n,i){let s=rF(e,r,n,i);if(s!==void 0)return s.valueMap[t]=s.chunk.SyntheticNativeFunction(\"exp\",[s.valueMap[r]]),s}function rF(e,t,r,n){let i=EO(e,t,r);if(i===void 0)return;let{chunk:s,valueMap:o}=i,a=s.getInstruction(o[t]);if(a.type!==8)return;let u=a.args[1],l=s.getInstruction(a.args[0]);if(l.type!==10)return;let[c,p]=l.args,{min:f,max:d}=n,m=d-f,y=.5*(d+f),g=s.Divide([s.Subtract([p,s.Constant(y)]),s.Constant(m)]),h=s.Add([s.Multiply([c,g]),u]);o[t]=h;function P(A){let T=i.forwardParameterMap(A),I=T[c],E=T[u],v=I*m,D=E+y*I;return T[c]=v,T[u]=D,T}function S(A){let T=A.slice(),I=A[c],E=A[u],v=I/m,D=E-v*y;return T[c]=v,T[u]=D,i.reverseParameterMap(T)}return{chunk:s,forwardParameterMap:P,reverseParameterMap:S,isLazy:!1,valueMap:o,replacementMask:i.replacementMask,didShiftScale:!0}}function vT(e,t,r){let n=e.chunk,i=_n(n,r,{allowRestriction:!1,allowClosedBlockReferences:!1});if(cr(i,t)!==1)return;let s=Vi(i),[o,a]=Mr(s,t);if(a===void 0)return;let u=s.newChunk.getInstruction(o);if(u.type!==1||u.valueType!==b)return;let l=s.newChunk.getInstruction(a);if(l.type!==1||l.valueType!==b)return;let c=Tm(e),{chunk:p,valueMap:f}=c,d=B(u.value),m=B(l.value);f[t]=r;function y(P){let S=c.forwardParameterMap(P),A=S[r],T=d+m*A;return S[r]=T,S}function g(P){let S=P.slice(),T=(S[r]-d)/m;return S[r]=T,c.reverseParameterMap(S)}let h=c.replacementMask.slice();return h[r]=!0,{chunk:p,forwardParameterMap:y,reverseParameterMap:g,isLazy:!1,valueMap:f,replacementMask:h}}function EO(e,t,r){let n=e.chunk,i=e.isLazy?t:e.valueMap[t],s=_n(n,r,{allowRestriction:!1,allowClosedBlockReferences:!0});if(cr(s,i)!==1)return;e.isLazy&&(s=_n(n.copy().reopenFinalBlock(),r,{allowRestriction:!1,allowClosedBlockReferences:!1}));let o=Vi(s),[a,u]=Mr(o,i);if(u===void 0)return;let l=o.newChunk,c=Math.max(u,a),p=[];for(let W=0;W<=c;W++)if(l.getInstruction(W).type===2){let et=ju(l.argNames.length);et[W]=!0,p.push(et)}else p.push(xm(l,p,l.argNames.length,W));let f,d;for(let W=0;W<n.argNames.length;W++)if(p[u][W])if(f===void 0)f=W;else return;else if(p[a][W])if(d===void 0)d=W;else return;if(f===void 0||d===void 0)return;let m=_n(l,f,{allowRestriction:!1,allowClosedBlockReferences:!1});if(cr(m,u)!==1)return;let y=_n(l,d,{allowRestriction:!1,allowClosedBlockReferences:!1});if(cr(y,a)!==1)return;let g=Vi(m),h=Vi(y),[P,S]=Mr(g,u),A=g.newChunk.getInstruction(P);if(A.type!==1||A.valueType!==b)return;let T=g.newChunk.getInstruction(S);if(T.type!==1||T.valueType!==b)return;let I=Tm(e),{chunk:E,valueMap:v}=I,D=E.Add([E.Multiply([f,r]),d]);v[t]=D;let R=l.copy();R.List([u,a]);let L=R.close().getCompiledFunction().fn;function w(W){let _e=I.forwardParameterMap(W),[et,Ct]=L.apply(null,_e);return _e[f]=et,_e[d]=Ct,_e}let X=B(A.value),H=B(T.value),[Z,K]=Mr(h,a),J=h.newChunk.copy();J.List([Z,K]);let ce=J.close().getCompiledFunction().fn;function ge(W){let _e=W.slice(),et=W[f],Ct=W[d],Jt=(et-X)/H,Lr=W.slice();Lr[f]=Jt,Lr.splice(d,1);let[un,xn]=ce.apply(null,Lr),yr=(Ct-un)/xn;return _e[f]=Jt,_e[d]=yr,I.reverseParameterMap(_e)}let ie=I.replacementMask.slice();return ie[f]=!0,ie[d]=!0,{chunk:E,forwardParameterMap:w,reverseParameterMap:ge,isLazy:!1,valueMap:v,replacementMask:ie}}function xm(e,t,r,n){let i=e.getInstruction(n),s=ju(r);if(be(i))return s;for(let o of i.args){let a=t[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function ju(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function nF(e){let t=[];for(let r=0;r<e;r++)t.push(r);return t}function IO(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function Ke(e,t){switch(e){case b:case me:return new x.Constant(t);case He:return new x.Seed(t);case N:return new x.ParenSeq([Ke(b,t[0]),Ke(b,t[1])]);case z:return new x.ParenSeq([Ke(b,t[0]),Ke(b,t[1]),Ke(b,t[2])]);case Tr:return new x.FunctionCall(\"segment\",[Ke(z,t[0]),Ke(z,t[1])]);case dr:return new x.FunctionCall(\"triangle\",[Ke(z,t[0]),Ke(z,t[1]),Ke(z,t[2])]);case Pr:return new x.FunctionCall(\"sphere\",[Ke(z,t[0]),Ke(b,t[1])]);case ot:return new x.FunctionCall(\"rgb\",[Ke(b,t[0]),Ke(b,t[1]),Ke(b,t[2])]);case Ee:return new x.FunctionCall(\"polygon\",[Ke(Ue,t)]);case xe:return new x.FunctionCall(\"segment\",[Ke(N,t[0]),Ke(N,t[1])]);case oe:return new x.FunctionCall(\"line\",[Ke(N,t[0]),Ke(N,t[1])]);case ve:return new x.FunctionCall(\"ray\",[Ke(N,t[0]),Ke(N,t[1])]);case pe:return new x.FunctionCall(\"mathVector\",[Ke(N,t[0]),Ke(N,t[1])]);case ue:return new x.FunctionCall(\"circle\",[Ke(N,t[0]),Ke(b,t[1])]);case ee:return new x.FunctionCall(\"arc\",[Ke(N,t[0]),Ke(N,t[1]),Ke(N,t[2])]);case Ie:return new x.FunctionCall(\"angle\",[Ke(N,t[0]),Ke(b,t[1]),Ke(b,t[2])]);case ye:return new x.FunctionCall(\"directedangle\",[Ke(N,t[0]),Ke(b,t[1]),Ke(b,t[2])]);case Oe:case j:case Nr:case Ue:case Or:case ur:case Kt:case br:case xr:case Sr:case zt:case qt:case gr:case hr:case zr:case qr:case Ar:case Ur:{let n=[],i=Fe(e);for(let s of t)n.push(Ke(i,s));return new x.List(n)}case st:case je:case wt:case Qt:case Be:case Ce:case Gr:case oi:throw new Error(`Programming error: cannot create parse node from valueType: ${In(e)}`);default:let r=e;throw new Error(`Programming error: unexpected valueType: ${In(r)}`)}}function RO(e,t){try{return iF(e,t)}catch(r){return r instanceof x.Error?r:ae(r)}}function iF(e,t){let{policy:r,frame:n,exportFrame:i,lastExportFrame:s,priorAnalysis:o}=e,a=t._lhs.buildIRExpression(r,n,{coerceToNumber:!0}),u=t._rhs.buildIRExpression(r,n,{coerceToNumber:!0});if(a.isError)throw a;if(u.isError)throw u;if(a.valueType!==b&&a.valueType!==j||u.valueType!==b&&u.valueType!==j)throw Iy([ne(a.valueType),ne(u.valueType)]);let l=t._difference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(l.isError)throw l;for(let T of l.getDependencies())if(!r.validRegressionParameter(T))throw $g(T);let c=oF(l.getDependencies(),t.userData.regressionParameters,s),{parameters:p,residuals:f,isLinear:d,parameterWarning:m}=AO(c,l),y={policy:r,frame:n},g=vO(y,t,p),h=lF(t,a,g),P;if(t.userData.isLogModeRegression&&(h===hn.LOGLIN||h===hn.LOGLOG)){let T=t._logDifference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(T.isError)throw T;let I=t._logLhs.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(I.isError)throw I;({parameters:p,isLinear:d,parameterWarning:m}=AO(c,T)),g=vO(y,t,p),f=NO(y,t._difference,p);let E=NO(y,t._logDifference,p);P=DO(t,I,g,E,t.userData.isLogModeRegression,h)}else P=DO(t,a,g,f,t.userData.isLogModeRegression,h);let S=sF(t,i),A=uF(t,S,o,r);return t.userData.residualVariable=wr(S),new x.OptimizedRegression(p,Ke(j,f),P,g.substituted,{isModelValid:g.isValid,residualVariable:S,residualSuggestionId:A,shouldSuggestLogMode:h!==hn.NONE,isLinear:d,parameterWarning:m})}function sF(e,t){if(e.userData&&e.userData.residualVariable){let s=vs(e.userData.residualVariable);if(!t[s])return s}let r=e.getDependencies().filter(s=>s[0]!==\"_\"),n;for(let s of r){let o=s.match(/_(.*)/);if(o&&(n=\"e_\"+o[1],!t[n]))return n}let i=1;for(;;){if(n=\"e_\"+i,!t[n])return n;i++}}function vO({policy:e,frame:t},r,n){let i=r._rhs.getDependencies(),s,o;for(let p of i){if(n.hasOwnProperty(p))continue;let f=t[p];if(!f||(f.type===\"Assignment\"&&(f=f._expression),!f.buildIRExpression))continue;let d=f.buildIRExpression(e,t,{coerceToNumber:!0});if(!d.isError&&d.valueType===j){if(s!==void 0){s=void 0,o=void 0;break}d.getDependencies().length===0&&(s=p,o=d)}}let a=Object.create(t);s!==void 0&&(a[s]=void 0);let u=r._rhs.buildIRExpression(e,a,{coerceToNumber:!0}),l=Object.create(a);for(let p in n)l[p]=n[p];let c=r._rhs.buildIRExpression(e,l,{coerceToNumber:!0});return o?{node:u,substituted:c,listNode:o,isValid:!0}:{node:u,substituted:c,listNode:o,isValid:!1}}function oF(e,t,r){let n=[];t||(t={}),r||(r={});for(let i of e){let s=wr(i);r[i]&&isFinite(r[i].asValue())?n.push(+r[i].asValue()):t.hasOwnProperty(s)&&isFinite(+t[s])?n.push(+t[s]):n.push(1)}return n}function OO(e,t){let r=t.getDependencies(),n=t.getCompiledFunction(r).fn;if(r.length){let i=t.findLinearSubset(r),s=i.every(a=>a),o=[];for(let a of r)o.push(t.takeDerivative(a).getCompiledFunction(r).fn);if(s){let a=r.map(()=>Me(0,1)),u=t.interpretWithParameters(a),l=[];for(let d of r)l.push(t.takeDerivative(d).interpretWithParameters(a));let c=TT(u,l);if(c){let d=t.interpretWithParameters(c);return{solution:c,residuals:d,MSE:ST(d),isLinear:s}}let{solution:p,MSE:f}=xT(n,PT(n,o));return{solution:p,residuals:n.apply(void 0,p),MSE:f,isLinear:s}}else{let a=[];for(let p of r)a.push(t.boundDomain(p));let u={linearSubset:i,bounds:a,preferredInitialGuess:e},{solution:l,MSE:c}=xT(n,bO(n,o,u));return{solution:l,residuals:n.apply(void 0,l),MSE:c,isLinear:s}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:ra(n,[]),isLinear:!0}}function SO(e,t){let r={},n=t.getDependencies();for(let i=0;i<n.length;i++){let s=new x.RegressionParameter(e[i]);r[n[i]]=s}return r}function DO(e,t,r,n,i,s){let o=ST(n);if(!isFinite(o))throw Yg();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(o)};let a=q(t.valueType)?Ql(t.asValue()):0;if(t.getDependencies().length||!isFinite(a)||a<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(o)};{let u=1-o/a;if(r.isValid){let l=[],c=[],p=i&&(s===hn.LINLOG||s===hn.LOGLOG);x.List.eachArgs([r.listNode,t],function(d){let m=d[0].isConstant?d[0].asCompilerValue():NaN,y=d[1].isConstant?d[1].asCompilerValue():NaN;l.push(p?Math.log(B(m)):m),c.push(y)});let f=Qf(l.map(d=>B(d)),c.map(d=>B(d)));if(cn(aF(l,c).MSE,o,8))return{r:f,rsquared:f*f}}return{Rsquared:u}}}function aF(e,t){let r=t,n=[e.map(a=>li(a)),e.map(()=>Me(-1,1))],i=TT(r,n);if(i){let[a,u]=i,l=[];for(let c=0;c<t.length;c++)l.push(Qi(t[c],Ms(Es(a,e[c]),u)));return{solution:i,MSE:ST(l)}}function s(a,u){let l=[];for(let c=0;c<e.length;c++)l.push(B(t[c])-(a*B(e[c])+u));return l}return PT(s,[function(){return e.map(function(a){return-B(a)})},function(){return e.map(function(){return-1})}])}function uF(e,t,r,n){let i=e._rhs.getDependencies(),s;for(let o in r){if(!r.hasOwnProperty(o))continue;let a=r[o].concreteTree;if(!Ui(a)||!a.columns[0])continue;let u=r[o].rawTree.columns;if(!u||!u.length)continue;let l=u[0].getExports(n);if(l.length===1&&i.indexOf(l[0])!==-1){for(let c=1;c<u.length;c++)if(u[c].getDependencies().indexOf(t)!==-1)return;s=s||o}}return s||void 0}function OT(e,t){let r=e.length,n=e[0],i=t[0],s=e[r-1],o=t[r-1];if(!isFinite(n)||!isFinite(s)||!isFinite(i)||!isFinite(o)||o-i===0)return!1;let a=s-n;if(a===0)return!1;for(let u=1;u<r-1;u++){let l=e[u],c=t[u],p=(o*(l-n)+i*(s-l))/a;if(!cn(c,p,5))return!1}return!0}var hn={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function lF(e,t,r){if(!e.isLhsSimple||!r.isValid)return hn.NONE;let n=r.substituted;if(n.isError||n.valueType!==b)return hn.NONE;let i=n.getDependencies();if(i.length!==1||isFinite(r.node.polynomialOrder(i[0])))return hn.NONE;let s=n.getCompiledFunction(i).fn,o=r.listNode;if(n.valueType!==b)return hn.NONE;let a=o.mapElements(f=>+f.asValue());if(a.length<3)return hn.NONE;a.sort(function(f,d){return f-d});let u=a.map(s),l=u.map(Math.log),c=a.map(Math.log),p=!0;return x.List.wrap(t).eachElement(f=>{isFinite(Math.log(+f.asValue()))||(p=!1)}),OT(a,l)&&p?hn.LOGLIN:OT(c,l)&&p?hn.LOGLOG:OT(c,u)?hn.LINLOG:hn.NONE}function NO({policy:e,frame:t},r,n){let i=Object.create(t);for(let a in n)n.hasOwnProperty(a)&&(i[a]=n[a]);let s=Gu({policy:e,frame:i,wrapInList:!0},r),o=s.getError();if(o)throw o;return s.asCompilerValue()}function ST(e){let t=0;for(let r of e){let n=B(r);t+=n*n}return t/e.length}function AO(e,t){let r,n,i=t._chunk;if(i&&(n=MO(i)),!n||n.length===0)return t=t.deriveRegressionRestrictions(),r=OO(e,t),{parameters:SO(r.solution,t),residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1};let s=t.getDependencies(),o=t.getCompiledFunction(s).fn,a=1/0,u={},l,c=!1;for(let p of n){let f=new Zt(p.chunk);if(f=f.deriveRegressionRestrictions(),r=OO(p.forwardParameterMap(e),f),r.MSE<a){let d=p.reverseParameterMap(r.solution.map(y=>B(y))),m=ra(o,d);if(u&&(!isFinite(m)||m>=a)){isFinite(m)||(c=!0);continue}a=r.MSE,u=SO(d,t),l=o.apply(void 0,d)}}return{parameters:u,residuals:l,isLinear:!1,parameterWarning:c}}x.Base.prototype.analyze=function(e,t){return on(this)?an(e,t,this):new G(e,t,this,this.tryGetConcreteTree(e,t))};function Pm(e,t,r,n){if(n.isError)return new G(e,t,r,n);if(!e.areAllScalesLinear()&&!el(n.valueType)){let a=xl(ne(n.valueType));return a.setCursorContext(n.getCursorContext()),new G(e,t,r,a)}var i=Si(e,n);let s;switch(n.valueType){case je:case Qt:case Oe:{s=n;break}case ot:case Or:case xe:case Kt:case ue:case gr:case ee:case hr:case oe:case br:case ve:case xr:case pe:case Sr:case Ie:case zt:case ye:case qt:case Ce:case Gr:case Be:case Ee:case ur:case Tr:case qr:case dr:case Ar:case Pr:case Ur:i.length?s=Ut(r.getSliderVariables(e,n)).setDependencies(i):s=n;break;case N:case z:case Ue:case zr:if(i.length)if(e.validParametricVariables(i))s=n;else{var o=r.getSliderVariables(e,n);s=Ut(o).setDependencies(o)}else s=n;break;case b:case j:i.length===0?s=n:i.length<=(e.is3dPolicy()?2:1)?e.validExpressionVariables(i)?s=n:s=jp(e.implicitDependency(i)).setDependencies(i):e.validImplicitVariables(i)?s=jp().setDependencies(i):s=Ut(r.getSliderVariables(e,n)).setDependencies(i);break;default:s=ae(`Programming error: unexpected value type ${n.valueType}`)}return ms(s)&&s.setCursorContext(n.getCursorContext()),s=Zu(e,r,s),new G(e,t,r,s)}function LO(e){return new x.FunctionCall(\"pdf\",[e,new x.Identifier(\"x\")])}x.Identifier.prototype.analyze=function(e,t){let r=this.tryGetConcreteTree(e,t,{coerceToNumber:!0}),n=Pm(e,t,this,r);return on(this)&&!NT(n)?an(e,t,this):n};x.FunctionCall.prototype.analyze=function(e,t,r){var n;qd[this._symbol]&&wu(t,this).length===0&&!e.is3dPolicy()?n=LO(this).tryGetConcreteTree(e,t):n=this.tryGetConcreteTree(e,t);var i=Pm(e,t,this,n);if(on(this)&&!NT(i))return an(e,t,this);var s=this.getMoveStrategy(e,t,n,r,this.userData);if(s){var o=this.getDefaultDragMode(s),a=n.asCompilerValue(),u=[new x.Constant(a[0]),new x.Constant(a[1])];return new G(e,t,this,new x.MovablePoint(u,s,o))}return i};x.Expression.prototype.analyze=function(e,t){var r=Pm(e,t,this,this.tryGetConcreteTree(e,t));return on(this)&&!NT(r)?an(e,t,this):r};x.FunctionDefinition.prototype.analyze=function(e,t){if(on(this))return an(e,t,this);if(we[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split(\"_\")[0];if(we[r]&&we[r].isFunction)return new G(e,t,this,cu(this._symbol,r));var n=this.tryGetConcreteTree(e,t);if(n instanceof x.Error&&!n.blocksExport&&this._argSymbols.length===1){let u=Object.create(t);u[this._argSymbols[0]]=new rt(\"identityTransformation\");let l=this._expression.tryGetConcreteTree(e,u);if(!(l instanceof x.Error))return new G(e,t,this,l)}if(n.isError)return new G(e,t,this,n);var i=this._argSymbols,s=n.getDependencies();if(s.indexOf(this._symbol)!==-1)return new G(e,t,this,vl(this._symbol));var o=s.filter(function(u){return i.indexOf(u)===-1});if(e.unplottablePolarFunction(this._symbol,s))return new G(e,t,this,Vg());if(o.some(function(u){return e.assignmentForbidden(u)}))return new G(e,t,this,Ol(o,this._symbol,i).setDependencies(s));if(o.length){var a=this.getSliderVariables(e,n);return new G(e,t,this,Ut(a).setDependencies(a))}return!e.areAllScalesLinear()&&!el(n.valueType)?new G(e,t,this,xl(ne(n.valueType))):(n=Zu(e,this,n),new G(e,t,this,n))};x.Assignment.prototype.analyze=function(e,t,r){if(on(this))return an(e,t,this);var n=this._symbol;if(!e.validLHS(n))return new G(e,t,this,Fg(n));if(we[n])return this.asEquation().analyze(e,t);var i;if(this._expression instanceof x.FunctionCall&&qd[this._expression._symbol]&&wu(t,this).length===0&&!e.is3dPolicy())i=LO(this._expression).tryGetConcreteTree(e,t);else{var s=Object.create(t);s[n]=e.validSolvedVariable(n)?void 0:ga(),i=this.tryGetConcreteTree(e,s)}if(i.isError)return new G(e,t,this,i);if(!e.areAllScalesLinear()&&!el(i.valueType))return new G(e,t,this,xl(ne(i.valueType)));if(this.isEquation(e,i))return this.asEquation().analyze(e,t);let o=i.valueType===ot||i.valueType===Or,a=Si(e,i),u=this.getSliderVariables(e,i,a);if(e.tooManySliderVariables(a,u,o)){let p=Ut(u).allowExport().setDependencies(u);return new G(e,t,this,p)}var l=this.getMoveStrategy(e,t,i,r,this.userData);if(l){var c=this.getDefaultDragMode(l);return i=new x.MovablePoint([i.elementAt(0),i.elementAt(1)],l,c),new G(e,t,this,i)}return i=Zu(e,this,i),new G(e,t,this,i)};x.CoordinateEquation.prototype.analyze=function(e,t){if(!e.validCoordinateEquationSymbol(this._concatenatedSymbol))return this.asEquation().analyze(e,t);if(on(this))return an(e,t,this);let r=this.tryGetConcreteTree(e,t);return r=Zu(e,this,r),new G(e,t,this,r)};x.Regression.prototype.analyze=function(e,t,r,n,i){if(on(this))return an(e,t,this);var s={policy:e,frame:t,exportFrame:r,lastExportFrame:n,priorAnalysis:i};return new G(e,t,this,RO(s,this))};function DT(e,t){var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();return n.length?new G(e,t,this,Ut(this.getSliderVariables(e,r)).setDependencies(n)):new G(e,t,this,this.tryGetConcreteTree(e,t))}x.Histogram.prototype.analyze=function(e,t){return on(this)?an(e,t,this):e.areAllScalesLinear()?DT.call(this,e,t):new G(e,t,this,Ny())};x.DotPlot.prototype.analyze=function(e,t){return on(this)?an(e,t,this):e.areAllScalesLinear()?DT.call(this,e,t):new G(e,t,this,Ay())};x.BoxPlot.prototype.analyze=function(e,t){return on(this)?an(e,t,this):e.areAllScalesLinear()?DT.call(this,e,t):new G(e,t,this,Ry())};function wO(e){return function(t,r){if(on(this))return an(t,r,this);var n=this.tryGetConcreteTree(t,r),i=n.getDependencies();if(i.length)return new G(t,r,this,Ut(this.getSliderVariables(t,n)).setDependencies(i));var s=new G(t,r,this,this.tryGetConcreteTree(t,r));if(!n.isError){s.evaluationState.expression_type=\"TTEST\";var o=n.args.map(function(a){return a.asValue()});s.evaluationState.ttest_results=e.apply(null,o)}return s}}x.TTest.prototype.analyze=wO(lb);x.IndependentTTest.prototype.analyze=wO(cb);x.Stats.prototype.analyze=function(e,t){if(on(this))return an(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();if(n.length)return new G(e,t,this,Ut(this.getSliderVariables(e,r)).setDependencies(n));var i=new G(e,t,this,this.tryGetConcreteTree(e,t));if(!r.isError){i.evaluationState.expression_type=\"STATS\";var s=r.args.map(function(o){return o.asValue()});i.evaluationState.stats_results=pb.apply(null,s)}return i};x.Equation.prototype.analyze=x.BaseComparator.prototype.analyze=function(e,t){if(on(this))return an(e,t,this);var r=this.getOperator()!==\"=\";if(r&&(!ii.plotInequalities||e.is3dPolicy()))return new G(e,t,this,Xp());var n=lO({policy:e,frame:t},this.asComparator());if(n.isError)return new G(e,t,this,n);let i=Si(e,n);if(n instanceof x.SolvedEquation&&i.length){var s=i.concat(n._symbol);if(!e.validImplicitVariables(s))return new G(e,t,this,ga().setDependencies(s))}return this.getGraphMode(e,n)===8&&!e.validImplicitVariables(i)?new G(e,t,this,ga().setDependencies(i)):(n=Zu(e,this,n),new G(e,t,this,n))};x.DoubleInequality.prototype.analyze=function(e,t){if(on(this))return an(e,t,this);if(!ii.plotInequalities)return new G(e,t,this,Xp());var r=this.tryGetConcreteTree(e,t);if(r.isError)return new G(e,t,this,r);var n=r.getDependencies();return pn[this._operators[0]].direction!==pn[this._operators[1]].direction?new G(e,t,this,Ug()):e.validDoubleInequalitySymbol(r._symbol)?e.validDoubleInequalityVariables(n)?n.length>2?new G(e,t,this,Ut(this.getSliderVariables(e,r)).setDependencies(n)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?new G(e,t,this,Zp().setDependencies(n)):new G(e,t,this,r):new G(e,t,this,Wp().setDependencies(n)):new G(e,t,this,Wp().setDependencies(n))};x.And.prototype.analyze=function(e,t){if(on(this))return an(e,t,this);var r=this.tryGetConcreteTree(e,t);if(r.isError)return new G(e,t,this,r);var n=r.getDependencies();return n.length?e.validDoubleInequalityVariables(n)?new G(e,t,this,Zp().setDependencies(n)):new G(e,t,this,Ut(this.getSliderVariables(e,r)).setDependencies(n)):new G(e,t,this,r)};x.ParenSeq.prototype.analyze=function(e,t,r){if(on(this))return an(e,t,this);var n=this.tryGetConcreteTree(e,t);if(n.isError)return new G(e,t,this,n);var i=this.getMoveStrategy(e,t,n,r,this.userData);if(i){var s=this.getDefaultDragMode(i),o=n.asCompilerValue(),a=[new x.Constant(o[0]),new x.Constant(o[1])];return new G(e,t,this,new x.MovablePoint(a,i,s))}return Pm(e,t,this,n)};function cF(e,t){return e.filter(function(r){return!t[r]})}function pF(e){for(var t={},r=0;r<e.length;r++){var n=e[r];if(n instanceof Ia&&n.header instanceof x.Identifier){var i=n.header._symbol;t[i]===void 0&&(t[i]=0),t[i]+=1}}return t}x.Table.prototype.analyze=function(e,t){var r=Object.create(t),n=[],i=pF(this.columns),s;for(s=0;s<this.columns.length;s++){var o=this.columns[s];if(o instanceof Ia&&o.header instanceof x.Identifier){var a=o.header._symbol,u=r[a],l=i[a]>1;u&&u.isError&&(u.isTableCycleWithoutGlobalDefinition||u.isMultiplyDefinedByTables&&!l)&&(r[a]=void 0)}var c=o.analyze(e,r);if(s===0&&c.concreteTree.isIndependent){var p=c.concreteTree.getDependencies()[0];e.validFirstColumnVariable(p)||(c=new G(e,t,o,kg()))}if(c.concreteTree.isIndependent)c.rawTree.exportToLocal(e,c.concreteTree,r);else if(!c.concreteTree.isError){var f=c.concreteTree.header.getDependencies(),d=cF(f,r);d.length&&(c=new G(e,t,o,Ut(d).setDependencies(d)))}n.push(c.concreteTree)}var m=1;for(s=0;s<n.length;s++)n[s].isError||(m=Math.max(n[s].values.length,m));for(s=0;s<n.length;s++)if(!n[s].isError&&n[s].header.isConstant){for(var y=[],g=0;g<m;g++)y.push(n[s].header);n[s]=new x.TableColumn(n[s].header,y)}var h=new x.Table(n),P=new G(e,t,this,h);return P.evaluationState.is_graphable=!0,P};x.TableColumn.prototype.analyze=function(e,t){var r=this.header.tableError();if(r)return new G(e,t,this,Hg(r));var n=this.tryGetConcreteTree(e,t);if(n.isError)return new G(e,t,this,n);if(n.header.isError)return new G(e,t,this,n.header);if(n.values.isError)return new G(e,t,this,n.values);for(var i=0;i<n.values.length;i++)if(!n.values[i].isError){var s=this.values[i]&&this.values[i].tableError();if(s){n.values[i]=fu(s);continue}var o=n.values[i].getDependencies();o.length&&(n.values[i]=Ut(o).setDependencies(o))}return new G(e,t,this,n)};x.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(e,t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError||n.opacity.isError)return new G(e,t,this,n);var i=n.center.getDependencies(),s=n.radianAngle.getDependencies(),o=n.width.getDependencies(),a=n.height.getDependencies(),u=n.opacity.getDependencies();return i.length||s.length||o.length||a.length||u.length?new G(e,t,this,new x.Image({center:i.length?Ut(s).setDependencies(i):n.center,radianAngle:s.length?Ut(s).setDependencies(s):n.radianAngle,width:o.length?Ut(o).setDependencies(o):n.width,height:a.length?Ut(a).setDependencies(a):n.height,opacity:u.length?Ut(u).setDependencies(u):n.opacity})):(n.moveStrategy=this.getMoveStrategy(e,t,n,r,this.userData),new G(e,t,this,n))};x.Slider.prototype.analyze=function(e,t){if(on(this))return an(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.sliderInfo,i;if(n.missingVars.length){var s=sl(n.missingVars);i=new G(e,t,this,Ut(e.sliderVariables(s)).setDependencies(s).allowExport())}else i=new G(e,t,this,r);var o=i.evaluationState;if(ii.sliders){o.assignment=n.exportedSymbol,o.slider_min_number=n.values.min,o.slider_max_number=n.values.max,o.slider_step_number=n.values.step,o.slider_min_valid=n.valids.min,o.slider_max_valid=n.valids.max,o.slider_step_valid=n.valids.step;var a=o.slider_min_valid&&o.slider_max_valid&&o.slider_step_valid;o.is_slider=!0,o.raw_slider_latex=this.getInputString(),o.is_slidable=a,o.is_animatable=o.is_slidable&&!o.is_graphable,n.errMsg&&(o.error=n.errMsg.getError())}return delete o.is_evaluable,delete o.zero_values,i};function on(e){return\"latex\"in e.userData&&Os(e.userData.latex).slice(-1)===\"=\"}function an(e,t,r){return new G(e,t,r,El(\"=\"))}function NT(e){return e.concreteTree.isConstant&&e.concreteTree.valueType===b}x.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new G(e,t,this,r):new G(e,t,this,ae(`Unexpected node type ${this.type}`))};x.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new G(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=we[i];return o?s=o.isFunction?yi(i):ha(i):s=Rl(i),new G(e,t,this,s)}return new G(e,t,this,r)};x.Assignment.prototype.analyzeFourFunction=function(e,t){return new G(e,t,this,Cl())};x.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return new G(e,t,this,Ll())};x.Equation.prototype.analyzeFourFunction=function(e,t){return new G(e,t,this,eo())};function AT(e,t){return new G(e,t,this,ba())}x.And.prototype.analyzeFourFunction=AT;x.DoubleInequality.prototype.analyzeFourFunction=AT;x.BaseComparator.prototype.analyzeFourFunction=AT;x.Regression.prototype.analyzeFourFunction=function(e,t){return new G(e,t,this,xa())};x.ParenSeq.prototype.analyzeFourFunction=function(e,t){return new G(e,t,this,Ta())};x.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new G(e,t,this,r):new G(e,t,this,ae(`Unexpected node type ${this.type}`))};x.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new G(e,t,this,r);var n=r.getDependencies();return n.length>0?new G(e,t,this,Ut(n)):new G(e,t,this,r)};x.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(we[r])return new G(e,t,this,cu(r));var n=Object.create(t);n[r]=eo();var i=this.tryGetConcreteTree(e,n);if(i.isError)return new G(e,t,this,i);var s=i.getDependencies();return this.isEquation(e,i)?new G(e,t,this,eo()):s.length>0?new G(e,t,this,Ut(s)):new G(e,t,this,i)};x.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(we[this._symbol])return new G(e,t,this,cu(this._symbol));var r=this.tryGetConcreteTree(e,t);if(r.isError)return new G(e,t,this,r);var n=this._argSymbols,i=r.getDependencies();if(i.indexOf(this._symbol)!==-1)return new G(e,t,this,vl(this._symbol));var s=i.filter(function(o){return n.indexOf(o)===-1});return s.length?new G(e,t,this,Ol(s,this._symbol,n)):new G(e,t,this,r)};x.Equation.prototype.analyzeScientific=function(e,t){return new G(e,t,this,eo())};function RT(e,t){return new G(e,t,this,ba())}x.And.prototype.analyzeScientific=RT;x.DoubleInequality.prototype.analyzeScientific=RT;x.BaseComparator.prototype.analyzeScientific=RT;x.Regression.prototype.analyzeScientific=function(e,t){return new G(e,t,this,xa())};x.ParenSeq.prototype.analyzeScientific=function(e,t){return new G(e,t,this,Ta())};x.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new G(e,t,this,r):new G(e,t,this,ae(`Unexpected node type ${this.type}`))};x.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new G(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=we[i];return o?s=o.isFunction?yi(i):ha(i):s=Rl(i),new G(e,t,this,s)}return new G(e,t,this,r)};x.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return new G(e,t,this,Cl())};x.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return new G(e,t,this,Ll())};x.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return new G(e,t,this,eo())};function CT(e,t){return new G(e,t,this,ba())}x.And.prototype.analyzeSingleExpressionScientific=CT;x.DoubleInequality.prototype.analyzeSingleExpressionScientific=CT;x.BaseComparator.prototype.analyzeSingleExpressionScientific=CT;x.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return new G(e,t,this,xa())};x.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return new G(e,t,this,Ta())};x.Base.prototype.getGraphInfo=function(e,t){var r=t.getDependencies(),n,i;switch(r.length){case 0:n=_O(t),i=t.boundDomain(\"x\");break;case 1:i=t.boundDomain(r[0]),i.type===\"known\"&&(n=_O(t));break;default:i=Jr();break}return{graphMode:this.getGraphMode(e,t),color:Ys(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,arrowMode:this.userData.arrowMode,operator:this.getOperator(),isLinear:!!n,linearCoefficients:n,domainBound:i}};function _O(e){switch(e.valueType){case b:return LT(e);case N:{var t=LT(e.elementAt(0)),r=LT(e.elementAt(1));return!t||!r?void 0:[t,r]}default:return}}function LT(e){var t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;var r=e.getPolynomialCoefficients(t[0]);return[r[0]?+r[0].asValue():0,r[1]?+r[1].asValue():0];default:return}}var FO=new x.Constant(Me(0,1));x.Base.prototype.getMoveStrategy=function(){};x.Assignment.prototype.getMoveStrategy=function(e,t,r,n,i){return this._expression.getMoveStrategy(e,t,r,n,i)};function fF(e){return{type:\"updateSliderNonlinear\",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,movesOn:e.movesOn,hasLinearComponent:e.hasLinearComponent}}function dF(e){return{type:\"updateGliderParameter\",span:e.span,movesOn:e.movesOn}}function mF(e){return{type:\"updateSliderForGlider\",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function VO(e,t,r,n,i,s){var o=t.getDependencies();for(let g of o)if(i[g])return;for(var a=o.length-1;a>=0;a--){var u=o[a];if(!s[u]){var l=n[u];if(l!==void 0){var c=r[u];if(c.order===1){var p=c.tree,f=p.getPolynomialCoefficients(u),d=f[1]||FO,m=f[0]||FO;if(!(!m.isConstant||!d.isConstant)&&!(!isFinite(m.asValue())||!isFinite(d.asValue()))&&d.asValue()!==0){var y=[-m.asValue()/d.asValue(),1/d.asValue()];return{symbol:u,id:l,coefficients:y}}}}}}}function yF(e,t){for(var r in t){var n=t[r].evaluationState,i=n.assignment;if(i===e)return r}}function gF(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function wT(e,t){var r=gF(e),n={};for(var i in t){var s=t[i].evaluationState.assignment;t[i].evaluationState.is_slidable&&r[s]&&(n[s]=i)}return n}function BO(e,t,r,n){for(var i=[],s=0;s<r.length;s++){var o=r[s],a={};i.push(a);for(var u=0;u<n.length;u++){var l=n[u],c=Object.create(t);c[l]=void 0;var p=o.tryGetConcreteTree(e,c);if(p.isError){a[l]={tree:p,order:1/0};continue}else a[l]={tree:p,order:p.polynomialOrder(l)}}}return i}function GO(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];t[i].order!==0&&(r[i]=!0)}}x.ParenSeq.prototype.getMoveStrategy=function(e,t,r,n,i){if(r.valueType!==N||r.getDependencies().length!==0)return;for(var s=this.getDependencies(),o=wT(s,n),a=Object.keys(o),u=this.args,l=BO(e,t,u,a),c=[],p={},f={},d=0;d<2;d++){var m=u[d];let E=m.getInputSpan();if(m.isConstant){c[d]=E?{type:\"updateCoordinate\",inputSpan:E}:{type:\"none\"};continue}var y=VO(e,m,l[d],o,p,f);y&&(c[d]={type:\"updateSlider\",id:y.id,coefficients:y.coefficients},p[y.symbol]=!0,GO(a,l[d],f)),c[d]||(c[d]={type:\"none\"})}let[g,h]=c,P;if(g.type===\"none\"&&h.type===\"none\"&&a.length===1&&(P=a[0]),!P)return g.type!==\"none\"||h.type!==\"none\"?c:void 0;var S=o[P],A;try{var T=Object.create(t);T[P]=void 0,A=this.getConcreteTree(e,T).getCompiledFunction()}catch(E){return}vb(A);var I=n[S].evaluationState;return[fF({id:S,initialValue:I.constant_value,min:I.slider_min_number,max:I.slider_max_number,compiled:A,hasLinearComponent:g.type===\"updateSlider\"||h.type===\"updateSlider\"}),{type:\"none\"}]};x.FunctionCall.prototype.getMoveStrategy=function(e,t,r,n,i){if(this._symbol===\"glider\"&&!(!r.isTypedConstant||r.valueType!==N)){var s,o,a;switch(this.args[1].type){case\"Constant\":{var u=this.args[1].asValue();if(typeof u!=\"number\"||(s=this.args[0].getConcreteTree(e,t),!s.isTypedConstant))return;a=s.asTypedValue();let m=this.args[1].getInputSpan();return[m?dF({span:m,movesOn:a}):{type:\"none\"},{type:\"none\"}]}case\"Identifier\":{var l=this.args[1]._symbol,c=wT([l],n),p=c[l];if(p===void 0)return;var f=n[p].evaluationState,d=Object.create(t);return d[l]=void 0,s=this.args[0].getConcreteTree(e,d),s.isTypedConstant?(a=s.asTypedValue(),o={min:f.slider_min_number,max:f.slider_max_number},[mF({min:o.min,max:o.max,movesOn:a,sliderId:p}),{type:\"none\"}]):void 0}default:return}}};x.Image.prototype.getMoveStrategy=function(e,t,r,n,i){if(!(r.center.valueType!==N||r.center.getDependencies().length!==0||!r.width.isConstant||!r.height.isConstant||!r.radianAngle.isConstant||!r.opacity.isConstant)){var s=this.getDependencies(),o=wT(s,n),a=Object.keys(o),u=[this.width,this.height];this.center.type===\"ParenSeq\"?u.push(this.center.args[0],this.center.args[1]):this.center.type===\"Identifier\"&&(this.center.referencedStatementId=yF(this.center._symbol,n));for(var l={},c={},p=BO(e,t,u,a),f=[],d=[2,3,0,1],m=0;m<d.length;m++){var y=d[m],g=u[y];if(!g){f[y]={type:\"none\"};continue}if(g.isConstant){let P=g.getInputSpan();f[y]=P?{type:\"updateCoordinate\",inputSpan:P}:{type:\"none\"};continue}var h=VO(e,g,p[y],o,l,c);h&&(f[y]={type:\"updateSlider\",id:h.id,coefficients:h.coefficients},l[h.symbol]=!0,GO(a,p[y],c)),f[y]||(f[y]={type:\"none\"})}if(!(f[0].type===\"none\"&&f[1].type===\"none\"&&f[2].type===\"none\"&&f[3].type===\"none\"))return f}};x.Base.prototype.getDefaultDragMode=function(e){return\"NONE\"};x.Assignment.prototype.getDefaultDragMode=function(e){return e[0].type!==\"none\"&&e[1].type!==\"none\"?\"XY\":e[0].type!==\"none\"?\"X\":e[1].type!==\"none\"?\"Y\":\"NONE\"};x.ParenSeq.prototype.getDefaultDragMode=function(e){return e[0].type===\"updateSlider\"&&e[1].type===\"updateSlider\"?\"XY\":e[0].type===\"updateSlider\"?\"X\":e[1].type===\"updateSlider\"?\"Y\":e[0].type===\"updateSliderNonlinear\"&&e[0].hasLinearComponent?\"X\":\"NONE\"};x.FunctionCall.prototype.getDefaultDragMode=function(e){return this._symbol!==\"glider\"?\"NONE\":x.Assignment.prototype.getDefaultDragMode.call(this,e)};var hF=x.List;x.Base.prototype.tableInfo=function(e,t){return!1};x.Identifier.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};x.Expression.prototype.tableInfo=function(e,t){var r=t.getDependencies();if(ko(this))return!1;switch(t.valueType){case N:case Ue:if(r.length!==0||t.isMovablePoint&&(t.moveStrategy[0].type===\"updateSlider\"||t.moveStrategy[1].type===\"updateSlider\"))return!1;var n=hF.wrap(t).asValue();return{independent_variable:\"x\",dependent_column:\"y\",by_reference:!1,values:n};case b:if(r.length!==1)return!1;var i=r[0];return e.validFirstColumnVariable(i)?{independent_variable:i,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};x.Assignment.prototype.tableInfo=function(e,t){if(t instanceof x.SolvedEquation||!this.getInputString().length||ko(this)||Ku(t.valueType))return!1;let r=t.getDependencies();if(r.length>1)return!1;let n;if(r.length===0){if(!e.tableableAsConstant(this._symbol))return!1;n=e.implicitIndependent(this._symbol)}else n=r[0];if(!e.validFirstColumnVariable(n))return!1;let i=e.assignmentForbidden(this._symbol)?Os(this.getInputString().replace(/[^=]*=/,\"\")):Os(this.getInputString().split(\"=\")[0]);return{independent_variable:n,dependent_column:i,by_reference:!e.assignmentForbidden(this._symbol)}};x.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length)return!1;var r=t.getDependencies();if(r.length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var i=e.assignmentForbidden(this._symbol),s=i?Os(this.getInputString().replace(/[^=]*=/,\"\")):Os(this.getInputString().split(\"=\")[0]);return{independent_variable:n,dependent_column:s,by_reference:!i}};x.BaseComparator.prototype.tableInfo=function(e,t){return!1};x.DoubleInequality.prototype.tableInfo=function(e,t){return!1};x.Equation.prototype.tableInfo=function(e,t){return!1};x.Base.prototype.tableError=function(){return this.isInequality()?M(\"shared-calculator-error-table-inequality-supplement\"):!(this instanceof x.Expression)&&!(this instanceof x.IRExpression)?M(\"shared-calculator-error-table-generic-supplement\"):!1};x.List.prototype.tableError=function(){return M(\"shared-calculator-error-table-list-supplement\")};x.Equation.prototype.tableError=x.Assignment.prototype.tableError=function(){return M(\"shared-calculator-error-table-equation-supplement\")};x.FunctionDefinition.prototype.tableError=function(){return M(\"shared-calculator-error-table-function-definition-supplement\")};x.Regression.prototype.tableError=function(){return M(\"shared-calculator-error-table-regression-supplement\")};x.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:new x.Constant(NaN)};x.List.prototype.eachElement=function(t){for(var r=0;r<this.length;r++)t(this.elementAt(r),r)};x.List.prototype.mapElements=function(t){for(var r=[],n=0;n<this.length;n++)r.push(t(this.elementAt(n),n));return r};x.IRExpression.prototype.elementAt=function(e){var t=this._chunk.elementAt(e);return new Zt(t)};x.ParenSeq.prototype.elementAt=function(e){return e<0||e>this.args.length-1?new x.Constant(NaN):this.args[e]};function bF(){return wr(this._symbol)+\" \"}x.Identifier.prototype.printLatex=bF;x.Constant.prototype.printLatex=function(){return zs(this.asValue())};x.Ticker.prototype.printLatex=function(){return\"\\\\ticker\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.Negative.prototype.printLatex=function(){return\"-\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};x.Add.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)+\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};x.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+\" \\\\% \\\\operatorname{of} \"+this.args[1].printLatex()};x.Subtract.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)-\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};x.Multiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)*\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};x.DotMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\cdot\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};x.CrossMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\times\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};x.Divide.prototype.printLatex=function(){return\"\\\\frac{\"+this.args[0].printLatex()+\"}{\"+this.args[1].printLatex()+\"}\"};x.Exponent.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)^{\"+this.args[1].printLatex()+\"}\"};x.Assignment.prototype.printLatex=function(){return wr(this._symbol)+\"=\"+this._expression.printLatex()};x.CoordinateEquation.prototype.printLatex=function(){return\"\\\\left(\"+this._symbols.map(e=>wr(e)).join(\",\")+\"\\\\right)=\"+this._expression.printLatex()};x.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+\"=\"+this._rhs.printLatex()};function Sc(e){switch(e){case\">\":return\">\";case\"<\":return\"<\";case\">=\":return\"\\\\ge \";case\"<=\":return\"\\\\le \";case\"=\":return\"=\"}return\"\"}x.BaseComparator.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+Sc(this.operator)+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};x.DoubleInequality.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+Sc(this.args[1])+this.args[2].printLatex()+Sc(this.args[3])+\"\\\\left(\"+this.args[4].printLatex()+\"\\\\right)\"};x.And.prototype.printLatex=function(){if(!(this.args[0]instanceof x.BaseComparator)||!(this.args[1]instanceof x.BaseComparator))throw new Error(\"Not implemented\");if(this.args[0].args[1].printLatex()!==this.args[1].args[0].printLatex())throw new Error(\"Not implemented\");return\"\\\\left(\"+this.args[0].args[0].printLatex()+\"\\\\right)\"+Sc(this.args[0].operator)+\"\\\\left(\"+this.args[0].args[1].printLatex()+\"\\\\right)\"+Sc(this.args[1].operator)+\"\\\\left(\"+this.args[1].args[1].printLatex()+\"\\\\right)\"};function bn(e){return e.printLatex()}function xF(){switch(this._symbol){case\"sqrt\":return\"\\\\sqrt{\"+this.args[0].printLatex()+\"}\";case\"nthroot\":return\"\\\\sqrt[\"+this.args[1].printLatex()+\"]{\"+this.args[0].printLatex()+\"}\";case\"logbase\":return\"\\\\log_{\"+this.args[1].printLatex()+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\";default:return wr(this._symbol)+\"\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"}}x.FunctionCall.prototype.printLatex=xF;x.SeededFunctionCall.prototype.printLatex=function(){return wr(this._symbol)+\"\\\\left(\"+this.args.slice(1).map(bn).join(\", \")+\"\\\\right)\"};x.DotAccess.prototype.printLatex=function(){return\"(\"+this.args[0].printLatex()+\").(\"+this.args[1].printLatex()+\")\"};x.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case\"logbase\":return\"\\\\log_{\"+this.args[0].args[1].printLatex()+\"}\"+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args[0].printLatex()+\"\\\\right)\";default:return wr(this.args[0]._symbol)+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args.map(bn).join(\", \")+\"\\\\right)\"}};x.List.prototype.printLatex=function(){return\"\\\\left[\"+this.args.map(bn).join(\", \")+\"\\\\right]\"};x.Range.prototype.printLatex=function(){return\"\\\\left[\"+this.args[0].args.map(bn).join(\", \")+\" ... \"+this.args[1].args.map(bn).join(\", \")+\"\\\\right]\"};x.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\to(\"+this.args[1].printLatex()+\")\"};x.ListAccess.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\left[\"+this.args[1].printLatex()+\"\\\\right]\"};x.ParenSeq.prototype.printLatex=function(){return\"\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.BareSeq.prototype.printLatex=function(){return this.args.map(bn).join(\", \")};x.NamedCoordinateAccess.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this.args[0].printLatex()+\"\\\\right).\"+this.symbol+\"\\\\right)\"};x.Norm.prototype.printLatex=function(){return\"\\\\left|\"+this.args[0].printLatex()+\"\\\\right|\"};x.Sum.prototype.printLatex=function(){return\"\\\\sum_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};x.Product.prototype.printLatex=function(){return\"\\\\prod_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};x.Integral.prototype.printLatex=function(){return\"\\\\int_{\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)d\"+this.args[0].printLatex()};x.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)^{\"+this.args[2].printLatex()+\"}\"};x.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)!\"};function zO(e){return e.isConstant&&e.asValue()===!0}function TF(e){return e.isConstant&&e.isNaN()}x.Piecewise.prototype.printLatex=function(){var e=this;if(zO(e.args[0]))return e.args[1].printLatex();for(var t=[\"\\\\left\\\\{\"];;){if(zO(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),\": \"),TF(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),\", \"),!(e.args[2]instanceof x.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push(\"\\\\right\\\\}\"),t.join(\"\")};x.FunctionDefinition.prototype.printLatex=function(){return wr(this._symbol)+\"\\\\left(\"+this._argSymbols.map(wr).join(\", \")+\"\\\\right) = \"+this._expression.printLatex()};x.Derivative.prototype.printLatex=function(){return\"\\\\frac{d}{d\"+wr(this._symbol)+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};x.Regression.prototype.printLatex=function(){return\"\\\\left(\"+this._lhs.printLatex()+\"\\\\right)\\\\sim\\\\left(\"+this._rhs.printLatex()+\"\\\\right)\"};x.Histogram.prototype.printLatex=function(){return\"\\\\histogram\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.DotPlot.prototype.printLatex=function(){return\"\\\\dotplot\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.BoxPlot.prototype.printLatex=function(){return\"\\\\boxplot\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.TTest.prototype.printLatex=function(){return\"\\\\TTest\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.IndependentTTest.prototype.printLatex=function(){return\"\\\\IndependentTTest\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.Stats.prototype.printLatex=function(){return\"\\\\Stats\\\\left(\"+this.args.map(bn).join(\", \")+\"\\\\right)\"};x.AssignmentExpression.prototype.printLatex=function(){return wr(this._symbol)+\"=\"+this.args[1].printLatex()};x.ListComprehension.prototype.printLatex=function(){return\"\\\\left[\"+this._body.printLatex()+\"\\\\operatorname{for}\"+this._inputLists.map(bn).join(\", \")+\"\\\\right]\"};x.Substitution.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this._body.printLatex()+\"\\\\right)\\\\operatorname{with}\"+this._assignments.map(bn).join(\", \")+\"\\\\right)\"};\
x.Construction.prototype.printLatex=function(){\
    return\"\\\\construction \"\
};\
x.Base.prototype.getExpressionType=function(e,t){\
    switch(e){\
        case 113:\
        case 114:\
        case 115:\
            return\"POINT3D\";\
        case 100:\
        case 101:\
        case 102:\
        case 118:\
        case 126:\
            return\"CURVE3D_xyz_t\";\
        case 103:\
        case 104:\
        case 105:\
            return\"SURFACE_xyz_uv\";\
        case 110:\
            return\"SURFACE_r_\\u03B8z\";\
        case 123:\
            return\"SURFACE_r_\\u03B8z_AMBIGUOUS\";\
        case 109:\
            return\"SURFACE_z_r\\u03B8\";\
        case 111:\
            return\"SURFACE_r_\\u03B8\\u03C6\";\
        case 124:\
            return\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\";\
        case 107:\
        case 108:\
        case 106:\
        case 117:\
            return\"SURFACE\";\
        case 116:\
            return\"TRIANGLE3D\";\
        case 119:\
        case 120:\
            return\"SURFACE_AMBIGUOUS\";\
        case 121:\
        case 122:\
            return\"SURFACE_CONSTANT_AMBIGUOUS\";\
        case 112:\
            return\"IMPLICIT_SURFACE\";\
        case 125:\
            return\"IMPLICIT_SURFACE_AMBIGUOUS\";\
        case 3:\
        case 4:\
            return t===N?\"SINGLE_POINT\":\"POINT_LIST\";\
        case 1:\
        case 2:\
            return\"X_OR_Y\";\
        case 5:\
            return\"PARAMETRIC\";\
        case 6:\
            return\"POLAR\";\
        case 8:\
            return\"IMPLICIT\";\
        default:\
            return t!==void 0&&re(t,Ee)?\"POLYGON\":\"X_OR_Y\"\
    }\
};\
x.Histogram.prototype.getExpressionType=function(e,t){return\"HISTOGRAM\"};x.DotPlot.prototype.getExpressionType=function(e,t){return\"DOTPLOT\"};x.BoxPlot.prototype.getExpressionType=function(e,t){return\"BOXPLOT\"};function _T(e,t,r){let n=[],i={},s={},o={},a={},u={},l={},c={},p=0,f=[],d=[];if(!r){r=[];for(let h in t)t.hasOwnProperty(h)&&r.push(h)}for(let h in t){if(!t.hasOwnProperty(h))continue;let P=t[h].exportPenalty||0;for(;n.length<P+1;)n.push([]);n[P].push(h)}for(let h of n){let P={};for(let S of h){let A=t[S],T=t[S].exportPenalty||0,I=Ui(A),E=A.getLegalExports(e);for(let v of E)we[v]||i[v]||(I&&(u[v]=!0),T===0&&(a[v]=!0),P[v]=P[v]||[],P[v].push(S),P[v].length>1&&(!s[v]&&I&&(o[v]=!0),s[v]=!0))}for(let S in P)o[S]||(i[S]=P[S])}for(let h of r)c.hasOwnProperty(h)||m(h);function m(h){c[h]=c[h]||{};let P=c[h],S;P.id=h,P.index=p,P.lowlink=p,f.push(P),P.instack=!0,p++;let A=t[h].getDependencies();for(let T of A){if(!i.hasOwnProperty(T))continue;let I=i[T];for(let E of I)c.hasOwnProperty(E)?(S=c[E],S.instack&&(P.lowlink=Math.min(P.lowlink,S.index))):(m(E),S=c[E],P.lowlink=Math.min(P.lowlink,S.lowlink))}if(P.lowlink===P.index)if(S=f.pop(),S.instack=!1,S===P)y(P);else{let T=[S];for(;S=f.pop(),S.instack=!1,T.push(S),S!==P;);g(T)}}function y(h){d.push(h.id)}function g(h){let P=[];for(let S=h.length-1;S>=0;S--){let A=h[S],T=t[A.id].getLegalExports(e);Array.prototype.push.apply(P,T),P.push(T[0]),d.push(A.id)}P=sl(P),P.sort();for(let S of P)l[S]=P}return{resolved:d,globallyDefined:a,tableDefined:u,multiplyDefined:s,multiplyDefinedByTables:o,cyclicallyDefined:l}}var PF=100;function Im(e){for(var t=[],r=0;r<e;r++)t[r]={x:[],y:[],intersects:[]};return t}function IF(e,t,r,n){return r===1&&n===1||r===2&&n===2?function(i){return t(i)-e(i)}:r===1&&n===2||r===2&&n===1?function(i){return i-t(e(i))}:!1}function UO(e,t){t instanceof x.SolvedEquation?t=t._expression:t instanceof x.OptimizedRegression&&(t=t.model);var r=[],n=[];return t instanceof x.DoubleInequality?x.List.eachArgs(t._expressions,function(i){r.push(i[0].getCompiledFunction()),n.push(i[0].isConstant&&i[1].isNaN()),r.push(i[1].getCompiledFunction()),n.push(i[1].isConstant&&i[1].isNaN())}):x.List.wrap(t).eachElement(function(i){r.push(i.getCompiledFunction()),n.push(i.isConstant&&i.isNaN())}),{functions:r,skipIntersecting:n}}function MF(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)&&String(n)!==String(t)&&e[n].shouldIntersect()){var i=e[n],s=UO(i.policy,i.concreteTree);r.push({id:n,graphMode:i.getGraphMode(),functions:s.functions,skipIntersecting:s.skipIntersecting})}return r}function EF(e,t){e.intersects=Array(e.x.length);for(var r=0;r<e.x.length;r++)e.intersects[r]=t}function vF(e,t){if(t===1){var r=e.y;e.y=e.x,e.x=r}}function OF(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),e.intersects&&t.intersects&&Array.prototype.push.apply(e.intersects,t.intersects)}function SF(e,t,r){var n=tT(e,t),i=n.poi.zeros,s=n.poi.extrema,o=[],a=0,u=0;for(a=0;a<i.x.length;a++){for(;u<s.x.length&&s.x[u]<i.x[a];u++)cn(s.y[u],0)&&o.push(s.x[u]);o.push(i.x[a])}for(;u<s.x.length;u++)cn(s.y[u],0)&&o.push(s.x[u]);return{x:o,y:o.map(r)}}function HO(e,t,r){var n=e[r],i=n.getGraphInfo(),s=n.getGraphMode(),o,a,u;try{o=UO(n.policy,n.concreteTree),a=Im(o.functions.length),u=MF(e,r)}catch(S){return Im(0)}if(!u)return a;for(var l=0,c=0;c<u.length;c++)for(var p=u[c],f=0;f<o.functions.length;f++)if(!o.skipIntersecting[f]){for(var d=o.functions[f].fn,m=$u(t,i,d),y=0;y<p.functions.length;y++)if(!u[c].skipIntersecting[y]){var g=p.functions[y].fn,h=IF(d,g,s,p.graphMode);if(h){var P;try{P=SF(h,m,d)}catch(S){return Im(0)}if(l+=P.x.length,l>PF)return Im(o.functions.length);EF(P,p.id),vF(P,s),OF(a[f],P)}}}return a}function DF(e){if(e.length<2)return\"text\";let t=e.split(\"`\").length-1;return t<2?\"text\":t===2&&e[0]===\"`\"&&e[e.length-1]===\"`\"?\"latex\":\"mixed\"}function NF(e){if(e.length===0)return[\"\"];let t=[],r=e.split(/(`)/),n=!1,i=\"\";for(let s=0;s<r.length;s++){let o=r[s];o.length&&(o===\"`\"?(i+=\"`\",n=!n,n||(t.push(i),i=\"\")):(i+=o,n||(t.push(i),i=\"\")))}return i.length&&t.push(i),t}function FT(e){return NF(e).map(AF)}function AF(e){let r=\"\\\\$({\"+[\"[a-zA-Z][0-9]*\",\"[a-zA-Z]_[a-zA-Z0-9]+\",\"[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}\",\"\\\\\\\\[a-zA-Z]+\",\"\\\\\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}\",\"\\\\\\\\[a-zA-Z]+_[a-zA-Z0-9]+\"].join(\"})|\\\\$({\")+\"})\",n=new RegExp(r,\"g\"),i=[],s=0,o=0,a;for(;a=n.exec(e);){o=a.index,o>s&&i.push(e.substr(s,o-s));let u=a[0],l=u.replace(/[{}\\$]/g,\"\").replace(/^([a-zA-Z])([0-9]+)$/,\"$1_$2\");i.push({symbol:l,str:u}),s=a.index+u.length}return s<e.length&&i.push(e.substr(s)),{raw:e,parts:i}}function kO(e,t){return t?\"{\"+Vm(e,{bigCutoff:1e7,digits:8})+\"}\":Fm(e,{bigCutoff:1e7,digits:8})}function VT(e,t,r){return e.map(n=>RF(n,t,r)).join(\"\")}function RF(e,t,r){let n=[],i=DF(e.raw)===\"latex\";for(let s of e.parts)if(typeof s==\"string\")n.push(s);else{let o=new x.Identifier(s.symbol).tryGetConcreteTree(hd,t);if(o.valueType===b&&o.getDependencies().length===0){let a=o.asValue();if(typeof a==\"number\"){n.push(kO(a,i));continue}}else if(o.valueType===j&&r<o.length&&o.getDependencies().length===0){let a=o.elementAt(r).asValue();if(typeof a==\"number\"){n.push(kO(a,i));continue}}i?n.push(\"{?}\"):n.push(\"?\")}return n.join(\"\")}function $O(){let e={},t={},r={},n=[],i=this.statements[Di];for(let s in this.statements){if(!this.statements.hasOwnProperty(s))continue;let o=this.statements[s];switch(o.type){case\"Error\":break;case\"Regression\":{r[s]=[],n.push(s);break}case\"Construction\":break;default:{let a=o.getLegalExports(this.policy);if(a){for(let l of a)o.exportPenalty!==void 0&&o.exportPenalty>0?t[l]=s:e[l]=s;let u=[];for(let l of o.getDependencies())l===\"construction\"&&i?u.push(...i.getDependencies()):u.push(l);r[s]=Rm(u,o.getDummyDependencies(),a)}break}}}for(let s of n){let o=this.statements[s],a=vs(o.userData.residualVariable);a&&(t[a]=s);let u=o.getDependencies().slice(),l={},c;for(;c=u.pop();){if(l[c])continue;l[c]=!0;let p=e[c]||t[c];if(p){u.push(...r[p]),r[s].push(c);continue}t[c]=s}}return{exportMap:e,weakExportMap:t,dependencyMap:r}}var Dc=class{constructor(){this.data={}}getChildIntersections(t){return this.data[t]||{count:0}}addListParent(t,r,n){if(tl(n.valueType,[N,Ue]),r!==void 0)n.valueType===Ue?this.addPoint(t,r,n.value[r]):this.addPoint(t,r,n.value);else{tl(n.valueType,[Ue]);for(let i=0;i<n.value.length;i++)this.addPoint(t,i,n.value[i])}}addPrimitiveParent(t,r){if(tl(r.valueType,[N,Ue]),r.valueType===N)this.addPoint(t,0,r.value);else for(let n=0;n<r.value.length;n++)this.addPoint(t,0,r.value[n])}addPoint(t,r,n){var s;let i=this.data[t]||{count:0};this.data[t]||(this.data[t]=i),i[r]||(i[r]=[]),(s=i[r])==null||s.push(n),i.count++}};var Nc=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return t.slice(0,3)!==\"ans\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Exponent\",\"PercentOf\",\"Substitution\"]}};var Ac=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return this.singleExpression?t.slice(0,3)!==\"ans\":t.slice(0,3)===\"tmp\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return this.singleExpression?[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\",\"PercentOf\"]:[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\"]}};var go=typeof performance!=\"undefined\"?()=>performance.now():()=>Date.now();typeof self!=\"undefined\"&&self.WorkerGlobalScope&&(self.Fragile={countReferences:cd,Opcodes:dt,Types:De,getConstantListLength:sr,ParsenodeError:O});var{Constant:Ps,Seed:XO,FunctionCall:UF,Image:HF,Slider:kF,Table:$F,TableColumn:YF,Construction:XF}=x;function WF(e,t,r,n){switch(e){case\"fourFunction\":return new Nc({singleExpression:!1});case\"singleExpressionFourFunction\":return new Nc({singleExpression:!0});case\"scientific\":return new Ac({singleExpression:!1});case\"singleExpressionScientific\":return new Ac({singleExpression:!0});case\"graphing\":return new zu({enableGeometry:!1,enable3d:t,beta3d:r,scales:n});case\"geometry\":return new zu({enableGeometry:!0,enable3d:!1,beta3d:!1,scales:n});case\"graphing_3d\":return new qu(r)}}var ZF={fourFunction:Jc,singleExpressionFourFunction:Jc,scientific:km,singleExpressionScientific:$m,graphing:ll,graphing_3d:ll,geometry:ll},Di=\"**geo_construction_statement_id**\";function Cn(e,t){var r=zi(e,t);return r.isError||r instanceof x.Expression?r:cl()}function jF(e){let t=e.rawTree.userData,r=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&r.distributionSpec)}function JF(e){let t=e.evaluationState.expression_type,r=e.rawTree.userData;return!r.clickableInfo||!r.clickableInfo.enabled?!1:Fd(e.rawTree)?!0:e.getGraphMode()===4?!1:V1(t)}function Yt(e,t){let r=\"id\"+e;for(let[n,i]of t||[])r+=\"::\"+n+i;return r}var QF=new Ps(Me(0,1)),KF=new Ps(Me(1,1)),eV=new Ps(NaN);function Ts(e,t){return e?e===\"0\"?QF:e===\"1\"?KF:Cn(e,t):eV}function na(e,t){if(e)return Cn(e,t)}function tV(e){return e.slice(0,3)!==\"ans\"}function rV(e){return e.slice(0,6)!==\"idref_\"}function WO(e,t){let{multiplyDefined:r,multiplyDefinedByTables:n,cyclicallyDefined:i}=e;for(let s in r)r.hasOwnProperty(s)&&(t[s]=n[s]?Tg(s):pu(s));for(let s in i){if(!i.hasOwnProperty(s))continue;let o=e.tableDefined[s]&&!e.globallyDefined[s],a=i[s].filter(tV).filter(rV);t[s]=o?Ig(a):Yp(a)}}function Cc(e,t,r){for(let n of r)e[n]||(e[n]=[]),e[n].push(t)}function ZO(e,t,r){if(r.extraDepNodes)for(let n of r.extraDepNodes)n&&Cc(e,t,n.getDependencies());r.clickHandler&&Cc(e,t,r.clickHandler.getDependencies())}function nV(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.cdfMin,o=i.metaData.cdfMax,a={},u=i.type===\"Assignment\"?i._expression:i,l=u&&u.metaData&&u.metaData.distributionSpec,c=Xs(t,r,s,a,-1/0),p=Xs(t,r,o,a,1/0),f=!0,d=!0;if(isNaN(c)&&(f=!1,c=NaN),isNaN(p)&&(d=!1,p=NaN),f?d?c>p&&(f=!1,d=!1,n.error=wg().getError()):n.error=Lg().getError():n.error=Cg().getError(),f&&d){let g=new UF(\"cdf\",[u,new Ps(c),new Ps(p)]);n.cdf_evaluation=+g.tryGetConcreteTree(t,r).asValue()}let m=-1/0,y=1/0;if(l&&(l.discrete&&(m=0),l.symbol===\"binomialdist\"&&u.args&&u.args[0])){let g=+u.args[0].asValue();isFinite(g)&&(y=g)}i.metaData.evaluatedCDFMin=c,i.metaData.evaluatedCDFMax=p,n.cdf_min_valid=f,n.cdf_max_valid=d,n.cdf_min_default=m,n.cdf_max_default=y,n.is_single_identifier=!1,ea(n,t,a)}function iV(e,t,r,n){let i={},s=!0,o=NaN,a,u=!1;if(r){let l=r.tryGetConcreteTree(e,t);a=l.getDependencies().length===0?l.asValue():NaN,u=Array.isArray(a),o=u?a:+a;for(let c of l.getDependencies())i[c]=!0}if(u){for(let l of o)if(!isFinite(+l)){s=!1,o=NaN;break}}else isFinite(+o)||(s=!1,o=NaN);return r||(s=!0,n!==void 0&&(o=n)),{value:o,valid:s,missingVarsMap:i}}var Rc={lineWidth:{parseNode:\"lineWidth\",valueOutputProp:\"computedLineWidth\",formulaOutputProp:\"\",validOutputProp:\"line_width_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=r.is3dPolicy(),o=n!==void 0&&re(n,Ee);return i&&o?2:s?1:2.5},transform:void 0,shouldEvaluate:void 0,seed:\"lw\"},resolution:{parseNode:\"resolution\",valueOutputProp:\"computedResolution\",formulaOutputProp:\"\",validOutputProp:\"resolution_valid\",default:()=>{},transform:void 0,shouldEvaluate:void 0,seed:\"re\"},checkers:{parseNode:\"checkers\",valueOutputProp:\"computedCheckers\",formulaOutputProp:\"\",validOutputProp:\"checkers_valid\",default:()=>jd,transform:void 0,shouldEvaluate:void 0,seed:\"ch\"},lineOpacity:{parseNode:\"lineOpacity\",valueOutputProp:\"computedLineOpacity\",formulaOutputProp:\"\",validOutputProp:\"line_opacity_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&re(n,Ee);return i&&s?.6:.9},transform:void 0,shouldEvaluate:void 0,seed:\"lo\"},pointOpacity:{parseNode:\"pointOpacity\",valueOutputProp:\"computedPointOpacity\",formulaOutputProp:\"\",validOutputProp:\"point_opacity_valid\",default:(e,t,r)=>!e||!t?.9:e.getGraphMode(r,t)===4?1:.9,transform:void 0,shouldEvaluate:void 0,seed:\"po\"},pointSize:{parseNode:\"pointSize\",valueOutputProp:\"computedPointSize\",formulaOutputProp:\"\",validOutputProp:\"point_size_valid\",default:(e,t,r)=>r.is3dProduct()?3:9,shouldEvaluate:void 0,transform:void 0,seed:\"ps\"},fillOpacity:{parseNode:\"fillOpacity\",valueOutputProp:\"computedFillOpacity\",formulaOutputProp:\"\",validOutputProp:\"fill_opacity_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&re(n,Ee);return i&&s?.2:.4},transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t,is_inequality:r}=e.evaluationState;return!!(t===\"POLYGON\"||t===\"PARAMETRIC\"||t===\"CURVE3D_xyz_t\"||r)},seed:\"fo\"},labelSize:{parseNode:\"labelSize\",valueOutputProp:\"computedLabelSize\",formulaOutputProp:\"\",validOutputProp:\"label_size_valid\",transform:void 0,default:()=>1,shouldEvaluate:void 0,seed:\"ls\"},labelAngle:{parseNode:\"labelAngle\",valueOutputProp:\"computedLabelAngle\",formulaOutputProp:\"label_angle_value\",validOutputProp:\"label_angle_valid\",default:()=>0,transform:e=>`-\\\\trigAngleMultiplier*(${e})`,shouldEvaluate:void 0,seed:\"la\"}};function jO(e,t,r,n,i,s,o){let a=Rc[s],u;e&&(u=e.tryGetConcreteTree(n,i));let l=a.default&&a.default(e,u,n,o),c=iV(n,i,r[a.parseNode],l);r[a.valueOutputProp]=c.value,a.formulaOutputProp&&(t[a.formulaOutputProp]=c.value),t[a.validOutputProp]=c.valid,ea(t,n,c.missingVarsMap)}function sV(e,t,r,n){let i,s,o;if(Ui(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let a=0;a<e.evaluationState.column_data.length;a++){i=e.evaluationState.column_data[a];let u=e.rawTree.columns[a];ms(u)||(s=u.header.metaData,o=s[n],jO(o,i,s,t,r,n,e.concreteTree.valueType))}else i=e.evaluationState,s=e.rawTree.metaData,o=s[n],jO(o,i,s,t,r,n,e.concreteTree.valueType)}function JO(e){return Sa(e[0],e[1],e[2]).formatHex()}function QO(e,t,r,n,i){let s;if(e){let o=e.tryGetConcreteTree(n,i),a=o.getDependencies().length>0?void 0:o.asValue(),{valueType:u}=o;if(s=!!(a&&(u===ot||u===Or)),s){let l=o&&o.valueType===ot?JO(a):a.map(JO);t.colorLatexValue=l,r.color_latex_value=l}else delete t.colorLatexValue,delete r.color_latex_value}else s=!0;r.color_latex_valid=s}function oV(e,t,r){let n,i,s;if(Ui(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let o=0;o<e.evaluationState.column_data.length;o++){n=e.evaluationState.column_data[o];let a=e.rawTree.columns[o];ms(a)||(i=a.header.metaData,s=i.colorLatex,QO(s,i,n,t,r))}else n=e.evaluationState,i=e.rawTree.metaData,s=i.colorLatex,QO(s,i,n,t,r)}function aV(e){if(e.concreteTree.valueType===ot&&e.concreteTree.getDependencies().length>0){let t=e.concreteTree._chunk;try{e.evaluationState.shader=gd(t)}catch(r){e.evaluationState.error=r instanceof x.Error?r.getError():ae(r).getError()}}}function uV(e,t,r){let n=e.evaluationState,i=e.rawTree,s={},o=i.metaData.clickHandler;if(!o)return;let a=o.tryGetConcreteTree(t,r);!a.isError&&a.valueType!==Be&&(a=hl(ne(a.valueType)));for(let l of a.getDependencies())t.validActionVariable(l)||(s[l]=!0);let u=Object.keys(s);u.length>0&&(a=Ut(u).setDependencies(a.getDependencies())),a.isError&&!mT(t,a)?n.click_handler={status:\"error\",error:a.getError()}:a.isEmptyAction?n.click_handler={status:\"empty\"}:n.click_handler={status:\"maybe-valid\"},ea(n,t,s)}function lV(e,t,r){let n=e.evaluationState,i=e.rawTree,s=n.expression_type===\"POLAR\"||n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"?i.metaData.polarDomainMin:i.metaData.parametricDomainMin,o=n.expression_type===\"POLAR\"||n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"?i.metaData.polarDomainMax:i.metaData.parametricDomainMax,a={},u=!!(s||o),l=Xs(t,r,s,a,0),c=NaN;o?c=Xs(t,r,o,a,NaN):n.expression_type===\"PARAMETRIC\"||n.expression_type===\"CURVE3D_xyz_t\"?c=1:n.expression_type===\"POLAR\"?c=Math.PI*12/+r.trigAngleMultiplier.asValue():(n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\")&&(c=Math.PI*2);let p=zT(l,c,n);({min:l,max:c}=p),i.metaData.evaluatedDomainMin=l,i.metaData.evaluatedDomainMax=c,(n.expression_type===\"POLAR\"||n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\")&&(i.metaData.isExplicitDomain=u),n.domain_min_number=l,n.domain_max_number=c,n.domain_min_valid=p.minValid,n.domain_max_valid=p.maxValid,(n.expression_type===\"PARAMETRIC\"||n.expression_type===\"CURVE3D_xyz_t\")&&delete a.t,ea(n,t,a)}function cV(e,t,r){let n=e.evaluationState,i=n.expression_type,s=e.rawTree,o=s.metaData.parametricDomain3DuMin,a=s.metaData.parametricDomain3DuMax,u=s.metaData.parametricDomain3DvMin,l=s.metaData.parametricDomain3DvMax,c={},p=0,f=1,d=0,m=1;i===\"SURFACE_r_\\u03B8\\u03C6\"||i===\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\"?(f=2*Math.PI,m=Math.PI):i===\"SURFACE_z_r\\u03B8\"&&(f=10,m=2*Math.PI),p=Xs(t,r,o,c,p),f=Xs(t,r,a,c,f),d=Xs(t,r,u,c,d),m=Xs(t,r,l,c,m);let y=zT(p,f,n);({min:p,max:f}=y);let g=zT(d,m,n);({min:d,max:m}=g),s.metaData.evaluatedDomain3DuMin=p,s.metaData.evaluatedDomain3DuMax=f,s.metaData.evaluatedDomain3DvMin=d,s.metaData.evaluatedDomain3DvMax=m,n.domain_min_u_valid=y.minValid,n.domain_max_u_valid=y.maxValid,n.domain_min_v_valid=g.minValid,n.domain_max_v_valid=g.maxValid,n.expression_type===\"SURFACE_xyz_uv\"&&(delete c.u,delete c.v),ea(n,t,c)}function Xs(e,t,r,n,i){if(r){let s=r.tryGetConcreteTree(e,t);for(let o of s.getDependencies())n[o]=!0;return s.isConstant?+s.asValue():NaN}else return i}function zT(e,t,r){let n=!0,i=!0;return isFinite(e)||(n=!1,e=NaN),isFinite(t)||(i=!1,t=NaN),n?i?e>t&&(n=!1,i=!1,r.error=Rg().getError()):r.error=Ag().getError():r.error=Ng().getError(),{min:e,max:t,minValid:n,maxValid:i}}function pV(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.vizAxisOffset,o=i.metaData.vizBreadth,a={},u=Xs(t,r,s,a,1),l=Xs(t,r,o,a,1),c=!0,p=!0;isFinite(u)||(c=!1,u=NaN),isFinite(l)||(p=!1,l=NaN),c?p||(n.error=Fy().getError()):n.error=_y().getError(),i.metaData.evaluatedAxisOffset=u,i.metaData.evaluatedBreadth=l,n.viz_values={axisOffset:u,breadth:l},n.viz_valids={axisOffset:c,breadth:p},ea(n,t,a)}function fV(e){return e.globalRandomSeed||[]}function BT(e,t,r,n,i){let s={},o={},a=[],u=[];for(let l in n)n[l]&&(o[l]=!0,a.push(l));for(let l in i)i[l]&&(s[l]=!0,u.push(l));for(;a.length||u.length;){for(;a.length;){let l=a.pop(),c=t[l];if(c)for(let p of c.getLegalExports(e))s[p]||(s[p]=!0,u.push(p))}for(;u.length;){let l=u.pop(),c=r[l];if(c)for(let p of c)o[p]||(o[p]=!0,a.push(p))}}return{ids:o,symbols:s}}function GT(e,t,r){if(e.isError||e.getDependencies().length||e.valueType!==Be)return;let n=e.asValue();if(n)for(let i in n.updateRules){t[i]=Gx(n,i);let{value:s,valueType:o}=n.updateRules[i];r[i]=new x.Assignment(i,Ke(o,s))}}var Mm=class{constructor(){this.childIntersections=new Dc;this.getCLSymbolMap=$O;this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.dimensions={width:0,height:0},this.intersectId=void 0,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.use_degrees=!1,this.initialEvaluation=!1,this.globalEventCount=0,this.actions=!0,this.substitutions=!0,this.setEvaluationMode(\"graphing\"),this.setProduct(\"graphing\"),this.setBeta3d(!1),this.setRestrictedFunctions(!1),this.setForceEnableGeometryFunctions(!1),this.setFunctionDefinition(!0),this.setReplaceRoundWithReciprocal(!1),this.setDistributions(!0),this.invalidate()}invalidate(){delete this.statements[Di];for(let r in this.statements)this.statements.hasOwnProperty(r)&&this.markAsDirtyRoot(r);this.currentStatus={},this.analysis={};let t=this.viewState?{xAxisScale:this.viewState.xAxisScale,yAxisScale:this.viewState.yAxisScale}:void 0;this.policy=WF(this.evaluationMode,this.product===\"graphing-3d\",this.beta3d,t),this.parent_frame=ZF[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,isGeometryCalculator:this.evaluationMode===\"geometry\",is3DCalculator:this.product===\"graphing-3d\",replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,trigAngleMultiplier:new Ps(this.use_degrees?Math.PI/180:Me(1,1)),initialEvaluation:new Ps(this.initialEvaluation?1:0),globalEventCount:new Ps(0),globalRandomSeed:new XO(this.globalRandomSeedString||\"\"),width:this.policy.dimensionVarsEnabled()?new Ps(Me(this.dimensions.width,1)):tf(\"width\"),height:this.policy.dimensionVarsEnabled()?new Ps(Me(this.dimensions.height,1)):tf(\"height\")}),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame),this.lastClockTickTime=void 0}processChangeSet(t){let r=go(),n={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};Gv(n);let i={intersections:{},graphs:{}};t.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={});let s=!!t.isCompleteState&&!t.isUndoRedoState;s!==this.initialEvaluation&&(this.initialEvaluation=s,this.invalidate()),t.hasOwnProperty(\"logInternalErrors\")&&Zm(t.logInternalErrors),t.viewState&&this.setViewState(t.viewState),t.hasOwnProperty(\"degreeMode\")&&this.setDegreeMode(t.degreeMode),t.hasOwnProperty(\"globalRandomSeed\")&&this.setGlobalRandomSeed(t.globalRandomSeed),t.hasOwnProperty(\"evaluationMode\")&&this.setEvaluationMode(t.evaluationMode),t.hasOwnProperty(\"additionalFunctions\")&&this.setAdditionalFunctions(t.additionalFunctions),t.hasOwnProperty(\"restrictedFunctions\")&&this.setRestrictedFunctions(t.restrictedFunctions),t.hasOwnProperty(\"forceEnableGeometryFunctions\")&&this.setForceEnableGeometryFunctions(t.forceEnableGeometryFunctions),t.hasOwnProperty(\"distributions\")&&this.setDistributions(t.distributions),t.hasOwnProperty(\"functionDefinition\")&&this.setFunctionDefinition(t.functionDefinition),t.hasOwnProperty(\"replaceRoundWithReciprocal\")&&this.setReplaceRoundWithReciprocal(t.replaceRoundWithReciprocal),t.hasOwnProperty(\"pointsOfInterest\")&&this.setWorkerConfigProperty(\"pointsOfInterest\",t.pointsOfInterest),t.hasOwnProperty(\"plotSingleVariableImplicitEquations\")&&this.setWorkerConfigProperty(\"plotSingleVariableImplicitEquations\",t.plotSingleVariableImplicitEquations),t.hasOwnProperty(\"plotImplicits\")&&this.setWorkerConfigProperty(\"plotImplicits\",t.plotImplicits),t.hasOwnProperty(\"plotInequalities\")&&this.setWorkerConfigProperty(\"plotInequalities\",t.plotInequalities),t.hasOwnProperty(\"sliders\")&&this.setWorkerConfigProperty(\"sliders\",t.sliders),t.hasOwnProperty(\"actions\")&&this.setActions(!!t.actions),t.hasOwnProperty(\"substitutions\")&&this.setSubstitutions(!!t.substitutions),t.hasOwnProperty(\"beta3d\")&&this.setBeta3d(!!t.beta3d),t.hasOwnProperty(\"product\")&&this.setProduct(t.product);let o;if(t.hasOwnProperty(\"selectedIds\")){let p=t.selectedIds||{};(this.intersectId===void 0||!p[this.intersectId])&&([o]=Object.keys(p),this.intersectId=o)}t.hasOwnProperty(\"dimensions\")&&this.setDimensions(t.dimensions);let a=go();this.processStatements(t,i);let u=go();n.processStatements=u-a,a=u,this.updateAnalysis(),u=go(),n.updateAnalysis=u-a,a=u,o!==void 0&&this._updateIntersections(o,i),u=go(),n.updateIntersections=u-a,a=u;let l=this._publishAllStatuses();u=go(),n.publishAllStatuses=u-a,a=u,this._computeAllLabels(),u=go(),n.computeAllLabels=u-a,a=u,this._computeAriaDescriptions(),u=go(),n.computeAriaDescriptions=u-a,a=u,this._graphAllChanged(i),u=go(),n.graphAllChanges=u-a;let c=this.processEvents(t.events);return this.unpublishedIds={},n.timeInWorker=u-r,{syncId:t.syncId,isCompleteState:t.isCompleteState,intersectionChanges:i.intersections,statusChanges:l,graphChanges:i.graphs,timingData:n,eventUpdates:c}}processStatements(t,r){if(t.removes)for(let n in t.removes){let i;if(!t.isCompleteState&&this.statements.hasOwnProperty(n)&&(i=this.statements[n].getAllIds()),this.removeStatement(n,r),!t.isCompleteState&&i)for(let s of i)r.graphs[s]=void 0}if(t.statements)for(let n in t.statements){let i=t.statements[n];i===null||this.addStatement(i,r)}}setViewState(t){if(Po(t,this.viewState))return;let r=!!(this.viewState&&t.xAxisScale===this.viewState.xAxisScale&&t.yAxisScale===this.viewState.yAxisScale);if(this.viewState=t,r)for(let n in this.statements)this.statements.hasOwnProperty(n)&&(this.unpublishedIds[n]=!0);else this.invalidate()}getViewState(){return this.viewState}setDegreeMode(t){this.use_degrees=t,this.invalidate()}setDimensions(t){t!==void 0&&(this.dimensions=t,this.invalidate())}setGlobalRandomSeed(t){this.globalRandomSeedString=t,this.parent_frame.globalRandomSeed=new XO(t),this.dirtyExportedSymbolRoots.globalRandomSeed=!0}setEvaluationMode(t){this.evaluationMode=t,this.invalidate()}setProduct(t){this.product=t,this.invalidate()}setBeta3d(t){this.beta3d=t,this.invalidate()}setAdditionalFunctions(t){this.additionalFunctions=t,this.invalidate()}setRestrictedFunctions(t){this.restrictedFunctions=t,this.invalidate()}setForceEnableGeometryFunctions(t){this.forceEnableGeometryFunctions=t,this.invalidate()}setDistributions(t){this.distributions=t,this.invalidate()}setFunctionDefinition(t){this.functionDefinition=t,this.invalidate()}setReplaceRoundWithReciprocal(t){this.replaceRoundWithReciprocal=t,this.invalidate()}setActions(t){t!==this.actions&&(this.actions=t,this.invalidate())}setSubstitutions(t){t!==this.substitutions&&(this.substitutions=t,this.invalidate())}setWorkerConfigProperty(t,r){r!==ii[t]&&(ii[t]=r,this.invalidate())}_publishAllStatuses(){let t={},r=this.currentStatus;this.currentStatus={};for(let n in this.unpublishedIds){if(!this.analysis.hasOwnProperty(n))continue;let i=this.analysis[n].evaluationState;Po(i,r[n])||(t[n]=i),this.currentStatus[n]=i}return t}_computeAllLabels(){for(let t in this.currentLabel){let r=this.statements[t];if(!r)continue;let n=r.tryGetConcreteTree(this.policy,this.frame),i=1;(n.valueType===Ue||n.valueType===Kt||n.valueType===ur||n.valueType===zt||n.valueType===qt)&&(i=n.length);let s=[],o=this.currentLabel[t];if(ls(o))for(let a=0;a<i;a++)s.push(VT(o,this.frame,a));Po(s,r.computedLabels)||(r.computedLabels=s,this.unpublishedIds[t]=!0)}}_computeAriaDescriptions(){for(let t in this.analysis){let r=this.analysis[t],n=r.evaluationState,s=r.rawTree.userData;if(s.description&&s.description!==\"\"){n.computed_description=[];let o=1;r.concreteTree.isList?o=r.concreteTree.length:n.dimensions&&n.dimensions.x&&Array.isArray(n.dimensions.x)&&(o=n.dimensions.x.length);for(let a=0;a<o;a++)n.computed_description.push(VT(FT(s.description),this.frame,a))}}}_graphAllChanged(t){let r=this.getViewState(),n=!1;if(!(!r||!w1(r))){for(let i in this.unpublishedIds){if(!this.analysis.hasOwnProperty(i))continue;let s=this.analysis[i],o=s.evaluationState.expression_type,a=o===\"SINGLE_POINT\"||o===\"POINT_LIST\";if(Ui(s.rawTree)){let u=s.graph(r,void 0),l=s.rawTree.getAllIds();for(let c of l)u[c]?this._notifyGraphComputed(c,u[c],t):this._notifyGraphRemoved(c,t)}else s.evaluationState.is_graphable&&(s.rawTree.userData.shouldGraph||s.rawTree.userData.showLabel&&a)?(this._notifyGraphComputed(i,s.graph(r,this.childIntersections.getChildIntersections(i)),t),this.intersectId===i&&(n=!0)):this._notifyGraphRemoved(i,t)}Mn(this.unpublishedIds).length&&this.intersectId!==void 0&&(this.unpublishedIds.hasOwnProperty(this.intersectId)||(n=!0)),n&&this._updateIntersections(this.intersectId,t)}}_notifyGraphRemoved(t,r){r.graphs[t]=void 0}_notifyGraphComputed(t,r,n){O0(r),n.graphs[t]=r}_updateIntersections(t,r){if(!this.viewState)return;if(!this.analysis[t]||!this.analysis[t].shouldIntersect()){r.intersections[t]=[];return}let n=HO(this.analysis,this.viewState,t);r.intersections[t]=n}getDisabledFeatures(){let t=this.policy.disabledFeatures();this.functionDefinition===!1&&(t=t.concat(\"FunctionDefinition\")),this.actions===!1&&(t=t.concat(\"UpdateRule\")),this.substitutions===!1&&(t=t.concat(\"Substitution\"));let r=this.additionalFunctions||[];return t=t.filter(n=>!(n===\"Exponent\"&&r.indexOf(\"exponent\")!==-1||n===\"PercentOf\"&&r.indexOf(\"percent\")!==-1)),t}areFractionsDisallowed(){let{evaluationMode:t}=this;return t!==\"fourFunction\"&&t!==\"singleExpressionFourFunction\"?!1:!this.additionalFunctions||this.additionalFunctions.indexOf(\"fraction\")===-1}addStatement(t,r){if(!t)return;let n=t.id;this.markExportsDirty(n),this.markAsDirtyRoot(n);let i;if(t.type===\"statement\"){let l=t.latexSelection;i=l&&{input:t.latex,start:l.start,end:l.end}}let s={index:this.policy.ansEnabled()?t.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),seedPrefix:Yt(n),writeIntegral:this.evaluationMode===\"geometry\",selection:i},o={extraDepNodes:[]};switch(t.type){case\"table\":let l=[];this.statements.hasOwnProperty(n)&&(l=this.statements[n].getAllIds()),t.shouldGraph=!0;let c=t.columns,p=[],f=I=>!I.replace(/\\\\space|\\\\ /g,\"\").match(/\\S/);for(let I=0;I<c.length;I++){let E,v,D,R=c[I];E=zi(R.latex,se($({},s),{seedPrefix:Yt(n,[[\"tr\",0],[\"tc\",I]])})),v=[];let L=-1;for(let w=0;w<c[I].values.length;w++)f(R.values[w])?v.push(new Ps(NaN)):(v.push(zi(R.values[w],se($({},s),{seedPrefix:Yt(n,[[\"tr\",w+1],[\"tc\",I]])}))),L=w);if(v=v.slice(0,L+1),D=new YF(E,v),D.id=R.id,D.header){if(D.header.userData=R,D.header.metaData={extraDepNodes:[]},R.colorLatex){let w=Cn(R.colorLatex,se($({},s),{seedPrefix:Yt(n,[[\"tr\",0],[\"tc\",I],[\"cl\",I]])}));D.header.metaData.colorLatex=w,D.header.metaData.extraDepNodes.push(w)}if(R.pointSize){let w=Cn(R.pointSize,se($({},s),{seedPrefix:Yt(n,[[\"tr\",0],[\"tc\",I],[\"ps\",I]])}));D.header.metaData.pointSize=w,D.header.metaData.extraDepNodes.push(w)}if(R.pointOpacity){let w=Cn(R.pointOpacity,se($({},s),{seedPrefix:Yt(n,[[\"tr\",0],[\"tc\",I],[\"po\",I]])}));D.header.metaData.pointOpacity=w,D.header.metaData.extraDepNodes.push(w)}if(R.lineWidth){let w=Cn(R.lineWidth,se($({},s),{seedPrefix:Yt(n,[[\"tr\",0],[\"tc\",I],[\"lw\",I]])}));D.header.metaData.lineWidth=w,D.header.metaData.extraDepNodes.push(w)}if(R.lineOpacity){let w=Cn(R.lineOpacity,se($({},s),{seedPrefix:Yt(n,[[\"tr\",0],[\"tc\",I],[\"lo\",I]])}));D.header.metaData.lineOpacity=w,D.header.metaData.extraDepNodes.push(w)}}p.push(D)}this.statements[n]=new $F(p);let d=this.statements[n].getAllIds();l.forEach(I=>{d.indexOf(I)===-1&&this._notifyGraphRemoved(I,r)});break;case\"image\":let m=\"-\\\\trigAngleMultiplier*(\"+t.angle+\")\",y=Cn(t.center,se($({},s),{seedPrefix:Yt(n,[[\"ic\",n]])})),g=Cn(m,se($({},s),{seedPrefix:Yt(n,[[\"ia\",n]])})),h=Cn(t.width,se($({},s),{seedPrefix:Yt(n,[[\"iw\",n]])})),P=Cn(t.height,se($({},s),{seedPrefix:Yt(n,[[\"ih\",n]])})),S=Cn(t.opacity,se($({},s),{seedPrefix:Yt(n,[[\"io\",n]])}));this.statements[n]=new HF({center:y,radianAngle:g,width:h,height:P,opacity:S},void 0);break;case\"ticker\":{this.statements[n]=new x.Ticker({handler:Cn(t.handlerLatex,se($({},s),{allowDt:!0})),minStep:Cn(t.minStepLatex||\"0\",s)});break}case\"geometry-toolbar-predicate\":{this.statements[n]=Cn(`\\\\{${t.latex}:1,0\\\\}`,$({},s));break}default:t=t;let A,T=Os(t.latex);T.slice(-1)===\"=\"?A=T.substring(0,T.length-1):A=t.latex,this.statements[n]=zi(A,s);for(let I in Rc){let E=I;if(t[E]){let v=Rc[E],D=t[E];v.transform&&(D=v.transform(D));let R=Ts(D,se($({},s),{seedPrefix:Yt(n,[[v.seed,n]])}));o[E]=R,o.extraDepNodes.push(R)}}if(t.colorLatex){let I=na(t.colorLatex,se($({},s),{seedPrefix:Yt(n,[[\"ac\",n]])}));o.colorLatex=I,o.extraDepNodes.push(I)}if(t.polarDomain&&t.polarDomain.min&&(o.polarDomainMin=Ts(t.polarDomain.min,se($({},s),{seedPrefix:Yt(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.polarDomainMin)),t.polarDomain&&t.polarDomain.max&&(o.polarDomainMax=Ts(t.polarDomain.max,se($({},s),{seedPrefix:Yt(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.polarDomainMax)),t.parametricDomain&&t.parametricDomain.min&&(o.parametricDomainMin=Ts(t.parametricDomain.min,se($({},s),{seedPrefix:Yt(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.parametricDomainMin)),t.parametricDomain3Du&&t.parametricDomain3Du.min&&(o.parametricDomain3DuMin=Ts(t.parametricDomain3Du.min,se($({},s),{seedPrefix:Yt(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.parametricDomain3DuMin)),t.parametricDomain3Dv&&t.parametricDomain3Dv.min&&(o.parametricDomain3DvMin=Ts(t.parametricDomain3Dv.min,se($({},s),{seedPrefix:Yt(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.parametricDomain3DvMin)),t.parametricDomain&&t.parametricDomain.max&&(o.parametricDomainMax=Ts(t.parametricDomain.max,se($({},s),{seedPrefix:Yt(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.parametricDomainMax)),t.parametricDomain3Du&&t.parametricDomain3Du.max&&(o.parametricDomain3DuMax=Ts(t.parametricDomain3Du.max,se($({},s),{seedPrefix:Yt(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.parametricDomain3DuMax)),t.parametricDomain3Dv&&t.parametricDomain3Dv.max&&(o.parametricDomain3DvMax=Ts(t.parametricDomain3Dv.max,se($({},s),{seedPrefix:Yt(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.parametricDomain3DvMax)),t.vizProps&&(t.vizProps.axisOffset&&(o.vizAxisOffset=Ts(t.vizProps.axisOffset,se($({},s),{seedPrefix:Yt(n,[[\"vo\",n]])})),o.extraDepNodes.push(o.vizAxisOffset)),t.vizProps.breadth&&(o.vizBreadth=Ts(t.vizProps.breadth,se($({},s),{seedPrefix:Yt(n,[[\"vb\",n]])})),o.extraDepNodes.push(o.vizBreadth))),t.cdf&&t.cdf.show){let I=s1(t.latex);I&&I.type===\"distribution\"&&(o.distributionSpec=I,o.cdfMin=na(t.cdf.min,se($({},s),{seedPrefix:Yt(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.cdfMin),o.cdfMax=na(t.cdf.max,se($({},s),{seedPrefix:Yt(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.cdfMax))}if(this.statements[n].shouldPromoteToSlider(this.policy)){let I=t.slider,E=!!(I&&I.isPlayingOnce),v=na(I&&I.softMin,s),D=na(I&&I.softMax,s),R=na(I&&I.min,se($({},s),{seedPrefix:Yt(n,[[\"lm\",n]])})),L=na(I&&I.max,se($({},s),{seedPrefix:Yt(n,[[\"lM\",n]])})),w=na(I&&I.step,se($({},s),{seedPrefix:Yt(n,[[\"ls\",n]])}));this.statements[n]=new kF(this.statements[n],{sliderMin:R,sliderMax:L,sliderStep:w,sliderIsPlayingOnce:E,sliderSoftMin:v,sliderSoftMax:D})}}let a=t.clickableInfo;a&&a.enabled&&a.latex&&(o.clickHandler=Cn(a.latex,se($({},s),{allowIndex:!0}))),this.statements[n].userData=t,this.statements[n].metaData=o;let u=t.label;if(u){let l=this.currentLabel[n];(!l||l.raw!==u)&&(this.currentLabel[n]=FT(u))}else delete this.currentLabel[n]}removeStatement(t,r){let n=this.statements[t];if(n){if(this.markExportsDirty(t),Ui(n)){let i=this;n.getAllIds().forEach(function(s){i._notifyGraphRemoved(s,r)})}else this._notifyGraphRemoved(t,r);delete this.currentLabel[t],delete this.statements[t],delete this.analysis[t],delete this.currentStatus[t]}}markExportsDirty(t){if(this.statements[t]){Vu(this.statements[t])&&(this.markedRegressionDirty=!0);for(let r of this.statements[t].getLegalExports(this.policy))this.dirtyExportedSymbolRoots[r]=!0}}markAsDirtyRoot(t){this.dirtyStatementRoots[t]=!0}getFrame(){return this.updateAnalysis(),this.frame}getAnalysis(){return this.updateAnalysis(),this.analysis}getEvaluationState(t){if(this.updateAnalysis(),!!this.analysis[t])return this.analysis[t].evaluationState}_updateRegressions(t){let r=this.frame,n=this.lastFrame,i=this.regressionFrame;if(!this.policy.graphingEnabled())return;let s=[];for(let c in t)t.hasOwnProperty(c)&&Vu(t[c])&&s.push(c);let o=this;s.sort(function(c,p){let f=o.statements[c].userData&&o.statements[c].userData.residualVariable,d=o.statements[p].userData&&o.statements[p].userData.residualVariable;return f&&!d?-1:d&&!f?1:0});let a=_T(this.policy,t,s);WO(a,i);let u=a.resolved,l={};for(let c of u)if(c!==Di)if(Vu(this.statements[c]))this.analysis[c]=t[c].analyze(this.policy,i,r,n,l),this.analysis[c].exportTo(this.policy,r),delete t[c];else{let p=t[c].tryGetConcreteTree(this.policy,i);t[c].exportTo(this.policy,p,i),l[c]={rawTree:t[c],concreteTree:p}}}buildSymbolToExpressionDirtyMap(){let t={};for(let r in this.statements){if(!this.statements.hasOwnProperty(r))continue;let n=this.statements[r],i=n.metaData;if(Cc(t,r,n.getDependencies()),Cc(t,r,n.getLegalExports(this.policy)),Vu(n)&&n.userData&&n.userData.residualVariable&&Cc(t,r,[vs(n.userData.residualVariable)]),ZO(t,r,i),Ui(n)&&n.columns)for(let s=0;s<n.columns.length;s++){let o=n.columns[s];!ms(o)&&o.header&&o.header.metaData&&ZO(t,r,o.header.metaData)}}return t}buildChildIntersectionMap(){var n,i;let t=this.childIntersections,r=new Dc;for(let s in this.analysis){let o=this.analysis[s],{geometry:a}=o.evaluationState;if(a!=null&&a.call&&a.call.symbol===\"intersection\"&&this.statements[s].userData.shouldGraph&&!o.concreteTree.isError){let u=!!this.unpublishedIds[s],l=o.concreteTree.asTypedValue();for(let c of a.call.parents){let p=c&&this.frame[c[0]],f=p&&p.userData.id;if(f==null)continue;let d=c&&c[1],m=this.analysis[f];q(m.concreteTree.asTypedValue().valueType)?r.addListParent(f,d===void 0?void 0:d-1,l):r.addPrimitiveParent(f,l),u&&(this.unpublishedIds[f]=!0)}}}for(let s in t.data){let o=((n=t.data[s])==null?void 0:n.count)||0;(((i=r.data[s])==null?void 0:i.count)||0)<o&&(this.unpublishedIds[s]=!0)}return r}updateConstruction(){if(!this.policy.isGeometryEnabled){this.parent_frame.construction=Pa();return}let t=[];for(let o in this.statements)this.statements[o].userData.isInConstructionsFolder&&t.push(o);let r=this.statements[Di],n=new XF(t);n.metaData={extraDepNodes:[]},n.userData={};let i={};for(let o of(r==null?void 0:r.getDependencies())||[])i[o]=!0;let s={};for(let o of n.getDependencies())s[o]=!0;(!r||!Po(i,s))&&(this.statements[Di]=n,this.parent_frame.construction=n,this.markAsDirtyRoot(Di),this.markExportsDirty(Di))}updateAnalysis(){var f;this.updateConstruction();let t=this.buildSymbolToExpressionDirtyMap(),r=BT(this.policy,this.statements,t,this.dirtyStatementRoots,this.dirtyExportedSymbolRoots),n=this.markedRegressionDirty;for(let d in r.ids)this.statements[d]&&Vu(this.statements[d])&&(n=!0);let i={};if(n){for(let d in this.statements)this.statements[d]&&(i[d]=this.statements[d]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{let d=r.ids;for(let y in d)this.statements[y]&&(i[y]=this.statements[y]);let m=r.symbols;for(let y in m)m[y]&&(delete this.frame[y],delete this.regressionFrame[y])}for(let d in i)i[d]&&(this.unpublishedIds[d]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};let s=this.analysis,o=this.frame;(this.evaluationMode===\"graphing\"||this.evaluationMode===\"geometry\"||this.evaluationMode===\"graphing_3d\")&&this._updateRegressions(i);let a=_T(this.policy,i);WO(a,o);let u=a.resolved;for(let d of u)if(d!==Di)switch(this.evaluationMode){case\"fourFunction\":case\"singleExpressionFourFunction\":s[d]=this.statements[d].analyzeFourFunction(this.policy,o,s),s[d].exportTo(this.policy,o);break;case\"scientific\":s[d]=this.statements[d].analyzeScientific(this.policy,o,s),s[d].exportTo(this.policy,o);break;case\"singleExpressionScientific\":s[d]=this.statements[d].analyzeSingleExpressionScientific(this.policy,o,s),s[d].exportTo(this.policy,o);break;case\"graphing\":case\"graphing_3d\":case\"geometry\":if(!this.policy.graphingEnabled())break;if(o.r){let m=Object.create(o);if(m.r=void 0,s[d]=this.statements[d].analyze(this.policy,m,s),s[d].getGraphMode()===6){s[d].exportTo(this.policy,o);continue}}s[d]=this.statements[d].analyze(this.policy,o,s),s[d].exportTo(this.policy,o);break}if(this.policy.graphingEnabled()){for(let d of u){if(d===Di)continue;let m=s[d],y=m.evaluationState.expression_type;for(let g in Rc){let h=g;var l=Rc[h];this.evaluationMode!==\"graphing_3d\"&&(h===\"checkers\"||h===\"resolution\")||(!l.shouldEvaluate||l.shouldEvaluate(m))&&sV(m,this.policy,o,h)}oV(m,this.policy,o),this.product===\"graphing-3d\"&&aV(m),this.actions&&JF(m)&&uV(m,this.policy,o),y===\"PARAMETRIC\"||y===\"CURVE3D_xyz_t\"||y===\"POLAR\"||y===\"SURFACE_r_\\u03B8z\"||y===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"?lV(m,this.policy,o):y===\"SURFACE_xyz_uv\"||y===\"SURFACE_r_\\u03B8\\u03C6\"||y===\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\"||y===\"SURFACE_z_r\\u03B8\"?cV(m,this.policy,o):y===\"BOXPLOT\"?pV(m,this.policy,o):jF(m)&&nV(m,this.policy,o)}this.childIntersections=this.buildChildIntersectionMap()}fV(t).forEach(function(d){s[d].evaluationState.depends_on_random_seed=!0});let c=BT(this.policy,this.statements,t,{[Di]:!0},{construction:!0});for(let d in c.ids){if(d===Di)continue;let m=s[d].evaluationState;m.geometry&&(m.geometry.unconstructable=!0)}let p;for(let d in this.statements)if((f=this.statements[d].parseOptions)!=null&&f.selection){p=d;break}if(p){let d=BT(this.policy,this.statements,t,{[p]:!0},{[`idref_${p}`]:!0});for(let m in d.ids){if(m===Di)continue;let y=s[m].evaluationState;y.geometry&&(y.geometry.depends_on_selected=!0)}}this.lastFrame=Object.create(this.parent_frame);for(let d in o)o.hasOwnProperty(d)&&(this.lastFrame[d]=o[d])}processEvents(t){if(!t||!this.actions)return;let r=Object.create(this.frame),n={},i=!1,s=!1,o;for(let l of t)switch(this.globalEventCount+=1,r.globalEventCount=new x.Constant(this.globalEventCount),l.type){case\"step\":{let p=this.statements[l.expressionId];if(!p)continue;let f=p.tryGetConcreteTree(this.policy,r);s=!0,GT(f,n,r);break}case\"click\":{let p=this.statements[l.expressionId];if(!p||!p.metaData.clickHandler)continue;r.index=new x.Constant(l.indexVar+1);let f=p.metaData.clickHandler.tryGetConcreteTree(this.policy,r);s=!0,i=!0,GT(f,n,r);break}case\"clock-tick\":{(o===void 0||l.isFirstTick&&!o.isFirstTick)&&(o=l);break}default:return l}if(o){let l=this.statements[o.id];if(l&&l instanceof x.Ticker){var a=l.minStep.tryGetConcreteTree(this.policy,r).asValue(),u=typeof a==\"number\"&&a>=0&&isFinite(a);if(u){let c=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!o.isFirstTick&&c!==void 0){r.dt=new x.Constant(this.lastClockTickTime-c);let p=l.handler.tryGetConcreteTree(this.policy,r);GT(p,n,r)}}}}return{objectClicked:i,userAction:s,updates:n}}};var KO=class{constructor(t){this.context=new Mm,this.sendMessage=t}processChangeSet(t){var r=this.context.processChangeSet(t);this.sendMessage(\"processChangeSet\",r)}};Object.defineProperty(__dcg_chunk_exports__, 'a', { get: () => $ });\nObject.defineProperty(__dcg_chunk_exports__, 'b', { get: () => se });\nObject.defineProperty(__dcg_chunk_exports__, 'c', { get: () => dV });\nObject.defineProperty(__dcg_chunk_exports__, 'd', { get: () => HT });\nObject.defineProperty(__dcg_chunk_exports__, 'e', { get: () => mV });\nObject.defineProperty(__dcg_chunk_exports__, 'f', { get: () => yV });\nObject.defineProperty(__dcg_chunk_exports__, 'g', { get: () => Yi });\nObject.defineProperty(__dcg_chunk_exports__, 'h', { get: () => gV });\nObject.defineProperty(__dcg_chunk_exports__, 'i', { get: () => hV });\nObject.defineProperty(__dcg_chunk_exports__, 'j', { get: () => qi });\nObject.defineProperty(__dcg_chunk_exports__, 'k', { get: () => xV });\nObject.defineProperty(__dcg_chunk_exports__, 'l', { get: () => Ka });\nObject.defineProperty(__dcg_chunk_exports__, 'm', { get: () => Hc });\nObject.defineProperty(__dcg_chunk_exports__, 'n', { get: () => TS });\nObject.defineProperty(__dcg_chunk_exports__, 'o', { get: () => JV });\nObject.defineProperty(__dcg_chunk_exports__, 'p', { get: () => QV });\nObject.defineProperty(__dcg_chunk_exports__, 'q', { get: () => Ja });\nObject.defineProperty(__dcg_chunk_exports__, 'r', { get: () => pP });\nObject.defineProperty(__dcg_chunk_exports__, 's', { get: () => PS });\nObject.defineProperty(__dcg_chunk_exports__, 't', { get: () => eB });\nObject.defineProperty(__dcg_chunk_exports__, 'u', { get: () => tB });\nObject.defineProperty(__dcg_chunk_exports__, 'v', { get: () => rB });\nObject.defineProperty(__dcg_chunk_exports__, 'w', { get: () => sB });\nObject.defineProperty(__dcg_chunk_exports__, 'x', { get: () => oB });\nObject.defineProperty(__dcg_chunk_exports__, 'y', { get: () => uB });\nObject.defineProperty(__dcg_chunk_exports__, 'z', { get: () => ES });\nObject.defineProperty(__dcg_chunk_exports__, 'A', { get: () => SS });\nObject.defineProperty(__dcg_chunk_exports__, 'B', { get: () => mB });\nObject.defineProperty(__dcg_chunk_exports__, 'C', { get: () => yB });\nObject.defineProperty(__dcg_chunk_exports__, 'D', { get: () => Mn });\nObject.defineProperty(__dcg_chunk_exports__, 'E', { get: () => il });\nObject.defineProperty(__dcg_chunk_exports__, 'F', { get: () => FS });\nObject.defineProperty(__dcg_chunk_exports__, 'G', { get: () => Po });\nObject.defineProperty(__dcg_chunk_exports__, 'H', { get: () => xB });\nObject.defineProperty(__dcg_chunk_exports__, 'I', { get: () => tu });\nObject.defineProperty(__dcg_chunk_exports__, 'J', { get: () => ru });\nObject.defineProperty(__dcg_chunk_exports__, 'K', { get: () => zS });\nObject.defineProperty(__dcg_chunk_exports__, 'L', { get: () => SB });\nObject.defineProperty(__dcg_chunk_exports__, 'M', { get: () => NB });\nObject.defineProperty(__dcg_chunk_exports__, 'N', { get: () => jw });\nObject.defineProperty(__dcg_chunk_exports__, 'O', { get: () => aT });\nObject.defineProperty(__dcg_chunk_exports__, 'P', { get: () => im });\nObject.defineProperty(__dcg_chunk_exports__, 'Q', { get: () => Kw });\nObject.defineProperty(__dcg_chunk_exports__, 'R', { get: () => e_ });\nObject.defineProperty(__dcg_chunk_exports__, 'S', { get: () => qa });\nObject.defineProperty(__dcg_chunk_exports__, 'T', { get: () => n_ });\nObject.defineProperty(__dcg_chunk_exports__, 'U', { get: () => i_ });\nObject.defineProperty(__dcg_chunk_exports__, 'V', { get: () => XT });\nObject.defineProperty(__dcg_chunk_exports__, 'W', { get: () => Fc });\nObject.defineProperty(__dcg_chunk_exports__, 'X', { get: () => Ni });\nObject.defineProperty(__dcg_chunk_exports__, 'Y', { get: () => js });\nObject.defineProperty(__dcg_chunk_exports__, 'Z', { get: () => Ji });\nObject.defineProperty(__dcg_chunk_exports__, '_', { get: () => pS });\nObject.defineProperty(__dcg_chunk_exports__, '$', { get: () => qV });\nObject.defineProperty(__dcg_chunk_exports__, 'aa', { get: () => UV });\nObject.defineProperty(__dcg_chunk_exports__, 'ba', { get: () => cn });\nObject.defineProperty(__dcg_chunk_exports__, 'ca', { get: () => HV });\nObject.defineProperty(__dcg_chunk_exports__, 'da', { get: () => XP });\nObject.defineProperty(__dcg_chunk_exports__, 'ea', { get: () => Gl });\nObject.defineProperty(__dcg_chunk_exports__, 'fa', { get: () => Cf });\nObject.defineProperty(__dcg_chunk_exports__, 'ga', { get: () => xi });\nObject.defineProperty(__dcg_chunk_exports__, 'ha', { get: () => hI });\nObject.defineProperty(__dcg_chunk_exports__, 'ia', { get: () => Hq });\nObject.defineProperty(__dcg_chunk_exports__, 'ja', { get: () => Wq });\nObject.defineProperty(__dcg_chunk_exports__, 'ka', { get: () => as });\nObject.defineProperty(__dcg_chunk_exports__, 'la', { get: () => fN });\nObject.defineProperty(__dcg_chunk_exports__, 'ma', { get: () => nn });\nObject.defineProperty(__dcg_chunk_exports__, 'na', { get: () => HI });\nObject.defineProperty(__dcg_chunk_exports__, 'oa', { get: () => Mu });\nObject.defineProperty(__dcg_chunk_exports__, 'pa', { get: () => Ou });\nObject.defineProperty(__dcg_chunk_exports__, 'qa', { get: () => Su });\nObject.defineProperty(__dcg_chunk_exports__, 'ra', { get: () => xb });\nObject.defineProperty(__dcg_chunk_exports__, 'sa', { get: () => Tb });\nObject.defineProperty(__dcg_chunk_exports__, 'ta', { get: () => Kh });\nObject.defineProperty(__dcg_chunk_exports__, 'ua', { get: () => ZA });\nObject.defineProperty(__dcg_chunk_exports__, 'va', { get: () => b0 });\nObject.defineProperty(__dcg_chunk_exports__, 'wa', { get: () => jA });\nObject.defineProperty(__dcg_chunk_exports__, 'xa', { get: () => Kf });\nObject.defineProperty(__dcg_chunk_exports__, 'ya', { get: () => jl });\nObject.defineProperty(__dcg_chunk_exports__, 'za', { get: () => Pb });\nObject.defineProperty(__dcg_chunk_exports__, 'Aa', { get: () => Ib });\nObject.defineProperty(__dcg_chunk_exports__, 'Ba', { get: () => T0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ca', { get: () => KA });\nObject.defineProperty(__dcg_chunk_exports__, 'Da', { get: () => P0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ea', { get: () => eR });\nObject.defineProperty(__dcg_chunk_exports__, 'Fa', { get: () => I0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ga', { get: () => tR });\nObject.defineProperty(__dcg_chunk_exports__, 'Ha', { get: () => pR });\nObject.defineProperty(__dcg_chunk_exports__, 'Ia', { get: () => mR });\nObject.defineProperty(__dcg_chunk_exports__, 'Ja', { get: () => yR });\nObject.defineProperty(__dcg_chunk_exports__, 'Ka', { get: () => _s });\nObject.defineProperty(__dcg_chunk_exports__, 'La', { get: () => _1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ma', { get: () => L6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Na', { get: () => Pn });\nObject.defineProperty(__dcg_chunk_exports__, 'Oa', { get: () => M });\nObject.defineProperty(__dcg_chunk_exports__, 'Pa', { get: () => st });\nObject.defineProperty(__dcg_chunk_exports__, 'Qa', { get: () => b });\nObject.defineProperty(__dcg_chunk_exports__, 'Ra', { get: () => N });\nObject.defineProperty(__dcg_chunk_exports__, 'Sa', { get: () => wt });\nObject.defineProperty(__dcg_chunk_exports__, 'Ta', { get: () => j });\nObject.defineProperty(__dcg_chunk_exports__, 'Ua', { get: () => Nr });\nObject.defineProperty(__dcg_chunk_exports__, 'Va', { get: () => Ue });\nObject.defineProperty(__dcg_chunk_exports__, 'Wa', { get: () => Qt });\nObject.defineProperty(__dcg_chunk_exports__, 'Xa', { get: () => Oe });\nObject.defineProperty(__dcg_chunk_exports__, 'Ya', { get: () => Or });\nObject.defineProperty(__dcg_chunk_exports__, 'Za', { get: () => Ee });\nObject.defineProperty(__dcg_chunk_exports__, '_a', { get: () => ur });\nObject.defineProperty(__dcg_chunk_exports__, '$a', { get: () => xe });\nObject.defineProperty(__dcg_chunk_exports__, 'ab', { get: () => Kt });\nObject.defineProperty(__dcg_chunk_exports__, 'bb', { get: () => ue });\nObject.defineProperty(__dcg_chunk_exports__, 'cb', { get: () => gr });\nObject.defineProperty(__dcg_chunk_exports__, 'db', { get: () => ee });\nObject.defineProperty(__dcg_chunk_exports__, 'eb', { get: () => hr });\nObject.defineProperty(__dcg_chunk_exports__, 'fb', { get: () => oe });\nObject.defineProperty(__dcg_chunk_exports__, 'gb', { get: () => br });\nObject.defineProperty(__dcg_chunk_exports__, 'hb', { get: () => ve });\nObject.defineProperty(__dcg_chunk_exports__, 'ib', { get: () => xr });\nObject.defineProperty(__dcg_chunk_exports__, 'jb', { get: () => Ie });\nObject.defineProperty(__dcg_chunk_exports__, 'kb', { get: () => zt });\nObject.defineProperty(__dcg_chunk_exports__, 'lb', { get: () => ye });\nObject.defineProperty(__dcg_chunk_exports__, 'mb', { get: () => qt });\nObject.defineProperty(__dcg_chunk_exports__, 'nb', { get: () => Ce });\nObject.defineProperty(__dcg_chunk_exports__, 'ob', { get: () => Gr });\nObject.defineProperty(__dcg_chunk_exports__, 'pb', { get: () => pe });\nObject.defineProperty(__dcg_chunk_exports__, 'qb', { get: () => Sr });\nObject.defineProperty(__dcg_chunk_exports__, 'rb', { get: () => z });\nObject.defineProperty(__dcg_chunk_exports__, 'sb', { get: () => uS });\nObject.defineProperty(__dcg_chunk_exports__, 'tb', { get: () => In });\nObject.defineProperty(__dcg_chunk_exports__, 'ub', { get: () => ne });\nObject.defineProperty(__dcg_chunk_exports__, 'vb', { get: () => q });\nObject.defineProperty(__dcg_chunk_exports__, 'wb', { get: () => Fe });\nObject.defineProperty(__dcg_chunk_exports__, 'xb', { get: () => Ku });\nObject.defineProperty(__dcg_chunk_exports__, 'yb', { get: () => Is });\nObject.defineProperty(__dcg_chunk_exports__, 'zb', { get: () => re });\nObject.defineProperty(__dcg_chunk_exports__, 'Ab', { get: () => De });\nObject.defineProperty(__dcg_chunk_exports__, 'Bb', { get: () => rr });\nObject.defineProperty(__dcg_chunk_exports__, 'Cb', { get: () => wm });\nObject.defineProperty(__dcg_chunk_exports__, 'Db', { get: () => ZS });\nObject.defineProperty(__dcg_chunk_exports__, 'Eb', { get: () => OP });\nObject.defineProperty(__dcg_chunk_exports__, 'Fb', { get: () => Xc });\nObject.defineProperty(__dcg_chunk_exports__, 'Gb', { get: () => eD });\nObject.defineProperty(__dcg_chunk_exports__, 'Hb', { get: () => Vm });\nObject.defineProperty(__dcg_chunk_exports__, 'Ib', { get: () => wr });\nObject.defineProperty(__dcg_chunk_exports__, 'Jb', { get: () => rD });\nObject.defineProperty(__dcg_chunk_exports__, 'Kb', { get: () => vs });\nObject.defineProperty(__dcg_chunk_exports__, 'Lb', { get: () => Os });\nObject.defineProperty(__dcg_chunk_exports__, 'Mb', { get: () => Qs });\nObject.defineProperty(__dcg_chunk_exports__, 'Nb', { get: () => we });\nObject.defineProperty(__dcg_chunk_exports__, 'Ob', { get: () => hd });\nObject.defineProperty(__dcg_chunk_exports__, 'Pb', { get: () => pn });\nObject.defineProperty(__dcg_chunk_exports__, 'Qb', { get: () => x });\nObject.defineProperty(__dcg_chunk_exports__, 'Rb', { get: () => Iq });\nObject.defineProperty(__dcg_chunk_exports__, 'Sb', { get: () => Sf });\nObject.defineProperty(__dcg_chunk_exports__, 'Tb', { get: () => HP });\nObject.defineProperty(__dcg_chunk_exports__, 'Ub', { get: () => ls });\nObject.defineProperty(__dcg_chunk_exports__, 'Vb', { get: () => iU });\nObject.defineProperty(__dcg_chunk_exports__, 'Wb', { get: () => DR });\nObject.defineProperty(__dcg_chunk_exports__, 'Xb', { get: () => od });\nObject.defineProperty(__dcg_chunk_exports__, 'Yb', { get: () => bM });\nObject.defineProperty(__dcg_chunk_exports__, 'Zb', { get: () => fs });\nObject.defineProperty(__dcg_chunk_exports__, '_b', { get: () => Td });\nObject.defineProperty(__dcg_chunk_exports__, '$b', { get: () => NM });\nObject.defineProperty(__dcg_chunk_exports__, 'ac', { get: () => Yr });\nObject.defineProperty(__dcg_chunk_exports__, 'bc', { get: () => fe });\nObject.defineProperty(__dcg_chunk_exports__, 'cc', { get: () => ix });\nObject.defineProperty(__dcg_chunk_exports__, 'dc', { get: () => qo });\nObject.defineProperty(__dcg_chunk_exports__, 'ec', { get: () => iv });\nObject.defineProperty(__dcg_chunk_exports__, 'fc', { get: () => gv });\nObject.defineProperty(__dcg_chunk_exports__, 'gc', { get: () => zi });\nObject.defineProperty(__dcg_chunk_exports__, 'hc', { get: () => Yv });\nObject.defineProperty(__dcg_chunk_exports__, 'ic', { get: () => Gs });\nObject.defineProperty(__dcg_chunk_exports__, 'jc', { get: () => s1 });\nObject.defineProperty(__dcg_chunk_exports__, 'kc', { get: () => zs });\nObject.defineProperty(__dcg_chunk_exports__, 'lc', { get: () => QL });\nObject.defineProperty(__dcg_chunk_exports__, 'mc', { get: () => d$ });\nObject.defineProperty(__dcg_chunk_exports__, 'nc', { get: () => zu });\nObject.defineProperty(__dcg_chunk_exports__, 'oc', { get: () => m1 });\nObject.defineProperty(__dcg_chunk_exports__, 'pc', { get: () => jd });\nObject.defineProperty(__dcg_chunk_exports__, 'qc', { get: () => y1 });\nObject.defineProperty(__dcg_chunk_exports__, 'rc', { get: () => h1 });\nObject.defineProperty(__dcg_chunk_exports__, 'sc', { get: () => Xx });\nObject.defineProperty(__dcg_chunk_exports__, 'tc', { get: () => Wx });\nObject.defineProperty(__dcg_chunk_exports__, 'uc', { get: () => Zx });\nObject.defineProperty(__dcg_chunk_exports__, 'vc', { get: () => M1 });\nObject.defineProperty(__dcg_chunk_exports__, 'wc', { get: () => E1 });\nObject.defineProperty(__dcg_chunk_exports__, 'xc', { get: () => jo });\nObject.defineProperty(__dcg_chunk_exports__, 'yc', { get: () => F1 });\nObject.defineProperty(__dcg_chunk_exports__, 'zc', { get: () => V1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ac', { get: () => vc });\nObject.defineProperty(__dcg_chunk_exports__, 'Bc', { get: () => rm });\nObject.defineProperty(__dcg_chunk_exports__, 'Cc', { get: () => V6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Dc', { get: () => G6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ec', { get: () => z6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Fc', { get: () => H1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Gc', { get: () => q6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Hc', { get: () => k6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ic', { get: () => $6 });\nObject.defineProperty(__dcg_chunk_exports__, 'Jc', { get: () => $1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Kc', { get: () => Jw });\nObject.defineProperty(__dcg_chunk_exports__, 'Lc', { get: () => nm });\nObject.defineProperty(__dcg_chunk_exports__, 'Mc', { get: () => Y1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Nc', { get: () => X1 });\nObject.defineProperty(__dcg_chunk_exports__, 'Oc', { get: () => i7 });\nObject.defineProperty(__dcg_chunk_exports__, 'Pc', { get: () => s7 });\nObject.defineProperty(__dcg_chunk_exports__, 'Qc', { get: () => Qw });\nObject.defineProperty(__dcg_chunk_exports__, 'Rc', { get: () => o7 });\nObject.defineProperty(__dcg_chunk_exports__, 'Sc', { get: () => a7 });\nObject.defineProperty(__dcg_chunk_exports__, 'Tc', { get: () => O_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Uc', { get: () => ar });\nObject.defineProperty(__dcg_chunk_exports__, 'Vc', { get: () => mm });\nObject.defineProperty(__dcg_chunk_exports__, 'Wc', { get: () => q_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Xc', { get: () => qO });\nObject.defineProperty(__dcg_chunk_exports__, 'Yc', { get: () => LP });\nObject.defineProperty(__dcg_chunk_exports__, 'Zc', { get: () => wP });\nObject.defineProperty(__dcg_chunk_exports__, '_c', { get: () => DF });\nObject.defineProperty(__dcg_chunk_exports__, '$c', { get: () => NF });\nObject.defineProperty(__dcg_chunk_exports__, 'ad', { get: () => Nc });\nObject.defineProperty(__dcg_chunk_exports__, 'bd', { get: () => Ac });\nObject.defineProperty(__dcg_chunk_exports__, 'cd', { get: () => Mm });\nObject.defineProperty(__dcg_chunk_exports__, 'dd', { get: () => KO });\n\n    return __dcg_chunk_exports__;\n  })();"
  const __dcg_shared_module_exports__ = eval(__dcg_shared_module_source__);
  const __dcg_worker_source_exports__ = (function () {
    // worker.js
    const __dcg_worker_source__ = `
      // store the code for the worker module as a function that takes the shared module exports as an argument
      const __dcg_worker_module__ = (__dcg_shared_module_exports__) => {
` + "var o={};__dcg_shared_module_exports__['k'].log=function(e){self.postMessage({log:JSON.stringify(e)})};var a=self;a.window=a;a.onmessage=function(e){var n=e.data&&e.data.connectionId;if(n)if(e.data.originalMessage.type===\"destroy\")delete o[n];else{var s=o[n];s||(s=new __dcg_shared_module_exports__['dd'](function(g,c){a.postMessage({connectionId:n,originalMessage:{type:g,payload:c}})}),o[n]=s),s.processChangeSet(e.data.originalMessage)}};a.loadMessageQueue&&(a.loadMessageQueue.forEach(function(e){a.onmessage(e)}),delete a.loadMessageQueue);\n" + `
      };
      // execute the shared module store its exports
      const __dcg_worker_shared_module_exports__ = ${__dcg_shared_module_source__};
      // call the worker module, passing in the shared module exports
      __dcg_worker_module__(__dcg_worker_shared_module_exports__);`

    let createWorker;
    if (typeof Blob !== 'undefined' && URL && typeof URL.createObjectURL === 'function') {
      createWorker = () => {
        const workerURL = URL.createObjectURL(new Blob([__dcg_worker_source__], { type: 'application/javascript' }))
        const worker = new Worker(workerURL);
        worker.revokeObjectURL = () => {
          URL.revokeObjectURL(workerURL);
        }
        return worker;
      }
    } else {
      // Just for testing in Node
      createWorker = () => {
        (new Function(__dcg_worker_source__))();
      }
    }

    return {createWorker, default: {createWorker}};
  })();
  // BEGIN SNATCH
  dcgSharedModule = __dcg_shared_module_exports__;
  // END SNATCH
  function aP(r,e,t){t=t||mi;var i,n,o=t.createElement("script");if(o.text=r,e)for(i in Pq)n=e[i]||e.getAttribute&&e.getAttribute(i),n&&o.setAttribute(i,n);t.head.appendChild(o).parentNode.removeChild(o)}function cm(r){return r==null?r+"":typeof r=="object"||typeof r=="function"?BC[oP.call(r)]||"object":typeof r}function jV(r){var e=!!r&&"length"in r&&r.length,t=cm(r);return ri(r)||am(r)?!1:t==="array"||e===0||typeof e=="number"&&e>0&&e-1 in r}function Pl(r,e){return r.nodeName&&r.nodeName.toLowerCase()===e.toLowerCase()}function JV(r,e,t){return ri(e)?I.grep(r,function(i,n){return!!e.call(i,n,i)!==t}):e.nodeType?I.grep(r,function(i){return i===e!==t}):typeof e!="string"?I.grep(r,function(i){return PC.call(e,i)>-1!==t}):I.filter(e,r,t)}function BO(r,e){for(;(r=r[e])&&r.nodeType!==1;);return r}function Bq(r){var e={};return I.each(r.match(cp)||[],function(t,i){e[i]=!0}),e}function tm(r){return r}function LC(r){throw r}function KO(r,e,t,i){var n;try{r&&ri(n=r.promise)?n.call(r).done(e).fail(t):r&&ri(n=r.then)?n.call(r,e,t):e.apply(void 0,[r].slice(i))}catch(o){t.apply(void 0,[o])}}function FC(){mi.removeEventListener("DOMContentLoaded",FC),window.removeEventListener("load",FC),I.ready()}function qq(r,e){return e.toUpperCase()}function ud(r){return r.replace(Uq,"ms-").replace(Hq,qq)}function cb(){this.expando=I.expando+cb.uid++}function Wq(r){return r==="true"?!0:r==="false"?!1:r==="null"?null:r===+r+""?+r:zq.test(r)?JSON.parse(r):r}function UO(r,e,t){var i;if(t===void 0&&r.nodeType===1)if(i="data-"+e.replace($q,"-$&").toLowerCase(),t=r.getAttribute(i),typeof t=="string"){try{t=Wq(t)}catch(n){}_a.set(r,e,t)}else t=void 0;return t}function hP(r,e,t,i){var n,o,s=20,a=i?function(){return i.cur()}:function(){return I.css(r,e,"")},l=a(),c=t&&t[3]||(I.cssNumber[e]?"":"px"),u=r.nodeType&&(I.cssNumber[e]||c!=="px"&&+l)&&db.exec(I.css(r,e));if(u&&u[3]!==c){for(l=l/2,c=c||u[3],u=+l||1;s--;)I.style(r,e,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u=u/o;u=u*2,I.style(r,e,u+c),t=t||[]}return t&&(u=+u||+l||0,n=t[1]?u+(t[1]+1)*t[2]:+t[2],i&&(i.unit=c,i.start=u,i.end=n)),n}function Jq(r){var e,t=r.ownerDocument,i=r.nodeName,n=HO[i];return n||(e=t.body.appendChild(t.createElement(i)),n=I.css(e,"display"),e.parentNode.removeChild(e),n==="none"&&(n="block"),HO[i]=n,n)}function nm(r,e){for(var t,i,n=[],o=0,s=r.length;o<s;o++)i=r[o],i.style&&(t=i.style.display,e?(t==="none"&&(n[o]=Jt.get(i,"display")||null,n[o]||(i.style.display="")),i.style.display===""&&KC(i)&&(n[o]=Jq(i))):t!=="none"&&(n[o]="none",Jt.set(i,"display",t)));for(o=0;o<s;o++)n[o]!=null&&(r[o].style.display=n[o]);return r}function Oa(r,e){var t;return typeof r.getElementsByTagName!="undefined"?t=r.getElementsByTagName(e||"*"):typeof r.querySelectorAll!="undefined"?t=r.querySelectorAll(e||"*"):t=[],e===void 0||e&&Pl(r,e)?I.merge([r],t):t}function nT(r,e){for(var t=0,i=r.length;t<i;t++)Jt.set(r[t],"globalEval",!e||Jt.get(e[t],"globalEval"))}function fP(r,e,t,i,n){for(var o,s,a,l,c,u,p=e.createDocumentFragment(),g=[],h=0,b=r.length;h<b;h++)if(o=r[h],o||o===0)if(cm(o)==="object")I.merge(g,o.nodeType?[o]:o);else if(!Yq.test(o))g.push(e.createTextNode(o));else{for(s=s||p.appendChild(e.createElement("div")),a=(gP.exec(o)||["",""])[1].toLowerCase(),l=Ol[a]||Ol._default,s.innerHTML=l[1]+I.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;I.merge(g,s.childNodes),s=p.firstChild,s.textContent=""}for(p.textContent="",h=0;o=g[h++];){if(i&&I.inArray(o,i)>-1){n&&n.push(o);continue}if(c=dm(o),s=Oa(p.appendChild(o),"script"),c&&nT(s),t)for(u=0;o=s[u++];)mP.test(o.type||"")&&t.push(o)}return p}function om(){return!0}function sm(){return!1}function Xq(r,e){return r===Qq()==(e==="focus")}function Qq(){try{return mi.activeElement}catch(r){}}function XV(r,e,t,i,n,o){var s,a;if(typeof e=="object"){typeof t!="string"&&(i=i||t,t=void 0);for(a in e)XV(r,a,t,i,e[a],o);return r}if(i==null&&n==null?(n=t,i=t=void 0):n==null&&(typeof t=="string"?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=sm;else if(!n)return r;return o===1&&(s=n,n=function(l){return I().off(l),s.apply(this,arguments)},n.guid=s.guid||(s.guid=I.guid++)),r.each(function(){I.event.add(this,e,n,i,t)})}function RC(r,e,t){if(!t){Jt.get(r,e)===void 0&&I.event.add(r,e,om);return}Jt.set(r,e,!1),I.event.add(r,e,{namespace:!1,handler:function(i){var n,o,s=Jt.get(this,e);if(i.isTrigger&1&&this[e]){if(s.length)(I.event.special[e]||{}).delegateType&&i.stopPropagation();else if(s=lp.call(arguments),Jt.set(this,e,s),n=t(this,e),this[e](),o=Jt.get(this,e),s!==o||n?Jt.set(this,e,!1):o={},s!==o)return i.stopImmediatePropagation(),i.preventDefault(),o&&o.value}else s.length&&(Jt.set(this,e,{value:I.event.trigger(I.extend(s[0],I.Event.prototype),s.slice(1),this)}),i.stopImmediatePropagation())}})}function zO(r,e){return Pl(r,"table")&&Pl(e.nodeType!==11?e:e.firstChild,"tr")&&I(r).children("tbody")[0]||r}function r4(r){return r.type=(r.getAttribute("type")!==null)+"/"+r.type,r}function i4(r){return(r.type||"").slice(0,5)==="true/"?r.type=r.type.slice(5):r.removeAttribute("type"),r}function $O(r,e){var t,i,n,o,s,a,l;if(e.nodeType===1){if(Jt.hasData(r)&&(o=Jt.get(r),l=o.events,l)){Jt.remove(e,"handle events");for(n in l)for(t=0,i=l[n].length;t<i;t++)I.event.add(e,n,l[n][t])}_a.hasData(r)&&(s=_a.access(r),a=I.extend({},s),_a.set(e,a))}}function n4(r,e){var t=e.nodeName.toLowerCase();t==="input"&&sb.test(r.type)?e.checked=r.checked:(t==="input"||t==="textarea")&&(e.defaultValue=r.defaultValue)}function rm(r,e,t,i){e=nP(e);var n,o,s,a,l,c,u=0,p=r.length,g=p-1,h=e[0],b=ri(h);if(b||p>1&&typeof h=="string"&&!wn.checkClone&&e4.test(h))return r.each(function(C){var D=r.eq(C);b&&(e[0]=h.call(this,C,D.html())),rm(D,e,t,i)});if(p&&(n=fP(e,r[0].ownerDocument,!1,r,i),o=n.firstChild,n.childNodes.length===1&&(n=o),o||i)){for(s=I.map(Oa(n,"script"),r4),a=s.length;u<p;u++)l=n,u!==g&&(l=I.clone(l,!0,!0),a&&I.merge(s,Oa(l,"script"))),t.call(r[u],l,u);if(a)for(c=s[s.length-1].ownerDocument,I.map(s,i4),u=0;u<a;u++)l=s[u],mP.test(l.type||"")&&!Jt.access(l,"globalEval")&&I.contains(c,l)&&(l.src&&(l.type||"").toLowerCase()!=="module"?I._evalUrl&&!l.noModule&&I._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):aP(l.textContent.replace(t4,""),l,c))}return r}function WO(r,e,t){for(var i,n=e?I.filter(e,r):r,o=0;(i=n[o])!=null;o++)!t&&i.nodeType===1&&I.cleanData(Oa(i)),i.parentNode&&(t&&dm(i)&&nT(Oa(i,"script")),i.parentNode.removeChild(i));return r}function lb(r,e,t){var i,n,o,s,a=r.style;return t=t||UC(r),t&&(s=t.getPropertyValue(e)||t[e],s===""&&!dm(r)&&(s=I.style(r,e)),!wn.pixelBoxStyles()&&oT.test(s)&&o4.test(e)&&(i=a.width,n=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=t.width,a.width=i,a.minWidth=n,a.maxWidth=o)),s!==void 0?s+"":s}function bP(r,e){return{get:function(){if(r()){delete this.get;return}return(this.get=e).apply(this,arguments)}}}function s4(r){for(var e=r[0].toUpperCase()+r.slice(1),t=jO.length;t--;)if(r=jO[t]+e,r in wP)return r}function QV(r){var e=I.cssProps[r]||JO[r];return e||(r in wP?r:JO[r]=s4(r)||r)}function xP(r,e,t){var i=db.exec(e);return i?Math.max(0,i[2]-(t||0))+(i[3]||"px"):e}function ZV(r,e,t,i,n,o){var s=e==="width"?1:0,a=0,l=0;if(t===(i?"border":"content"))return 0;for(;s<4;s+=2)t==="margin"&&(l+=I.css(r,t+au[s],!0,n)),i?(t==="content"&&(l-=I.css(r,"padding"+au[s],!0,n)),t!=="margin"&&(l-=I.css(r,"border"+au[s]+"Width",!0,n))):(l+=I.css(r,"padding"+au[s],!0,n),t!=="padding"?l+=I.css(r,"border"+au[s]+"Width",!0,n):a+=I.css(r,"border"+au[s]+"Width",!0,n));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(r["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l}function QO(r,e,t){var i=UC(r),n=!wn.boxSizingReliable()||t,o=n&&I.css(r,"boxSizing",!1,i)==="border-box",s=o,a=lb(r,e,i),l="offset"+e[0].toUpperCase()+e.slice(1);if(oT.test(a)){if(!t)return a;a="auto"}return(!wn.boxSizingReliable()&&o||!wn.reliableTrDimensions()&&Pl(r,"tr")||a==="auto"||!parseFloat(a)&&I.css(r,"display",!1,i)==="inline")&&r.getClientRects().length&&(o=I.css(r,"boxSizing",!1,i)==="border-box",s=l in r,s&&(a=r[l])),a=parseFloat(a)||0,a+ZV(r,e,t||(o?"border":"content"),s,i,a)+"px"}function Pa(r,e,t,i,n){return new Pa.prototype.init(r,e,t,i,n)}function eT(){NC&&(mi.hidden===!1&&window.requestAnimationFrame?window.requestAnimationFrame(eT):window.setTimeout(eT,I.fx.interval),I.fx.tick())}function ZO(){return window.setTimeout(function(){lm=void 0}),lm=Date.now()}function OC(r,e){var t,i=0,n={height:r};for(e=e?1:0;i<4;i+=2-e)t=au[i],n["margin"+t]=n["padding"+t]=r;return e&&(n.opacity=n.width=r),n}function vP(r,e,t){for(var i,n=(mc.tweeners[e]||[]).concat(mc.tweeners["*"]),o=0,s=n.length;o<s;o++)if(i=n[o].call(t,e,r))return i}function u4(r,e,t){var i,n,o,s,a,l,c,u,p="width"in e||"height"in e,g=this,h={},b=r.style,C=r.nodeType&&KC(r),D=Jt.get(r,"fxshow");t.queue||(s=I._queueHooks(r,"fx"),s.unqueued==null&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,g.always(function(){g.always(function(){s.unqueued--,I.queue(r,"fx").length||s.empty.fire()})}));for(i in e)if(n=e[i],c4.test(n)){if(delete e[i],o=o||n==="toggle",n===(C?"hide":"show"))if(n==="show"&&D&&D[i]!==void 0)C=!0;else continue;h[i]=D&&D[i]||I.style(r,i)}if(l=!I.isEmptyObject(e),!(!l&&I.isEmptyObject(h))){p&&r.nodeType===1&&(t.overflow=[b.overflow,b.overflowX,b.overflowY],c=D&&D.display,c==null&&(c=Jt.get(r,"display")),u=I.css(r,"display"),u==="none"&&(c?u=c:(nm([r],!0),c=r.style.display||c,u=I.css(r,"display"),nm([r]))),(u==="inline"||u==="inline-block"&&c!=null)&&I.css(r,"float")==="none"&&(l||(g.done(function(){b.display=c}),c==null&&(u=b.display,c=u==="none"?"":u)),b.display="inline-block")),t.overflow&&(b.overflow="hidden",g.always(function(){b.overflow=t.overflow[0],b.overflowX=t.overflow[1],b.overflowY=t.overflow[2]})),l=!1;for(i in h)l||(D?"hidden"in D&&(C=D.hidden):D=Jt.access(r,"fxshow",{display:c}),o&&(D.hidden=!C),C&&nm([r],!0),g.done(function(){C||nm([r]),Jt.remove(r,"fxshow");for(i in h)I.style(r,i,h[i])})),l=vP(C?D[i]:0,i,g),i in D||(D[i]=l.start,C&&(l.end=l.start,l.start=0))}}function p4(r,e){var t,i,n,o,s;for(t in r)if(i=ud(t),n=e[i],o=r[t],Array.isArray(o)&&(n=o[1],o=r[t]=o[0]),t!==i&&(r[i]=o,delete r[t]),s=I.cssHooks[i],s&&"expand"in s){o=s.expand(o),delete r[i];for(t in o)t in r||(r[t]=o[t],e[t]=n)}else e[i]=n}function mc(r,e,t){var i,n,o=0,s=mc.prefilters.length,a=I.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var p=lm||ZO(),g=Math.max(0,c.startTime+c.duration-p),h=g/c.duration||0,b=1-h,C=0,D=c.tweens.length;C<D;C++)c.tweens[C].run(b);return a.notifyWith(r,[c,b,g]),b<1&&D?g:(D||a.notifyWith(r,[c,1,0]),a.resolveWith(r,[c]),!1)},c=a.promise({elem:r,props:I.extend({},e),opts:I.extend(!0,{specialEasing:{},easing:I.easing._default},t),originalProperties:e,originalOptions:t,startTime:lm||ZO(),duration:t.duration,tweens:[],createTween:function(p,g){var h=I.Tween(r,c.opts,p,g,c.opts.specialEasing[p]||c.opts.easing);return c.tweens.push(h),h},stop:function(p){var g=0,h=p?c.tweens.length:0;if(n)return this;for(n=!0;g<h;g++)c.tweens[g].run(1);return p?(a.notifyWith(r,[c,1,0]),a.resolveWith(r,[c,p])):a.rejectWith(r,[c,p]),this}}),u=c.props;for(p4(u,c.opts.specialEasing);o<s;o++)if(i=mc.prefilters[o].call(c,r,u,c.opts),i)return ri(i.stop)&&(I._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return I.map(u,vP,c),ri(c.opts.start)&&c.opts.start.call(r,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),I.fx.timer(I.extend(l,{elem:r,anim:c,queue:c.opts.queue})),c}function im(r){var e=r.match(cp)||[];return e.join(" ")}function Gh(r){return r.getAttribute&&r.getAttribute("class")||""}function YV(r){return Array.isArray(r)?r:typeof r=="string"?r.match(cp)||[]:[]}function tT(r,e,t,i){var n;if(Array.isArray(e))I.each(e,function(o,s){t||f4.test(r)?i(r,s):tT(r+"["+(typeof s=="object"&&s!=null?o:"")+"]",s,t,i)});else if(!t&&cm(e)==="object")for(n in e)tT(r+"["+n+"]",e[n],t,i);else i(r,e)}var lu,iP,lp,nP,rT,PC,BC,oP,_C,sP,Oq,wn,ri,am,mi,Pq,lP,I,Vh,em,NO,cP,dP,uP,_q,Fq,Rq,Nq,cp,Kq,iT,cu,Uq,Hq,ab,Jt,_a,zq,$q,pP,db,au,Ih,dm,jq,KC,HO,sb,gP,mP,Ol,Yq,qO,Zq,e4,t4,oT,UC,yP,o4,jO,wP,JO,a4,YO,l4,XO,lm,NC,c4,d4,CP,ob,h4,g4,m4,eP,tP,Zte,ere,f4,rP,y4,b4,w4,x4,v4,O,ct=__dcg_shared_module_exports__['e'](()=>{"use strict";lu=[],iP=Object.getPrototypeOf,lp=lu.slice,nP=lu.flat?function(r){return lu.flat.call(r)}:function(r){return lu.concat.apply([],r)},rT=lu.push,PC=lu.indexOf,BC={},oP=BC.toString,_C=BC.hasOwnProperty,sP=_C.toString,Oq=sP.call(Object),wn={},ri=function(e){return typeof e=="function"&&typeof e.nodeType!="number"&&typeof e.item!="function"},am=function(e){return e!=null&&e===e.window},mi=window.document,Pq={type:!0,src:!0,nonce:!0,noModule:!0};lP="3.6.0",I=function(r,e){return new I.fn.init(r,e)};I.fn=I.prototype={jquery:lP,constructor:I,length:0,toArray:function(){return lp.call(this)},get:function(r){return r==null?lp.call(this):r<0?this[r+this.length]:this[r]},pushStack:function(r){var e=I.merge(this.constructor(),r);return e.prevObject=this,e},each:function(r){return I.each(this,r)},map:function(r){return this.pushStack(I.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(lp.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(I.grep(this,function(r,e){return(e+1)%2}))},odd:function(){return this.pushStack(I.grep(this,function(r,e){return e%2}))},eq:function(r){var e=this.length,t=+r+(r<0?e:0);return this.pushStack(t>=0&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:rT,sort:lu.sort,splice:lu.splice};I.extend=I.fn.extend=function(){var r,e,t,i,n,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for(typeof s=="boolean"&&(c=s,s=arguments[a]||{},a++),typeof s!="object"&&!ri(s)&&(s={}),a===l&&(s=this,a--);a<l;a++)if((r=arguments[a])!=null)for(e in r)i=r[e],!(e==="__proto__"||s===i)&&(c&&i&&(I.isPlainObject(i)||(n=Array.isArray(i)))?(t=s[e],n&&!Array.isArray(t)?o=[]:!n&&!I.isPlainObject(t)?o={}:o=t,n=!1,s[e]=I.extend(c,o,i)):i!==void 0&&(s[e]=i));return s};I.extend({expando:"jQuery"+(lP+Math.random()).replace(/\D/g,""),isReady:!0,error:function(r){throw new Error(r)},noop:function(){},isPlainObject:function(r){var e,t;return!r||oP.call(r)!=="[object Object]"?!1:(e=iP(r),e?(t=_C.call(e,"constructor")&&e.constructor,typeof t=="function"&&sP.call(t)===Oq):!0)},isEmptyObject:function(r){var e;for(e in r)return!1;return!0},globalEval:function(r,e,t){aP(r,{nonce:e&&e.nonce},t)},each:function(r,e){var t,i=0;if(jV(r))for(t=r.length;i<t&&e.call(r[i],i,r[i])!==!1;i++);else for(i in r)if(e.call(r[i],i,r[i])===!1)break;return r},makeArray:function(r,e){var t=e||[];return r!=null&&(jV(Object(r))?I.merge(t,typeof r=="string"?[r]:r):rT.call(t,r)),t},inArray:function(r,e,t){return e==null?-1:PC.call(e,r,t)},merge:function(r,e){for(var t=+e.length,i=0,n=r.length;i<t;i++)r[n++]=e[i];return r.length=n,r},grep:function(r,e,t){for(var i,n=[],o=0,s=r.length,a=!t;o<s;o++)i=!e(r[o],o),i!==a&&n.push(r[o]);return n},map:function(r,e,t){var i,n,o=0,s=[];if(jV(r))for(i=r.length;o<i;o++)n=e(r[o],o,t),n!=null&&s.push(n);else for(o in r)n=e(r[o],o,t),n!=null&&s.push(n);return nP(s)},guid:1,support:wn});typeof Symbol=="function"&&(I.fn[Symbol.iterator]=lu[Symbol.iterator]);I.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(r,e){BC["[object "+e+"]"]=e.toLowerCase()});Vh=function(r){var e,t,i,n,o,s,a,l,c,u,p,g,h,b,C,D,S,V,k,T="sizzle"+1*new Date,A=r.document,R=0,P=0,W=Ge(),H=Ge(),j=Ge(),ne=Ge(),le=function(N,$){return N===$&&(p=!0),0},w={}.hasOwnProperty,B=[],q=B.pop,M=B.push,ae=B.push,se=B.slice,ge=function(N,$){for(var Z=0,be=N.length;Z<be;Z++)if(N[Z]===$)return Z;return-1},he="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ye="[\\x20\\t\\r\\n\\f]",fe="(?:\\\\[\\da-fA-F]{1,6}"+ye+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Se="\\["+ye+"*("+fe+")(?:"+ye+"*([*^$|!~]?=)"+ye+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+fe+"))|)"+ye+"*\\]",de=":("+fe+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Se+")*)|.*)\\)|)",Ee=new RegExp(ye+"+","g"),U=new RegExp("^"+ye+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ye+"+$","g"),ce=new RegExp("^"+ye+"*,"+ye+"*"),Oe=new RegExp("^"+ye+"*([>+~]|"+ye+")"+ye+"*"),Qe=new RegExp(ye+"|>"),Ct=new RegExp(de),Je=new RegExp("^"+fe+"$"),tr={ID:new RegExp("^#("+fe+")"),CLASS:new RegExp("^\\.("+fe+")"),TAG:new RegExp("^("+fe+"|[*])"),ATTR:new RegExp("^"+Se),PSEUDO:new RegExp("^"+de),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ye+"*(even|odd|(([+-]|)(\\d*)n|)"+ye+"*(?:([+-]|)"+ye+"*(\\d+)|))"+ye+"*\\)|)","i"),bool:new RegExp("^(?:"+he+")$","i"),needsContext:new RegExp("^"+ye+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ye+"*((?:-\\d)?\\d*)"+ye+"*\\)|)(?=[^-]|$)","i")},mr=/HTML$/i,we=/^(?:input|select|textarea|button)$/i,Xr=/^h\d$/i,xi=/^[^{]+\{\s*\[native \w/,Le=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Et=/[+~]/,lt=new RegExp("\\\\[\\da-fA-F]{1,6}"+ye+"?|\\\\([^\\r\\n\\f])","g"),dt=function(N,$){var Z="0x"+N.slice(1)-65536;return $||(Z<0?String.fromCharCode(Z+65536):String.fromCharCode(Z>>10|55296,Z&1023|56320))},Pt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Ve=function(N,$){return $?N==="\0"?"\uFFFD":N.slice(0,-1)+"\\"+N.charCodeAt(N.length-1).toString(16)+" ":"\\"+N},ur=function(){g()},Ne=On(function(N){return N.disabled===!0&&N.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{ae.apply(B=se.call(A.childNodes),A.childNodes),B[A.childNodes.length].nodeType}catch(N){ae={apply:B.length?function($,Z){M.apply($,se.call(Z))}:function($,Z){for(var be=$.length,oe=0;$[be++]=Z[oe++];);$.length=be-1}}}function $t(N,$,Z,be){var oe,Ce,Pe,Be,rt,At,yt,vt=$&&$.ownerDocument,jt=$?$.nodeType:9;if(Z=Z||[],typeof N!="string"||!N||jt!==1&&jt!==9&&jt!==11)return Z;if(!be&&(g($),$=$||h,C)){if(jt!==11&&(rt=Le.exec(N)))if(oe=rt[1]){if(jt===9)if(Pe=$.getElementById(oe)){if(Pe.id===oe)return Z.push(Pe),Z}else return Z;else if(vt&&(Pe=vt.getElementById(oe))&&k($,Pe)&&Pe.id===oe)return Z.push(Pe),Z}else{if(rt[2])return ae.apply(Z,$.getElementsByTagName(N)),Z;if((oe=rt[3])&&t.getElementsByClassName&&$.getElementsByClassName)return ae.apply(Z,$.getElementsByClassName(oe)),Z}if(t.qsa&&!ne[N+" "]&&(!D||!D.test(N))&&(jt!==1||$.nodeName.toLowerCase()!=="object")){if(yt=N,vt=$,jt===1&&(Qe.test(N)||Oe.test(N))){for(vt=Et.test(N)&&no($.parentNode)||$,(vt!==$||!t.scope)&&((Be=$.getAttribute("id"))?Be=Be.replace(Pt,Ve):$.setAttribute("id",Be=T)),At=s(N),Ce=At.length;Ce--;)At[Ce]=(Be?"#"+Be:":scope")+" "+Qi(At[Ce]);yt=At.join(",")}try{return ae.apply(Z,vt.querySelectorAll(yt)),Z}catch(_r){ne(N,!0)}finally{Be===T&&$.removeAttribute("id")}}}return l(N.replace(U,"$1"),$,Z,be)}function Ge(){var N=[];function $(Z,be){return N.push(Z+" ")>i.cacheLength&&delete $[N.shift()],$[Z+" "]=be}return $}function st(N){return N[T]=!0,N}function kt(N){var $=h.createElement("fieldset");try{return!!N($)}catch(Z){return!1}finally{$.parentNode&&$.parentNode.removeChild($),$=null}}function Ae(N,$){for(var Z=N.split("|"),be=Z.length;be--;)i.attrHandle[Z[be]]=$}function Mr(N,$){var Z=$&&N,be=Z&&N.nodeType===1&&$.nodeType===1&&N.sourceIndex-$.sourceIndex;if(be)return be;if(Z){for(;Z=Z.nextSibling;)if(Z===$)return-1}return N?1:-1}function xt(N){return function($){var Z=$.nodeName.toLowerCase();return Z==="input"&&$.type===N}}function il(N){return function($){var Z=$.nodeName.toLowerCase();return(Z==="input"||Z==="button")&&$.type===N}}function Ft(N){return function($){return"form"in $?$.parentNode&&$.disabled===!1?"label"in $?"label"in $.parentNode?$.parentNode.disabled===N:$.disabled===N:$.isDisabled===N||$.isDisabled!==!N&&Ne($)===N:$.disabled===N:"label"in $?$.disabled===N:!1}}function In(N){return st(function($){return $=+$,st(function(Z,be){for(var oe,Ce=N([],Z.length,$),Pe=Ce.length;Pe--;)Z[oe=Ce[Pe]]&&(Z[oe]=!(be[oe]=Z[oe]))})})}function no(N){return N&&typeof N.getElementsByTagName!="undefined"&&N}t=$t.support={},o=$t.isXML=function(N){var $=N&&N.namespaceURI,Z=N&&(N.ownerDocument||N).documentElement;return!mr.test($||Z&&Z.nodeName||"HTML")},g=$t.setDocument=function(N){var $,Z,be=N?N.ownerDocument||N:A;return be==h||be.nodeType!==9||!be.documentElement||(h=be,b=h.documentElement,C=!o(h),A!=h&&(Z=h.defaultView)&&Z.top!==Z&&(Z.addEventListener?Z.addEventListener("unload",ur,!1):Z.attachEvent&&Z.attachEvent("onunload",ur)),t.scope=kt(function(oe){return b.appendChild(oe).appendChild(h.createElement("div")),typeof oe.querySelectorAll!="undefined"&&!oe.querySelectorAll(":scope fieldset div").length}),t.attributes=kt(function(oe){return oe.className="i",!oe.getAttribute("className")}),t.getElementsByTagName=kt(function(oe){return oe.appendChild(h.createComment("")),!oe.getElementsByTagName("*").length}),t.getElementsByClassName=xi.test(h.getElementsByClassName),t.getById=kt(function(oe){return b.appendChild(oe).id=T,!h.getElementsByName||!h.getElementsByName(T).length}),t.getById?(i.filter.ID=function(oe){var Ce=oe.replace(lt,dt);return function(Pe){return Pe.getAttribute("id")===Ce}},i.find.ID=function(oe,Ce){if(typeof Ce.getElementById!="undefined"&&C){var Pe=Ce.getElementById(oe);return Pe?[Pe]:[]}}):(i.filter.ID=function(oe){var Ce=oe.replace(lt,dt);return function(Pe){var Be=typeof Pe.getAttributeNode!="undefined"&&Pe.getAttributeNode("id");return Be&&Be.value===Ce}},i.find.ID=function(oe,Ce){if(typeof Ce.getElementById!="undefined"&&C){var Pe,Be,rt,At=Ce.getElementById(oe);if(At){if(Pe=At.getAttributeNode("id"),Pe&&Pe.value===oe)return[At];for(rt=Ce.getElementsByName(oe),Be=0;At=rt[Be++];)if(Pe=At.getAttributeNode("id"),Pe&&Pe.value===oe)return[At]}return[]}}),i.find.TAG=t.getElementsByTagName?function(oe,Ce){if(typeof Ce.getElementsByTagName!="undefined")return Ce.getElementsByTagName(oe);if(t.qsa)return Ce.querySelectorAll(oe)}:function(oe,Ce){var Pe,Be=[],rt=0,At=Ce.getElementsByTagName(oe);if(oe==="*"){for(;Pe=At[rt++];)Pe.nodeType===1&&Be.push(Pe);return Be}return At},i.find.CLASS=t.getElementsByClassName&&function(oe,Ce){if(typeof Ce.getElementsByClassName!="undefined"&&C)return Ce.getElementsByClassName(oe)},S=[],D=[],(t.qsa=xi.test(h.querySelectorAll))&&(kt(function(oe){var Ce;b.appendChild(oe).innerHTML="<a id='"+T+"'></a><select id='"+T+"-\r\\' msallowcapture=''><option selected=''></option></select>",oe.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+ye+`*(?:''|"")`),oe.querySelectorAll("[selected]").length||D.push("\\["+ye+"*(?:value|"+he+")"),oe.querySelectorAll("[id~="+T+"-]").length||D.push("~="),Ce=h.createElement("input"),Ce.setAttribute("name",""),oe.appendChild(Ce),oe.querySelectorAll("[name='']").length||D.push("\\["+ye+"*name"+ye+"*="+ye+`*(?:''|"")`),oe.querySelectorAll(":checked").length||D.push(":checked"),oe.querySelectorAll("a#"+T+"+*").length||D.push(".#.+[+~]"),oe.querySelectorAll("\\\f"),D.push("[\\r\\n\\f]")}),kt(function(oe){oe.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var Ce=h.createElement("input");Ce.setAttribute("type","hidden"),oe.appendChild(Ce).setAttribute("name","D"),oe.querySelectorAll("[name=d]").length&&D.push("name"+ye+"*[*^$|!~]?="),oe.querySelectorAll(":enabled").length!==2&&D.push(":enabled",":disabled"),b.appendChild(oe).disabled=!0,oe.querySelectorAll(":disabled").length!==2&&D.push(":enabled",":disabled"),oe.querySelectorAll("*,:x"),D.push(",.*:")})),(t.matchesSelector=xi.test(V=b.matches||b.webkitMatchesSelector||b.mozMatchesSelector||b.oMatchesSelector||b.msMatchesSelector))&&kt(function(oe){t.disconnectedMatch=V.call(oe,"*"),V.call(oe,"[s!='']:x"),S.push("!=",de)}),D=D.length&&new RegExp(D.join("|")),S=S.length&&new RegExp(S.join("|")),$=xi.test(b.compareDocumentPosition),k=$||xi.test(b.contains)?function(oe,Ce){var Pe=oe.nodeType===9?oe.documentElement:oe,Be=Ce&&Ce.parentNode;return oe===Be||!!(Be&&Be.nodeType===1&&(Pe.contains?Pe.contains(Be):oe.compareDocumentPosition&&oe.compareDocumentPosition(Be)&16))}:function(oe,Ce){if(Ce){for(;Ce=Ce.parentNode;)if(Ce===oe)return!0}return!1},le=$?function(oe,Ce){if(oe===Ce)return p=!0,0;var Pe=!oe.compareDocumentPosition-!Ce.compareDocumentPosition;return Pe||(Pe=(oe.ownerDocument||oe)==(Ce.ownerDocument||Ce)?oe.compareDocumentPosition(Ce):1,Pe&1||!t.sortDetached&&Ce.compareDocumentPosition(oe)===Pe?oe==h||oe.ownerDocument==A&&k(A,oe)?-1:Ce==h||Ce.ownerDocument==A&&k(A,Ce)?1:u?ge(u,oe)-ge(u,Ce):0:Pe&4?-1:1)}:function(oe,Ce){if(oe===Ce)return p=!0,0;var Pe,Be=0,rt=oe.parentNode,At=Ce.parentNode,yt=[oe],vt=[Ce];if(!rt||!At)return oe==h?-1:Ce==h?1:rt?-1:At?1:u?ge(u,oe)-ge(u,Ce):0;if(rt===At)return Mr(oe,Ce);for(Pe=oe;Pe=Pe.parentNode;)yt.unshift(Pe);for(Pe=Ce;Pe=Pe.parentNode;)vt.unshift(Pe);for(;yt[Be]===vt[Be];)Be++;return Be?Mr(yt[Be],vt[Be]):yt[Be]==A?-1:vt[Be]==A?1:0}),h},$t.matches=function(N,$){return $t(N,null,null,$)},$t.matchesSelector=function(N,$){if(g(N),t.matchesSelector&&C&&!ne[$+" "]&&(!S||!S.test($))&&(!D||!D.test($)))try{var Z=V.call(N,$);if(Z||t.disconnectedMatch||N.document&&N.document.nodeType!==11)return Z}catch(be){ne($,!0)}return $t($,h,null,[N]).length>0},$t.contains=function(N,$){return(N.ownerDocument||N)!=h&&g(N),k(N,$)},$t.attr=function(N,$){(N.ownerDocument||N)!=h&&g(N);var Z=i.attrHandle[$.toLowerCase()],be=Z&&w.call(i.attrHandle,$.toLowerCase())?Z(N,$,!C):void 0;return be!==void 0?be:t.attributes||!C?N.getAttribute($):(be=N.getAttributeNode($))&&be.specified?be.value:null},$t.escape=function(N){return(N+"").replace(Pt,Ve)},$t.error=function(N){throw new Error("Syntax error, unrecognized expression: "+N)},$t.uniqueSort=function(N){var $,Z=[],be=0,oe=0;if(p=!t.detectDuplicates,u=!t.sortStable&&N.slice(0),N.sort(le),p){for(;$=N[oe++];)$===N[oe]&&(be=Z.push(oe));for(;be--;)N.splice(Z[be],1)}return u=null,N},n=$t.getText=function(N){var $,Z="",be=0,oe=N.nodeType;if(oe){if(oe===1||oe===9||oe===11){if(typeof N.textContent=="string")return N.textContent;for(N=N.firstChild;N;N=N.nextSibling)Z+=n(N)}else if(oe===3||oe===4)return N.nodeValue}else for(;$=N[be++];)Z+=n($);return Z},i=$t.selectors={cacheLength:50,createPseudo:st,match:tr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(N){return N[1]=N[1].replace(lt,dt),N[3]=(N[3]||N[4]||N[5]||"").replace(lt,dt),N[2]==="~="&&(N[3]=" "+N[3]+" "),N.slice(0,4)},CHILD:function(N){return N[1]=N[1].toLowerCase(),N[1].slice(0,3)==="nth"?(N[3]||$t.error(N[0]),N[4]=+(N[4]?N[5]+(N[6]||1):2*(N[3]==="even"||N[3]==="odd")),N[5]=+(N[7]+N[8]||N[3]==="odd")):N[3]&&$t.error(N[0]),N},PSEUDO:function(N){var $,Z=!N[6]&&N[2];return tr.CHILD.test(N[0])?null:(N[3]?N[2]=N[4]||N[5]||"":Z&&Ct.test(Z)&&($=s(Z,!0))&&($=Z.indexOf(")",Z.length-$)-Z.length)&&(N[0]=N[0].slice(0,$),N[2]=Z.slice(0,$)),N.slice(0,3))}},filter:{TAG:function(N){var $=N.replace(lt,dt).toLowerCase();return N==="*"?function(){return!0}:function(Z){return Z.nodeName&&Z.nodeName.toLowerCase()===$}},CLASS:function(N){var $=W[N+" "];return $||($=new RegExp("(^|"+ye+")"+N+"("+ye+"|$)"))&&W(N,function(Z){return $.test(typeof Z.className=="string"&&Z.className||typeof Z.getAttribute!="undefined"&&Z.getAttribute("class")||"")})},ATTR:function(N,$,Z){return function(be){var oe=$t.attr(be,N);return oe==null?$==="!=":$?(oe+="",$==="="?oe===Z:$==="!="?oe!==Z:$==="^="?Z&&oe.indexOf(Z)===0:$==="*="?Z&&oe.indexOf(Z)>-1:$==="$="?Z&&oe.slice(-Z.length)===Z:$==="~="?(" "+oe.replace(Ee," ")+" ").indexOf(Z)>-1:$==="|="?oe===Z||oe.slice(0,Z.length+1)===Z+"-":!1):!0}},CHILD:function(N,$,Z,be,oe){var Ce=N.slice(0,3)!=="nth",Pe=N.slice(-4)!=="last",Be=$==="of-type";return be===1&&oe===0?function(rt){return!!rt.parentNode}:function(rt,At,yt){var vt,jt,_r,St,Hn,Zi,ss=Ce!==Pe?"nextSibling":"previousSibling",en=rt.parentNode,dc=Be&&rt.nodeName.toLowerCase(),rd=!yt&&!Be,as=!1;if(en){if(Ce){for(;ss;){for(St=rt;St=St[ss];)if(Be?St.nodeName.toLowerCase()===dc:St.nodeType===1)return!1;Zi=ss=N==="only"&&!Zi&&"nextSibling"}return!0}if(Zi=[Pe?en.firstChild:en.lastChild],Pe&&rd){for(St=en,_r=St[T]||(St[T]={}),jt=_r[St.uniqueID]||(_r[St.uniqueID]={}),vt=jt[N]||[],Hn=vt[0]===R&&vt[1],as=Hn&&vt[2],St=Hn&&en.childNodes[Hn];St=++Hn&&St&&St[ss]||(as=Hn=0)||Zi.pop();)if(St.nodeType===1&&++as&&St===rt){jt[N]=[R,Hn,as];break}}else if(rd&&(St=rt,_r=St[T]||(St[T]={}),jt=_r[St.uniqueID]||(_r[St.uniqueID]={}),vt=jt[N]||[],Hn=vt[0]===R&&vt[1],as=Hn),as===!1)for(;(St=++Hn&&St&&St[ss]||(as=Hn=0)||Zi.pop())&&!((Be?St.nodeName.toLowerCase()===dc:St.nodeType===1)&&++as&&(rd&&(_r=St[T]||(St[T]={}),jt=_r[St.uniqueID]||(_r[St.uniqueID]={}),jt[N]=[R,as]),St===rt)););return as-=oe,as===be||as%be===0&&as/be>=0}}},PSEUDO:function(N,$){var Z,be=i.pseudos[N]||i.setFilters[N.toLowerCase()]||$t.error("unsupported pseudo: "+N);return be[T]?be($):be.length>1?(Z=[N,N,"",$],i.setFilters.hasOwnProperty(N.toLowerCase())?st(function(oe,Ce){for(var Pe,Be=be(oe,$),rt=Be.length;rt--;)Pe=ge(oe,Be[rt]),oe[Pe]=!(Ce[Pe]=Be[rt])}):function(oe){return be(oe,0,Z)}):be}},pseudos:{not:st(function(N){var $=[],Z=[],be=a(N.replace(U,"$1"));return be[T]?st(function(oe,Ce,Pe,Be){for(var rt,At=be(oe,null,Be,[]),yt=oe.length;yt--;)(rt=At[yt])&&(oe[yt]=!(Ce[yt]=rt))}):function(oe,Ce,Pe){return $[0]=oe,be($,null,Pe,Z),$[0]=null,!Z.pop()}}),has:st(function(N){return function($){return $t(N,$).length>0}}),contains:st(function(N){return N=N.replace(lt,dt),function($){return($.textContent||n($)).indexOf(N)>-1}}),lang:st(function(N){return Je.test(N||"")||$t.error("unsupported lang: "+N),N=N.replace(lt,dt).toLowerCase(),function($){var Z;do if(Z=C?$.lang:$.getAttribute("xml:lang")||$.getAttribute("lang"))return Z=Z.toLowerCase(),Z===N||Z.indexOf(N+"-")===0;while(($=$.parentNode)&&$.nodeType===1);return!1}}),target:function(N){var $=r.location&&r.location.hash;return $&&$.slice(1)===N.id},root:function(N){return N===b},focus:function(N){return N===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(N.type||N.href||~N.tabIndex)},enabled:Ft(!1),disabled:Ft(!0),checked:function(N){var $=N.nodeName.toLowerCase();return $==="input"&&!!N.checked||$==="option"&&!!N.selected},selected:function(N){return N.parentNode&&N.parentNode.selectedIndex,N.selected===!0},empty:function(N){for(N=N.firstChild;N;N=N.nextSibling)if(N.nodeType<6)return!1;return!0},parent:function(N){return!i.pseudos.empty(N)},header:function(N){return Xr.test(N.nodeName)},input:function(N){return we.test(N.nodeName)},button:function(N){var $=N.nodeName.toLowerCase();return $==="input"&&N.type==="button"||$==="button"},text:function(N){var $;return N.nodeName.toLowerCase()==="input"&&N.type==="text"&&(($=N.getAttribute("type"))==null||$.toLowerCase()==="text")},first:In(function(){return[0]}),last:In(function(N,$){return[$-1]}),eq:In(function(N,$,Z){return[Z<0?Z+$:Z]}),even:In(function(N,$){for(var Z=0;Z<$;Z+=2)N.push(Z);return N}),odd:In(function(N,$){for(var Z=1;Z<$;Z+=2)N.push(Z);return N}),lt:In(function(N,$,Z){for(var be=Z<0?Z+$:Z>$?$:Z;--be>=0;)N.push(be);return N}),gt:In(function(N,$,Z){for(var be=Z<0?Z+$:Z;++be<$;)N.push(be);return N})}},i.pseudos.nth=i.pseudos.eq;for(e in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=xt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=il(e);function Vi(){}Vi.prototype=i.filters=i.pseudos,i.setFilters=new Vi,s=$t.tokenize=function(N,$){var Z,be,oe,Ce,Pe,Be,rt,At=H[N+" "];if(At)return $?0:At.slice(0);for(Pe=N,Be=[],rt=i.preFilter;Pe;){(!Z||(be=ce.exec(Pe)))&&(be&&(Pe=Pe.slice(be[0].length)||Pe),Be.push(oe=[])),Z=!1,(be=Oe.exec(Pe))&&(Z=be.shift(),oe.push({value:Z,type:be[0].replace(U," ")}),Pe=Pe.slice(Z.length));for(Ce in i.filter)(be=tr[Ce].exec(Pe))&&(!rt[Ce]||(be=rt[Ce](be)))&&(Z=be.shift(),oe.push({value:Z,type:Ce,matches:be}),Pe=Pe.slice(Z.length));if(!Z)break}return $?Pe.length:Pe?$t.error(N):H(N,Be).slice(0)};function Qi(N){for(var $=0,Z=N.length,be="";$<Z;$++)be+=N[$].value;return be}function On(N,$,Z){var be=$.dir,oe=$.next,Ce=oe||be,Pe=Z&&Ce==="parentNode",Be=P++;return $.first?function(rt,At,yt){for(;rt=rt[be];)if(rt.nodeType===1||Pe)return N(rt,At,yt);return!1}:function(rt,At,yt){var vt,jt,_r,St=[R,Be];if(yt){for(;rt=rt[be];)if((rt.nodeType===1||Pe)&&N(rt,At,yt))return!0}else for(;rt=rt[be];)if(rt.nodeType===1||Pe)if(_r=rt[T]||(rt[T]={}),jt=_r[rt.uniqueID]||(_r[rt.uniqueID]={}),oe&&oe===rt.nodeName.toLowerCase())rt=rt[be]||rt;else{if((vt=jt[Ce])&&vt[0]===R&&vt[1]===Be)return St[2]=vt[2];if(jt[Ce]=St,St[2]=N(rt,At,yt))return!0}return!1}}function pa(N){return N.length>1?function($,Z,be){for(var oe=N.length;oe--;)if(!N[oe]($,Z,be))return!1;return!0}:N[0]}function Wt(N,$,Z){for(var be=0,oe=$.length;be<oe;be++)$t(N,$[be],Z);return Z}function vi(N,$,Z,be,oe){for(var Ce,Pe=[],Be=0,rt=N.length,At=$!=null;Be<rt;Be++)(Ce=N[Be])&&(!Z||Z(Ce,be,oe))&&(Pe.push(Ce),At&&$.push(Be));return Pe}function xo(N,$,Z,be,oe,Ce){return be&&!be[T]&&(be=xo(be)),oe&&!oe[T]&&(oe=xo(oe,Ce)),st(function(Pe,Be,rt,At){var yt,vt,jt,_r=[],St=[],Hn=Be.length,Zi=Pe||Wt($||"*",rt.nodeType?[rt]:rt,[]),ss=N&&(Pe||!$)?vi(Zi,_r,N,rt,At):Zi,en=Z?oe||(Pe?N:Hn||be)?[]:Be:ss;if(Z&&Z(ss,en,rt,At),be)for(yt=vi(en,St),be(yt,[],rt,At),vt=yt.length;vt--;)(jt=yt[vt])&&(en[St[vt]]=!(ss[St[vt]]=jt));if(Pe){if(oe||N){if(oe){for(yt=[],vt=en.length;vt--;)(jt=en[vt])&&yt.push(ss[vt]=jt);oe(null,en=[],yt,At)}for(vt=en.length;vt--;)(jt=en[vt])&&(yt=oe?ge(Pe,jt):_r[vt])>-1&&(Pe[yt]=!(Be[yt]=jt))}}else en=vi(en===Be?en.splice(Hn,en.length):en),oe?oe(null,Be,en,At):ae.apply(Be,en)})}function Qr(N){for(var $,Z,be,oe=N.length,Ce=i.relative[N[0].type],Pe=Ce||i.relative[" "],Be=Ce?1:0,rt=On(function(vt){return vt===$},Pe,!0),At=On(function(vt){return ge($,vt)>-1},Pe,!0),yt=[function(vt,jt,_r){var St=!Ce&&(_r||jt!==c)||(($=jt).nodeType?rt(vt,jt,_r):At(vt,jt,_r));return $=null,St}];Be<oe;Be++)if(Z=i.relative[N[Be].type])yt=[On(pa(yt),Z)];else{if(Z=i.filter[N[Be].type].apply(null,N[Be].matches),Z[T]){for(be=++Be;be<oe&&!i.relative[N[be].type];be++);return xo(Be>1&&pa(yt),Be>1&&Qi(N.slice(0,Be-1).concat({value:N[Be-2].type===" "?"*":""})).replace(U,"$1"),Z,Be<be&&Qr(N.slice(Be,be)),be<oe&&Qr(N=N.slice(be)),be<oe&&Qi(N))}yt.push(Z)}return pa(yt)}function Yd(N,$){var Z=$.length>0,be=N.length>0,oe=function(Ce,Pe,Be,rt,At){var yt,vt,jt,_r=0,St="0",Hn=Ce&&[],Zi=[],ss=c,en=Ce||be&&i.find.TAG("*",At),dc=R+=ss==null?1:Math.random()||.1,rd=en.length;for(At&&(c=Pe==h||Pe||At);St!==rd&&(yt=en[St])!=null;St++){if(be&&yt){for(vt=0,!Pe&&yt.ownerDocument!=h&&(g(yt),Be=!C);jt=N[vt++];)if(jt(yt,Pe||h,Be)){rt.push(yt);break}At&&(R=dc)}Z&&((yt=!jt&&yt)&&_r--,Ce&&Hn.push(yt))}if(_r+=St,Z&&St!==_r){for(vt=0;jt=$[vt++];)jt(Hn,Zi,Pe,Be);if(Ce){if(_r>0)for(;St--;)Hn[St]||Zi[St]||(Zi[St]=q.call(rt));Zi=vi(Zi)}ae.apply(rt,Zi),At&&!Ce&&Zi.length>0&&_r+$.length>1&&$t.uniqueSort(rt)}return At&&(R=dc,c=ss),Hn};return Z?st(oe):oe}return a=$t.compile=function(N,$){var Z,be=[],oe=[],Ce=j[N+" "];if(!Ce){for($||($=s(N)),Z=$.length;Z--;)Ce=Qr($[Z]),Ce[T]?be.push(Ce):oe.push(Ce);Ce=j(N,Yd(oe,be)),Ce.selector=N}return Ce},l=$t.select=function(N,$,Z,be){var oe,Ce,Pe,Be,rt,At=typeof N=="function"&&N,yt=!be&&s(N=At.selector||N);if(Z=Z||[],yt.length===1){if(Ce=yt[0]=yt[0].slice(0),Ce.length>2&&(Pe=Ce[0]).type==="ID"&&$.nodeType===9&&C&&i.relative[Ce[1].type]){if($=(i.find.ID(Pe.matches[0].replace(lt,dt),$)||[])[0],$)At&&($=$.parentNode);else return Z;N=N.slice(Ce.shift().value.length)}for(oe=tr.needsContext.test(N)?0:Ce.length;oe--&&(Pe=Ce[oe],!i.relative[Be=Pe.type]);)if((rt=i.find[Be])&&(be=rt(Pe.matches[0].replace(lt,dt),Et.test(Ce[0].type)&&no($.parentNode)||$))){if(Ce.splice(oe,1),N=be.length&&Qi(Ce),!N)return ae.apply(Z,be),Z;break}}return(At||a(N,yt))(be,$,!C,Z,!$||Et.test(N)&&no($.parentNode)||$),Z},t.sortStable=T.split("").sort(le).join("")===T,t.detectDuplicates=!!p,g(),t.sortDetached=kt(function(N){return N.compareDocumentPosition(h.createElement("fieldset"))&1}),kt(function(N){return N.innerHTML="<a href='#'></a>",N.firstChild.getAttribute("href")==="#"})||Ae("type|href|height|width",function(N,$,Z){if(!Z)return N.getAttribute($,$.toLowerCase()==="type"?1:2)}),(!t.attributes||!kt(function(N){return N.innerHTML="<input/>",N.firstChild.setAttribute("value",""),N.firstChild.getAttribute("value")===""}))&&Ae("value",function(N,$,Z){if(!Z&&N.nodeName.toLowerCase()==="input")return N.defaultValue}),kt(function(N){return N.getAttribute("disabled")==null})||Ae(he,function(N,$,Z){var be;if(!Z)return N[$]===!0?$.toLowerCase():(be=N.getAttributeNode($))&&be.specified?be.value:null}),$t}(window);I.find=Vh;I.expr=Vh.selectors;I.expr[":"]=I.expr.pseudos;I.uniqueSort=I.unique=Vh.uniqueSort;I.text=Vh.getText;I.isXMLDoc=Vh.isXML;I.contains=Vh.contains;I.escapeSelector=Vh.escape;em=function(r,e,t){for(var i=[],n=t!==void 0;(r=r[e])&&r.nodeType!==9;)if(r.nodeType===1){if(n&&I(r).is(t))break;i.push(r)}return i},NO=function(r,e){for(var t=[];r;r=r.nextSibling)r.nodeType===1&&r!==e&&t.push(r);return t},cP=I.expr.match.needsContext;dP=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;I.filter=function(r,e,t){var i=e[0];return t&&(r=":not("+r+")"),e.length===1&&i.nodeType===1?I.find.matchesSelector(i,r)?[i]:[]:I.find.matches(r,I.grep(e,function(n){return n.nodeType===1}))};I.fn.extend({find:function(r){var e,t,i=this.length,n=this;if(typeof r!="string")return this.pushStack(I(r).filter(function(){for(e=0;e<i;e++)if(I.contains(n[e],this))return!0}));for(t=this.pushStack([]),e=0;e<i;e++)I.find(r,n[e],t);return i>1?I.uniqueSort(t):t},filter:function(r){return this.pushStack(JV(this,r||[],!1))},not:function(r){return this.pushStack(JV(this,r||[],!0))},is:function(r){return!!JV(this,typeof r=="string"&&cP.test(r)?I(r):r||[],!1).length}});_q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Fq=I.fn.init=function(r,e,t){var i,n;if(!r)return this;if(t=t||uP,typeof r=="string")if(r[0]==="<"&&r[r.length-1]===">"&&r.length>=3?i=[null,r,null]:i=_q.exec(r),i&&(i[1]||!e))if(i[1]){if(e=e instanceof I?e[0]:e,I.merge(this,I.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:mi,!0)),dP.test(i[1])&&I.isPlainObject(e))for(i in e)ri(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}else return n=mi.getElementById(i[2]),n&&(this[0]=n,this.length=1),this;else return!e||e.jquery?(e||t).find(r):this.constructor(e).find(r);else{if(r.nodeType)return this[0]=r,this.length=1,this;if(ri(r))return t.ready!==void 0?t.ready(r):r(I)}return I.makeArray(r,this)};Fq.prototype=I.fn;uP=I(mi);Rq=/^(?:parents|prev(?:Until|All))/,Nq={children:!0,contents:!0,next:!0,prev:!0};I.fn.extend({has:function(r){var e=I(r,this),t=e.length;return this.filter(function(){for(var i=0;i<t;i++)if(I.contains(this,e[i]))return!0})},closest:function(r,e){var t,i=0,n=this.length,o=[],s=typeof r!="string"&&I(r);if(!cP.test(r)){for(;i<n;i++)for(t=this[i];t&&t!==e;t=t.parentNode)if(t.nodeType<11&&(s?s.index(t)>-1:t.nodeType===1&&I.find.matchesSelector(t,r))){o.push(t);break}}return this.pushStack(o.length>1?I.uniqueSort(o):o)},index:function(r){return r?typeof r=="string"?PC.call(I(r),this[0]):PC.call(this,r.jquery?r[0]:r):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(r,e){return this.pushStack(I.uniqueSort(I.merge(this.get(),I(r,e))))},addBack:function(r){return this.add(r==null?this.prevObject:this.prevObject.filter(r))}});I.each({parent:function(r){var e=r.parentNode;return e&&e.nodeType!==11?e:null},parents:function(r){return em(r,"parentNode")},parentsUntil:function(r,e,t){return em(r,"parentNode",t)},next:function(r){return BO(r,"nextSibling")},prev:function(r){return BO(r,"previousSibling")},nextAll:function(r){return em(r,"nextSibling")},prevAll:function(r){return em(r,"previousSibling")},nextUntil:function(r,e,t){return em(r,"nextSibling",t)},prevUntil:function(r,e,t){return em(r,"previousSibling",t)},siblings:function(r){return NO((r.parentNode||{}).firstChild,r)},children:function(r){return NO(r.firstChild)},contents:function(r){return r.contentDocument!=null&&iP(r.contentDocument)?r.contentDocument:(Pl(r,"template")&&(r=r.content||r),I.merge([],r.childNodes))}},function(r,e){I.fn[r]=function(t,i){var n=I.map(this,e,t);return r.slice(-5)!=="Until"&&(i=t),i&&typeof i=="string"&&(n=I.filter(i,n)),this.length>1&&(Nq[r]||I.uniqueSort(n),Rq.test(r)&&n.reverse()),this.pushStack(n)}});cp=/[^\x20\t\r\n\f]+/g;I.Callbacks=function(r){r=typeof r=="string"?Bq(r):I.extend({},r);var e,t,i,n,o=[],s=[],a=-1,l=function(){for(n=n||r.once,i=e=!0;s.length;a=-1)for(t=s.shift();++a<o.length;)o[a].apply(t[0],t[1])===!1&&r.stopOnFalse&&(a=o.length,t=!1);r.memory||(t=!1),e=!1,n&&(t?o=[]:o="")},c={add:function(){return o&&(t&&!e&&(a=o.length-1,s.push(t)),function u(p){I.each(p,function(g,h){ri(h)?(!r.unique||!c.has(h))&&o.push(h):h&&h.length&&cm(h)!=="string"&&u(h)})}(arguments),t&&!e&&l()),this},remove:function(){return I.each(arguments,function(u,p){for(var g;(g=I.inArray(p,o,g))>-1;)o.splice(g,1),g<=a&&a--}),this},has:function(u){return u?I.inArray(u,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return n=s=[],o=t="",this},disabled:function(){return!o},lock:function(){return n=s=[],!t&&!e&&(o=t=""),this},locked:function(){return!!n},fireWith:function(u,p){return n||(p=p||[],p=[u,p.slice?p.slice():p],s.push(p),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c};I.extend({Deferred:function(r){var e=[["notify","progress",I.Callbacks("memory"),I.Callbacks("memory"),2],["resolve","done",I.Callbacks("once memory"),I.Callbacks("once memory"),0,"resolved"],["reject","fail",I.Callbacks("once memory"),I.Callbacks("once memory"),1,"rejected"]],t="pending",i={state:function(){return t},always:function(){return n.done(arguments).fail(arguments),this},catch:function(o){return i.then(null,o)},pipe:function(){var o=arguments;return I.Deferred(function(s){I.each(e,function(a,l){var c=ri(o[l[4]])&&o[l[4]];n[l[1]](function(){var u=c&&c.apply(this,arguments);u&&ri(u.promise)?u.promise().progress(s.notify).done(s.resolve).fail(s.reject):s[l[0]+"With"](this,c?[u]:arguments)})}),o=null}).promise()},then:function(o,s,a){var l=0;function c(u,p,g,h){return function(){var b=this,C=arguments,D=function(){var V,k;if(!(u<l)){if(V=g.apply(b,C),V===p.promise())throw new TypeError("Thenable self-resolution");k=V&&(typeof V=="object"||typeof V=="function")&&V.then,ri(k)?h?k.call(V,c(l,p,tm,h),c(l,p,LC,h)):(l++,k.call(V,c(l,p,tm,h),c(l,p,LC,h),c(l,p,tm,p.notifyWith))):(g!==tm&&(b=void 0,C=[V]),(h||p.resolveWith)(b,C))}},S=h?D:function(){try{D()}catch(V){I.Deferred.exceptionHook&&I.Deferred.exceptionHook(V,S.stackTrace),u+1>=l&&(g!==LC&&(b=void 0,C=[V]),p.rejectWith(b,C))}};u?S():(I.Deferred.getStackHook&&(S.stackTrace=I.Deferred.getStackHook()),window.setTimeout(S))}}return I.Deferred(function(u){e[0][3].add(c(0,u,ri(a)?a:tm,u.notifyWith)),e[1][3].add(c(0,u,ri(o)?o:tm)),e[2][3].add(c(0,u,ri(s)?s:LC))}).promise()},promise:function(o){return o!=null?I.extend(o,i):i}},n={};return I.each(e,function(o,s){var a=s[2],l=s[5];i[s[1]]=a.add,l&&a.add(function(){t=l},e[3-o][2].disable,e[3-o][3].disable,e[0][2].lock,e[0][3].lock),a.add(s[3].fire),n[s[0]]=function(){return n[s[0]+"With"](this===n?void 0:this,arguments),this},n[s[0]+"With"]=a.fireWith}),i.promise(n),r&&r.call(n,n),n},when:function(r){var e=arguments.length,t=e,i=Array(t),n=lp.call(arguments),o=I.Deferred(),s=function(a){return function(l){i[a]=this,n[a]=arguments.length>1?lp.call(arguments):l,--e||o.resolveWith(i,n)}};if(e<=1&&(KO(r,o.done(s(t)).resolve,o.reject,!e),o.state()==="pending"||ri(n[t]&&n[t].then)))return o.then();for(;t--;)KO(n[t],s(t),o.reject);return o.promise()}});Kq=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;I.Deferred.exceptionHook=function(r,e){window.console&&window.console.warn&&r&&Kq.test(r.name)&&window.console.warn("jQuery.Deferred exception: "+r.message,r.stack,e)};I.readyException=function(r){window.setTimeout(function(){throw r})};iT=I.Deferred();I.fn.ready=function(r){return iT.then(r).catch(function(e){I.readyException(e)}),this};I.extend({isReady:!1,readyWait:1,ready:function(r){(r===!0?--I.readyWait:I.isReady)||(I.isReady=!0,!(r!==!0&&--I.readyWait>0)&&iT.resolveWith(mi,[I]))}});I.ready.then=iT.then;mi.readyState==="complete"||mi.readyState!=="loading"&&!mi.documentElement.doScroll?window.setTimeout(I.ready):(mi.addEventListener("DOMContentLoaded",FC),window.addEventListener("load",FC));cu=function(r,e,t,i,n,o,s){var a=0,l=r.length,c=t==null;if(cm(t)==="object"){n=!0;for(a in t)cu(r,e,a,t[a],!0,o,s)}else if(i!==void 0&&(n=!0,ri(i)||(s=!0),c&&(s?(e.call(r,i),e=null):(c=e,e=function(u,p,g){return c.call(I(u),g)})),e))for(;a<l;a++)e(r[a],t,s?i:i.call(r[a],a,e(r[a],t)));return n?r:c?e.call(r):l?e(r[0],t):o},Uq=/^-ms-/,Hq=/-([a-z])/g;ab=function(r){return r.nodeType===1||r.nodeType===9||!+r.nodeType};cb.uid=1;cb.prototype={cache:function(r){var e=r[this.expando];return e||(e={},ab(r)&&(r.nodeType?r[this.expando]=e:Object.defineProperty(r,this.expando,{value:e,configurable:!0}))),e},set:function(r,e,t){var i,n=this.cache(r);if(typeof e=="string")n[ud(e)]=t;else for(i in e)n[ud(i)]=e[i];return n},get:function(r,e){return e===void 0?this.cache(r):r[this.expando]&&r[this.expando][ud(e)]},access:function(r,e,t){return e===void 0||e&&typeof e=="string"&&t===void 0?this.get(r,e):(this.set(r,e,t),t!==void 0?t:e)},remove:function(r,e){var t,i=r[this.expando];if(i!==void 0){if(e!==void 0)for(Array.isArray(e)?e=e.map(ud):(e=ud(e),e=e in i?[e]:e.match(cp)||[]),t=e.length;t--;)delete i[e[t]];(e===void 0||I.isEmptyObject(i))&&(r.nodeType?r[this.expando]=void 0:delete r[this.expando])}},hasData:function(r){var e=r[this.expando];return e!==void 0&&!I.isEmptyObject(e)}};Jt=new cb,_a=new cb,zq=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,$q=/[A-Z]/g;I.extend({hasData:function(r){return _a.hasData(r)||Jt.hasData(r)},data:function(r,e,t){return _a.access(r,e,t)},removeData:function(r,e){_a.remove(r,e)},_data:function(r,e,t){return Jt.access(r,e,t)},_removeData:function(r,e){Jt.remove(r,e)}});I.fn.extend({data:function(r,e){var t,i,n,o=this[0],s=o&&o.attributes;if(r===void 0){if(this.length&&(n=_a.get(o),o.nodeType===1&&!Jt.get(o,"hasDataAttrs"))){for(t=s.length;t--;)s[t]&&(i=s[t].name,i.indexOf("data-")===0&&(i=ud(i.slice(5)),UO(o,i,n[i])));Jt.set(o,"hasDataAttrs",!0)}return n}return typeof r=="object"?this.each(function(){_a.set(this,r)}):cu(this,function(a){var l;if(o&&a===void 0)return l=_a.get(o,r),l!==void 0||(l=UO(o,r),l!==void 0)?l:void 0;this.each(function(){_a.set(this,r,a)})},null,e,arguments.length>1,null,!0)},removeData:function(r){return this.each(function(){_a.remove(this,r)})}});I.extend({queue:function(r,e,t){var i;if(r)return e=(e||"fx")+"queue",i=Jt.get(r,e),t&&(!i||Array.isArray(t)?i=Jt.access(r,e,I.makeArray(t)):i.push(t)),i||[]},dequeue:function(r,e){e=e||"fx";var t=I.queue(r,e),i=t.length,n=t.shift(),o=I._queueHooks(r,e),s=function(){I.dequeue(r,e)};n==="inprogress"&&(n=t.shift(),i--),n&&(e==="fx"&&t.unshift("inprogress"),delete o.stop,n.call(r,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(r,e){var t=e+"queueHooks";return Jt.get(r,t)||Jt.access(r,t,{empty:I.Callbacks("once memory").add(function(){Jt.remove(r,[e+"queue",t])})})}});I.fn.extend({queue:function(r,e){var t=2;return typeof r!="string"&&(e=r,r="fx",t--),arguments.length<t?I.queue(this[0],r):e===void 0?this:this.each(function(){var i=I.queue(this,r,e);I._queueHooks(this,r),r==="fx"&&i[0]!=="inprogress"&&I.dequeue(this,r)})},dequeue:function(r){return this.each(function(){I.dequeue(this,r)})},clearQueue:function(r){return this.queue(r||"fx",[])},promise:function(r,e){var t,i=1,n=I.Deferred(),o=this,s=this.length,a=function(){--i||n.resolveWith(o,[o])};for(typeof r!="string"&&(e=r,r=void 0),r=r||"fx";s--;)t=Jt.get(o[s],r+"queueHooks"),t&&t.empty&&(i++,t.empty.add(a));return a(),n.promise(e)}});pP=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,db=new RegExp("^(?:([+-])=|)("+pP+")([a-z%]*)$","i"),au=["Top","Right","Bottom","Left"],Ih=mi.documentElement,dm=function(r){return I.contains(r.ownerDocument,r)},jq={composed:!0};Ih.getRootNode&&(dm=function(r){return I.contains(r.ownerDocument,r)||r.getRootNode(jq)===r.ownerDocument});KC=function(r,e){return r=e||r,r.style.display==="none"||r.style.display===""&&dm(r)&&I.css(r,"display")==="none"};HO={};I.fn.extend({show:function(){return nm(this,!0)},hide:function(){return nm(this)},toggle:function(r){return typeof r=="boolean"?r?this.show():this.hide():this.each(function(){KC(this)?I(this).show():I(this).hide()})}});sb=/^(?:checkbox|radio)$/i,gP=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,mP=/^$|^module$|\/(?:java|ecma)script/i;(function(){var r=mi.createDocumentFragment(),e=r.appendChild(mi.createElement("div")),t=mi.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),wn.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",wn.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",wn.option=!!e.lastChild})();Ol={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ol.tbody=Ol.tfoot=Ol.colgroup=Ol.caption=Ol.thead;Ol.th=Ol.td;wn.option||(Ol.optgroup=Ol.option=[1,"<select multiple='multiple'>","</select>"]);Yq=/<|&#?\w+;/;qO=/^([^.]*)(?:\.(.+)|)/;I.event={global:{},add:function(r,e,t,i,n){var o,s,a,l,c,u,p,g,h,b,C,D=Jt.get(r);if(ab(r))for(t.handler&&(o=t,t=o.handler,n=o.selector),n&&I.find.matchesSelector(Ih,n),t.guid||(t.guid=I.guid++),(l=D.events)||(l=D.events=Object.create(null)),(s=D.handle)||(s=D.handle=function(S){return typeof I!="undefined"&&I.event.triggered!==S.type?I.event.dispatch.apply(r,arguments):void 0}),e=(e||"").match(cp)||[""],c=e.length;c--;)a=qO.exec(e[c])||[],h=C=a[1],b=(a[2]||"").split(".").sort(),h&&(p=I.event.special[h]||{},h=(n?p.delegateType:p.bindType)||h,p=I.event.special[h]||{},u=I.extend({type:h,origType:C,data:i,handler:t,guid:t.guid,selector:n,needsContext:n&&I.expr.match.needsContext.test(n),namespace:b.join(".")},o),(g=l[h])||(g=l[h]=[],g.delegateCount=0,(!p.setup||p.setup.call(r,i,b,s)===!1)&&r.addEventListener&&r.addEventListener(h,s)),p.add&&(p.add.call(r,u),u.handler.guid||(u.handler.guid=t.guid)),n?g.splice(g.delegateCount++,0,u):g.push(u),I.event.global[h]=!0)},remove:function(r,e,t,i,n){var o,s,a,l,c,u,p,g,h,b,C,D=Jt.hasData(r)&&Jt.get(r);if(!(!D||!(l=D.events))){for(e=(e||"").match(cp)||[""],c=e.length;c--;){if(a=qO.exec(e[c])||[],h=C=a[1],b=(a[2]||"").split(".").sort(),!h){for(h in l)I.event.remove(r,h+e[c],t,i,!0);continue}for(p=I.event.special[h]||{},h=(i?p.delegateType:p.bindType)||h,g=l[h]||[],a=a[2]&&new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=g.length;o--;)u=g[o],(n||C===u.origType)&&(!t||t.guid===u.guid)&&(!a||a.test(u.namespace))&&(!i||i===u.selector||i==="**"&&u.selector)&&(g.splice(o,1),u.selector&&g.delegateCount--,p.remove&&p.remove.call(r,u));s&&!g.length&&((!p.teardown||p.teardown.call(r,b,D.handle)===!1)&&I.removeEvent(r,h,D.handle),delete l[h])}I.isEmptyObject(l)&&Jt.remove(r,"handle events")}},dispatch:function(r){var e,t,i,n,o,s,a=new Array(arguments.length),l=I.event.fix(r),c=(Jt.get(this,"events")||Object.create(null))[l.type]||[],u=I.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!(u.preDispatch&&u.preDispatch.call(this,l)===!1)){for(s=I.event.handlers.call(this,l,c),e=0;(n=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=n.elem,t=0;(o=n.handlers[t++])&&!l.isImmediatePropagationStopped();)(!l.rnamespace||o.namespace===!1||l.rnamespace.test(o.namespace))&&(l.handleObj=o,l.data=o.data,i=((I.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,a),i!==void 0&&(l.result=i)===!1&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(r,e){var t,i,n,o,s,a=[],l=e.delegateCount,c=r.target;if(l&&c.nodeType&&!(r.type==="click"&&r.button>=1)){for(;c!==this;c=c.parentNode||this)if(c.nodeType===1&&!(r.type==="click"&&c.disabled===!0)){for(o=[],s={},t=0;t<l;t++)i=e[t],n=i.selector+" ",s[n]===void 0&&(s[n]=i.needsContext?I(n,this).index(c)>-1:I.find(n,this,null,[c]).length),s[n]&&o.push(i);o.length&&a.push({elem:c,handlers:o})}}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(r,e){Object.defineProperty(I.Event.prototype,r,{enumerable:!0,configurable:!0,get:ri(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[r]},set:function(t){Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(r){return r[I.expando]?r:new I.Event(r)},special:{load:{noBubble:!0},click:{setup:function(r){var e=this||r;return sb.test(e.type)&&e.click&&Pl(e,"input")&&RC(e,"click",om),!1},trigger:function(r){var e=this||r;return sb.test(e.type)&&e.click&&Pl(e,"input")&&RC(e,"click"),!0},_default:function(r){var e=r.target;return sb.test(e.type)&&e.click&&Pl(e,"input")&&Jt.get(e,"click")||Pl(e,"a")}},beforeunload:{postDispatch:function(r){r.result!==void 0&&r.originalEvent&&(r.originalEvent.returnValue=r.result)}}}};I.removeEvent=function(r,e,t){r.removeEventListener&&r.removeEventListener(e,t)};I.Event=function(r,e){if(!(this instanceof I.Event))return new I.Event(r,e);r&&r.type?(this.originalEvent=r,this.type=r.type,this.isDefaultPrevented=r.defaultPrevented||r.defaultPrevented===void 0&&r.returnValue===!1?om:sm,this.target=r.target&&r.target.nodeType===3?r.target.parentNode:r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget):this.type=r,e&&I.extend(this,e),this.timeStamp=r&&r.timeStamp||Date.now(),this[I.expando]=!0};I.Event.prototype={constructor:I.Event,isDefaultPrevented:sm,isPropagationStopped:sm,isImmediatePropagationStopped:sm,isSimulated:!1,preventDefault:function(){var r=this.originalEvent;this.isDefaultPrevented=om,r&&!this.isSimulated&&r.preventDefault()},stopPropagation:function(){var r=this.originalEvent;this.isPropagationStopped=om,r&&!this.isSimulated&&r.stopPropagation()},stopImmediatePropagation:function(){var r=this.originalEvent;this.isImmediatePropagationStopped=om,r&&!this.isSimulated&&r.stopImmediatePropagation(),this.stopPropagation()}};I.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},I.event.addProp);I.each({focus:"focusin",blur:"focusout"},function(r,e){I.event.special[r]={setup:function(){return RC(this,r,Xq),!1},trigger:function(){return RC(this,r),!0},_default:function(){return!0},delegateType:e}});I.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(r,e){I.event.special[r]={delegateType:e,bindType:e,handle:function(t){var i,n=this,o=t.relatedTarget,s=t.handleObj;return(!o||o!==n&&!I.contains(n,o))&&(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}});I.fn.extend({on:function(r,e,t,i){return XV(this,r,e,t,i)},one:function(r,e,t,i){return XV(this,r,e,t,i,1)},off:function(r,e,t){var i,n;if(r&&r.preventDefault&&r.handleObj)return i=r.handleObj,I(r.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof r=="object"){for(n in r)this.off(n,e,r[n]);return this}return(e===!1||typeof e=="function")&&(t=e,e=void 0),t===!1&&(t=sm),this.each(function(){I.event.remove(this,r,t,e)})}});Zq=/<script|<style|<link/i,e4=/checked\s*(?:[^=]|=\s*.checked.)/i,t4=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;I.extend({htmlPrefilter:function(r){return r},clone:function(r,e,t){var i,n,o,s,a=r.cloneNode(!0),l=dm(r);if(!wn.noCloneChecked&&(r.nodeType===1||r.nodeType===11)&&!I.isXMLDoc(r))for(s=Oa(a),o=Oa(r),i=0,n=o.length;i<n;i++)n4(o[i],s[i]);if(e)if(t)for(o=o||Oa(r),s=s||Oa(a),i=0,n=o.length;i<n;i++)$O(o[i],s[i]);else $O(r,a);return s=Oa(a,"script"),s.length>0&&nT(s,!l&&Oa(r,"script")),a},cleanData:function(r){for(var e,t,i,n=I.event.special,o=0;(t=r[o])!==void 0;o++)if(ab(t)){if(e=t[Jt.expando]){if(e.events)for(i in e.events)n[i]?I.event.remove(t,i):I.removeEvent(t,i,e.handle);t[Jt.expando]=void 0}t[_a.expando]&&(t[_a.expando]=void 0)}}});I.fn.extend({detach:function(r){return WO(this,r,!0)},remove:function(r){return WO(this,r)},text:function(r){return cu(this,function(e){return e===void 0?I.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=e)})},null,r,arguments.length)},append:function(){return rm(this,arguments,function(r){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var e=zO(this,r);e.appendChild(r)}})},prepend:function(){return rm(this,arguments,function(r){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var e=zO(this,r);e.insertBefore(r,e.firstChild)}})},before:function(){return rm(this,arguments,function(r){this.parentNode&&this.parentNode.insertBefore(r,this)})},after:function(){return rm(this,arguments,function(r){this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling)})},empty:function(){for(var r,e=0;(r=this[e])!=null;e++)r.nodeType===1&&(I.cleanData(Oa(r,!1)),r.textContent="");return this},clone:function(r,e){return r=r==null?!1:r,e=e==null?r:e,this.map(function(){return I.clone(this,r,e)})},html:function(r){return cu(this,function(e){var t=this[0]||{},i=0,n=this.length;if(e===void 0&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!Zq.test(e)&&!Ol[(gP.exec(e)||["",""])[1].toLowerCase()]){e=I.htmlPrefilter(e);try{for(;i<n;i++)t=this[i]||{},t.nodeType===1&&(I.cleanData(Oa(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,r,arguments.length)},replaceWith:function(){var r=[];return rm(this,arguments,function(e){var t=this.parentNode;I.inArray(this,r)<0&&(I.cleanData(Oa(this)),t&&t.replaceChild(e,this))},r)}});I.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(r,e){I.fn[r]=function(t){for(var i,n=[],o=I(t),s=o.length-1,a=0;a<=s;a++)i=a===s?this:this.clone(!0),I(o[a])[e](i),rT.apply(n,i.get());return this.pushStack(n)}});oT=new RegExp("^("+pP+")(?!px)[a-z%]+$","i"),UC=function(r){var e=r.ownerDocument.defaultView;return(!e||!e.opener)&&(e=window),e.getComputedStyle(r)},yP=function(r,e,t){var i,n,o={};for(n in e)o[n]=r.style[n],r.style[n]=e[n];i=t.call(r);for(n in e)r.style[n]=o[n];return i},o4=new RegExp(au.join("|"),"i");(function(){function r(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ih.appendChild(l).appendChild(c);var u=window.getComputedStyle(c);t=u.top!=="1%",a=e(u.marginLeft)===12,c.style.right="60%",o=e(u.right)===36,i=e(u.width)===36,c.style.position="absolute",n=e(c.offsetWidth/3)===12,Ih.removeChild(l),c=null}}function e(u){return Math.round(parseFloat(u))}var t,i,n,o,s,a,l=mi.createElement("div"),c=mi.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",wn.clearCloneStyle=c.style.backgroundClip==="content-box",I.extend(wn,{boxSizingReliable:function(){return r(),i},pixelBoxStyles:function(){return r(),o},pixelPosition:function(){return r(),t},reliableMarginLeft:function(){return r(),a},scrollboxSize:function(){return r(),n},reliableTrDimensions:function(){var u,p,g,h;return s==null&&(u=mi.createElement("table"),p=mi.createElement("tr"),g=mi.createElement("div"),u.style.cssText="position:absolute;left:-11111px;border-collapse:separate",p.style.cssText="border:1px solid",p.style.height="1px",g.style.height="9px",g.style.display="block",Ih.appendChild(u).appendChild(p).appendChild(g),h=window.getComputedStyle(p),s=parseInt(h.height,10)+parseInt(h.borderTopWidth,10)+parseInt(h.borderBottomWidth,10)===p.offsetHeight,Ih.removeChild(u)),s}}))})();jO=["Webkit","Moz","ms"],wP=mi.createElement("div").style,JO={};a4=/^(none|table(?!-c[ea]).+)/,YO=/^--/,l4={position:"absolute",visibility:"hidden",display:"block"},XO={letterSpacing:"0",fontWeight:"400"};I.extend({cssHooks:{opacity:{get:function(r,e){if(e){var t=lb(r,"opacity");return t===""?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(r,e,t,i){if(!(!r||r.nodeType===3||r.nodeType===8||!r.style)){var n,o,s,a=ud(e),l=YO.test(e),c=r.style;if(l||(e=QV(a)),s=I.cssHooks[e]||I.cssHooks[a],t!==void 0){if(o=typeof t,o==="string"&&(n=db.exec(t))&&n[1]&&(t=hP(r,e,n),o="number"),t==null||t!==t)return;o==="number"&&!l&&(t+=n&&n[3]||(I.cssNumber[a]?"":"px")),!wn.clearCloneStyle&&t===""&&e.indexOf("background")===0&&(c[e]="inherit"),(!s||!("set"in s)||(t=s.set(r,t,i))!==void 0)&&(l?c.setProperty(e,t):c[e]=t)}else return s&&"get"in s&&(n=s.get(r,!1,i))!==void 0?n:c[e]}},css:function(r,e,t,i){var n,o,s,a=ud(e),l=YO.test(e);return l||(e=QV(a)),s=I.cssHooks[e]||I.cssHooks[a],s&&"get"in s&&(n=s.get(r,!0,t)),n===void 0&&(n=lb(r,e,i)),n==="normal"&&e in XO&&(n=XO[e]),t===""||t?(o=parseFloat(n),t===!0||isFinite(o)?o||0:n):n}});I.each(["height","width"],function(r,e){I.cssHooks[e]={get:function(t,i,n){if(i)return a4.test(I.css(t,"display"))&&(!t.getClientRects().length||!t.getBoundingClientRect().width)?yP(t,l4,function(){return QO(t,e,n)}):QO(t,e,n)},set:function(t,i,n){var o,s=UC(t),a=!wn.scrollboxSize()&&s.position==="absolute",l=a||n,c=l&&I.css(t,"boxSizing",!1,s)==="border-box",u=n?ZV(t,e,n,c,s):0;return c&&a&&(u-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-ZV(t,e,"border",!1,s)-.5)),u&&(o=db.exec(i))&&(o[3]||"px")!=="px"&&(t.style[e]=i,i=I.css(t,e)),xP(t,i,u)}}});I.cssHooks.marginLeft=bP(wn.reliableMarginLeft,function(r,e){if(e)return(parseFloat(lb(r,"marginLeft"))||r.getBoundingClientRect().left-yP(r,{marginLeft:0},function(){return r.getBoundingClientRect().left}))+"px"});I.each({margin:"",padding:"",border:"Width"},function(r,e){I.cssHooks[r+e]={expand:function(t){for(var i=0,n={},o=typeof t=="string"?t.split(" "):[t];i<4;i++)n[r+au[i]+e]=o[i]||o[i-2]||o[0];return n}},r!=="margin"&&(I.cssHooks[r+e].set=xP)});I.fn.extend({css:function(r,e){return cu(this,function(t,i,n){var o,s,a={},l=0;if(Array.isArray(i)){for(o=UC(t),s=i.length;l<s;l++)a[i[l]]=I.css(t,i[l],!1,o);return a}return n!==void 0?I.style(t,i,n):I.css(t,i)},r,e,arguments.length>1)}});I.Tween=Pa;Pa.prototype={constructor:Pa,init:function(r,e,t,i,n,o){this.elem=r,this.prop=t,this.easing=n||I.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(I.cssNumber[t]?"":"px")},cur:function(){var r=Pa.propHooks[this.prop];return r&&r.get?r.get(this):Pa.propHooks._default.get(this)},run:function(r){var e,t=Pa.propHooks[this.prop];return this.options.duration?this.pos=e=I.easing[this.easing](r,this.options.duration*r,0,1,this.options.duration):this.pos=e=r,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),t&&t.set?t.set(this):Pa.propHooks._default.set(this),this}};Pa.prototype.init.prototype=Pa.prototype;Pa.propHooks={_default:{get:function(r){var e;return r.elem.nodeType!==1||r.elem[r.prop]!=null&&r.elem.style[r.prop]==null?r.elem[r.prop]:(e=I.css(r.elem,r.prop,""),!e||e==="auto"?0:e)},set:function(r){I.fx.step[r.prop]?I.fx.step[r.prop](r):r.elem.nodeType===1&&(I.cssHooks[r.prop]||r.elem.style[QV(r.prop)]!=null)?I.style(r.elem,r.prop,r.now+r.unit):r.elem[r.prop]=r.now}}};Pa.propHooks.scrollTop=Pa.propHooks.scrollLeft={set:function(r){r.elem.nodeType&&r.elem.parentNode&&(r.elem[r.prop]=r.now)}};I.easing={linear:function(r){return r},swing:function(r){return .5-Math.cos(r*Math.PI)/2},_default:"swing"};I.fx=Pa.prototype.init;I.fx.step={};c4=/^(?:toggle|show|hide)$/,d4=/queueHooks$/;I.Animation=I.extend(mc,{tweeners:{"*":[function(r,e){var t=this.createTween(r,e);return hP(t.elem,r,db.exec(e),t),t}]},tweener:function(r,e){ri(r)?(e=r,r=["*"]):r=r.match(cp);for(var t,i=0,n=r.length;i<n;i++)t=r[i],mc.tweeners[t]=mc.tweeners[t]||[],mc.tweeners[t].unshift(e)},prefilters:[u4],prefilter:function(r,e){e?mc.prefilters.unshift(r):mc.prefilters.push(r)}});I.speed=function(r,e,t){var i=r&&typeof r=="object"?I.extend({},r):{complete:t||!t&&e||ri(r)&&r,duration:r,easing:t&&e||e&&!ri(e)&&e};return I.fx.off?i.duration=0:typeof i.duration!="number"&&(i.duration in I.fx.speeds?i.duration=I.fx.speeds[i.duration]:i.duration=I.fx.speeds._default),(i.queue==null||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){ri(i.old)&&i.old.call(this),i.queue&&I.dequeue(this,i.queue)},i};I.fn.extend({fadeTo:function(r,e,t,i){return this.filter(KC).css("opacity",0).show().end().animate({opacity:e},r,t,i)},animate:function(r,e,t,i){var n=I.isEmptyObject(r),o=I.speed(e,t,i),s=function(){var a=mc(this,I.extend({},r),o);(n||Jt.get(this,"finish"))&&a.stop(!0)};return s.finish=s,n||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(r,e,t){var i=function(n){var o=n.stop;delete n.stop,o(t)};return typeof r!="string"&&(t=e,e=r,r=void 0),e&&this.queue(r||"fx",[]),this.each(function(){var n=!0,o=r!=null&&r+"queueHooks",s=I.timers,a=Jt.get(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&d4.test(o)&&i(a[o]);for(o=s.length;o--;)s[o].elem===this&&(r==null||s[o].queue===r)&&(s[o].anim.stop(t),n=!1,s.splice(o,1));(n||!t)&&I.dequeue(this,r)})},finish:function(r){return r!==!1&&(r=r||"fx"),this.each(function(){var e,t=Jt.get(this),i=t[r+"queue"],n=t[r+"queueHooks"],o=I.timers,s=i?i.length:0;for(t.finish=!0,I.queue(this,r,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===r&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete t.finish})}});I.each(["toggle","show","hide"],function(r,e){var t=I.fn[e];I.fn[e]=function(i,n,o){return i==null||typeof i=="boolean"?t.apply(this,arguments):this.animate(OC(e,!0),i,n,o)}});I.each({slideDown:OC("show"),slideUp:OC("hide"),slideToggle:OC("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(r,e){I.fn[r]=function(t,i,n){return this.animate(e,t,i,n)}});I.timers=[];I.fx.tick=function(){var r,e=0,t=I.timers;for(lm=Date.now();e<t.length;e++)r=t[e],!r()&&t[e]===r&&t.splice(e--,1);t.length||I.fx.stop(),lm=void 0};I.fx.timer=function(r){I.timers.push(r),I.fx.start()};I.fx.interval=13;I.fx.start=function(){NC||(NC=!0,eT())};I.fx.stop=function(){NC=null};I.fx.speeds={slow:600,fast:200,_default:400};I.fn.delay=function(r,e){return r=I.fx&&I.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(t,i){var n=window.setTimeout(t,r);i.stop=function(){window.clearTimeout(n)}})};(function(){var r=mi.createElement("input"),e=mi.createElement("select"),t=e.appendChild(mi.createElement("option"));r.type="checkbox",wn.checkOn=r.value!=="",wn.optSelected=t.selected,r=mi.createElement("input"),r.value="t",r.type="radio",wn.radioValue=r.value==="t"})();ob=I.expr.attrHandle;I.fn.extend({attr:function(r,e){return cu(this,I.attr,r,e,arguments.length>1)},removeAttr:function(r){return this.each(function(){I.removeAttr(this,r)})}});I.extend({attr:function(r,e,t){var i,n,o=r.nodeType;if(!(o===3||o===8||o===2)){if(typeof r.getAttribute=="undefined")return I.prop(r,e,t);if((o!==1||!I.isXMLDoc(r))&&(n=I.attrHooks[e.toLowerCase()]||(I.expr.match.bool.test(e)?CP:void 0)),t!==void 0){if(t===null){I.removeAttr(r,e);return}return n&&"set"in n&&(i=n.set(r,t,e))!==void 0?i:(r.setAttribute(e,t+""),t)}return n&&"get"in n&&(i=n.get(r,e))!==null?i:(i=I.find.attr(r,e),i==null?void 0:i)}},attrHooks:{type:{set:function(r,e){if(!wn.radioValue&&e==="radio"&&Pl(r,"input")){var t=r.value;return r.setAttribute("type",e),t&&(r.value=t),e}}}},removeAttr:function(r,e){var t,i=0,n=e&&e.match(cp);if(n&&r.nodeType===1)for(;t=n[i++];)r.removeAttribute(t)}});CP={set:function(r,e,t){return e===!1?I.removeAttr(r,t):r.setAttribute(t,t),t}};I.each(I.expr.match.bool.source.match(/\w+/g),function(r,e){var t=ob[e]||I.find.attr;ob[e]=function(i,n,o){var s,a,l=n.toLowerCase();return o||(a=ob[l],ob[l]=s,s=t(i,n,o)!=null?l:null,ob[l]=a),s}});h4=/^(?:input|select|textarea|button)$/i,g4=/^(?:a|area)$/i;I.fn.extend({prop:function(r,e){return cu(this,I.prop,r,e,arguments.length>1)},removeProp:function(r){return this.each(function(){delete this[I.propFix[r]||r]})}});I.extend({prop:function(r,e,t){var i,n,o=r.nodeType;if(!(o===3||o===8||o===2))return(o!==1||!I.isXMLDoc(r))&&(e=I.propFix[e]||e,n=I.propHooks[e]),t!==void 0?n&&"set"in n&&(i=n.set(r,t,e))!==void 0?i:r[e]=t:n&&"get"in n&&(i=n.get(r,e))!==null?i:r[e]},propHooks:{tabIndex:{get:function(r){var e=I.find.attr(r,"tabindex");return e?parseInt(e,10):h4.test(r.nodeName)||g4.test(r.nodeName)&&r.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}});wn.optSelected||(I.propHooks.selected={get:function(r){var e=r.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(r){var e=r.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}});I.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){I.propFix[this.toLowerCase()]=this});I.fn.extend({addClass:function(r){var e,t,i,n,o,s,a,l=0;if(ri(r))return this.each(function(c){I(this).addClass(r.call(this,c,Gh(this)))});if(e=YV(r),e.length){for(;t=this[l++];)if(n=Gh(t),i=t.nodeType===1&&" "+im(n)+" ",i){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=im(i),n!==a&&t.setAttribute("class",a)}}return this},removeClass:function(r){var e,t,i,n,o,s,a,l=0;if(ri(r))return this.each(function(c){I(this).removeClass(r.call(this,c,Gh(this)))});if(!arguments.length)return this.attr("class","");if(e=YV(r),e.length){for(;t=this[l++];)if(n=Gh(t),i=t.nodeType===1&&" "+im(n)+" ",i){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");a=im(i),n!==a&&t.setAttribute("class",a)}}return this},toggleClass:function(r,e){var t=typeof r,i=t==="string"||Array.isArray(r);return typeof e=="boolean"&&i?e?this.addClass(r):this.removeClass(r):ri(r)?this.each(function(n){I(this).toggleClass(r.call(this,n,Gh(this),e),e)}):this.each(function(){var n,o,s,a;if(i)for(o=0,s=I(this),a=YV(r);n=a[o++];)s.hasClass(n)?s.removeClass(n):s.addClass(n);else(r===void 0||t==="boolean")&&(n=Gh(this),n&&Jt.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",n||r===!1?"":Jt.get(this,"__className__")||""))})},hasClass:function(r){var e,t,i=0;for(e=" "+r+" ";t=this[i++];)if(t.nodeType===1&&(" "+im(Gh(t))+" ").indexOf(e)>-1)return!0;return!1}});m4=/\r/g;I.fn.extend({val:function(r){var e,t,i,n=this[0];return arguments.length?(i=ri(r),this.each(function(o){var s;this.nodeType===1&&(i?s=r.call(this,o,I(this).val()):s=r,s==null?s="":typeof s=="number"?s+="":Array.isArray(s)&&(s=I.map(s,function(a){return a==null?"":a+""})),e=I.valHooks[this.type]||I.valHooks[this.nodeName.toLowerCase()],(!e||!("set"in e)||e.set(this,s,"value")===void 0)&&(this.value=s))})):n?(e=I.valHooks[n.type]||I.valHooks[n.nodeName.toLowerCase()],e&&"get"in e&&(t=e.get(n,"value"))!==void 0?t:(t=n.value,typeof t=="string"?t.replace(m4,""):t==null?"":t)):void 0}});I.extend({valHooks:{option:{get:function(r){var e=I.find.attr(r,"value");return e!=null?e:im(I.text(r))}},select:{get:function(r){var e,t,i,n=r.options,o=r.selectedIndex,s=r.type==="select-one",a=s?null:[],l=s?o+1:n.length;for(o<0?i=l:i=s?o:0;i<l;i++)if(t=n[i],(t.selected||i===o)&&!t.disabled&&(!t.parentNode.disabled||!Pl(t.parentNode,"optgroup"))){if(e=I(t).val(),s)return e;a.push(e)}return a},set:function(r,e){for(var t,i,n=r.options,o=I.makeArray(e),s=n.length;s--;)i=n[s],(i.selected=I.inArray(I.valHooks.option.get(i),o)>-1)&&(t=!0);return t||(r.selectedIndex=-1),o}}}});I.each(["radio","checkbox"],function(){I.valHooks[this]={set:function(r,e){if(Array.isArray(e))return r.checked=I.inArray(I(r).val(),e)>-1}},wn.checkOn||(I.valHooks[this].get=function(r){return r.getAttribute("value")===null?"on":r.value})});wn.focusin="onfocusin"in window;eP=/^(?:focusinfocus|focusoutblur)$/,tP=function(r){r.stopPropagation()};I.extend(I.event,{trigger:function(r,e,t,i){var n,o,s,a,l,c,u,p,g=[t||mi],h=_C.call(r,"type")?r.type:r,b=_C.call(r,"namespace")?r.namespace.split("."):[];if(o=p=s=t=t||mi,!(t.nodeType===3||t.nodeType===8)&&!eP.test(h+I.event.triggered)&&(h.indexOf(".")>-1&&(b=h.split("."),h=b.shift(),b.sort()),l=h.indexOf(":")<0&&"on"+h,r=r[I.expando]?r:new I.Event(h,typeof r=="object"&&r),r.isTrigger=i?2:3,r.namespace=b.join("."),r.rnamespace=r.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,r.result=void 0,r.target||(r.target=t),e=e==null?[r]:I.makeArray(e,[r]),u=I.event.special[h]||{},!(!i&&u.trigger&&u.trigger.apply(t,e)===!1))){if(!i&&!u.noBubble&&!am(t)){for(a=u.delegateType||h,eP.test(a+h)||(o=o.parentNode);o;o=o.parentNode)g.push(o),s=o;s===(t.ownerDocument||mi)&&g.push(s.defaultView||s.parentWindow||window)}for(n=0;(o=g[n++])&&!r.isPropagationStopped();)p=o,r.type=n>1?a:u.bindType||h,c=(Jt.get(o,"events")||Object.create(null))[r.type]&&Jt.get(o,"handle"),c&&c.apply(o,e),c=l&&o[l],c&&c.apply&&ab(o)&&(r.result=c.apply(o,e),r.result===!1&&r.preventDefault());return r.type=h,!i&&!r.isDefaultPrevented()&&(!u._default||u._default.apply(g.pop(),e)===!1)&&ab(t)&&l&&ri(t[h])&&!am(t)&&(s=t[l],s&&(t[l]=null),I.event.triggered=h,r.isPropagationStopped()&&p.addEventListener(h,tP),t[h](),r.isPropagationStopped()&&p.removeEventListener(h,tP),I.event.triggered=void 0,s&&(t[l]=s)),r.result}},simulate:function(r,e,t){var i=I.extend(new I.Event,t,{type:r,isSimulated:!0});I.event.trigger(i,null,e)}});I.fn.extend({trigger:function(r,e){return this.each(function(){I.event.trigger(r,e,this)})},triggerHandler:function(r,e){var t=this[0];if(t)return I.event.trigger(r,e,t,!0)}});wn.focusin||I.each({focus:"focusin",blur:"focusout"},function(r,e){var t=function(i){I.event.simulate(e,i.target,I.event.fix(i))};I.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,n=Jt.access(i,e);n||i.addEventListener(r,t,!0),Jt.access(i,e,(n||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,n=Jt.access(i,e)-1;n?Jt.access(i,e,n):(i.removeEventListener(r,t,!0),Jt.remove(i,e))}}});Zte=window.location,ere={guid:Date.now()};I.parseXML=function(r){var e,t;if(!r||typeof r!="string")return null;try{e=new window.DOMParser().parseFromString(r,"text/xml")}catch(i){}return t=e&&e.getElementsByTagName("parsererror")[0],(!e||t)&&I.error("Invalid XML: "+(t?I.map(t.childNodes,function(i){return i.textContent}).join(`
`):r)),e};f4=/\[\]$/,rP=/\r?\n/g,y4=/^(?:submit|button|image|reset|file)$/i,b4=/^(?:input|select|textarea|keygen)/i;I.param=function(r,e){var t,i=[],n=function(o,s){var a=ri(s)?s():s;i[i.length]=encodeURIComponent(o)+"="+encodeURIComponent(a==null?"":a)};if(r==null)return"";if(Array.isArray(r)||r.jquery&&!I.isPlainObject(r))I.each(r,function(){n(this.name,this.value)});else for(t in r)tT(t,r[t],e,n);return i.join("&")};I.fn.extend({serialize:function(){return I.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var r=I.prop(this,"elements");return r?I.makeArray(r):this}).filter(function(){var r=this.type;return this.name&&!I(this).is(":disabled")&&b4.test(this.nodeName)&&!y4.test(r)&&(this.checked||!sb.test(r))}).map(function(r,e){var t=I(this).val();return t==null?null:Array.isArray(t)?I.map(t,function(i){return{name:e.name,value:i.replace(rP,`\r
`)}}):{name:e.name,value:t.replace(rP,`\r
`)}}).get()}});I.fn.extend({wrapAll:function(r){var e;return this[0]&&(ri(r)&&(r=r.call(this[0])),e=I(r,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(r){return ri(r)?this.each(function(e){I(this).wrapInner(r.call(this,e))}):this.each(function(){var e=I(this),t=e.contents();t.length?t.wrapAll(r):e.append(r)})},wrap:function(r){var e=ri(r);return this.each(function(t){I(this).wrapAll(e?r.call(this,t):r)})},unwrap:function(r){return this.parent(r).not("body").each(function(){I(this).replaceWith(this.childNodes)}),this}});I.expr.pseudos.hidden=function(r){return!I.expr.pseudos.visible(r)};I.expr.pseudos.visible=function(r){return!!(r.offsetWidth||r.offsetHeight||r.getClientRects().length)};wn.createHTMLDocument=function(){var r=mi.implementation.createHTMLDocument("").body;return r.innerHTML="<form></form><form></form>",r.childNodes.length===2}();I.parseHTML=function(r,e,t){if(typeof r!="string")return[];typeof e=="boolean"&&(t=e,e=!1);var i,n,o;return e||(wn.createHTMLDocument?(e=mi.implementation.createHTMLDocument(""),i=e.createElement("base"),i.href=mi.location.href,e.head.appendChild(i)):e=mi),n=dP.exec(r),o=!t&&[],n?[e.createElement(n[1])]:(n=fP([r],e,o),o&&o.length&&I(o).remove(),I.merge([],n.childNodes))};I.expr.pseudos.animated=function(r){return I.grep(I.timers,function(e){return r===e.elem}).length};I.offset={setOffset:function(r,e,t){var i,n,o,s,a,l,c,u=I.css(r,"position"),p=I(r),g={};u==="static"&&(r.style.position="relative"),a=p.offset(),o=I.css(r,"top"),l=I.css(r,"left"),c=(u==="absolute"||u==="fixed")&&(o+l).indexOf("auto")>-1,c?(i=p.position(),s=i.top,n=i.left):(s=parseFloat(o)||0,n=parseFloat(l)||0),ri(e)&&(e=e.call(r,t,I.extend({},a))),e.top!=null&&(g.top=e.top-a.top+s),e.left!=null&&(g.left=e.left-a.left+n),"using"in e?e.using.call(r,g):p.css(g)}};I.fn.extend({offset:function(r){if(arguments.length)return r===void 0?this:this.each(function(n){I.offset.setOffset(this,r,n)});var e,t,i=this[0];if(i)return i.getClientRects().length?(e=i.getBoundingClientRect(),t=i.ownerDocument.defaultView,{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var r,e,t,i=this[0],n={top:0,left:0};if(I.css(i,"position")==="fixed")e=i.getBoundingClientRect();else{for(e=this.offset(),t=i.ownerDocument,r=i.offsetParent||t.documentElement;r&&(r===t.body||r===t.documentElement)&&I.css(r,"position")==="static";)r=r.parentNode;r&&r!==i&&r.nodeType===1&&(n=I(r).offset(),n.top+=I.css(r,"borderTopWidth",!0),n.left+=I.css(r,"borderLeftWidth",!0))}return{top:e.top-n.top-I.css(i,"marginTop",!0),left:e.left-n.left-I.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var r=this.offsetParent;r&&I.css(r,"position")==="static";)r=r.offsetParent;return r||Ih})}});I.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(r,e){var t=e==="pageYOffset";I.fn[r]=function(i){return cu(this,function(n,o,s){var a;if(am(n)?a=n:n.nodeType===9&&(a=n.defaultView),s===void 0)return a?a[e]:n[o];a?a.scrollTo(t?a.pageXOffset:s,t?s:a.pageYOffset):n[o]=s},r,i,arguments.length)}});I.each(["top","left"],function(r,e){I.cssHooks[e]=bP(wn.pixelPosition,function(t,i){if(i)return i=lb(t,e),oT.test(i)?I(t).position()[e]+"px":i})});I.each({Height:"height",Width:"width"},function(r,e){I.each({padding:"inner"+r,content:e,"":"outer"+r},function(t,i){I.fn[i]=function(n,o){var s=arguments.length&&(t||typeof n!="boolean"),a=t||(n===!0||o===!0?"margin":"border");return cu(this,function(l,c,u){var p;return am(l)?i.indexOf("outer")===0?l["inner"+r]:l.document.documentElement["client"+r]:l.nodeType===9?(p=l.documentElement,Math.max(l.body["scroll"+r],p["scroll"+r],l.body["offset"+r],p["offset"+r],p["client"+r])):u===void 0?I.css(l,c,a):I.style(l,c,u,a)},e,s?n:void 0,s)}})});I.fn.extend({bind:function(r,e,t){return this.on(r,null,e,t)},unbind:function(r,e){return this.off(r,null,e)},delegate:function(r,e,t,i){return this.on(e,r,t,i)},undelegate:function(r,e,t){return arguments.length===1?this.off(r,"**"):this.off(e,r||"**",t)},hover:function(r,e){return this.mouseenter(r).mouseleave(e||r)}});I.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(r,e){I.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}});w4=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;I.proxy=function(r,e){var t,i,n;if(typeof e=="string"&&(t=r[e],e=r,r=t),!!ri(r))return i=lp.call(arguments,2),n=function(){return r.apply(e||this,i.concat(lp.call(arguments)))},n.guid=r.guid=r.guid||I.guid++,n};I.holdReady=function(r){r?I.readyWait++:I.ready(!0)};I.isArray=Array.isArray;I.parseJSON=JSON.parse;I.nodeName=Pl;I.isFunction=ri;I.isWindow=am;I.camelCase=ud;I.type=cm;I.now=Date.now;I.isNumeric=function(r){var e=I.type(r);return(e==="number"||e==="string")&&!isNaN(r-parseFloat(r))};I.trim=function(r){return r==null?"":(r+"").replace(w4,"")};x4=window.jQuery,v4=window.$;I.noConflict=function(r){return window.$===I&&(window.$=v4),r&&window.jQuery===I&&(window.jQuery=x4),I};typeof noGlobal=="undefined"&&(window.jQuery=window.$=I);O=I});var Gs,uu=__dcg_shared_module_exports__['e'](()=>{Gs=()=>{let r="";try{r=location.search,r[0]=="?"&&(r=r.slice(1))}catch(i){}let e=r.split("&"),t={};for(let i of e){let n=i.split("=");n.length==2?t[n[0]]=decodeURIComponent(n[1]):t[n[0]]=!0}return t}});function Lz(r,e){if(e!=null){if(typeof r!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof e!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount:function(t){t[r.toLowerCase()]=function(i){i&&e.apply(this,arguments)}}}}}}var aN,lN=__dcg_shared_module_exports__['e'](()=>{aN=Lz});function Oz(r){var e=function(){return r};return e.isDCGViewConst=!0,e}function Pz(r){return!!(typeof r=="function"&&r.isDCGViewConst)}var Fo,Mc=__dcg_shared_module_exports__['e'](()=>{Fo={isConst:Pz,makeConst:Oz}});function _z(r,e,t){t===void 0?r.removeAttribute(e):r.setAttribute(e,t+"")}var PS,VM=__dcg_shared_module_exports__['e'](()=>{PS={update:_z}});function Fz(r,e){var t=e(),i;return Fo.isConst(e)||(i={onUpdate:function(n){var o=e();o!==t&&(t=o,PS.update(n,r,o))}}),{value:t,bindings:i}}var cN,dN=__dcg_shared_module_exports__['e'](()=>{Mc();VM();cN=Fz});function Rz(r){return r[0]==="o"&&r[1]==="n"&&r[2].toUpperCase()===r[2]}var uN,pN=__dcg_shared_module_exports__['e'](()=>{uN=Rz});function Nz(r,e){TM[r]=e}function Bz(r){return TM.hasOwnProperty(r)}function Kz(r,e){var t=TM[r];return t(e)}var TM,pw,MM=__dcg_shared_module_exports__['e'](()=>{TM={};pw={isCustomAttribute:Bz,add:Nz,parse:Kz}});function Uz(r,e,t){var i=r._bindings[e];i?i.push(t):r._bindings[e]=[t]}function Hz(r,e){var t=r._bindings[e];if(t)for(var i=t.length,n=0;n<i;n++)t[n]()}var Ca,hw=__dcg_shared_module_exports__['e'](()=>{Ca={add:Uz,invoke:Hz}});function qz(r){uf.push(r)}function zz(r){var e=uf;uf=[];for(var t=0;t<e.length;t++){var i=e[t];i!==r&&uf.push(i)}}function $z(r,e){try{if(e&&e._isDCGView){r+=" ["+e._viewName+"]";var t=e.traceViewHierarchy();t.ancestors.length>0&&(r+=`
View Hierarchy:
`+t.formatted)}throw new Error(r)}catch(n){console.warn(n);for(var i=0;i<uf.length;i++)uf[i](n)}}var uf,Dd,gw=__dcg_shared_module_exports__['e'](()=>{uf=[];Dd={warn:$z,addWarningHandler:qz,removeWarningHandler:zz}});function Jz(r,e,t){var i=!1;return function(){if(i){Dd.warn(r+" is a one-time binding but was called multiple times",t);return}i=!0,e.apply(this,arguments)}}function Yz(r,e,t){var i=t.bindings;if(i)for(var n in i){var o=i[n];n in Wz&&(o=o.bind(null,e)),n in jz&&(o=Jz(n,o,r)),Ca.add(r,n,o)}}function Xz(r,e){if(typeof e!="function")throw new Error('The "'+r+'" attr must be a function. It is: '+JSON.stringify(e));return pw.isCustomAttribute(r)?pw.parse(r,e):uN(r)?aN(r,e):cN(r,e)}function Qz(r,e,t){if(e)for(var i in e){var n=Xz(i,e[i]);if(n){var o=n.value;o!==void 0&&t.setAttribute(i,o),n.bindings&&Yz(r,t,n)}}}var Wz,jz,hN,gN=__dcg_shared_module_exports__['e'](()=>{lN();dN();pN();MM();hw();gw();Wz={onMount:!0,didMount:!0,willUnmount:!0,willUpdate:!0,onUpdate:!0,didUpdate:!0},jz={willMount:!0,onMount:!0,didMount:!0,willUnmount:!0,onUnmount:!0,didUnmount:!0};hN=Qz});function Zz(){mN=!0}function e7(r,e,t){if(typeof t!="function")throw new Error("bindText expects a function");var i=t();i==null&&(i="");var n=document.createTextNode(i);if(mN){var o=document.createElement("span");o.appendChild(n),e.appendChild(o)}else e.appendChild(n);Ca.add(r,"onUpdate",function(){var s=t();s==null&&(s=""),i!==s&&(n.nodeValue=s,i=s)})}var mN,_S,AM=__dcg_shared_module_exports__['e'](()=>{hw();mN=!1;_S={bindText:e7,enableSpanWrapping:Zz}});function fN(r,e){var t=document.createTextNode(e);r.appendChild(t)}function LM(r,e,t){if(this.tagName=r,this.attrs=e,this.children=t,Array.isArray(this.children))for(var i=0;i<this.children.length;i++){var n=typeof this.children[i];n!=="object"&&n!=="function"||(this.children[i]._parentElement=this)}}var t7,yN,bN=__dcg_shared_module_exports__['e'](()=>{gN();AM();Mc();gw();t7=_S.bindText;LM.prototype._isDCGElement=!0;LM.prototype.renderToDocFrag=function(r,e){if(this._domNode)throw new Error("Cannot remount a DCGElement");var t=this.children,i=document.createElement(this.tagName);this._domNode=i,hN(e,this.attrs,i),r.appendChild(i);for(var n=t.length,o=0;o<n;o++){var s=t[o];s._isDCGElement?s.renderToDocFrag(i,e):Fo.isConst(s)?fN(i,s()):typeof s=="function"?t7(e,i,s):(Dd.warn("Text should be a const or a getter: "+JSON.stringify(s),e),fN(i,s))}};yN=LM});function wN(r,e){if(r!=null)if(Array.isArray(r))for(var t=0;t<r.length;t++)wN(r[t],e);else e.push(r)}function r7(r,e){for(var t=[],i=arguments.length-1,n=2;n<=i;n++)wN(arguments[n],t);if(typeof r=="string")return new yN(r,e,t);if(r&&r._isDCGViewClass)return new r(e,t);throw new Error("createElement expects a String or DCGViewClass")}var Sd,pf=__dcg_shared_module_exports__['e'](()=>{bN();Sd=r7});function i7(){for(var r=this._element;r._isDCGView;)r=r._element;return r._domNode}function n7(r,e){if(e&&e._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");if(this.__generatedHTMLBefore=!0,this._element.renderToDocFrag(r,this),Array.isArray(this._siblingElements))for(var t=0;t<this._siblingElements.length;t++)this._siblingElements[t].renderToDocFrag(r,this)}function o7(r,e,t){if(!r||!r._isDCGViewClass)throw new Error("Must pass a DCGView class to be mounted");if(!e||e.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(e._mountedDCGView)throw new Error("This node is already mounted by a view");var i=new r(t),n=document.createDocumentFragment();return i.renderToDocFrag(n),e.innerHTML="",OM(i),e._mountedDCGView=i,e.appendChild(n),PM(i),_M(i),i}function s7(r){var e=r._mountedDCGView;if(!e)throw new Error("This node is not mounted by a DCGView");FM(e),r.innerHTML="",delete r._mountedDCGView,RM(e),NM(e)}function OM(r){r.willMount&&r.willMount(),Ca.invoke(r,"willMount"),r._childViews.forEach(OM)}function PM(r){r._isMounted=!0,r.onMount&&r.onMount(),Ca.invoke(r,"onMount"),r._childViews.forEach(PM)}function _M(r){r.didMount&&r.didMount(),Ca.invoke(r,"didMount"),r._childViews.forEach(_M)}function FM(r){r.willUnmount&&r.willUnmount(),Ca.invoke(r,"willUnmount"),r._childViews.forEach(FM)}function RM(r){r._isMounted=!1,r._childViews.forEach(RM),Ca.invoke(r,"onUnmount"),r.onUnmount&&r.onUnmount()}function NM(r){r._childViews.forEach(NM),Ca.invoke(r,"didUnmount"),r.didUnmount&&r.didUnmount()}function a7(r,e){var t=document.createDocumentFragment();return r.renderToDocFrag(t,e),t.firstChild}var cr,Lp=__dcg_shared_module_exports__['e'](()=>{hw();cr={renderToDocFrag:n7,findRootNode:i7,createNodeForView:a7,willMount:OM,onMount:PM,didMount:_M,willUnmount:FM,onUnmount:RM,didUnmount:NM,mountToNode:o7,unmountFromNode:s7}});function l7(){if(!this._isMounted)return Dd.warn("Trying to update view that is not mounted. Ignoring update.",this);if(!(this.shouldUpdate&&!this.shouldUpdate())){if(this.willUpdate&&this.willUpdate(),Ca.invoke(this,"willUpdate"),Ca.invoke(this,"onUpdate"),this.onUpdate&&this.onUpdate(),this.overrideChildUpdates)this.overrideChildUpdates();else for(var r=this._childViews,e=r.length,t=0;t<e;t++)r[t].update();Ca.invoke(this,"didUpdate"),this.didUpdate&&this.didUpdate()}}var xN,vN=__dcg_shared_module_exports__['e'](()=>{hw();gw();xN={update:l7}});function c7(r){var e=arguments.length;if(e<2)return r;for(var t=1;t<e;t++)for(var i=arguments[t],n=Object.keys(i),o=n.length,s=0;s<o;s++){var a=n[s];r[a]=i[a]}return r}var Ed,hf=__dcg_shared_module_exports__['e'](()=>{Ed=c7});function d7(r){if(!r)throw new Error("must pass a spec to DCGView.createClass");if(typeof r.template!="function")throw new Error("must pass a template function to DCGView.createClass");var e=function(i,n){this._viewName=r.viewName||(this.constructor?this.constructor.name:"Anonymous DCGView"),this._setupProps(i,n),this.init&&this.init(),this._callTemplate()};e.prototype._setupProps=function(i,n){if(i){for(var o in i){var s=i[o];if(typeof s!="function"&&s!==void 0)throw new Error('The "'+o+'" prop must be a function. It is: '+JSON.stringify(s))}this.props=i}else this.props={};this.children=n,this._childViews=[],this._bindings={}},e.prototype._callTemplate=function(){if(this._element=this.template(),!this._element||!this._element._isDCGElement)throw new Error("template() must return a DCGElement");this._element._parentElement=this},e.prototype.bindFn=function(i){return i.bind(this)},e.prototype.findRootNode=cr.findRootNode,e.prototype.renderToDocFrag=cr.renderToDocFrag,e.prototype.const=Fo.makeConst,e.prototype.spread=Ed,e.prototype.createElement=Sd,e.prototype.update=xN.update,e.prototype.traceViewHierarchy=function(){for(var i=[],n=this._parentElement;n;n=n._parentElement)i.unshift(n);var o=i.concat([this]).filter(function(s){return!(!s._isDCGView||s._isDCGSwitch&&s._parentElement&&s._parentElement._isDCGIf||s._isDCGIfDefinedWrapper||s._isDCGSwitchWrapper||s._isDCGSwitchUnionWrapper)}).map(function(s,a){for(var l="";a-- >0;)l+="  ";return l+"<"+s._viewName+">"}).join(`
`);return{ancestors:i,formatted:o}};for(var t in r)if(r.hasOwnProperty(t))if(!e.prototype.hasOwnProperty(t))e.prototype[t]=r[t];else throw new Error("Cannot override the "+t+"() method");return e._isDCGViewClass=!0,e.prototype._isDCGView=!0,e.prototype._isDCGElement=!0,e}var mn,Hl=__dcg_shared_module_exports__['e'](()=>{pf();Lp();vN();Mc();hf();mn=d7});function CN(r){var e=r(),t=typeof e;if(t==="string")return e;if(!t||t!=="object")throw new Error("Unsupported type returned from style getter: "+t);var i="";for(var n in e){var o=e[n];e.hasOwnProperty(n)&&o!=null&&(i?i+=";"+n+":"+o:i=n+":"+o)}return i}function u7(r){var e,t=CN(r);return Fo.isConst(r)||(e={onUpdate:function(i){var n=CN(r);t!==n&&(PS.update(i,"style",n),t=n)}}),{value:t,bindings:e}}var DN,SN=__dcg_shared_module_exports__['e'](()=>{Mc();VM();DN=u7});function EN(r){var e=r(),t=typeof e;if(t==="string")return e;if(!t||t!=="object")throw new Error("Unsupported type returned from class getter: "+t);var i="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];o&&(i?i+=" "+n:i=n)}return i}function p7(r,e,t){for(var i=[],n=r.className.replace(kN,"").split(GN),o=e.replace(kN,"").split(GN),s={},a=o.length-1;a>=0;a--)s[o[a]]=!0;var l=n.length;for(a=0;a<l;a++){var c=n[a];s.hasOwnProperty(c)||i.push(c)}return t?i.length?t+" "+i.join(" "):t:i.join(" ")}function h7(r){var e,t=EN(r);return Fo.isConst(r)||(e={onUpdate:function(i){var n=EN(r);t!==n&&(i.className===t?(i.className=n,t=n):(i.className=p7(i,t,n),t=n))}}),{value:t,bindings:e}}var kN,GN,IN,VN=__dcg_shared_module_exports__['e'](()=>{Mc();kN=/^\s+|\s+$/g,GN=/\s+/;IN=h7});function g7(r){return function(e){if(typeof e!="function")throw new Error("The "+r+" attribute expects a function for the value");if(Fo.isConst(e))throw new Error("The "+r+" attribute does not expect a const for the value");var t={bindings:{}};return t.bindings[r]=e,t}}var kd,TN=__dcg_shared_module_exports__['e'](()=>{Mc();kd=g7});function MN(r){var e=r.length,t=new Array(e),i=new Array(e+1),n=0,o,s;for(s=0;s<e;s++){if(r[i[n]]<r[s])o=n+1;else{for(var a=1,l=n-1;a<=l;){var c=Math.ceil((a+l)/2);r[i[c]]<r[s]?a=c+1:l=c-1}o=a}t[s]=i[o-1],i[o]=s,o>n&&(n=o)}var u=new Array(n),p=i[n];for(s=n-1;s>=0;s--)u[s]=r[p],p=t[p];return u}var AN=__dcg_shared_module_exports__['e'](()=>{});function m7(r,e){var t={},i,n,o=[],s=[];for(i=0;i<e.length;i++)n=e[i],t[n]=i;for(i=0;i<r.length;i++)n=r[i],t[n]===void 0&&o.push(n);var a=[];for(i=0;i<r.length;i++){n=r[i];var l=t[n];l!==void 0&&a.push(l)}var c=MN(a),u={};for(i=0;i<c.length;i++)n=e[c[i]],u[n]=!0;for(i=e.length-1;i>=0;i--)n=e[i],!u[n]&&s.push({key:n,beforeKey:e[i+1]});return{removes:o,inserts:s}}var FS,BM=__dcg_shared_module_exports__['e'](()=>{AN();FS=m7});function w7(r,e){return Sd(b7,{items:r,keyFunction:e.key,viewFunction:e.item})}var f7,y7,b7,LN,ON=__dcg_shared_module_exports__['e'](()=>{Hl();BM();pf();Lp();f7=mn({viewName:"EachPlaceholder",_isDCGEachPlaceholder:!0,template:function(){return this.createElement("div",{style:this.const("display: none")})}}),y7=mn({viewName:"EachWrapper",_isDCGEachWrapper:!0,template:function(){return this.children[0]}}),b7=mn({viewName:"Each",_isDCGEach:!0,getKeys:function(){this._keyToItem={};var r=this.props.items(),e=this.props.keyFunction?r.map(this.props.keyFunction):r.slice(0);if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error("The key: "+JSON.stringify(e[0])+" is not a string or number");for(var t=0;t<e.length;t++){var i=e[t];if(typeof i!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(i)+" is not a "+this._chosenKeyType);if(i in this._keyToItem)throw new Error("The key: "+JSON.stringify(i)+" is not unique");this._keyToItem[i]=r[t]}return e},createViewForKey:function(r){var e=this._keyToItem[r],t=this.props.viewFunction.call(this,e,r),i=t;return i._isDCGView||(i=this.createElement(y7,null,t)),this._keyToView[r]=i,i},template:function(){this._keyToView={},this._keys=this.getKeys(),this._element=this.createElement(f7,null),this._siblingElements=[];for(var r=0;r<this._keys.length;r++){var e=this._keys[r],t=this.createViewForKey(e);t._parentElement=this._element._parentElement,this._siblingElements.push(t)}return this._element},detachAllRemovedViews:function(){for(var r=this._childViews,e=0,t=r.length,i,n=0;n<t;n++)i=r[n],i._will_be_unmounted_?e++:r[n-e]=i;r.splice(t-e,e)},overrideChildUpdates:function(){var r=this._keys,e=this.getKeys();this._keys=e;var t=this._element.findRootNode().parentNode,i,n,o,s,a,l,c=FS(r,e),u=[];for(i=c.removes.length-1;i>=0;i--)l=c.removes[i],u.push(this._keyToView[l]);for(u.forEach(cr.willUnmount),i=0;i<c.removes.length;i++)l=c.removes[i],n=this._keyToView[l],delete this._keyToView[l],n._will_be_unmounted_=!0,t.removeChild(n.findRootNode());u.length>0&&this.detachAllRemovedViews(),u.forEach(cr.onUnmount),u.forEach(cr.didUnmount);var p=[];for(i=c.inserts.length-1;i>=0;i--)l=c.inserts[i].key,l in this._keyToView||(n=this.createViewForKey(l),p.push(n),cr.createNodeForView(n,this));for(p.forEach(cr.willMount),i=0;i<c.inserts.length;i++)a=c.inserts[i],o=this._keyToView[a.key].findRootNode(),a.beforeKey!==void 0?s=this._keyToView[a.beforeKey].findRootNode():s=null,t.insertBefore(o,s);p.forEach(cr.onMount),p.forEach(cr.didMount);var g=this._childViews,h=g.length-p.length;for(i=0;i<h;i++)g[i].update()}});LN=w7});var x7,v7,PN,_N=__dcg_shared_module_exports__['e'](()=>{Hl();BM();Mc();Lp();x7=mn({viewName:"ForWrapper",template:function(){return this.children[0]}}),v7=mn({viewName:"For",_isDCGFor:!0,getKeys:function(){this._keyToItem={};var r=this.props.each();if(!Array.isArray(r))throw new Error("<For each={}> must return an array");var e=this.props.key?r.map(this.props.key):r.slice(0);if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error("The key: "+JSON.stringify(e[0])+" is not a string or number");for(var t=0;t<e.length;t++){var i=e[t];if(typeof i!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(i)+" is not a "+this._chosenKeyType);if(i in this._keyToItem)throw new Error("The key: "+JSON.stringify(i)+" is not unique");this._keyToItem[i]=r[t]}return e},createViewForKey:function(r){var e=this._keyToItem[r],t=this._viewFunction.call(this,e,r),i=t;return i._isDCGView||(i=this.createElement(x7,null,t)),this._keyToView[r]=i,i},template:function(){if(this._keyToView={},typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(this.children.length!==1)throw new Error("<For> expects a single child. You passed "+this.children.length);var r=this.children[0];if(!r||!r._isDCGElement)throw new Error("<For> expects the root node to be a DCGElement. You passed "+JSON.stringify(r));if(r._isDCGView)throw new Error("<For> expects the root node to not be a DCGView. Pass in something like <div> or <span>");if(r.children.length!==1)throw new Error("<For> expects a root node with a single child. You passed "+r.children.length);if(this._viewFunction=r.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var e=JSON.stringify(this._viewFunction);throw new Error("<For> expects a function that constructs a DCGElement. You passed "+e)}if(Fo.isConst(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");this._keys=this.getKeys();for(var t=[],i=0;i<this._keys.length;i++){var n=this._keys[i],o=this.createViewForKey(n);o._parentElement=this,t.push(o)}return r.children=t,r},detachAllRemovedViews:function(){for(var r=this._childViews,e=0,t=r.length,i,n=0;n<t;n++)i=r[n],i._will_be_unmounted_?e++:r[n-e]=i;r.splice(t-e,e)},overrideChildUpdates:function(){var r=this._keys,e=this.getKeys();this._keys=e;var t=this.findRootNode(),i,n,o,s,a,l,c=FS(r,e),u=[];for(i=c.removes.length-1;i>=0;i--)l=c.removes[i],u.push(this._keyToView[l]);for(u.forEach(cr.willUnmount),i=0;i<c.removes.length;i++)l=c.removes[i],n=this._keyToView[l],delete this._keyToView[l],n._will_be_unmounted_=!0,t.removeChild(n.findRootNode());u.length>0&&this.detachAllRemovedViews(),u.forEach(cr.onUnmount),u.forEach(cr.didUnmount);var p=[];for(i=c.inserts.length-1;i>=0;i--)l=c.inserts[i].key,l in this._keyToView||(n=this.createViewForKey(l),p.push(n),cr.createNodeForView(n,this));for(p.forEach(cr.willMount),i=0;i<c.inserts.length;i++)a=c.inserts[i],o=this._keyToView[a.key].findRootNode(),a.beforeKey!==void 0?s=this._keyToView[a.beforeKey].findRootNode():s=null,t.insertBefore(o,s);p.forEach(cr.onMount),p.forEach(cr.didMount);var g=this._childViews,h=g.length-p.length;for(i=0;i<h;i++)g[i].update()}}),PN=v7});var C7,D7,RS,KM=__dcg_shared_module_exports__['e'](()=>{Hl();Mc();Lp();C7=mn({viewName:"SwitchWrapper",_isDCGSwitchWrapper:!0,template:function(){return this.children[0]}}),D7=mn({viewName:"Switch",_isDCGSwitch:!0,updateKey:function(){this._key=this.props.key()},createView:function(){var r=this._viewFunction(this._key);r==null&&(r=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(C7,null,r);return e._parentElement=this,e},template:function(){if(this._key=void 0,typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(this.children.length!==1)throw new Error("<Switch> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var r=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+r)}if(Fo.isConst(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()},overrideChildUpdates:function(){var r=this._key;this.updateKey();var e=this._key;if(r===e)this._element.update();else{var t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),cr.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),cr.onUnmount(this._element),cr.didUnmount(this._element),this._element=this.createView();var n=cr.createNodeForView(this._element,this);cr.willMount(this._element),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),cr.onMount(this._element),cr.didMount(this._element)}}}),RS=D7});function FN(r,e,t){return Sd(E7,{getCase:function(){var i=e();return r?i&&i[r]:i},buildChildView:function(i){var n=t[i];if(n)return n(e)}})}function k7(r,e){return typeof r=="string"?FN.bind(this,r,e):FN(void 0,r,e)}var S7,E7,NS,UM=__dcg_shared_module_exports__['e'](()=>{Hl();Lp();pf();S7=mn({viewName:"SwitchUnionWrapper",_isDCGSwitchUnionWrapper:!0,template:function(){return this.children[0]}}),E7=mn({viewName:"SwitchUnion",_isDCGSwitchUnion:!0,updateCase:function(){this._case=this.props.getCase()},createView:function(){var r=this.props.buildChildView(this._case);r==null&&(r=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(S7,null,r);return e._parentElement=this,e},template:function(){return this._case=void 0,this.updateCase(),this.createView()},overrideChildUpdates:function(){var r=this._case;this.updateCase();var e=this._case;if(r===e)this._element.update();else{var t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),cr.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),cr.onUnmount(this._element),cr.didUnmount(this._element),this._element=this.createView();var n=cr.createNodeForView(this._element,this);cr.willMount(this._element),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),cr.onMount(this._element),cr.didMount(this._element)}}});NS=k7});var G7,RN,NN=__dcg_shared_module_exports__['e'](()=>{Hl();Mc();KM();G7=mn({viewName:"If",_isDCGIf:!0,template:function(){if(typeof this.props.predicate!="function")throw new Error("<If predicate={}> must be a function");if(this.children.length!==1)throw new Error("<If> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var r=JSON.stringify(this._viewFunction);throw new Error("<If> expects a function that constructs a DCGElement. You passed "+r)}if(Fo.isConst(this._viewFunction))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");var e=function(){return!!this.props.predicate()}.bind(this),t=function(i){if(i)return this._viewFunction()}.bind(this);return this.createElement(RS,{key:e},t)}}),RN=G7});function T7(r,e){return Sd(V7,{isDefined:function(){var t=r();return t!=null},buildChildView:function(){return e(r)}})}var I7,V7,BN,KN=__dcg_shared_module_exports__['e'](()=>{Hl();Lp();pf();I7=mn({viewName:"IfDefinedWrapper",_isDCGIfDefinedWrapper:!0,template:function(){return this.children[0]}}),V7=mn({viewName:"IfDefined",_isDCGIfDefined:!0,updateIsDefined:function(){this._isDefined=this.props.isDefined()},createView:function(){var r;this._isDefined&&(r=this.props.buildChildView()),r==null&&(r=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(I7,null,r);return e._parentElement=this,e},template:function(){return this._isDefined=void 0,this.updateIsDefined(),this.createView()},overrideChildUpdates:function(){var r=this._isDefined;this.updateIsDefined();var e=this._isDefined;if(r===e)this._element.update();else{var t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),cr.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),cr.onUnmount(this._element),cr.didUnmount(this._element),this._element=this.createView();var n=cr.createNodeForView(this._element,this);cr.willMount(this._element),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),cr.onMount(this._element),cr.didMount(this._element)}}});BN=T7});function M7(r,e){var t=NS(function(){return r()?"true":"false"},e);return t._viewName="IfElse",t}var UN,HN=__dcg_shared_module_exports__['e'](()=>{UM();UN=M7});var qN,zN=__dcg_shared_module_exports__['e'](()=>{Hl();hf();qN=mn({viewName:"Textarea",computeValue:function(){var r=this.props.value();return r==null?"":r+""},template:function(){if(!this.props.value)throw new Error('<Textarea> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Textarea> expects an "onInput={}" prop');var r=Ed({},this.props,{onInput:function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}.bind(this)});return this.props.disabled&&(r.disabled=function(){if(this.props.disabled())return!0}.bind(this)),delete r.value,this.createElement("textarea",r,this.const(this.computeValue()))},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeValue();this.rootDOM.value!==r&&(this.rootDOM.value=r)}})});var $N,WN=__dcg_shared_module_exports__['e'](()=>{Hl();hf();$N=mn({viewName:"Input",computeValue:function(){var r=this.props.value();return r==null?"":r+""},template:function(){if(!this.props.value)throw new Error('<Input> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Input> expects an "onInput={}" prop');var r=Ed({},this.props,{value:this.const(this.computeValue()),onInput:function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}.bind(this)});return this.props.onEnterPressed&&(r.onKeypress=function(e){e.which===13&&this.props.onEnterPressed()}.bind(this)),this.props.disabled&&(r.disabled=function(){if(this.props.disabled())return!0}.bind(this)),r.hasOwnProperty("tabindex")||(r.tabindex=function(){return this.props.disabled&&this.props.disabled()?"-1":"0"}.bind(this)),this.createElement("input",r)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeValue();this.rootDOM.value!==r&&(this.rootDOM.value=r)}})});var jN,JN=__dcg_shared_module_exports__['e'](()=>{Hl();hf();jN=mn({viewName:"Checkbox",computeChecked:function(){return!!this.props.checked()},template:function(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');var r=Ed({},this.props,{type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:function(e){this.props.onChange(e.target.checked),this._isMounted&&this.update()}.bind(this)});return this.createElement("input",r)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeChecked();this.rootDOM.checked!==r&&(this.rootDOM.checked=r)}})});var YN,XN=__dcg_shared_module_exports__['e'](()=>{ON();_N();KM();UM();NN();KN();HN();zN();WN();JN();YN={Each:LN,For:PN,Switch:RS,SwitchUnion:NS,If:RN,IfDefined:BN,IfElse:UN,Textarea:qN,Input:$N,Checkbox:jN}});var QN,ZN=__dcg_shared_module_exports__['e'](()=>{Hl();QN=mn({template:function(){}})});var A7,ql,Ac,eB=__dcg_shared_module_exports__['e'](()=>{pf();Hl();Lp();hf();Mc();MM();SN();VN();TN();XN();gw();AM();ZN();A7=_S.enableSpanWrapping,ql={createElement:Sd,createClass:mn,mountToNode:cr.mountToNode,unmountFromNode:cr.unmountFromNode,spread:Ed,const:Fo.makeConst,isConst:Fo.isConst,addCustomAttribute:pw.add,Components:YN,addWarningHandler:Dd.addWarningHandler,removeWarningHandler:Dd.removeWarningHandler,_warn:Dd.warn,enableSpanWrapping:A7,Class:QN};ql.addCustomAttribute("style",DN);ql.addCustomAttribute("class",IN);ql.addCustomAttribute("willMount",kd("willMount"));ql.addCustomAttribute("onMount",kd("onMount"));ql.addCustomAttribute("didMount",kd("didMount"));ql.addCustomAttribute("willUnmount",kd("willUnmount"));ql.addCustomAttribute("onUnmount",kd("onUnmount"));ql.addCustomAttribute("didUnmount",kd("didUnmount"));ql.addCustomAttribute("willUpdate",kd("willUpdate"));ql.addCustomAttribute("onUpdate",kd("onUpdate"));ql.addCustomAttribute("didUpdate",kd("didUpdate"));Ac=ql});function L7(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}function O7(){var r=window.Desmos&&window.Desmos.commit;return r}function P7(){var r="production";if(location&&location.hostname){var e=location.hostname,t=e.split("."),i=t.slice(0,t.length-2).join("."),n=t.slice(t.length-2).join(".");n==="desmos.com"&&(!i||i==="www"?r="production":r=i)}return r}function rB(r){if(!gf){var e=0,t=L7();gf=r({apiKey:"7f7807097671acbc4557e64bbf5eb529",maxBreadcrumbs:40,appVersion:O7(),releaseStage:P7(),consoleBreadcrumbsEnabled:!1,beforeSend:function(i){if(i.errorClass){for(let n of tB)if(i.errorClass.indexOf(n)!==-1){i.ignore();return}}if(i.errorMessage){for(let n of tB)if(i.errorMessage.indexOf(n)!==-1){i.ignore();return}}HM&&HM(i),i.isIgnored()||(e+=1,i.metaData.errorNumber=e,i.metaData.pageLoadId=t)}})}}function Yo(r,e){gf&&gf.notify(r,e)}function jh(r,e,t,i){if(e){e=__dcg_shared_module_exports__['a']({},e);for(var n in e)try{e[n]=JSON.stringify(e[n],null,2)}catch(o){e[n]="[[could not stringify]]"}}gf&&gf.leaveBreadcrumb(r,e,t,i)}function iB(r){HM=r}var gf,HM,tB,zl=__dcg_shared_module_exports__['e'](()=>{tB=["UnhandledRejection","lnrAppboy","socratic","MyAppGet","SymBrowser_","mobincube_","_avast_submit","Cannot redefine property: googletag","jcarousel","SyntaxError: Unexpected identifier 'script'","__gCrWeb.autofill.extractForms","BrowseITEXT","Can't find variable: removeAllHighlights","aAttribruteValue.parentNode.getAttribute","vid_mate_check","GetImageTagSrcFromPoint","Can't find variable: didEnterViewPort","tinyMCE is not defined"]});function vu(r,e){let i=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(r);return i?decodeURIComponent(i[1].replace(/\+/g,"%20")):null}function _7(r,e){return new RegExp("[?|&]"+e+"(=|&|;|$)").test(r)}function F7(r,e,t){if(e!==encodeURIComponent(e))throw new Error("Programming error: parameter name should be URL-safe without encoding.");let i=encodeURIComponent(t);if(r.length){let n=r.split("#"),o=/\?/.test(r)?`${n[0]}&${e}=${i}`:`${n[0]}?${e}=${i}`;return n[1]!==void 0?`${o}#${n[1]}`:o}else return`?${e}=${i}`}function R7(r,e,t){let n=new RegExp("([?|&])"+e+"=([^&;]+?)(&|#|;|$)").exec(r);if(!n)return r;let o=n[1],s=n[2],a=`${o}${e}=${s}`,l=encodeURIComponent(t),c=`${o}${e}=${l}`;return r.replace(a,c)}function BS(r,e,t){return _7(r,e)?R7(r,e,t):F7(r,e,t)}var Jh=__dcg_shared_module_exports__['e'](()=>{});function H7(r){let e=K7.exec(r);if(e){let t=e[1];return!U7.test(t)}return!1}function KS(r,e){let t=Gs(),i="";return e!==void 0?i=e:i=t.lang?""+t.lang:"",r===""||i===""||N7.test(r)||B7.test(r)||H7(r)?r:BS(r,"lang",i)}var N7,B7,K7,U7,nB=__dcg_shared_module_exports__['e'](()=>{uu();Jh();N7=/lang=[A-Za-z]+/,B7=/(cl|learn|help).desmos.com/,K7=/^(?:https?:)?(?:\/\/)?([^\s\/\?]+)/i,U7=/(^desmos\.com$)|(\.desmos.com$)/});var oB=__dcg_shared_module_exports__['e'](()=>{});var X=__dcg_shared_module_exports__['f']((Rle,sB)=>{eB();ct();zl();nB();oB();Ac.addWarningHandler(r=>Yo(r));Ac.addCustomAttribute("href",function(r){let e=KS(r()),t={value:`${KS(r())}`,bindings:{onMount(i){if(!O(i).is("a")&&!O(i).is("use"))throw new Error("Cannot have an href on a non-link element.")}}};return t.bindings.onUpdate=function(i){let n=KS(r());e!==n&&(e=n,i.setAttribute("href",n))},t});Ac.addCustomAttribute("onTap",r=>({value:"",bindings:{onMount(e){O(e).on("dcg-tap",r)}}}));Ac.addCustomAttribute("ignoreRealClick",r=>({bindings:{onMount(e){O(e).on("click",function(t){r()&&t.preventDefault()})}}}));Ac.addCustomAttribute("onTapStart",r=>({bindings:{onMount(e){O(e).on("dcg-tapstart",r)}}}));Ac.addCustomAttribute("onTapMove",r=>({bindings:{onMount(e){O(e).on("dcg-tapmove",r)}}}));Ac.addCustomAttribute("onTapEnd",r=>({bindings:{onMount(e){O(e).on("dcg-tapend",r)}}}));Ac.addCustomAttribute("onLongHold",r=>({bindings:{onMount(e){O(e).on("dcg-longhold",r)}}}));Ac.addCustomAttribute("manageFocus",function(r){return r()===void 0?{}:{bindings:{onMount(e){r().shouldBeFocused()&&e.focus(),e.onfocus=function(t){r().shouldBeFocused()||r().onFocusedChanged(!0,t)},e.onblur=function(t){r().shouldBeFocused()&&r().onFocusedChanged(!1,t)}},onUpdate(e){let t=r().shouldBeFocused(),i=document.activeElement===e;t&&!i?e.focus():i&&!t&&e.blur()},willUnmount(e){e.onfocus=null,e.onblur=null}}}});sB.exports=Ac});var uB=__dcg_shared_module_exports__['f'](fw=>{var Dt=fw&&fw.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$S=fw&&fw.__assign||function(){return $S=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},$S.apply(this,arguments)};(function(){var r=-1,e=1,t=Math.min,i=Math.max;function n(){}function o(v,f){if(!f)throw new Error("prayer failed: "+v)}function s(v){o("a direction was passed",v===r||v===e)}function a(v){var f=document.implementation.createHTMLDocument("");if(f.body.innerHTML=v,f.body.children.length===1)return f.body.children[0];for(var d=document.createDocumentFragment();f.body.firstChild;)d.appendChild(f.body.firstChild);return d}var l=function(f,d,m){var y;switch(f){case"svg":case"path":y=document.createElementNS("http://www.w3.org/2000/svg",f);break;default:y=document.createElement(f)}for(var E in d){var F=d[E];F!==void 0&&y.setAttribute(E,typeof F=="string"?F:String(F))}if(m)for(var z=0;z<m.length;z++)y.appendChild(m[z]);return y};l.text=function(v){return document.createTextNode(v)},l.block=function(v,f,d){var m=l(v,f,[d.html()]);return d.setDOM(m),w.linkElementByBlockNode(m,d),m},l.entityText=function(v){var f=a(v);return o("entity parses to a single text node",f instanceof DocumentFragment&&f.childNodes.length===1&&f.childNodes[0]instanceof Text),f.childNodes[0]};function c(v,f){var d,m,y;if(typeof((d=v)===null||d===void 0?void 0:d.closest)=="function")return v.closest(f);if(!(v instanceof HTMLElement))return null;var E=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,F=v;do{if(E.call(F,f))return F;F=(y=(m=F==null?void 0:F.parentElement)!==null&&m!==void 0?m:F==null?void 0:F.parentNode)!==null&&y!==void 0?y:null}while(F!==null&&F.nodeType===1);return null}var u="\xA0",p="\u200B",g="\u02D9",h="\u2211",b="\u220F",C="\u2210",D="\u222B";function S(v){return v.getClientRects().length?v.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function V(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function k(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var T=function(){var v,f;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(v=requestAnimationFrame,f=cancelAnimationFrame):(v=function(d){return setTimeout(d,13)},f=clearTimeout),function(d,m){var y=Date.now(),E,F=0;function z(){var He=(Date.now()-y)/d;He<=F?ue():F=He,m(F,ue,ee)}function ee(){E!==void 0&&f(E),E=void 0}function ue(){ee(),E=v(z)}m(d<=0?1:0,ue,ee)}}(),A=function(){function v(f){this.span=l("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=f}return v.prototype.attach=function(){var f=this.controller.container;this.span.parentNode!==f&&P(f).prepend(P(this.span))},v.prototype.queue=function(f,d){d===void 0&&(d=!1);var m="";if(f instanceof Ne){var y=f.mathspeak({ignoreShorthand:!0});d&&(f.parent&&f.parent.ariaLabel&&f.ariaLabel==="block"?m=f.parent.ariaLabel+" "+y:f.ariaLabel&&(m=f.ariaLabel+" "+y)),m===""&&(m=y)}else m=f||"";return this.items.push(m),this},v.prototype.queueDirOf=function(f){return s(f),this.queue(f===r?"before":"after")},v.prototype.queueDirEndOf=function(f){return s(f),this.queue(f===r?"beginning of":"end of")},v.prototype.alert=function(f){return this.attach(),f&&this.queue(f),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},v.prototype.clear=function(){return this.items.length=0,this},v}(),R=function(){function v(f,d){var m;arguments.length===1&&(d=f),!(!f||!d)&&(this.ends=(m={},m[r]=f,m[e]=d,m))}return v.create=function(f,d){arguments.length===1&&(d=f),o("No half-empty DOMFragments",!!f==!!d);var m=new v(f,d);return o("last is a forward sibling of first",m.isValid()),m},v.prototype.isEmpty=function(){return this.ends===void 0},v.prototype.isOneNode=function(){return!!(this.ends&&this.ends[r]===this.ends[e])},v.prototype.isValid=function(){if(!this.ends||this.ends[r]===this.ends[e])return!0;var f;return this.eachNode(function(d){return f=d}),f===this.ends[e]},v.prototype.firstNode=function(){return o("Fragment is not empty",this.ends),this.ends[r]},v.prototype.lastNode=function(){return o("Fragment is not empty",this.ends),this.ends[e]},v.prototype.children=function(){var f=this.oneNode(),d=f.firstChild,m=f.lastChild;return d&&m?new v(d,m):new v},v.prototype.join=function(f){if(!this.ends)return f;if(!f.ends)return this;for(var d=!1,m=this.ends[e].nextSibling;m;){if(m===f.ends[r]){d=!0;break}m=m.nextSibling}return o("sibling must be a forward DOM sibling of this fragment",d),new v(this.ends[r],f.ends[e])},v.prototype.oneNode=function(){return o("Fragment has a single node",this.ends&&this.ends[r]===this.ends[e]),this.ends[r]},v.prototype.oneElement=function(){var f=this.oneNode();return o("Node is an Element",f.nodeType===Node.ELEMENT_NODE),f},v.prototype.oneText=function(){var f=this.oneNode();return o("Node is Text",f.nodeType===Node.TEXT_NODE),f},v.prototype.eachNode=function(f){if(!this.ends)return this;for(var d=this.ends[e],m=this.ends[r],y=void 0;m&&(y=m.nextSibling,f(m),m!==d);m=y);return this},v.prototype.eachElement=function(f){return this.eachNode(function(d){d.nodeType===Node.ELEMENT_NODE&&f(d)}),this},v.prototype.text=function(){var f="";return this.eachNode(function(d){f+=d.textContent||""}),f},v.prototype.toNodeArray=function(){var f=[];return this.eachNode(function(d){return f.push(d)}),f},v.prototype.toElementArray=function(){var f=[];return this.eachElement(function(d){return f.push(d)}),f},v.prototype.toDocumentFragment=function(){var f=document.createDocumentFragment();return this.eachNode(function(d){return f.appendChild(d)}),f},v.prototype.insertBefore=function(f){return this.insDirOf(r,f)},v.prototype.insertAfter=function(f){return this.insDirOf(e,f)},v.prototype.append=function(f){return f.appendTo(this.oneElement()),this},v.prototype.prepend=function(f){return f.prependTo(this.oneElement()),this},v.prototype.appendTo=function(f){return this.insAtDirEnd(e,f)},v.prototype.prependTo=function(f){return this.insAtDirEnd(r,f)},v.prototype.parent=function(){if(!this.ends)return this;var f=this.ends[r].parentNode;return f?new v(f):new v},v.prototype.wrapAll=function(f){if(f.textContent="",!this.ends)return this;var d=this.ends[r].parentNode,m=this.ends[e].nextSibling;return this.appendTo(f),d&&d.insertBefore(f,m),this},v.prototype.replaceWith=function(f){var d,m=(d=this.ends)===null||d===void 0?void 0:d[e],y=m==null?void 0:m.parentNode,E=m==null?void 0:m.nextSibling;this.detach();var F=f.toDocumentFragment();return!m||!y?this:(y.insertBefore(F,E||null),this)},v.prototype.nthElement=function(f){if(this.ends&&!(f<0||f!==Math.floor(f)))for(var d=this.ends[r];d;){if(d.nodeType===Node.ELEMENT_NODE){if(f<=0)return d;f-=1}if(d===this.ends[e])return;d=d.nextSibling}},v.prototype.firstElement=function(){return this.nthElement(0)},v.prototype.lastElement=function(){if(this.ends)for(var f=this.ends[e];f;){if(f.nodeType===Node.ELEMENT_NODE)return f;if(f===this.ends[r])return;f=f.previousSibling}},v.prototype.first=function(){return new v(this.firstElement())},v.prototype.last=function(){return new v(this.lastElement())},v.prototype.eq=function(f){return new v(this.nthElement(f))},v.prototype.slice=function(f){if(!this.ends)return this;var d=this.nthElement(f);return d?new v(d,this.ends[e]):new v},v.prototype.next=function(){for(var f=this.oneNode();f;)if(f=f.nextSibling,f&&f.nodeType===Node.ELEMENT_NODE)return new v(f);return new v},v.prototype.prev=function(){for(var f=this.oneNode();f;)if(f=f.previousSibling,f&&f.nodeType===Node.ELEMENT_NODE)return new v(f);return new v},v.prototype.empty=function(){return this.eachElement(function(f){f.textContent=""}),this},v.prototype.remove=function(){return this.toDocumentFragment(),this},v.prototype.detach=function(){return this.remove()},v.prototype.insDirOf=function(f,d){var m;if(!this.ends)return this;var y=(m=d.ends)===null||m===void 0?void 0:m[f];return!y||!y.parentNode?this.detach():(W(f,y.parentNode,this.toDocumentFragment(),y),this)},v.prototype.insAtDirEnd=function(f,d){return this.ends?(H(f,this.toDocumentFragment(),d),this):this},v.prototype.hasClass=function(f){var d=!1;return this.eachElement(function(m){m.classList.contains(f)&&(d=!0)}),d},v.prototype.addClass=function(f){for(var d=function(z){if(!z)return"continue";m.eachElement(function(ee){ee.classList.add(z)})},m=this,y=0,E=f.split(/\s+/);y<E.length;y++){var F=E[y];d(F)}return this},v.prototype.removeClass=function(f){for(var d=function(z){if(!z)return"continue";m.eachElement(function(ee){ee.classList.remove(z)})},m=this,y=0,E=f.split(/\s+/);y<E.length;y++){var F=E[y];d(F)}return this},v.prototype.toggleClass=function(f,d){if(d===!0)return this.addClass(f);if(d===!1)return this.removeClass(f);for(var m=function(ee){if(!ee)return"continue";y.eachElement(function(ue){ue.classList.toggle(ee)})},y=this,E=0,F=f.split(/\s+/);E<F.length;E++){var z=F[E];m(z)}return this},v}(),P=R.create;function W(v,f,d,m){f.insertBefore(d,v===r?m:m.nextSibling)}function H(v,f,d){v===r?d.insertBefore(f,d.firstChild):d.appendChild(f)}var j=function(){function v(f,d,m){this.init(f,d,m)}return v.prototype.init=function(f,d,m){this.parent=f,this[r]=d,this[e]=m},v.copy=function(f){return new v(f.parent,f[r],f[e])},v}();function ne(v,f){var d=v[r];if(d){var m=v[e];if(m)for(m=m[e];d!==m;d=d[e]){var y=f(d);if(y===!1)break}}}function le(v,f,d){var m=v[r];if(!m)return f;var y=v[e];if(!y)return f;for(y=y[e];m!==y;m=m[e])f=d(f,m);return f}var w=function(){function v(){var m;this[f]=0,this[d]=0,this.parent=0,this.ends=(m={},m[r]=0,m[e]=0,m),this.id=v.uniqueNodeId()}v.uniqueNodeId=function(){return v.idCounter+=1},v.getNodeOfElement=function(m){if(m){if(!m.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var y=m;return y.mqBlockNode||y.mqCmdNode}},v.linkElementByBlockNode=function(m,y){m.mqBlockNode=y},v.linkElementByCmdNode=function(m,y){m.mqCmdNode=y},v.prototype.setEnds=function(m){this.ends=m,o("No half-empty node ends",!!this.ends[r]==!!this.ends[e])},v.prototype.getEnd=function(m){return this.ends[m]},v.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},v.prototype.setDOM=function(m){return m&&o("DOM is an element or a text node",m.nodeType===Node.ELEMENT_NODE||m.nodeType===Node.TEXT_NODE),this._el=m,this},v.prototype.domFrag=function(){return P(this._el)},v.prototype.createDir=function(m,y){s(m);var E=this;return E.html(),E.domFrag().insDirOf(m,y.domFrag()),y[m]=E.adopt(y.parent,y[r],y[e]),E},v.prototype.createLeftOf=function(m){this.createDir(r,m)},v.prototype.selectChildren=function(m,y){return new ye(m,y)},v.prototype.bubble=function(m){for(var y=this.getSelfNode(),E=y;E;E=E.parent){var F=m(E);if(F===!1)break}return this},v.prototype.postOrder=function(m){var y=this.getSelfNode();return function E(F){return F?(F.eachChild(E),m(F),!0):!1}(y),y},v.prototype.isEmpty=function(){return this.ends[r]===0&&this.ends[e]===0},v.prototype.isQuietEmptyDelimiter=function(m){if(!this.isEmpty()||!m||!this.parent||this.parent.ctrlSeq===void 0)return!1;var y=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return m.hasOwnProperty(y)},v.prototype.isStyleBlock=function(){return!1},v.prototype.isTextBlock=function(){return!1},v.prototype.children=function(){return new q(this.getEnd(r),this.getEnd(e))},v.prototype.eachChild=function(m){return ne(this.ends,m),this},v.prototype.foldChildren=function(m,y){return le(this.ends,m,y)},v.prototype.withDirAdopt=function(m,y,E,F){var z=this.getSelfNode();return new q(z,z).withDirAdopt(m,y,E,F),this},v.prototype.adopt=function(m,y,E){var F=this.getSelfNode();return new q(F,F).adopt(m,y,E),this.getSelfNode()},v.prototype.disown=function(){var m=this.getSelfNode();return new q(m,m).disown(),this},v.prototype.remove=function(){return this.domFrag().remove(),this.disown()},v.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(m){return!(!m.disableAutoSubstitutionInSubscripts||!this.parent||!(this.parent.parent instanceof ol)||!this.parent.domFrag().hasClass("dcg-mq-sub"))},v.prototype.getSelfNode=function(){return this},v.prototype.parser=function(){o("Abstract parser() method is never called",!1)},v.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},v.prototype.text=function(){return""},v.prototype.latex=function(){var m={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(m),m.latex},v.prototype.latexRecursive=function(m){},v.prototype.checkCursorContextOpen=function(m){m.startSelectionBefore===this&&(m.startIndex=m.latex.length),m.endSelectionBefore===this&&(m.endIndex=m.latex.length)},v.prototype.checkCursorContextClose=function(m){m.startSelectionAfter===this&&(m.startIndex=m.latex.length),m.endSelectionAfter===this&&(m.endIndex=m.latex.length)},v.prototype.finalizeTree=function(m,y){},v.prototype.contactWeld=function(m,y){},v.prototype.blur=function(m){},v.prototype.focus=function(){},v.prototype.intentionalBlur=function(){},v.prototype.reflow=function(){},v.prototype.registerInnerField=function(m,y){},v.prototype.chToCmd=function(m,y){o("Abstract chToCmd() method is never called",!1)},v.prototype.mathspeak=function(m){return""},v.prototype.seek=function(m,y){},v.prototype.siblingDeleted=function(m,y){},v.prototype.siblingCreated=function(m,y){},v.prototype.finalizeInsert=function(m,y){},v.prototype.fixDigitGrouping=function(m){},v.prototype.writeLatex=function(m,y){},v.prototype.write=function(m,y){};var f,d;return f=r,d=e,v.idCounter=0,v}();function B(v,f,d){o("a parent is always present",v),o("leftward is properly set up",function(){return f?f[e]===d&&f.parent===v:v.getEnd(r)===d}()),o("rightward is properly set up",function(){return d?d[r]===f&&d.parent===v:v.getEnd(e)===f}())}var q=function(){function v(f,d,m){var y,E;if(this.disowned=!1,m===void 0&&(m=r),s(m),o("no half-empty fragments",!f==!d),!f||!d){this.setEnds((y={},y[r]=0,y[e]=0,y));return}o("withDir is passed to Fragment",f instanceof Ne),o("oppDir is passed to Fragment",d instanceof Ne),o("withDir and oppDir have the same parent",f.parent===d.parent);var F=(E={},E[m]=f,E[-m]=d,E);this.setEnds(F);var z=0;this.each(function(ee){z=ee}),o("following direction siblings from start reaches end",z===F[e])}return v.prototype.getDOMFragFromEnds=function(){var f=this.ends[r],d=this.ends[e];return f===0||d===0?P():f===d?f.domFrag():f.domFrag().join(d.domFrag())},v.prototype.setEnds=function(f){this.ends=f},v.prototype.getEnd=function(f){return this.ends?this.ends[f]:0},v.prototype.domFrag=function(){return this.getDOMFragFromEnds()},v.prototype.withDirAdopt=function(f,d,m,y){return f===r?this.adopt(d,m,y):this.adopt(d,y,m)},v.prototype.adopt=function(f,d,m){var y;B(f,d,m);var E=this;this.disowned=!1;var F=E.ends[r];if(!F)return this;var z=E.ends[e];if(!z)return this;var ee=(y={},y[r]=f.getEnd(r),y[e]=f.getEnd(e),y);return d||(ee[r]=F),m?m[r]=z:ee[e]=z,f.setEnds(ee),z[e]=m,E.each(function(ue){return ue[r]=d,ue.parent=f,d&&(d[e]=ue),d=ue,!0}),E},v.prototype.disown=function(){var f,d=this,m=d.ends[r];if(!m||d.disowned)return d;this.disowned=!0;var y=d.ends[e];if(!y)return d;var E=m.parent;B(E,m[r],m),B(E,y,y[e]);var F=(f={},f[r]=E.getEnd(r),f[e]=E.getEnd(e),f);if(m[r]){var z=m[r];z[e]=y[e]}else F[r]=y[e];if(y[e]){var ee=y[e];ee[r]=m[r]}else F[e]=m[r];return F[r]&&F[e]?E.setEnds(F):E.ends=F,d},v.prototype.remove=function(){return this.domFrag().remove(),this.disown()},v.prototype.each=function(f){return ne(this.ends,f),this},v.prototype.fold=function(f,d){return le(this.ends,f,d)},v}(),M={},ae={};function se(v){return v&&v.prototype instanceof Ne}var ge=function(v){Dt(f,v);function f(d,m,y){var E=v.call(this,d,m,y)||this;return E.ancestors={},E}return f.fromCursor=function(d){return new f(d.parent,d[r],d[e])},f}(j),he=function(v){Dt(f,v);function f(d,m,y){var E=v.call(this,d,0,0)||this;return E.upDownCache={},E.cursorElement=l("span",{class:"dcg-mq-cursor"},[l.text(p)]),E._domFrag=P(),E.controller=y,E.options=m,E.setDOMFrag(P(E.cursorElement)),E.blink=function(){P(E.cursorElement).toggleClass("dcg-mq-blink")},E}return f.prototype.setDOMFrag=function(d){return this._domFrag=d,this},f.prototype.domFrag=function(){return this._domFrag},f.prototype.show=function(){if(P(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(P(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var d=this[e];if(d){var m=this.selection;m&&m.getEnd(r)[r]===this[r]?this.domFrag().insertBefore(m.domFrag()):this.domFrag().insertBefore(d.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},f.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(P()),this},f.prototype.withDirInsertAt=function(d,m,y,E){var F=this.parent;this.parent=m,this[d]=y,this[-d]=E,F!==m&&F.blur&&F.blur(this)},f.prototype.insDirOf=function(d,m){return s(d),this.domFrag().insDirOf(d,m.domFrag()),this.withDirInsertAt(d,m.parent,m[d],m),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},f.prototype.insLeftOf=function(d){return this.insDirOf(r,d)},f.prototype.insRightOf=function(d){return this.insDirOf(e,d)},f.prototype.insAtDirEnd=function(d,m){return s(d),this.domFrag().insAtDirEnd(d,m.domFrag().oneElement()),this.withDirInsertAt(d,m,0,m.getEnd(d)),m.focus(),this},f.prototype.insAtLeftEnd=function(d){return this.insAtDirEnd(r,d)},f.prototype.insAtRightEnd=function(d){return this.insAtDirEnd(e,d)},f.prototype.jumpUpDown=function(d,m){var y=this;y.upDownCache[d.id]=j.copy(y);var E=y.upDownCache[m.id];if(E){var F=E[e];F?y.insLeftOf(F):y.insAtRightEnd(E.parent)}else{var z=y.getBoundingClientRectWithoutMargin().left;m.seek(z,y)}y.controller.aria.queue(m,!0)},f.prototype.getBoundingClientRectWithoutMargin=function(){var d=this.domFrag();d.removeClass("dcg-mq-cursor");var m=S(d.oneElement()),y=m.left,E=m.right;return d.addClass("dcg-mq-cursor"),{left:y,right:E}},f.prototype.unwrapGramp=function(){var d=this.parent.parent,m=d.parent,y=d[e],E=this,F=d[r];if(d.disown().eachChild(function(Ie){return Ie.isEmpty()||(Ie.children().adopt(m,F,y).each(function(We){return We.domFrag().insertBefore(d.domFrag()),!0}),F=Ie.getEnd(e)),!0}),!this[e]){var z=this[r];if(z)this[e]=z[e];else for(;!this[e];){var ee=this.parent[e];if(ee)this.parent=ee,this[e]=ee.getEnd(r);else{this[e]=d[e],this.parent=m;break}}}var ue=this[e];ue?this.insLeftOf(ue):this.insAtRightEnd(m),d.domFrag().remove();var He=d[r],_e=d[e];He&&He.siblingDeleted(E.options,e),_e&&_e.siblingDeleted(E.options,r)},f.prototype.startSelection=function(){for(var d=this.anticursor=ge.fromCursor(this),m=d.ancestors,y=d;y.parent;y=y.parent)m[y.parent.id]=y},f.prototype.endSelection=function(){delete this.anticursor},f.prototype.select=function(){var d,m=this.anticursor;if(this[r]===m[r]&&this.parent===m.parent)return!1;for(var y=this;y.parent;y=y.parent)if(y.parent.id in m.ancestors){d=y.parent;break}o("cursor and anticursor in the same tree",d);var E=d,F=m.ancestors[E.id],z,ee,ue=e;if(y[r]!==F){for(var He=y;He;He=He[e])if(He[e]===F[e]){ue=r,z=y,ee=F;break}}ue===e&&(z=F,ee=y),z instanceof j&&(z=z[e]),ee instanceof j&&(ee=ee[r]),this.hide().selection=E.selectChildren(z,ee);var _e=this.selection.getEnd(ue);return this.insDirOf(ue,_e),this.selectionChanged(),!0},f.prototype.resetToEnd=function(d){this.clearSelection();var m=d.root;this[e]=0,this[r]=m.getEnd(e),this.parent=m},f.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},f.prototype.deleteSelection=function(){var d=this.selection;d&&(this[r]=d.getEnd(r)[r],this[e]=d.getEnd(e)[e],d.remove(),this.selectionChanged(),delete this.selection)},f.prototype.replaceSelection=function(){var d=this.selection;return d&&(this[r]=d.getEnd(r)[r],this[e]=d.getEnd(e)[e],delete this.selection),d},f.prototype.depth=function(){for(var d=this,m=0;d=d.parent;)m+=d instanceof Qr?1:0;return m},f.prototype.isTooDeep=function(d){return this.options.maxDepth!==void 0?this.depth()+(d||0)>this.options.maxDepth:!1},f.prototype.selectionChanged=function(){},f}(j),ye=function(v){Dt(f,v);function f(d,m,y){var E=v.call(this,d,m,y)||this;return E._el=l("span",{class:"dcg-mq-selection"}),E.getDOMFragFromEnds().wrapAll(E._el),E}return f.prototype.isCleared=function(){return this._el===void 0},f.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():P(this._el)},f.prototype.setEnds=function(d){o("Selection ends are never empty",d[r]&&d[e]),this.ends=d},f.prototype.getEnd=function(d){return this.ends[d]},f.prototype.adopt=function(d,m,y){return this.clear(),v.prototype.adopt.call(this,d,m,y)},f.prototype.clear=function(){var d=this.getDOMFragFromEnds();return this.domFrag().replaceWith(d),this._el=void 0,this},f.prototype.join=function(d,m){return m===void 0&&(m=""),this.fold("",function(y,E){return y+m+E[d]()})},f}(q),fe=function(){function v(f,d,m){this.textareaEventListeners={},this.id=f.id,this.data={},this.root=f,this.container=d,this.options=m,this.aria=new A(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",f.controller=this.getControllerSelf(),this.cursor=f.cursor=new he(f,m,this.getControllerSelf())}return v.prototype.getControllerSelf=function(){return this},v.prototype.handle=function(f,d){var m,y=this.options.handlers,E=(m=this.options.handlers)===null||m===void 0?void 0:m.fns[f];if(E){var F=y==null?void 0:y.APIClasses[this.KIND_OF_MQ];o("APIClass is defined",F);var z=new F(this);d===r||d===e?E(d,z):E(z)}},v.onNotify=function(f){v.notifyees.push(f)},v.prototype.notify=function(f){for(var d=0;d<v.notifyees.length;d+=1)v.notifyees[d](this.cursor,f);return this},v.prototype.setAriaLabel=function(f){var d=this.getAriaLabel();return f&&typeof f=="string"&&f!==""?this.ariaLabel=f:this.editable?this.ariaLabel="Math Input":this.ariaLabel="",this.ariaLabel!==d&&!this.containerHasFocus()&&this.updateMathspeak(),this},v.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},v.prototype.setAriaPostLabel=function(f,d){var m=this;return f&&typeof f=="string"&&f!==""?(f!==this.ariaPostLabel&&typeof d=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){m.containerHasFocus()?m.aria.alert(m.root.mathspeak().trim()+" "+f.trim()):m.updateMathspeak()},d)),this.ariaPostLabel=f):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},v.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},v.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},v.prototype.getTextareaOrThrow=function(){var f=this.textarea;if(!f)throw new Error("expected a textarea");return f},v.prototype.getTextareaSpanOrThrow=function(){var f=this.textareaSpan;if(!f)throw new Error("expected a textareaSpan");return f},v.prototype.addTextareaEventListeners=function(f){if(this.textarea)for(var d in f){var m=d;this.removeTextareaEventListener(m),this.textarea.addEventListener(m,f[m])}},v.prototype.removeTextareaEventListener=function(f){if(this.textarea){var d=this.textareaEventListeners[f];d&&this.textarea.removeEventListener(f,d)}},v.prototype.exportMathSpeak=function(){return this.root.mathspeak()},v.prototype.updateMathspeak=function(){},v.prototype.scrollHoriz=function(){},v.prototype.selectionChanged=function(){},v.prototype.setOverflowClasses=function(){},v.notifyees=[],v}(),Se={},de={},Ee={handlers:!0,autoCommands:!0,quietEmptyDelimiters:!0,autoParenthesizedFunctions:!0,autoOperatorNames:!0,leftRightIntoCmdGoes:!0,maxDepth:!0,interpretTildeAsSim:!0},U={},ce=function(){function v(f){this.version=f}return v.prototype.assertJquery=function(){return o("Interface versions > 2 do not depend on JQuery",this.version<=2),o("JQuery is set for interface v < 3",this.jQuery),this.jQuery},v}(),Oe=function(){function v(){}return v}(),Qe=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Ct;function Je(v){return Qe(),Ct||(Ct=we(1)),Ct(v)}Je.prototype=Oe.prototype,Je.VERSION="v0.10.1",Je.interfaceVersion=function(v){if(v!==1)throw"Only interface version 1 supported. You specified: "+v;return Qe=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Qe(),Je},Je.getInterface=we;var tr=we.MIN=1,mr=we.MAX=3;function we(v){if(v!==1&&v!==2&&v!==3)throw"Only interface versions between "+tr+" and "+mr+" supported. You specified: "+v;var f=v;if(f<3){var d=window.jQuery;if(!d)throw"MathQuill interface version ".concat(f," requires jQuery 1.5.2+ to be loaded first");ce.prototype.jQuery=d}var m=$S($S({},U),{handlers:function(_e){return{fns:_e||{},APIClasses:ee}}});function y(_e,Ie){for(var We in Ie)if(Ie.hasOwnProperty(We)){if(We==="substituteKeyboardEvents"&&f>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var Ze=Ie[We],pt=m[We];_e[We]=pt?pt(Ze):Ze}}var E=f<3?ce:function(_e){Dt(Ie,_e);function Ie(){return _e!==null&&_e.apply(this,arguments)||this}return Ie}(ce),F=function(_e){Dt(Ie,_e);function Ie(We){var Ze=_e.call(this)||this;return Ze.__controller=We,Ze.__options=We.options,Ze.id=We.id,Ze.data=We.data,Ze}return Ie.prototype.mathquillify=function(We){var Ze=this.__controller,pt=Ze.root,bt=Ze.container;Ze.createTextarea();var _t=P(bt).addClass(We).children().detach();pt.setDOM(P(l("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(bt).oneElement()),w.linkElementByBlockNode(pt.domFrag().oneElement(),pt),this.latex(_t.text()),this.revert=function(){return Ze.removeMouseEventListener(),P(bt).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(_t),f<3?this.__options.assertJquery()(bt):bt}},Ie.prototype.setAriaLabel=function(We){return this.__controller.setAriaLabel(We),this},Ie.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},Ie.prototype.config=function(We){return y(this.__options,We),this},Ie.prototype.el=function(){return this.__controller.container},Ie.prototype.text=function(){return this.__controller.exportText()},Ie.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},Ie.prototype.latex=function(We){if(arguments.length>0){this.__controller.renderLatexMath(We);var Ze=this.__controller.cursor;return this.__controller.blurred&&Ze.hide().parent.blur(Ze),this}return this.__controller.exportLatex()},Ie.prototype.selection=function(){return this.__controller.exportLatexSelection()},Ie.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},Ie.prototype.reflow=function(){return this.__controller.root.postOrder(function(We){We.reflow()}),this},Ie}(Oe),z=function(_e){Dt(Ie,_e);function Ie(){return _e!==null&&_e.apply(this,arguments)||this}return Ie.prototype.mathquillify=function(We){return _e.prototype.mathquillify.call(this,We),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},Ie.prototype.focus=function(){return this.__controller.getTextareaOrThrow().focus(),this.__controller.scrollHoriz(),this},Ie.prototype.blur=function(){return this.__controller.getTextareaOrThrow().blur(),this},Ie.prototype.write=function(We){this.__controller.writeLatex(We),this.__controller.scrollHoriz();var Ze=this.__controller.cursor;return this.__controller.blurred&&Ze.hide().parent.blur(Ze),this},Ie.prototype.empty=function(){var We,Ze=this.__controller.root,pt=this.__controller.cursor;return Ze.setEnds((We={},We[r]=0,We[e]=0,We)),Ze.domFrag().empty(),delete pt.selection,pt.insAtRightEnd(Ze),this},Ie.prototype.cmd=function(We){var Ze=this.__controller.notify(void 0),pt=Ze.cursor;if(/^\\[a-z]+$/i.test(We)&&!pt.isTooDeep()){We=We.slice(1);var bt=M[We],_t;bt&&(bt.constructor?_t=new bt(We):_t=bt(We),pt.selection&&_t.replaces(pt.replaceSelection()),_t.createLeftOf(pt.show()))}else pt.parent.write(pt,We);return Ze.scrollHoriz(),Ze.blurred&&pt.hide().parent.blur(pt),this},Ie.prototype.select=function(){return this.__controller.selectAll(),this},Ie.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},Ie.prototype.moveToDirEnd=function(We){return this.__controller.notify("move").cursor.insAtDirEnd(We,this.__controller.root),this},Ie.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(r)},Ie.prototype.moveToRightEnd=function(){return this.moveToDirEnd(e)},Ie.prototype.keystroke=function(We,Ze){for(var pt=We.replace(/^\s+|\s+$/g,"").split(/\s+/),bt=0;bt<pt.length;bt+=1)this.__controller.keystroke(pt[bt],Ze);return this},Ie.prototype.typedText=function(We){for(var Ze=0;Ze<We.length;Ze+=1)this.__controller.typedText(We.charAt(Ze));return this},Ie.prototype.dropEmbedded=function(We,Ze,pt){var bt=We-V(),_t=Ze-k(),Hr=document.elementFromPoint(bt,_t);this.__controller.seek(Hr,bt,_t);var Vn=new Wy().setOptions(pt);Vn.createLeftOf(this.__controller.cursor)},Ie.prototype.setAriaPostLabel=function(We,Ze){return this.__controller.setAriaPostLabel(We,Ze),this},Ie.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},Ie.prototype.clickAt=function(We,Ze,pt){pt=pt||document.elementFromPoint(We,Ze);var bt=this.__controller,_t=bt.root,Hr=_t.domFrag().oneElement();return Hr.contains(pt)||(pt=Hr),bt.seek(pt,We,Ze),bt.blurred&&this.focus(),this},Ie.prototype.ignoreNextMousedown=function(We){return this.__controller.cursor.options.ignoreNextMousedown=We,this},Ie}(F),ee={AbstractMathQuill:F,EditableField:z};o("API.StaticMath defined",Se.StaticMath),ee.StaticMath=Se.StaticMath(ee),o("API.MathField defined",Se.MathField),ee.MathField=Se.MathField(ee),o("API.InnerMathField defined",Se.InnerMathField),ee.InnerMathField=Se.InnerMathField(ee),Se.TextField&&(ee.TextField=Se.TextField(ee));var ue=function(_e){if(!_e||!_e.nodeType)return null;for(var Ie,We=P(_e).children().toElementArray(),Ze=0,pt=We;Ze<pt.length;Ze++){var bt=pt[Ze];if(bt.classList.contains("dcg-mq-root-block")){Ie=bt;break}}var _t=w.getNodeOfElement(Ie),Hr=_t&&_t.controller,Vn=Hr&&ee[Hr.KIND_OF_MQ];return Hr&&Vn?new Vn(Hr):null};ue.L=r,ue.R=e,ue.config=function(_e){return y(E.prototype,_e),this},ue.registerEmbed=function(_e,Ie){if(!/^[a-z][a-z0-9]*$/i.test(_e))throw"Embed name must start with letter and be only letters and digits";de[_e]=Ie},ue.StaticMath=He("StaticMath",ee.StaticMath),ue.MathField=He("MathField",ee.MathField),ue.InnerMathField=He("InnerMathField",ee.InnerMathField),ee.TextField&&(ue.TextField=He("TextField",ee.TextField)),ue.prototype=F.prototype,ue.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},ue.EditableField.prototype=z.prototype,f<3&&(ue.saneKeyboardEvents=Ft);function He(_e,Ie){o(_e+" is defined",Ie);function We(Ze,pt){if(!Ze||!Ze.nodeType)return null;var bt=ue(Ze);if(bt instanceof Ie)return bt;var _t=new In(new Ie.RootBlock,Ze,new E(f));return _t.KIND_OF_MQ=_e,new Ie(_t).__mathquillify(pt||{},f)}return We.prototype=Ie.prototype,We}return ue}Je.noConflict=function(){return window.MathQuill=Xr,Je};var Xr=window.MathQuill;window.MathQuill=Je;function xi(v){v.moveOutOf=function(f){o("controller is defined",this.controller),this.controller.handle("moveOutOf",f)},v.deleteOutOf=function(f){o("controller is defined",this.controller),this.controller.handle("deleteOutOf",f)},v.selectOutOf=function(f){o("controller is defined",this.controller),this.controller.handle("selectOutOf",f)},v.upOutOf=function(){o("controller is defined",this.controller),this.controller.handle("upOutOf")},v.downOutOf=function(){o("controller is defined",this.controller),this.controller.handle("downOutOf")},v.reflow=function(){o("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function Le(v,f){throw v?v="'"+v+"'":v="EOF","Parse Error: "+f+" at "+v}var Et=function(){function v(f){this._=f}return v.prototype.parse=function(f){return this.skip(v.eof)._(""+f,d,Le);function d(m,y){return y}},v.prototype.or=function(f){o("or is passed a parser",f instanceof v);var d=this;return new v(function(m,y,E){return d._(m,y,F);function F(z){return f._(m,y,E)}})},v.prototype.then=function(f){var d=this;return new v(function(m,y,E){return d._(m,F,E);function F(z,ee){var ue=f instanceof v?f:f(ee);return o("a parser is returned",ue instanceof v),ue._(z,y,E)}})},v.prototype.many=function(){var f=this;return new v(function(d,m,y){for(var E=[];f._(d,F,z););return m(d,E);function F(ee,ue){return d=ee,E.push(ue),!0}function z(){return!1}})},v.prototype.times=function(f,d){arguments.length<2&&(d=f);var m=this;return new v(function(y,E,F){for(var z=[],ee=!0,ue,He=0;He<f;He+=1)if(ee=!!m._(y,_e,Ie),!ee)return F(y,ue);for(;He<d&&ee;He+=1)m._(y,_e,We);return E(y,z);function _e(Ze,pt){return z.push(pt),y=Ze,!0}function Ie(Ze,pt){return ue=pt,y=Ze,!1}function We(Ze,pt){return!1}})},v.prototype.result=function(f){return this.then(v.succeed(f))},v.prototype.atMost=function(f){return this.times(0,f)},v.prototype.atLeast=function(f){var d=this;return d.times(f).then(function(m){return d.many().map(function(y){return m.concat(y)})})},v.prototype.map=function(f){return this.then(function(d){return v.succeed(f(d))})},v.prototype.skip=function(f){return this.then(function(d){return f.result(d)})},v.string=function(f){var d=f.length,m="expected '"+f+"'";return new v(function(y,E,F){var z=y.slice(0,d);return z===f?E(y.slice(d),z):F(y,m)})},v.regex=function(f){o("regexp parser is anchored",f.toString().charAt(1)==="^");var d="expected "+f;return new v(function(m,y,E){var F=f.exec(m);if(F){var z=F[0];return y(m.slice(z.length),z)}else return E(m,d)})},v.succeed=function(f){return new v(function(d,m){return m(d,f)})},v.fail=function(f){return new v(function(d,m,y){return y(d,f)})},v.letter=v.regex(/^[a-z]/i),v.letters=v.regex(/^[a-z]*/i),v.digit=v.regex(/^[0-9]/),v.digits=v.regex(/^[0-9]*/),v.whitespace=v.regex(/^\s+/),v.optWhitespace=v.regex(/^\s*/),v.any=new v(function(f,d,m){return f?d(f.slice(1),f.charAt(0)):m(f,"expected any character")}),v.all=new v(function(f,d,m){return d("",f)}),v.eof=new v(function(f,d,m){return f?m(f,"expected EOF"):d(f,f)}),v}(),lt=function(){function v(){this.fn=n}return v.prototype.listen=function(f){this.fn=f,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},v.prototype.listenOnce=function(f){var d=this;this.listen(function(){for(var m=[],y=0;y<arguments.length;y++)m[y]=arguments[y];d.clearListener(),f.apply(void 0,m)})},v.prototype.clearListener=function(){this.fn=n,clearTimeout(this.timeoutId)},v.prototype.trigger=function(){for(var f=[],d=0;d<arguments.length;d++)f[d]=arguments[d];this.fn.apply(this,f)},v}(),dt=function(){var v={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},f={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function d(F){switch(y(F)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function m(F){return F.length===1&&F>="a"&&F<="z"}function y(F){var z;if(F.key===void 0){var ee=F.which||F.keyCode;return v[ee]||String.fromCharCode(ee)}return m(F.key)?F.key.toUpperCase():(z=f[F.key])!==null&&z!==void 0?z:F.key}function E(F){var z=y(F),ee=[];return F.ctrlKey&&ee.push("Ctrl"),F.metaKey&&ee.push("Meta"),F.altKey&&ee.push("Alt"),F.shiftKey&&ee.push("Shift"),ee.length?(z!=="Alt"&&z!=="Control"&&z!=="Meta"&&z!=="Shift"&&ee.push(z),ee.join("-")):z}return function(z,ee){var ue=null,He=null,_e=new lt;function Ie(){try{z instanceof HTMLTextAreaElement&&z.select()}catch(ei){}}function We(ei){_e.trigger(),_e.clearListener(),z instanceof HTMLTextAreaElement&&(z.value=ei),ei&&Ie(),Ze=!!ei}var Ze=!1;function pt(){return!("selectionStart"in z)||!(z instanceof HTMLTextAreaElement)?!1:z.selectionStart!==z.selectionEnd}function bt(){ee.options&&ee.options.overrideKeystroke?ee.options.overrideKeystroke(E(ue),ue):ee.keystroke(E(ue),ue)}function _t(ei){_e.trigger(ei),ei.target===z&&(ue=ei,He=null,Ze&&_e.listenOnce(function(id){id&&id.type==="focusout"||Ie()}),bt())}function Hr(ei){_e.trigger(ei),ei.target===z&&(ue&&He&&bt(),He=ei,d(ei)?_e.listenOnce(Pn):_e.listen(Zr))}function Vn(ei){_e.trigger(ei),ei.target===z&&ue&&!He&&(d(ei)?_e.listenOnce(Pn):_e.listen(Zr))}function Zr(){if(!pt()&&z instanceof HTMLTextAreaElement){var ei=z.value;ue&&!ue.altKey&&ue.ctrlKey&&!ue.metaKey&&ue.shiftKey&&(ue.key==="U"||ue.key==="Unidentified"||ue.key==="Process")||(ei.length===1?(z.value="",ee.options&&ee.options.overrideTypedText?ee.options.overrideTypedText(ei):ee.typedText(ei)):Pn())}}function Pn(){z instanceof HTMLTextAreaElement&&z.value.length>1&&Ie()}function ha(){ue=null,He=null,_e.clearListener(),z instanceof HTMLTextAreaElement&&(z.value="")}function Zs(ei){_e.trigger(),ei.target===z&&(document.activeElement!==z&&z.focus(),_e.listen(function(){if(z instanceof HTMLTextAreaElement){var Ml=z.value;z.value="",Ml&&ee.paste(Ml)}}))}function pc(ei){_e.trigger(ei)}return ee.options&&ee.options.disableCopyPaste?ee.addTextareaEventListeners({keydown:_t,keypress:Hr,keyup:Vn,focusout:ha,copy:function(ei){ei.preventDefault()},cut:function(ei){ei.preventDefault()},paste:function(ei){_e.trigger(),ei.preventDefault()},input:pc}):ee.addTextareaEventListeners({keydown:_t,keypress:Hr,keyup:Vn,focusout:ha,cut:function(){_e.listenOnce(function(){ee.cut()})},copy:function(){_e.listenOnce(function(){ee.copy()})},paste:Zs,input:pc}),{select:We}}}(),Pt=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.exportText=function(){return this.root.foldChildren("",function(d,m){return d+m.text()})},f}(fe);fe.onNotify(function(v,f){if(f==="edit"||f==="replace"||f===void 0){var d=v.controller;if(!d||!d.options.enableDigitGrouping||d.blurred!==!1)return;d.disableGroupingForSeconds(1)}});var Ve=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.handleTextareaFocusEditable=function(){var m=d.cursor;d.updateMathspeak(),d.blurred=!1,clearTimeout(d.blurTimeout),P(d.container).addClass("dcg-mq-focused"),m.parent||m.insAtRightEnd(d.root),m.selection?(m.selection.domFrag().removeClass("dcg-mq-blur"),d.selectionChanged()):m.show(),d.setOverflowClasses()},d.handleTextareaBlurEditable=function(){d.textareaSelectionTimeout&&(clearTimeout(d.textareaSelectionTimeout),d.textareaSelectionTimeout=0),d.disableGroupingForSeconds(0),d.blurred=!0,d.blurTimeout=setTimeout(function(){d.root.postOrder(function(m){m.intentionalBlur()}),d.cursor.clearSelection().endSelection(),d.blur(),d.updateMathspeak(),d.scrollHoriz()}),window.addEventListener("blur",d.handleWindowBlur)},d.handleTextareaFocusStatic=function(){d.blurred=!1},d.handleTextareaBlurStatic=function(){d.cursor.selection&&d.cursor.selection.clear(),setTimeout(function(){P(d.getTextareaSpanOrThrow()).detach(),d.blurred=!0})},d.handleWindowBlur=function(){clearTimeout(d.blurTimeout),d.cursor.selection&&d.cursor.selection.domFrag().addClass("dcg-mq-blur"),d.blur(),d.updateMathspeak()},d}return f.prototype.disableGroupingForSeconds=function(d){var m=this;clearTimeout(this.__disableGroupingTimeout),d===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){m.root.domFrag().removeClass("dcg-mq-suppress-grouping")},d*1e3))},f.prototype.blur=function(){this.cursor.hide().parent.blur(this.cursor),P(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},f.prototype.addEditableFocusBlurListeners=function(){var d=this,m=d.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),d.blurred=!0,m.hide().parent.blur(m)},f.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},f}(Pt),ur=!1,Ne=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.keystroke=function(d,m,y){var E=y.cursor;switch(d){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":y.ctrlDeleteDir(r);break;case"Shift-Backspace":case"Backspace":y.backspace();break;case"Esc":case"Tab":y.escapeDir(e,d,m);return;case"Shift-Tab":case"Shift-Esc":y.escapeDir(r,d,m);return;case"End":y.notify("move").cursor.insAtRightEnd(E.parent),y.aria.queue("end of").queue(E.parent,!0);break;case"Ctrl-End":y.notify("move").cursor.insAtRightEnd(y.root),y.aria.queue("end of").queue(y.ariaLabel).queue(y.root).queue(y.ariaPostLabel);break;case"Shift-End":y.selectToBlockEndInDir(e);break;case"Ctrl-Shift-End":y.selectToRootEndInDir(e);break;case"Home":y.notify("move").cursor.insAtLeftEnd(E.parent),y.aria.queue("beginning of").queue(E.parent,!0);break;case"Ctrl-Home":y.notify("move").cursor.insAtLeftEnd(y.root),y.aria.queue("beginning of").queue(y.ariaLabel).queue(y.root).queue(y.ariaPostLabel);break;case"Shift-Home":y.selectToBlockEndInDir(r);break;case"Ctrl-Shift-Home":y.selectToRootEndInDir(r);break;case"Left":y.moveLeft();break;case"Shift-Left":y.selectLeft();break;case"Ctrl-Left":break;case"Right":y.moveRight();break;case"Shift-Right":y.selectRight();break;case"Ctrl-Right":break;case"Up":y.moveUp();break;case"Down":y.moveDown();break;case"Shift-Up":y.withIncrementalSelection(function(F){if(E[r])for(;E[r];)F(r);else F(r)});break;case"Shift-Down":y.withIncrementalSelection(function(F){if(E[e])for(;E[e];)F(e);else F(e)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":y.ctrlDeleteDir(e);break;case"Shift-Del":case"Del":y.deleteForward();break;case"Meta-A":case"Ctrl-A":y.selectAll();break;case"Ctrl-Alt-Up":E.parent.parent&&E.parent.parent instanceof f?y.aria.queue(E.parent.parent):y.aria.queue("nothing above");break;case"Ctrl-Alt-Down":E.parent&&E.parent instanceof f?y.aria.queue(E.parent):y.aria.queue("block is empty");break;case"Ctrl-Alt-Left":E.parent.parent&&E.parent.parent.getEnd(r)?y.aria.queue(E.parent.parent.getEnd(r)):y.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":E.parent.parent&&E.parent.parent.getEnd(e)?y.aria.queue(E.parent.parent.getEnd(e)):y.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":E.selection?y.aria.queue(E.selection.join("mathspeak"," ").trim()+" selected"):y.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":y.ariaPostLabel.length?y.aria.queue(y.ariaPostLabel):y.aria.queue("no answer");break;default:return}y.aria.alert(),m==null||m.preventDefault(),y.scrollHoriz()},f.prototype.moveOutOf=function(d,m,y){o("overridden or never called on this node",!1)},f.prototype.moveTowards=function(d,m,y){o("overridden or never called on this node",!1)},f.prototype.deleteOutOf=function(d,m){o("overridden or never called on this node",!1)},f.prototype.deleteTowards=function(d,m){o("overridden or never called on this node",!1)},f.prototype.unselectInto=function(d,m){o("overridden or never called on this node",!1)},f.prototype.selectOutOf=function(d,m){o("overridden or never called on this node",!1)},f.prototype.selectTowards=function(d,m){o("overridden or never called on this node",!1)},f}(w);fe.onNotify(function(v,f){(f==="move"||f==="upDown")&&v.show().clearSelection()}),U.leftRightIntoCmdGoes=function(v){if(v&&v!=="up"&&v!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+v+'"';return v},fe.onNotify(function(v,f){f!=="upDown"&&(v.upDownCache={})}),fe.onNotify(function(v,f){f==="edit"&&v.show().deleteSelection()}),fe.onNotify(function(v,f){f!=="select"&&v.endSelection()});var $t=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.keystroke=function(d,m){this.cursor.parent.keystroke(d,m,this.getControllerSelf())},f.prototype.escapeDir=function(d,m,y){s(d);var E=this.cursor;if(E.parent!==this.root&&(y==null||y.preventDefault()),E.parent!==this.root)return E.clearSelection(),E.parent.moveOutOf(d,E),E.controller.aria.alert(),this.notify("move")},f.prototype.moveDir=function(d){s(d);var m=this.cursor,y=m.options.leftRightIntoCmdGoes,E=m[d];return m.selection?m.insDirOf(d,m.selection.getEnd(d)):E?E.moveTowards(d,m,y):m.parent.moveOutOf(d,m,y),this.notify("move")},f.prototype.moveLeft=function(){return this.moveDir(r)},f.prototype.moveRight=function(){return this.moveDir(e)},f.prototype.moveUp=function(){return this.moveUpDown("up")},f.prototype.moveDown=function(){return this.moveUpDown("down")},f.prototype.moveUpDown=function(d){var m=this,y=m.notify("upDown").cursor,E,F;d==="up"?(E="upInto",F="upOutOf"):(E="downInto",F="downOutOf");var z=y[r],ee=y[e],ue=ee&&ee[E],He=z&&z[E];return ue?y.insAtLeftEnd(ue):He?y.insAtRightEnd(He):y.parent.bubble(function(_e){var Ie=_e[F];if(Ie&&(typeof Ie=="function"&&(Ie=Ie.call(_e,y)),Ie instanceof Ne&&y.jumpUpDown(_e,Ie),Ie!==!0))return!1}),m},f.prototype.deleteDir=function(d){s(d);var m=this.cursor,y=m[d],E=m.parent.parent,F=m.controller;if(y&&y instanceof Ne)y.sides?F.aria.queue(y.parent.chToCmd(y.sides[-d].ch).mathspeak({createdLeftOf:m})):!y.blocks&&y.parent.ctrlSeq!=="\\text"&&F.aria.queue(y);else if(E&&E instanceof Ne)if(E.sides)F.aria.queue(E.parent.chToCmd(E.sides[d].ch).mathspeak({createdLeftOf:m}));else if(E.blocks&&E.mathspeakTemplate)if(E.upInto&&E.downInto)F.aria.queue(E.mathspeakTemplate[1]);else{var z=E.mathspeakTemplate,ee=d===r?z[0]:z[z.length-1];F.aria.queue(ee)}else F.aria.queue(E);var ue=m.selection;if(this.notify("edit"),!ue){var He=m[d];He?He.deleteTowards(d,m):m.parent.deleteOutOf(d,m)}var _e=m[r],Ie=m[e];return _e.siblingDeleted&&_e.siblingDeleted(m.options,e),Ie.siblingDeleted&&Ie.siblingDeleted(m.options,r),m.parent.bubble(function(We){We.reflow()}),this},f.prototype.ctrlDeleteDir=function(d){s(d);var m=this.cursor;if(!m[d]||m.selection)return this.deleteDir(d);this.notify("edit");var y;d===r?y=new q(m.parent.getEnd(r),m[r]):y=new q(m[e],m.parent.getEnd(e)),m.controller.aria.queue(y),y.remove(),m.insAtDirEnd(d,m.parent);var E=m[r],F=m[e];return E&&E.siblingDeleted(m.options,e),F&&F.siblingDeleted(m.options,r),m.parent.bubble(function(z){z.reflow()}),this},f.prototype.backspace=function(){return this.deleteDir(r)},f.prototype.deleteForward=function(){return this.deleteDir(e)},f.prototype.startIncrementalSelection=function(){o("Multiple selections can't be simultaneously open",!ur),ur=!0,this.notify("select");var d=this.cursor;d.anticursor||d.startSelection()},f.prototype.selectDirIncremental=function(d){o("A selection is open",ur),ur=!0;var m=this.cursor,y=m.selection;s(d);var E=m[d];E?y&&y.getEnd(d)===E&&m.anticursor[-d]!==E?E.unselectInto(d,m):E.selectTowards(d,m):m.parent.selectOutOf(d,m)},f.prototype.finishIncrementalSelection=function(){o("A selection is open",ur);var d=this.cursor;d.clearSelection(),d.select()||d.show();var m=d.selection;m&&d.controller.aria.clear().queue(m.join("mathspeak"," ").trim()+" selected"),ur=!1},f.prototype.withIncrementalSelection=function(d){var m=this;try{this.startIncrementalSelection();try{d(function(y){return m.selectDirIncremental(y)})}finally{this.finishIncrementalSelection()}}finally{ur=!1}},f.prototype.selectDir=function(d){this.withIncrementalSelection(function(m){return m(d)})},f.prototype.selectLeft=function(){return this.selectDir(r)},f.prototype.selectRight=function(){return this.selectDir(e)},f.prototype.selectAll=function(){this.notify("move");var d=this.cursor;d.insAtRightEnd(this.root),this.withIncrementalSelection(function(m){for(;d[r];)m(r)})},f.prototype.selectToBlockEndInDir=function(d){var m=this.cursor;this.withIncrementalSelection(function(y){for(;m[d];)y(d)})},f.prototype.selectToRootEndInDir=function(d){var m=this,y=this.cursor;this.withIncrementalSelection(function(E){for(;y[d]||y.parent!==m.root;)E(d)})},f}(Ve),Ge=function(v){Dt(f,v);function f(d){return v.call(this)||this}return f}(Ne),st=function(){function v(Zr){var Pn=new Qr;return Zr.adopt(Pn,0,0),Pn}function f(Zr){for(var Pn=Zr[0]||new Qr,ha=1;ha<Zr.length;ha+=1)Zr[ha].children().adopt(Pn,Pn.getEnd(e),0);return Pn}var d=Et.string,m=Et.regex,y=Et.letter,E=Et.digit,F=Et.any,z=Et.optWhitespace,ee=Et.succeed,ue=Et.fail,He=y.map(function(Zr){return new oe(Zr)}),_e=E.map(function(Zr){return new $(Zr)}),Ie=m(/^[^${}\\_^]/).map(function(Zr){return new pa(Zr)}),We=m(/^[^\\a-eg-zA-Z]/).or(d("\\").then(m(/^[a-z]+/i).or(m(/^\s+/).result(" ")).or(F))).then(function(Zr){var Pn=M[Zr];if(Pn)if(Pn.constructor){var ha=Pn;return new ha(Zr).parser()}else{var Zs=Pn;return Zs(Zr).parser()}else return ue("unknown command: \\"+Zr)}),Ze=We.or(He).or(_e).or(Ie),pt=d("{").then(function(){return _t}).skip(d("}")),bt=z.then(pt.or(Ze.map(v))),_t=bt.many().map(f).skip(z),Hr=d("[").then(bt.then(function(Zr){return Zr.join("latex")!=="]"?ee(Zr):ue("")}).many().map(f).skip(z)).skip(d("]")),Vn=_t;return Vn.block=bt,Vn.optBlock=Hr,Vn}();U.maxDepth=function(v){return typeof v=="number"?v:void 0};var kt=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.cleanLatex=function(d){return d.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},f.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},f.prototype.writeLatex=function(d){var m=this.notify("edit").cursor;return m.parent.writeLatex(m,d),this},f.prototype.exportLatexSelection=function(){var d={latex:"",startIndex:-1,endIndex:-1},m=this.cursor.selection;if(m)d.startSelectionBefore=m.getEnd(r),d.endSelectionAfter=m.getEnd(e);else{var y=this.cursor[r];y?d.startSelectionAfter=y:d.startSelectionBefore=this.cursor.parent;var E=this.cursor[e];E?d.endSelectionBefore=E:d.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(d);for(var F=d.latex,z=this.cleanLatex(F),ee=d.startIndex,ue=d.endIndex,He=0,_e=0;_e<d.endIndex;_e++)F[_e]!==z[He]?(_e<d.startIndex&&(ee-=1),ue-=1):He+=1;return{latex:z,startIndex:ee,endIndex:ue}},f.prototype.classifyLatexForEfficientUpdate=function(d){if(typeof d=="string"){var m=d.match(/-?[0-9.]+$/g);if(m&&m.length===1)return{latex:d,prefix:d.substr(0,d.length-m[0].length),digits:m[0]}}},f.prototype.updateLatexMathEfficiently=function(d,m){var y,E,F,z,ee=this.root,ue,He=this.classifyLatexForEfficientUpdate(d);if(He){if(ue=this.classifyLatexForEfficientUpdate(m),!ue||ue.prefix!==He.prefix)return!1}else return!1;var _e=ue.digits,Ie=He.digits,We=!1,Ze=!1;_e[0]==="-"&&(We=!0,_e=_e.substr(1)),Ie[0]==="-"&&(Ze=!0,Ie=Ie.substr(1));for(var pt=this.root.getEnd(e),bt=[],_t=_e.length-1;_t>=0;_t--){if(!pt||pt.ctrlSeq!==_e[_t]||pt.parent!==ee)return!1;bt.unshift(pt),pt=pt[r]}if(We&&!Ze){var Hr=pt;if(!Hr||Hr.ctrlSeq!=="-"||Hr[e]!==bt[0]||Hr.parent!==ee)return!1;var Vn=Hr[r];if(Vn&&Vn.parent!==ee)return!1;bt[0][r]=Hr[r],ee.getEnd(r)===Hr&&ee.setEnds((y={},y[r]=bt[0],y[e]=ee.getEnd(e),y)),Vn&&(Vn[e]=bt[0]),Hr.domFrag().remove()}if(!We&&Ze){var Zr=new _r("-"),Pn=document.createElement("span");Pn.textContent="-",Zr.setDOM(Pn);var ha=bt[0][r];ha&&(ha[e]=Zr),ee.getEnd(r)===bt[0]&&ee.setEnds((E={},E[r]=Zr,E[e]=ee.getEnd(e),E)),Zr.parent=ee,Zr[r]=bt[0][r],Zr[e]=bt[0],bt[0][r]=Zr,Zr.contactWeld(this.cursor),Zr.domFrag().insertBefore(bt[0].domFrag())}var Zs=Math.min(_e.length,Ie.length);for(_t=0;_t<Zs;_t++){var pc=Ie[_t];pt=bt[_t],pt.ctrlSeq!==pc&&(pt.ctrlSeq=pc,pt.domFrag().oneElement().textContent=pc,pt.mathspeakName=pc)}if(_e.length>Ie.length)for(pt=bt[Ie.length-1],ee.setEnds((F={},F[r]=ee.getEnd(r),F[e]=pt,F)),pt[e]=0,_t=_e.length-1;_t>=Zs;_t--)bt[_t].domFrag().remove();if(Ie.length>_e.length){var ei=document.createDocumentFragment();for(_t=Zs;_t<Ie.length;_t++){var id=document.createElement("span");id.className="dcg-mq-digit",id.textContent=Ie[_t];var Ml=new $(Ie[_t]);Ml.parent=ee,Ml.setDOM(id),ei.appendChild(id),Ml[r]=ee.getEnd(e),Ml[e]=0;var jy=Ml[r];jy[e]=Ml,ee.setEnds((z={},z[r]=ee.getEnd(r),z[e]=Ml,z))}ee.domFrag().oneElement().appendChild(ei)}var Ng=this.exportLatex();if(Ng!==d)return console.warn("tried updating latex efficiently but did not work. Attempted: "+d+" but wrote: "+Ng),!1;var Jy=ee.getEnd(e);return Jy&&Jy.fixDigitGrouping(this.cursor.options),!0},f.prototype.renderLatexMathFromScratch=function(d){var m,y=this.root,E=this.cursor,F=Et.all,z=Et.eof,ee=st.skip(z).or(F.result(!1)).parse(d);if(y.setEnds((m={},m[r]=0,m[e]=0,m)),ee&&ee.children().adopt(y,0,0),ee){var ue=y.domFrag();ue.children().remove(),ue.oneElement().appendChild(ee.html()),y.finalizeInsert(E.options,E)}else y.domFrag().empty()},f.prototype.renderLatexMath=function(d){var m=this.cursor,y=this.root;this.notify("replace"),m.clearSelection();var E=this.exportLatex();(!y.getEnd(r)||!y.getEnd(e)||E!==d)&&(this.updateLatexMathEfficiently(d,E)||this.renderLatexMathFromScratch(d),this.updateMathspeak()),m.insAtRightEnd(y)},f.prototype.renderLatexText=function(d){var m,y=this.root,E=this.cursor;y.domFrag().children().slice(1).remove(),y.setEnds((m={},m[r]=0,m[e]=0,m)),delete E.selection,E.show().insAtRightEnd(y);var F=Et.regex,z=Et.string,ee=Et.eof,ue=Et.all,He=z("$").then(st).skip(z("$").or(ee)).map(function(bt){var _t=new RootMathCommand(E);_t.createBlocks();var Hr=_t.getEnd(r);return bt.children().adopt(Hr,0,0),_t}),_e=z("\\$").result("$"),Ie=_e.or(F(/^[^$]/)).map(function(bt){return new pa(bt)}),We=He.or(Ie).many(),Ze=We.skip(ee).or(ue.result(!1)).parse(d);if(Ze){for(var pt=0;pt<Ze.length;pt+=1)Ze[pt].adopt(y,y.getEnd(e),0);P(y.html()).appendTo(y.domFrag().oneElement()),y.finalizeInsert(E.options,E)}},f}($t),Ae=function(v){return!1};ce.prototype.ignoreNextMousedown=Ae;var Mr;(function(){fe.onNotify(function(v,f){(f==="edit"||f==="replace")&&Mr&&Mr.cursor===v&&Mr.cb()})})();var xt=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.handleMouseDown=function(m){var y=c(m.target,".dcg-mq-root-block"),E=y&&w.getNodeOfElement(y)||w.getNodeOfElement(d.root.domFrag().oneElement()),F=E.domFrag().firstNode().ownerDocument,z=E.controller,ee=z.cursor,ue=ee.blink,He=z.getTextareaSpanOrThrow(),_e=z.getTextareaOrThrow();if(m.preventDefault(),m.target.unselectable=!0,ee.options.ignoreNextMousedown(m)||(ee.options.ignoreNextMousedown=Ae,c(m.target,".dcg-mq-ignore-mousedown")))return;var Ie=null;function We(Vn){Ie=Vn.target}function Ze(Vn){ee.anticursor||ee.startSelection(),z.seek(Ie,Vn.clientX,Vn.clientY).cursor.select(),ee.selection&&ee.controller.aria.clear().queue(ee.selection.join("mathspeak")+" selected").alert(),Ie=null}function pt(){y==null||y.removeEventListener("mousemove",We),F==null||F.removeEventListener("mousemove",Ze),F==null||F.removeEventListener("mouseup",_t),Mr=void 0}function bt(){z.editable?(ee.show(),ee.controller.aria.queue(ee.parent).alert()):P(He).detach()}function _t(){ee.blink=ue,ee.selection||bt(),pt()}var Hr;Mr={cursor:ee,cb:function(){Hr=!0,ee.blink=ue,ee.clearSelection(),bt(),pt()}},!(z.blurred&&(y&&!z.editable&&P(y).prepend(P(He)),_e.focus(),Hr))&&(ee.blink=n,z.seek(m.target,m.clientX,m.clientY).cursor.startSelection(),y==null||y.addEventListener("mousemove",We),F==null||F.addEventListener("mousemove",Ze),F==null||F.addEventListener("mouseup",_t))},d}return f.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},f.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},f.prototype.seek=function(d,m,y){for(var E=this.notify("select").cursor,F;d&&(F=w.getNodeOfElement(d),!F);)d=d.parentElement;return F||(F=this.root),E.clearSelection().show(),F.seek(m,E),this.scrollHoriz(),this},f}(kt),il=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setOverflowClasses=function(){var d=this.root.domFrag().oneElement(),m=!1,y=!1;if(!this.blurred){var E=S(d).width,F=d.scrollWidth,z=d.scrollLeft;m=F>E+z,y=z>0}d.classList.contains("dcg-mq-editing-overflow-right")!==m&&d.classList.toggle("dcg-mq-editing-overflow-right"),d.classList.contains("dcg-mq-editing-overflow-left")!==y&&d.classList.toggle("dcg-mq-editing-overflow-left")},f.prototype.scrollHoriz=function(){var d=this,m=this.cursor,y=m.selection,E=S(this.root.domFrag().oneElement());if(m.domFrag().isEmpty()&&!y){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var F=this.root.domFrag().oneElement(),z=F.scrollLeft;T(this.getScrollAnimationDuration(),function(bt,_t,Hr){bt>=1?(d.cancelScrollHoriz=void 0,F.scrollLeft=0,d.setOverflowClasses()):(d.cancelScrollHoriz=Hr,_t(),F.scrollLeft=Math.round((1-bt)*z))});return}else if(y){var He=S(y.domFrag().oneElement()),_e=He.left-(E.left+20),Ie=He.right-(E.right-20);if(y.getEnd(r)===m[e])if(_e<0)var ue=_e;else if(Ie>0)if(He.left-Ie<E.left+20)var ue=_e;else var ue=Ie;else return;else if(Ie>0)var ue=Ie;else if(_e<0)if(He.right-_e>E.right-20)var ue=Ie;else var ue=_e;else return}else{var ee=S(m.domFrag().oneElement()).left;if(ee>E.right-20)var ue=ee-(E.right-20);else if(ee<E.left+20)var ue=ee-(E.left+20);else return}var We=this.root.domFrag().oneElement();if(!(ue<0&&We.scrollLeft===0)&&!(ue>0&&We.scrollWidth<=We.scrollLeft+E.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var Ze=this.root.domFrag().oneElement(),pt=Ze.scrollLeft;T(this.getScrollAnimationDuration(),function(bt,_t,Hr){bt>=1?(d.cancelScrollHoriz=void 0,Ze.scrollLeft=Math.round(pt+ue),d.setOverflowClasses()):(d.cancelScrollHoriz=Hr,_t(),Ze.scrollLeft=Math.round(pt+bt*ue))})}},f.prototype.getScrollAnimationDuration=function(){var d;return(d=this.options.scrollAnimationDuration)!==null&&d!==void 0?d:100},f}(xt);ce.prototype.substituteTextarea=function(){return l("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0})};function Ft(v,f){return dt(v[0],f)}ce.prototype.substituteKeyboardEvents=Ft;var In=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.selectFn=n,d}return f.prototype.createTextarea=function(){this.textareaSpan=l("span",{class:"dcg-mq-textarea"});var d=this.options.substituteTextarea();if(!d.nodeType)throw"substituteTextarea() must return a DOM element, got "+d;this.textarea=P(d).appendTo(this.textareaSpan).oneElement();var m=this;m.cursor.selectionChanged=function(){m.selectionChanged()}},f.prototype.selectionChanged=function(){var d=this;d.textareaSelectionTimeout||(d.textareaSelectionTimeout=setTimeout(function(){d.setTextareaSelection()}))},f.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var d="";this.cursor.selection&&(d=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(d="$"+d+"$")),this.selectFn(d)},f.prototype.staticMathTextareaEvents=function(){var d=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),d.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){d.setTextareaSelection()}}),this.addStaticFocusBlurListeners(),d.selectFn=function(m){var y=d.getTextareaOrThrow();y instanceof HTMLTextAreaElement&&(y.value=m,m&&y.select())}},f.prototype.editablesTextareaEvents=function(){var d=this,m=d.getTextareaOrThrow(),y=d.getTextareaSpanOrThrow();if(this.options.version<3){var E=this.options.assertJquery(),F=this.options.substituteKeyboardEvents(E(m),this);this.selectFn=function(ee){F.select(ee)}}else{var z=dt(m,this).select;this.selectFn=z}P(this.container).prepend(P(y)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},f.prototype.unbindEditablesEvents=function(){var d=this,m=d.getTextareaOrThrow(),y=d.getTextareaSpanOrThrow();this.selectFn=function(E){m instanceof HTMLTextAreaElement&&(m.value=E,E&&m.select())},P(y).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),d.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},f.prototype.typedText=function(d){if(d===`
`)return this.handle("enter");var m=this.notify(void 0).cursor;m.parent.write(m,d),this.scrollHoriz()},f.prototype.cut=function(){var d=this,m=d.cursor;m.selection&&setTimeout(function(){d.notify("edit"),m.parent.bubble(function(y){y.reflow()}),d.options&&d.options.onCut&&d.options.onCut()})},f.prototype.copy=function(){this.setTextareaSelection()},f.prototype.paste=function(d){this.options.statelessClipboard&&(d.slice(0,1)==="$"&&d.slice(-1)==="$"?d=d.slice(1,-1):d="\\text{"+d+"}"),this.writeLatex(d).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},f.prototype.setupStaticField=function(){this.mathspeakSpan=l("span",{class:"dcg-mq-mathspeak"}),P(this.container).prepend(P(this.mathspeakSpan)),this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},f.prototype.updateMathspeak=function(){var d=this,m=d.getAriaLabel(),y=/[A-Za-z0-9]$/.test(m)?m+":":m,E=d.root.mathspeak().trim();this.aria.clear();var F=d.getTextareaOrThrow();d.mathspeakSpan?(F.setAttribute("aria-label",""),d.mathspeakSpan.textContent=(y+" "+E).trim()):F.setAttribute("aria-label",(y+" "+E+" "+d.ariaPostLabel).trim())},f}(il),no=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.finalizeInsert=function(d,m){var y=this;y.postOrder(function(z){z.finalizeTree(d)}),y.postOrder(function(z){z.contactWeld(m)}),y.postOrder(function(z){z.blur(m)}),y.postOrder(function(z){z.reflow()});var E=y[e],F=y[r];E&&E.siblingCreated(d,r),F&&F.siblingCreated(d,e),y.bubble(function(z){z.reflow()})},f.prototype.prepareInsertionAt=function(d){var m=d.options.maxDepth;if(m!==void 0){var y=d.depth();if(y>m)return!1;this.removeNodesDeeperThan(m-y)}return!0},f.prototype.removeNodesDeeperThan=function(d){for(var m=0,y=[[this,m]],E;E=y.shift();){var F=E;F[0].children().each(function(z){var ee=z instanceof Qr?1:0;m=F[1]+ee,m<=d?y.push([z,m]):(ee?z.children():z).remove()})}},f}(Ne),Vi=function(){function v(f,d){this.childCount=f,this.render=d}return v}(),Qi=function(v){Dt(f,v);function f(d,m,y){var E=v.call(this)||this;return E.textTemplate=[""],E.mathspeakTemplate=[""],E.setCtrlSeqHtmlAndText(d,m,y),E}return f.prototype.setEnds=function(d){o("MathCommand ends are never empty",d[r]&&d[e]),this.ends=d},f.prototype.getEnd=function(d){return this.ends[d]},f.prototype.setCtrlSeqHtmlAndText=function(d,m,y){this.ctrlSeq||(this.ctrlSeq=d),m&&(this.domView=m),y&&(this.textTemplate=y)},f.prototype.replaces=function(d){d.disown(),this.replacedFragment=d},f.prototype.isEmpty=function(){return this.foldChildren(!0,function(d,m){return d&&m.isEmpty()})},f.prototype.parser=function(){var d=this,m=st.block;return m.times(this.numBlocks()).map(function(y){d.blocks=y;for(var E=0;E<y.length;E+=1)y[E].adopt(d,d.getEnd(e),0);return d})},f.prototype.createLeftOf=function(d){var m=this,y=m.replacedFragment;if(m.createBlocks(),v.prototype.createLeftOf.call(this,d),y){var E=m.getEnd(r);y.adopt(E,0,0),y.domFrag().appendTo(E.domFrag().oneElement()),m.placeCursor(d),m.prepareInsertionAt(d)}m.finalizeInsert(d.options,d),m.placeCursor(d)},f.prototype.createBlocks=function(){for(var d=this,m=d.numBlocks(),y=d.blocks=Array(m),E=0;E<m;E+=1){var F=y[E]=new Qr;F.adopt(d,d.getEnd(e),0)}},f.prototype.placeCursor=function(d){d.insAtRightEnd(this.foldChildren(this.getEnd(r),function(m,y){return m.isEmpty()?m:y}))},f.prototype.moveTowards=function(d,m,y){var E;y==="up"?E=this.upInto:y==="down"&&(E=this.downInto);var F=E||this.getEnd(-d);m.insAtDirEnd(-d,F),m.controller.aria.queueDirEndOf(-d).queue(m.parent,!0)},f.prototype.deleteTowards=function(d,m){this.isEmpty()?m[d]=this.remove()[d]:this.moveTowards(d,m)},f.prototype.selectTowards=function(d,m){m[-d]=this,m[d]=this[d]},f.prototype.selectChildren=function(){return new ye(this,this)},f.prototype.unselectInto=function(d,m){var y=m.anticursor,E=y.ancestors[this.id];m.insAtDirEnd(-d,E)},f.prototype.seek=function(d,m){function y(ee){var ue,He=ee.domFrag().oneElement(),_e=S(He).left,Ie=_e+He.offsetWidth;return ue={},ue[r]=_e,ue[e]=Ie,ue}var E=this,F=y(E);if(d<F[r])return m.insLeftOf(E);if(d>F[e])return m.insRightOf(E);var z=F[r];E.eachChild(function(ee){var ue=y(ee);if(d<ue[r])return d-z<ue[r]-d?ee[r]?m.insAtRightEnd(ee[r]):m.insLeftOf(E):m.insAtLeftEnd(ee),!1;if(d>ue[e]){ee[e]?z=ue[e]:F[e]-d<d-ue[e]?m.insRightOf(E):m.insAtRightEnd(ee);return}else return ee.seek(d,m),!1})},f.prototype.numBlocks=function(){return this.domView.childCount},f.prototype.html=function(){var d=this.blocks;o("domView is defined",this.domView);var m=this.domView,y=m.render(d||[]);return this.setDOM(y),w.linkElementByCmdNode(y,this),y},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.ctrlSeq||"",this.eachChild(function(m){d.latex+="{";var y=d.latex.length;m.latexRecursive(d);var E=d.latex.length;y===E&&(d.latex+=" "),d.latex+="}"}),this.checkCursorContextClose(d)},f.prototype.text=function(){var d=this,m=0;return d.foldChildren(d.textTemplate[m],function(y,E){m+=1;var F=E.text();return y&&d.textTemplate[m]==="("&&F[0]==="("&&F.slice(-1)===")"?y+F.slice(1,-1)+d.textTemplate[m]:y+F+(d.textTemplate[m]||"")})},f.prototype.mathspeak=function(){var d=this,m=0;return d.foldChildren(d.mathspeakTemplate[m]||"Start"+d.ctrlSeq+" ",function(y,E){return m+=1,y+" "+E.mathspeak()+" "+(d.mathspeakTemplate[m]+" "||"End"+d.ctrlSeq+" ")})},f}(no),On=function(v){Dt(f,v);function f(d,m,y,E){var F=v.call(this)||this;return F.setCtrlSeqHtmlTextAndMathspeak(d,m?new Vi(0,function(){return m.cloneNode(!0)}):void 0,y,E),F}return f.prototype.setCtrlSeqHtmlTextAndMathspeak=function(d,m,y,E){!y&&d&&(y=d.replace(/^\\/,"")),this.mathspeakName=E||y,v.prototype.setCtrlSeqHtmlAndText.call(this,d,m,[y||""])},f.prototype.parser=function(){return Et.succeed(this)},f.prototype.numBlocks=function(){return 0},f.prototype.replaces=function(d){d.remove()},f.prototype.createBlocks=function(){},f.prototype.moveTowards=function(d,m){m.domFrag().insDirOf(d,this.domFrag()),m[-d]=this,m[d]=this[d],m.controller.aria.queue(this)},f.prototype.deleteTowards=function(d,m){m[d]=this.remove()[d]},f.prototype.seek=function(d,m){var y=this.domFrag().oneElement(),E=S(y).left;return d-E<y.offsetWidth/2?m.insLeftOf(this):m.insRightOf(this),m},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.ctrlSeq||"",this.checkCursorContextClose(d)},f.prototype.text=function(){return this.textTemplate.join("")},f.prototype.mathspeak=function(d){return this.mathspeakName||""},f.prototype.placeCursor=function(){},f.prototype.isEmpty=function(){return!0},f}(Qi),pa=function(v){Dt(f,v);function f(d,m,y){return v.call(this,d,l("span",{},[m||l.text(d)]),void 0,y)||this}return f}(On);function Wt(v,f,d){return function(){return new pa(v,f?l.entityText(f):void 0,d)}}var vi=function(v){Dt(f,v);function f(d,m,y,E,F){var z=this;return F?z=v.call(this,d,l("span",{},[m||l.text(d||"")]),void 0,E)||this:z=v.call(this,d,l("span",{class:"dcg-mq-binary-operator"},m?[m]:[]),y,E)||this,z}return f}(On);function xo(v,f,d,m){return function(){return new vi(v,f?l.entityText(f):void 0,d,m)}}var Qr=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ariaLabel="block",d}return f.prototype.join=function(d){return this.foldChildren("",function(m,y){return m+y[d]()})},f.prototype.html=function(){var d=document.createDocumentFragment();return this.eachChild(function(m){var y=m.html();d.appendChild(y)}),d},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),this.eachChild(function(m){return m.latexRecursive(d)}),this.checkCursorContextClose(d)},f.prototype.text=function(){var d=this.getEnd(r),m=this.getEnd(e);return d===m&&d!==0?d.text():this.join("text")},f.prototype.mathspeak=function(){var d="",m={};return this.controller&&(m=this.controller.options.autoOperatorNames),this.foldChildren([],function(y,E){if(E.isPartOfOperator)d+=E.mathspeak();else{if(d!==""){if(m._maxLength>0){var F=m[d.toLowerCase()];typeof F=="string"&&(d=F)}y.push(d+" "),d=""}var z=E.mathspeak(),ee=E.ctrlSeq;isNaN(ee)&&ee!=="."&&(!E.parent||!E.parent.parent||!E.parent.parent.isTextBlock())&&(z=" "+z+" "),y.push(z)}return y}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(y,E,F){return E+F.split("").join(" ").trim()})},f.prototype.keystroke=function(d,m,y){if(y.options.spaceBehavesLikeTab&&(d==="Spacebar"||d==="Shift-Spacebar")){m==null||m.preventDefault(),y.escapeDir(d==="Shift-Spacebar"?r:e,d,m);return}return v.prototype.keystroke.call(this,d,m,y)},f.prototype.moveOutOf=function(d,m,y){var E;if(y==="up"?E=this.parent.upInto:y==="down"&&(E=this.parent.downInto),!E&&this[d]){var F=-d;m.insAtDirEnd(F,this[d]),m.controller.aria.queueDirEndOf(F).queue(m.parent,!0)}else m.insDirOf(d,this.parent),m.controller.aria.queueDirOf(d).queue(this.parent)},f.prototype.selectOutOf=function(d,m){m.insDirOf(d,this.parent)},f.prototype.deleteOutOf=function(d,m){m.unwrapGramp()},f.prototype.seek=function(d,m){var y=this.getEnd(e);if(!y)return m.insAtRightEnd(this);var E=y.domFrag().oneElement(),F=S(E).left;if(F+E.offsetWidth<d)return m.insAtRightEnd(this);var z=this.getEnd(r);if(d<S(z.domFrag().oneElement()).left)return m.insAtLeftEnd(this);for(;d<S(y.domFrag().oneElement()).left;)y=y[r];return y.seek(d,m)},f.prototype.chToCmd=function(d,m){var y;return d.match(/^[a-eg-zA-Z]$/)?new oe(d):/^\d$/.test(d)?new $(d):m&&m.typingSlashWritesDivisionSymbol&&d==="/"?M["\xF7"](d):m&&m.typingAsteriskWritesTimesSymbol&&d==="*"?M["\xD7"](d):m&&m.typingPercentWritesPercentOf&&d==="%"?M.percentof(d):(y=ae[d]||M[d])?y.constructor?new y(d):y(d):new pa(d)},f.prototype.write=function(d,m){var y=this.chToCmd(m,d.options);d.selection&&y.replaces(d.replaceSelection()),d.isTooDeep()||(y.createLeftOf(d.show()),m==="/"?d.controller.aria.alert("over"):d.controller.aria.alert(y.mathspeak({createdLeftOf:d})))},f.prototype.writeLatex=function(d,m){var y=Et.all,E=Et.eof,F=st.skip(E).or(y.result(!1)).parse(m);if(F&&!F.isEmpty()&&F.prepareInsertionAt(d)){F.children().adopt(d.parent,d[r],d[e]),P(F.html()).insertBefore(d.domFrag()),d[r]=F.getEnd(e),F.finalizeInsert(d.options,d);var z=F.getEnd(e),ee=F.getEnd(r),ue=z[e],He=ee[r];ue&&ue.siblingCreated(d.options,r),He&&He.siblingCreated(d.options,e),d.parent.bubble(function(_e){_e.reflow()})}},f.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},f.prototype.blur=function(d){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),d&&this.isQuietEmptyDelimiter(d.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},f}(no);ce.prototype.mouseEvents=!0,Se.StaticMath=function(v){var f;return f=function(d){Dt(m,d);function m(y){var E=d.call(this,y)||this,F=E.innerFields=[];return E.__controller.root.postOrder(function(z){z.registerInnerField(F,v.InnerMathField)}),E}return m.prototype.__mathquillify=function(y,E){return this.config(y),d.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&(this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents()),this},m.prototype.latex=function(y){var E=d.prototype.latex.apply(this,arguments);if(arguments.length>0){var F=this.innerFields=[];this.__controller.root.postOrder(function(z){z.registerInnerField(F,v.InnerMathField)}),this.__controller.updateMathspeak()}return E},m.prototype.setAriaLabel=function(y){return this.__controller.setAriaLabel(y),this},m.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},m}(v.AbstractMathQuill),f.RootBlock=Qr,f};var Yd=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f}(Qr);xi(Yd.prototype),Se.MathField=function(v){var f;return f=function(d){Dt(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.prototype.__mathquillify=function(y,E){return this.config(y),E>1&&(this.__controller.root.reflow=n),d.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},m}(v.EditableField),f.RootBlock=Yd,f},Se.InnerMathField=function(v){return o("MathField class is defined",v.MathField),function(f){Dt(d,f);function d(){return f!==null&&f.apply(this,arguments)||this}return d.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),P(this.__controller.container).removeClass("dcg-mq-editable-field")},d.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),P(this.__controller.container).addClass("dcg-mq-editable-field")},d}(v.MathField)};var N=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.finalizeTree=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.siblingDeleted=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.siblingCreated=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.sharedSiblingMethod=function(d,m){m!==r&&this[e]instanceof f||this.fixDigitGrouping(d)},f.prototype.fixDigitGrouping=function(d){if(d.enableDigitGrouping){var m=this,y=this,E=0,F=[],z="\\ ",ee=".",ue=m;do if(/^[0-9]$/.test(ue.ctrlSeq))m=ue;else if(ue.ctrlSeq===z)m=ue,E+=1;else if(ue.ctrlSeq===ee)m=ue,F.push(ue);else break;while(ue=m[r]);for(;ue=y[e];)if(/^[0-9]$/.test(ue.ctrlSeq))y=ue;else if(ue.ctrlSeq===z)y=ue,E+=1;else if(ue.ctrlSeq===ee)y=ue,F.push(ue);else break;for(;y!==m&&m&&m.ctrlSeq===z;)m=m[e],E-=1;for(;y!==m&&y&&y.ctrlSeq===z;)y=y[r],E-=1;if(!(m===y&&m&&m.ctrlSeq===z)){var He=E>0||F.length>1;He?this.removeGroupingBetween(m,y):F[0]?(F[0]!==m&&this.addGroupingBetween(F[0][r],m),F[0]!==y&&this.removeGroupingBetween(F[0][e],y)):this.addGroupingBetween(y,m)}}},f.prototype.removeGroupingBetween=function(d,m){var y=d;do if(y instanceof f&&y.setGroupingClass(void 0),!y||y===m)break;while(y=y[e])},f.prototype.addGroupingBetween=function(d,m){for(var z=d,y=0,E=0,z=d;z&&(E+=1,z!==m);)z=z[r];var F=E%3;F===0&&(F=3);for(var z=d;z;){y+=1;var ee=void 0;if(E>=4&&(y===E?ee="dcg-mq-group-leading-"+F:y%3===0&&y!==E&&(ee="dcg-mq-group-start"),ee||(ee="dcg-mq-group-other")),z instanceof f&&z.setGroupingClass(ee),z===m)break;z=z[r]}},f.prototype.setGroupingClass=function(d){this._groupingClass!==d&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),d&&this.domFrag().addClass(d),this._groupingClass=d)},f}(On),$=function(v){Dt(f,v);function f(d,m){return v.call(this,d,l("span",{class:"dcg-mq-digit"},[l.text(d)]),void 0,m)||this}return f.prototype.createLeftOf=function(d){var m=d[r],y=m&&m[r],E=d.parent.parent instanceof ol?d.parent.parent.sub:void 0;d.options.autoSubscriptNumerals&&d.parent!==E&&(m instanceof Z&&m.isItalic!==!1||m instanceof ol&&y instanceof Z&&y.isItalic!==!1)?(new tC().createLeftOf(d),v.prototype.createLeftOf.call(this,d),d.insRightOf(d.parent.parent)):v.prototype.createLeftOf.call(this,d)},f.prototype.mathspeak=function(d){if(d&&d.createdLeftOf){var m=d.createdLeftOf,y=m[r],E=y&&y[r],F=m.parent.parent instanceof ol?m.parent.parent.sub:void 0;if(m.options.autoSubscriptNumerals&&m.parent!==F&&(y instanceof Z&&y.isItalic!==!1||m[r]instanceof ol&&E instanceof Z&&E.isItalic!==!1))return"Subscript "+v.prototype.mathspeak.call(this)+" Baseline"}return v.prototype.mathspeak.call(this)},f}(N),Z=function(v){Dt(f,v);function f(d,m){return v.call(this,d,l("var",{},[m||l.text(d)]))||this}return f.prototype.text=function(){var d=this.ctrlSeq||"";return this.isPartOfOperator?d[0]=="\\"?d=d.slice(1,d.length):d[d.length-1]==" "&&(d=d.slice(0,-1)):(this[r]&&!(this[r]instanceof f)&&!(this[r]instanceof vi)&&this[r].ctrlSeq!=="\\ "&&(d="*"+d),this[e]&&!(this[e]instanceof vi)&&!(this[e]instanceof ol)&&(d+="*")),d},f.prototype.mathspeak=function(){var d=this.ctrlSeq||"";return this.isPartOfOperator||d.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?v.prototype.mathspeak.call(this):'"'+d+'"'},f}(On);function be(v,f,d){return function(){return new Z(v,l.entityText(f))}}ce.prototype.autoCommands={_maxLength:0},U.autoCommands=function(v){if(typeof v!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(v))throw'"'+v+'" not a space-delimited list of only letters';for(var f=v.split(" "),d={},m=0,y=0;y<f.length;y+=1){var E=f[y];if(E.length<2)throw'autocommand "'+E+'" not minimum length of 2';if(M[E]===rt)throw'"'+E+'" is a built-in operator name';d[E]=1,m=i(m,E.length)}return d._maxLength=m,d},ce.prototype.quietEmptyDelimiters={},U.quietEmptyDelimiters=function(v){v===void 0&&(v="");for(var f=v.split(" "),d={},m=0;m<f.length;m+=1){var y=f[m];d[y]=1}return d},ce.prototype.autoParenthesizedFunctions={_maxLength:0},U.autoParenthesizedFunctions=function(v){if(typeof v!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(v))throw'"'+v+'" not a space-delimited list of only letters';for(var f=v.split(" "),d={},m=0,y=0;y<f.length;y+=1){var E=f[y];if(E.length<2)throw'autocommand "'+E+'" not minimum length of 2';d[E]=1,m=i(m,E.length)}return d._maxLength=m,d};var oe=function(v){Dt(f,v);function f(d){var m=v.call(this,d)||this;return m.letter=d,m}return f.prototype.checkAutoCmds=function(d){if(!this.shouldIgnoreSubstitutionInSimpleSubscript(d.options)){var m=d.options.autoCommands,y=m._maxLength||0;if(y>0){for(var E="",F=this,z=0;F instanceof f&&F.ctrlSeq===F.letter&&z<y;)E=F.letter+E,F=F[r],z+=1;for(;E.length;){if(m.hasOwnProperty(E)){for(F=this,z=1;F&&z<E.length;z+=1,F=F[r]);new q(F,this).remove(),d[r]=F[r];var ee=M[E],ue;return se(ee)?ue=new ee(E):ue=ee(E),ue.createLeftOf(d)}E=E.slice(1)}}}},f.prototype.autoParenthesize=function(d){var m=d.parent.getEnd(e);if(!(m&&m instanceof sl&&m.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(d.options)){for(var y="",E=this,F=0,z=d.options.autoParenthesizedFunctions,ee=z._maxLength||0,ue=d.options.autoOperatorNames;E instanceof f&&F<ee;)y=E.letter+y,E=E[r],F+=1;for(;y.length;){if(z.hasOwnProperty(y)&&ue.hasOwnProperty(y))return d.parent.write(d,"(");y=y.slice(1)}}},f.prototype.createLeftOf=function(d){v.prototype.createLeftOf.call(this,d),this.checkAutoCmds(d),this.autoParenthesize(d)},f.prototype.italicize=function(d){return this.isItalic=d,this.isPartOfOperator=!d,this.domFrag().toggleClass("dcg-mq-operator-name",!d),this},f.prototype.finalizeTree=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.siblingDeleted=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.siblingCreated=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.sharedSiblingMethod=function(d,m){m!==r&&this[e]instanceof f||this.autoUnItalicize(d)},f.prototype.autoUnItalicize=function(d){var m=d.autoOperatorNames;if(m._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(d)){for(var y=this.letter,E=this[r];E instanceof f;E=E[r])y=E.letter+y;for(var F=this[e];F instanceof f;F=F[e])y+=F.letter;var z=E&&E[e],ee=F&&F[r];new q(z||this.parent.getEnd(r),ee||this.parent.getEnd(e)).each(function(Zs){Zs instanceof f&&(Zs.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),Zs.ctrlSeq=Zs.letter)});var ue=m._maxLength||0;e:for(var He=0,_e=E[e]||this.parent.getEnd(r);_e&&He<y.length;He+=1,_e=_e[e])for(var Ie=t(ue,y.length-He);Ie>0;Ie-=1){var We=y.slice(He,He+Ie),Ze=void 0;if(m.hasOwnProperty(We)){for(var pt=0,bt=_e;pt<Ie;pt+=1,bt=bt[e])bt instanceof f&&(bt.italicize(!1),Ze=bt);var _t=Ce.hasOwnProperty(We);if(_e.ctrlSeq=(_t?"\\":"\\operatorname{")+_e.ctrlSeq,Ze.ctrlSeq+=_t?" ":"}",Pe.hasOwnProperty(We)){var Hr=Ze[r],Vn=Hr&&Hr[r],Zr=Vn&&Vn[r];Zr.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(_e[r])||_e.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(Ze[e]))if(Ze[e]instanceof ol){var Pn=Ze[e],ha=Pn.siblingCreated=Pn.siblingDeleted=function(){Pn.domFrag().toggleClass("dcg-mq-after-operator-name",!(Pn[e]instanceof sl))};ha()}else Ze.domFrag().toggleClass("dcg-mq-last",!(Ze[e]instanceof sl));He+=Ie-1,_e=Ze;continue e}}}},f.prototype.shouldOmitPadding=function(d){return!d||d.ctrlSeq==="."||d instanceof vi||d instanceof uc},f}(Z),Ce={};ce.prototype.autoOperatorNames=Be();var Pe={limsup:1,liminf:1,projlim:1,injlim:1};function Be(){for(var v={_maxLength:9},f="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),d=0;d<f.length;d+=1)Ce[f[d]]=v[f[d]]=1;for(var m="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),d=0;d<m.length;d+=1)Ce[m[d]]=1;for(var y="sin cos tan sec cosec csc cotan cot ctg".split(" "),d=0;d<y.length;d+=1)v[y[d]]=v["arc"+y[d]]=v[y[d]+"h"]=v["ar"+y[d]+"h"]=v["arc"+y[d]+"h"]=1;for(var E="gcf hcf lcm proj span".split(" "),d=0;d<E.length;d+=1)v[E[d]]=1;return v}U.autoOperatorNames=function(v){if(typeof v!="string")throw'"'+v+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(v))throw'"'+v+'" not a space-delimited list of letters or "|"';for(var f=v.split(" "),d={},m=0,y=0;y<f.length;y+=1){var E=f[y];if(E.length<2)throw'"'+E+'" not minimum length of 2';if(E.indexOf("|")<0)d[E]=E,m=i(m,E.length);else{var F=E.split("|");if(F.length>2)throw'"'+E+'" has more than 1 mathspeak delimiter';if(F[0].length<2)throw'"'+E[0]+'" not minimum length of 2';d[F[0]]=F[1].replace(/-/g," "),m=i(m,F[0].length)}}return d._maxLength=m,d};var rt=function(v){Dt(f,v);function f(d){return v.call(this,d||"")||this}return f.prototype.createLeftOf=function(d){for(var m=this.ctrlSeq,y=0;y<m.length;y+=1)new oe(m.charAt(y)).createLeftOf(d)},f.prototype.parser=function(){for(var d=this.ctrlSeq,m=new Qr,y=0;y<d.length;y+=1)new oe(d.charAt(y)).adopt(m,m.getEnd(e),0);return Et.succeed(m.children())},f}(On);for(var At in ce.prototype.autoOperatorNames)ce.prototype.autoOperatorNames.hasOwnProperty(At)&&(M[At]=rt);M.operatorname=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(){},f.prototype.numBlocks=function(){return 1},f.prototype.parser=function(){return st.block.map(function(d){var m=!0,y="",E=d.children();return E.each(function(F){F instanceof oe?y+=F.letter:m=!1}),m&&y==="ans"?rC():E})},f}(Qi),M.f=function(v){Dt(f,v);function f(){var d=this,m="f";return d=v.call(this,m)||this,d.letter=m,d.domView=new Vi(0,function(){return l("var",{class:"dcg-mq-f"},[l.text("f")])}),d}return f.prototype.italicize=function(d){return this.domFrag().eachElement(function(m){return m.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",d),v.prototype.italicize.call(this,d)},f}(oe),M[" "]=M.space=function(){return new N("\\ ",l("span",{},[l.text(u)])," ")},M["."]=function(){return new N(".",l("span",{class:"dcg-mq-digit"},[l.text(".")]),".")},M["'"]=M.prime=Wt("'","&prime;","prime"),M["\u2033"]=M.dprime=Wt("\u2033","&Prime;","double prime"),M.backslash=Wt("\\backslash ","\\","backslash"),ae["\\"]||(ae["\\"]=M.backslash),M.$=Wt("\\$","$","dollar"),M.square=Wt("\\square ","\u25A1","square"),M.mid=Wt("\\mid ","\u2223","mid");var yt=function(v){Dt(f,v);function f(d,m,y){return v.call(this,d,l("span",{class:"dcg-mq-nonSymbola"},[m||l.text(d)]))||this}return f}(On);M["@"]=function(){return new yt("@")},M["&"]=function(){return new yt("\\&",l.entityText("&amp;"),"and")},M["%"]=function(v){Dt(f,v);function f(){return v.call(this,"\\%",l.text("%"),"percent")||this}return f.prototype.parser=function(){var d=Et.optWhitespace,m=Et.string;return d.then(m("\\operatorname{of}").map(function(){return iC()})).or(v.prototype.parser.call(this))},f}(yt),M["\u2225"]=M.parallel=Wt("\\parallel ","&#x2225;","parallel"),M["\u2226"]=M.nparallel=Wt("\\nparallel ","&#x2226;","not parallel"),M["\u27C2"]=M.perp=Wt("\\perp ","&#x27C2;","perpendicular"),M.alpha=M.beta=M.gamma=M.delta=M.zeta=M.eta=M.theta=M.iota=M.kappa=M.mu=M.nu=M.xi=M.rho=M.sigma=M.tau=M.chi=M.psi=M.omega=function(v){return new Z("\\"+v+" ",l.entityText("&"+v+";"))},M.phi=be("\\phi ","&#981;","phi"),M.phiv=M.varphi=be("\\varphi ","&phi;","phi"),M.epsilon=be("\\epsilon ","&#1013;","epsilon"),M.epsiv=M.varepsilon=be("\\varepsilon ","&epsilon;","epsilon"),M.piv=M.varpi=be("\\varpi ","&piv;","piv"),M.sigmaf=M.sigmav=M.varsigma=be("\\varsigma ","&sigmaf;","sigma"),M.thetav=M.vartheta=M.thetasym=be("\\vartheta ","&thetasym;","theta"),M.upsilon=M.upsi=be("\\upsilon ","&upsilon;","upsilon"),M.gammad=M.Gammad=M.digamma=be("\\digamma ","&#989;","gamma"),M.kappav=M.varkappa=be("\\varkappa ","&#1008;","kappa"),M.rhov=M.varrho=be("\\varrho ","&#1009;","rho"),M.pi=M.\u03C0=function(){return new yt("\\pi ",l.entityText("&pi;"),"pi")},M.lambda=function(){return new yt("\\lambda ",l.entityText("&lambda;"),"lambda")},M.Upsilon=M.Upsi=M.upsih=M.Upsih=function(){return new On("\\Upsilon ",l("var",{style:"font-family: serif"},[l.entityText("&upsih;")]),"capital upsilon")},M.Gamma=M.Delta=M.Theta=M.Lambda=M.Xi=M.Pi=M.Sigma=M.Phi=M.Psi=M.Omega=M.forall=function(v){return new pa("\\"+v+" ",l.entityText("&"+v+";"))};var vt=function(v){Dt(f,v);function f(d){var m=v.call(this)||this;return m.latexStr=d,m}return f.prototype.createLeftOf=function(d){var m=st.parse(this.latexStr);m.children().adopt(d.parent,d[r],d[e]),d[r]=m.getEnd(e),P(m.html()).insertBefore(d.domFrag()),m.finalizeInsert(d.options,d);var y=m.getEnd(e),E=y&&y[e];E&&E.siblingCreated(d.options,r);var F=m.getEnd(r),z=F&&F[r];z&&z.siblingCreated(d.options,e),d.parent.bubble(function(ee){ee.reflow()})},f.prototype.mathspeak=function(){return st.parse(this.latexStr).mathspeak()},f.prototype.parser=function(){var d=st.parse(this.latexStr).children();return Et.succeed(d)},f}(Qi);M["\u2070"]=function(){return new vt("^0")},M["\xB9"]=function(){return new vt("^1")},M["\xB2"]=function(){return new vt("^2")},M["\xB3"]=function(){return new vt("^3")},M["\u2074"]=function(){return new vt("^4")},M["\u2075"]=function(){return new vt("^5")},M["\u2076"]=function(){return new vt("^6")},M["\u2077"]=function(){return new vt("^7")},M["\u2078"]=function(){return new vt("^8")},M["\u2079"]=function(){return new vt("^9")},M["\xBC"]=function(){return new vt("\\frac14")},M["\xBD"]=function(){return new vt("\\frac12")},M["\xBE"]=function(){return new vt("\\frac34")},M["\u221A"]=function(){return new vt("\\sqrt{}")};function jt(v){if(!v)return!1;var f=v[r];if(f){if(f instanceof vi||/^(\\ )|[,;:\(\[]$/.test(f.ctrlSeq))return!1}else return v.parent&&v.parent.parent&&v.parent.parent.isStyleBlock()?jt(v.parent.parent):!1;return!0}var _r=function(v){Dt(f,v);function f(d,m,y){return v.call(this,d,m,void 0,y,!0)||this}return f.prototype.contactWeld=function(d,m){this.sharedSiblingMethod(d.options,m)},f.prototype.siblingCreated=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.siblingDeleted=function(d,m){this.sharedSiblingMethod(d,m)},f.prototype.sharedSiblingMethod=function(d,m){if(m!==e)return this.domFrag().oneElement().className=jt(this)?"dcg-mq-binary-operator":"",this},f}(vi);M["+"]=function(v){Dt(f,v);function f(){return v.call(this,"+",l.text("+"))||this}return f.prototype.mathspeak=function(){return jt(this)?"plus":"positive"},f}(_r);var St=function(v){Dt(f,v);function f(){return v.call(this,"-",l.entityText("&minus;"))||this}return f.prototype.mathspeak=function(){return jt(this)?"minus":"negative"},f}(_r);M["\u2212"]=M["\u2014"]=M["\u2013"]=M["-"]=St,M["\xB1"]=M.pm=M.plusmn=M.plusminus=function(){return new _r("\\pm ",l.entityText("&plusmn;"),"plus-or-minus")},M.mp=M.mnplus=M.minusplus=function(){return new _r("\\mp ",l.entityText("&#8723;"),"minus-or-plus")},ae["*"]=M.sdot=M.cdot=xo("\\cdot ","&middot;","*","times");var Hn=function(v){Dt(f,v);function f(){return v.call(this,"\\to ",l.entityText("&rarr;"),"to")||this}return f.prototype.deleteTowards=function(d,m){if(d===r){var y=m[r];new q(y,this).remove(),m[r]=y[r],new St().createLeftOf(m),m[r].bubble(function(E){E.reflow()});return}v.prototype.deleteTowards.call(this,d,m)},f}(vi);M["\u2192"]=M.to=Hn;var Zi=function(v){Dt(f,v);function f(d,m){var y=this,E=m?"Strict":"";return y=v.call(this,d["ctrlSeq".concat(E)],l.entityText(d["htmlEntity".concat(E)]),d["text".concat(E)],d["mathspeak".concat(E)])||this,y.data=d,y.strict=m,y}return f.prototype.swap=function(d){this.strict=d;var m=d?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(m)],this.domFrag().children().replaceWith(P(l.entityText(this.data["htmlEntity".concat(m)]))),this.textTemplate=[this.data["text".concat(m)]],this.mathspeakName=this.data["mathspeak".concat(m)]},f.prototype.deleteTowards=function(d,m){if(d===r&&!this.strict){this.swap(!0),this.bubble(function(y){y.reflow()});return}v.prototype.deleteTowards.call(this,d,m)},f}(vi),ss={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"\u2264",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},en={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"\u2265",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},dc=function(v){Dt(f,v);function f(){return v.call(this,en,!0)||this}return f.prototype.createLeftOf=function(d){var m=d[r];if(m instanceof vi&&m.ctrlSeq==="-"){var y=m;d[r]=y[r],y.remove(),new Hn().createLeftOf(d),d[r].bubble(function(E){E.reflow()});return}v.prototype.createLeftOf.call(this,d)},f}(Zi);M["<"]=M.lt=function(){return new Zi(ss,!0)},M[">"]=M.gt=dc,M["\u2264"]=M.le=M.leq=function(){return new Zi(ss,!1)},M["\u2265"]=M.ge=M.geq=function(){return new Zi(en,!1)},M.infty=M.infin=M.infinity=Wt("\\infty ","&infin;","infinity"),M["\u2260"]=M.ne=M.neq=xo("\\ne ","&ne;","not equal");var rd=function(v){Dt(f,v);function f(){return v.call(this,"=",l.text("="),"=","equals")||this}return f.prototype.createLeftOf=function(d){var m=d[r];if(m instanceof Zi&&m.strict){m.swap(!1),m.bubble(function(y){y.reflow()});return}v.prototype.createLeftOf.call(this,d)},f}(vi);M["="]=rd,M["\xD7"]=M.times=M.cross=xo("\\times ","&times;","[x]","times"),M["\xF7"]=M.div=M.divide=M.divides=xo("\\div ","&divide;","[/]","over");var as=function(v){Dt(f,v);function f(){return v.call(this,"\\sim ",l.text("~"),"~","tilde")||this}return f.prototype.createLeftOf=function(d){if(d[r]instanceof f){var m=d[r];d[r]=m[r],m.remove(),new eC().createLeftOf(d),d[r].bubble(function(y){y.reflow()});return}v.prototype.createLeftOf.call(this,d)},f}(vi),eC=function(v){Dt(f,v);function f(){return v.call(this,"\\approx ",l.entityText("&approx;"),"\u2248","approximately equal")||this}return f.prototype.deleteTowards=function(d,m){if(d===r){var y=m[r];new q(y,this).remove(),m[r]=y[r],new as().createLeftOf(m),m[r].bubble(function(E){E.reflow()});return}v.prototype.deleteTowards.call(this,d,m)},f}(vi);M.tildeNbsp=Wt("~",u," "),M.sim=as,M["\u2248"]=M.approx=eC,ae["~"]=M.sim,M["~"]=M.tildeNbsp,U.interpretTildeAsSim=function(v){var f=!!v;return f?M["~"]=M.sim:M["~"]=M.tildeNbsp,f};var Xu={sqrt:{width:"",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[l("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[l("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[l("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[l("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[l("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[l("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[l("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},nl=function(v){Dt(f,v);function f(d,m,y,E,F){var z=v.call(this,d,new Vi(1,function(ee){return l.block(m,y,ee[0])}))||this;return z.ariaLabel=E||d.replace(/^\\/,""),z.mathspeakTemplate=["Start"+z.ariaLabel+",","End"+z.ariaLabel],z.shouldNotSpeakDelimiters=F&&F.shouldNotSpeakDelimiters,z}return f.prototype.mathspeak=function(d){return!this.shouldNotSpeakDelimiters||d&&d.ignoreShorthand?v.prototype.mathspeak.call(this):this.foldChildren("",function(m,y){return m+" "+y.mathspeak(d)}).trim()},f}(Qi);M.mathrm=function(v){Dt(f,v);function f(){return v.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return f.prototype.isTextBlock=function(){return!0},f}(nl),M.mathit=function(){return new nl("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},M.mathbf=function(){return new nl("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},M.mathsf=function(){return new nl("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},M.mathtt=function(){return new nl("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},M.underline=function(){return new nl("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},M.overline=M.bar=function(){return new nl("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},M.overrightarrow=function(){return new nl("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right"},"Over Right Arrow")},M.overleftarrow=function(){return new nl("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left"},"Over Left Arrow")},M.overleftrightarrow=function(){return new nl("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright"},"Over Left and Right Arrow")},M.overarc=function(){return new nl("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},M.dot=function(){return new Qi("\\dot",new Vi(1,function(v){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-dot-recurring-inner"},[l("span",{class:"dcg-mq-dot-recurring"},[l.text(g)]),l.block("span",{class:"dcg-mq-empty-box"},v[0])])])}))},M.textcolor=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setColor=function(d){this.color=d,this.domView=new Vi(1,function(m){return l.block("span",{class:"dcg-mq-textcolor",style:"color:"+d},m[0])}),this.ariaLabel=d.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d);var m=this.blocks[0];d.latex+="\\textcolor{"+this.color+"}{",m.latexRecursive(d),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.parser=function(){var d=this,m=Et.optWhitespace,y=Et.string,E=Et.regex;return m.then(y("{")).then(E(/^[#\w\s.,()%-]*/)).skip(y("}")).then(function(F){return d.setColor(F),v.prototype.parser.call(d)})},f.prototype.isStyleBlock=function(){return!0},f}(Qi);var s1=M.class=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.parser=function(){var d=this,m=Et.string,y=Et.regex;return Et.optWhitespace.then(m("{")).then(y(/^[-\w\s\\\xA0-\xFF]*/)).skip(m("}")).then(function(E){return d.cls=E||"",d.domView=new Vi(1,function(F){return l.block("span",{class:"dcg-mq-class ".concat(E)},F[0])}),d.ariaLabel=E+" class",d.mathspeakTemplate=["Start "+d.ariaLabel+",","End "+d.ariaLabel],v.prototype.parser.call(d)})},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d);var m=this.blocks[0];d.latex+="\\class{"+this.cls+"}{",m.latexRecursive(d),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.isStyleBlock=function(){return!0},f}(Qi),Xd=/^[\+\-]?[\d]+$/;function zy(v){if(!v)return"";var f="";return v.eachChild(function(d){d.ctrlSeq!==void 0&&(f+=d.ctrlSeq)}),f}ce.prototype.charsThatBreakOutOfSupSub="";var ol=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="_{...}^{...}",d}return f.prototype.setEnds=function(d){o("SupSub ends must be MathBlocks",d[r]instanceof Qr&&d[e]instanceof Qr),this.ends=d},f.prototype.getEnd=function(d){return this.ends[d]},f.prototype.createLeftOf=function(d){if(!(!this.replacedFragment&&!d[r]&&d.options.supSubsRequireOperand))return v.prototype.createLeftOf.call(this,d)},f.prototype.contactWeld=function(d){for(var m=r;m;m=m===r?e:!1){var y=this[m],E=void 0;if(y instanceof f){for(var F="sub";F;F=F==="sub"?"sup":!1){var z=this[F],ee=y[F];if(z){if(!ee)y.addBlock(z.disown());else if(z.isEmpty())E=new j(ee,0,ee.getEnd(r));else{z.domFrag().children().insAtDirEnd(-m,ee.domFrag().oneElement());var ue=z.children().disown();E=new j(ee,ue.getEnd(e),ee.getEnd(r)),m===r?ue.adopt(ee,ee.getEnd(e),0):ue.adopt(ee,0,ee.getEnd(r))}this.placeCursor=function(He,_e){return function(Ie){Ie.insAtDirEnd(-m,He||_e)}}(ee,z)}}this.remove(),d&&d[r]===this&&(m===e&&E?E[r]?d.insRightOf(E[r]):d.insAtLeftEnd(E.parent):d.insRightOf(y));break}}},f.prototype.finalizeTree=function(){var d=this.getEnd(r);d.write=function(m,y){if(m.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(y)>=0){var E=this.chToCmd(y,m.options);E instanceof On?m.deleteSelection():m.clearSelection().insRightOf(this.parent),E.createLeftOf(m.show()),m.controller.aria.queue("Baseline").alert(E.mathspeak({createdLeftOf:m}));return}m[r]&&!m[e]&&!m.selection&&m.options.charsThatBreakOutOfSupSub.indexOf(y)>-1&&(m.insRightOf(this.parent),m.controller.aria.queue("Baseline")),Qr.prototype.write.call(this,m,y)}},f.prototype.moveTowards=function(d,m,y){m.options.autoSubscriptNumerals&&!this.sup?m.insDirOf(d,this):v.prototype.moveTowards.call(this,d,m,y)},f.prototype.deleteTowards=function(d,m){if(m.options.autoSubscriptNumerals&&this.sub){var y=this.sub.getEnd(-d);y instanceof On?y.remove():y&&y.deleteTowards(d,m.insAtDirEnd(-d,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(r,m.insAtLeftEnd(this.sub)),this.sup&&m.insDirOf(-d,this))}else v.prototype.deleteTowards.call(this,d,m)},f.prototype.latexRecursive=function(d){if(this.checkCursorContextOpen(d),this.sub){d.latex+="_{";var m=d.latex.length;this.sub.latexRecursive(d);var y=d.latex.length;m===y&&(d.latex+=" "),d.latex+="}"}if(this.sup){d.latex+="^{";var m=d.latex.length;this.sup.latexRecursive(d);var y=d.latex.length;m===y&&(d.latex+=" "),d.latex+="}"}this.checkCursorContextClose(d)},f.prototype.text=function(){function d(m,y){var E=y&&y.text()||"";return y?m+(E.length===1?E:"("+(E||" ")+")"):""}return d("_",this.sub)+d("^",this.sup)},f.prototype.addBlock=function(d){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=d,d.adopt(this,this.sub,0).downOutOf=this.sub,d.setDOM(P(l("span",{class:"dcg-mq-sup"})).append(d.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),w.linkElementByBlockNode(d.domFrag().oneElement(),d)):(this.sub=this.downInto=this.sup.downOutOf=d,d.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),d.setDOM(P(l("span",{class:"dcg-mq-sub"})).append(d.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),w.linkElementByBlockNode(d.domFrag().oneElement(),d),this.domFrag().append(P(l("span",{style:"display:inline-block;width:0"},[l.text(p)]))));for(var m=0;m<2;m+=1)(function(y,E,F,z){var ee=y[E];ee.deleteOutOf=function(ue,He){if(He.insDirOf(this[ue]?-ue:ue,this.parent),!this.isEmpty()){var _e=this.getEnd(ue);this.children().disown().withDirAdopt(ue,He.parent,He[ue],He[-ue]).domFrag().insDirOf(-ue,He.domFrag()),He[-ue]=_e}y.supsub=F,delete y[E],delete y["".concat(z,"Into")];var Ie=y[F];Ie["".concat(z,"OutOf")]=ph,delete Ie.deleteOutOf,E==="sub"&&y.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[m],"sup sub".split(" ")[m],"down up".split(" ")[m])},f}(Qi);function ph(v){var f=this.parent,d=v;do{if(d[e])return v.insLeftOf(f);d=d.parent.parent}while(d!==f);v.insRightOf(f)}var tC=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.supsub="sub",d.domView=new Vi(1,function(m){return l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[l.block("span",{class:"dcg-mq-sub"},m[0]),l("span",{style:"display:inline-block;width:0"},[l.text(p)])])}),d.textTemplate=["_"],d.mathspeakTemplate=["Subscript,",", Baseline"],d.ariaLabel="subscript",d}return f.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(r),this.sub.upOutOf=ph,v.prototype.finalizeTree.call(this)},f}(ol);M.subscript=M._=tC,M.superscript=M.supscript=M["^"]=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.supsub="sup",d.domView=new Vi(1,function(m){return l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[l.block("span",{class:"dcg-mq-sup"},m[0])])}),d.textTemplate=["^(",")"],d.ariaLabel="superscript",d.mathspeakTemplate=["Superscript,",", Baseline"],d}return f.prototype.mathspeak=function(d){var m=this.upInto;if(m!==void 0){var y=zy(m);if((!d||!d.ignoreShorthand)&&Xd.test(y)){if(y==="0")return"to the 0 power";if(y==="2")return"squared";if(y==="3")return"cubed";var E="";/^[+-]?\d{1,3}$/.test(y)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(y)?E="th":/1$/.test(y)?E="st":/2$/.test(y)?E="nd":/3$/.test(y)&&(E="rd"));var F=typeof m=="object"?m.mathspeak():y;return"to the "+F+E+" power"}}return v.prototype.mathspeak.call(this)},f.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(e),this.sup.downOutOf=ph,v.prototype.finalizeTree.call(this)},f}(ol);var uc=function(v){Dt(f,v);function f(d,m,y){var E=v.call(this)||this;E.ariaLabel=y||d.replace(/^\\/,"");var F=new Vi(2,function(z){return l("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-to"},[l.block("span",{},z[1])]),l("big",{},[l.text(m)]),l("span",{class:"dcg-mq-from"},[l.block("span",{},z[0])])])});return On.prototype.setCtrlSeqHtmlTextAndMathspeak.call(E,d,F),E}return f.prototype.createLeftOf=function(d){v.prototype.createLeftOf.call(this,d),d.options.sumStartsWithNEquals&&(new oe("n").createLeftOf(d),new rd().createLeftOf(d))},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.ctrlSeq+"_{";var m=d.latex.length;this.getEnd(r).latexRecursive(d);var y=d.latex.length;y===m&&(d.latex+=" "),d.latex+="}^{",m=d.latex.length,this.getEnd(e).latexRecursive(d),y=d.latex.length,m===y&&(d.latex+=" "),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(r).mathspeak()+" to "+this.getEnd(e).mathspeak()+", end "+this.ariaLabel+", "},f.prototype.parser=function(){for(var d=Et.string,m=Et.optWhitespace,y=Et.succeed,E=st.block,F=this,z=F.blocks=[new Qr,new Qr],ee=0;ee<z.length;ee+=1)z[ee].adopt(F,F.getEnd(e),0);return m.then(d("_").or(d("^"))).then(function(ue){var He=z[ue==="_"?0:1];return E.then(function(_e){return _e.children().adopt(He,He.getEnd(e),0),y(F)})}).many().result(F)},f.prototype.finalizeTree=function(){var d=this.getEnd(r),m=this.getEnd(e);d.ariaLabel="lower bound",m.ariaLabel="upper bound",this.downInto=d,this.upInto=m,d.upOutOf=m,m.downOutOf=d},f}(Qi);M["\u2211"]=M.sum=M.summation=function(){return new uc("\\sum ",h,"sum")},M["\u220F"]=M.prod=M.product=function(){return new uc("\\prod ",b,"product")},M.coprod=M.coproduct=function(){return new uc("\\coprod ",C,"co product")},M["\u222B"]=M.int=M.integral=function(v){Dt(f,v);function f(){var d=v.call(this,"\\int ","","integral")||this;return d.ariaLabel="integral",d.domView=new Vi(2,function(m){return l("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[l("big",{},[l.text(D)]),l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-sup"},[l.block("span",{class:"dcg-mq-sup-inner"},m[1])]),l.block("span",{class:"dcg-mq-sub"},m[0]),l("span",{style:"display:inline-block;width:0"},[l.text(p)])])])}),d}return f.prototype.createLeftOf=function(d){Qi.prototype.createLeftOf.call(this,d)},f}(uc);var MV=M.frac=M.dfrac=M.cfrac=M.fraction=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\frac",d.domView=new Vi(2,function(m){return l("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[l.block("span",{class:"dcg-mq-numerator"},m[0]),l.block("span",{class:"dcg-mq-denominator"},m[1]),l("span",{style:"display:inline-block;width:0"},[l.text(p)])])}),d.textTemplate=["(",")/(",")"],d}return f.prototype.finalizeTree=function(){var d=this.getEnd(r),m=this.getEnd(e);this.upInto=m.upOutOf=d,this.downInto=d.downOutOf=m,d.ariaLabel="numerator",m.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},f.prototype.mathspeak=function(d){if(d&&d.createdLeftOf){var m=d.createdLeftOf;return m.parent.mathspeak()}var y=zy(this.getEnd(r)),E=zy(this.getEnd(e));if((!d||!d.ignoreShorthand)&&Xd.test(y)&&Xd.test(E)){var F=y==="1"||y==="-1",z="";if(E==="2"?z=F?"half":"halves":E==="3"?z=F?"third":"thirds":E==="4"?z=F?"quarter":"quarters":E==="5"?z=F?"fifth":"fifths":E==="6"?z=F?"sixth":"sixths":E==="7"?z=F?"seventh":"sevenths":E==="8"?z=F?"eighth":"eighths":E==="9"&&(z=F?"ninth":"ninths"),z!==""){for(var ee="",ue=!1,He=this[r];He&&He[r]!==void 0;He=He[r])if(He.ctrlSeq!=="\\ ")if(Xd.test(He.ctrlSeq||""))ue=!0;else{ue=!1;break}return ue&&(ee+="and "),ee+=this.getEnd(r).mathspeak()+" "+z,ee}}return v.prototype.mathspeak.call(this)},f.prototype.getFracDepth=function(){var d=0,m=function(y,E){return y instanceof Ne&&y.ctrlSeq&&y.ctrlSeq.toLowerCase().search("frac")>=0&&(E+=1),y&&y.parent?m(y.parent,E):E};return m(this,d)},f}(Qi),AV=M.over=ae["/"]=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(d){if(!this.replacedFragment){var m=d[r];if(!d.options.typingSlashCreatesNewFraction)for(;m&&!(m instanceof vi||m instanceof(M.text||n)||m instanceof uc||m.ctrlSeq==="\\ "||/^[,;:]$/.test(m.ctrlSeq));)m=m[r];if(m instanceof uc&&m[e]instanceof ol){m=m[e];var y=m[e];y instanceof ol&&y.ctrlSeq!=m.ctrlSeq&&(m=m[e])}if(m!==d[r]&&!d.isTooDeep(1)){var y=m[e],E=d[r];this.replaces(new q(y||d.parent.getEnd(r),E)),d[r]=m}}v.prototype.createLeftOf.call(this,d)},f}(MV),rC=function(){return new On("\\operatorname{ans}",l("span",{class:"dcg-mq-ans"},[l.text("ans")]),"ans")};M.ans=rC;var iC=function(){return new On("\\%\\operatorname{of}",l("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[l.text("% of ")]),"percent of")};M.percent=M.percentof=iC;var _g=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.tokenId="",d.ctrlSeq="\\token",d.textTemplate=["token(",")"],d.mathspeakTemplate=["StartToken,",", EndToken"],d.ariaLabel="token",d}return f.prototype.html=function(){var d=l("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(d),w.linkElementByCmdNode(d,this),d},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(d)},f.prototype.mathspeak=function(){var d=[];return this.domFrag().children().eachElement(function(m){var y=m.getAttribute("aria-label");typeof y=="string"&&y!==""&&d.push(y)}),d.length>0?d.join(" ").trim():"token "+this.tokenId},f.prototype.parser=function(){var d=this;return st.block.map(function(m){var y=m.getEnd(r);if(y)for(d.tokenId+=y.ctrlSeq;y=y[e];)d.tokenId+=y.ctrlSeq;return d})},f}(On);M.token=_g;var nC=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\sqrt",d.domView=new Vi(1,function(m){return l("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[l("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[Xu.sqrt.html()]),l.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},m[0])])}),d.textTemplate=["sqrt(",")"],d.mathspeakTemplate=["StartRoot,",", EndRoot"],d.ariaLabel="root",d}return f.prototype.parser=function(){return st.optBlock.then(function(d){return st.block.map(function(m){var y=new hh;return y.blocks=[d,m],d.adopt(y,0,0),m.adopt(y,d,0),y})}).or(v.prototype.parser.call(this))},f}(Qi);M.sqrt=nC,M.hat=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\hat",d.domView=new Vi(1,function(m){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-hat-prefix"},[l.text("^")]),l.block("span",{class:"dcg-mq-hat-stem"},m[0])])}),d.textTemplate=["hat(",")"],d}return f}(Qi);var hh=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.domView=new Vi(2,function(m){return l("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[l.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},m[0]),l("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[l("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[Xu.sqrt.html()]),l.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},m[1])])])}),d.textTemplate=["sqrt[","](",")"],d}return f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+="\\sqrt[",this.getEnd(r).latexRecursive(d),d.latex+="]{",this.getEnd(e).latexRecursive(d),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.mathspeak=function(){var d=this.getEnd(r).mathspeak(),m=this.getEnd(e).mathspeak();return this.getEnd(r).ariaLabel="Index",this.getEnd(e).ariaLabel="Radicand",d==="3"?"Start Cube Root, "+m+", End Cube Root":"Root Index "+d+", Start Root, "+m+", End Root"},f}(nC);M.nthroot=hh,M.cbrt=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(d){v.prototype.createLeftOf.call(this,d),new $("3").createLeftOf(d),d.controller.moveRight()},f}(hh);var oC=function(v){Dt(f,v);function f(d,m,y){var E=this,F=new Vi(1,function(z){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-diacritic-above"},[m]),l.block("span",{class:"dcg-mq-diacritic-stem"},z[0])])});return E=v.call(this,d,F,y)||this,E}return f}(Qi);M.vec=function(){return new oC("\\vec",l.entityText("&rarr;"),["vec(",")"])},M.tilde=function(){return new oC("\\tilde",l.text("~"),["tilde(",")"])};var sC=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setDOM=function(d){var m;v.prototype.setDOM.call(this,d);var y=this.domFrag().children();return y.isEmpty()||(this.delimFrags=(m={},m[r]=y.first(),m[e]=y.last(),m)),this},f}(Qi),sl=function(v){Dt(f,v);function f(d,m,y,E,F){var z,ee=v.call(this,"\\left"+E,void 0,[m,y])||this;return ee.side=d,ee.sides=(z={},z[r]={ch:m,ctrlSeq:E},z[e]={ch:y,ctrlSeq:F},z),ee}return f.prototype.numBlocks=function(){return 1},f.prototype.html=function(){var d=this,m=this.getSymbol(r),y=this.getSymbol(e);return this.domView=new Vi(1,function(E){return l("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[l("span",{style:"width:"+m.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(d.side===e?" dcg-mq-ghost":"")},[m.html()]),l.block("span",{style:"margin-left:"+m.width+";margin-right:"+y.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},E[0]),l("span",{style:"width:"+y.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(d.side===r?" dcg-mq-ghost":"")},[y.html()])])}),v.prototype.html.call(this)},f.prototype.getSymbol=function(d){var m=this.sides[d||e].ch;return Xu[m]||{width:"0",html:""}},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+="\\left"+this.sides[r].ctrlSeq,this.getEnd(r).latexRecursive(d),d.latex+="\\right"+this.sides[e].ctrlSeq,this.checkCursorContextClose(d)},f.prototype.mathspeak=function(d){var m=this.sides[r].ch,y=this.sides[e].ch;if(m==="|"&&y==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(d&&d.createdLeftOf&&this.side){var E="";return this.side===r?E=this.textTemplate[0]:this.side===e&&(E=this.textTemplate[1]),(this.side===r?"left ":"right ")+Qu[E]}else this.mathspeakTemplate=["left "+Qu[m]+",",", right "+Qu[y]],this.ariaLabel=Qu[m]+" block";return v.prototype.mathspeak.call(this)},f.prototype.matchBrack=function(d,m,y){return y instanceof f&&y.side&&y.side!==-m&&(!d.restrictMismatchedBrackets||Qd[this.sides[this.side].ch]===y.sides[y.side].ch||{"(":"]","[":")"}[this.sides[r].ch]===y.sides[e].ch)&&y},f.prototype.closeOpposing=function(d){d.side=0,d.sides[this.side]=this.sides[this.side];var m=d.delimFrags[this.side===r?r:e].removeClass("dcg-mq-ghost");this.replaceBracket(m,this.side)},f.prototype.createLeftOf=function(d){var m;if(!this.replacedFragment){var y=d.options;this.sides[r].ch==="|"?m=this.matchBrack(y,e,d[e])||this.matchBrack(y,r,d[r])||this.matchBrack(y,0,d.parent.parent):m=this.matchBrack(y,-this.side,d[-this.side])||this.matchBrack(y,-this.side,d.parent.parent)}if(m){var E=this.side=-m.side;this.closeOpposing(m),m===d.parent.parent&&d[E]&&new q(d[E],d.parent.getEnd(E),-E).disown().withDirAdopt(-E,m.parent,m,m[E]).domFrag().insDirOf(E,m.domFrag()),m.bubble(function(F){F.reflow()})}else m=this,E=m.side,m.replacedFragment?m.side=0:d[-E]&&(m.replaces(new q(d[-E],d.parent.getEnd(-E),E)),d[-E]=0),v.prototype.createLeftOf.call(this,d);E===r?d.insAtLeftEnd(m.getEnd(r)):d.insRightOf(m)},f.prototype.placeCursor=function(){},f.prototype.unwrap=function(){this.getEnd(r).children().disown().adopt(this.parent,this,this[e]).domFrag().insertAfter(this.domFrag()),this.remove()},f.prototype.deleteSide=function(d,m,y){var E=this.parent,F=this[d],z=E.getEnd(d);if(d===this.side){this.unwrap(),F?y.insDirOf(-d,F):y.insAtDirEnd(d,E);return}var ee=y.options,ue=!this.side;if(this.side=-d,this.matchBrack(ee,d,this.getEnd(r).getEnd(this.side))){this.closeOpposing(this.getEnd(r).getEnd(this.side));var He=this.getEnd(r).getEnd(d);this.unwrap(),He&&He.siblingCreated(y.options,d),F?y.insDirOf(-d,F):y.insAtDirEnd(d,E)}else{if(this.matchBrack(ee,d,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(m&&ue){this.unwrap(),F?y.insDirOf(-d,F):y.insAtDirEnd(d,E);return}else{this.sides[d]=LV(this),this.delimFrags[r].removeClass("dcg-mq-ghost"),this.delimFrags[e].removeClass("dcg-mq-ghost");var _e=this.delimFrags[d].addClass("dcg-mq-ghost");this.replaceBracket(_e,d)}if(F){var Ie=this.getEnd(r),He=Ie.getEnd(d);Ie.domFrag().removeClass("dcg-mq-empty"),new q(F,z,-d).disown().withDirAdopt(-d,Ie,He,0).domFrag().insAtDirEnd(d,Ie.domFrag().oneElement()),He&&He.siblingCreated(y.options,d),y.insDirOf(-d,F)}else m?y.insDirOf(d,this):y.insAtDirEnd(d,this.getEnd(r))}},f.prototype.replaceBracket=function(d,m){var y=this.getSymbol(m);if(d.children().replaceWith(P(y.html())),d.oneElement().style.width=y.width,m===r){var E=d.next();E.isEmpty()||(E.oneElement().style.marginLeft=y.width)}else{var F=d.prev();F.isEmpty()||(F.oneElement().style.marginRight=y.width)}},f.prototype.deleteTowards=function(d,m){this.deleteSide(-d,!1,m)},f.prototype.finalizeTree=function(){this.getEnd(r).deleteOutOf=function(d,m){this.parent.deleteSide(d,!0,m)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===r?e:r].removeClass("dcg-mq-ghost"),this.side=0}},f.prototype.siblingCreated=function(d,m){m===-this.side&&this.finalizeTree()},f}(sC);function LV(v){var f=v.side,d=v.sides[f];return{ch:Qd[d.ch],ctrlSeq:Qd[d.ctrlSeq]}}var Qd={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},Qu={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function Fg(v,m,d){var m=m||v,y=Qd[v],E=Qd[m];ae[v]=function(){return new sl(r,v,y,m,E)},ae[y]=function(){return new sl(e,v,y,m,E)},Qu[v]=Qu[y]=d}Fg("(","","parenthesis"),Fg("[","","bracket"),Fg("{","\\{","brace"),M.langle=function(){return new sl(r,"&lang;","&rang;","\\langle ","\\rangle ")},M.rangle=function(){return new sl(e,"&lang;","&rang;","\\langle ","\\rangle ")},ae["|"]=function(){return new sl(r,"|","|","|","|")},M.lVert=function(){return new sl(r,"&#8741;","&#8741;","\\lVert ","\\rVert ")},M.rVert=function(){return new sl(e,"&#8741;","&#8741;","\\lVert ","\\rVert ")},M.left=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.parser=function(){var d=Et.regex,m=Et.string,y=Et.optWhitespace;return y.then(d(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(E){var F=E.replace(/^\\/,"");return E=="\\langle"&&(F="&lang;",E=E+" "),E=="\\lVert"&&(F="&#8741;",E=E+" "),st.then(function(z){return m("\\right").skip(y).then(d(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(ee){var ue=ee.replace(/^\\/,"");ee=="\\rangle"&&(ue="&rang;",ee=ee+" "),ee=="\\rVert"&&(ue="&#8741;",ee=ee+" ");var He=new sl(0,F,ue,E,ee);return He.blocks=[z],z.adopt(He,0,0),He})})})},f}(Qi),M.right=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.parser=function(){return Et.fail("unmatched \\right")},f}(Qi);var Rg=Xu["("],$y=Xu[")"],aC=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\binom",d.domView=new Vi(2,function(m){return l("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[l("span",{style:"width:"+Rg.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[Rg.html()]),l("span",{style:"margin-left:"+Rg.width+"; margin-right:"+$y.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[l("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[l.block("span",{},m[0]),l.block("span",{},m[1])])]),l("span",{style:"width:"+$y.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[$y.html()])])}),d.textTemplate=["choose(",",",")"],d.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],d.ariaLabel="binomial",d}return f}(sC);M.binom=M.binomial=aC,M.choose=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(d){AV.prototype.createLeftOf(d)},f}(aC);var OV=function(v){Dt(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\MathQuillMathField",d.domView=new Vi(1,function(m){return l("span",{class:"dcg-mq-editable-field"},[l.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},m[0])])}),d}return f.prototype.parser=function(){var d=this,m=Et.string,y=Et.regex,E=Et.succeed;return m("[").then(y(/^[a-z][a-z0-9]*/i)).skip(m("]")).map(function(F){d.name=F}).or(E(void 0)).then(v.prototype.parser.call(this))},f.prototype.finalizeTree=function(d){var m=new In(this.getEnd(r),this.domFrag().oneElement(),d);m.KIND_OF_MQ="MathField",m.editable=!0,m.createTextarea(),m.editablesTextareaEvents(),m.cursor.insAtRightEnd(m.root),xi(m.root);function y(E){if(E.parentNode&&!P(E).hasClass("dcg-mq-root-block")&&y(E.parentNode),E.nodeType===Node.ELEMENT_NODE){var F=E;F.getAttribute("aria-hidden")==="true"&&(F.removeAttribute("aria-hidden"),P(E).children().eachElement(function(z){z.setAttribute("aria-hidden","true")}))}}y(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},f.prototype.registerInnerField=function(d,m){var y=this.getEnd(r).controller,E=new m(y);d[this.name]=E,d.push(E)},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),this.getEnd(r).latexRecursive(d),this.checkCursorContextClose(d)},f.prototype.text=function(){return this.getEnd(r).text()},f}(Qi);M.editable=M.MathQuillMathField=OV;var Wy=function(v){Dt(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setOptions=function(d){function m(){return""}return this.text=d.text||m,this.domView=new Vi(0,function(){return l("span",{},[a(d.htmlString||"")])}),this.latex=d.latex||m,this},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.latex(),this.checkCursorContextClose(d)},f.prototype.parser=function(){var d=this,m=Et.string,y=Et.regex,E=Et.succeed;return m("{").then(y(/^[a-z][a-z0-9]*/i)).skip(m("}")).then(function(F){return m("[").then(y(/^[-\w\s]*/)).skip(m("]")).or(E(void 0)).map(function(z){return d.setOptions(de[F](z))})})},f}(On);if(M.embed=Wy,window.jQuery){Ct=we(1);for(var lC in Ct)(function(v,f){typeof f=="function"?(Je[v]=function(){return Qe(),f.apply(this,arguments)},Je[v].prototype=f.prototype):Je[v]=f})(lC,Ct[lC])}})()});var NU=__dcg_shared_module_exports__['f']((Lbe,RU)=>{RU.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var KU=__dcg_shared_module_exports__['f']((Obe,BU)=>{var TY=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,MY=NU();BU.exports=function(r){var e=0,t,i=!0,n={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return r.replace(TY,function(o){if(o==="="){i=!0,e++;return}i?e===0?((MY[o]||r.charAt(r.length-2)==="/")&&(n.voidElement=!0),n.name=o):(n.attrs[t]=o.replace(/^['"]|['"]$/g,""),t=void 0):(t&&(n.attrs[t]=t),t=o),e++,i=!1}),n}});var HU=__dcg_shared_module_exports__['f']((Pbe,UU)=>{var AY=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,LY=KU(),OY=Object.create?Object.create(null):{};function IL(r,e,t,i,n){var o=e.indexOf("<",i),s=e.slice(i,o===-1?void 0:o);/^\s*$/.test(s)&&(s=" "),(!n&&o>-1&&t+r.length>=0||s!==" ")&&r.push({type:"text",content:s})}UU.exports=function(e,t){t||(t={}),t.components||(t.components=OY);var i=[],n,o=-1,s=[],a={},l=!1;return e.replace(AY,function(c,u){if(l){if(c!=="</"+n.name+">")return;l=!1}var p=c.charAt(1)!=="/",g=c.indexOf("<!--")===0,h=u+c.length,b=e.charAt(h),C;p&&!g&&(o++,n=LY(c),n.type==="tag"&&t.components[n.name]&&(n.type="component",l=!0),!n.voidElement&&!l&&b&&b!=="<"&&IL(n.children,e,o,h,t.ignoreWhitespace),a[n.tagName]=n,o===0&&i.push(n),C=s[o-1],C&&C.children.push(n),s[o]=n),(g||!p||n.voidElement)&&(g||o--,!l&&b!=="<"&&b&&(C=o===-1?i:s[o].children,IL(C,e,o,h,t.ignoreWhitespace)))}),!i.length&&e.length&&IL(i,e,0,0,t.ignoreWhitespace),i}});var $U=__dcg_shared_module_exports__['f']((_be,zU)=>{function PY(r){var e=[];for(var t in r)e.push(t+'="'+r[t]+'"');return e.length?" "+e.join(" "):""}function qU(r,e){switch(e.type){case"text":return r+e.content;case"tag":return r+="<"+e.name+(e.attrs?PY(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?r:r+e.children.reduce(qU,"")+"</"+e.name+">"}}zU.exports=function(r){return r.reduce(function(e,t){return e+qU("",t)},"")}});var jU=__dcg_shared_module_exports__['f']((Fbe,WU)=>{WU.exports={parse:HU(),stringify:$U()}});var fq=__dcg_shared_module_exports__['f']((mq,o1)=>{(function(r){if(typeof mq=="object"&&typeof o1!="undefined")o1.exports=r();else{var e;typeof window!="undefined"?e=window:typeof global!="undefined"?e=global:typeof self!="undefined"?e=self:e=this,e.bugsnag=r()}})(function(){var r,e,t,i=function(G,_,K){for(var Q=K,ie=0,De=G.length;ie<De;ie++)Q=_(Q,G[ie],ie,G);return Q},n=function(G,_){return i(G,function(K,Q,ie,De){return _(Q,ie,De)?K.concat(Q):K},[])},o=function(G,_){return i(G,function(K,Q,ie,De){return K.concat(_(Q,ie,De))},[])},s=function(G,_){return i(G,function(K,Q,ie,De){return K===!0||Q===_},!1)},a=!{toString:null}.propertyIsEnumerable("toString"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(G){var _=[],K;for(K in G)Object.prototype.hasOwnProperty.call(G,K)&&_.push(K);if(!a)return _;for(var Q=0,ie=l.length;Q<ie;Q++)Object.prototype.hasOwnProperty.call(G,l[Q])&&_.push(l[Q]);return _},u=function(G){return Object.prototype.toString.call(G)==="[object Array]"},p=function(G){return G<10?"0"+G:G},g=function(){var G=new Date;return G.getUTCFullYear()+"-"+p(G.getUTCMonth()+1)+"-"+p(G.getUTCDate())+"T"+p(G.getUTCHours())+":"+p(G.getUTCMinutes())+":"+p(G.getUTCSeconds())+"."+(G.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},h={map:o,reduce:i,filter:n,includes:s,keys:c,isArray:u,isoDate:g},b={};b.intRange=function(G,_){return G===void 0&&(G=1),_===void 0&&(_=1/0),function(K){return typeof K=="number"&&parseInt(""+K,10)===K&&K>=G&&K<=_}},b.stringWithLength=function(G){return typeof G=="string"&&!!G.length};var C={},D=h.filter,S=h.reduce,V=h.keys,k=h.isArray,T=h.includes,A=b.intRange,R=b.stringWithLength;C.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:R},appVersion:{defaultValue:function(){return null},message:"should be a string",validate:function(G){return G===null||R(G)}},appType:{defaultValue:function(){return null},message:"should be a string",validate:function(G){return G===null||R(G)}},autoNotify:{defaultValue:function(){return!0},message:"should be true|false",validate:function(G){return G===!0||G===!1}},beforeSend:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:function(G){return typeof G=="function"||k(G)&&D(G,function(_){return typeof _=="function"}).length===G.length}},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }. sessions is optional if autoCaptureSessions=false",validate:function(G,_){return G&&typeof G=="object"&&R(G.notify)&&(_.autoCaptureSessions===!1||R(G.sessions))&&D(V(G),function(K){return!T(["notify","sessions"],K)}).length===0}},autoCaptureSessions:{defaultValue:function(G,_){return _.endpoints===void 0||!!_.endpoints&&!!_.endpoints.sessions},message:"should be true|false",validate:function(G){return G===!0||G===!1}},notifyReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(G){return G===null||k(G)&&D(G,function(_){return typeof _=="string"}).length===G.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(G){return typeof G=="string"&&G.length}},maxBreadcrumbs:{defaultValue:function(){return 20},message:"should be a number \u226440",validate:function(G){return A(0,40)(G)}},autoBreadcrumbs:{defaultValue:function(){return!0},message:"should be true|false",validate:function(G){return typeof G=="boolean"}},user:{defaultValue:function(){return null},message:"(object) user should be an object",validate:function(G){return typeof G=="object"}},metaData:{defaultValue:function(){return null},message:"should be an object",validate:function(G){return typeof G=="object"}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(G){return!G||G&&S(["debug","info","warn","error"],function(_,K){return _&&typeof G[K]=="function"},!0)}},filters:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(G){return k(G)&&G.length===D(G,function(_){return typeof _=="string"||_&&typeof _.test=="function"}).length}}},C.mergeDefaults=function(G,_){if(!G||!_)throw new Error("opts and schema objects are required");return S(V(_),function(K,Q){return K[Q]=G[Q]!==void 0?G[Q]:_[Q].defaultValue(G[Q],G),K},{})},C.validate=function(G,_){if(!G||!_)throw new Error("opts and schema objects are required");var K=S(V(_),function(Q,ie){return _[ie].validate(G[ie],G)?Q:Q.concat({key:ie,message:_[ie].message,value:G[ie]})},[]);return{valid:!K.length,errors:K}};function P(){return P=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},P.apply(this,arguments)}var W=C.schema,H=h.map,j=b.stringWithLength,ne={releaseStage:{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"},message:"should be set",validate:j},logger:P({},W.logger,{defaultValue:function(){return typeof console!="undefined"&&typeof console.debug=="function"?le():void 0}})},le=function(){var G={},_=console.log;return H(["debug","info","warn","error"],function(K){var Q=console[K];G[K]=typeof Q=="function"?Q.bind(console,"[bugsnag]"):_.bind(console,"[bugsnag]")}),G},w=h.isoDate,B=function(){function G(K,Q,ie,De){K===void 0&&(K="[anonymous]"),Q===void 0&&(Q={}),ie===void 0&&(ie="manual"),De===void 0&&(De=w()),this.type=ie,this.name=K,this.metaData=Q,this.timestamp=De}var _=G.prototype;return _.toJSON=function(){return{type:this.type,name:this.name,timestamp:this.timestamp,metaData:this.metaData}},G}(),q=B,M=function(G,_,K){var Q=G.length,ie=0,De=function(){if(ie>=Q)return K(null,!1);_(G[ie],function(ve,ot){if(ve)return K(ve,!1);if(ot===!0)return K(null,!0);ie++,De()})};De()},ae=function(G){return G.app&&typeof G.app.releaseStage=="string"?G.app.releaseStage:G.config.releaseStage},se=ge;function ge(G){switch(Object.prototype.toString.call(G)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return G instanceof Error}}var he=se,ye=function(G,_){return function(K,Q){if(typeof K!="function")return Q(null,!1);try{if(K.length!==2){var ie=K(G);return ie&&typeof ie.then=="function"?ie.then(function(De){return setTimeout(function(){return Q(null,fe(G,De))},0)},function(De){setTimeout(function(){return _(De),Q(null,!1)})}):Q(null,fe(G,ie))}K(G,function(De,ve){if(De)return _(De),Q(null,!1);Q(null,fe(G,ve))})}catch(De){_(De),Q(null,!1)}}},fe=function(G,_){return G.isIgnored()||_===!1},Se={};(function(G,_){"use strict";typeof r=="function"&&r.amd?r("stackframe",[],_):typeof Se=="object"?Se=_():G.StackFrame=_()})(this,function(){"use strict";function G(Ye){return!isNaN(parseFloat(Ye))&&isFinite(Ye)}function _(Ye){return Ye.charAt(0).toUpperCase()+Ye.substring(1)}function K(Ye){return function(){return this[Ye]}}var Q=["isConstructor","isEval","isNative","isToplevel"],ie=["columnNumber","lineNumber"],De=["fileName","functionName","source"],ve=["args"],ot=Q.concat(ie,De,ve);function et(Ye){if(Ye instanceof Object)for(var Ti=0;Ti<ot.length;Ti++)Ye.hasOwnProperty(ot[Ti])&&Ye[ot[Ti]]!==void 0&&this["set"+_(ot[Ti])](Ye[ot[Ti]])}et.prototype={getArgs:function(){return this.args},setArgs:function(Ye){if(Object.prototype.toString.call(Ye)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=Ye},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(Ye){if(Ye instanceof et)this.evalOrigin=Ye;else if(Ye instanceof Object)this.evalOrigin=new et(Ye);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var Ye=this.getFunctionName()||"{anonymous}",Ti="("+(this.getArgs()||[]).join(",")+")",nd=this.getFileName()?"@"+this.getFileName():"",hc=G(this.getLineNumber())?":"+this.getLineNumber():"",Ss=G(this.getColumnNumber())?":"+this.getColumnNumber():"";return Ye+Ti+nd+hc+Ss}};for(var pr=0;pr<Q.length;pr++)et.prototype["get"+_(Q[pr])]=K(Q[pr]),et.prototype["set"+_(Q[pr])]=function(Ye){return function(Ti){this[Ye]=!!Ti}}(Q[pr]);for(var Ot=0;Ot<ie.length;Ot++)et.prototype["get"+_(ie[Ot])]=K(ie[Ot]),et.prototype["set"+_(ie[Ot])]=function(Ye){return function(Ti){if(!G(Ti))throw new TypeError(Ye+" must be a Number");this[Ye]=Number(Ti)}}(ie[Ot]);for(var tn=0;tn<De.length;tn++)et.prototype["get"+_(De[tn])]=K(De[tn]),et.prototype["set"+_(De[tn])]=function(Ye){return function(Ti){this[Ye]=String(Ti)}}(De[tn]);return et});var de={};(function(G,_){"use strict";typeof r=="function"&&r.amd?r("error-stack-parser",["stackframe"],_):typeof de=="object"?de=_(Se):G.ErrorStackParser=_(G.StackFrame)})(this,function(_){"use strict";var K=/(^|@)\S+\:\d+/,Q=/^\s*at .*(\S+\:\d+|\(native\))/m,ie=/^(eval@)?(\[native code\])?$/;return{parse:function(ve){if(typeof ve.stacktrace!="undefined"||typeof ve["opera#sourceloc"]!="undefined")return this.parseOpera(ve);if(ve.stack&&ve.stack.match(Q))return this.parseV8OrIE(ve);if(ve.stack)return this.parseFFOrSafari(ve);throw new Error("Cannot parse given Error object")},extractLocation:function(ve){if(ve.indexOf(":")===-1)return[ve];var ot=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,et=ot.exec(ve.replace(/[\(\)]/g,""));return[et[1],et[2]||void 0,et[3]||void 0]},parseV8OrIE:function(ve){var ot=ve.stack.split(`
`).filter(function(et){return!!et.match(Q)},this);return ot.map(function(et){et.indexOf("(eval ")>-1&&(et=et.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var pr=et.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),Ot=this.extractLocation(pr.pop()),tn=pr.join(" ")||void 0,Ye=["eval","<anonymous>"].indexOf(Ot[0])>-1?void 0:Ot[0];return new _({functionName:tn,fileName:Ye,lineNumber:Ot[1],columnNumber:Ot[2],source:et})},this)},parseFFOrSafari:function(ve){var ot=ve.stack.split(`
`).filter(function(et){return!et.match(ie)},this);return ot.map(function(et){if(et.indexOf(" > eval")>-1&&(et=et.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),et.indexOf("@")===-1&&et.indexOf(":")===-1)return new _({functionName:et});var pr=/((.*".+"[^@]*)?[^@]*)(?:@)/,Ot=et.match(pr),tn=Ot&&Ot[1]?Ot[1]:void 0,Ye=this.extractLocation(et.replace(pr,""));return new _({functionName:tn,fileName:Ye[0],lineNumber:Ye[1],columnNumber:Ye[2],source:et})},this)},parseOpera:function(ve){return!ve.stacktrace||ve.message.indexOf(`
`)>-1&&ve.message.split(`
`).length>ve.stacktrace.split(`
`).length?this.parseOpera9(ve):ve.stack?this.parseOpera11(ve):this.parseOpera10(ve)},parseOpera9:function(ve){for(var ot=/Line (\d+).*script (?:in )?(\S+)/i,et=ve.message.split(`
`),pr=[],Ot=2,tn=et.length;Ot<tn;Ot+=2){var Ye=ot.exec(et[Ot]);Ye&&pr.push(new _({fileName:Ye[2],lineNumber:Ye[1],source:et[Ot]}))}return pr},parseOpera10:function(ve){for(var ot=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,et=ve.stacktrace.split(`
`),pr=[],Ot=0,tn=et.length;Ot<tn;Ot+=2){var Ye=ot.exec(et[Ot]);Ye&&pr.push(new _({functionName:Ye[3]||void 0,fileName:Ye[2],lineNumber:Ye[1],source:et[Ot]}))}return pr},parseOpera11:function(ve){var ot=ve.stack.split(`
`).filter(function(et){return!!et.match(K)&&!et.match(/^Error created at/)},this);return ot.map(function(et){var pr=et.split("@"),Ot=this.extractLocation(pr.pop()),tn=pr.shift()||"",Ye=tn.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0,Ti;tn.match(/\(([^\)]*)\)/)&&(Ti=tn.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var nd=Ti===void 0||Ti==="[arguments not available]"?void 0:Ti.split(",");return new _({functionName:Ye,args:nd,fileName:Ot[0],lineNumber:Ot[1],columnNumber:Ot[2],source:et})},this)}}});var Ee=de,U=function(G){return!!G&&(!!G.stack||!!G.stacktrace||!!G["opera#sourceloc"])&&typeof(G.stack||G.stacktrace||G["opera#sourceloc"])=="string"&&G.stack!==G.name+": "+G.message},ce={};(function(G,_){"use strict";typeof r=="function"&&r.amd?r("stack-generator",["stackframe"],_):typeof ce=="object"?ce=_(Se):G.StackGenerator=_(G.StackFrame)})(this,function(G){return{backtrace:function(K){var Q=[],ie=10;typeof K=="object"&&typeof K.maxStackSize=="number"&&(ie=K.maxStackSize);for(var De=arguments.callee;De&&Q.length<ie&&De.arguments;){for(var ve=new Array(De.arguments.length),ot=0;ot<ve.length;++ot)ve[ot]=De.arguments[ot];/function(?:\s+([\w$]+))+\s*\(/.test(De.toString())?Q.push(new G({functionName:RegExp.$1||void 0,args:ve})):Q.push(new G({args:ve}));try{De=De.caller}catch(et){break}}return Q}}});function Oe(){return Oe=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},Oe.apply(this,arguments)}var Qe=h.reduce,Ct=h.filter,Je=function(){function G(K,Q,ie,De,ve){ie===void 0&&(ie=[]),De===void 0&&(De=we()),this.__isBugsnagReport=!0,this._ignored=!1,this._handledState=De,this.app=void 0,this.apiKey=void 0,this.breadcrumbs=[],this.context=void 0,this.device=void 0,this.errorClass=Xr(K,"[no error class]"),this.errorMessage=Xr(Q,"[no error message]"),this.groupingHash=void 0,this.metaData={},this.request=void 0,this.severity=this._handledState.severity,this.stacktrace=Qe(ie,function(ot,et){var pr=tr(et);try{return JSON.stringify(pr)==="{}"?ot:ot.concat(pr)}catch(Ot){return ot}},[]),this.user=void 0,this.session=void 0,this.originalError=ve}var _=G.prototype;return _.ignore=function(){this._ignored=!0},_.isIgnored=function(){return this._ignored},_.updateMetaData=function(Q){var ie;if(!Q)return this;var De;return(arguments.length<=1?void 0:arguments[1])===null?this.removeMetaData(Q):(arguments.length<=2?void 0:arguments[2])===null?this.removeMetaData(Q,arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]):(typeof(arguments.length<=1?void 0:arguments[1])=="object"&&(De=arguments.length<=1?void 0:arguments[1]),typeof(arguments.length<=1?void 0:arguments[1])=="string"&&(De=(ie={},ie[arguments.length<=1?void 0:arguments[1]]=arguments.length<=2?void 0:arguments[2],ie)),De?(this.metaData[Q]||(this.metaData[Q]={}),this.metaData[Q]=Oe({},this.metaData[Q],De),this):this)},_.removeMetaData=function(Q,ie){return typeof Q!="string"?this:ie?this.metaData[Q]?(delete this.metaData[Q][ie],this):this:(delete this.metaData[Q],this)},_.toJSON=function(){return{payloadVersion:"4",exceptions:[{errorClass:this.errorClass,message:this.errorMessage,stacktrace:this.stacktrace,type:"browserjs"}],severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,breadcrumbs:this.breadcrumbs,context:this.context,user:this.user,metaData:this.metaData,groupingHash:this.groupingHash,request:this.request,session:this.session}},G}(),tr=function(G){var _={file:G.fileName,method:mr(G.functionName),lineNumber:G.lineNumber,columnNumber:G.columnNumber,code:void 0,inProject:void 0};return _.lineNumber>-1&&!_.file&&!_.method&&(_.file="global code"),_},mr=function(G){return/^global code$/i.test(G)?"global code":G},we=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},Xr=function(G,_){return typeof G=="string"&&G?G:_};Je.getStacktrace=function(G,_,K){return _===void 0&&(_=0),K===void 0&&(K=0),U(G)?Ee.parse(G).slice(_):Ct(ce.backtrace(),function(Q){return(Q.functionName||"").indexOf("StackGenerator$$")===-1}).slice(1+K)},Je.ensureReport=function(G,_,K){if(_===void 0&&(_=0),K===void 0&&(K=0),G.__isBugsnagReport)return G;try{var Q=Je.getStacktrace(G,_,1+K);return new Je(G.name,G.message,Q,void 0,G)}catch(ie){return new Je(G.name,G.message,[],void 0,G)}};var xi=Je,Le=function(_,K){var Q="000000000"+_;return Q.substr(Q.length-K)},Et=typeof window=="object"?window:self,lt=0;for(var dt in Et)Object.hasOwnProperty.call(Et,dt)&&lt++;var Pt=navigator.mimeTypes?navigator.mimeTypes.length:0,Ve=Le((Pt+navigator.userAgent.length).toString(36)+lt.toString(36),4),ur=function(){return Ve},Ne=0,$t=4,Ge=36,st=Math.pow(Ge,$t);function kt(){return Le((Math.random()*st<<0).toString(Ge),$t)}function Ae(){return Ne=Ne<st?Ne:0,Ne++,Ne-1}function Mr(){var G="c",_=new Date().getTime().toString(Ge),K=Le(Ae().toString(Ge),$t),Q=ur(),ie=kt()+kt();return G+_+K+Q+ie}Mr.fingerprint=ur;var xt=Mr,il=h.isoDate,Ft=function(){function G(){this.id=xt(),this.startedAt=il(),this._handled=0,this._unhandled=0}var _=G.prototype;return _.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},_.trackError=function(Q){this[Q._handledState.unhandled?"_unhandled":"_handled"]+=1},G}(),In=Ft;function no(){return no=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},no.apply(this,arguments)}var Vi=h.map,Qi=h.includes,On=h.isArray,pa="Usage error.",Wt="Bugsnag usage error.",vi=function(){function G(K){if(!K||!K.name||!K.version||!K.url)throw new Error("`notifier` argument is required");this.notifier=K,this._configured=!1,this._opts={},this.config={},this._delivery={sendSession:function(){},sendReport:function(){}},this._logger={debug:function(){},info:function(){},warn:function(){},error:function(){}},this._plugins={},this._session=null,this.breadcrumbs=[],this.app={},this.context=void 0,this.device=void 0,this.metaData=void 0,this.request=void 0,this.user={},this.BugsnagClient=G,this.BugsnagReport=xi,this.BugsnagBreadcrumb=q,this.BugsnagSession=In;var Q=this,ie=this.notify;this.notify=function(){return ie.apply(Q,arguments)}}var _=G.prototype;return _.setOptions=function(Q){this._opts=no({},this._opts,Q)},_.configure=function(Q){Q===void 0&&(Q=C.schema);var ie=C.mergeDefaults(this._opts,Q),De=C.validate(ie,Q);if(!De.valid)throw new Error(Yd(De.errors));return typeof ie.beforeSend=="function"&&(ie.beforeSend=[ie.beforeSend]),ie.appVersion&&(this.app.version=ie.appVersion),ie.appType&&(this.app.type=ie.appType),ie.metaData&&(this.metaData=ie.metaData),ie.user&&(this.user=ie.user),ie.logger&&this.logger(ie.logger),this.config=no({},this.config,ie),this._configured=!0,this},_.use=function(Q){if(!this._configured)throw new Error("client not configured");Q.configSchema&&this.configure(Q.configSchema);for(var ie=arguments.length,De=new Array(ie>1?ie-1:0),ve=1;ve<ie;ve++)De[ve-1]=arguments[ve];var ot=Q.init.apply(Q,[this].concat(De));return Q.name&&(this._plugins["~"+Q.name+"~"]=ot),this},_.getPlugin=function(Q){return this._plugins["~"+Q+"~"]},_.delivery=function(Q){return this._delivery=Q,this},_.logger=function(Q,ie){return this._logger=Q,this},_.sessionDelegate=function(Q){return this._sessionDelegate=Q,this},_.startSession=function(){return this._sessionDelegate?this._sessionDelegate.startSession(this):(this._logger.warn("No session implementation is installed"),this)},_.leaveBreadcrumb=function(Q,ie,De,ve){if(!this._configured)throw new Error("client not configured");if(Q=Q||void 0,De=typeof De=="string"?De:void 0,ve=typeof ve=="string"?ve:void 0,ie=typeof ie=="object"&&ie!==null?ie:void 0,!(typeof Q!="string"&&!ie)){var ot=new q(Q,ie,De,ve);return this.breadcrumbs.push(ot),this.breadcrumbs.length>this.config.maxBreadcrumbs&&(this.breadcrumbs=this.breadcrumbs.slice(this.breadcrumbs.length-this.config.maxBreadcrumbs)),this}},_.notify=function(Q,ie,De){var ve=this;if(ie===void 0&&(ie={}),De===void 0&&(De=function(){}),!this._configured)throw new Error("client not configured");var ot=ae(this),et=xo(Q,ie,this._logger),pr=et.err,Ot=et.errorFramesToSkip,tn=et._opts;tn&&(ie=tn),(typeof ie!="object"||ie===null)&&(ie={});var Ye=xi.ensureReport(pr,Ot,2);if(Ye.app=no({},{releaseStage:ot},Ye.app,this.app),Ye.context=Ye.context||ie.context||this.context||void 0,Ye.device=no({},Ye.device,this.device,ie.device),Ye.request=no({},Ye.request,this.request,ie.request),Ye.user=no({},Ye.user,this.user,ie.user),Ye.metaData=no({},Ye.metaData,this.metaData,ie.metaData),Ye.breadcrumbs=this.breadcrumbs.slice(0),this._session&&(this._session.trackError(Ye),Ye.session=this._session),ie.severity!==void 0&&(Ye.severity=ie.severity,Ye._handledState.severityReason={type:"userSpecifiedSeverity"}),On(this.config.notifyReleaseStages)&&!Qi(this.config.notifyReleaseStages,ot))return this._logger.warn("Report not sent due to releaseStage/notifyReleaseStages configuration"),De(null,Ye);var Ti=Ye.severity,nd=[].concat(ie.beforeSend).concat(this.config.beforeSend),hc=function(Ss){ve._logger.error("Error occurred in beforeSend callback, continuing anyway\u2026"),ve._logger.error(Ss)};M(nd,ye(Ye,hc),function(Ss,Bg){if(Ss&&hc(Ss),Bg)return ve._logger.debug("Report not sent due to beforeSend callback"),De(null,Ye);ve.config.autoBreadcrumbs&&ve.leaveBreadcrumb(Ye.errorClass,{errorClass:Ye.errorClass,errorMessage:Ye.errorMessage,severity:Ye.severity},"error"),Ti!==Ye.severity&&(Ye._handledState.severityReason={type:"userCallbackSetSeverity"}),ve._delivery.sendReport(ve._logger,ve.config,{apiKey:Ye.apiKey||ve.config.apiKey,notifier:ve.notifier,events:[Ye]},function(cC){return De(cC,Ye)})})},G}(),xo=function(G,_,K){var Q=3,ie=function(et){var pr=N(et);return K.warn(pa+" "+pr),new Error(Wt+" "+pr)},De,ve=0,ot;switch(typeof G){case"string":typeof _=="string"?(De=ie("string/string"),ot={metaData:{notifier:{notifyArgs:[G,_]}}}):(De=new Error(String(G)),ve=Q);break;case"number":case"boolean":De=new Error(String(G));break;case"function":De=ie("function");break;case"object":G!==null&&(he(G)||G.__isBugsnagReport)?De=G:G!==null&&Qr(G)?(De=new Error(G.message||G.errorMessage),De.name=G.name||G.errorClass,ve=Q):De=ie(G===null?"null":"unsupported object");break;default:De=ie("nothing")}return{err:De,errorFramesToSkip:ve,_opts:ot}},Qr=function(G){return(typeof G.name=="string"||typeof G.errorClass=="string")&&(typeof G.message=="string"||typeof G.errorMessage=="string")},Yd=function(G){return`Bugsnag configuration error
`+Vi(G,function(_){return'"'+_.key+'" '+_.message+` 
    got `+$(_.value)}).join(`

`)},N=function(G){return"notify() expected error/opts parameters, got "+G},$=function(G){return typeof G=="object"?JSON.stringify(G):String(G)},Z=vi,be=function(G,_,K,Q){var ie=Q&&Q.filterKeys?Q.filterKeys:[],De=Q&&Q.filterPaths?Q.filterPaths:[];return JSON.stringify(Hn(G,ie,De),_,K)},oe=20,Ce=25e3,Pe=8,Be="...";function rt(G){return G instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(G))}function At(G){return"[Throws: "+(G?G.message:"?")+"]"}function yt(G,_){for(var K=0,Q=G.length;K<Q;K++)if(G[K]===_)return!0;return!1}function vt(G,_){for(var K=0,Q=G.length;K<Q;K++)if(_.indexOf(G[K])===0)return!0;return!1}function jt(G,_){for(var K=0,Q=G.length;K<Q;K++)if(typeof G[K]=="string"&&G[K]===_||G[K]&&typeof G[K].test=="function"&&G[K].test(_))return!0;return!1}function _r(G){return Object.prototype.toString.call(G)==="[object Array]"}function St(G,_){try{return G[_]}catch(K){return At(K)}}function Hn(G,_,K){var Q=[],ie=0;function De(ve,ot){function et(){return ot.length>Pe&&ie>Ce}if(ie++,ot.length>oe||et())return Be;if(ve===null||typeof ve!="object")return ve;if(yt(Q,ve))return"[Circular]";if(Q.push(ve),typeof ve.toJSON=="function")try{ie--;var pr=De(ve.toJSON(),ot);return Q.pop(),pr}catch(Bg){return At(Bg)}var Ot=rt(ve);if(Ot){ie--;var tn=De({name:ve.name,message:ve.message},ot);return Q.pop(),tn}if(_r(ve)){for(var Ye=[],Ti=0,nd=ve.length;Ti<nd;Ti++){if(et()){Ye.push(Be);break}Ye.push(De(ve[Ti],ot.concat("[]")))}return Q.pop(),Ye}var hc={};try{for(var Ss in ve)if(Object.prototype.hasOwnProperty.call(ve,Ss)){if(vt(K,ot.join("."))&&jt(_,Ss)){hc[Ss]="[Filtered]";continue}if(et()){hc[Ss]=Be;break}hc[Ss]=De(St(ve,Ss),ot.concat(Ss))}}catch(Bg){}return Q.pop(),hc}return De(G,[])}var Zi={},ss=["events.[].app","events.[].metaData","events.[].user","events.[].breadcrumbs","events.[].request","events.[].device"],en=["device","app","user"];Zi.report=function(G,_){var K=be(G,null,null,{filterPaths:ss,filterKeys:_});if(K.length>1e6&&(delete G.events[0].metaData,G.events[0].metaData={notifier:`WARNING!
Serialized payload was `+K.length/1e6+`MB (limit = 1MB)
metaData was removed`},K=be(G,null,null,{filterPaths:ss,filterKeys:_}),K.length>1e6))throw new Error("payload exceeded 1MB limit");return K},Zi.session=function(G,_){var K=be(G,null,null,{filterPaths:en,filterKeys:_});if(K.length>1e6)throw new Error("payload exceeded 1MB limit");return K};var dc={},rd=h.isoDate;dc=function(G){return G===void 0&&(G=window),{sendReport:function(_,K,Q,ie){ie===void 0&&(ie=function(){});var De=as(K,"notify","4",G),ve=new G.XDomainRequest;ve.onload=function(){ie(null)},ve.open("POST",De),setTimeout(function(){try{ve.send(Zi.report(Q,K.filters))}catch(ot){_.error(ot),ie(ot)}},0)},sendSession:function(_,K,Q,ie){ie===void 0&&(ie=function(){});var De=as(K,"sessions","1",G),ve=new G.XDomainRequest;ve.onload=function(){ie(null)},ve.open("POST",De),setTimeout(function(){try{ve.send(Zi.session(Q,K.filters))}catch(ot){_.error(ot),ie(ot)}},0)}}};var as=function(G,_,K,Q){return eC(G.endpoints[_],Q.location.protocol)+"?apiKey="+encodeURIComponent(G.apiKey)+"&payloadVersion="+K+"&sentAt="+encodeURIComponent(rd())},eC=dc._matchPageProtocol=function(G,_){return _==="http:"?G.replace(/^https:/,"http:"):G},Xu=h.isoDate,nl=function(G){return G===void 0&&(G=window),{sendReport:function(_,K,Q,ie){ie===void 0&&(ie=function(){});try{var De=K.endpoints.notify,ve=new G.XMLHttpRequest;ve.onreadystatechange=function(){ve.readyState===G.XMLHttpRequest.DONE&&ie(null)},ve.open("POST",De),ve.setRequestHeader("Content-Type","application/json"),ve.setRequestHeader("Bugsnag-Api-Key",Q.apiKey||K.apiKey),ve.setRequestHeader("Bugsnag-Payload-Version","4"),ve.setRequestHeader("Bugsnag-Sent-At",Xu()),ve.send(Zi.report(Q,K.filters))}catch(ot){_.error(ot)}},sendSession:function(_,K,Q,ie){ie===void 0&&(ie=function(){});try{var De=K.endpoints.sessions,ve=new G.XMLHttpRequest;ve.onreadystatechange=function(){ve.readyState===G.XMLHttpRequest.DONE&&ie(null)},ve.open("POST",De),ve.setRequestHeader("Content-Type","application/json"),ve.setRequestHeader("Bugsnag-Api-Key",K.apiKey),ve.setRequestHeader("Bugsnag-Payload-Version","1"),ve.setRequestHeader("Bugsnag-Sent-At",Xu()),ve.send(Zi.session(Q,K.filters))}catch(ot){_.error(ot)}}}},s1={init:function(G,_){_===void 0&&(_=window),G.config.beforeSend.unshift(function(K){K.context||(K.context=_.location.pathname)})}};function Xd(){return Xd=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},Xd.apply(this,arguments)}var zy=h.isoDate,ol={init:function(G,_){_===void 0&&(_=navigator);var K={locale:_.browserLanguage||_.systemLanguage||_.userLanguage||_.language,userAgent:_.userAgent};G.device=Xd({},K,G.device),G.config.beforeSend.unshift(function(Q){Q.device=Xd({},Q.device,{time:zy()})})}};function ph(){return ph=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},ph.apply(this,arguments)}var tC={init:function(G,_){_===void 0&&(_=window),G.config.beforeSend.unshift(function(K){K.request&&K.request.url||(K.request=ph({},K.request,{url:_.location.href}))})}};function uc(){return uc=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},uc.apply(this,arguments)}var MV=h.isArray,AV=h.includes,rC={init:function(G){return G.sessionDelegate(iC)}},iC={startSession:function(G){var _=G;_._session=new G.BugsnagSession;var K=ae(_);return MV(_.config.notifyReleaseStages)&&!AV(_.config.notifyReleaseStages,K)?(_._logger.warn("Session not sent due to releaseStage/notifyReleaseStages configuration"),_):_.config.endpoints.sessions?(_._delivery.sendSession(_._logger,_.config,{notifier:_.notifier,device:_.device,app:uc({},{releaseStage:K},_.app),sessions:[{id:_._session.id,startedAt:_._session.startedAt,user:_.user}]}),_):(_._logger.warn("Session not sent due to missing endpoints.sessions configuration"),_)}};function _g(){return _g=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},_g.apply(this,arguments)}var nC={init:function(G){G.config.collectUserIp||G.config.beforeSend.push(function(_){_.user&&typeof _.user.id=="undefined"&&delete _.user.id,_.user=_g({id:"[NOT COLLECTED]"},_.user),_.request=_g({clientIp:"[NOT COLLECTED]"},_.request)})},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(G){return G===!0||G===!1}}}},hh={},oC=h.map,sC=h.reduce,sl=h.filter;hh.init=function(G){var _=/^dev(elopment)?$/.test(G.config.releaseStage),K=G.config.consoleBreadcrumbsEnabled===!1,Q=(G.config.autoBreadcrumbs===!1||_)&&G.config.consoleBreadcrumbsEnabled!==!0;K||Q||oC(LV,function(ie){var De=console[ie];console[ie]=function(){for(var ve=arguments.length,ot=new Array(ve),et=0;et<ve;et++)ot[et]=arguments[et];G.leaveBreadcrumb("Console output",sC(ot,function(pr,Ot,tn){var Ye="[Unknown value]";try{Ye=String(Ot)}catch(Ti){}if(Ye==="[object Object]")try{Ye=JSON.stringify(Ot)}catch(Ti){}return pr["["+tn+"]"]=Ye,pr},{severity:ie.indexOf("group")===0?"log":ie}),"log"),De.apply(console,ot)},console[ie]._restore=function(){console[ie]=De}})},hh.configSchema={consoleBreadcrumbsEnabled:{defaultValue:function(){},validate:function(G){return G===!0||G===!1||G===void 0},message:"should be true|false"}};var LV=sl(["log","debug","info","warn","error"],function(G){return typeof console!="undefined"&&typeof console[G]=="function"}),Qd={},Qu=h.reduce;Qd={init:function(G,_,K){_===void 0&&(_=document),K===void 0&&(K=window);var Q="",ie=!1,De=function(){return _.documentElement.outerHTML},ve=K.location.href,ot=function(pr){var Ot=pr.stacktrace[0];if(!Ot||!Ot.file||!Ot.lineNumber||Ot.file.replace(/#.*$/,"")!==ve.replace(/#.*$/,""))return Ot;(!ie||!Q)&&(Q=De());var tn=["<!-- DOC START -->"].concat(Q.split(`
`)),Ye=$y(tn,Ot.lineNumber-1),Ti=Ye.script,nd=Ye.start,hc=Qu(Ti,function(Ss,Bg,cC){return Math.abs(nd+cC+1-Ot.lineNumber)>10||(Ss[""+(nd+cC+1)]=Bg),Ss},{});Ot.code=hc,pr.updateMetaData("script",{content:Ti.join(`
`)})};Q=De();var et=_.onreadystatechange;_.onreadystatechange=function(){_.readyState==="interactive"&&(Q=De(),ie=!0),typeof et=="function"&&et.apply(this,arguments)},G.config.beforeSend.unshift(ot)}};var Fg=/^.*<script.*?>/,Rg=/<\/script>.*$/,$y=Qd.extractScriptContent=function(G,_){for(var K=_;K<G.length&&!Rg.test(G[K]);)K++;for(var Q=K;K>0&&!Fg.test(G[K]);)K--;var ie=K,De=G.slice(ie,Q+1);return De[0]=De[0].replace(Fg,""),De[De.length-1]=De[De.length-1].replace(Rg,""),{script:De,start:ie}},aC={init:function(G,_){if(_===void 0&&(_=window),"addEventListener"in _){var K=G.config.interactionBreadcrumbsEnabled===!1,Q=G.config.autoBreadcrumbs===!1&&G.config.interactionBreadcrumbsEnabled!==!0;K||Q||_.addEventListener("click",function(ie){var De,ve;try{De=OV(ie.target),ve=Wy(ie.target,_)}catch(ot){De="[hidden]",ve="[hidden]",G._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/y94fq5zm")}G.leaveBreadcrumb("UI click",{targetText:De,targetSelector:ve},"user")},!0)}},configSchema:{interactionBreadcrumbsEnabled:{defaultValue:function(){},validate:function(G){return G===!0||G===!1||G===void 0},message:"should be true|false"}}},OV=function(G){var _=G.textContent||G.innerText||"";return!_&&(G.type==="submit"||G.type==="button")&&(_=G.value),_=_.replace(/^\s+|\s+$/g,""),lC(_,140)};function Wy(G,_){var K=[G.tagName];if(G.id&&K.push("#"+G.id),G.className&&G.className.length&&K.push("."+G.className.split(" ").join(".")),!_.document.querySelectorAll||!Array.prototype.indexOf)return K.join("");try{if(_.document.querySelectorAll(K.join("")).length===1)return K.join("")}catch(ie){return K.join("")}if(G.parentNode.childNodes.length>1){var Q=Array.prototype.indexOf.call(G.parentNode.childNodes,G)+1;K.push(":nth-child("+Q+")")}return _.document.querySelectorAll(K.join("")).length===1?K.join(""):G.parentNode?Wy(G.parentNode,_)+" > "+K.join(""):K.join("")}function lC(G,_){var K="(...)";return G&&G.length<=_?G:G.slice(0,_-K.length)+K}var v={};v.init=function(G,_){if(_===void 0&&(_=window),"addEventListener"in _){var K=G.config.navigationBreadcrumbsEnabled===!1,Q=G.config.autoBreadcrumbs===!1&&G.config.navigationBreadcrumbsEnabled!==!0;if(!(K||Q)){var ie=function(De){return function(){return G.leaveBreadcrumb(De,{},"navigation")}};_.addEventListener("pagehide",ie("Page hidden"),!0),_.addEventListener("pageshow",ie("Page shown"),!0),_.addEventListener("load",ie("Page loaded"),!0),_.document.addEventListener("DOMContentLoaded",ie("DOMContentLoaded"),!0),_.addEventListener("load",function(){return _.addEventListener("popstate",ie("Navigated back"),!0)}),_.addEventListener("hashchange",function(De){var ve=De.oldURL?{from:f(De.oldURL,_),to:f(De.newURL,_),state:y(_)}:{to:f(_.location.href,_)};G.leaveBreadcrumb("Hash changed",ve,"navigation")},!0),_.history.replaceState&&m(G,_.history,"replaceState",_),_.history.pushState&&m(G,_.history,"pushState",_),G.leaveBreadcrumb("Bugsnag loaded",{},"navigation")}}},v.configSchema={navigationBreadcrumbsEnabled:{defaultValue:function(){},validate:function(G){return G===!0||G===!1||G===void 0},message:"should be true|false"}};var f=function(G,_){var K=_.document.createElement("A");return K.href=G,""+K.pathname+K.search+K.hash},d=function(G,_,K,Q){var ie=f(G.location.href,G);return{title:K,state:_,prevState:y(G),to:Q||ie,from:ie}},m=function(G,_,K,Q){var ie=_[K];_[K]=function(De,ve,ot){G.leaveBreadcrumb("History "+K,d(Q,De,ve,ot),"navigation"),typeof G.refresh=="function"&&G.refresh(),G.config.autoCaptureSessions&&G.startSession(),ie.apply(_,[De,ve].concat(ot!==void 0?ot:[]))},_[K]._restore=function(){_[K]=ie}},y=function(G){try{return G.history.state}catch(_){}},E={},F="request",z="BS~~S",ee="BS~~U",ue="BS~~M",He=h.includes,_e=[],Ie,We,Ze=function(){return[Ie.config.endpoints.notify,Ie.config.endpoints.sessions]};E.init=function(G,_){_===void 0&&(_=window);var K=G.config.networkBreadcrumbsEnabled===!1,Q=G.config.autoBreadcrumbs===!1&&G.config.networkBreadcrumbsEnabled!==!0;K||Q||(Ie=G,We=_,pt(),Hr())},E.configSchema={networkBreadcrumbsEnabled:{defaultValue:function(){},validate:function(G){return G===!0||G===!1||G===void 0},message:"should be true|false"}};var pt=function(){if("addEventListener"in We.XMLHttpRequest.prototype){var G=We.XMLHttpRequest.prototype.open;We.XMLHttpRequest.prototype.open=function(K,Q){this[ee]=Q,this[ue]=K,this[z]&&(this.removeEventListener("load",bt),this.removeEventListener("error",_t)),this.addEventListener("load",bt),this.addEventListener("error",_t),this[z]=!0,G.apply(this,arguments)}}};function bt(){if(!He(Ze(),this[ee])){var G={status:this.status,request:this[ue]+" "+this[ee]};this.status>=400?Ie.leaveBreadcrumb("XMLHttpRequest failed",G,F):Ie.leaveBreadcrumb("XMLHttpRequest succeeded",G,F)}}function _t(){He(Ze(),this[ee])||Ie.leaveBreadcrumb("XMLHttpRequest error",{request:this[ue]+" "+this[ee]},F)}var Hr=function(){if("fetch"in We){var G=We.fetch;We.fetch=function(){for(var K=arguments.length,Q=new Array(K),ie=0;ie<K;ie++)Q[ie]=arguments[ie];var De=Q[0],ve=Q[1],ot="GET";return ve&&ve.method&&(ot=ve.method),new Promise(function(et,pr){G.apply(void 0,Q).then(function(Ot){Vn(Ot,ot,De),et(Ot)}).catch(function(Ot){Zr(ot,De),pr(Ot)})})}}},Vn=function(G,_,K){var Q={status:G.status,request:_+" "+K};G.status>=400?Ie.leaveBreadcrumb("fetch() failed",Q,F):Ie.leaveBreadcrumb("fetch() succeeded",Q,F)},Zr=function(G,_){Ie.leaveBreadcrumb("fetch() error",{request:G+" "+_},F)},Pn=b.intRange,ha={init:function(G){var _=0;G.config.beforeSend.push(function(K){if(_>=G.config.maxEvents)return K.ignore();_++}),G.refresh=function(){_=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer \u2264100",validate:function(G){return Pn(1,100)(G)}}}},Zs={};function pc(){return pc=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},pc.apply(this,arguments)}var ei=h.map;Zs={init:function(G){G.config.beforeSend.push(function(_){_.stacktrace=ei(_.stacktrace,function(K){return pc({},K,{file:id(K.file)})})})}};var id=Zs._strip=function(G){return typeof G=="string"?G.replace(/\?.*$/,"").replace(/#.*$/,""):G},Ml={init:function(G,_){_===void 0&&(_=window);function K(ie,De,ve,ot,et){if(ve===0&&/Script error\.?/.test(ie))G._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/y94fq5zm");else{var pr={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},Ot;if(et)et.name&&et.message?Ot=new G.BugsnagReport(et.name,et.message,jy(G.BugsnagReport.getStacktrace(et),De,ve,ot),pr,et):(Ot=new G.BugsnagReport("window.onerror",String(et),jy(G.BugsnagReport.getStacktrace(et,1),De,ve,ot),pr,et),Ot.updateMetaData("window onerror",{error:et}));else if(typeof ie=="object"&&ie!==null&&(!De||typeof De!="string")&&!ve&&!ot&&!et){var tn=ie.type?"Event: "+ie.type:"window.onerror",Ye=ie.message||ie.detail||"";Ot=new G.BugsnagReport(tn,Ye,G.BugsnagReport.getStacktrace(new Error,1).slice(1),pr,ie),Ot.updateMetaData("window onerror",{event:ie,extraParameters:De})}else Ot=new G.BugsnagReport("window.onerror",String(ie),jy(G.BugsnagReport.getStacktrace(et,1),De,ve,ot),pr,ie),Ot.updateMetaData("window onerror",{event:ie});G.notify(Ot)}typeof Q=="function"&&Q.apply(this,arguments)}var Q=_.onerror;_.onerror=K}},jy=function(G,_,K,Q){var ie=G[0];return ie&&(!ie.fileName&&typeof _=="string"&&ie.setFileName(_),!ie.lineNumber&&Ng(K)&&ie.setLineNumber(K),ie.columnNumber||(Ng(Q)?ie.setColumnNumber(Q):window.event&&Ng(window.event.errorCharacter)&&ie.setColumnNumber(window.event.errorCharacter))),G},Ng=function(G){return typeof G=="number"&&String.call(G)!=="NaN"},Jy={},Cq=h.reduce,Dq;Jy.init=function(G,_){_===void 0&&(_=window);var K=function(Q){var ie=Q.reason,De=!1;try{Q.detail&&Q.detail.reason&&(ie=Q.detail.reason,De=!0)}catch(pr){}var ve={severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}},ot;if(ie&&U(ie))ot=new G.BugsnagReport(ie.name,ie.message,Ee.parse(ie),ve,ie),De&&(ot.stacktrace=Cq(ot.stacktrace,Eq(ie),[]));else{var et='Rejection reason was not an Error. See "Promise" tab for more detail.';ot=new G.BugsnagReport(ie&&ie.name?ie.name:"UnhandledRejection",ie&&ie.message?ie.message:et,[],ve,ie),ot.updateMetaData("promise","rejection reason",Sq(ie))}G.notify(ot)};"addEventListener"in _?_.addEventListener("unhandledrejection",K):_.onunhandledrejection=function(Q,ie){K({detail:{reason:Q,promise:ie}})},Dq=K};var Sq=function(G){if(G==null)return"undefined (or null)";if(he(G)){var _;return _={},_[Object.prototype.toString.call(G)]={name:G.name,message:G.message,code:G.code,stack:G.stack},_}else return G},Eq=function(G){return function(_,K){return K.file===G.toString()?_:(K.method&&(K.method=K.method.replace(/^\s+/,"")),_.concat(K))}},Yy={};function PV(){return PV=Object.assign||function(G){for(var _=1;_<arguments.length;_++){var K=arguments[_];for(var Q in K)Object.prototype.hasOwnProperty.call(K,Q)&&(G[Q]=K[Q])}return G},PV.apply(this,arguments)}var kq="Bugsnag JavaScript",Gq="6.1.0",Iq="https://github.com/bugsnag/bugsnag-js",Vq=h.map,Tq=PV({},C.schema,ne);return Yy=function(G){typeof G=="string"&&(G={apiKey:G});var _=[];G.sessionTrackingEnabled&&(_.push("deprecated option sessionTrackingEnabled is now called autoCaptureSessions"),G.autoCaptureSessions=G.sessionTrackingEnabled),(G.endpoint||G.sessionEndpoint)&&!G.endpoints&&(_.push("deprecated options endpoint/sessionEndpoint are now configured in the endpoints object"),G.endpoints={notify:G.endpoint,sessions:G.sessionEndpoint}),G.endpoints&&G.endpoints.notify&&!G.endpoints.sessions&&_.push("notify endpoint is set but sessions endpoint is not. No sessions will be sent.");var K=new Z({name:kq,version:Gq,url:Iq});return K.setOptions(G),K.delivery(window.XDomainRequest?dc():nl()),K.configure(Tq),Vq(_,function(Q){return K._logger.warn(Q)}),K.use(ol),K.use(s1),K.use(tC),K.use(Qd),K.use(ha),K.use(rC),K.use(nC),K.use(Zs),K.config.autoNotify!==!1&&(K.use(Ml),K.use(Jy)),K.use(v),K.use(aC),K.use(E),K.use(hh),K.config.autoCaptureSessions?K.startSession():K},Yy.Bugsnag={Client:Z,Report:xi,Session:In,Breadcrumb:q},Yy.default=Yy,Yy})});var FO;function Aq(r){FO=r(__dcg_shared_module_exports__['c'])}Aq(function(r){function e(){window.consoleOverride=!0;var i=window.console.log;window.console.log=function(){for(var n=[],o=0;o<arguments.length;o++)n.push(arguments[o]);i.apply(window.console,[].concat([n.join(" ")],n))}}var t={ready:function(){try{window.TestBridge=t,parent.USING_SELENIUM&&e()}catch(i){}}};return t});var{ready:RO}=FO;ct();ct();var $r={};__dcg_shared_module_exports__['g']($r,{ALT:()=>E4,BACKSPACE:()=>ul,CAPSLOCK:()=>k4,CONTROL:()=>S4,DELETE:()=>Ah,DOWN:()=>Eo,END:()=>pp,ENTER:()=>Fl,ESCAPE:()=>Do,HOME:()=>hp,LEFT:()=>hd,PAGEDOWN:()=>pm,PAGEUP:()=>um,RIGHT:()=>gd,SHIFT:()=>pb,SPACEBAR:()=>hb,TAB:()=>pl,UP:()=>So,default:()=>pd,isBacktick:()=>D4,isHelp:()=>sT,isRedo:()=>Mh,isSelectAll:()=>C4,isUndo:()=>Th,lookup:()=>Re,lookupChar:()=>Di});ct();var DP=function(){{var r={IS_IE8:navigator.userAgent.match(/MSIE 8.0/i)!==null,IS_IE9:navigator.userAgent.match(/MSIE 9.0/i)!==null,IS_IE:navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null,IS_EDGE:navigator.userAgent.match(/Edge/i)!==null,IS_IPAD:navigator.userAgent.match(/iPad/i)!==null,IS_MOBILE:navigator.userAgent.match(/Mobile|Android/i)!==null,IS_ANDROID:navigator.userAgent.match(/Android/i)!==null,IS_IOS:navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,IS_CHROME:navigator.userAgent.match(/Chrome/i)!==null,IS_FIREFOX:navigator.userAgent.match(/Firefox/i)!==null,IS_SAFARI:navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,IS_APPLE:navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,IS_WINDOWS:navigator.platform.match(/(Win32)/i)!==null,IS_TOUCH:navigator.userAgent.match(/Touch/i)!==null,IS_KINDLE:navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i)!==null,IS_BRAILLENOTE:navigator.userAgent.match(/KeyWeb/i)!==null,IS_IN_IFRAME:window.parent!==window};return r.IS_TABLET=r.IS_IPAD||r.IS_ANDROID||r.IS_KINDLE,r.IS_TOUCH_DEVICE=r.SHOULD_NOT_AUTOFOCUS=r.IS_IOS||r.IS_ANDROID||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),r.IOS_VERSION=function(){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:null}(),r.MAC_VERSION=function(){var e=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:null}(),r.CHROME_VERSION=function(){var e=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return e?[parseInt(e[2],10),parseInt(e[3],10),parseInt(e[4]||0,10)]:null}(),r.SUPPORTS_INPUTMODE=function(){var e="inputMode"in document.createElement("textarea");return!(!e||r.IS_IOS&&r.IOS_VERSION&&r.IOS_VERSION[0]<15)}(),r.SUPPORTS_TRANSLATE3D=!1,O(document).ready(function(){var e=document.createElement("p"),t,i,n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(e,null);for(var o in n)if(e.style[o]!==void 0){if(e.style[o]="translate3d(1px,1px,1px)",i=window.getComputedStyle(e),!i)return;t=i.getPropertyValue(n[o])}document.body.removeChild(e),r.SUPPORTS_TRANSLATE3D=t!==void 0&&t.length>0&&t!=="none"}),r.translateRule=function(e,t){return r.SUPPORTS_TRANSLATE3D?"translate3d("+e+(e?"px":"")+","+t+(t?"px":"")+",0)":"translate("+e+(e?"px":"")+","+t+(t?"px":"")+")"},r.SUPPORTS_CANVAS=function(){var e=document.createElement("canvas"),t=!!(e.getContext&&e.getContext("2d"));return t}(),r.SUPPORTS_WEBP=function(){var e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))&&e.toDataURL("image/webp").indexOf("data:image/webp")==0}(),r}}(),SP=DP,{SHOULD_NOT_AUTOFOCUS:fc,IS_TOUCH_DEVICE:EP,IS_SAFARI:kP,IS_APPLE:di,IS_IOS:dp,IS_ANDROID:up,IS_IPAD:dl,IS_IN_IFRAME:du,IOS_VERSION:ub,MAC_VERSION:ire,CHROME_VERSION:nre,IS_IE:GP,IS_EDGE:ore,IS_CHROME:IP,IS_FIREFOX:VP,IS_MOBILE:_l,IS_WINDOWS:TP,IS_TOUCH:MP,SUPPORTS_INPUTMODE:HC,SUPPORTS_CANVAS:sre,SUPPORTS_WEBP:are,translateRule:lre}=DP;var AP=function(){{var r=function(){for(var e={8:this.BACKSPACE="Backspace",9:this.TAB="Tab",13:this.ENTER="Enter",16:this.SHIFT="Shift",17:this.CONTROL="Control",18:this.ALT="Alt",20:this.CAPSLOCK="CapsLock",27:this.ESCAPE="Esc",32:this.SPACEBAR="Space",33:this.PAGEUP="PageUp",34:this.PAGEDOWN="PageDown",35:this.END="End",36:this.HOME="Home",37:this.LEFT="Left",38:this.UP="Up",39:this.RIGHT="Right",40:this.DOWN="Down",46:this.DELETE="Del"},t={Backspace:this.BACKSPACE,Tab:this.TAB,Enter:this.ENTER,Shift:this.SHIFT,Control:this.CONTROL,Alt:this.ALT,CapsLock:this.CAPSLOCK,Escape:this.ESCAPE," ":this.SPACEBAR,PageUp:this.PAGEUP,PageDown:this.PAGEDOWN,End:this.END,Home:this.HOME,ArrowLeft:this.LEFT,ArrowUp:this.UP,ArrowRight:this.RIGHT,ArrowDown:this.DOWN,Delete:this.DELETE},i={UIKeyInputUpArrow:this.UP,UIKeyInputDownArrow:this.DOWN,UIKeyInputLeftArrow:this.LEFT,UIKeyInputRightArrow:this.RIGHT,UIKeyInputEscape:this.ESCAPE,UIKeyInputPageUp:this.PAGEUP,UIKeyInputPageDown:this.PAGEDOWN},n=["0123456789abcdefghijklmnopqrstuvwxyz","\xBA\xA1\u2122\xA3\xA2\u221E\xA7\xB6\u2022\xAA\xE5\u222B\xE7\u2202 \u0192\xA9\u02D9 \u2206\u02DA\xAC\xB5 \xF8\u03C0\u0153\xAE\xDF\u2020 \u221A\u2211\u2248\xA5\u03A9","\u201A\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB0\xB7\xC5\u0131\xC7\xCE\xB4\xCF\u02DD\xD3\u02C6\xD4\uF8FF\xD2\xC2\u02DC\xD8\u220F\u0152\u2030\xCD\u02C7\xA8\u25CA\u201E\u02DB\xC1\xB8"].map(function(g){return g.split("")}),o=n[0],s=n[1],a=n[2],l={},c={},u=0;u<o.length;u++){var p=o[u];s[u]!==" "&&(l[s[u]]=p.toUpperCase()),a[u]!==" "&&(c[a[u]]=p.toUpperCase())}this.isUndo=function(g){return!g.altKey&&!g.shiftKey&&(g.ctrlKey||g.metaKey)&&(g.key=="z"||g.which==90)},this.isRedo=function(g){return!g.altKey&&(g.ctrlKey||g.metaKey)&&(g.key==="y"||g.which==89||g.shiftKey&&(g.key==="Z"||g.key==="z"||g.which===90))},this.isSelectAll=function(g){return!g.altKey&&(g.ctrlKey||g.metaKey)&&(g.key==="a"||g.key==="A"||g.which==65)},this.isBacktick=function(g){return!g.altKey&&!g.ctrlKey&&!g.metaKey&&!g.shiftKey&&(g.key==="`"||g.which==192)},this.isHelp=function(g){return!g.altKey&&(g.ctrlKey||g.metaKey)&&(g.key==="/"||g.which==191)},this.lookup=function(g){return t[g.key]||e[g.which]||i[g.key]},this.lookupChar=function(g){if(!g.key)return String.fromCharCode(g.which);if(SP.IS_APPLE&&g.altKey){var h=g.shiftKey?c:l;if(h[g.key])return h[g.key]}if(g.key.length===1)return g.key.toUpperCase();if(g.key==="Enter")return String.fromCharCode(13);if(g.key==="Tab")return String.fromCharCode(9)}};return new r}}(),pd=AP,{isUndo:Th,isRedo:Mh,isSelectAll:C4,isBacktick:D4,isHelp:sT,BACKSPACE:ul,TAB:pl,ENTER:Fl,SHIFT:pb,CONTROL:S4,ALT:E4,CAPSLOCK:k4,ESCAPE:Do,SPACEBAR:hb,PAGEUP:um,PAGEDOWN:pm,END:pp,HOME:hp,LEFT:hd,UP:So,RIGHT:gd,DOWN:Eo,DELETE:Ah,lookup:Re,lookupChar:Di}=AP;var G4=function(){{let de=function(U,ce){U.trim().split(/\s+/).forEach(function(Oe){var Qe=Se?{passive:!1}:void 0;document.addEventListener(Oe,function(Ct){n("document.on:"+Ct.type),ce(O.event.fix(Ct))},Qe)})},Ee=function(U){var ce=!!O(U).closest(".dcg-do-not-blur").length,Oe=!!O(U).closest(".dcg-do-blur").length;return!!(ce&&!Oe&&H(U))};var r=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,e,t;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0),window._touchtracking_id_counter+=1;var i="touchtracking_id_"+window._touchtracking_id_counter,n=function(U){t&&(t[0].value="("+Date.now()+") "+U+`
`+t[0].value)},o=function(U){O(U).addClass("dcg-tap-container"),O(U).addClass(i),r&&(e&&e.remove(),e=O('<div style="position:absolute;bottom:10px;right:10px;"><textarea rows="30" cols="40"></textarea><div id="dcg-touchtracking-debug-copy" class="dcg-btn-blue">COPY LOGS</div></div>'),t=e.find("textarea"),O(U).append(e),O("#dcg-touchtracking-debug-copy")[0].addEventListener("mousedown",function(){t[0].select(),document.execCommand("copy")},!0),n("monitor touches"))},s=function(U){O(U).addClass("dcg-no-touchtracking")},a=0,l=1,c=2,u=3,p=4,g=a,h={},b={},C=[],D=0,S=null,V=null,k=null,T=[],A=function(U){for(var ce=[];U;)ce.push(U),U=U.parentNode;return ce},R=function(U){for(var ce=[],Oe=0;Oe<U.length;Oe++){var Qe=U[Oe];if(ce.push(Qe),O(Qe).is(".dcg-tap-container, .dcg-no-touchtracking"))return O(Qe).is(".dcg-tap-container."+i)?ce:[]}return[]},P=function(U,ce){V=null,g=U,n("beginMode:"+g),g===l?C=A(ce.originalEvent.touches[0].target):C=A(ce.target),O(R(C)).addClass("dcg-depressed").each(function(){var Oe=O(this);j(Oe)&&Oe.addClass("dcg-focus-by-tap")}),O(C).each(function(){var Oe=O(this);Oe.data({originalScrollTop:Oe.scrollTop(),originalScrollLeft:Oe.scrollLeft()})}),b={}},W=function(U){return U.is('input, textarea, select, [role="textbox"]')||U.hasClass("dcg-mathquill-input-span")||U.is("[contenteditable=true]")},H=function(U){return!!O(U).closest(".dcg-tap-container, .dcg-no-touchtracking").is(".dcg-tap-container."+i)},j=function(U){return g!==u&&!W(U)&&H(U)},ne=function(U,ce){V=null;var Oe=!1;n("endMode:"+g),O(".dcg-depressed").removeClass("dcg-depressed");var Qe=O(document.activeElement);if(!Ee(U.target)&&j(Qe))try{Qe.blur()}catch(Et){}if(O(".dcg-focus-by-tap").removeClass("dcg-focus-by-tap"),O(C).each(function(){var Et=O(this),lt=Et.data("originalScrollTop")-Et.scrollTop(),dt=Et.data("originalScrollLeft")-Et.scrollLeft();(lt||dt)&&(b.scroll=!0)}),b["dcg-tapstart"]===1&&b["dcg-tapend"]===1&&!b["dcg-tapcancel"]&&!b.scroll){n("potential dcg-tap");var Ct=ce.changedTouches[0].clientX,Je=ce.changedTouches[0].clientY;if(U&&!U.device&&Ct===0&&Je===0){n("event appears to be simulated"),Oe=!0,g=u;var tr=U.target.getBoundingClientRect();Ct=(tr.left+tr.right)/2,Je=(tr.top+tr.bottom)/2}n("potential dcg-tap coords:"+Ct+":"+Je);for(var mr=!1,we=!1,Xr=0;Xr<C.length&&!mr;Xr++){var xi=O(C[Xr]),Le;if(typeof xi[0].getBoundingClientRect=="function"&&(Le=xi[0].getBoundingClientRect()),xi.attr("tapboundary")==="true"&&(mr=!0),!(Le&&(Ct<Le.left||Je<Le.top||Ct>Le.right||Je>Le.bottom))){V=xi[0],we=!0,q("dcg-tap",U,{target:V,touches:ce.touches,changedTouches:ce.changedTouches});break}}}n("result of dcg-tap:  did_dispatch="+we+"  did_escape="+mr),g===l||g===p?S=setTimeout(function(){S=null,D=new Date().getTime()},1e3):Oe&&(S=setTimeout(function(){S=null,D=new Date().getTime()},100)),C=[],g=a},le=function(){return S||new Date().getTime()-D<500},w=function(U){return U.identifier!==void 0?U.identifier:U.pointerId},B=function(U){for(var ce=[],Oe=0;Oe<U.length;Oe++){var Qe=U[Oe];ce.push({identifier:w(Qe),x:Qe.pageX,y:Qe.pageY,screenX:Qe.screenX,screenY:Qe.screenY,pageX:Qe.pageX,pageY:Qe.pageY,clientX:Qe.clientX,clientY:Qe.clientY})}return ce},q=function(U,ce,Oe){var Qe=w(ce),Ct=B(Oe.touches),Je=B(Oe.changedTouches);if(n("dispatchEvent:"+U),U==="dcg-tapstart")h[Qe]={type:U,pageX:Je[0].pageX,pageY:Je[0].pageY};else if(U==="dcg-tapmove"){var tr=Je[0],mr=h[Qe];if(mr&&tr.pageX===mr.pageX&&tr.pageY===mr.pageY||(g===l||g===p)&&mr&&mr.type==="dcg-tapstart"&&Math.abs(mr.pageX-tr.pageX)+Math.abs(mr.pageY-tr.pageY)<2)return;h[Qe]={type:U,pageX:Je[0].pageX,pageY:Je[0].pageY}}b[U.toLowerCase()]===void 0?b[U.toLowerCase()]=1:b[U.toLowerCase()]++;var we=O.event.fix(ce.originalEvent);we.type=U,we.device=g===l||g===p?"touch":g===u?"keyboard":"mouse",we.touches=Ct,we.changedTouches=Je,we.target=Oe.target?Oe.target:ce.target;var Xr=we.device!=="keyboard"&&b["dcg-longhold"]>0;we.wasLongheld=function(){return Xr},we.preventTap=function(){b["dcg-tapcancel"]=1},clearTimeout(k),we.type==="dcg-tapstart"&&we.device!=="keyboard"&&we.touches.length===1&&(k=setTimeout(function(){q("dcg-longhold",ce,Oe)},500)),we.target&&we.target.nodeName&&we.target.nodeName.toLowerCase()==="a"&&we.type==="dcg-tap"&&we.device==="keyboard"&&we.target.click&&we.target.click(),n("trigger event:"+we.type),O(we.target).trigger(we)},M=function(U){var ce=C,Oe=!!C.length,Qe=O(".dcg-tap-container."+i+" .dcg-hovered"),Ct=O.makeArray(Qe.filter(function(){return H(this)})),Je=[],tr=[],mr=[];R(A(U)).forEach(function(Xr){(!Oe||ce.indexOf(Xr)!==-1)&&(Ct.indexOf(Xr)===-1&&mr.push(Xr),Je.push(Xr))});for(var we=0;we<Ct.length;we++)U=Ct[we],Je.indexOf(U)===-1&&tr.push(U);O(tr).removeClass("dcg-hovered").trigger("tipsyhide"),O(mr).addClass("dcg-hovered").trigger("tipsyshow")},ae=function(U){for(var ce=0;ce<T.length;ce++)if(T[ce].pointerId===U)return!0;return!1},se=function(U){for(var ce=0;ce<T.length;ce++)if(T[ce].pointerId===U)return T.splice(ce,1)[0]},ge=function(U){g===a&&P(p,U),M(null),T.push(U.originalEvent),q("dcg-tapstart",U,{touches:T,changedTouches:[U.originalEvent]})},he=function(U){se(U.originalEvent.pointerId);var ce={touches:T,changedTouches:[U.originalEvent]};q("dcg-tapcancel",U,ce),T.length===0&&ne(U,ce)},ye=function(U){se(U.originalEvent.pointerId);var ce={touches:T,changedTouches:[U.originalEvent]};q("dcg-tapend",U,ce),T.length===0&&ne(U,ce)},fe=function(U){return U.originalEvent.pointerType==="touch"||U.originalEvent.pointerType===2};de("pointerdown MSPointerDown",function(U){if(!(g===c||g===l||!fe(U))){if(ae(U.originalEvent.pointerId)){n("exit. pointer id already exists: "+U.originalEvent.pointerId);return}ge(U)}}),de("pointermove MSPointerMove",function(U){g===c||g===l||!fe(U)||(ae(U.originalEvent.pointerId)||(n("pointer id already exists: "+U.originalEvent.pointerId),ge(U)),se(U.originalEvent.pointerId),T.push(U.originalEvent),q("dcg-tapmove",U,{touches:T,changedTouches:[U.originalEvent]}))}),O(document).on("pointercancel MSPointerCancel",function(U){if(n("document.on:"+U.type),!(g!==p||!fe(U))&&ae(U.originalEvent.pointerId)){he(U);for(var ce;ce=T.pop();){var U=O.Event(ce,{originalEvent:ce});he(U)}}}),O(document).on("pointerup MSPointerUp",function(U){if(n("document.on:"+U.type),!(g!==p||!fe(U))&&ae(U.originalEvent.pointerId)){ye(U);for(var ce;ce=T.pop();){var U=O.Event(ce,{originalEvent:ce});ye(U)}}});var Se=function(){var U=!1;try{var ce=Object.defineProperty({},"passive",{get:function(){U=!0}});window.addEventListener("test",function(){},ce),window.removeEventListener("test",function(){},ce)}catch(Oe){}return U}();return de("touchstart",function(U){g===c||g===p||(g===a&&P(l,U),M(null),q("dcg-tapstart",U,{touches:U.originalEvent.touches,changedTouches:U.originalEvent.changedTouches}))}),de("touchmove",function(U){g===l&&q("dcg-tapmove",U,{touches:U.originalEvent.touches,changedTouches:U.originalEvent.changedTouches})}),de("touchcancel",function(U){if(g===l){var ce={touches:U.originalEvent.touches,changedTouches:U.originalEvent.changedTouches};q("dcg-tapcancel",U,ce),U.originalEvent.touches.length===0&&ne(U,ce)}}),de("touchend",function(U){if(g===l){var ce={touches:U.originalEvent.touches,changedTouches:U.originalEvent.changedTouches};q("dcg-tapend",U,ce),U.originalEvent.touches.length===0&&ne(U,ce)}}),O(document).on("mousedown",function(U){if(n("document.on:"+U.type),!(U.button===1||U.button===2)){if(g===l||g===p||le()){!O(U.target).is("input, textarea, select")&&H(U.target)&&U.preventDefault(),n("abort mousedown: "+g+":"+le());return}P(c,U),q("dcg-tapstart",U,{touches:[U],changedTouches:[U]})}}),O(document).ready(function(){O(document).on("mousedown",function(U){if(n("document.on:"+U.type),!!Ee(U.target)){U.preventDefault();try{var ce=window.getSelection();if(ce.rangeCount===1){var Oe=ce.getRangeAt(0);Oe.startContainer===Oe.endContainer&&O(Oe.startContainer).closest(".dcg-text-selectable").length&&ce.removeAllRanges()}}catch(Qe){}}})}),O(document).on("mouseleave",function(U){if(n("document.on:"+U.type),g===a){if(le()){n("abort mouseleave: "+g+":"+le());return}M(null)}}),O(document).on("mousemove",function(U){if(n("document.on:"+U.type),!(U.button===1||U.button===2)&&!(g===l||g===p)){if(le()){n("abort mousemove: "+g+":"+le());return}M(U.target),q("dcg-tapmove",U,{touches:[U],changedTouches:[U]})}}),O(document).on("mouseup",function(U){if(n("document.on:"+U.type),!(U.button===1||U.button===2)&&g===c){var ce={touches:[],changedTouches:[U]};q("dcg-tapend",U,ce),ne(U,ce)}}),O(document).on("keydown",function(U){if(n("document.on:"+U.type),!(pd.lookup(U)!==pd.ENTER&&pd.lookup(U)!==pd.SPACEBAR||!H(U.target))&&g!==u){if(O(U.target).is('a:not([ontap]), button, input, textarea, select, [role="textbox"], [contenteditable="true"]'))return;U.preventDefault(),P(u,U),q("dcg-tapstart",U,{touches:[U],changedTouches:[U]})}}),O(document).on("keyup",function(U){if(n("document.on:"+U.type),!(pd.lookup(U)!==pd.ENTER&&pd.lookup(U)!==pd.SPACEBAR||!H(U.target))&&g===u){var ce={touches:[],changedTouches:[U]};q("dcg-tapend",U,ce),ne(U,ce)}}),{monitor:o,ignore:s,isTapActive:function(){return g!==a},elIsFocusable:W}}}();var{ignore:mre,isTapActive:LP,elIsFocusable:gp,monitor:mp}=G4;var OP=`[
  {
    "hash": "2rnqgoa6a4",
    "parent_hash": "89ndqgh5id",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/2rnqgoa6a4.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/2rnqgoa6a4",
    "title": "Lines: Slope Intercept Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 19:24:05 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lines-slope-intercept-form",
    "example": true
  },
  {
    "hash": "onfy0dzx2o",
    "parent_hash": "kha6fgxhaf",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/onfy0dzx2o.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/onfy0dzx2o",
    "title": "Lines: Point Slope Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:21:16 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lines-point-slope-form",
    "example": true
  },
  {
    "hash": "md6buy4efz",
    "parent_hash": "fi71u8ej0q",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/md6buy4efz.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/md6buy4efz",
    "title": "Lines: Two Point Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:21:39 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lines-two-point-form",
    "example": true
  },
  {
    "hash": "zukjgk9iry",
    "parent_hash": "jv9fmw2qz8",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/zukjgk9iry.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/zukjgk9iry",
    "title": "Parabolas: Standard Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:22:02 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-standard-form",
    "example": true
  },
  {
    "hash": "8keeh1pt5l",
    "parent_hash": "klodq5d0ph",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/8keeh1pt5l.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/8keeh1pt5l",
    "title": "Parabolas: Vertex Form",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:22:22 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-vertex-form",
    "example": true
  },
  {
    "hash": "dxkknajdqb",
    "parent_hash": "t6auzqijzl",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/dxkknajdqb.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/dxkknajdqb",
    "title": "Parabolas: Standard Form + Tangent",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:24:05 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent",
    "example": true
  },
  {
    "hash": "kihjluohq9",
    "parent_hash": "vpnnmvncdb",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/kihjluohq9.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/kihjluohq9",
    "title": "Trigonometry: Period and Amplitude",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:24:32 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-period-and-amplitude",
    "example": true
  },
  {
    "hash": "l3u8133jwj",
    "parent_hash": "51d9lso1ia",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/l3u8133jwj.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/l3u8133jwj",
    "title": "Trigonometry: Phase",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:24:53 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-phase",
    "example": true
  },
  {
    "hash": "7eeumgl7it",
    "parent_hash": "7rnv0erick",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/7eeumgl7it.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/7eeumgl7it",
    "title": "Trigonometry: Wave Interference",
    "access": "link",
    "created": "Tue, 03 Dec 2019 18:14:54 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-wave-interference",
    "example": true
  },
  {
    "hash": "qmzx2skkzy",
    "parent_hash": "s9myfmvujr",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/qmzx2skkzy.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/qmzx2skkzy",
    "title": "Trigonometry: Unit Circle",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:26:18 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-trig-unit-circle",
    "example": true
  },
  {
    "hash": "ivud1auwvw",
    "parent_hash": "8dsmqe5ycc",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/ivud1auwvw.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/ivud1auwvw",
    "title": "Conic Sections: Circle",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:27:04 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-circle",
    "example": true
  },
  {
    "hash": "djcrjdfiif",
    "parent_hash": "0jwlvn9hcs",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/djcrjdfiif.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/djcrjdfiif",
    "title": "Conic Sections: Parabola and Focus",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:27:50 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-parabola-and-focus",
    "example": true
  },
  {
    "hash": "afja7ee9mh",
    "parent_hash": "duajwxdopa",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/afja7ee9mh.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/afja7ee9mh",
    "title": "Conic Sections: Ellipse with Foci",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:28:08 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci",
    "example": true
  },
  {
    "hash": "vgfqbejegx",
    "parent_hash": "k6xcbueze5",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/vgfqbejegx.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/vgfqbejegx",
    "title": "Conic Sections: Hyperbola",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:28:27 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-conic-sections-hyperbola",
    "example": true
  },
  {
    "hash": "0ovfwwmfrb",
    "parent_hash": "scuci1750d",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/0ovfwwmfrb.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/0ovfwwmfrb",
    "title": "Polar: Rose",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:28:48 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-rose",
    "example": true
  },
  {
    "hash": "qlbdlxyrza",
    "parent_hash": "nicremwert",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/qlbdlxyrza.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/qlbdlxyrza",
    "title": "Polar: Logarithmic Spiral",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:29:08 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-logarithmic-spiral",
    "example": true
  },
  {
    "hash": "rayzacuktw",
    "parent_hash": "21pbohd07u",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/rayzacuktw.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/rayzacuktw",
    "title": "Polar: Limacon",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:29:25 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-limacon",
    "example": true
  },
  {
    "hash": "gxnu7fbgks",
    "parent_hash": "kk3axf8oon",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/gxnu7fbgks.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/gxnu7fbgks",
    "title": "Polar: Conic Sections",
    "access": "link",
    "created": "Tue, 18 Aug 2015 20:29:42 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-polar-conic-sections",
    "example": true
  },
  {
    "hash": "rnyjcjpouf",
    "parent_hash": "ogvj2tzgjj",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/rnyjcjpouf.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/rnyjcjpouf",
    "title": "Parametric: Introduction",
    "access": "all",
    "created": "Tue, 18 Aug 2015 20:30:31 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parametric-introduction",
    "example": true
  },
  {
    "hash": "eg5he4xpg9",
    "parent_hash": "pwjl3pe4da",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/eg5he4xpg9.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/eg5he4xpg9",
    "title": "Parametric: Cycloid",
    "access": "link",
    "created": "Tue, 18 Aug 2015 20:30:46 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-parametric-cycloid",
    "example": true
  },
  {
    "hash": "nyterjs0uf",
    "parent_hash": "nqxx2mhknn",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/nyterjs0uf.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/nyterjs0uf",
    "title": "Transformations: Translating a Function",
    "access": "link",
    "created": "Fri, 29 Sep 2017 00:47:36 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-translating-a-function",
    "example": true
  },
  {
    "hash": "vdkjrpznnu",
    "parent_hash": "doxva7ciht",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/vdkjrpznnu.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/vdkjrpznnu",
    "title": "Transformations: Scaling a Function",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:23:20 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-scaling-a-function",
    "example": true
  },
  {
    "hash": "fcjhdt1xdw",
    "parent_hash": "tif5liedlj",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/fcjhdt1xdw.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/fcjhdt1xdw",
    "title": "Transformations: Inverse of a Function",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:23:36 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-transformations-inverse-of-a-function",
    "example": true
  },
  {
    "hash": "jwquvmikhr",
    "parent_hash": "2l0r87hkmq",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/jwquvmikhr.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/jwquvmikhr",
    "title": "Statistics: Linear Regression",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:24:01 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-stats-linear-regression",
    "example": true
  },
  {
    "hash": "qrdbrcfnsl",
    "parent_hash": "paknt6oneh",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/qrdbrcfnsl.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/qrdbrcfnsl",
    "title": "Statistics: Anscombe's Quartet",
    "access": "link",
    "created": "Mon, 13 Jul 2020 20:40:16 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-stats-anscombes-quartet",
    "example": true
  },
  {
    "hash": "sanlujpfmc",
    "parent_hash": "tyszvsmelo",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/sanlujpfmc.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/sanlujpfmc",
    "title": "Statistics: 4th Order Polynomial",
    "access": "all",
    "created": "Tue, 18 Aug 2015 21:25:02 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-stats-fourth-order-polynomial",
    "example": true
  },
  {
    "hash": "iwfjdrhdyr",
    "parent_hash": "4n11jtzki0",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/iwfjdrhdyr.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/iwfjdrhdyr",
    "title": "Lists: Family of sin Curves",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:25:30 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lists-family-of-sin-curves",
    "example": true
  },
  {
    "hash": "ib4qkln029",
    "parent_hash": "1flkupc1yt",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/ib4qkln029.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/ib4qkln029",
    "title": "Lists: Curve Stitching",
    "access": "link",
    "created": "Thu, 05 May 2016 06:33:59 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lists-curve-stitching",
    "example": true
  },
  {
    "hash": "zdv2kras4n",
    "parent_hash": "fqhp5hq3ka",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/zdv2kras4n.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/zdv2kras4n",
    "title": "Lists: Plotting a List of Points",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:01 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-lists-plotting-a-list-of-points",
    "example": true
  },
  {
    "hash": "qtzamwcdrk",
    "parent_hash": "aqgbwm3qfd",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/qtzamwcdrk.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/qtzamwcdrk",
    "title": "Calculus: Derivatives",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:17 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-derivatives",
    "example": true
  },
  {
    "hash": "mekfho0w38",
    "parent_hash": "irip8pnpdf",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/mekfho0w38.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/mekfho0w38",
    "title": "Calculus: Secant Line",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:32 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-secant-line",
    "example": true
  },
  {
    "hash": "fs3lx8gptb",
    "parent_hash": "dlzhsldcgo",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/fs3lx8gptb.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/fs3lx8gptb",
    "title": "Calculus: Tangent Line",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:27:46 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-tangent-line",
    "example": true
  },
  {
    "hash": "noanuckuli",
    "parent_hash": "gkjridbqfj",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/noanuckuli.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/noanuckuli",
    "title": "Calculus: Taylor Expansion of sin(x)",
    "access": "link",
    "created": "Tue, 18 Aug 2015 21:28:02 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x",
    "example": true
  },
  {
    "hash": "qigfpckugc",
    "parent_hash": null,
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/qigfpckugc.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/qigfpckugc",
    "title": "Calculus: Integrals",
    "access": "link",
    "created": "Tue, 19 Apr 2016 14:03:33 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-integrals",
    "example": true
  },
  {
    "hash": "u2qz73ufju",
    "parent_hash": "o3pwn3vkgh",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/u2qz73ufju.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/u2qz73ufju",
    "title": "Calculus: Integral with adjustable bounds",
    "access": "link",
    "created": "Tue, 19 Apr 2016 14:12:40 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds",
    "example": true
  },
  {
    "hash": "gaa5aqyb5s",
    "parent_hash": null,
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/gaa5aqyb5s.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/gaa5aqyb5s",
    "title": "Calculus: Fundamental Theorem of Calculus",
    "access": "link",
    "created": "Tue, 19 Apr 2016 14:15:45 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus",
    "example": true
  },
  {
    "hash": "8hxtdephtf",
    "parent_hash": "xova2bfhj5",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/8hxtdephtf.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/8hxtdephtf",
    "title": "hungry pac-man",
    "access": "link",
    "created": "Mon, 20 Apr 2015 14:47:01 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-pac-man",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "qbaliml2om",
    "parent_hash": "8mmk4hrmqg",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/qbaliml2om.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/qbaliml2om",
    "title": "PRIDE flag",
    "access": "link",
    "created": "Wed, 02 Jun 2021 01:46:57 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "ieellz6qbr",
    "parent_hash": "velayq9vsr",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/ieellz6qbr.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/ieellz6qbr",
    "title": "PRIDE flag",
    "access": "link",
    "created": "Wed, 02 Jun 2021 01:51:23 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-pride-flag",
    "example": true,
    "easterEgg": "pride"
  },
  {
    "hash": "dhzndt8brx",
    "parent_hash": "brei8peg52",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/dhzndt8brx.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/dhzndt8brx",
    "title": "3D World",
    "access": "link",
    "created": "Fri, 03 Jun 2016 01:50:06 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-3d-world",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "zzhx3zzlns",
    "parent_hash": "ccmfndxptv",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/zzhx3zzlns.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/zzhx3zzlns",
    "title": "Checkerboard Inversion",
    "access": "link",
    "created": "Thu, 02 Jun 2016 22:06:08 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-checkerboard-inversion",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "c1u72uowae",
    "parent_hash": null,
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/c1u72uowae.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/c1u72uowae",
    "title": "desmos graph of awesomeness",
    "access": "link",
    "created": "Sun, 18 Aug 2013 06:25:20 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-regular-sine-wave",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "2mwse3jtff",
    "parent_hash": "msmdonti4c",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/2mwse3jtff.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/2mwse3jtff",
    "title": "Fastest path to point",
    "access": "link",
    "created": "Thu, 02 Jun 2016 22:02:44 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-fastest-path-to-a-point",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "8ytrg3nyln",
    "parent_hash": "d7qrsg2hxg",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/8ytrg3nyln.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/8ytrg3nyln",
    "title": "Fireworks!",
    "access": "link",
    "created": "Fri, 03 Jun 2016 01:50:52 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-fireworks",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "9ed6k6wexp",
    "parent_hash": "9ed6k6wexp",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/9qixqdozzh.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/9ed6k6wexp",
    "title": "Sierpinski Valentine",
    "access": "link",
    "created": "Sat, 14 Feb 2015 18:42:18 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-fractal-valentine",
    "example": true,
    "easterEgg": "betchacant"
  },
  {
    "hash": "am6ab20tmw",
    "parent_hash": "hvycjwscfq",
    "thumbUrl": "https://saved-work.desmos.com/calc_thumbs/production/am6ab20tmw.png",
    "stateUrl": "https://saved-work.desmos.com/calc-states/production/am6ab20tmw",
    "title": "Outstretched Arm",
    "access": "link",
    "created": "Fri, 03 Jun 2016 01:45:50 GMT",
    "i18nKey": "graphing-calculator-label-example-graph-outstretched-arm",
    "example": true,
    "easterEgg": "betchacant"
  }
]
`;ct();uu();var Wo={},hl=Gs();if(typeof Desmos!="undefined"&&Desmos.config)for(qC in Desmos.config)Desmos.config.hasOwnProperty(qC)&&(hl[qC]=Desmos.config[qC]);var qC,yc=function(r){return hl.hasOwnProperty(r)},ii=function(r){Wo[r]=yc(r)},xn=function(r){Wo[r]=!yc("no"+r)};ii("testing");ii("maintenance");ii("disableScrollFix");ii("nativeOnscreenKeypad");ii("hidden");ii("disableMouseInteractions");ii("advancedStyling");ii("outofdom");ii("beta3d");hl.lang&&(Wo.language=hl.lang);hl.fontSize&&(Wo.fontSize=hl.fontSize);hl.backgroundColor&&(Wo.backgroundColor="#"+hl.backgroundColor);hl.textColor&&(Wo.textColor="#"+hl.textColor);Wo.no_navigation_warning=yc("noconcat")||yc("testing");Wo.previewMessage="You're previewing some new accessibility features.";Wo.previewFeedbackUrl="mailto:feedback@desmos.com";var V4=location&&location.hostname==="preview.desmos.com";Wo.previewMode=yc("previewMode")||V4;ii("lockViewport");ii("authorFeatures");ii("degreeMode");ii("clearIntoDegreeMode");ii("plaidMode");ii("editOnWeb");ii("crossOriginSaveTest");ii("showResetButtonOnGraphpaper");ii("transparentBackground");ii("forceLogModeRegressions");xn("links");xn("trace");xn("zoomFit");ii("expressionsCollapsed");ii("invertedColors");ii("projectorMode");xn("images");xn("folders");xn("settingsMenu");xn("expressionsTopbar");xn("zoomButtons");xn("keypad");xn("graphpaper");xn("expressions");xn("branding");xn("pointsOfInterest");xn("plotSingleVariableImplicitEquations");xn("plotImplicits");xn("plotInequalities");xn("notes");xn("sliders");ii("pauseWhenOffscreen");ii("worksheetSVG");xn("brailleControls");ii("audioTraceKeypad");xn("audio");ii("sciKeypad");ii("4fnKeypad");ii("ans");yc("braille")&&(Wo.braille=!0);xn("qwertyKeyboard");ii("restrictedFunctions");ii("forceEnableGeometryFunctions");xn("functionDefinition");ii("singleExpression");ii("restrictedEditing");ii("replaceCommaWith10Exp");ii("replaceRoundWithReciprocal");yc("typingAsteriskWritesTimesSymbol")&&(Wo.typingAsteriskWritesTimesSymbol=!0);xn("substitutions");xn("logScales");xn("labels");xn("distributions");Wo["4fnKeypad"]?ii("decimalToFraction"):xn("decimalToFraction");ii("3d");yc("exponentButtonForSquareRoot")?Wo.additionalFunctions=["exponent"]:hl.additionalFunctions&&typeof hl.additionalFunctions=="string"&&(Wo.additionalFunctions=hl.additionalFunctions.split(","));yc("actions")?Wo.actions=!0:yc("noactions")?Wo.actions=!1:yc("clickableObjects")&&(Wo.actions=!0);function Ai(r){return Wo[r]}function zC(){return __dcg_shared_module_exports__['j'](Wo)}function $C(r){var e=[];for(let i of r)if(!(!i||typeof i!="string")){var t=i.split("-")[0];e.push(i),e.push(t);for(let n in ml){let o=ml[n];n.split("-")[0]===t&&o.useAsRoot&&e.push(n)}}return e}function PP(){let r={},e=Object.keys(ml);for(let t in e){let i=e[t];r[i]={code:i,display_name:ml[i].displayName}}return r}var ml={en:{displayName:"English (US)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},es:{displayName:"Espa\xF1ol (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugu\xEAs (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Portugu\xEAs (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal\xE0",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Fran\xE7ais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!1},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"\xCDslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"\u010Ce\u0161tina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ti\u1EBFng Vi\u1EC7t",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"T\xFCrk\xE7e",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"\u7B80\u4F53\u4E2D\u6587",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"\u7E41\u9AD4\u4E2D\u6587",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"\uD55C\uAD6D\uC5B4",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"\u65E5\u672C\u8A9E",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};var _P=`account-shell-button-cancel = Cancel
account-shell-button-clear = Clear
account-shell-button-confirm-delete =
    { $count ->
        [one] Yes, delete graph
       *[other] Yes, delete graphs
    }
account-shell-button-contact-us = Contact Us
account-shell-button-delete = Delete
account-shell-button-download-braille = Download Braille Equations
account-shell-button-download-png = Download PNG
account-shell-button-download-svg = Download SVG
account-shell-button-duplicate = Duplicate
account-shell-button-embed = Embed
account-shell-button-export-image = Export Image
account-shell-button-hide-browser-warning = Hide this warning.
account-shell-button-line-medium = Medium
account-shell-button-line-thick = Thick
account-shell-button-line-thin = Thin
account-shell-button-log-in = Log In
account-shell-button-mygraphs-attempt-recovery = Attempt recovery.
account-shell-button-mygraphs-cancel = Cancel
account-shell-button-mygraphs-close-graph-list = Close Graph List
account-shell-button-mygraphs-close-graph-preview = Close Graph Preview
account-shell-button-mygraphs-delete-graph = Delete Graph
account-shell-button-mygraphs-delete-title = Delete { $graphTitle }
account-shell-button-mygraphs-offline-try-again = offline. click to try again.
account-shell-button-mygraphs-save = Save
account-shell-button-mygraphs-try-again = Try again
account-shell-button-open-construction = Open Construction
account-shell-button-open-graph = Open Graph
account-shell-button-print = Print
account-shell-button-rename = Rename
account-shell-button-retry-now = Retry now
account-shell-button-save = Save
account-shell-button-sign-up = Sign Up
account-shell-button-submit = Submit
account-shell-button-submit-graph = Submit This Graph
account-shell-button-svg-options = SVG Options
account-shell-button-update-graph = Update your submission
account-shell-error-deletion-error = There was an error. Try again later?
account-shell-error-graph-too-large = This graph is too large to save. The maximum allowable size is 5 MB.
account-shell-error-logging-out = Error logging out.
account-shell-error-mygraphs-check-connection = Check your internet connection?
account-shell-error-mygraphs-error-deleting = Error deleting.
account-shell-error-mygraphs-error-loading = Error loading graph
account-shell-error-save-art-contest = Error saving. Please try again later.
account-shell-error-sharing-link = Sorry, there was an error generating a link to your graph. Check your internet connection.
account-shell-error-something-went-wrong = Something went wrong, please report this to desmos.com support. (Error { $error_num })
account-shell-error-submitting = Error submitting. Please try again later.
account-shell-error-unexpected-error = Unexpected error.
account-shell-error-unknown = Sorry! Something went wrong. Please try again later.
account-shell-heading-3dcalc-page-title = Desmos | 3D Graphing Calculator
account-shell-heading-artist-statement = Your Artist Statement
account-shell-heading-birth-year = Your Birth Year
account-shell-heading-contact-us = Contact Us
account-shell-heading-country = Your Country
account-shell-heading-download-instructions = Download Instructions
account-shell-heading-duplicate-construction = Duplicate This Construction
account-shell-heading-duplicate-graph = Duplicate This Graph
account-shell-heading-email = Your Email
account-shell-heading-email-details = This will never be shared, but please provide an email where we can reach you!
account-shell-heading-embossers = Tactile Graphics Embossers
account-shell-heading-embossing-instructions = Embossing Instructions
account-shell-heading-export-graph = Export Your Graph
account-shell-heading-export-size = Size
account-shell-heading-geometry-beta-page-title = Desmos | Geometry (Beta)
account-shell-heading-geometry-page-title = Desmos | Geometry
account-shell-heading-graphingcalc-page-title = Desmos | Graphing Calculator
account-shell-heading-line-thickness = Line Thickness
account-shell-heading-math-art-contest = Global Math Art Contest
account-shell-heading-mygraphs-examples = Examples
account-shell-heading-mygraphs-recovered-work = Recovered Work
account-shell-heading-mygraphs-saved-constructions = Saved Constructions
account-shell-heading-mygraphs-saved-graphs = Saved Graphs
account-shell-heading-name = Your Name
account-shell-heading-name-details = This will be public
account-shell-heading-rename-graph = Rename This Graph
account-shell-heading-resources = Resources
account-shell-heading-save-construction = Save This Construction
account-shell-heading-save-graph = Save This Graph
account-shell-heading-share-graph = Share Your Graph
account-shell-heading-submit-graph = Submit This Graph
account-shell-heading-title-mygraphs-search = Search
account-shell-heading-tours = Tours
account-shell-heading-unsupported-browser = Unsupported Browser
account-shell-label-account-information = Account Information
account-shell-label-advanced-preferences = Advanced
account-shell-label-artiist-statement-description = In 2-3 sentences, describe the inspiration behind your graph.
account-shell-label-artist-statement-placeholder = Tell us about your graph...
account-shell-label-beta = Beta
account-shell-label-betchacant-loading = Challenge accepted...
account-shell-label-birth-year-placeholder = Birth Year
account-shell-label-country-placeholder = Your Country
account-shell-label-created-days-ago = { $number } days ago
account-shell-label-created-hours-ago = { $number } hours ago
account-shell-label-created-last-week = last week
account-shell-label-created-minutes-ago = { $number } minutes ago
account-shell-label-created-on-date = { $month } { $day }, { $year }
account-shell-label-created-one-hour-ago = one hour ago
account-shell-label-created-one-minute-ago = one minute ago
account-shell-label-created-seconds-ago = less than a minute ago
account-shell-label-created-weeks-ago = { $number } weeks ago
account-shell-label-created-yesterday = yesterday
account-shell-label-delete-graph-modal-title = Delete Graph
account-shell-label-email-address = Email Address
account-shell-label-email-placeholder = email@example.com
account-shell-label-export-size-large-rectangle = Large Rectangle
account-shell-label-export-size-large-square = Large Square
account-shell-label-export-size-medium-rectangle = Medium Rectangle
account-shell-label-export-size-medium-square = Medium Square
account-shell-label-export-size-small-square = Small Square
account-shell-label-feature-flag-actions = Actions
account-shell-label-feedback = Feedback
account-shell-label-feedback-email = Email address so we can respond! (optional)
account-shell-label-feedback-message = Questions? Feedback?
account-shell-label-feedback-placeholder = Write to us!
account-shell-label-feedback-sending = Sending...
account-shell-label-full-name = Full Name
account-shell-label-graph-actions = Graph actions
account-shell-label-graph-title = Title
account-shell-label-help = Help
account-shell-label-help-menu = Help Menu
account-shell-label-language = Language
account-shell-label-loading = Loading...
account-shell-label-math-art-contest = Global Math Art Contest
account-shell-label-month-apr = Apr
account-shell-label-month-aug = Aug
account-shell-label-month-dec = Dec
account-shell-label-month-feb = Feb
account-shell-label-month-jan = Jan
account-shell-label-month-jul = Jul
account-shell-label-month-jun = Jun
account-shell-label-month-mar = Mar
account-shell-label-month-may = May
account-shell-label-month-nov = Nov
account-shell-label-month-oct = Oct
account-shell-label-month-sep = Sep
account-shell-label-mygraphs-example = example
account-shell-label-mygraphs-last-saved = last saved: { $date }
account-shell-label-mygraphs-no-unsaved-changes = no unsaved changes
account-shell-label-mygraphs-unsaved-graph = unsaved graph
account-shell-label-no-unsaved-changes = No Unsaved Changes
account-shell-label-open-graph-mac = { $open_graph } (cmd+o)
account-shell-label-open-graph-pc = { $open_graph } (ctrl+o)
account-shell-label-save-changes-mac = Save Changes (cmd+s)
account-shell-label-save-changes-pc = Save Changes (ctrl+s)
account-shell-label-saving-graph = Saving graph...
account-shell-label-share = share
account-shell-label-share-graph = Share Graph
account-shell-label-share-link = Share this link:
account-shell-label-submission-already-received = Your Art Contest Submission
account-shell-label-submission-received = Submission Received!
account-shell-label-submitting = Submitting...
account-shell-label-success = Success!
account-shell-label-you-are-eligible = You're eligible to participate in the 2022 Global Math Art Contest!
account-shell-label-zoom = Zoom: { $value }%
account-shell-link-account-settings = Account Settings
account-shell-link-download-chrome = Click here to download Google Chrome.
account-shell-link-email-support = Email Our Support Team
account-shell-link-geometry-user-guide = Geometry User Guide
account-shell-link-getting-started = Getting Started
account-shell-link-help = Help
account-shell-link-help-center = Help Center
account-shell-link-keyboard-shortcuts = Keyboard Shortcuts
account-shell-link-learn-more = Learn More
account-shell-link-privacy = Privacy Policy
account-shell-link-share-thoughts = Share your thoughts!
account-shell-link-sign-out = Sign Out
account-shell-link-terms = Terms of Service
account-shell-link-user-guide = Desmos User Guide
account-shell-link-video-tutorials = Video Tutorials
account-shell-narration-clear-selected-country = Clear Selected Country
account-shell-narration-graph-preview = Graph Preview
account-shell-narration-image-download = Image Download
account-shell-narration-language-menu = Language Options Menu
account-shell-narration-mygraphs-open-graph = Open graph
account-shell-narration-share-options = Share Options
account-shell-narration-size-options = Size Options
account-shell-text-advanced-preferences-instructions = Try these advanced features. Feel free to send any questions or feedback to support@desmos.com.
account-shell-text-alt-text-art-contest = Earth with students from different countries and a red ribbon around it. Illustration.
account-shell-text-alt-text-success = Five people standing around and talking about an exciting piece of art in a museum. Illustration.
account-shell-text-art-contest-about-paragraph = Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before<1> January 15th </1>for a chance to be featured on our website and win other prizes! <2>Learn more</2>
account-shell-text-art-contest-congratulations = Congratulations, and keep graphing!
account-shell-text-art-contest-copyright-agreement = I pledge that (a) this is my original work and (b) this isn't based on copyrighted material.
account-shell-text-art-contest-legal-disclaimer = By submitting this graph, you acknowledge that Desmos Studio, PBC may, at its discretion, post it publicly at the contest website and/or on social media channels.
account-shell-text-art-contest-notice-default = Once you've created a graph, you can submit it here to participate in the Global Math Art Contest!
account-shell-text-art-contest-notice-login = Please create an account or sign in to participate in the Global Math Art Contest!
account-shell-text-art-contest-submission-already-received = <1>Your previous submission to the Global Math Art Contest was successfully received! You can click the link below to update your submission, any time before January 15th.</1>
account-shell-text-art-contest-success-paragraph = If you'd like to revise your submission, feel free to resubmit anytime before<1> January 15th</1>. We'll only look at the most recent submission.
account-shell-text-artcontest-ineligible = <1><2>Based on your age and location, we aren\u2019t able to accept a graph submission from you this year.</2><3>Keep up the awesome graphing! There will be new contests every year.</3></1>
account-shell-text-confirm-leave = Are you sure you want to leave this graph? Your unsaved work will be lost.
account-shell-text-construction-cleared = Construction Cleared.
account-shell-text-contest-under-16 = Under 16?
account-shell-text-contest-verify-eligibility = Verify your eligibility
account-shell-text-copy-of-title = [Copy of] { $originalTitle }
account-shell-text-delete-graphs-confirmation =
    Are you sure you want to delete { $count ->
        [one] "{ $title }"
       *[other] the { $count } selected graphs
    }?
account-shell-text-download-instructions = To download, right click on the image of the graph select "Save As." You might also be able to click and drag the image onto your desktop.
account-shell-text-embossing-etc-print = Set paper size to { $size }. Then click "Edit" and select File > Emboss.
account-shell-text-embossing-etc-save = Save this image. Open Firebird, select File > Open > Image File, and open the image.
account-shell-text-embossing-vpmax-print = Right click image and select "print". Set paper size to { $size }.
account-shell-text-embossing-vpmax-save = Right click graph image and save to desktop.
account-shell-text-error = error
account-shell-text-feature-flag-actions-description = Make graphs interactive by defining rules for responding to clicks or to the passage of time.
account-shell-text-feedback-sent = Thanks! We'll be in touch.
account-shell-text-geometry-beta-notice = Thank you for visiting our Beta Geometry Tool! Please share any bugs, questions, or suggestions with us at <1>feedback@desmos.com</1>. You can also use the form below:
account-shell-text-geometry-expression-list-notice = Please share any bugs, questions, or suggestions with us! <1>feedback@desmos.com</1>
account-shell-text-graph-cleared = Graph cleared.
account-shell-text-graph-uses-advanced-features = This graph uses advanced features.
account-shell-text-logged-in = Logged in successfully!
account-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple
account-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.
account-shell-text-maintenance-mode = Desmos is in Maintenance Mode.
account-shell-text-mygraphs-attempting-recovery = Attempting recovery...
account-shell-text-mygraphs-count-more = { $count } more...
account-shell-text-mygraphs-current-construction = Current Construction
account-shell-text-mygraphs-current-graph = Current Graph
account-shell-text-mygraphs-deleting = Deleting...
account-shell-text-mygraphs-loading = Loading...
account-shell-text-mygraphs-lost-work = Lost work?
account-shell-text-mygraphs-maintenance-mode = Desmos is temporarily in maintenance mode. You can open example graphs, but won't be able to sign in, open your graphs, or save any changes. We're so sorry for the inconvenience.
account-shell-text-mygraphs-new-blank-graph = New Blank Graph
account-shell-text-mygraphs-new-construction = New Construction
account-shell-text-mygraphs-no-examples-match-search = No examples match your search.
account-shell-text-mygraphs-no-saved-graphs = No saved graphs yet.
account-shell-text-mygraphs-no-search-results = No saved graphs match your search.
account-shell-text-mygraphs-no-unsaved-graphs = Couldn't find any unsaved graphs.
account-shell-text-mygraphs-opened-graph = Opened '{ $graphTitle }'
account-shell-text-mygraphs-opening = Opening...
account-shell-text-mygraphs-or = or
account-shell-text-mygraphs-search-by-title = search by title
account-shell-text-mygraphs-share-thoughts = Share your thoughts!
account-shell-text-mygraphs-slow-big-constructions = This can take a little while for big constructions...
account-shell-text-mygraphs-slow-big-graphs = This can take a little while for big graphs...
account-shell-text-mygraphs-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-mygraphs-synced = synced!
account-shell-text-mygraphs-to-save-constructions = to save your constructions!
account-shell-text-mygraphs-to-save-graphs = to save your graphs!
account-shell-text-mygraphs-updating-graphs = updating graphs...
account-shell-text-mygraphs-version = Version
account-shell-text-new-construction-created = New construction created.
account-shell-text-new-graph-created = New graph created.
account-shell-text-or = or
account-shell-text-saved = saved
account-shell-text-share-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-unsupported-browser-android = Desmos works best on your version of Android if you use the Chrome Browser.
account-shell-text-untitled = Untitled
account-shell-text-untitled-graph = Untitled Graph
account-shell-text-welcome-to-geometry = Welcome to Geometry (Beta)
shared-button-accept = Accept
shared-button-cancel = Cancel
shared-button-change-email-address = Change email address
shared-button-change-email-and-password = Change email and password
shared-button-close-dialog = Close Dialog
shared-button-close-message = Close Message
shared-button-confirm-name = Confirm Name
shared-button-continue-to-desmos = Continue to Desmos
shared-button-create-account = Create Account
shared-button-delete-account-question = Delete your Desmos account?
shared-button-email-address-narrow = Email
shared-button-email-address-wide = Email Address
shared-button-external-account-narrow = External
shared-button-external-account-wide = External Account
shared-button-go-to-account-settings = Go to Account Settings
shared-button-google-account-narrow = Google
shared-button-google-account-wide = Google Account
shared-button-learn-more-capitalized = Learn More
shared-button-login = Log in
shared-button-login-capitalized = Log In
shared-button-recover-password = Recover Password
shared-button-save = Save
shared-button-send-delete-account-email = Send Delete Account Email
shared-button-send-email = Send Email
shared-button-sign-in-with-apple = Sign in with Apple
shared-button-sign-in-with-google = Sign in with Google
shared-button-try-again = Didn't work? Try again!
shared-calculator-button-braille-mode-nemeth = Nemeth
shared-calculator-button-braille-mode-ueb = UEB
shared-calculator-button-clear = clear
shared-calculator-button-controlbar-functions = functions
shared-calculator-button-go = Go
shared-calculator-button-mac = Mac Shortcuts
shared-calculator-button-windows-chrome = Windows / ChromeOS Shortcuts
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-mixed-number = Sorry, I don't know what to do with mixed number '{ $mixedNumber }'. Try using a '*' symbol around it.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-and-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-list-comprehension-input-dependency = List comprehension input list can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-restrict = Cannot create a restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-custom-toolbar-not-condition = Please write a valid condition and make sure every referenced variable is defined.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-depends-on-deleted-geo-object = This depends on a geometric object that's no longer defined.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-type-error = Cannot call '.{ $symbol }' on { $type }.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-function-unsupported = Color functions do not support the '{ $symbol }' function.
shared-calculator-error-gpu-integral-unsupported = Color functions do not support integrals.
shared-calculator-error-gpu-long-product = Color functions do not support products of more than { $maxTermCount } terms.
shared-calculator-error-gpu-long-sum = Color functions do not support sums of more than { $maxTermCount } terms.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements in a color function.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' in a color function.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' in a color function.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' in a color function.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Inputs to a list comprehension must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-inequality-chain-too-long = Cannot chain more than 2 inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and \u03B8.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a list.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = An input to a list comprehension must be a list, but { $identifier } is { $actual }. Try { $identifier }=[1...10].
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-ordered-pair-access-type-error = Cannot access a coordinate of { $symbol }.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-self-referential-function = The definition of function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't use '{ $symbol }' as a list comprehension input because it's already defined.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and 'with'. Add parentheses around the 'with' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-local-variable-dependency = The left hand side of a 'with' substitution cannot depend on '{ $symbol }' because '{ $symbol }' is locally defined.
shared-calculator-error-substitution-body-regression-parameter-dependency = The left hand side of a 'with' substitution cannot depend on '{ $symbol }' because '{ $symbol }' is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable assignments.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-undefined-rhs = An expression that depends on the free variable '{ $symbol }' cannot be used on the right hand side of 'with'.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-1 = Try using just { $arg }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-2 = Try using just { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-definition-type-error-use-more-1 = A { $fn } cannot be defined using just { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-use-more-2 = A { $fn } cannot be defined using just { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-for-keyword = 'for' can only be used inside a list. Try [i for i=[1...10]].
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unplottable-polar-function = We can't plot \u03B8 as a function of r. Try plotting r(\u03B8) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-function-free-variable = Function '{ $functionSymbol }' cannot depend on free variable '{ $variableSymbol }'.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-heading-function-table-column-header = Function
shared-calculator-heading-keyboard-shortcuts = Keyboard Shortcuts
shared-calculator-heading-keyboard-shortcuts-audio-tracing = Audio Tracing
shared-calculator-heading-keyboard-shortcuts-braille = Braille
shared-calculator-heading-keyboard-shortcuts-common-actions = Common Actions
shared-calculator-heading-keyboard-shortcuts-common-symbols = Common Symbols
shared-calculator-heading-keyboard-shortcuts-desmos-com-only = Desmos.com Only
shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation = Expression Entry and Navigation
shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction = Graph Navigation During Construction
shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator = Token Navigator
shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection = Tool Selection
shared-calculator-heading-keyboard-shortcuts-interactive-points = Interactive Points
shared-calculator-heading-keyboard-shortcuts-slider-trace = Slider Trace
shared-calculator-heading-keyboard-shortcuts-sliders = Sliders
shared-calculator-heading-keyboard-shortcuts-symbols = Symbols
shared-calculator-heading-keyboard-shortcuts-tables = Tables
shared-calculator-heading-mac-table-column-header = Mac Shortcut
shared-calculator-heading-windows-chrome-table-column-header = Windows / ChromeOS Shortcut
shared-calculator-label-os = Operating System
shared-calculator-label-saved = Saved!
shared-calculator-label-saving = Saving...
shared-calculator-label-search-results = Search Results
shared-calculator-label-toast-learn-more = Learn more
shared-calculator-label-toast-undo = Undo
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-3d-points = a list of 3D points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-list-of-vectors = a list of vectors
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-label-value-type-vector = a vector
shared-calculator-narration-author-mode = Author Mode
shared-calculator-narration-braille-mode = Braille Mode
shared-calculator-narration-control-toggle-switch-to-default = { $toggled } selected. Press Enter to switch to { $default }.
shared-calculator-narration-control-toggle-switch-to-toggled = { $default } selected. Press Enter to switch to { $toggled }.
shared-calculator-narration-disable-tool = Disable { $tool } when this condition is true
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-expression-index = Expression { $index }
shared-calculator-narration-expression-list = Expression List
shared-calculator-narration-hotkey-braille-mode-nemeth = Braille mode Nemeth
shared-calculator-narration-hotkey-braille-mode-off = Braille mode off
shared-calculator-narration-hotkey-braille-mode-ueb = Braille mode UEB
shared-calculator-narration-input-error = input has an error
shared-calculator-narration-item-clickable = { $item } clickable
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unknown = Unknown
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilate = Dilate
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflect = Reflect
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotate = Rotate
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-translate = Translate
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-math-input-error-message = expression has error
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-show-as-decimal = Show as Decimal
shared-calculator-narration-show-as-fraction = Show as Fraction
shared-calculator-narration-six-key-mode-off = Six Key Braille Input off
shared-calculator-narration-six-key-mode-on = Six Key Braille Input on
shared-calculator-text-customize-toolbar = Customize the Toolbar
shared-calculator-text-keyboard-shortcut-add-expression = Add an Expression
shared-calculator-text-keyboard-shortcut-add-folder = Add a Folder
shared-calculator-text-keyboard-shortcut-add-image = Add an Image
shared-calculator-text-keyboard-shortcut-add-note = Add a Note
shared-calculator-text-keyboard-shortcut-add-table = Add a Table
shared-calculator-text-keyboard-shortcut-adjust-playback-speed = Adjust Playback Speed (1 = slowest, 5 = fastest)
shared-calculator-text-keyboard-shortcut-announce-slider-animations = Announce Active Slider Animations
shared-calculator-text-keyboard-shortcut-beginning-of-block = Beginning of Current Block
shared-calculator-text-keyboard-shortcut-beginning-of-expression = Beginning of Current Expression
shared-calculator-text-keyboard-shortcut-close-a-dialog = Close a Dialog
shared-calculator-text-keyboard-shortcut-collapse-all-folders = Collapse All Folders
shared-calculator-text-keyboard-shortcut-collapse-folder = Collapse Selected Folder
shared-calculator-text-keyboard-shortcut-decrease-volume = Decrease Volume
shared-calculator-text-keyboard-shortcut-decrease-x = Decrease X
shared-calculator-text-keyboard-shortcut-decrease-x-larger = Decrease X by Larger Amount
shared-calculator-text-keyboard-shortcut-decrease-y = Decrease Y
shared-calculator-text-keyboard-shortcut-decrease-y-larger = Decrease Y by Larger Amount
shared-calculator-text-keyboard-shortcut-degrees-toggle = Toggle Between Degrees and Radians
shared-calculator-text-keyboard-shortcut-delete-expression = Delete the Focused Expression
shared-calculator-text-keyboard-shortcut-delete-selection = Delete Selection
shared-calculator-text-keyboard-shortcut-describe-axes = Describe the graph axes
shared-calculator-text-keyboard-shortcut-end-of-block = End of Current Block
shared-calculator-text-keyboard-shortcut-end-of-expression = End of Current Expression
shared-calculator-text-keyboard-shortcut-exit-block = Exit Current Block
shared-calculator-text-keyboard-shortcut-expand-all-folders = Expand All Folders
shared-calculator-text-keyboard-shortcut-expand-folder = Expand Selected Folder
shared-calculator-text-keyboard-shortcut-first-point = First Point
shared-calculator-text-keyboard-shortcut-focus-expression-list = Focus the Expression List
shared-calculator-text-keyboard-shortcut-focus-first-interactive-point = Focus First Interactive Point On Screen
shared-calculator-text-keyboard-shortcut-focus-graph-paper = Focus the Graph Paper
shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection = Add Object Under Attention to Selection (when box-select is active)
shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection = Add an Object Token to Selection
shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool = Cancel Active Tool
shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph = Select a Tool and Focus the Graph
shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator = Close Token navigator
shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects = Delete Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-describe-object = Describe Object Under Attention
shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects = Deselect All Objects
shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects = Drag All Movable Objects
shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar = Focus the Toolbar for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar = Focus the Geometry Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories = Move Between Categories in the Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items = Move Through Tools in a Dropdown
shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph = Move to Bottom Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph = Move to Left Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph = Move to Right Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph = Move to Top Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator = Move an Object Token Between the Expression List and Navigator
shared-calculator-text-keyboard-shortcut-geometry-navigate-graph = Navigate Constructed Objects
shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels = Navigate Between Object Levels
shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level = Move Between Object Tokens at Current Level
shared-calculator-text-keyboard-shortcut-geometry-next-object = Give Attention to Next Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-open-options = Open Options for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator = Open Token navigator
shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options = Open Transformation Options for Selected Object
shared-calculator-text-keyboard-shortcut-geometry-previous-object = Give Attention to Previous Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt = Repeat Active Tool Prompt
shared-calculator-text-keyboard-shortcut-geometry-select-next-category = Select Next Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category = Select Next Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-category = Select Previous Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category = Select Previous Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token = Select a Single Object Token
shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number = Select the nth Construction Tool Category
shared-calculator-text-keyboard-shortcut-hear-graph = Hear Graph
shared-calculator-text-keyboard-shortcut-hear-specific-branch = Hear Only Branch 1 Through 10
shared-calculator-text-keyboard-shortcut-increase-selection-left = Increase Selection Left
shared-calculator-text-keyboard-shortcut-increase-selection-right = Increase Selection Right
shared-calculator-text-keyboard-shortcut-increase-volume = Increase Volume
shared-calculator-text-keyboard-shortcut-increase-x = Increase X
shared-calculator-text-keyboard-shortcut-increase-x-larger = Increase X by Larger Amount
shared-calculator-text-keyboard-shortcut-increase-y = Increase Y
shared-calculator-text-keyboard-shortcut-increase-y-larger = Increase Y by Larger Amount
shared-calculator-text-keyboard-shortcut-keypad-toggle = Show or Hide the Keypad
shared-calculator-text-keyboard-shortcut-last-point = Last Point
shared-calculator-text-keyboard-shortcut-move-to-denominator = Move to Denominator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-numerator = Move to Numerator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-origin = Move to Origin
shared-calculator-text-keyboard-shortcut-nemeth-mode = Switch to Nemeth
shared-calculator-text-keyboard-shortcut-next-character = Next Character
shared-calculator-text-keyboard-shortcut-next-curve = Move to Next Curve
shared-calculator-text-keyboard-shortcut-next-expression = Move to Next Expression
shared-calculator-text-keyboard-shortcut-next-interactive-point = Go to Next Interactive Point
shared-calculator-text-keyboard-shortcut-next-poi = Next Point of Interest
shared-calculator-text-keyboard-shortcut-next-point = Next Point
shared-calculator-text-keyboard-shortcut-open-a-graph = Open a Graph
shared-calculator-text-keyboard-shortcut-open-expression-options = Open Options for the Focused Expression
shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog = Open Keyboard Shortcuts Dialog
shared-calculator-text-keyboard-shortcut-previous-character = Previous Character
shared-calculator-text-keyboard-shortcut-previous-curve = Move to Previous Curve
shared-calculator-text-keyboard-shortcut-previous-expression = Move to Previous Expression
shared-calculator-text-keyboard-shortcut-previous-interactive-point = Go to Previous Interactive Point
shared-calculator-text-keyboard-shortcut-previous-poi = Previous Point of Interest
shared-calculator-text-keyboard-shortcut-previous-point = Previous Point
shared-calculator-text-keyboard-shortcut-print-a-graph = Print a Graph
shared-calculator-text-keyboard-shortcut-print-mode = Switch to Print
shared-calculator-text-keyboard-shortcut-redo = Redo
shared-calculator-text-keyboard-shortcut-remove-empty-expression = Remove Selected Empty Expression
shared-calculator-text-keyboard-shortcut-save-a-graph = Save a Graph
shared-calculator-text-keyboard-shortcut-select-all = Select All
shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction = Show Answer as Decimal or Fraction
shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list = Show or Hide the Expression List
shared-calculator-text-keyboard-shortcut-slider-decrease = Decrease Value
shared-calculator-text-keyboard-shortcut-slider-decrease-larger = Decrease Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-increase = Increase Value
shared-calculator-text-keyboard-shortcut-slider-increase-larger = Increase Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-maximum = Highest Value
shared-calculator-text-keyboard-shortcut-slider-minimum = Lowest Value
shared-calculator-text-keyboard-shortcut-slider-trace-decrease = Decrease Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger = Decrease Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase = Increase Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger = Increase Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-maximum = Move to Highest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-minimum = Move to Lowest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-next-slider = Select Next Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider = Select Previous Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-speak-answer = Speak Answer
shared-calculator-text-keyboard-shortcut-speak-branch = Speak Branch
shared-calculator-text-keyboard-shortcut-speak-color = Speak Color
shared-calculator-text-keyboard-shortcut-speak-focused-block = Speak Focused Block
shared-calculator-text-keyboard-shortcut-speak-label = Speak Label
shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block = Speak Left-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-parent-block = Speak Parent Block
shared-calculator-text-keyboard-shortcut-speak-poi-count = Speak Point of Interest Count
shared-calculator-text-keyboard-shortcut-speak-point-type = Speak Type of Selected Point
shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block = Speak Right-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-selection = Speak Selection
shared-calculator-text-keyboard-shortcut-speak-x = Speak X Coordinate
shared-calculator-text-keyboard-shortcut-speak-y = Speak Y Coordinate
shared-calculator-text-keyboard-shortcut-summarize-graph = Summarize Selected Curve
shared-calculator-text-keyboard-shortcut-table-first-column = First Column in Row
shared-calculator-text-keyboard-shortcut-table-first-row = First Row in Column
shared-calculator-text-keyboard-shortcut-table-last-column = Last Column in Row
shared-calculator-text-keyboard-shortcut-table-last-row = Last Row in Column
shared-calculator-text-keyboard-shortcut-table-next-cell = Next Cell
shared-calculator-text-keyboard-shortcut-table-next-column = Next Column
shared-calculator-text-keyboard-shortcut-table-next-row = Next Row
shared-calculator-text-keyboard-shortcut-table-previous-cell = Previous Cell
shared-calculator-text-keyboard-shortcut-table-previous-column = Previous Column
shared-calculator-text-keyboard-shortcut-table-previous-row = Previous Row
shared-calculator-text-keyboard-shortcut-table-speak-column-header = Speak Column Header
shared-calculator-text-keyboard-shortcut-toggle-account-menu = Open or Close the Account Menu
shared-calculator-text-keyboard-shortcut-toggle-audio-trace = Enable or Disable Audio Trace Mode
shared-calculator-text-keyboard-shortcut-toggle-braille-typing = Turn Braille Typing On or Off
shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode = Turn Edit List Mode On or Off
shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu = Open or Close the Graph Settings Menu
shared-calculator-text-keyboard-shortcut-toggle-help-menu = Open or Close the Help Menu
shared-calculator-text-keyboard-shortcut-toggle-language-menu = Open or Close the Language Menu
shared-calculator-text-keyboard-shortcut-toggle-share-menu = Open or Close the Share Menu
shared-calculator-text-keyboard-shortcut-toggle-slider-trace = Toggle Slider Trace Mode
shared-calculator-text-keyboard-shortcut-ueb-mode = Switch to UEB
shared-calculator-text-keyboard-shortcut-undo = Undo
shared-calculator-text-keyboard-shortcut-zoom-fit = Zoom to Fit
shared-calculator-text-keyboard-shortcut-zoom-in = Zoom In
shared-calculator-text-keyboard-shortcut-zoom-out = Zoom Out
shared-calculator-text-keyboard-shortcut-zoom-restore-default = Restore Default Viewport
shared-calculator-text-search-results =
    { $count ->
        [0] No results.
        [one] 1 reslt.
       *[other] { $count } results.
    }
shared-label-email = Email
shared-label-family-name = Last Name (optional)
shared-label-given-name-or-nickname = First Name or Nickname
shared-label-name = Name
shared-label-new-email-address = New Email Address
shared-label-password = Password
shared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!
shared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.
shared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.
shared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.
shared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.
shared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.
shared-message-consent-delete-information = If you don't want Desmos to hold onto this information, you may delete your account from the Account Settings menu at any time.
shared-message-consent-information = When you created your Desmos account, you gave us your name, email address, and password (unless you signed in with Google, in which case you gave us access to the name and email address associated with that account). You also gave us access to your saved work. To continue using your Desmos account, please consent below to the collection of this information.
shared-message-consent-text = I agree to let Desmos store and maintain the information I provide (e.g. login credentials, saved work) in order to provide and improve its service. To withdraw consent, you may delete your account at any time.
shared-message-cookie-notice = <1>Note:</1> Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in. <2>Learn More.</2>
shared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please <2>let us know.</2>
shared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.
shared-message-email-sent = Email sent
shared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.
shared-message-google-login-not-available = Google Login is not available on this device.
shared-message-information-saved = Saved!
shared-message-or-login-with-desmos = Or log in with Desmos
shared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.
shared-message-privacy-notice = I have read, understand, and accept the <1>Terms of Service</1> and <2>Privacy Policy</2>.
shared-message-set-new-email-address = Set a new email address and password.
shared-prompt-already-have-account = Already have a Desmos account?
shared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.
shared-prompt-forgot-your-password = Forgot your password?
shared-prompt-new-to-desmos-sign-up-here = New to Desmos? <1>Sign up</1>.
shared-prompt-new-to-desmos-teacher-or-student = New to Desmos? <1>Sign up!</1>
shared-prompt-please-consent-to-sign-up-with-apple = Please consent above to sign up with Apple
shared-prompt-please-consent-to-sign-up-with-google = Please consent above to sign up with Google
shared-prompt-sign-up-with-apple = Sign up with Apple
shared-prompt-sign-up-with-google = Sign up with Google
shared-title-account-reactivated = Your account has been reactivated.
shared-title-account-settings = Account Settings
shared-title-change-email-address = Change your Desmos email address
shared-title-change-password-narrow = Password
shared-title-change-password-wide = Change Password
shared-title-consent = We value your privacy
shared-title-delete-account = Are you sure you want to delete your account?
shared-title-email-settings = Email
shared-title-language-menu = Language
shared-title-login = Log In
shared-title-profile-information-narrow = Profile
shared-title-profile-information-wide = Profile Information
shared-title-recover-password = Recover Password
shared-title-signup = Sign-Up
basic-calculator-button-controlbar-abc = abc
basic-calculator-button-controlbar-clear = clear
basic-calculator-button-controlbar-clear-all = clear all
basic-calculator-button-controlbar-func = func
basic-calculator-button-controlbar-main = main
basic-calculator-button-turn-braille-mode-off = Turn { $mode } off
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-heading-braille-table-type-this = Type this
basic-calculator-heading-braille-table-typeset = Typeset
basic-calculator-label-answer-hint = Your answers show up on this side.
basic-calculator-label-controlbar-deg = deg
basic-calculator-label-controlbar-rad = rad
basic-calculator-label-convert-to-decimal = Convert to decimal.
basic-calculator-label-convert-to-fraction = Convert to fraction.
basic-calculator-label-reverse-contrast = Reverse Contrast
basic-calculator-label-six-key-input = Six Key Braille Input
basic-calculator-link-download-braille-equations = Download Braille Equations
basic-calculator-link-view-braille-examples = View more examples
basic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator
basic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator
basic-calculator-narration-controlbar-abc = A B C
basic-calculator-narration-controlbar-backspace = backspace
basic-calculator-narration-controlbar-clear = clear
basic-calculator-narration-controlbar-clear-all = clear all
basic-calculator-narration-controlbar-degrees = Degrees
basic-calculator-narration-controlbar-functions = Functions
basic-calculator-narration-controlbar-main = main
basic-calculator-narration-controlbar-radians = Radians
basic-calculator-narration-controlbar-redo = Redo
basic-calculator-narration-controlbar-settings = settings
basic-calculator-narration-controlbar-undo = Undo
basic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal
basic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction
basic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off
basic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on
basic-calculator-text-braille-mode-is-on = { $mode } is on!
basic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.
geometry-label-construct-instruction = Click down here to construct
geometry-label-pick-tool-instruction = Pick a tool to get started
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-change-image = Change Image
graphing-calculator-button-clear-graph = Delete All
graphing-calculator-button-done = Done
graphing-calculator-button-draggable = Draggable
graphing-calculator-button-edit-graph-on-desmos-logo = edit graph on
graphing-calculator-button-editable-math = Editable Math
graphing-calculator-button-editable-text = Editable Text
graphing-calculator-button-find-cdf = Find Cumulative Probability (CDF)
graphing-calculator-button-funcs = funcs
graphing-calculator-button-functions = functions
graphing-calculator-button-functions-menu-custom-colors = Custom Colors
graphing-calculator-button-functions-menu-number-theory = Number Theory
graphing-calculator-button-geometry-label-points-checkbox = Label Points
graphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-button-keypad-describe-axes = Describe Axes
graphing-calculator-button-keypad-describe-curve = Describe Curve
graphing-calculator-button-keypad-describe-curve-short = Curve
graphing-calculator-button-keypad-describe-point = Describe Point
graphing-calculator-button-keypad-describe-point-short = Point
graphing-calculator-button-label = Label
graphing-calculator-button-label-editable = Editable
graphing-calculator-button-label-show-on-hover = Show on hover
graphing-calculator-button-label-text-outline = Text outline
graphing-calculator-button-load-image-retry = Retry.
graphing-calculator-button-move-to-folder-action = Move
graphing-calculator-button-place-image-behind-graphs = Place behind graphs
graphing-calculator-button-regression-log-mode = Log Mode
graphing-calculator-button-regression-plot-residuals = plot
graphing-calculator-button-replace = Replace
graphing-calculator-button-reset-graph = Reset
graphing-calculator-button-settings-2d = 2D
graphing-calculator-button-settings-3d = 3D
graphing-calculator-button-settings-degrees = Degrees
graphing-calculator-button-settings-radians = Radians
graphing-calculator-button-settings-zoom-square = Zoom Square
graphing-calculator-button-share-graph-link-copy = Copy
graphing-calculator-button-show-all-table-rows = Show all
graphing-calculator-button-slider-add-all-variables = all
graphing-calculator-button-visual-parameters-binned = Binned
graphing-calculator-button-visual-parameters-center = Center
graphing-calculator-button-visual-parameters-count = Count
graphing-calculator-button-visual-parameters-density = Density
graphing-calculator-button-visual-parameters-exact = Exact
graphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers
graphing-calculator-button-visual-parameters-left = Left
graphing-calculator-button-visual-parameters-relative = Relative
graphing-calculator-error-equation-contains-unresolved-details = This equation contains fine detail that has not been fully resolved.
graphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.
graphing-calculator-error-expression-search = Can only rename a valid function or variable name.
graphing-calculator-error-failed-to-load-image = Failed to load image.
graphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.
graphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).
graphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image
graphing-calculator-error-image-invalid-height = Invalid height. Try using any number.
graphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.
graphing-calculator-error-image-invalid-width = Invalid width. Try using any number.
graphing-calculator-error-log-axes-image = Cannot plot images on a log scale.
graphing-calculator-heading-advanced = Advanced
graphing-calculator-heading-audio-trace-describe = Describe
graphing-calculator-heading-audio-trace-navigation = Navigation
graphing-calculator-heading-audio-trace-screen-reader = Screen Reader
graphing-calculator-heading-calculus = Calculus
graphing-calculator-heading-clickable = Clickable
graphing-calculator-heading-dist-tab-distributions = Distributions
graphing-calculator-heading-dist-tab-visualizations = Visualizations
graphing-calculator-heading-drag = Drag
graphing-calculator-heading-fill = Fill
graphing-calculator-heading-functions-menu-advanced = Advanced
graphing-calculator-heading-geometry = Geometry
graphing-calculator-heading-geometry-measurements = Properties & Measurements
graphing-calculator-heading-geometry-tools = Geometry Tools
graphing-calculator-heading-geometry-transformations = Transformations
graphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions
graphing-calculator-heading-image-opacity = Opacity
graphing-calculator-heading-inverse-trig = Inverse Trig Functions
graphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>
graphing-calculator-heading-label = Label
graphing-calculator-heading-label-orientation = Orientation
graphing-calculator-heading-lines = Lines
graphing-calculator-heading-lists = List Operations
graphing-calculator-heading-points = Points
graphing-calculator-heading-regression-parameters = Parameters
graphing-calculator-heading-regression-residuals = Residuals
graphing-calculator-heading-regression-statistics = Statistics
graphing-calculator-heading-slider-animation-mode = Animation Mode
graphing-calculator-heading-slider-speed = Speed
graphing-calculator-heading-stat-tests = Statistical Tests
graphing-calculator-heading-stats = Statistics
graphing-calculator-heading-style = Style
graphing-calculator-heading-surfaces = Surfaces
graphing-calculator-heading-trig = Trig Functions
graphing-calculator-heading-visual-parameters-bar-heights = Bar Heights
graphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment
graphing-calculator-heading-visual-parameters-display-properties = Display Properties
graphing-calculator-heading-visual-parameters-x-values = X Values
graphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image
graphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image
graphing-calculator-label-add-item-tooltip = Add Item
graphing-calculator-label-add-slider = add slider:
graphing-calculator-label-angle-tooltip = Angle
graphing-calculator-label-animation-properties-tooltip = Animation Properties
graphing-calculator-label-audio-trace-curve = Curve
graphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.
graphing-calculator-label-audio-trace-point = Point
graphing-calculator-label-audio-trace-speed = Speed
graphing-calculator-label-audio-trace-volume = Volume
graphing-calculator-label-axes = Axes
graphing-calculator-label-braille-size-etc11 = ETC Romeo/Juliet (11.5 x 11 in)
graphing-calculator-label-braille-size-etc8 = ETC Romeo/Juliet (8.5 x 11 in)
graphing-calculator-label-braille-size-vpmax11 = VP Max (11.5 x 11 in)
graphing-calculator-label-braille-size-vpmax8 = VP Max (8.5 x 11 in)
graphing-calculator-label-cdf-maximum = Max:
graphing-calculator-label-cdf-minimum = Min:
graphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image
graphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image
graphing-calculator-label-checkers = Number of checkers on a side
graphing-calculator-label-convert-to-table-tooltip = Convert to Table
graphing-calculator-label-create-table = Create Table
graphing-calculator-label-depressed = Depressed
graphing-calculator-label-drop-image-here = Drop Image Here
graphing-calculator-label-duplicate-expression-tooltip = Duplicate
graphing-calculator-label-edit-graph-bounds = Graph Bounds
graphing-calculator-label-edit-list-tooltip = Edit List
graphing-calculator-label-evaluation-list = { $count } element list
graphing-calculator-label-example-graph-3d-world = 3D World
graphing-calculator-label-example-graph-calculus-derivatives = Calculus: Derivatives
graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus = Calculus: Fundamental Theorem of Calculus
graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds = Calculus: Integral with adjustable bounds
graphing-calculator-label-example-graph-calculus-integrals = Calculus: Integrals
graphing-calculator-label-example-graph-calculus-secant-line = Calculus: Secant Line
graphing-calculator-label-example-graph-calculus-tangent-line = Calculus: Tangent Line
graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x = Calculus: Taylor Expansion of sin(x)
graphing-calculator-label-example-graph-checkerboard-inversion = Checkerboard Inversion
graphing-calculator-label-example-graph-conic-sections-circle = Conic Sections: Circle
graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci = Conic Sections: Ellipse with Foci
graphing-calculator-label-example-graph-conic-sections-hyperbola = Conic Sections: Hyperbola
graphing-calculator-label-example-graph-conic-sections-parabola-and-focus = Conic Sections: Parabola and Focus
graphing-calculator-label-example-graph-fastest-path-to-a-point = Fastest Path to a Point
graphing-calculator-label-example-graph-fireworks = Fireworks!
graphing-calculator-label-example-graph-fractal-valentine = Fractal Valentine
graphing-calculator-label-example-graph-lines-point-slope-form = Lines: Point Slope Form
graphing-calculator-label-example-graph-lines-slope-intercept-form = Lines: Slope Intercept Form
graphing-calculator-label-example-graph-lines-two-point-form = Lines: Two Point Form
graphing-calculator-label-example-graph-lists-curve-stitching = Lists: Curve Stitching
graphing-calculator-label-example-graph-lists-family-of-sin-curves = Lists: Family of sin Curves
graphing-calculator-label-example-graph-lists-plotting-a-list-of-points = Lists: Plotting a List of Points
graphing-calculator-label-example-graph-outstretched-arm = Outstretched Arm
graphing-calculator-label-example-graph-pac-man = Pac Man
graphing-calculator-label-example-graph-parabolas-standard-form = Parabolas: Standard Form
graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent = Parabolas: Standard Form + Tangent
graphing-calculator-label-example-graph-parabolas-vertex-form = Parabolas: Vertex Form
graphing-calculator-label-example-graph-parametric-cycloid = Parametric: Cycloid
graphing-calculator-label-example-graph-parametric-introduction = Parametric: Introduction
graphing-calculator-label-example-graph-polar-conic-sections = Polar: Conic Sections
graphing-calculator-label-example-graph-polar-limacon = Polar: Limacon
graphing-calculator-label-example-graph-polar-logarithmic-spiral = Polar: Logarithmic Spiral
graphing-calculator-label-example-graph-polar-rose = Polar: Rose
graphing-calculator-label-example-graph-pride-flag = PRIDE flag
graphing-calculator-label-example-graph-regular-sine-wave = Regular Sine Wave?
graphing-calculator-label-example-graph-stats-anscombes-quartet = Statistics: Anscombe's Quartet
graphing-calculator-label-example-graph-stats-fourth-order-polynomial = Statistics: 4th Order Polynomial
graphing-calculator-label-example-graph-stats-linear-regression = Statistics: Linear Regression
graphing-calculator-label-example-graph-transformations-inverse-of-a-function = Transformations: Inverse of a Function
graphing-calculator-label-example-graph-transformations-scaling-a-function = Transformations: Scaling a Function
graphing-calculator-label-example-graph-transformations-translating-a-function = Transformations: Translating a Function
graphing-calculator-label-example-graph-trig-period-and-amplitude = Trigonometry: Period and Amplitude
graphing-calculator-label-example-graph-trig-phase = Trigonometry: Phase
graphing-calculator-label-example-graph-trig-unit-circle = Trigonometry: Unit Circle
graphing-calculator-label-example-graph-trig-wave-interference = Trigonometry: Wave Interference
graphing-calculator-label-expression-delete-tooltip = Delete
graphing-calculator-label-expression-lowercase = expression
graphing-calculator-label-folder-lowercase = folder
graphing-calculator-label-geometry-move-to-folder-placeholder = Folder name
graphing-calculator-label-geometry-tool-options = { $tool } options
graphing-calculator-label-geometry-tools = Geometry Tools
graphing-calculator-label-hide-expression-list-tooltip = Hide Expression List
graphing-calculator-label-hide-keypad = Hide Keypad
graphing-calculator-label-hovered = Hovered
graphing-calculator-label-image-angle = Angle:
graphing-calculator-label-image-center = Center:
graphing-calculator-label-image-height = Height:
graphing-calculator-label-image-lowercase = image
graphing-calculator-label-image-opacity = Opacity:
graphing-calculator-label-image-width = Width:
graphing-calculator-label-label-size-tooltip = Label Scale Factor
graphing-calculator-label-line-thickness-3d-tooltip = Line Thickness
graphing-calculator-label-line-thickness-tooltip = Line Thickness (px)
graphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.
graphing-calculator-label-lock-expression-tooltip = Prevent Editing
graphing-calculator-label-lock-graph-bounds = Lock Graph Bounds
graphing-calculator-label-more-viewport-options = More Options
graphing-calculator-label-new-transformation = New Transformation
graphing-calculator-label-note-lowercase = note
graphing-calculator-label-opacity-tooltip = Opacity (0 to 1)
graphing-calculator-label-open-graph-tooltip = Open Graph (ctrl+o)
graphing-calculator-label-poi-unknown = unknown coordinates
graphing-calculator-label-point-size-3d-tooltip = Point Size
graphing-calculator-label-point-size-tooltip = Point Size (px)
graphing-calculator-label-powered-by = powered by
graphing-calculator-label-randomize-tooltip = Randomize
graphing-calculator-label-recent-transformations = Recent Transformations
graphing-calculator-label-redo-tooltip = Redo (ctrl+y)
graphing-calculator-label-reference-count =
    { $count ->
        [one] (1 reference)
       *[other] ({ $count } references)
    }
graphing-calculator-label-regression-log-mode-help-tooltip = Log mode help
graphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.
graphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.
graphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.
graphing-calculator-label-remove-depressed-image = Remove depressed image
graphing-calculator-label-remove-hovered-image = Remove hovered image
graphing-calculator-label-rename = rename
graphing-calculator-label-resolution-tooltip = 3D Grid Sample Resolution
graphing-calculator-label-search-expressions = Search this graph
graphing-calculator-label-settings-arrows = Arrows
graphing-calculator-label-settings-axis-labels-3d = Show labels
graphing-calculator-label-settings-axis-numbers = Axis Numbers
graphing-calculator-label-settings-domain-plane = Show x-y plane
graphing-calculator-label-settings-grid = Grid
graphing-calculator-label-settings-hidden-objects = Reveal { $count } hidden objects
graphing-calculator-label-settings-lock-viewport = Lock Viewport
graphing-calculator-label-settings-minor-gridlines = Minor Gridlines
graphing-calculator-label-settings-one-quadrant = One Quadrant
graphing-calculator-label-settings-reverse-contrast = Reverse Contrast
graphing-calculator-label-settings-six-key-braille = Six Key Braille Input
graphing-calculator-label-settings-step = Step:
graphing-calculator-label-settings-x-axis = X-Axis
graphing-calculator-label-settings-y-axis = Y-Axis
graphing-calculator-label-show-keypad = Show Keypad
graphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.
graphing-calculator-label-slider-step = Step:
graphing-calculator-label-table-lowercase = table
graphing-calculator-label-ticker-close = cancel
graphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.
graphing-calculator-label-ticker-lowercase = ticker
graphing-calculator-label-ticker-min-step = Min Step Time
graphing-calculator-label-ticker-pause = pause
graphing-calculator-label-ticker-play = play
graphing-calculator-label-tooltip-geometry-settings = Geometry Settings
graphing-calculator-label-tooltip-graph-settings = Graph Settings
graphing-calculator-label-tooltip-open-graph = Open Graph
graphing-calculator-label-tooltip-reset = Reset
graphing-calculator-label-tooltip-show-list = Show List
graphing-calculator-label-tooltip-viewport-default = Default Viewport
graphing-calculator-label-tooltip-zoom-default-orientation = Default Orientation
graphing-calculator-label-tooltip-zoom-in = Zoom In
graphing-calculator-label-tooltip-zoom-out = Zoom Out
graphing-calculator-label-undo-tooltip = Undo (ctrl+z)
graphing-calculator-label-unlock-expression-tooltip = Allow Editing
graphing-calculator-label-update-on-click = On click:
graphing-calculator-link-edit-on-desmos = edit graph on
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-link-view-braille-examples = View examples
graphing-calculator-narration-add-expression = Add expression
graphing-calculator-narration-add-folder = Add folder
graphing-calculator-narration-add-image = Add image
graphing-calculator-narration-add-item-menu = Add Item Menu
graphing-calculator-narration-add-note = Add note
graphing-calculator-narration-add-slider-prompt = Add slider for { $vars }
graphing-calculator-narration-add-table = Add table
graphing-calculator-narration-add-ticker = Add Ticker
graphing-calculator-narration-all-folders-collapsed = all folders collapsed
graphing-calculator-narration-all-folders-expanded = all folders expanded
graphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.
graphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.
graphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.
graphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider
graphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.
graphing-calculator-narration-audio-trace-description-color = Color: { $color }.
graphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.
graphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.
graphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.
graphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.
graphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.
graphing-calculator-narration-audio-trace-description-no-curve-selected = No curve selected.
graphing-calculator-narration-audio-trace-description-no-visible-axes = No visible axes.
graphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.
graphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.
graphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.
graphing-calculator-narration-audio-trace-description-one-label = 1 point label.
graphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.
graphing-calculator-narration-audio-trace-description-shading-above = Shading above.
graphing-calculator-narration-audio-trace-description-shading-below = Shading below.
graphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.
graphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.
graphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.
graphing-calculator-narration-audio-trace-description-visible-grid = Grid lines are visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis = X axis visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label = X axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range = X axis visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label = X axis visible from { $xmin } to { $xmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis = Y axis visible.
graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label = Y axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range = Y axis visible from { $ymin } to { $ymax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label = Y axis visible from { $ymin } to { $ymax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }
graphing-calculator-narration-audio-trace-first-point = First point
graphing-calculator-narration-audio-trace-first-slider = First slider.
graphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.
graphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.
graphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.
graphing-calculator-narration-audio-trace-last-point = Last point
graphing-calculator-narration-audio-trace-last-slider = Last slider.
graphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.
graphing-calculator-narration-audio-trace-no-more-pois = No more points of interest
graphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.
graphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.
graphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }
graphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.
graphing-calculator-narration-audio-trace-point-type-definition = Definition
graphing-calculator-narration-audio-trace-point-type-extremum = Extremum
graphing-calculator-narration-audio-trace-point-type-intercept = Intercept
graphing-calculator-narration-audio-trace-point-type-intersection = Intersection
graphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }
graphing-calculator-narration-audio-trace-point-type-label = Label
graphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I
graphing-calculator-narration-audio-trace-point-type-root = Zero
graphing-calculator-narration-audio-trace-point-type-trace = Trace
graphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.
graphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value
graphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.
graphing-calculator-narration-audio-trace-traceable-curves =
    { $sketchCount ->
        [one] 1 audio traceable curve.
       *[other] { $sketchCount } audio traceable curves.
    }
graphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.
graphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.
graphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.
graphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.
graphing-calculator-narration-audio-trace-volume = Volume { $volume } percent
graphing-calculator-narration-cdf-maximum = Max
graphing-calculator-narration-cdf-minimum = Min
graphing-calculator-narration-click-action = Click Action
graphing-calculator-narration-clickable-image-options = Clickable Image Options
graphing-calculator-narration-collapse = Collapse
graphing-calculator-narration-collapse-folder-index = Collapse Folder { $index }
graphing-calculator-narration-collapse-folder-title = Collapse { $folder } folder
graphing-calculator-narration-color-unknown = unknown
graphing-calculator-narration-computed-cell-role-description = computed cell
graphing-calculator-narration-configure-toolbar = Geometry Toolbar Configuration
graphing-calculator-narration-create-table = Create Table
graphing-calculator-narration-create-table-expression = Create Table from Expression { $index }
graphing-calculator-narration-create-table-secret-expression = Create Table from Secret Expression { $index }
graphing-calculator-narration-delete = Delete
graphing-calculator-narration-delete-expression = Delete Expression { $index }
graphing-calculator-narration-delete-folder-index = Delete Folder { $index }
graphing-calculator-narration-delete-folder-title = Delete { $folder } folder
graphing-calculator-narration-delete-image = Delete Image { $index }
graphing-calculator-narration-delete-secret-expression = Delete Secret Expression { $index }
graphing-calculator-narration-delete-table = Delete Table { $index }
graphing-calculator-narration-delete-text = Delete Note { $index }
graphing-calculator-narration-describe = Unknown object
graphing-calculator-narration-describe-expression = Expression { $index }
graphing-calculator-narration-describe-folder-index = Folder { $index }
graphing-calculator-narration-describe-folder-title = { $folder } folder
graphing-calculator-narration-describe-image = Image { $index }
graphing-calculator-narration-describe-secret-expression = Secret expression { $index }
graphing-calculator-narration-describe-table = Table { $index }
graphing-calculator-narration-describe-text = Note { $index }
graphing-calculator-narration-description-collapsed-folder = Collapsed Folder
graphing-calculator-narration-description-collapsed-readonly-folder = Collapsed Locked Folder
graphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder
graphing-calculator-narration-description-collapsed-secret-readonly-folder = Collapsed Secret Locked Folder
graphing-calculator-narration-description-folder = Folder
graphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder
graphing-calculator-narration-description-hidden-collapsed-readonly-folder = Hidden Collapsed Locked Folder
graphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder
graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder = Hidden Collapsed Secret Locked Folder
graphing-calculator-narration-description-hidden-folder = Hidden Folder
graphing-calculator-narration-description-hidden-readonly-folder = Hidden Locked Folder
graphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder
graphing-calculator-narration-description-hidden-secret-readonly-folder = Hidden Secret Locked Folder
graphing-calculator-narration-description-readonly-folder = Locked Folder
graphing-calculator-narration-description-secret-folder = Secret Folder
graphing-calculator-narration-description-secret-readonly-folder = Secret Locked Folder
graphing-calculator-narration-dist-tab-distributions = Distributions
graphing-calculator-narration-dist-tab-visualizations = Visualizations
graphing-calculator-narration-domain3d-maximum = domain { $term } Maximum:
graphing-calculator-narration-domain3d-minimum = domain { $term } Minimum:
graphing-calculator-narration-drag-mode-x = X
graphing-calculator-narration-drag-mode-xy = X and Y
graphing-calculator-narration-drag-mode-y = Y
graphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen
graphing-calculator-narration-duplicate = Duplicate
graphing-calculator-narration-duplicate-expression = Duplicate Expression { $index }
graphing-calculator-narration-duplicate-folder-index = Duplicate Folder { $index }
graphing-calculator-narration-duplicate-folder-title = Duplicate { $folder } folder
graphing-calculator-narration-duplicate-image = Duplicate Image { $index }
graphing-calculator-narration-duplicate-secret-expression = Duplicate Secret Expression { $index }
graphing-calculator-narration-duplicate-table = Duplicate Table { $index }
graphing-calculator-narration-duplicate-text = Duplicate Note { $index }
graphing-calculator-narration-edit-action = Edit Action
graphing-calculator-narration-edit-expression-list = Edit Expression List
graphing-calculator-narration-edit-folder-title = Edit Folder { $index } Title
graphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-image-title = Edit Image { $index } Title
graphing-calculator-narration-edit-list-mode-off = Edit list mode off.
graphing-calculator-narration-edit-list-mode-on = Edit list mode on.
graphing-calculator-narration-edit-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits
graphing-calculator-narration-edit-text-title = Note { $index }
graphing-calculator-narration-edit-title = Edit Title
graphing-calculator-narration-editable-label-mode = Editable label mode
graphing-calculator-narration-editable-point-label-at-coordinates = Editable point label at { $coordinates }
graphing-calculator-narration-expand = Expand
graphing-calculator-narration-expand-folder-index = Expand Folder { $index }
graphing-calculator-narration-expand-folder-title = Expand { $folder } folder
graphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.
graphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.
graphing-calculator-narration-expression-bar = Expression Bar
graphing-calculator-narration-expression-evaluation-has-graph = Has graph.
graphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-is-distribution = is distribution.
graphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.
graphing-calculator-narration-expression-hidden-label = Hidden { $label }
graphing-calculator-narration-expression-index-table = Expression { $index } table
graphing-calculator-narration-expression-label = Label
graphing-calculator-narration-fill-opacity = Fill Opacity:
graphing-calculator-narration-fill-visible = Fill visible
graphing-calculator-narration-folder-collapsed = folder collapsed
graphing-calculator-narration-folder-expanded = folder expanded
graphing-calculator-narration-folder-has-items = { $folder } has { $count } items
graphing-calculator-narration-functions = Functions
graphing-calculator-narration-geometry-added-object-type = Added { $type }.
graphing-calculator-narration-geometry-added-object-type-and-point = Added { $type } and 1 point.
graphing-calculator-narration-geometry-added-object-type-and-points = Added { $type } and { $points } points.
graphing-calculator-narration-geometry-added-points = Added { $points } points.
graphing-calculator-narration-geometry-angle-at-coordinates-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 } at { $x1 } { $y1 }
graphing-calculator-narration-geometry-angle-of-polygon-at-coordinates = { $itemDescription } of { $parent } at { $x } { $y }
graphing-calculator-narration-geometry-angle-with-assignment = Angle { $assignment }
graphing-calculator-narration-geometry-angle-with-measurement-and-assignment = { $measurementText } Angle { $assignment }
graphing-calculator-narration-geometry-arc-with-assignment = Arc { $assignment }
graphing-calculator-narration-geometry-circle-with-assignment = Circle { $assignment }
graphing-calculator-narration-geometry-construction-icon-label = Token Count
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-deselect-all = Deselect All
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-directed-angle-with-assignment = Directed Angle { $assignment }
graphing-calculator-narration-geometry-directed-angle-with-measurement-and-assignment = { $measurementText } Directed Angle { $assignment }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-with-assignment = GliderW { $assignment }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates-and-intersection = { $itemDescription } intersecting { $parent1 } and { $parent2 } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-and-parent = { $itemDescription } of { $parent } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-item-at-coordinates-with-middle-and-end = { $itemDescription } starting at { $x1 } { $y1 } middle at { $x2 } { $y2 } and end at { $x3 } { $y3 }
graphing-calculator-narration-geometry-item-at-coordinates-with-radius = { $itemDescription } at { $x } { $y } with radius { $radius }.
graphing-calculator-narration-geometry-item-to-line-passing-through-point-at-coordinates-to-coordinates = { $itemDescription } to { $parent1 } passing through { $parent2 } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-line-with-assignment = Line { $assignment }
graphing-calculator-narration-geometry-list-of-angles = List of { $count } angles
graphing-calculator-narration-geometry-list-of-any = List of { $count } unknown objects
graphing-calculator-narration-geometry-list-of-arcs = List of { $count } arcs
graphing-calculator-narration-geometry-list-of-circles = List of { $count } circles
graphing-calculator-narration-geometry-list-of-directed-angles = List of { $count } directed angles
graphing-calculator-narration-geometry-list-of-lines = List of { $count } lines
graphing-calculator-narration-geometry-list-of-points = List of { $count } points
graphing-calculator-narration-geometry-list-of-polygons = List of { $count } polygons
graphing-calculator-narration-geometry-list-of-rays = List of { $count } rays
graphing-calculator-narration-geometry-list-of-segments = List of { $count } segments
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-moved-to-coordinates = Moved to x: { $x }, y: { $y }.
graphing-calculator-narration-geometry-near-item = Near { $item }.
graphing-calculator-narration-geometry-no-tool-inputs = No inputs exist
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-parallel-with-assignment = Parallel { $assignment }
graphing-calculator-narration-geometry-perpendicular-with-assignment = Perpendicular { $assignment }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-polygon-with-assignment = Polygon { $assignment } with { $sideCount } sides
graphing-calculator-narration-geometry-quadrilateral-with-assignment = Quadrilateral { $assignment }
graphing-calculator-narration-geometry-ray-with-assignment = Ray { $assignment }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-token-navigator-depth = Depth: { $depth }
graphing-calculator-narration-geometry-token-navigator-label = Token Navigator
graphing-calculator-narration-geometry-tool-cancelled = Cancelled.
graphing-calculator-narration-geometry-tool-disabled = The { $tool } tool is disabled.
graphing-calculator-narration-geometry-transformed-item = reflected { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-triangle-with-assignment = Triangle { $assignment }
graphing-calculator-narration-geometry-unable-to-move = Unable to move.
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index } with { $sideCount } sides
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-geometry-unlabeled-vector = Vector { $index }
graphing-calculator-narration-geometry-vector-with-assignment = Vector { $assignment }
graphing-calculator-narration-graph-settings-controls = Graph Settings Controls
graphing-calculator-narration-graphpaper-label = graph paper
graphing-calculator-narration-hide = Hide
graphing-calculator-narration-hide-animation-properties = Hide Animation Properties
graphing-calculator-narration-hide-expression = Hide Expression { $index }
graphing-calculator-narration-hide-expression-list = Hide expression list
graphing-calculator-narration-hide-folder-index = Hide Folder { $index }
graphing-calculator-narration-hide-folder-title = Hide { $folder } folder
graphing-calculator-narration-hide-image = Hide Image { $index }
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-options-expression = Hide Options for Expression { $index }
graphing-calculator-narration-hide-options-image = Hide Options for Image { $index }
graphing-calculator-narration-hide-options-secret-expression = Hide Options for Secret Expression { $index }
graphing-calculator-narration-hide-secret-expression = Hide Secret Expression { $index }
graphing-calculator-narration-hide-table = Hide Table { $index }
graphing-calculator-narration-hide-table-column = Hide Column
graphing-calculator-narration-hide-text = Hide Note { $index }
graphing-calculator-narration-image-styles = Styles
graphing-calculator-narration-item-at-coordinates = { $itemDescription } at { $x } { $y }
graphing-calculator-narration-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-items-deleted =
    { $count ->
        [one] { $count } item deleted.
       *[other] { $count } items deleted.
    }
graphing-calculator-narration-keypad-hidden = Keypad hidden
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-keypad-visible = Keypad visible
graphing-calculator-narration-label-angle = Label Angle:
graphing-calculator-narration-label-size = Label Size:
graphing-calculator-narration-label-text = Label Text
graphing-calculator-narration-label-visible = Label visible
graphing-calculator-narration-line-opacity = Line Opacity:
graphing-calculator-narration-line-style-dashed = Dashed
graphing-calculator-narration-line-style-dotted = Dotted
graphing-calculator-narration-line-style-solid = Solid
graphing-calculator-narration-lines-visible = Lines visible
graphing-calculator-narration-main-desmos-geometry = Desmos Geometry
graphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator
graphing-calculator-narration-make-clickable = make clickable
graphing-calculator-narration-menu-drag-enabled = Drag Enabled
graphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen
graphing-calculator-narration-movable-point-prefix = Point
graphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.
graphing-calculator-narration-open-graph = Open Graph
graphing-calculator-narration-options-menu = Options Menu
graphing-calculator-narration-options-menu-closed = Options menu closed.
graphing-calculator-narration-options-menu-open = Options menu open.
graphing-calculator-narration-orientation-restore-default = Restore Default Orientation
graphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation
graphing-calculator-narration-play-variable-animation = Play { $variable } Animation
graphing-calculator-narration-poi-graph-point = Point
graphing-calculator-narration-point-size = Point Size:
graphing-calculator-narration-point-style-cross = Cross
graphing-calculator-narration-point-style-open = Open
graphing-calculator-narration-point-style-point = Point
graphing-calculator-narration-points-visible = Points visible
graphing-calculator-narration-powered-by-desmos = Powered by Desmos
graphing-calculator-narration-redo = Redo
graphing-calculator-narration-rename = Rename
graphing-calculator-narration-rename-expression = Rename in Expression { $index }
graphing-calculator-narration-rename-secret-expression = Rename in Secret Expression { $index }
graphing-calculator-narration-rename-table = Rename in Table { $index }
graphing-calculator-narration-run-action-icon = Run Action
graphing-calculator-narration-settings-angle = Angle Settings
graphing-calculator-narration-settings-cartesian-grid = Cartesian Grid
graphing-calculator-narration-settings-dimension = 2D vs 3D Mode
graphing-calculator-narration-settings-polar-grid = Polar Grid
graphing-calculator-narration-settings-show-both = Show Both
graphing-calculator-narration-settings-show-positive = Show Positive
graphing-calculator-narration-settings-x-axis-label-placeholder = e.g. \u201Cx\u201D
graphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }
graphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }
graphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }
graphing-calculator-narration-settings-y-axis-label-placeholder = e.g. \u201Cy\u201D
graphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }
graphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }
graphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }
graphing-calculator-narration-settings-z-axis-max = Z Axis Maximum:{ " " }
graphing-calculator-narration-settings-z-axis-min = Z Axis Minimum:{ " " }
graphing-calculator-narration-share-graph-link = Link to this graph
graphing-calculator-narration-share-graph-link-copied = Link copied
graphing-calculator-narration-share-graph-link-unable-to-copy = Unable to copy link
graphing-calculator-narration-show = Show
graphing-calculator-narration-show-animation-properties = Show Animation Properties
graphing-calculator-narration-show-expression = Show Expression { $index }
graphing-calculator-narration-show-folder-index = Show Folder { $index }
graphing-calculator-narration-show-folder-title = Show { $folder } folder
graphing-calculator-narration-show-image = Show Image { $index }
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-options-expression = Show Options for Expression { $index }
graphing-calculator-narration-show-options-image = Show Options for Image { $index }
graphing-calculator-narration-show-options-secret-expression = Show Options for Secret Expression { $index }
graphing-calculator-narration-show-secret-expression = Show Secret Expression { $index }
graphing-calculator-narration-show-table = Show Table { $index }
graphing-calculator-narration-show-table-column = Show Column
graphing-calculator-narration-show-text = Show Note { $index }
graphing-calculator-narration-slider-animate-faster = Animate Faster
graphing-calculator-narration-slider-animate-slower = Animate Slower
graphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x
graphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards
graphing-calculator-narration-slider-maximum = Slider Maximum:
graphing-calculator-narration-slider-minimum = Slider Minimum:
graphing-calculator-narration-slider-play-indefinitely = Play indefinitely
graphing-calculator-narration-slider-play-once = Play once
graphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction
graphing-calculator-narration-slider-step = Slider Step Size:
graphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.
graphing-calculator-narration-slider-trace-off = Slider trace off.
graphing-calculator-narration-slider-trace-on = Slider trace on.
graphing-calculator-narration-slider-variable-paused = { $variable } paused
graphing-calculator-narration-slider-variable-playing = { $variable } playing
graphing-calculator-narration-slider-variable-restarted = { $variable } restarted
graphing-calculator-narration-surfaces-visible = Surfaces visible
graphing-calculator-narration-table-column-header = Column header { $column }
graphing-calculator-narration-table-no-column-header = No column header
graphing-calculator-narration-table-row-column = Row { $row } Col { $column }
graphing-calculator-narration-tick-action = Tick Action
graphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace
graphing-calculator-narration-toggle-letters = Toggle Letters
graphing-calculator-narration-transformations-menu = Transformations Menu
graphing-calculator-narration-unable-to-activate-account-menu = Unable to activate account menu
graphing-calculator-narration-unable-to-activate-help-menu = Unable to activate help menu
graphing-calculator-narration-unable-to-activate-language-menu = Unable to activate language menu
graphing-calculator-narration-unable-to-activate-share-menu = Unable to activate share menu
graphing-calculator-narration-unable-to-add-expression = Unable to add expression
graphing-calculator-narration-unable-to-add-note = Unable to add note
graphing-calculator-narration-unable-to-add-table = Unable to add table
graphing-calculator-narration-undo = Undo
graphing-calculator-narration-viewport-default = Graph viewport default
graphing-calculator-narration-viewport-restore-default = Restore Default Viewport
graphing-calculator-narration-viewport-updated = Graph viewport updated.
graphing-calculator-narration-viewport-zoom-in = Graph zoom in
graphing-calculator-narration-viewport-zoom-out = Graph zoom out
graphing-calculator-narration-viewport-zoom-square = Graph zoom square
graphing-calculator-narration-visual-parameters-height = Height
graphing-calculator-narration-visual-parameters-offset = Offset
graphing-calculator-narration-visual-parameters-width = Width
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
graphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label
graphing-calculator-text-arrow-mode-both = Both
graphing-calculator-text-arrow-mode-default = Default
graphing-calculator-text-arrow-mode-none = None
graphing-calculator-text-arrow-mode-positive = Positive
graphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can't trace implicit curves yet.
graphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can't trace parametric curves yet.
graphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can't trace polar curves yet.
graphing-calculator-text-audio-trace-off = Audio trace off.
graphing-calculator-text-audio-trace-on = Audio trace on.
graphing-calculator-text-color-black = black
graphing-calculator-text-color-blue = blue
graphing-calculator-text-color-gray = gray
graphing-calculator-text-color-green = green
graphing-calculator-text-color-orange = orange
graphing-calculator-text-color-purple = purple
graphing-calculator-text-color-red = red
graphing-calculator-text-color-unknown = color unknown
graphing-calculator-text-enter-pareneter = Enter the { $param }.
graphing-calculator-text-export-braille-email-accessibility = Feedback? Email <1>accessibility@desmos.com</1>.
graphing-calculator-text-folder-placeholder = Untitled folder
graphing-calculator-text-geometry-arrow-mode = Arrow Mode: { $mode }
graphing-calculator-text-geometry-delete-selected-objects =
    { $count ->
        [one] Delete 1 object
       *[other] Delete { $count } objects
    }
graphing-calculator-text-geometry-glider = glider
graphing-calculator-text-geometry-hide-objects =
    { $count ->
        [one] Hide
       *[other] Hide all
    }
graphing-calculator-text-geometry-intersection = intersection
graphing-calculator-text-geometry-move-to-folder-message =
    { $count ->
        [one] Move to folder:
       *[other] Move { $count } objects to folder:
    }
graphing-calculator-text-geometry-multi-select-more-dropdown = More
graphing-calculator-text-geometry-multi-select-transform = Transform
graphing-calculator-text-geometry-no-constructed-objects = No constructed objects yet.
graphing-calculator-text-geometry-select-hint = Select a { $type }
graphing-calculator-text-geometry-selected-objects =
    { $count ->
        [one] 1 object selected
       *[other] { $count } objects selected
    }
graphing-calculator-text-geometry-show-objects =
    { $count ->
        [one] Show
       *[other] Show all
    }
graphing-calculator-text-geometry-tool-angle-display-name = Angle
graphing-calculator-text-geometry-tool-angle-hint-1 = Choose a starting point
graphing-calculator-text-geometry-tool-angle-hint-2 = Choose a vertex point
graphing-calculator-text-geometry-tool-angle-hint-3 = Choose an endpoint
graphing-calculator-text-geometry-tool-angles-hint-1 = Choose a starting point or a polygon
graphing-calculator-text-geometry-tool-arc-display-name = Arc
graphing-calculator-text-geometry-tool-arc-hint-1 = Choose a point (start)
graphing-calculator-text-geometry-tool-arc-hint-2 = Choose a point (middle)
graphing-calculator-text-geometry-tool-arc-hint-3 = Choose a point (end)
graphing-calculator-text-geometry-tool-box-selection-display-name = Box Select
graphing-calculator-text-geometry-tool-circle-display-name = Circle
graphing-calculator-text-geometry-tool-circle-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-circle-hint-radius = Choose a point (radius)
graphing-calculator-text-geometry-tool-compass-display-name = Compass
graphing-calculator-text-geometry-tool-compass-hint-center = Choose a center point
graphing-calculator-text-geometry-tool-compass-hint-segment = Choose a segment to set the radius
graphing-calculator-text-geometry-tool-dilate-display-name = Dilate
graphing-calculator-text-geometry-tool-dilation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-dilation-hint-scale-factor = Scale factor
graphing-calculator-text-geometry-tool-directedangle-display-name = Directed angle
graphing-calculator-text-geometry-tool-expression-edit-display-name = Insert into current expression.
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0 = No valid inputs
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1 = Choose { $type }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2 = Choose { $type1 } or { $type2 }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object = Choose any object
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many = Choose one of the following: { $types }
graphing-calculator-text-geometry-tool-line-display-name = Line
graphing-calculator-text-geometry-tool-line-hint-end = Choose a 2nd point
graphing-calculator-text-geometry-tool-line-hint-start = Choose a 1st point
graphing-calculator-text-geometry-tool-midpoint-display-name = Midpoint
graphing-calculator-text-geometry-tool-midpoint-hint = Choose a segment
graphing-calculator-text-geometry-tool-parallel-display-name = Parallel
graphing-calculator-text-geometry-tool-parallel-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-parallel-hint-straight-line = Choose a line to be parallel to
graphing-calculator-text-geometry-tool-perpendicular-display-name = Perpendicular
graphing-calculator-text-geometry-tool-perpendicular-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line = Choose a line to be perpendicular to
graphing-calculator-text-geometry-tool-point-display-name = Point
graphing-calculator-text-geometry-tool-point-hint = Select or create a point
graphing-calculator-text-geometry-tool-polygon-display-name = Polygon
graphing-calculator-text-geometry-tool-polygon-hint-finish-point = Choose another point, or click an existing point to finish
graphing-calculator-text-geometry-tool-polygon-hint-first-point = Choose a point
graphing-calculator-text-geometry-tool-polygon-hint-next-point = Choose another point
graphing-calculator-text-geometry-tool-ray-display-name = Ray
graphing-calculator-text-geometry-tool-ray-hint-end = Choose a point (direction)
graphing-calculator-text-geometry-tool-ray-hint-start = Choose a point (vertex)
graphing-calculator-text-geometry-tool-reflect-display-name = Reflect
graphing-calculator-text-geometry-tool-reflection-hint-choose-line = Choose line of reflection
graphing-calculator-text-geometry-tool-rotate-display-name = Rotate
graphing-calculator-text-geometry-tool-rotation-hint-angle = Choose angle
graphing-calculator-text-geometry-tool-rotation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-segment-display-name = Segment
graphing-calculator-text-geometry-tool-segment-hint-end = Choose another point
graphing-calculator-text-geometry-tool-segment-hint-start = Choose a point
graphing-calculator-text-geometry-tool-selection-display-name = Select
graphing-calculator-text-geometry-tool-translate-display-name = Translate
graphing-calculator-text-geometry-tool-translation-hint-from = Choose start point
graphing-calculator-text-geometry-tool-translation-hint-to = Choose end point
graphing-calculator-text-geometry-tool-vector-display-name = Vector
graphing-calculator-text-image-placeholder = Unnamed image
graphing-calculator-text-label-orientation-above = Above
graphing-calculator-text-label-orientation-above-left = Above Left
graphing-calculator-text-label-orientation-above-right = Above Right
graphing-calculator-text-label-orientation-below = Below
graphing-calculator-text-label-orientation-below-left = Below Left
graphing-calculator-text-label-orientation-below-right = Below Right
graphing-calculator-text-label-orientation-default = Default
graphing-calculator-text-label-orientation-left = Left
graphing-calculator-text-label-orientation-right = Right
graphing-calculator-text-loading-image = Loading image...
graphing-calculator-text-note-placeholder = Empty note
graphing-calculator-text-parameter-name-binwidth = Bin Width
graphing-calculator-text-parameter-name-data = Data Set
graphing-calculator-text-parameter-name-dof = Degrees of Freedom
graphing-calculator-text-parameter-name-height = Height
graphing-calculator-text-parameter-name-max = Maximum
graphing-calculator-text-parameter-name-mean = Mean
graphing-calculator-text-parameter-name-min = Minimum
graphing-calculator-text-parameter-name-offset = Offset
graphing-calculator-text-parameter-name-probsuccess = Success Probability
graphing-calculator-text-parameter-name-stddev = Standard Deviation
graphing-calculator-text-parameter-name-trials = Trials
graphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.
graphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.
graphing-calculator-text-share-graph-link = Link to this graph
graphing-calculator-text-table-created = Table created.
graphing-calculator-text-table-more-rows = { $rowCount } more rows
graphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement
graphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?
graphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.
graphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.
graphing-calculator-text-toast-graph-cleared = Graph cleared.
graphing-calculator-text-toast-graph-reset = Graph reset.
graphing-calculator-text-toast-image-upload-failed = Image upload failed.
graphing-calculator-text-toast-imported-graph = Graph imported!
graphing-calculator-text-toast-importing-graph = Importing graph...
graphing-calculator-text-toast-no-file-selected = You did not select a file
graphing-calculator-text-toast-undo-cmd-z = Press CMD+Z to undo.
graphing-calculator-text-toast-undo-ctrl-z = Press CTRL+Z to undo.
graphing-calculator-text-toast-uploading-images = Uploading images...
graphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.
graphing-calculator-text-zoom-fit = Zoom Fit
graphing-tours-heading-advanced-tables = Advanced Tables
graphing-tours-heading-derivatives = Derivatives
graphing-tours-heading-folders = Folders
graphing-tours-heading-lists = Lists
graphing-tours-heading-regressions = Regressions
graphing-tours-heading-restrictions = Restrictions
graphing-tours-heading-sliders = Sliders
graphing-tours-heading-tables = Tables
graphing-tours-label-advanced-tables-continue = Click here to continue editing this table.
graphing-tours-label-advanced-tables-convert = Convert this to a table.
graphing-tours-label-advanced-tables-create = Click here to generate a table.
graphing-tours-label-advanced-tables-dots = Click here to only show the dots.
graphing-tours-label-advanced-tables-edit-list = Click the "Edit List" button.
graphing-tours-label-advanced-tables-graph = Start by graphing a function.
graphing-tours-label-advanced-tables-new-column = Move right to add a new column.
graphing-tours-label-advanced-tables-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-advanced-tables-start = Let's make a function. First: click here to create a new blank expression.
graphing-tours-label-advanced-tables-type-function = Try typing { $sample_expression }
graphing-tours-label-advanced-tables-wizard = You're a table wizard!
graphing-tours-label-awesome = Awesome!
graphing-tours-label-brilliant = Brilliant!
graphing-tours-label-derivative-graph-derivative = To graph its derivative: { $equation }
graphing-tours-label-derivative-hint-type-derivative = Hint: To get the derivative operator, just type d/dx.
graphing-tours-label-derivative-one-more = Let's try one more: { $equation }
graphing-tours-label-derivative-start-function = Start with a function: { $equation }
graphing-tours-label-derivative-start-graph = Let's graph a derivative!
graphing-tours-label-folders-collapse = Now we\u2019ll explore some folder functionality. Click here to collapse the folder.
graphing-tours-label-folders-did-you-know = Did You Know...
graphing-tours-label-folders-grab = Now grab this equation by its left edge and drag it into the folder.
graphing-tours-label-folders-great-start = That\u2019s a great start!
graphing-tours-label-folders-hide = You can hide everything in the folder with one click. Click here to try.
graphing-tours-label-folders-indicator = Hint: The gray line will show you if the expression is in the folder.
graphing-tours-label-folders-name = Give your folder a name.
graphing-tours-label-folders-new-equation = Let's make a new equation. For example, type: { $equation }
graphing-tours-label-folders-option = ... and select the "folder" option.
graphing-tours-label-folders-start = Let's make a folder!
graphing-tours-label-great-job = Great job!
graphing-tours-label-last-thing = Last thing!
graphing-tours-label-list-computation = You can do a computation on a list. For example: { $equation }
graphing-tours-label-lists-are-powerful = Lists are powerful. Let's see.
graphing-tours-label-lists-begin-equation = Begin by typing { $equation }
graphing-tours-label-lists-count-by = If you want to count by 5 instead, just write something like this: { $equation }
graphing-tours-label-lists-create-range = You can create lists of integers even more easily. Try this: { $equation }
graphing-tours-label-lists-graph-equation = Graph: { $equation }
graphing-tours-label-lists-graph-points = Let's graph a few points.
graphing-tours-label-lists-hint-abc = Hint: press the 'A B C' button on the keypad to find the [ ] buttons
graphing-tours-label-lists-hint-plot-points = Hint: this will plot a point for each item of b.
graphing-tours-label-lists-hint-superscript = Hint: you can type { $suggestion1 } or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-lists-point-equation = Try this: { $equation }
graphing-tours-label-lists-put-to-work = Nice. Let's put that list to work.
graphing-tours-label-new-item = Click here to add a new item.
graphing-tours-label-nice = Nice!
graphing-tours-label-regressions-better-fit = Edit this equation to find a better fit. Try, for example:<br>{ $equation }
graphing-tours-label-regressions-check-model = Nice. Let's check the model.
graphing-tours-label-regressions-data = First, let's get some data.
graphing-tours-label-regressions-data-2 = Let's start with some data!
graphing-tours-label-regressions-docs = Head over to Google Docs and copy and paste this { $sample_data_link }.
graphing-tours-label-regressions-equation = Now type: { $equation }
graphing-tours-label-regressions-expression-option = ... and select the "expression" option.
graphing-tours-label-regressions-fill-sample-data = Fill in the sample data:
graphing-tours-label-regressions-hint-1 = Hint #1: to get { $y_1 } type { $y1 }.
graphing-tours-label-regressions-hint-2 = Hint #2: { $twiddle } is in our onscreen keypad in the 'A B C' section.
graphing-tours-label-regressions-keep-exploring = Nice work &ndash; Keep exploring!
graphing-tours-label-regressions-new-model = Now, let's try a new model.
graphing-tours-label-regressions-new-table = Click here to add a new table.
graphing-tours-label-regressions-own-data = Note: you can add your own data instead by clicking the { $plus_icon } button.
graphing-tours-label-regressions-residuals = Residuals are the difference between your data and your model. Click here to add them to your table and plot them on the graph.
graphing-tours-label-regressions-sample-data = sample data
graphing-tours-label-require-expressions-visible = Click to show the list of expressions.
graphing-tours-label-require-not-edit-list-mode = Click to return to your expressions.
graphing-tours-label-require-resources-not-open = Click to return to this graph.
graphing-tours-label-restrictions-abc = Hint: press the 'A B C' button on the keypad to find the { $buttons } buttons
graphing-tours-label-restrictions-blank-expression = Click here to make a new blank expression.
graphing-tours-label-restrictions-change-equation = Change this equation to { $sample_expression }
graphing-tours-label-restrictions-domain = Restrict the domain of this line by adding { $sample_expression } to the end.
graphing-tours-label-restrictions-dont-forget = Don't forget the "y="!
graphing-tours-label-restrictions-graph-parabola = Now graph: { $sample_expression }
graphing-tours-label-restrictions-move-parabola = Move the parabola.
graphing-tours-label-restrictions-new-expression = Click here to create a new expression.
graphing-tours-label-restrictions-range = Now let's restrict the range. Add { $sample_expression } to the end.
graphing-tours-label-restrictions-star = You're a restrictions star!
graphing-tours-label-restrictions-start = Let's get started!
graphing-tours-label-restrictions-straight-line = Try graphing a straight line, like { $sample_expression }
graphing-tours-label-restrictions-type-all = Try typing all of { $sample_expression }
graphing-tours-label-restrictions-typing-hint = Hint: you can type { $suggestion1 }, or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-self-destruct = This message will self-destruct in { $seconds }...
graphing-tours-label-sliders-add = Now click here to add the sliders.
graphing-tours-label-sliders-blank-expression = Click here to create a new blank expression.
graphing-tours-label-sliders-change-value = Type in here to change the value.
graphing-tours-label-sliders-drag-handle = Drag the handle to change the value.
graphing-tours-label-sliders-hands-free = Go "Hands-free"
graphing-tours-label-sliders-make-sliders = Let's make some sliders!
graphing-tours-label-sliders-press-play = Press play to animate the slider.
graphing-tours-label-sliders-pro = You're a slider pro!
graphing-tours-label-sliders-try-typing = Try typing { $sample_expression }
graphing-tours-label-tables-back = Click back to continue editing.
graphing-tours-label-tables-close-options = Click anywhere to close the drawing options.
graphing-tours-label-tables-dots = Click here to connect the dots.
graphing-tours-label-tables-enter = Now try pressing Enter.
graphing-tours-label-tables-fill-another = Just fill in one more...
graphing-tours-label-tables-fill-cell = Fill it in.
graphing-tours-label-tables-fill-row = Fill in this whole row.
graphing-tours-label-tables-last-trick = Last trick!
graphing-tours-label-tables-next-row = Go down to the next row to add more data.
graphing-tours-label-tables-open-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-tables-select-table = ... and select the "table" option.
graphing-tours-label-tables-start = Let's make a table!
graphing-tours-label-tables-type-number = Type any number here.
graphing-tours-label-tables-valid-number = Uh-oh! Type a valid number here.
graphing-tours-label-tables-whiz = You're a tables whiz!
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose
frontpage-narration-shared-desmos-logo = Desmos Logo




























































































































































































































































































































































































































































































































































`;var fp=class{constructor(e){this.value=e}valueOf(){return this.value}},Fn=class extends fp{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},fl=class extends fp{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},pu=class extends fp{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}};var FP=100,M4="\u2068",A4="\u2069";function L4(r,e,t){if(t===e||t instanceof fl&&e instanceof fl&&t.value===e.value)return!0;if(e instanceof fl&&typeof t=="string"){let i=r.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===i)return!0}return!1}function RP(r,e,t){return e[t]?gm(r,e[t].value):(r.reportError(new RangeError("No default")),new Fn)}function aT(r,e){let t=[],i=Object.create(null);for(let n of e)n.type==="narg"?i[n.name]=gb(r,n.value):t.push(gb(r,n));return{positional:t,named:i}}function gb(r,e){switch(e.type){case"str":return e.value;case"num":return new fl(e.value,{minimumFractionDigits:e.precision});case"var":return O4(r,e);case"mesg":return P4(r,e);case"term":return _4(r,e);case"func":return F4(r,e);case"select":return R4(r,e);default:return new Fn}}function O4(r,{name:e}){let t;if(r.params)if(Object.prototype.hasOwnProperty.call(r.params,e))t=r.params[e];else return new Fn(`$${e}`);else if(r.args&&Object.prototype.hasOwnProperty.call(r.args,e))t=r.args[e];else return r.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Fn(`$${e}`);if(t instanceof fp)return t;switch(typeof t){case"string":return t;case"number":return new fl(t);case"object":if(t instanceof Date)return new pu(t.getTime());default:return r.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Fn(`$${e}`)}}function P4(r,{name:e,attr:t}){let i=r.bundle._messages.get(e);if(!i)return r.reportError(new ReferenceError(`Unknown message: ${e}`)),new Fn(e);if(t){let n=i.attributes[t];return n?gm(r,n):(r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Fn(`${e}.${t}`))}return i.value?gm(r,i.value):(r.reportError(new ReferenceError(`No value: ${e}`)),new Fn(e))}function _4(r,{name:e,attr:t,args:i}){let n=`-${e}`,o=r.bundle._terms.get(n);if(!o)return r.reportError(new ReferenceError(`Unknown term: ${n}`)),new Fn(n);if(t){let a=o.attributes[t];if(a){r.params=aT(r,i).named;let l=gm(r,a);return r.params=null,l}return r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Fn(`${n}.${t}`)}r.params=aT(r,i).named;let s=gm(r,o.value);return r.params=null,s}function F4(r,{name:e,args:t}){let i=r.bundle._functions[e];if(!i)return r.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Fn(`${e}()`);if(typeof i!="function")return r.reportError(new TypeError(`Function ${e}() is not callable`)),new Fn(`${e}()`);try{let n=aT(r,t);return i(n.positional,n.named)}catch(n){return r.reportError(n),new Fn(`${e}()`)}}function R4(r,{selector:e,variants:t,star:i}){let n=gb(r,e);if(n instanceof Fn)return RP(r,t,i);for(let o of t){let s=gb(r,o.key);if(L4(r,n,s))return gm(r,o.value)}return RP(r,t,i)}function lT(r,e){if(r.dirty.has(e))return r.reportError(new RangeError("Cyclic reference")),new Fn;r.dirty.add(e);let t=[],i=r.bundle._useIsolating&&e.length>1;for(let n of e){if(typeof n=="string"){t.push(r.bundle._transform(n));continue}if(r.placeables++,r.placeables>FP)throw r.dirty.delete(e),new RangeError(`Too many placeables expanded: ${r.placeables}, max allowed is ${FP}`);i&&t.push(M4),t.push(gb(r,n).toString(r)),i&&t.push(A4)}return r.dirty.delete(e),t.join("")}function gm(r,e){return typeof e=="string"?r.bundle._transform(e):lT(r,e)}var WC=class{constructor(e,t,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=i}reportError(e){if(!this.errors)throw e;this.errors.push(e)}memoizeIntlObject(e,t){let i=this.bundle._intls.get(e);i||(i={},this.bundle._intls.set(e,i));let n=JSON.stringify(t);return i[n]||(i[n]=new e(this.bundle.locales,t)),i[n]}};function NP(r,e){let t=Object.create(null);for(let[i,n]of Object.entries(r))e.includes(i)&&(t[i]=n.valueOf());return t}var N4=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function BP(r,e){let t=r[0];if(t instanceof Fn)return new Fn(`NUMBER(${t.valueOf()})`);if(t instanceof fl||t instanceof pu)return new fl(t.valueOf(),__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t.opts),NP(e,N4)));throw new TypeError("Invalid argument to NUMBER")}var B4=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function KP(r,e){let t=r[0];if(t instanceof Fn)return new Fn(`DATETIME(${t.valueOf()})`);if(t instanceof fl||t instanceof pu)return new pu(t.valueOf(),__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t.opts),NP(e,B4)));throw new TypeError("Invalid argument to DATETIME")}var mb=class{constructor(e,{functions:t,useIsolating:i=!0,transform:n=o=>o}={}){this._terms=new Map,this._messages=new Map,this._intls=new WeakMap,this.locales=Array.isArray(e)?e:[e],this._functions=__dcg_shared_module_exports__['a']({NUMBER:BP,DATETIME:KP},t),this._useIsolating=i,this._transform=n}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let i=[];for(let n=0;n<e.body.length;n++){let o=e.body[n];if(o.id.startsWith("-")){if(t===!1&&this._terms.has(o.id)){i.push(new Error(`Attempt to override an existing term: "${o.id}"`));continue}this._terms.set(o.id,o)}else{if(t===!1&&this._messages.has(o.id)){i.push(new Error(`Attempt to override an existing message: "${o.id}"`));continue}this._messages.set(o.id,o)}}return i}formatPattern(e,t=null,i=null){if(typeof e=="string")return this._transform(e);let n=new WC(this,i,t);try{return lT(n,e).toString(n)}catch(o){if(n.errors)return n.errors.push(o),new Fn().toString(n);throw o}}};var cT=/^(-?[a-zA-Z][\w-]*) *= */gm,UP=/\.([a-zA-Z][\w-]*) *= */y,K4=/\*?\[/y,dT=/(-?[0-9]+(?:\.([0-9]+))?)/y,U4=/([a-zA-Z][\w-]*)/y,HP=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,H4=/^[A-Z][A-Z0-9_-]*$/,jC=/([^{}\n\r]+)/y,q4=/([^\\"\n\r]*)/y,qP=/\\([\\"])/y,zP=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,z4=/^\n+/,$P=/ +$/,$4=/ *\r?\n/g,W4=/( *)$/,j4=/{\s*/y,WP=/\s*}/y,J4=/\[\s*/y,Y4=/\s*] */y,X4=/\s*\(\s*/y,Q4=/\s*->\s*/y,Z4=/\s*:\s*/y,e6=/\s*,?\s*/y,t6=/\s+/y,mm=class{constructor(e){this.body=[],cT.lastIndex=0;let t=0;for(;;){let H=cT.exec(e);if(H===null)break;t=cT.lastIndex;try{this.body.push(l(H[1]))}catch(j){if(j instanceof SyntaxError)continue;throw j}}function i(H){return H.lastIndex=t,H.test(e)}function n(H,j){if(e[t]===H)return t++,!0;if(j)throw new j(`Expected ${H}`);return!1}function o(H,j){if(i(H))return t=H.lastIndex,!0;if(j)throw new j(`Expected ${H.toString()}`);return!1}function s(H){H.lastIndex=t;let j=H.exec(e);if(j===null)throw new SyntaxError(`Expected ${H.toString()}`);return t=H.lastIndex,j}function a(H){return s(H)[1]}function l(H){let j=u(),ne=c();if(j===null&&Object.keys(ne).length===0)throw new SyntaxError("Expected message value or attributes");return{id:H,value:j,attributes:ne}}function c(){let H=Object.create(null);for(;i(UP);){let j=a(UP),ne=u();if(ne===null)throw new SyntaxError("Expected attribute value");H[j]=ne}return H}function u(){let H;if(i(jC)&&(H=a(jC)),e[t]==="{"||e[t]==="}")return p(H?[H]:[],1/0);let j=R();return j?H?p([H,j],j.length):(j.value=P(j.value,z4),p([j],j.length)):H?P(H,$P):null}function p(H=[],j){for(;;){if(i(jC)){H.push(a(jC));continue}if(e[t]==="{"){H.push(g());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let B=R();if(B){H.push(B),j=Math.min(j,B.length);continue}break}let ne=H.length-1,le=H[ne];typeof le=="string"&&(H[ne]=P(le,$P));let w=[];for(let B of H)B instanceof JC&&(B=B.value.slice(0,B.value.length-j)),B&&w.push(B);return w}function g(){o(j4,SyntaxError);let H=h();if(o(WP))return H;if(o(Q4)){let j=D();return o(WP,SyntaxError),__dcg_shared_module_exports__['a']({type:"select",selector:H},j)}throw new SyntaxError("Unclosed placeable")}function h(){if(e[t]==="{")return g();if(i(HP)){let[,H,j,ne=null]=s(HP);if(H==="$")return{type:"var",name:j};if(o(X4)){let le=b();if(H==="-")return{type:"term",name:j,attr:ne,args:le};if(H4.test(j))return{type:"func",name:j,args:le};throw new SyntaxError("Function names must be all upper-case")}return H==="-"?{type:"term",name:j,attr:ne,args:[]}:{type:"mesg",name:j,attr:ne}}return V()}function b(){let H=[];for(;;){switch(e[t]){case")":return t++,H;case void 0:throw new SyntaxError("Unclosed argument list")}H.push(C()),o(e6)}}function C(){let H=h();return H.type!=="mesg"?H:o(Z4)?{type:"narg",name:H.name,value:V()}:H}function D(){let H=[],j=0,ne;for(;i(K4);){n("*")&&(ne=j);let le=S(),w=u();if(w===null)throw new SyntaxError("Expected variant value");H[j++]={key:le,value:w}}if(j===0)return null;if(ne===void 0)throw new SyntaxError("Expected default variant");return{variants:H,star:ne}}function S(){o(J4,SyntaxError);let H;return i(dT)?H=k():H={type:"str",value:a(U4)},o(Y4,SyntaxError),H}function V(){if(i(dT))return k();if(e[t]==='"')return T();throw new SyntaxError("Invalid expression")}function k(){let[,H,j=""]=s(dT),ne=j.length;return{type:"num",value:parseFloat(H),precision:ne}}function T(){n('"',SyntaxError);let H="";for(;;){if(H+=a(q4),e[t]==="\\"){H+=A();continue}if(n('"'))return{type:"str",value:H};throw new SyntaxError("Unclosed string literal")}}function A(){if(i(qP))return a(qP);if(i(zP)){let[,H,j]=s(zP),ne=parseInt(H||j,16);return ne<=55295||57344<=ne?String.fromCodePoint(ne):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function R(){let H=t;switch(o(t6),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return W(e.slice(H,t))}return e[t-1]===" "?W(e.slice(H,t)):!1}function P(H,j){return H.replace(j,"")}function W(H){let j=H.replace($4,`
`),ne=W4.exec(H)[1].length;return new JC(j,ne)}}},JC=class{constructor(e,t){this.value=e,this.length=t}};var i6=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],uo=class{constructor(e){this.value=e}},fm=class{constructor(e,t){this.bundles=e;this.onError=t}static fromSources(e,t,i){let n=[];for(let{lang:o,source:s}of e){let a=o.split("-")[0],l=new mb(o,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},i),{useIsolating:i6.indexOf(a)>=0}));l.addResource(new mm(s),{allowOverrides:!1}),l.addResource(new mm(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),n.push(l)}return new fm(n,t)}format(e,t){for(let i of this.bundles){if(!i.hasMessage(e))continue;let n=i.getMessage(e);if(!(n!=null&&n.value))return;let o=[],s=i.formatPattern(n.value,this.coerceNumericVariables(t),o);for(let a of o)this.onError(`Error formatting ${e} for locale ${i.locales.join(",")}: ${a}`);return s}this.onError(`Couldn't find message for key ${e} for locales ${this.getLocales().join(",")}`)}formatDate(e,t){return t.showYear?this.format("l10n-internal-date-day-month-year",{d:e}):this.format("l10n-internal-date-day-month",{d:e})}formatTime(e){let t=this.format("l10n-internal-time",{d:e});return this.getLocales()[0]==="en"?t==null?void 0:t.toLowerCase():t}hasTranslation(e,t){for(let i of this.bundles)if(i.locales.indexOf(t)>=0)return i.hasMessage(e);return!1}coerceNumericVariables(e){let t={};for(let i in e){let n=e[i];n instanceof uo?t[i]=n.value:typeof n=="number"?t[i]=`${n}`:t[i]=n}return t}getLocales(){return this.bundles.reduce((e,t)=>e.concat(t.locales),[])}};var YC="",uT={},jP={},pT={},n6=["ar","hy-AM","hi","tr","xx-XX"];function XC(r){YC=r||""}function hT(r){for(let e in r)delete pT[e],jP[e]=r[e]}function gT(r,e){let t=e!=null?e:YC;return YP(t).hasTranslation(r,t)}function Fa(r,e){if(e)for(var t in e)e.hasOwnProperty(t)&&(r=r.split("__"+t+"__").join(e[t]));return r}function pn(r,e,t){return JP(r,e!=null?e:{},t!=null?t:YC)}function bc(r){return function(t,i){return JP(t,i!=null?i:{},r())}}function o6(r){let e={};for(let t in r){let i=r[t];i!==void 0&&(e[t]=i)}return e}function JP(r,e,t){let n=YP(t).format(r,o6(e));return n==null?(__dcg_shared_module_exports__['k'].warn(`Could not format string ${r}`),""):n}function YP(r){let e=pT[r];if(!e){uT[r]||(uT[r]=$C([r]));let t=[];for(let n of uT[r]){let o=jP[n];o&&t.push({lang:n,source:o})}let i={};r==="xx-XX"&&(i.transform=n=>n.replace(/[a-z]/gi,"\u2666")),e=pT[r]=fm.fromSources([...t,{lang:"en",source:_P}],n=>{__dcg_shared_module_exports__['k'].warn(n)},i)}return e}function fb(){return YC}function mT(r){return ml.hasOwnProperty(r)||__dcg_shared_module_exports__['q'](n6,r)}function md(r,e){if(r==null)return"";if(typeof r=="string")return r;if(typeof r=="number")return""+r;let t=r.vars,i;if(t){i={};for(let n in t)t.hasOwnProperty(n)&&(i[n]=md(t[n],e))}return pn(r.key,i,e)}var fd={cb20221031:"1"};var yb=typeof desmosLocaleData=="object"?desmosLocaleData:{};function bb(){for(var r=$C([Ai("language"),navigator.userLanguage,navigator.language]),e=0;e<r.length;e++){var t=r[e];if(mT(t))return t}return"en"}async function ym(r){if(yb[r]||r==="en"||r==="xx-XX")return XC(r),!0;if(!mT(r)){let i=r.indexOf("-")!==-1?r.split("-")[0]:r;for(let n in ml)if(i===n.split("-")[0]&&ml[n].useAsRoot){r=n;break}}let e=await fetch(`/api/v1/calculator/language/${r}.ftl?${new URLSearchParams(fd)}`,{headers:{Accept:"application/json"}});if(!e.ok)throw e.status===404&&__dcg_shared_module_exports__['k'].warn(r+" is not an available language."),void 0;let t=await e.json();return yb[r]=t[r],hT(yb),XC(r),!0}function QC(r){return!!yb[r]}hT(yb);XC(bb());var fT={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisScale:"linear",yAxisScale:"linear",xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:"NONE",yAxisArrowMode:"NONE",xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,randomSeed:"",restrictGridToFirstQuadrant:!1,userLockedViewport:!1},XP={threeDMode:!0,worldRotation3D:[],axis3D:[0,0,1],speed3D:0,showPlane3D:!0,plane3dOpacity:"",backgroundColor3d:"#FFF",showAxis3D:!0,showAxisLabels3D:!0,showBox3D:!0},s6={squareAxes:!0},a6=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},XP),s6),{product:"graphing"});function QP(r){return r in XP}var Lh=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},fT),a6),ZP=Object.keys(fT);function e_(r){return r in fT}var bm=r=>isFinite(r)&&(r>0||r===0);var l6=0,c6="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",
yT=class{
    constructor(){
        this.__observers={},
        this.__eventObservers={},
        this.__oldProperties={},
        this.__propertyComparators={},
        this.guid=c6+ ++l6
    }
    unobserveAll(){
        this.__observers={},this.__eventObservers={}}getProperty(e){return this[e]}getOldProperty(e){return this.__oldProperties[e]}setProperty(e,t){var i=this[e];this[e]=t;var n=this.__propertyComparators[e];if(n){if(n(i,t))return}else if(__dcg_shared_module_exports__['G'](i,t))return;this.__oldProperties[e]=i,this.notifyPropertyChange(e)}setProperties(e){for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])}setPropertyComparator(e,t){this.__propertyComparators[e]=t}notifyPropertyChange(e){this.__callObservers(this.__observers,e,this)}observe(e,t){this.__addObservers(this.__observers,e,t)}unobserve(e){this.__removeObservers(this.__observers,e)}observeAndSync(e,t){this.observe(e,t);for(var i=e.split(" "),n=0;n<i.length;n++){var o=i[n].split("."),s=o[0];this.hasOwnProperty(s)&&t(s,this)}}triggerEvent(e,t){this.__callObservers(this.__eventObservers,e,t)}observeEvent(e,t){this.__addObservers(this.__eventObservers,e,t)}unobserveEvent(e){this.__removeObservers(this.__eventObservers,e)}__callObservers(e,t,i){var n=e[t];if(n)for(var o=0;o<n.length;o++)n[o].callback(t,i)}__removeObservers(e,t){for(var i=t.split(" "),n=0;n<i.length;n++){var o=i[n].split("."),s=o[0],a=o[1];if(s&&a){var l=e[s],c=[];if(!l)continue;for(var u=0;u<l.length;u++){var p=l[u];p.namespace!==a&&c.push(p)}e[s]=c}else if(s)delete e[s];else if(a)for(s in e)e.hasOwnProperty(s)&&this.__removeObservers(e,s+"."+a)}}__addObservers(e,t,i){for(var n=t.split(" "),o=0;o<n.length;o++){var s=n[o].split("."),a=s[0];if(!a)throw"Must supply a property to observe";var l=s[1],c={namespace:l,callback:i},u=e[a];u?u.push(c):e[a]=[c]}}},Wr=yT;var wc=class extends Wr{constructor(){super();this.highlightPropertyMultipliers={};this.stateProperties=[],this.cloneProperties=[],this.highlightPropertyMultipliers={},this.config=new Wr;for(var t in Lh)Lh.hasOwnProperty(t)&&this.addStateProperty(t,Lh[t]);this.labelHangingColor="rgba(150,150,150,1)",this.lastChangedAxis="x",this.addDynamicProperties()}addDynamicProperties(){var t=this;function i(o,s,a){t.cloneProperties.push(o);function l(){t.setProperty(o,t.config.projectorMode?a:s)}t.config.observe("projectorMode",l),l()}function n(o,s,a,l,c){t.cloneProperties.push(o);function u(){var g;t.config.projectorMode?g=t.highlight?c:l:g=t.highlight?a:s,t.setProperty(o,g)}var p=[s,a,l,c];t.highlightPropertyMultipliers[o]=p.map(function(g){return g/p[0]}),t.observe("highlight",u),t.config.observe("projectorMode",u),u()}i("labelSize",14,19),i("majorAxisOpacity",.4,1),i("minorAxisOpacity",.12,.25),i("axisOpacity",.9,.9),i("axisLineWidth",1.5,2),i("axisLineOffset",.25,0),i("pixelsPerLabel",80,120),n("curveOpacity",.7,1,.7,1),i("globalCurveColor",void 0,void 0),i("disableFill",!1,!1),n("graphLineWidth",2.5,3.5,5,7),n("pointLineWidth",9,11,15,17)}setController(t){this.controller=t,this.registerCallbacks()}getHighlightPropertyMultiplier(t,i){var n=i?1:0;return this.config.projectorMode?this.highlightPropertyMultipliers[t][2+n]:this.highlightPropertyMultipliers[t][n]}getFillOpacityMultiplier(){return this.highlight&&this.controller&&this.controller.isGeometry()?2:1}addStateProperty(t,i){this[t]=i,this.stateProperties.push(t),this.cloneProperties.push(t)}static fromObject(t){var i=new wc;return i.cloneProperties.forEach(function(n){t.hasOwnProperty(n)&&i.setProperty(n,t[n])}),i}registerCallbacks(){var t=()=>{var i;(i=this.controller)==null||i.requestRedrawGraph()};this.stateProperties.forEach(i=>{this.observe(i,t)}),this.config.observe("backgroundColor",t),this.config.observe("textColor",t),this.config.observe("invertedColors",t),this.observe("backgroundColor",t),this.observe("textColor",t),this.config.observe("enableTabindex",t),this.config.observeAndSync("projectorMode",t)}_validateSetting(t,i){var n;switch(t){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":n=Math.round(Math.min(Math.max(0,i),5)),i!==n&&__dcg_shared_module_exports__['k'].warn("minorSubdivisions must be an integer between 0 and 5. You provided "+i+", which we changed to "+n+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":n=i==="false"?!1:!!i,i!==n&&__dcg_shared_module_exports__['k'].warn(t+" must be a Boolean. You provided "+i+" ("+typeof i+"), which we changed to "+n+" ("+typeof n+").");break;case"xAxisStep":case"yAxisStep":n=parseFloat(i),isFinite(i)||(n=0,__dcg_shared_module_exports__['k'].warn(t+" must be a number. You provided "+i+", which we changed to "+n+"."));break;case"xAxisScale":case"yAxisScale":n=i,!this.config.logScales&&i==="logarithmic"?(n="linear",__dcg_shared_module_exports__['k'].warn("Must set logScales: true to set "+t+" to 'logarithmic'.")):i!=="linear"&&i!=="logarithmic"&&(n="linear",__dcg_shared_module_exports__['k'].warn(t+' must be "linear" or "logarithmic". You provided '+i+", which we changed to "+n+"."));break;case"xAxisArrowMode":case"yAxisArrowMode":n=__dcg_shared_module_exports__['N'][i],n!==i&&(n="NONE",__dcg_shared_module_exports__['k'].warn(`unknown AxisArrowMode. Allowed values are:
`+__dcg_shared_module_exports__['D'](__dcg_shared_module_exports__['N']).join(`
`)));break;case"xAxisLabel":case"yAxisLabel":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['k'].warn(t+" must be a string. you provided a "+typeof i+"."));break;case"randomSeed":n=i,typeof i!="string"&&(n=""+i,__dcg_shared_module_exports__['k'].warn("randomSeed must be a string. you provided a "+typeof i+"."));break;case"backgroundColor":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['k'].warn(t+" must be a string. you provided a "+typeof i+".")),n||(n="#fff"),n[0]!=="#"&&(n="#"+n);break;case"textColor":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['k'].warn(t+" must be a string. you provided a "+typeof i+".")),n||(n="#000"),n[0]!=="#"&&(n="#"+n);break;case"fontSize":n=i,typeof i!="number"&&(n=parseInt(n,10),__dcg_shared_module_exports__['k'].warn("fontSize must be a number. Attempted to convert "+i+" to "+n+"."));break;case"language":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['k'].warn(t+" must be a string. you provided a "+typeof i+".")),i!=="en"&&!QC(i)&&(n="en",__dcg_shared_module_exports__['k'].warn(i+" is not currently an available language."));break;default:n=i;break}return n}validateSettings(t){var i={},n=!1;for(var o in t)this.stateProperties.indexOf(o)>=0?i[o]=this._validateSetting(o,t[o]):(__dcg_shared_module_exports__['k'].warn('Invalid graph setting "'+o+'".'),n=!0);return n&&__dcg_shared_module_exports__['k'].warn(`Available graph settings are: 
`+this.stateProperties.join(`
`)),i}getBackgroundColor(){var t=__dcg_shared_module_exports__['O'](this.config.backgroundColor||"#fff");return this.config.invertedColors&&t!=="#ffffff"?__dcg_shared_module_exports__['R'](t):t}getTextColor(){var t=__dcg_shared_module_exports__['O'](this.config.textColor||"#000");return this.config.invertedColors&&t!=="#000000"?__dcg_shared_module_exports__['R'](t):t}};ct();function t_(r,e){var t=__dcg_shared_module_exports__['la'](r),i=__dcg_shared_module_exports__['la'](e);if(__dcg_shared_module_exports__['ba'](t.n/t.d,r)&&__dcg_shared_module_exports__['ba'](i.n/i.d,e)){var n=__dcg_shared_module_exports__['na'](t.d,i.d),o=t.n*(n/t.d),s=i.n*(n/i.d),a=s-o;return{nstart:o,nstep:a,lcm:n}}}var r_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function wT(r){let e=[],t=r.toLowerCase();if(t.slice(0,3)==="rgb")try{e=t.replace(/[^\d,]/g,"").split(",").slice(0,3).map(function(n){return parseInt(n,10)})}catch(n){bT(r)}else if(t[0]==="#"){var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/;t=t.replace(i,function(n,o,s,a){return o+o+s+s+a+a});try{e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(t).slice(1).map(function(n){return parseInt(n,16)})}catch(n){bT(r)}}else e=r_[t];return d6(e)||bT(r),{R:e[0],G:e[1],B:e[2]}}function d6(r){return!__dcg_shared_module_exports__['I'](r)||r.length!==3?!1:__dcg_shared_module_exports__['o'](r,function(e){return Number.isInteger(e)&&e>=0&&e<=255})}function bT(r){throw new Error("Invalid color string: "+r)}function i_(r){var e=r.R/255,t=r.G/255,i=r.B/255,n=[];return n[0]=.49*e+.31*t+.2*i,n[1]=.17697*e+.8124*t+.01063*i,n[2]=.01*t+.99*i,n=__dcg_shared_module_exports__['m'](n,function(o){return o/.17697}),{X:n[0],Y:n[1],Z:n[2]}}function n_(r){var e=95.047,t=100,i=108.883,n=r.X,o=r.Y,s=r.Z,a=[];return a[0]=116*xb(o/t)-16,a[1]=500*(xb(n/e)-xb(o/t)),a[2]=200*(xb(o/t)-xb(s/i)),{L:a[0],a:a[1],b:a[2]}}function xb(r){var e=.20689655172413793;return r>Math.pow(e,3)?Math.pow(r,1/3):r/(3*e*e)+4/29}function u6(r,e){var t=1,i=.045,n=.015,o=1,s=1,a=1,l=r.L,c=r.a,u=r.b,p=e.L,g=e.a,h=e.b,b=l-p,C=Math.sqrt(c*c+u*u),D=Math.sqrt(g*g+h*h),S=C-D,V=c-g,k=u-h,T=Math.sqrt(V*V+k*k-S*S),A=1+i*C,R=1+n*C,P=b/(t*a),W=S/(o*A),H=T/(s*R);return Math.sqrt(P*P+W*W+H*H)}function p6(r,e){var t=n_(i_(wT(r))),i=n_(i_(wT(e)));return u6(t,i)}function o_(r,e){var t=__dcg_shared_module_exports__['m'](e,function(n){return p6(r,n)}),i=__dcg_shared_module_exports__['t'](t);return e[t.indexOf(i)]}function h6({R:r,G:e,B:t}){return .2126729*(r/255)**2.4+.7151522*(e/255)**2.4+.072175*(t/255)**2.4}var xT=.342;function vT(r,e=!1,t=xT){if(typeof r!="string"||!r)return!1;try{let i=wT(r);return h6(i)>t?!e:e}catch(i){return!1}}function Si(r,e){var t=/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/;if(t.test(r))return parseFloat(r);var i=Object.create(__dcg_shared_module_exports__['Nb']);return i.trigAngleMultiplier=new __dcg_shared_module_exports__['Bb'](e?Math.PI/180:1),+__dcg_shared_module_exports__['gc'](r).tryGetConcreteTree(__dcg_shared_module_exports__['Ob'],i).asValue()}function Li(r,e){if(!isFinite(r))return r;if(!isFinite(e))return e;var t=__dcg_shared_module_exports__['Y'](r,e);if(r>0!=e>0||r===0||e===0)return 0;var i=r>0?1:-1,n=Math.abs(r).toExponential().split("e"),o=Math.abs(e).toExponential().split("e"),s=n[0],a=o[0],l=n[1],c=o[1];if(c!==l)return i*Math.pow(10,Math.max(parseFloat(l),parseFloat(c)));if(s[0]!==a[0])return parseFloat(t.toPrecision(1));for(var u=1,p=2;p<Math.min(s.length,a.length)&&(u++,s[p]===a[p]);p++);return parseFloat(t.toPrecision(u))}function g6(r){return __dcg_shared_module_exports__['ea'](r)!==null}var wm=g6;function vb(r){let e=__dcg_shared_module_exports__['gc'](r);if(e.type!=="Assignment")return NaN;if(e._expression.type!=="Constant")return NaN;if(!new __dcg_shared_module_exports__['nc']({enableGeometry:!1,enable3d:!0,beta3d:!0,scales:void 0}).validLHS(e._symbol))return NaN;if(__dcg_shared_module_exports__['Nb'][e._symbol])return NaN;let i=e._expression.asValue();return typeof i=="number"?i:NaN}function m6(r){return r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}function f6(r){return r.replace(/\\\\right\\(\\*[})\]|])/g,".*\\\\right\\$1").replace(/ ?\\([}\]])/g,".*\\$1")}function c_(r){let e=f6(m6(r));return new RegExp(e)}function y6(r){switch(r.type){case"TokenNode":case"Letter":return!0;case"OperatorName":{for(let e of r.arg.args)if(e.type!=="Letter")return!1;return!0}case"Cmd":{let e=__dcg_shared_module_exports__['dc'][r.val];return e===void 0?!0:e==="Ln"||e==="Log"||e==="Trig"}default:return!1}}function CT(r){let e;try{e=__dcg_shared_module_exports__['$b'](r)}catch(n){return}if(e.args.length===0||e.args.length>2)return;let t=e.args[0];if(!y6(t))return;let i;if(e.args.length>1){let n=e.args[1];if(n.type!=="SupSub")return;let{sup:o,sub:s}=n;if(o!==void 0||s===void 0)return;for(let a of s.args)if(a.type!=="Letter"&&a.type!=="Digit")return;i=s}return{base:t,subscript:i}}function ga(r){return CT(r)!==void 0}function d_(r){let e=__dcg_shared_module_exports__['$b'](r),t=__dcg_shared_module_exports__['fc'](e);switch(t.type){case"Letter":return t.val;case"Cmd":return t.val;default:return}}function a_(r){return r.replace(/^(\\? )+|(\\? )+$/g,"")}function u_(r){try{let e=__dcg_shared_module_exports__['$b'](r),t=__dcg_shared_module_exports__['fc'](e);if(t.type==="Equals"&&(t=t.args[1]),t.type==="Call"){let i=t.args[1];return i.type==="Seq"?i.args:[i]}return}catch(e){return}}function Db(r){let e=r.indexOf("=");if(e===-1)return;let t=a_(r.slice(0,e));if(ga(t))return t;try{let i=__dcg_shared_module_exports__['$b'](`${t}=0`),n=__dcg_shared_module_exports__['fc'](i);if(n.type==="Equals"&&__dcg_shared_module_exports__['ec'](n.args[0])){let o=r.indexOf("\\left(");if(o===-1&&(o=r.indexOf("(")),o===-1)return;let s=a_(r.slice(0,o));if(ga(s))return s}}catch(i){}}function ZC(r,e){let t=CT(e);if(t===void 0)return[];let i=[],n;try{n=__dcg_shared_module_exports__['$b'](r)}catch(o){return i}return Cb(n,t,i,{wrapInBraces:!1}),i}function xc(r,e){return ZC(r,e).length!==0}function eD(r,e,t){return CT(t)===void 0?r:DT(r,e,t)}function DT(r,e,t){let i=ZC(r,e);if(i.length===0)return r;let n="",o=0;for(let s of i){if(n+=r.slice(o,s.base.start),s.wrapInBraces&&(n+="{"),n+=t,o=s.base.end,s.subscript){let a=0,l=0;for(let c=s.subscript.start;c>=0;c--)if(r[c]==="{"&&(a+=1),r[c]==="_"){l=c;break}n+=r.slice(o,l),o=s.subscript.end;for(let c=s.subscript.end;c<r.length&&!(a<=0);c++)r[c]==="}"&&(a-=1,o=c+1)}s.wrapInBraces&&(n+="}")}return n+=r.slice(o,r.length),n}function l_(r,e){if(r.args.length!==e.args.length)return!1;for(let t=0;t<r.args.length;t++){let i=r.args[t],n=e.args[t];if(!(i.type==="Letter"&&n.type==="Letter"&&i.val===n.val)&&!(i.type==="Digit"&&n.type==="Digit"&&i.val===n.val))return!1}return!0}function b6(r,e,t){let i=r.arg.args,n=e.arg.args;if(i.length===n.length){for(let o=0;o<i.length;o++){let s=i[o],a=n[o];if(s.type!=="Digit"||s.type!==a.type||s.val!==a.val)return}t.push({base:e.span,wrapInBraces:!1})}}function Cb(r,e,t,{wrapInBraces:i}){let{base:n,subscript:o}=e;for(let s=0;s<r.args.length;s++){let a=r.args[s],l;if(s+1<r.args.length){let c=r.args[s+1];c.type==="SupSub"&&c.sub!==void 0&&(l=c.sub)}switch(a.type){case"Letter":case"Cmd":if(n.type!==a.type||n.val!==a.val)break;o&&l&&l_(o,l)?t.push({base:a.span,subscript:l.span,wrapInBraces:i}):!o&&!l&&t.push({base:a.span,wrapInBraces:i});break;case"OperatorName":{if(n.type!==a.type||n.arg.args.length!==a.arg.args.length)break;let c=!0;for(let u=0;u<n.arg.args.length;u++){let p=n.arg.args[u],g=a.arg.args[u];if(p.type!=="Letter"||g.type!=="Letter"||p.val!==g.val){c=!1;break}}if(!c)break;o&&l&&l_(o,l)?t.push({base:a.span,subscript:l.span,wrapInBraces:i}):!o&&!l&&t.push({base:a.span,wrapInBraces:i});break}case"Digit":case"Symbol":case"EscapedSymbol":break;case"LeftRight":case"Sqrt":Cb(a.arg,e,t,{wrapInBraces:!1});break;case"Frac":Cb(a.num,e,t,{wrapInBraces:!1}),Cb(a.den,e,t,{wrapInBraces:!1});break;case"SupSub":if(a.sup){let c=!1;for(let u=a.sup.span.start;u>=0;u--){let p=a.sup.span.input[u];if(p==="^")break;p==="{"&&(c=!0)}Cb(a.sup,e,t,{wrapInBraces:!c})}break;case"TokenNode":{if(n.type!==a.type)break;b6(n,a,t)}break;default:{let c=a;throw new Error("Unexpected token type: "+c.type)}}}}function ET(r){return r===void 0?NaN:+r}function xp(r){return!!r&&r.type==="expression"&&!!r.formula&&!!r.formula.typed_constant_value&&!!r.formula.geometry}var g_={smallCutoff:1e-6,bigCutoff:1e9,digits:12};function m_(r){let e=r.formula;return e?r.controller.isDecimalToFractionEnabled()&&e.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['Eb'](ET(e.constant_value)):!1}function Nl(r){return!!(r.formula&&r.formula.is_graphable)}function kT(r){let e=r.formula;if(!e)return!1;let t=e.is_evaluable&&e.zero_values&&e.zero_values.length>0&&typeof e.zero_values[0].val!="boolean",i=m_(r)&&vp(r),n=!!e.rgb_value&&r.formula.assignment;return t||i||n}function GT(r){let e=r.formula;return kT(r)?e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.rgb_value?e.rgb_value:e.constant_value:m_(r)?r.formula.constant_value:NaN}function xm(r){var e=r.formula.ttest_results;if(!(!e||!isFinite(e.lessThan)))return{lessThan:e.lessThan,greaterThan:e.greaterThan,notEqual:e.notEqual}}function vm(r){var e=r.formula.stats_results;if(!(!e||!isFinite(e.min)))return{min:e.min,q1:e.q1,median:e.median,q3:e.q3,max:e.max}}function bp(r,e){if(!isFinite(e))return r;let t=r.indexOf("=")+1;return Si(r.slice(t),!1)===e?r:r.slice(0,t)+__dcg_shared_module_exports__['lc'](e)}function Na(r){var e=r.latex||"",t=r.label||"",i=e+t;return i.split(" ").join("")===""}function rn(r,e={isReverseDrag:!1}){let t=r.dragMode==="AUTO"&&r.formula.default_drag_mode!==void 0?r.formula.default_drag_mode:r.dragMode;return r.controller.isThreeDMode()&&(t="NONE"),r.dragMode==="AUTO"&&!e.isReverseDrag&&Ba(r)&&(t="NONE"),__dcg_shared_module_exports__['La'](t,r.formula.move_strategy)}function x6(r){let e=rn(r);r.interactiveLabel&&e!=="NONE"&&Kb(r,!1)}function Rl(r,e,t){if(!r.sliderExists)return NaN;let i=yl(r),n=vc(r),o=Bl(r);if(t&&t.overwriteStep!==void 0&&(o=t.overwriteStep),e=__dcg_shared_module_exports__['Sb']({target:e,hardMin:r.slider.hardMin?i:void 0,hardMax:r.slider.hardMax?n:void 0,step:o}),!t||!t.ignoreSoftLimits){if(!r.slider.hardMin&&e<i)return i;if(!r.slider.hardMax&&e>n)return n}return e}function IT(r,e,t={}){if(!r.sliderExists)return NaN;let i=ma(r),n=yl(r),o=vc(r),s=Bl(r);t.overwriteStep===void 0&&(t.overwriteStep=s||(o-n)/20);var a=0;switch(e){case"min":return Rl(r,n);case"max":return Rl(r,o);case"up":a=1;break;case"down":a=-1;break;case"bigup":a=5;break;case"bigdown":a=-5;break;default:return e}let l=i;for(var c=0;c<20;c++){let u=c/3*t.overwriteStep,p=i;if(a>0)i=Rl(r,l+u,t),i>p&&(a-=1);else if(a<0)i=Rl(r,l-u,t),i<p&&(a+=1);else break}return i}function tD(r,e){if(r.sliderExists){r.slider.isPlaying&&Ka(r,!1);var t=Rl(r,e,{ignoreSoftLimits:!0});r.latex=bp(r.latex,t)}}function f_(r,e,t){if(r.sliderExists){r.slider.isPlaying&&Ka(r,!1),Sm(r);var i=IT(r,e,t);r.latex=bp(r.latex,i)}}function y_(r,e){if(r.sliderExists){r.slider.isPlaying&&Ka(r,!1);var t=Rl(r,e);r.latex=bp(r.latex,t)}}function b_(r,e){if(!r.sliderExists||r.resetSliderAnimationTargetValue)return;var t=r.sliderLastTickTime;if(r.sliderLastTickTime=e,t===void 0)return;var i=e-t;let n=yl(r),o=vc(r),s=Bl(r),a=r.slider.animationPeriod,l=r.slider.loopMode;if(isNaN(r.sliderAnimationTargetValue)){var c=ma(r);isNaN(c)||(r.sliderAnimationTargetValue=c)}var u=s?s/2:0;if(l==="LOOP_FORWARD_REVERSE")r.sliderAnimationTargetValue>=o?cs(r,{playDirection:-1}):r.sliderAnimationTargetValue<=n&&cs(r,{playDirection:1});else if(l==="LOOP_FORWARD")cs(r,{playDirection:1}),r.sliderAnimationTargetValue>=o+u&&(r.sliderAnimationTargetValue=n-u);else if(l==="PLAY_ONCE")cs(r,{playDirection:1});else if(l==="PLAY_INDEFINITELY")cs(r,{playDirection:1});else throw new Error("Unexpected slider loop mode: "+l);isFinite(i)||(i=0);var p,g;if(l==="PLAY_INDEFINITELY")p=i/(a/4),s&&(p*=s),r.sliderAnimationTargetValue+=p,g=r.sliderAnimationTargetValue,s||(g=Li(g-p*.1,g+p*.1)),g=Rl(r,g,{ignoreSoftLimits:!0}),r.latex=bp(r.latex,g);else{if(i=Math.min(i,a/10),p=(o-n)*i/a,r.sliderAnimationTargetValue+=p*r.slider.playDirection,r.sliderAnimationTargetValue=Math.max(n-u,Math.min(o+u,r.sliderAnimationTargetValue)),g=r.sliderAnimationTargetValue,!s){let h=p/i*16.666666666666668;g=Li(g-h*.1,g+h*.1)}g=Rl(r,g),r.latex=bp(r.latex,g)}}function rD(r){let e=r.formula;return e?e.is_single_identifier?[]:e.variables||[]:[]}function VT(r,e){r.formula=e,r.error=e.error,r.unresolved=!1,e.is_slider?(!r.sliderExists||r.resetSliderAnimationTargetValue)&&(r.sliderAnimationTargetValue=ma(r),r.sliderDragging=!1,r.sliderExists=!0):r.sliderExists=!1,r.resetSliderAnimationTargetValue=!1;var t={};e.is_regression&&(t=e.regression.parameters,r.residualVariable=e.regression.residualVariable,r.controller.areLogModeRegressionsForced()&&(r.isLogModeRegression=!0)),__dcg_shared_module_exports__['G'](r.regressionParameters,t)||(r.regressionParameters=t)}function v6(r){if(r.shouldGraph=!Ba(r),r.folderId===__dcg_shared_module_exports__['Jc']){let e=r.controller.getExpressionIdForIdentifier(r.controller.getHoveredTokenIdentifier())===r.id,t=r.controller.isItemSelected(r.id);(e||t||r.controller.getGhostMode())&&(r.shouldGraph=!0)}}function Ba(r){var t;if(!r)return!1;if(r.hidden)return!0;if((t=r==null?void 0:r.formula)!=null&&t.expression_type&&Rh(r))return!0;let e=Ua(r);return!!(e&&e.hidden)}function C6(r){let e=r.formula&&r.formula.raw_slider_latex;if(!r.sliderExists||r.latex!==e){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let{latex:t}=r;if(r.cachedDisplayLatex.storedLatex!==t){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let i=v_(r);if(isFinite(i)){let n=r.controller.getFocusLocation();n&&n.type==="expression"&&n.id===r.id||(r.cachedDisplayLatex.valueLatex=bp(r.latex,i))}}function Eb(r){return r.cachedDisplayLatex.valueLatex}function w_(r){return __dcg_shared_module_exports__['Cb'](r).latex}function iD(r){return r.slider.hardMin?r.slider.min:w_(yl(r))}function x_(r){return r.slider.hardMax?r.slider.max:w_(vc(r))}function yl(r){if(r.slider.hardMin){let e=r.formula.slider_min_number;return isFinite(e)?e:NaN}else{let e=r.controller.isDegreeMode(),t=Si(r.slider.min,e),i=ma(r),n=Bl(r),o=r.slider.hardMax?r.formula.slider_max_number:void 0,s=-10;if(t<s&&(s=t),i<s&&(s=i),o<s&&(s=o),n){let a=__dcg_shared_module_exports__['Sb']({target:s,hardMin:void 0,hardMax:o,step:n});a<=s?s=a:s=a-n}return s}}function vc(r){if(r.slider.hardMax){let e=r.formula.slider_max_number;return isFinite(e)?e:NaN}else{let e=r.controller.isDegreeMode(),t=Si(r.slider.max,e),i=ma(r),n=Bl(r),o=r.slider.hardMin?r.formula.slider_min_number:void 0;return __dcg_shared_module_exports__['Tb']({storedMax:t,sliderValue:i,step:n,hardMin:o})}}function Bl(r){return r.formula.slider_step_number}function v_(r){if(!r.formula||!r.formula.is_slider)return;let e=r.formula.constant_value;if(e!==void 0)return+e}function ma(r){let e=r.formula&&r.formula.raw_slider_latex;if(r.latex!==e)return vb(r.latex);let t=v_(r);return isFinite(t)?t:NaN}function TT(r){return r.slider.loopMode!=="PLAY_ONCE"?!1:ma(r)>=vc(r)}function C_(r,e){return r.formula.viz_valids?!!r.formula.viz_valids[e]:!1}function hu(r,e){return r.vizProps[e]}function D_(r,e,t){r.vizProps=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.vizProps),{[e]:t})}function S_(r,e,t){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{[e]:t})}function nD(r,e){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{latex:e})}function fa(r){var e;return!!(r.clickableInfo.enabled&&YT(r)&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}function E_(r){return!!r.__workerNeedsDotplotXMode}function oD(r){return!!(r.formula&&r.formula.slider_min_valid)}function sD(r){return!!(r.formula&&r.formula.slider_max_valid)}function aD(r){return!!(r.formula&&r.formula.slider_step_valid)}function k_(r){if(!r.formula)return NaN;if(r.formula.expression_type==="SURFACE_xyz_uv"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"||r.formula.expression_type==="SURFACE_z_r\u03B8")return 0;if(Cp(r)&&isFinite(r.__workerSampledDomainMin))return r.__workerSampledDomainMin;let e=r.formula.domain_min_number;return isFinite(e)?e:NaN}function G_(r,e=""){if(!r.formula)return NaN;if(r.formula.expression_type==="SURFACE_xyz_uv")return 1;if(r.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"){if(e==="\\theta")return Math.PI*2;if(e==="\\phi")return Math.PI}if(r.formula.expression_type==="SURFACE_z_r\u03B8"){if(e==="r")return 10;if(e==="\\theta")return Math.PI*2}if(Cp(r)&&isFinite(r.__workerSampledDomainMax))return r.__workerSampledDomainMax;let t=r.formula.domain_max_number;return isFinite(t)?t:NaN}function I_(r,e){switch(e){case"u":return!!(r.formula&&r.formula.domain_min_u_valid);case"r":return!!(r.formula&&(Ra(r)&&r.formula.domain_min_u_valid||r.formula.domain_min_valid));case"\\theta":return!!(r.formula&&(bl(r)&&r.formula.domain_min_u_valid||Ra(r)&&r.formula.domain_min_v_valid||r.formula.domain_min_valid));case"v":case"\\phi":return!!(r.formula&&r.formula.domain_min_v_valid)}return!!(r.formula&&r.formula.domain_min_valid)}function V_(r,e){switch(e){case"u":return!!(r.formula&&r.formula.domain_max_u_valid);case"r":return!!(r.formula&&(Ra(r)&&r.formula.domain_max_u_valid||r.formula.domain_max_valid));case"\\theta":return!!(r.formula&&(bl(r)&&r.formula.domain_max_u_valid||Ra(r)&&r.formula.domain_max_v_valid||r.formula.domain_max_valid));case"v":case"\\phi":return!!(r.formula&&r.formula.domain_max_v_valid)}return!!(r.formula&&r.formula.domain_max_valid)}function Ph(r,e){var t=r.cachedViewState;if((!e.stripDefaults||r.parametricDomain.min!==""||r.parametricDomain.max!=="")&&(t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{domain:{min:r.parametricDomain.min===""?"0":r.parametricDomain.min,max:r.parametricDomain.max===""?"1":r.parametricDomain.max}})),e.stripDefaults)return __dcg_shared_module_exports__['Pc'](t);if(t.points===void 0||t.lines===void 0||t.fill===void 0||t.surfaces===void 0){let i=__dcg_shared_module_exports__['j'](t);return i.points===void 0&&delete i.points,i.lines===void 0&&delete i.lines,i.fill===void 0&&delete i.fill,i.surfaces===void 0&&delete i.surfaces,i}return t}function D6(r){let e=r.cachedViewState;e&&__dcg_shared_module_exports__['Rc'](e,r)&&e.folderId===r.folderId&&e.color===r.color&&e.latex===r.latex&&e.showLabel===r.showLabel&&e.showAngleLabel===r.showAngleLabel&&e.label===r.label&&e.hidden===r.hidden&&e.secret===r.secret&&e.readonly===r.readonly&&e.fill===r.fill&&e.points===r.points&&e.lines===r.lines&&e.surfaces===r.surfaces&&e.lineStyle===r.lineStyle&&e.arrowMode===r.arrowMode&&e.pointStyle===r.pointStyle&&e.dragMode===r.dragMode&&e.labelSize===r.labelSize&&e.labelOrientation===r.labelOrientation&&e.suppressTextOutline===r.suppressTextOutline&&e.interactiveLabel===r.interactiveLabel&&e.editableLabelMode===r.editableLabelMode&&e.residualVariable===r.residualVariable&&e.regressionParameters===r.regressionParameters&&e.isLogModeRegression===r.isLogModeRegression&&e.displayEvaluationAsFraction===r.displayEvaluationAsFraction&&e.slider===r.slider&&e.strictIntersection===r.strictIntersection||(r.cachedViewState=__dcg_shared_module_exports__['a']({type:r.type,id:r.id,folderId:r.folderId,color:r.color,latex:r.latex,showLabel:r.showLabel,showAngleLabel:r.showAngleLabel,label:r.label,hidden:r.hidden,secret:r.secret,readonly:r.readonly,points:r.points,lines:r.lines,surfaces:r.surfaces,lineStyle:r.lineStyle,arrowMode:r.arrowMode,pointStyle:r.pointStyle,fill:r.fill,dragMode:r.dragMode,labelSize:r.labelSize,labelOrientation:r.labelOrientation,suppressTextOutline:r.suppressTextOutline,interactiveLabel:r.interactiveLabel,editableLabelMode:r.editableLabelMode,residualVariable:r.residualVariable,regressionParameters:r.regressionParameters,isLogModeRegression:r.isLogModeRegression,displayEvaluationAsFraction:r.displayEvaluationAsFraction,slider:r.slider,strictIntersection:r.strictIntersection},__dcg_shared_module_exports__['Qc'](r)))}function MT(r,e){e&&Sm(r),r.draggingOnGraphpaper=e}function S6(r){var e=r.memoizedUndoRedoStateParams,t=r.cachedViewState,i=r.preTransientState;if(r.cachedUndoRedoFullState=t,e&&e.viewState===t&&e.preTransientState===i)return;r.memoizedUndoRedoStateParams={viewState:t,preTransientState:i};let n;i?n=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{latex:i.latex,slider:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t.slider),i.slider)}):n=__dcg_shared_module_exports__['a']({},t),delete n.regressionParameters,delete n.residualVariable,r.cachedUndoRedoDiffState=n}function lD(r,e){let t=__dcg_shared_module_exports__['j'](__dcg_shared_module_exports__['Oc'](r)),{color:i}=t;return(!i||!wm(i))&&(i=e.getNextColor()),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),xd(e)),{labelDropdownOpen:!1,formula:{error:void 0,operator:"=",variables:[]},error:void 0,unresolved:!1,color:i,pointStyle:t.pointStyle,lineStyle:t.lineStyle,arrowMode:t.arrowMode,displayEvaluationAsFraction:t.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,resetSliderAnimationTargetValue:!1,sliderLastTickTime:void 0,draggingOnGraphpaper:!1,cachedUndoRedoDiffState:void 0,cachedUndoRedoFullState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}})}function E6(r){let e=Ua(r),t=!!(e&&e.hidden),i=r.cachedViewState,n=r.index,o=r.showLabel&&!t,s=r.showAngleLabel,a=r.shouldGraph,l=r.memoizedParsableStateParams;if(l&&l.viewState===i&&l.index===n&&l.showLabel===o&&l.showAngleLabel===s&&l.shouldGraph===a)return;r.memoizedParsableStateParams={viewState:i,index:n,showLabel:o,showAngleLabel:s,shouldGraph:a};let c=__dcg_shared_module_exports__['Sc'](i);c.index=n,c.showLabel=o,c.showAngleLabel=s,c.shouldGraph=a,c.isInConstructionsFolder=r.folderId===__dcg_shared_module_exports__['Jc'],r.cachedParsableState=c}function cD(r,e){e(r.latex,"latex"),e(r.clickableInfo.latex,"clickableInfoLatex"),e(r.lineWidth,"lineWidth"),e(r.fillOpacity,"fillOpacity"),e(r.lineOpacity,"lineOpacity"),e(r.pointOpacity,"pointOpacity"),e(r.pointSize,"pointSize"),e(r.labelSize,"labelSize"),e(r.labelAngle,"labelAngle"),e(r.colorLatex,"colorLatex"),mu(r)&&(e(r.parametricDomain.min,"parametricDomainMin"),e(r.parametricDomain.max,"parametricDomainMax")),(vD(r)||bl(r))&&(e(r.parametricDomain3Du.min,"parametricDomain3DuMin"),e(r.parametricDomain3Du.max,"parametricDomain3DuMax"),e(r.parametricDomain3Dv.min,"parametricDomain3DvMin"),e(r.parametricDomain3Dv.max,"parametricDomain3DvMax")),(Cp(r)||Tm(r))&&(e(r.polarDomain.min,"polarDomainMin"),e(r.polarDomain.max,"polarDomainMax")),(HT(r)||UT(r))&&e(r.resolution,"resolution"),wd(r)&&(e(r.cdf.min,"cdfMin"),e(r.cdf.max,"cdfMax")),r.sliderExists&&(e(r.slider.min,"sliderMin"),e(r.slider.max,"sliderMax"),e(r.slider.step,"sliderStep")),r.residualVariable&&e(r.residualVariable,"residualVariable")}function po(r){return r.formula&&r.formula.assignment}function AT(r){return r.formula&&r.formula.shader}function jo(r){let e=r.cachedAssignmentOrFunctionName;if(e&&e.latex===r.latex)return e.result;let t=Db(r.latex),i=t?{latex:t,identifier:__dcg_shared_module_exports__['Kb'](t)}:void 0;return r.cachedAssignmentOrFunctionName={latex:r.latex,result:i},i}function T_(r){let e=r.cachedFunctionCallArgumentsLatex;if(e&&e.latex===r.latex)return e.parsedArgs;let t=u_(r.latex);return r.cachedFunctionCallArgumentsLatex={latex:r.latex,parsedArgs:t},t}function M_(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;return e==null?!1:__dcg_shared_module_exports__['vb'](e)}function LT(r){var i;let e=(i=jo(r))==null?void 0:i.latex;var t=e==null?void 0:e.match(/^(\\token\{\d+\})$/);if(t)return t[1]}function A_(r){var i,n;let e=(n=(i=r.formula)==null?void 0:i.typed_constant_value)==null?void 0:n.valueType,t=!1;if(e&&__dcg_shared_module_exports__['vb'](e)&&(t=!0,e=__dcg_shared_module_exports__['wb'](e)),e==null||!__dcg_shared_module_exports__['xb'](e))return"U";switch(e){case __dcg_shared_module_exports__['Ra']:return t?"P":"p";case __dcg_shared_module_exports__['$a']:case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['fb']:return t?"L":"l";case __dcg_shared_module_exports__['pb']:return t?"V":"v";case __dcg_shared_module_exports__['db']:case __dcg_shared_module_exports__['bb']:return t?"C":"c";case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['lb']:return t?"A":"a";case __dcg_shared_module_exports__['Za']:return"P";case __dcg_shared_module_exports__['nb']:return"T";default:return e}}function k6(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['vb'](e)&&(e=__dcg_shared_module_exports__['wb'](e)),!__dcg_shared_module_exports__['xb'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['Ra']:return"point";case __dcg_shared_module_exports__['$a']:return"segment";case __dcg_shared_module_exports__['hb']:return"ray";case __dcg_shared_module_exports__['fb']:return"line";case __dcg_shared_module_exports__['pb']:return"vector";case __dcg_shared_module_exports__['db']:return"arc";case __dcg_shared_module_exports__['bb']:return"circle";case __dcg_shared_module_exports__['jb']:return"angle";case __dcg_shared_module_exports__['lb']:return"directedangle";case __dcg_shared_module_exports__['Za']:return"polygon";case __dcg_shared_module_exports__['nb']:return"transformation";default:return e}return"unknown"}function OT(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['vb'](e)&&(e=__dcg_shared_module_exports__['wb'](e)),!__dcg_shared_module_exports__['xb'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['Ra']:return"point";case __dcg_shared_module_exports__['$a']:case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['fb']:case __dcg_shared_module_exports__['pb']:return"line";case __dcg_shared_module_exports__['db']:return"arc";case __dcg_shared_module_exports__['bb']:return"circle";case __dcg_shared_module_exports__['jb']:return"angle";case __dcg_shared_module_exports__['lb']:return"directedangle";case __dcg_shared_module_exports__['Za']:return"polygon";case __dcg_shared_module_exports__['nb']:return"transformation";default:return e}return"unknown"}function L_(r){return r.indexOf("\\token{")!==-1}function O_(r){var t,i;let e=(i=(t=r.formula.geometry)==null?void 0:t.call)==null?void 0:i.symbol;return e&&e!=="apply"?e:k6(r)}function G6(r){return!!(r.sliderExists&&(r.slider.isPlaying||r.sliderDragging)||r.draggingOnGraphpaper)}function P_(r){return!!(r.sliderExists&&r.sliderDragging||r.draggingOnGraphpaper)}function PT(r){var e=G6(r);e?r.preTransientState||(r.preTransientState={latex:r.latex,slider:{min:r.slider.min,max:r.slider.max,playDirection:r.slider.playDirection}}):delete r.preTransientState,(!r.sliderExists||!r.slider.isPlaying)&&(r.sliderLastTickTime=void 0),vd(r),v6(r),x6(r),D6(r),S6(r),E6(r),C6(r)}var I6=__dcg_shared_module_exports__['a']({id:!1,type:!1,color:!0,folderId:!0,latex:!0,showLabel:!0,showAngleLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,points:!0,lines:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,fill:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,suppressTextOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,angleType:!0,showAngleDirection:!0},__dcg_shared_module_exports__['Gc'](__dcg_shared_module_exports__['Lc']));function __(r,e){__dcg_shared_module_exports__['Dc']({from:e,to:r,props:I6}),r.resetSliderAnimationTargetValue=!0,r.sliderAnimationTargetValue=void 0}function Cm(r,e){e?cs(r,{hardMin:!0,min:e}):cs(r,{hardMin:!1,min:"-10"})}function Dm(r,e){e?cs(r,{hardMax:!0,max:e}):cs(r,{hardMax:!1,max:"10"})}function cs(r,e){r.slider=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},r.slider),e)}function Ka(r,e){!r||r.slider.isPlaying===e||(cs(r,{isPlaying:e}),e&&(Sm(r),r.sliderAnimationTargetValue=ma(r)))}function Sm(r){if(!r.slider.hardMin){let e=__dcg_shared_module_exports__['kc'](yl(r));e!==r.slider.min&&cs(r,{min:e})}if(!r.slider.hardMax){let e=__dcg_shared_module_exports__['kc'](vc(r));e!==r.slider.max&&cs(r,{max:e})}}function ya(r,e){var t=vb(e);if(isFinite(t)){let i=__dcg_shared_module_exports__['Rb']({target:t,step:Bl(r),hardMin:r.slider.hardMin?yl(r):void 0,hardMax:r.slider.hardMax?vc(r):void 0});i.min||cs(r,{hardMin:!1,min:"-10"}),i.max||cs(r,{hardMax:!1,max:"10"}),i.step||cs(r,{step:""})}r.latex=e}function F_(r,e){cs(r,{loopMode:e,playDirection:1}),e==="PLAY_INDEFINITELY"&&cs(r,{hardMin:!1,hardMax:!1,min:"",max:""}),r.sliderAnimationTargetValue=yl(r)}function kb(r,e){e&&Sm(r),r.sliderDragging=e}function Gb(r,e){cs(r,{step:e})}function R_(r,e){cs(r,{animationPeriod:e})}function vp(r){return r.displayEvaluationAsFraction}function N_(r,e){r.displayEvaluationAsFraction=e}function gu(r,e){r.label=e}function _h(r,e){Dp(r)?r.showAngleLabel=e:r.showLabel=e}function B_(r,e){r.description=e}function Ib(r,e){r.polarDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.polarDomain),{min:e})}function Vb(r,e){r.parametricDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain),{min:e})}function Tb(r,e){r.parametricDomain3Du=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Du),{min:e})}function Mb(r,e){r.parametricDomain3Dv=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Dv),{min:e})}function Ab(r,e){r.polarDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.polarDomain),{max:e})}function Lb(r,e){r.parametricDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain),{max:e})}function Ob(r,e){r.parametricDomain3Du=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Du),{max:e})}function Pb(r,e){r.parametricDomain3Dv=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Dv),{max:e})}function _T(r,e){r.isLogModeRegression=e}function dD(r,e){wm(e)&&(r.color=e,r.colorLatex="")}function FT(r,e){r.fill=e}function _b(r,e){r.fillOpacity!==e&&(r.fillOpacity=e)}function Em(r,e){r.lineOpacity!==e&&(r.lineOpacity=e)}function Fb(r,e){r.pointOpacity!==e&&(r.pointOpacity=e)}function Rb(r,e){r.pointSize!==e&&(r.pointSize=e)}function km(r,e){r.lineWidth!==e&&(r.lineWidth=e)}function uD(r,e){r.resolution!==e&&(r.resolution=e)}function pD(r,e){r.checkers!==e&&(r.checkers=e)}function K_(r,e){r.polarCoordinateSystem!==e&&(r.polarCoordinateSystem=e)}function Nb(r,e){r.colorLatex!==e&&(r.colorLatex=e)}function U_(r,e){r.labelDropdownOpen=e}function Fh(r,e){r.dragMode!==e&&(r.dragMode=e)}function RT(r,e){r.points=e}function NT(r,e){r.pointStyle!==e&&(r.pointStyle=e,e!=="POINT"&&(r.dragMode="NONE"))}function BT(r,e){r.lines=e}function H_(r,e){r.surfaces=e}function hD(r,e){r.lineStyle!==e&&(r.lineStyle=e)}function q_(r,e){r.arrowMode=e===V6(r)?"DEFAULT":e}function V6(r){return"NONE"}function Bb(r,e){r.labelSize=e}function gD(r,e){r.labelAngle=e}function KT(r,e){r.labelOrientation=e}function z_(r,e){r.suppressTextOutline=e}function Kb(r,e){r.interactiveLabel=e}function mD(r,e){r.editableLabelMode=e}function $_(r){return r.editableLabelMode}function Gm(r){let{editableLabelMode:e}=r;return e==="MATH"||e==="TEXT"}function W_(r,e){r.strictIntersection=e}function j_(r){return!!(rn(r)!=="NONE"&&Ba(r))}function J_(r,e){r.hidden=e,!e&&Rh(r)&&(r.lines=r.points=r.fill=r.surfaces=void 0)}function Rh(r){if(bd(r))return!1;let{points:e,lines:t,fill:i,surfaces:n}=r,o=__dcg_shared_module_exports__['yc'](r.formula.expression_type,{points:e,lines:t,fill:i,surfaces:n});return!o.points&&!o.lines&&!o.fill&&!o.surfaces}function fD(r){return mu(r)||Cp(r)||Tm(r)}function yD(r){return vD(r)||bl(r)||Ra(r)}function Y_(r){return r.polarDomain.min}function X_(r){return r.polarDomain.max}function Q_(r){return r.parametricDomain.min}function Z_(r){return r.parametricDomain3Du.min}function eF(r){return r.parametricDomain3Dv.min}function tF(r){return r.parametricDomain.max}function rF(r){return r.parametricDomain3Du.max}function iF(r){return r.parametricDomain3Dv.max}function Im(r){return!!r.formula.action_value&&Object.keys(r.formula.action_value).length>0}function nF(r){return!!r.sliderExists}function yd(r){return r.formula.expression_type==="POLYGON"}function bd(r){return!!r.formula.is_inequality}function Vm(r){return!!r.formula.is_regression}function mu(r){return r.formula.expression_type==="PARAMETRIC"||r.formula.expression_type==="CURVE3D_xyz_t"&&r.latex.indexOf("segment")===-1}function bD(r){return r.formula.expression_type==="POINT3D"}function UT(r){return r.formula.expression_type==="CURVE3D_xyz_t"}function HT(r){switch(r.formula.expression_type){case"SURFACE_xyz_uv":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_r_\u03B8\u03C6_AMBIGUOUS":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"TRIANGLE3D":return!0;default:return!1}}function wD(r){return r.formula.expression_type==="TRIANGLE3D"}function oF(r){return r.formula.expression_type==="IMPLICIT_SURFACE"||r.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function sF(r){return!r.formula.is_inequality&&(r.formula.expression_type==="X_OR_Y"||r.formula.expression_type==="IMPLICIT"||r.formula.expression_type==="SURFACE_AMBIGUOUS"||r.formula.expression_type==="SURFACE_CONSTANT_AMBIGUOUS"||r.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS")}function xD(r){return!r.formula.is_inequality&&(r.formula.expression_type==="POLAR"||r.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS")}function Cp(r){return r.formula.expression_type==="POLAR"}function Tm(r){return r.formula.expression_type==="SURFACE_r_\u03B8z"||r.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"}function Ra(r){return r.formula.expression_type==="SURFACE_z_r\u03B8"}function bl(r){return r.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"}function vD(r){return r.formula.expression_type==="SURFACE_xyz_uv"}function Dp(r){let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['jb']||t===__dcg_shared_module_exports__['kb']||t===__dcg_shared_module_exports__['lb']||t===__dcg_shared_module_exports__['mb']}function Cc(r){let e=Dp(r);return e&&r.showAngleLabel||!e&&r.showLabel}function aF(r){if(Kl(r))return!0;let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['$a']||t===__dcg_shared_module_exports__['ab']||t===__dcg_shared_module_exports__['jb']||t===__dcg_shared_module_exports__['kb']||t===__dcg_shared_module_exports__['lb']||t===__dcg_shared_module_exports__['mb']}function ta(r){return r.formula.expression_type==="SINGLE_POINT"}function qT(r){return r.formula.expression_type==="POINT_LIST"}function Kl(r){return r.formula.expression_type==="POINT_LIST"||r.formula.expression_type==="SINGLE_POINT"}function Sp(r){let e=wl(r);return!!(e&&e.type==="visualization"&&e.symbol==="boxplot")}function fu(r){let e=wl(r);return!!(e&&e.type==="visualization"&&e.symbol==="dotplot")}function Nh(r){let e=wl(r);return!!(e&&e.type==="visualization"&&e.symbol==="histogram")}function CD(r){var e=Sp(r)||fu(r)||Nh(r);return e}function DD(r){return r.formula.expression_type==="TTEST"}function lF(r){return r.formula.expression_type==="STATS"}function Ep(r){let e=wl(r);return!!(e&&e.type==="distribution")}function cF(r){let{formula:e}=r;return e?!!e.is_discrete_distribution:!1}function wl(r){if(r.controller.areDistributionsEnabled()&&r.latex)return(!r.cachedParseToplevelFunction||r.cachedParseToplevelFunction.latex!==r.latex)&&(r.cachedParseToplevelFunction={latex:r.latex,spec:__dcg_shared_module_exports__['jc'](r.latex)}),r.cachedParseToplevelFunction.spec}function zT(r){return Ub(r)&&Ep(r)}function Ub(r){return!!r.formula.expression_type}function $T(r){return!!r.formula.is_concrete_list}function wd(r){return!zT(r)||$T(r)?!1:r.cdf.show}function Hb(r){return r.cdf.min}function qb(r){return r.cdf.max}function dF(r){var e=ET(r.formula.cdf_min_default);return e===-1/0?"-\\infty":isFinite(e)?e+"":"-\\infty"}function uF(r){var e=ET(r.formula.cdf_max_default);return e===1/0?"\\infty":isFinite(e)?e+"":"\\infty"}function pF(r,e){r.cdf=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cdf),{show:e})}function SD(r,e){r.cdf=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cdf),{min:e})}function ED(r,e){r.cdf=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cdf),{max:e})}function zb(r){return!!r.formula&&r.formula.cdf_min_valid!==!1}function $b(r){return!!r.formula&&r.formula.cdf_max_valid!==!1}function WT(r){return!!r.formula&&r.formula.fill_opacity_valid!==!1}function hF(r){return!!r.formula&&r.formula.line_opacity_valid!==!1}function gF(r){return!!r.formula&&r.formula.point_opacity_valid!==!1}function jT(r){return!!r.formula&&r.formula.label_size_valid!==!1}function JT(r){return!!r.formula&&r.formula.label_angle_valid!==!1}function kD(r){return!!r.formula&&r.formula.point_size_valid!==!1}function GD(r){return!!r.formula&&r.formula.line_width_valid!==!1}function mF(r){return!!r.formula&&r.formula.checkers_valid!==!1}function ID(r){return!!r.formula&&r.formula.resolution_valid!==!1}function fF(r){return!!r.formula&&r.formula.color_latex_valid!==!1}function yF(r){return r.formula&&r.formula.color_latex_value}function bF(r){return r.formula&&r.formula.label_angle_value}function VD(r){var e=r.formula&&r.formula.cdf_evaluation;return isFinite(e)?e:0}function YT(r){if(!__dcg_shared_module_exports__['zc'](r.formula.expression_type))return!1;let e=rn(r);return!(e&&e!=="NONE")}function wF(r){r.showLabel=__dcg_shared_module_exports__['Mc'].showLabel,r.showAngleLabel=__dcg_shared_module_exports__['Mc'].showAngleLabel,r.label=__dcg_shared_module_exports__['Mc'].label,r.hidden=__dcg_shared_module_exports__['Mc'].hidden,r.dragMode=__dcg_shared_module_exports__['Mc'].dragMode,r.fill=__dcg_shared_module_exports__['Mc'].fill,r.points=__dcg_shared_module_exports__['Mc'].points,r.pointStyle=__dcg_shared_module_exports__['Mc'].pointStyle,r.lines=__dcg_shared_module_exports__['Mc'].lines,r.lineStyle=__dcg_shared_module_exports__['Mc'].lineStyle,r.slider=__dcg_shared_module_exports__['Nc'],r.latex="",r.labelSize="",r.labelOrientation="default",r.displayEvaluationAsFraction=__dcg_shared_module_exports__['Mc'].displayEvaluationAsFraction,r.strictIntersection=__dcg_shared_module_exports__['Mc'].strictIntersection,r.suppressTextOutline=!1,r.interactiveLabel=!1,r.editableLabelMode=__dcg_shared_module_exports__['Mc'].editableLabelMode,__dcg_shared_module_exports__['Ec'](__dcg_shared_module_exports__['Lc'],r)}function TD(r){return!!r.formula.move_strategy}function MD(r,e){var t=r.cachedViewState;return e.stripDefaults?__dcg_shared_module_exports__['Ic'](t):t}function T6(r){r.cachedViewState={type:r.type,id:r.id,title:r.title,hidden:r.hidden,readonly:r.readonly,collapsed:r.collapsed,secret:r.secret}}function M6(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}function xF(r,e){let t=__dcg_shared_module_exports__['j'](__dcg_shared_module_exports__['Hc'](r));return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),xd(e)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function vF(r){A6(r),vd(r),T6(r),M6(r)}function A6(r){var e=r.controller,t=e.getAllSelectedItems();r.collapsedChildIsSelected=r.collapsed&&__dcg_shared_module_exports__['p'](t,i=>i.type!=="folder"&&i.folderId===r.id)}var L6={id:!1,type:!1,hidden:!0,secret:!0,collapsed:!0,title:!0,readonly:!0};function CF(r,e){__dcg_shared_module_exports__['Dc']({from:e,to:r,props:L6})}function Mm(r,e){r.collapsed=e}function DF(r,e){r.title=e}function SF(r,e){r.hidden=e}var kF={folderId:"",text:"",secret:!1,readonly:!1};function GF(r){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},kF),r)}function IF(r){return __dcg_shared_module_exports__['Ac'](kF,r)}function VF(r,e){r.text=e}function TF(r,e){let t=__dcg_shared_module_exports__['j'](GF(r));return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),xd(e)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function MF(r){vd(r),P6(r),_6(r)}var O6={id:!1,type:!1,folderId:!0,text:!0,secret:!0,readonly:!0};function AF(r,e){__dcg_shared_module_exports__['Dc']({from:e,to:r,props:O6})}function AD(r,e){var t=r.cachedViewState;return e.stripDefaults?IF(t):t}function P6(r){r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,text:r.text,secret:r.secret,readonly:r.readonly}}function _6(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}var F6=0;function R6(){return"helper_item_"+F6++}function OF(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{formula:__dcg_shared_module_exports__['Tc'](),guid:R6(),cachedParsableState:{type:"statement",id:r.id,latex:r.latex,shouldGraph:!1}})}function PF(r,e,t){var l;e.formula=t;let i=e.proxy,n={numericValue:i.numericValue,listValue:i.listValue},{constant_value:o,zero_values:s}=t,a=o!=null?o:(l=(s||[])[0])==null?void 0:l.val;i.numericValue=__dcg_shared_module_exports__['K'](a)?a:NaN,i.listValue=__dcg_shared_module_exports__['I'](a)&&__dcg_shared_module_exports__['o'](a,__dcg_shared_module_exports__['K'])?a.slice(0):void 0,__dcg_shared_module_exports__['G'](i.numericValue,n.numericValue)||r.runAfterDispatch(()=>{i.notifyPropertyChange("numericValue")}),__dcg_shared_module_exports__['G'](i.listValue,n.listValue)||r.runAfterDispatch(()=>{i.notifyPropertyChange("listValue")})}ct();var XT={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},LD={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:XT,description:"",draggable:!1},_F=__dcg_shared_module_exports__['a']({folderId:"",hidden:!1,secret:!1,readonly:!1,foreground:!1,name:""},LD);function FF(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},_F),r),{clickableInfo:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},XT),r.clickableInfo)})}function RF(r){var e=__dcg_shared_module_exports__['Ac'](_F,r),t=__dcg_shared_module_exports__['Bc'](XT,r.clickableInfo);return t===void 0?delete e.clickableInfo:e.clickableInfo=t,e}function QT(r){return __dcg_shared_module_exports__['Fc'](r,LD)}function NF(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({type:"image",id:r.id},QT(r)),{guid:"",index:0,color:"",shouldGraph:r.hidden,showPoints:!1})}function BF(r,e){r.hidden=e}function qa(r,e,t){r[e]=t}function KF(r,e){return r[e]}function UF(r,e){r.description=e}function HF(r,e){r.name=e}function ZT(r,e){r.draggable=e}function Am(r){if(r.formula){var e=r.formula.center_reference_id,t=r.formula.center_reference_symbol;if(!(!e||!t)){var i=r.controller.getItemModel(e);if(!(!i||i.type!=="expression")&&i.formula.assignment===t&&ta(i))return i}}}function B6(r){var e=Am(r);if(!e)return!1;var t=rn(e);return!(!t||t==="NONE")}function Cd(r){return r.draggable?B6(r):!1}function qF(r){if(!r.formula||!r.formula.center_is_point_literal)return!1;var e=r.formula.move_strategy;if(!e)return!1;var t=e[2],i=e[3],n=t&&t.type!=="none",o=i&&i.type!=="none";return!!(n||o)}function zF(r,e){r.opacity=e}function eM(r,e){r.foreground=e}function $F(r,e){r.image_url=e}function PD(r,e){e(r.opacity,"imageOpacity"),e(r.center,"imageCenter"),e(r.height,"imageHeight"),e(r.width,"imageWidth"),e(r.angle,"imageAngle")}function K6(r){let e=NF(r);e.color=r.color,e.index=r.index,e.guid=r.guid,e.shouldGraph=r.shouldGraph,e.showPoints=r.showPoints,r.cachedParsableState=e}function WF(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={center:r.center,width:r.width,height:r.height}):delete r.preTransientState,vd(r);let e=Ua(r);r.shouldGraph=e&&e.hidden?!1:!r.hidden,r.showPoints=r.shouldGraph&&ba(r)&&r.loadStatus==="loaded"&&!Cd(r)&&r.controller.isTraceEnabled(),H6(r),q6(r),K6(r)}function jF(r,e){r.formula=e,r.error=U6(r)}function _D(r){return r.formula?r.formula.variables||[]:[]}function U6(r){var e={scale:r.controller.s("graphing-calculator-error-log-axes-image"),center:r.controller.s("graphing-calculator-error-image-invalid-center"),angle:r.controller.s("graphing-calculator-error-image-invalid-angle"),width:r.controller.s("graphing-calculator-error-image-invalid-width"),height:r.controller.s("graphing-calculator-error-image-invalid-height"),opacity:r.controller.s("graphing-calculator-error-image-invalid-opacity")};for(var t in r.formula.errorMap){var i=r.formula.errorMap[t];if(i)return e[t]}}function JF(r,e){return!r.formula||!r.formula.errorMap?!1:!!r.formula.errorMap[e]}function FD(r,e){var t=r.cachedViewState;return e.stripDefaults?RF(t):t}function H6(r){var e=r.cachedViewState.clickableInfo,t=!0,i=!0;if(e&&(e.depressedImage===r.clickableInfo.depressedImage&&(i=!1),e.hoveredImage===r.clickableInfo.hoveredImage&&(t=!1)),t&&(r.hoveredImageObj&&(O(r.hoveredImageObj).off("load"),delete r.hoveredImageObj),r.clickableInfo.hoveredImage)){r.hoveredImageObj=new Image;var n=function(){r.controller.requestRedrawGraph()},o=function(){};OD(r.hoveredImageObj,r.clickableInfo.hoveredImage,n,o)}if(i&&(r.depressedImageObj&&(O(r.depressedImageObj).off("load"),delete r.depressedImageObj),r.clickableInfo.depressedImage)){r.depressedImageObj=new Image;var n=function(){r.controller.requestRedrawGraph()},o=function(){};OD(r.depressedImageObj,r.clickableInfo.depressedImage,n,o)}if(r.cachedViewState.image_url!==r.image_url){O(r.imageObj).off("load"),r.imageObj=new Image;let s=function(){r.controller.dispatch({type:"image-load-success",id:r.id})},a=function(){r.controller.dispatch({type:"image-load-error",id:r.id})};OD(r.imageObj,r.image_url,s,a)}r.cachedViewState=__dcg_shared_module_exports__['a']({type:r.type,id:r.id,folderId:r.folderId,image_url:r.image_url,name:r.name,hidden:r.hidden,foreground:r.foreground,secret:r.secret,readonly:r.readonly},QT(r))}function tM(r,e){r.draggingOnGraphpaper=e}function q6(r){var e=r.cachedViewState;r.cachedUndoRedoFullState=r.cachedViewState,r.preTransientState&&(e=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},e),r.preTransientState)),r.cachedUndoRedoDiffState=e}function z6(r){var e=document.createElement("canvas");e.width=2,e.height=2;var t=e.getContext("2d");return t.drawImage(r,0,0,2,2),e.toDataURL()}function OD(r,e,t,i){O(r).on("load.initial-image-load",function(){var n=r.width,o=r.height;n===1&&o===1?(O(r).off(".initial-image-load"),O(r).on("load",t),r.src=z6(r)):t()}).on("error",i),/^data:/.test(e)||(r.crossOrigin="anonymous"),r.src=e}function YF(r,e){let t=__dcg_shared_module_exports__['j'](FF(r));return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),xd(e)),{color:__dcg_shared_module_exports__['S'].BLUE,loadStatus:"loading",failures:0,imageObj:new Image,hoveredImageObj:void 0,depressedImageObj:void 0,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{}})}var $6=__dcg_shared_module_exports__['a']({id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,foreground:!0},__dcg_shared_module_exports__['Gc'](LD));function XF(r,e){__dcg_shared_module_exports__['Dc']({from:e,to:r,props:$6})}function QF(r){let{controller:e,files:t,id:i}=r,n={errors:[],tokens:[]};for(let o=0;o<t.length;o++){let s=t[o];if(!s.type.match("image/*")){n.errors.push(e.s("graphing-calculator-error-image-invalid-file",{file:s.name}));continue}n.tokens.push(j6({controller:e,file:s,id:i}))}return n}var W6=0;function j6(r){let{controller:e,file:t,id:i}=r,n=""+W6++;return e.getGraphSettings().config.imageUploadCallback(t,(o,s)=>{setTimeout(()=>{if(o)e.dispatch({type:"image-upload-error",token:n,error:o});else{let a=new Image;OD(a,s,function(){var u=a.width,p=a.height,g=Math.max(u,p)/Math.min(u,p);u<p?(p=10,u=Math.round(10*p/g)/10):(u=10,p=Math.round(10*u/g)/10),e.dispatch({type:"image-upload-success",token:n,url:s,width:u+"",height:p+"",name:t.name,id:i})},function(){e.dispatch({type:"image-upload-error",token:n,error:!0})})}})}),n}function RD(r,e){r.loadStatus=e,e==="loaded"&&(r.failures=0),e==="failed"&&(r.failures+=1)}function rM(r){r.imageObj.src=r.imageObj.src,RD(r,"loading")}function ND(r,e,t){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{[e]:t})}function ZF(r,e){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{latex:e})}function Bh(r){var e;return!!(r.clickableInfo.enabled&&r.formula&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}var Om={handlerLatex:"",minStepLatex:"",open:!1,playing:!1};function eR(r){return __dcg_shared_module_exports__['Bc'](Om,r)}function tR(r){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},Om),r)}var rR="dcg_ticker_guid_internal",J6=rR;function iR(){return iM(Om)}function Y6(r){r.cachedParsableState={type:"ticker",id:r.id,handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,shouldGraph:!1}}function nR(r,e){return e.stripDefaults?eR(r.cachedViewState):r.cachedViewState}function oR(r){return r.cachedUndoRedoDiffState}function sR(r){return r.cachedUndoRedoFullState}function X6(r){r.cachedViewState={handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,playing:r.playing,open:r.open}}function Q6(r){var e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function iM(r){let e=tR(r);return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{type:"ticker",guid:rR,id:J6,avgDelta:0,lastTickTime:void 0,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},filteredBySearch:!1})}function aR(r,e){__dcg_shared_module_exports__['Ec'](e,r)}function lR(r,e){r.formula=e}function cR(r){X6(r),Q6(r),Y6(r)}function dR(r,{currentFrameTime:e,previousFrameTime:t}){var s,a;if(!r.playing||((s=r.formula)==null?void 0:s.handler.status)!=="maybe-valid")return!1;if(r.lastTickTime==null||t==null)return!0;if(((a=r.formula)==null?void 0:a.minStep.status)!=="valid")return!1;let i=r.formula.minStep.value,n=r.lastTickTime+i;if(e>=n)return!0;let o=e-t;return n-e<o/2}function uR(r,e){r.lastTickTime=e}function pR(r){if(r.formula)return r.formula.handler.status==="error"?r.formula.handler.error:void 0}function hR(r){if(r.formula)return r.formula.minStep.status==="error"?r.formula.minStep.error:void 0}function jb(r){var e;return((e=r.formula)==null?void 0:e.variables)||[]}function BD(r,e){e(r.handlerLatex,"tickerHandler"),e(r.minStepLatex,"tickerMinStep")}var Pm="dcg_geometry_toolbar_",gR={selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!1},line:{visible:!1},segment:{visible:!1},ray:{visible:!1},circle:{visible:!1},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}};function mR(r){if(r.toolbar!=="all"){if(r.toolbar==="custom"){let e=__dcg_shared_module_exports__['Bc'](gR,r.toolbarState),t={toolbar:"custom"};return e!==void 0&&(t.toolbarState=e),t}return r}}function fR(r){return r===void 0?{toolbar:"all"}:r.toolbar==="custom"?{toolbar:"custom",toolbarState:__dcg_shared_module_exports__['Cc'](gR,r.toolbarState)}:r}function yR(r,e){return e.stripDefaults?mR(r.cachedViewState):r.cachedViewState}function nM(r){return r.cachedUndoRedoDiffState}function Z6(r){r.toolbar==="custom"?r.cachedViewState={toolbar:"custom",toolbarState:__dcg_shared_module_exports__['j'](r.toolbarState)}:r.cachedViewState={toolbar:r.toolbar}}function bR(r){Z6(r),ez(r),r.__cachedToolbarState=void 0}function wR(r){let e=[];for(let t in r.toolbarState){let i=t,n=r.toolbarState[i];n.visible&&n.disabledLatex&&e.push({type:"geometry-toolbar-predicate",id:`${Pm}${i}`,latex:n.disabledLatex})}return e}function xR(r,e){if(!r.toolbarState[e].disabledLatex)return;let t=r.formulas[e];if(t!=null&&t.error)return{key:"shared-calculator-error-custom-toolbar-not-condition",vars:{}}}function vR(r,e,t){let i=e.replace(Pm,"");i in r.toolbarState&&(r.formulas[i]=t)}function ez(r){var e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function UD(r){let e=fR(r);return{toolbar:e.toolbar,toolbarState:e.toolbar==="custom"?e.toolbarState:tz(),formulas:{},selectedToolForGroup:{},__cachedToolbarState:void 0,cachedViewState:e,cachedUndoRedoDiffState:e,cachedUndoRedoFullState:e}}function CR(){return UD(void 0)}function tz(){return{selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!0},line:{visible:!0},segment:{visible:!0},ray:{visible:!0},circle:{visible:!0},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}}}function DR(r,e){r.toolbar=e,r.__cachedToolbarState=void 0}function SR(r,e,t){let{groups:i,items:n}=qD(r,t);for(let o of i){let s=n[o];s!=null&&s.dropdown&&s.dropdown.indexOf(e)!==-1?r.selectedToolForGroup[s.group]=e:s!=null&&s.dropdown&&rz(s.current)&&(r.selectedToolForGroup[s.group]=s.dropdown[0])}r.__cachedToolbarState=void 0}function HD(r,e,t){r.toolbarState[e]={visible:t.visible,disabledLatex:t.disabledLatex},r.__cachedToolbarState=void 0}function Kh(r,e){return r.toolbar==="all"?!0:r.toolbar==="none"?!1:r.toolbarState[e].visible}function _m(r,e){if(r.toolbar==="all")return!0;let t=Kh(r,e);if(t&&r.formulas[e]){let i=r.formulas[e],n=i==null?void 0:i.constant_value;return typeof n=="number"?!n:!0}return t||e==="selection"}function qD(r,e){var n;if(((n=r.__cachedToolbarState)==null?void 0:n.authorMode)===e)return r.__cachedToolbarState.state;let t={};for(let o of oM())if(o.dropdown){let s=o.dropdown.filter(a=>e||Kh(r,a));if(s.sort((a,l)=>{let c=_m(r,a),u=_m(r,l),p=Kh(r,a),g=Kh(r,l);return(c?0:p?1:2)-(u?0:g?1:2)}),s.length>0){let a=r.selectedToolForGroup[o.group];(!a||s.indexOf(a)===-1)&&(a=s[0]),!e&&!_m(r,a)&&(a=s.find(l=>_m(r,l))||s[0]),t[o.group]={group:o.group,current:a,dropdown:s.length>1?s:void 0}}}else(e||Kh(r,o.current))&&(t[o.group]=o);let i=Object.keys(t);r.__cachedToolbarState={authorMode:e,state:{groups:i,items:t}};for(let o of i){let s=t[o];r.selectedToolForGroup[o]=s==null?void 0:s.current}return{groups:i,items:t}}function oM(){return[{group:"selection",current:"selection",dropdown:["selection","box-selection"]},{group:"point",current:"point",dropdown:["point","midpoint"]},{group:"line",current:"segment",dropdown:["segment","line","ray","parallel","perpendicular"]},{group:"circle",current:"circle",dropdown:["circle","compass","arc"]},{group:"angle",current:"angle",dropdown:["angle","directedangle"]},{group:"polygon",current:"polygon"}]}function rz(r){switch(r){case"box-selection":case"midpoint":case"parallel":case"perpendicular":case"compass":case"arc":return!0;default:return!1}}var Bm="**dcg_geo_expression_edit_tool_preview**";function ER(r){return{controller:r,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},__toolPreviewIdToModel:{},__anyDependsOnRandomSeed:!1,__anyIsAction:!1,selectedItemMap:{},drawOrder:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:1,ticker:iR()}}function kR(r){for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t.type==="image"&&t.loadStatus==="loading")return!0}return!1}function GR(r){var e=__dcg_shared_module_exports__['n'](__dcg_shared_module_exports__['E'](r.controller.getColors()),i=>i!=__dcg_shared_module_exports__['S'].ORANGE),t=e[r.colorIdx];return r.colorIdx=(r.colorIdx+1)%e.length,t}function Km(r,e){return r.__itemModelArray[e]}function Um(r){for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];if(Hm(t))return t}}function $D(r){for(let e=r.__itemModelArray.length-1;e>=0;e--){let t=r.__itemModelArray[e];if(Hm(t))return t}}function Uh(r,e){var t;do{if(e--,e===-1)return;t=Km(r,e)}while(t&&!Hm(t));return t}function Hh(r,e){var t,i=Yb(r);do{if(e++,e===i)return;t=Km(r,e)}while(t&&!Hm(t));return t}function Ua(r){if(r.type!=="folder"&&r.folderId){let e=r.controller.getListModel(),t=Sc(e,r.folderId);if(t&&t.type==="folder")return t}}function IR(r,e){let t=Sc(r,e);if(!t||t.type!=="folder")return 0;let i=0,n=r.__itemModelArray.length;for(var o=t.index+1;o<n;o++){let s=r.__itemModelArray[o];if(s.type==="folder"||s.folderId!==e)break;i+=1}return i}function VR(r,e){let t=Sc(r,e);if(!t||t.type!=="folder")return[];let i=[],n=r.__itemModelArray.length;for(var o=t.index+1;o<n;o++){let s=r.__itemModelArray[o];if(s.type==="folder"||s.folderId!==e)break;i.push(s.id)}return i}function TR(r,e){let t=[],i=Sc(r,e);if(!i||i.type!=="folder")return t;let n=r.__itemModelArray.length;for(let o=i.index+1;o<n;o++){let s=r.__itemModelArray[o];if(s.type==="folder"||s.folderId!==e)break;t.push(s)}return t}function aM(r){return!!(r&&r.readonly)}function Jb(r){if(!r)return!1;if(r.secret)return!0;let e=Ua(r);return!!(e&&e.secret&&e.id!==__dcg_shared_module_exports__['Jc'])}function Hm(r){return!lM(r)}function MR(r){return r.id===__dcg_shared_module_exports__['Jc']||r.type!=="folder"&&r.folderId===__dcg_shared_module_exports__['Jc']}function lM(r){if(!r||r.filteredBySearch||MR(r))return!0;if(r.controller.isItemBeingDragged(r.id))return!!r.controller.shouldRenderDraggedItemAsToken();if(!r.controller.shouldShowAuthorFeatures()&&Jb(r))return!0;let t=Ua(r);return!!(t&&t.collapsed&&!r.controller.getExpressionSearchStr())}function cM(r){return r.__itemModelArray}function AR(r){return __dcg_shared_module_exports__['E'](r.__helperIdToModel)}function qm(r){return __dcg_shared_module_exports__['E'](r.__toolPreviewIdToModel)}function zm(r,e){for(var t=0;t<r.__itemModelArray.length;t++){var i=r.__itemModelArray[t];Rm(i,e)}for(var n in r.__toolPreviewIdToModel)Rm(r.__toolPreviewIdToModel[n],e);if(r.ticker.open&&(e(r.ticker.handlerLatex,{type:"item",location:"tickerHandler",item:r.ticker}),e(r.ticker.minStepLatex,{type:"item",location:"tickerMinStep",item:r.ticker})),r.controller.isGeometry()){let s=r.controller.getGeometryToolbarModel().toolbarState;for(let a in s){let l=a,c=s[l];c.visible&&c.disabledLatex&&e(c.disabledLatex,{type:"geometry-toolbar",tool:l})}}}function Rm(r,e){switch(r.type){case"expression":cD(r,(i,n)=>e(i,{type:"item",location:n,item:r}));break;case"table":QD(r,(i,n,o)=>e(i,__dcg_shared_module_exports__['a']({type:"item",location:n,item:r},o)));break;case"image":PD(r,(i,n)=>e(i,{type:"item",location:n,item:r}));break;case"ticker":BD(r,(i,n)=>e(i,{type:"item",location:n,item:r}));break;case"folder":case"text":break;default:return r}}function Fm(r,e){return!!r.replace(/([_^])([a-z0-9])/gi,"$1{$2}").match(e)}function LR(r,e){if(!ga(e))return!1;let i=!1;return zm(r,n=>{xc(n,e)&&(i=!0)}),i}function OR(r,e){let t=0,i=ga(e);r.ticker.filteredBySearch=r.ticker.open&&!xc(r.ticker.handlerLatex,e)&&!xc(r.ticker.minStepLatex,e);for(let n of r.__itemModelArray){if(!i){n.filteredBySearch=!1,t++;continue}switch(n.filteredBySearch=!0,n.type){case"expression":cD(n,a=>{xc(a,e)&&(n.filteredBySearch=!1,t++)});let o=Cc(n);n.label&&o&&n.label.match(zD(e))&&(n.filteredBySearch=!1,t++);break;case"table":QD(n,a=>{xc(a,e)&&(n.filteredBySearch=!1,t++)});break;case"image":PD(n,a=>{xc(a,e)&&(n.filteredBySearch=!1,t++)});break;case"folder":case"text":break;default:return n}!n.filteredBySearch&&n.type!=="folder"&&n.folderId&&(r.__itemIdToModel[n.folderId].filteredBySearch=!1,t++)}return t}function PR(r,e){let t=0,i=c_(e);r.ticker.filteredBySearch=r.ticker.open&&!Fm(r.ticker.handlerLatex,i)&&!Fm(r.ticker.minStepLatex,i);for(var n=0;n<r.__itemModelArray.length;n++){if(!e){r.__itemModelArray[n].filteredBySearch=!1;continue}var o=r.__itemModelArray[n];switch(o.filteredBySearch=!0,o.type){case"expression":cD(o,l=>{Fm(l,i)&&(o.filteredBySearch=!1,t++)});let s=Cc(o);o.label&&s&&(e==="\\operatorname{label}"||e.length>1&&"label".indexOf(e)===0||Fm(o.label,i))&&(o.filteredBySearch=!1,t++);break;case"table":QD(o,l=>{Fm(l,i)&&(o.filteredBySearch=!1,t++)});break;case"image":PD(o,l=>{Fm(l,i)&&(o.filteredBySearch=!1,t++)});break;case"folder":o.title&&o.title.indexOf(e)>=0&&(o.filteredBySearch=!1,t++);break;case"text":o.text.indexOf(e)>=0&&(o.filteredBySearch=!1,t++);break;default:return o}!o.filteredBySearch&&o.type!=="folder"&&o.folderId&&(r.__itemIdToModel[o.folderId].filteredBySearch=!1,t++)}return t}function zD(r,e){return new RegExp("\\$\\{"+r.replace("{","\\{?").replace("}","\\}?").replace("_","\\_?")+"\\}",e)}function _R(r,e){let t=0;for(var i=0;i<r.__itemModelArray.length;i++){var n=r.__itemModelArray[i];if(n.type!=="expression")continue;if(Cc(n)&&n.label){let s=n.label.match(zD(e,"g"));s&&(t+=s.length)}}return zm(r,o=>{t+=ZC(o,e).length}),t}function Gp(r,e,t,i){t=t.trim().replace(/_\{([a-zA-Z0-9])\}/g,"_$1");for(var n=0;n<r.__itemModelArray.length;n++){let o=r.__itemModelArray[n];if(o.type==="expression"){let s=Cc(o);o.label&&s&&o.label.match(zD(e))&&gu(o,o.label.replace(zD(e,"g"),"${"+t.trim()+"}"))}}zm(r,(o,s)=>{if(i&&i.limitToItem!==void 0&&(s.type!=="item"||i.limitToItem!==s.item.id)||i&&i.limitToFolder!==void 0&&(s.type!=="item"||s.item.type==="ticker"||s.item.type==="folder"||i.limitToFolder!==s.item.folderId))return;let a=eD(o,e,t);if(s.type==="geometry-toolbar"){let c=r.controller.getGeometryToolbarModel();HD(c,s.tool,{visible:!0,disabledLatex:a});return}let l=s.item;if(a!==o){let c;switch(s.cellLocation!==void 0&&l.columnModels&&(c=l.columnModels[s.cellLocation.column].id),s.location){case"latex":{ya(l,a);break}case"cdfMin":{SD(l,a);break}case"cdfMax":{ED(l,a);break}case"colorLatex":{Nb(l,a);break}case"lineWidth":{km(l,a);break}case"resolution":{uD(l,a);break}case"checkers":{pD(l,a);break}case"clickableInfoLatex":{nD(l,a);break}case"fillOpacity":{_b(l,a);break}case"lineOpacity":{Em(l,a);break}case"pointOpacity":{Fb(l,a);break}case"pointSize":{Rb(l,a);break}case"labelAngle":{gD(l,a);break}case"labelSize":{Bb(l,a);break}case"polarDomainMin":{Ib(l,a);break}case"polarDomainMax":{Ab(l,a);break}case"parametricDomainMin":{Vb(l,a);break}case"parametricDomain3DuMin":{Tb(l,a);break}case"parametricDomain3DvMin":{Mb(l,a);break}case"parametricDomainMax":{Lb(l,a);break}case"parametricDomain3DuMax":{Ob(l,a);break}case"parametricDomain3DvMax":{Pb(l,a);break}case"sliderMin":{Cm(l,a);break}case"sliderMax":{Dm(l,a);break}case"sliderStep":{Gb(l,a);break}case"imageOpacity":{qa(l,"opacity",a);break}case"imageCenter":{qa(l,"center",a);break}case"imageHeight":{qa(l,"height",a);break}case"imageWidth":{qa(l,"width",a);break}case"imageAngle":{qa(l,"angle",a);break}case"tickerHandler":{l.handlerLatex=a;break}case"tickerMinStep":{l.minStepLatex=a;break}case"tableHeader":case"tableCellValue":if(!s.cellLocation||l.type!=="table")break;yu(l,s.cellLocation,a);break;case"tableColumnColorLatex":{c&&iS(l,c,a);break}case"tableColumnPointSize":{c&&tS(l,c,a);break}case"tableColumnPointOpacity":{c&&rS(l,c,a);break}case"tableColumnLineWidth":{c&&ZD(l,c,a);break}case"tableColumnLineOpacity":{c&&eS(l,c,a);break}case"residualVariable":break;default:{let u=s.location;throw new Error(`Unexpected latex location ${u}`)}}}})}function WD(r){var e=[];zm(r,function(n){if(!(n.indexOf("~")!==-1||n.indexOf("\\sim")!==-1))for(var o=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var s=o.exec(n);if(!s)break;e.push(parseInt(s[1]||s[2],10))}}),e.sort(function(n,o){return n-o});for(var t=1,i=0;i<e.length;i++)e[i]===t&&t++;return t}function FR(r){var e=0;return zm(r,function(t){for(var i=/\\token\{(\d+)\}/g;;){var n=i.exec(t);if(!n)break;var o=parseInt(n[1],10);o>e&&(e=o)}}),e}function RR(r){var e={};return zm(r,function(t){if(!(t.indexOf("~")!==-1||t.indexOf("\\sim")!==-1))for(var i=/(\\?[a-zA-Z]+)_(\d)|(\\?[a-zA-Z]+)_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var n=i.exec(t);if(!n)break;var o=n[1]||n[3],s=n[2]||n[4];o[0]!=="\\"&&(o=o[o.length-1]);var a=parseInt(s,10);e[o]||(e[o]=0),a>e[o]&&(e[o]=a)}}),e}function NR(r,e){var t=[],i={points:[],angles:[],polygons:[],other:[]};function n(o){if(!(oz(r,o.id)&&e!=="actual")&&!(o.id===Bm&&e!=="preview")){if(o.type==="expression"&&o.folderId===__dcg_shared_module_exports__['Jc']){Kl(o)?i.points.push(o.id):Dp(o)?i.angles.push(o.id):yd(o)?i.polygons.push(o.id):i.other.push(o.id);return}o.type==="table"?__dcg_shared_module_exports__['l'](o.columnModels,function(s){t.push(s.id)}):t.push(o.id)}}r.__itemModelArray.forEach(n),qm(r).forEach(n),t.push.apply(t,i.polygons),t.push.apply(t,i.other),t.push.apply(t,i.angles),t.push.apply(t,i.points),r.drawOrder=t}function Sc(r,e,t){let i=r.__itemIdToModel[e];if(i)return i;if(t&&t.includePreviewItems)return r.__toolPreviewIdToModel[e]}function $m(r,e){var o;for(var t=[],i=0;i<r.__itemModelArray.length;i++){var n=r.__itemModelArray[i];n.type==="expression"&&((o=jo(n))==null?void 0:o.identifier)===e&&t.push(n)}return t}function iz(r,e){return r.__helperIdToModel[e]}function BR(r,e){var t=OF(e);r.__helperIdToModel[t.id]=t}function dM(r){r.__anyDependsOnRandomSeed=!1;for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula&&t.formula.depends_on_random_seed){r.__anyDependsOnRandomSeed=!0;return}}}function KR(r){r.__anyIsAction=!1}function jD(r){if(!r.__anyIsAction){if(r.ticker.open){r.__anyIsAction=!0;return}for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula){if(t.type!=="expression"&&t.type!=="image")continue;let{formula:i}=t;if(i.hasOwnProperty("action_value")||i.hasOwnProperty("click_handler")){r.__anyIsAction=!0;return}}}}}function qh(r){for(var e=!r.controller.shouldShowAuthorFeatures(),t=1,i=1,n=0;n<r.__itemModelArray.length;n++){var o=r.__itemModelArray[n];o.index=n,o.displayIndex=t,Jb(o)&&(o.secretIndex=i,i+=1),!MR(o)&&(!e||!Jb(o))&&(t+=1)}for(var s in r.selectedItemMap)r.__itemIdToModel[s]||delete r.selectedItemMap[s];r.nextDisplayIndex=t}function nz(r){r.__itemModelArray=[],r.__itemIdToModel={},r.__helperIdToModel={},r.__toolPreviewIdToModel={},r.__anyDependsOnRandomSeed=!1}function uM(r,e){let t={},i=[];return e.forEach(n=>{let o=r.__itemIdToModel[n];if(o&&!aM(o)){let s=Jm(r,n);for(let a of s)t[a.id]||(t[a.id]=!0,i.push(a))}}),i}function Yb(r){return r.__itemModelArray.length}function UR(r){return r.__itemModelArray.filter(e=>e.type==="expression"&&e.folderId===__dcg_shared_module_exports__['Jc']&&!!Ba(e)).length}function HR(r){return r.nextDisplayIndex===1}function qR(r){for(var e=[],t=0;t<r.__itemModelArray.length;t++){var i=r.__itemModelArray[t];i.type==="expression"&&i.sliderExists&&e.push(i)}return e}function Wm(r){var e;for(var t in r.selectedItemMap){if(e!==void 0)return;e=t}if(e!==void 0)return r.__itemIdToModel[e]}function oz(r,e){return!!r.selectedItemMap[e]}function zR(r){return __dcg_shared_module_exports__['a']({},r.selectedItemMap)}function JD(r){var e=[];for(var t in r.selectedItemMap)e.push(r.__itemIdToModel[t]);return e}function $R(r){return{list:r.__itemModelArray.map(function(e){return e.cachedUndoRedoDiffState}),ticker:oR(r.ticker)}}function pM(r){return{list:r.__itemModelArray.map(function(e){return e.cachedUndoRedoFullState}),ticker:sR(r.ticker)}}function WR(r,e){let t={list:r.__itemModelArray.map(function(n){switch(n.type){case"expression":return Ph(n,e);case"image":return FD(n,e);case"table":return Xm(n,e);case"folder":return MD(n,e);case"text":return AD(n,e);default:return n}})},i=nR(r.ticker,e);return i&&(t.ticker=i),t}function jR(r){let e=0,t=/^[0-9]+$/;for(var i=r.list.length-1;i>=0;i--){var n=r.list[i];let o=n.id;if(t.test(o)){let s=parseInt(o,10);s>e&&(e=s)}if(n.type==="table"&&n.columns){for(let s=n.columns.length-1;s>=0;s--)if(o=n.columns[s].id,t.test(o)){let a=parseInt(o,10);a>e&&(e=a)}}}return e}function JR(r,e,t){t||(t={});var i,n;for(r.colorIdx=0,nz(r),r.expressionAnalysis={},i=0;i<e.list.length;i++){if(n=Nm(r,e.list[i]),t.remapColors&&"color"in n&&n.color){var o=__dcg_shared_module_exports__['E'](r.controller.getColors());__dcg_shared_module_exports__['q'](o,n.color)||(n.color=o_(n.color,o))}r.__itemModelArray.push(n),r.__itemIdToModel[n.id]=n}if(r.ticker=iM(e.ticker),qh(r),r.nextDisplayIndex===1){var s=Nm(r,{type:"expression",id:r.controller.generateId(),color:r.controller.getNextColor()});xl(r,s,r.__itemModelArray.length)}}function Nm(r,e){switch(e.type){case"expression":return lD(e,r.controller);case"table":return n2(e,r.controller);case"image":return YF(e,r.controller);case"folder":return xF(e,r.controller);case"text":return TF(e,r.controller);default:return e}}function YR(r,e){var t,i;let n=r.__itemIdToModel;for(r.__itemModelArray=[],r.__itemIdToModel={},t=0;t<e.list.length;t++){var o=e.list[t];if(i=n[o.id],i&&i.type===o.type)switch(i.type){case"expression":if(o.type!==i.type)throw new Error("invalid restoration");__(i,o);break;case"table":if(o.type!==i.type)throw new Error("invalid restoration");i2(i,o);break;case"image":if(o.type!==i.type)throw new Error("invalid restoration");XF(i,o);break;case"folder":{if(o.type!==i.type)throw new Error("invalid restoration");CF(i,o)}break;case"text":if(o.type!==i.type)throw new Error("invalid restoration");AF(i,o);break;default:return i}else i=Nm(r,o);r.__itemModelArray.push(i),r.__itemIdToModel[i.id]=i}e.ticker&&aR(r.ticker,e.ticker),dM(r),jD(r),qh(r)}function XR(r,e,t){let i=t[0]&&t[0].tableId,n=Sc(r,i||e);if(!n)return;let o;switch(n.type){case"expression":let s=!1;n.__workerNeedsDotplotXMode=!1;for(let c=0;c<t.length;c++){let u=t[c];if(u.graphMode===15){n.error=u.error;continue}"resolved"in u&&!u.resolved&&(s=!0),"boundingBox"in u&&u.boundingBox&&(o||(o=[]),o.push(u.boundingBox)),u.needsDotplotXMode&&(n.__workerNeedsDotplotXMode=!0)}n.unresolved=s,n.boundingBoxes=o;let a=1/0,l=-1/0;for(let c of t){if(c.graphMode!==6)continue;let u=c.sampledDomain;u&&(a=Math.min(a,u.min),l=Math.max(l,u.max))}isFinite(a)&&(n.__workerSampledDomainMin=a),isFinite(l)&&(n.__workerSampledDomainMax=l);return;case"table":for(let c=0;c<t.length;c++){let u=t[c];"boundingBox"in u&&u.boundingBox&&(o||(o=[]),o.push(u.boundingBox))}o&&o2(n,e,o);return;default:return}}function QR(r,e){var t,i,n,o=__dcg_shared_module_exports__['j'](r.expressionAnalysis);for(t in e){if(!e.hasOwnProperty(t))continue;n=e[t],i=Sc(r,t);let s={isGraphable:!!n.is_graphable,isError:!!n.error,errorMessage:n.error?r.controller.unpack(n.error):void 0};if(i)switch(i.type){case"expression":if(VT(i,n),n.zero_values&&n.zero_values.length===1){let c=n.zero_values[0].val;__dcg_shared_module_exports__['K'](c)&&(s.evaluation={type:"Number",value:c},s.evaluationDisplayed=!0),__dcg_shared_module_exports__['I'](c)&&c.every(__dcg_shared_module_exports__['K'])&&(s.evaluation={type:"ListOfNumber",value:c.slice()},s.evaluationDisplayed=!0)}else n.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['K'](n.constant_value)&&(s.evaluation={type:"Number",value:n.constant_value},s.evaluationDisplayed=!1);break;case"image":jF(i,n);break;case"table":r2(i,n);break;case"folder":case"text":break;default:return i}else t===r.ticker.id&&lR(r.ticker,n);let a=iz(r,t);if(a)PF(r.controller,a,n);else{let l=r.__toolPreviewIdToModel[t];l&&VT(l,n)}t.startsWith(Pm)&&vR(r.controller.getGeometryToolbarModel(),t,n),t!==r.ticker.id&&!t.startsWith(Pm)&&(o[t]=s)}dM(r),jD(r),r.expressionAnalysis=o}function ui(r,e){if(r.selectedItemMap={},!!e){if(e.type==="image"&&e.folderId){let t=Sc(r,e.folderId);t&&t.type==="folder"&&t.collapsed&&(e=t)}r.selectedItemMap[e.id]=!0}}function hM(r,e){r.selectedItemMap[e]?delete r.selectedItemMap[e]:r.selectedItemMap[e]=!0}function gM(r,e){r.selectedItemMap=__dcg_shared_module_exports__['a']({},e)}function Ip(r,e,t,i){if(e===t)return;let n=r.__itemModelArray.splice(e,i);e<t&&(t=t-i+1),r.__itemModelArray.splice.apply(r.__itemModelArray,[t,0,...n]),qh(r)}function xl(r,e,t){var i=String(e.id);if(r.__itemIdToModel.hasOwnProperty(i))throw Error("Item with id '"+i+"' is already in list");r.__itemIdToModel[i]=e,r.__itemModelArray.splice(t,0,e),qh(r)}function Ec(r,e){xl(r,e,Yb(r))}function jm(r,e){let t=[];var i=r.__itemModelArray[e];if(i.type==="folder"){let o=0,s=e+1;for(let a=s;a<r.__itemModelArray.length;a++){var n=r.__itemModelArray[a];if(n.type==="folder"||n.folderId!==i.id)break;ba(n)&&ui(r,void 0),n.readonly?(a>s&&(r.__itemModelArray[a]=r.__itemModelArray[s],r.__itemModelArray[s]=n),us(n,""),s+=1):(delete r.__itemIdToModel[n.id],delete r.expressionAnalysis[i.id],o+=1)}o>0&&t.push(...r.__itemModelArray.splice(s,o))}return ba(i)&&ui(r,void 0),t.push(...r.__itemModelArray.splice(e,1)),delete r.__itemIdToModel[i.id],delete r.expressionAnalysis[i.id],dM(r),qh(r),t}function ZR(r){return r.__anyDependsOnRandomSeed}function e2(r){return r.__anyIsAction}function Jm(r,e){let t=Sc(r,e);return t?jm(r,t.index):[]}function YD(r){let e=Wm(r);if(!e)return!1;let t=Uh(r,e.index);return t?(ui(r,t),t.index===Yb(r)-1&&e.type==="expression"&&Na(e)&&jm(r,t.index),!0):!1}function XD(r){let e=Wm(r);if(!e)return!1;let t=Hh(r,e.index);return t?(ui(r,t),!0):!1}function ba(r){return!!r.controller.getListModel().selectedItemMap[r.id]}function Xb(r,e){r.dragState=e}function Qb(r){switch(r.type){case"expression":return rD(r);case"image":return _D(r);case"table":return[];case"text":return[];case"folder":return[];default:return r}}function t2(r,e){for(let t of cM(r))t.type==="folder"&&Mm(t,e)}function Ym(r){return r?r.type==="image"&&Bh(r)||r.type==="expression"&&fa(r):!1}var sz=30,az=10,nS=__dcg_shared_module_exports__['S'].RED,oS=__dcg_shared_module_exports__['S'].BLUE,sS=__dcg_shared_module_exports__['S'].GREEN,aS=__dcg_shared_module_exports__['S'].PURPLE,lS=__dcg_shared_module_exports__['S'].ORANGE,cS=__dcg_shared_module_exports__['S'].BLACK;function zh(r,e){switch(e){case __dcg_shared_module_exports__['S'].RED:return r.s("graphing-calculator-text-color-red");case __dcg_shared_module_exports__['S'].BLUE:return r.s("graphing-calculator-text-color-blue");case __dcg_shared_module_exports__['S'].GREEN:return r.s("graphing-calculator-text-color-green");case __dcg_shared_module_exports__['S'].PURPLE:return r.s("graphing-calculator-text-color-purple");case __dcg_shared_module_exports__['S'].ORANGE:return r.s("graphing-calculator-text-color-orange");case __dcg_shared_module_exports__['S'].BLACK:return r.s("graphing-calculator-text-color-black");case __dcg_shared_module_exports__['S'].GRAY:return r.s("graphing-calculator-text-color-gray");default:return r.s("graphing-calculator-text-color-unknown")}}var mM=r=>{if(!Array.isArray(r))return[r];let e=Array(Math.min(r.length,az));for(let t=0;t<e.length;t++)e[t]=r[Math.round(t*r.length/e.length)];return e};function s2(r,e){switch(r.type){case"single-color":case"color-array":return mM(r.value).every(i=>vT(i,e));case"gradient_u":case"gradient_v":case"checkers":case"shader":case"image":return!1;default:let t=r;throw new Error("Unexpected ColorSwatchSpec type: "+t.type)}}function dS(r,e,t=xT){switch(r.type){case"single-color":case"color-array":return mM(r.value).some(n=>vT(n,e,t));case"gradient_u":case"gradient_v":case"checkers":case"shader":case"image":return!0;default:let i=r;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}}var Qm=r=>{switch(r.type){case"single-color":return r.value;case"color-array":let e=mM(r.value);if(e.length===0)return __dcg_shared_module_exports__['S'].BLACK;if(e.length===1)return r.value[0];let t=sz/e.length;return`linear-gradient(to right${e.reduce((n,o,s)=>`${n}, ${o} ${s*t}px, ${o} ${(s+1)*t}px`,"")})`;case"gradient_u":return"linear-gradient(90deg,hsl(0, 100%, 50%),hsl(30, 100%, 50%),hsl(60, 100%, 50%),hsl(90, 100%, 50%),hsl(120, 100%, 50%),hsl(150, 100%, 50%),hsl(180, 100%, 50%),hsl(210, 100%, 50%),hsl(240, 100%, 50%),hsl(270, 100%, 50%),hsl(300, 100%, 50%),hsl(330, 100%, 50%),hsl(360, 100%, 50%)";case"gradient_v":return"linear-gradient(180deg,hsl(0, 100%, 50%),hsl(30, 100%, 50%),hsl(60, 100%, 50%),hsl(90, 100%, 50%),hsl(120, 100%, 50%),hsl(150, 100%, 50%),hsl(180, 100%, 50%),hsl(210, 100%, 50%),hsl(240, 100%, 50%),hsl(270, 100%, 50%),hsl(300, 100%, 50%),hsl(330, 100%, 50%),hsl(360, 100%, 50%)";case"checkers":return"repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 16px 16px";case"shader":return"#808080";case"image":return'url("'+r.value+'")';default:let i=r;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}};var lz=0;function cz(){return"abstract_item_"+lz++}function xd(r){return{guid:cz(),controller:r,index:-1,displayIndex:-1,secretIndex:-1,isHiddenFromUI:!0,renderShell:!0}}function fM(r,e){r.secret=e}function uS(r,e){r.readonly=e}function us(r,e){r.type!=="folder"&&(r.folderId=e)}function vd(r){r.isHiddenFromUI=lM(r)}function pS(r){return r.isHiddenFromUI||r.filteredBySearch?"none":r.renderShell?"shell":"render"}function kc(r){let e=Zb(r),t=e.type==="color-array"?{type:"single-color",value:e.value[0]}:e;return Qm(t)}function Zb(r){if(!r.colorLatex)return{type:"single-color",value:r.color};switch(r.colorLatex){case"gradient_u":case"gradient_v":case"checkers":return{type:r.colorLatex};default:if(/^data:image/.test(r.colorLatex))return{type:"image",value:r.colorLatex};let e,t;return r.type==="expression"?(e=yF(r),t=fF(r)):r.type==="table-column"&&(e=c2(r),t=l2(r)),t&&e?Array.isArray(e)?{type:"color-array",value:e}:{type:"single-color",value:e}:{type:"single-color",value:r.color}}}var d2={folderId:"",secret:!1,readonly:!1},hS={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""};function gS(r){let e=(r.columns||[]).map(function(t){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},hS),t)});return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},d2),r),{columns:e})}function u2(r){return r=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{columns:r.columns.map(function(e){return __dcg_shared_module_exports__['Ac'](hS,e)})}),__dcg_shared_module_exports__['Ac'](d2,r)}function mS(r){return{type:"table",id:r.id,columns:r.columns.map(function(e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{tableId:r.id})})}}function uz(r){return isFinite(r)?__dcg_shared_module_exports__['Hb'](r,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function pz(r,e,t){let i=r.columnModels[e];i.error=t.error,i.discrete=t.discrete,i.disabled=t.dependent,i.draggable=!t.error&&!t.dependent,i.packedErrors=[],i.computedValues=[];let n=t.values;for(let o=n.length-1;o>=0;o--){let s=n[o];typeof s=="number"?i.computedValues[o]=uz(s):(i.computedValues[o]="",i.packedErrors[o]=s)}}function h2(r){let e=Jo(r);if(!e)return;let t=Wh(r);if(!t){r.isExpanded||Zm(r,!0);return}e.row>=t.min&&e.row<t.max&&Zm(r,!0)}function Wh(r){if(r.isExpanded)return;let e=wa(r);if(!(e<30))return{min:8,max:e-4}}function g2(r,e){let t=r.columnModels[e];return{values:t.values.slice(),dragMode:t.dragMode,hidden:t.hidden,id:t.id,color:t.color,points:t.points,lines:t.lines,pointStyle:t.pointStyle,lineStyle:t.lineStyle,latex:t.latex,colorLatex:t.colorLatex,lineOpacity:t.lineOpacity,lineWidth:t.lineWidth,pointSize:t.pointSize,pointOpacity:t.pointOpacity}}var hz=0;function gz(){return"table_guid_"+hz++}function mz(r,e,t){r.columnModels[e].values.splice(t,0,"")}function fz(r,e,t){r.columnModels[e].values.splice(t,1)}function m2(r,e,t){let{color:i}=t;(!i||!wm(i))&&(i=r.controller.getNextColor());let n=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{type:"table-column",guid:gz(),index:e,error:void 0,table:r,color:i,packedErrors:[],computedValues:[],discrete:void 0,shouldGraph:void 0,disabled:void 0,draggable:void 0});return e===0&&(n.hidden=!0),n}function ew(r,e){var t=r.table.formula;if(!t)return!1;var i=t.column_data[r.index];return i?!!i[e]:!1}function l2(r){return ew(r,"color_latex_valid")}function f2(r){return ew(r,"line_opacity_valid")}function y2(r){return ew(r,"line_width_valid")}function b2(r){return ew(r,"point_size_valid")}function w2(r){return ew(r,"point_opacity_valid")}function c2(r){var e=r.table.formula;if(e){var t=e.column_data[r.index];if(t)return t.color_latex_value}}function x2(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={columns:Xm(r,{stripDefaults:!1}).columns}):delete r.preTransientState,vd(r);let e=Ua(r);var t=e&&e.hidden;__dcg_shared_module_exports__['l'](r.columnModels,function(i){i.shouldGraph=!t&&!i.hidden&&!r.controller.is3dProduct()}),bz(r),wz(r),yz(r)}function wa(r){let e=2,t,i=Jo(r);return i&&i.row>e&&(e=i.row),r.columnModels.forEach(n=>{t=n.disabled?n.computedValues.length:n.values.length+1,t>e&&(e=t)}),e}function ef(r){return r.columnModels.length}function r2(r,e){r.formula=e;for(let i=0;i<e.column_data.length&&i<ef(r);i++){let n=e.column_data[i];pz(r,i,n)}let t=r.columnModels[r.columnModels.length-1];t.disabled=!0,t.error=void 0}function yM(r,e){for(let t=0;t<r.columnModels.length;t++)mz(r,t,e)}function v2(r,e){let t=Wh(r);t&&e===t.max-1&&Zm(r,!0);for(var i=0;i<r.columnModels.length;i++)fz(r,i,e),i>0&&O2(r.columnModels[i])}function fS(r,e){let t={id:r.controller.generateId(),latex:e?e.latex:"",color:r.controller.getNextColor()},i=e?e.columnIndex:r.columnModels.length,n=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},hS),t),{values:[]});var o=m2(r,i,n);r.columnModels.splice(i,0,o);for(var s=i+1;s<r.columnModels.length;s++)r.columnModels[s].index=s}function C2(r,e){r.columnModels.splice(e,1);for(var t=e;t<r.columnModels.length;t++)r.columnModels[t].index=t}function D2(r,e){var t,i=r.columnModels.length,n=[];for(t=0;t<i;t++)n.push("");var o=r.columnModels[0].values;if(e>1){var s=r.controller.isDegreeMode(),a=Si(o[0],s),l=Si(o[1],s);if(isFinite(a)&&isFinite(l)){var c=t_(a,l);if(c){var u=c.nstart,p=u/c.lcm;for(t=0;t<e;t++){var g=Si(o[t],s);if(!__dcg_shared_module_exports__['ba'](g,p))return n;u+=c.nstep,p=u/c.lcm}(""+a).length<8&&(""+l).length<8?n[0]=""+p:n[0]="\\frac{"+u+"}{"+c.lcm+"}"}}}return n}function QD(r,e){for(let n=0;n<r.columnModels.length;n++){let o=r.columnModels[n],s={cellLocation:{column:n,row:0}};e(o.latex,"tableHeader",s),e(o.colorLatex,"tableColumnColorLatex",s),e(o.pointSize,"tableColumnPointSize",s),e(o.pointOpacity,"tableColumnPointOpacity",s),e(o.lineWidth,"tableColumnLineWidth",s),e(o.lineOpacity,"tableColumnLineOpacity",s);for(var t=r.columnModels[n],i=0;i<t.values.length;i++)t.values[i]&&e(t.values[i],"tableCellValue",{cellLocation:{column:n,row:i+1}})}}function yz(r){let e=mS({type:"table",id:r.id,secret:r.secret,readonly:r.readonly,folderId:r.folderId,columns:r.columnModels.map(function(i){return g2(r,i.index)})});for(var t=0;t<e.columns.length;t++)e.columns[t].hidden=!r.columnModels[t].shouldGraph;r.cachedParsableState=e}function S2(r){return r.slice(0,r.length-1)}function Xm(r,e){let t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cachedViewState),{columns:S2(r.cachedViewState.columns)});return e.stripDefaults?u2(t):t}function bz(r){var e=r.columnModels.map(function(t,i){return g2(r,i)});r.cachedViewState={id:r.id,type:r.type,folderId:r.folderId,columns:e,secret:r.secret,readonly:r.readonly}}function bM(r,e){r.draggingOnGraphpaper=e}function wz(r){let e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cachedViewState),{columns:S2(r.cachedViewState.columns)});r.cachedUndoRedoFullState=e,r.preTransientState&&(e=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},e),r.preTransientState)),r.cachedUndoRedoDiffState=e}var xz={id:!1,type:!1,columns:!1,folderId:!0,secret:!0,readonly:!0};function i2(r,e){__dcg_shared_module_exports__['Dc']({from:e,to:r,props:xz}),E2(r,e.columns)}function n2(r,e){let t=__dcg_shared_module_exports__['j'](gS(r)),i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),xd(e)),{columnModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},isExpanded:!1});return E2(i,t.columns),i}function E2(r,e){r.columnModels=e.map(function(t,i){return m2(r,i,t)}),fS(r)}var p2=["x","y","z","u","v","w"];function wM(r,e,t){for(var i=[],n=Math.min(e.length,p2.length),o=0;o<n;o++)i.push({id:t.generateId(),latex:__dcg_shared_module_exports__['Ib'](p2[o]+"_"+r),values:e[o],color:t.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineWidth:"",lineOpacity:"",pointOpacity:"",pointSize:""});return{id:t.generateId(),type:"table",folderId:"",secret:!1,readonly:!1,columns:i}}function k2(r,e){let t=Xm(r,{stripDefaults:!1});if(!t.columns||!e.columns)return e;for(var i=0;i<e.columns.length;i++){var n=t.columns[i],o=e.columns[i];if(n)for(var s in n)n.hasOwnProperty(s)&&(o.hasOwnProperty(s)||(o[s]=n[s]))}return e}function Jo(r){var e=r.controller.getFocusLocation();if(e&&e.type==="table"&&e.id===r.id)return e.location}function ps(r,e){for(var t=0;t<r.columnModels.length;t++){let i=r.columnModels[t];if(i.id===e)return i}}function xM(r,e,t){let i=ps(r,e);i&&(i.points=t,t||(i.dragMode="NONE"))}function G2(r,e,t){let i=ps(r,e);i&&(i.pointStyle=t)}function I2(r,e,t){let i=ps(r,e);i&&(i.lines=t)}function V2(r,e,t){let i=ps(r,e);i&&(i.lineStyle=t)}function ZD(r,e,t){let i=ps(r,e);i&&(i.lineWidth=t)}function eS(r,e,t){let i=ps(r,e);i&&(i.lineOpacity=t)}function tS(r,e,t){let i=ps(r,e);i&&(i.pointSize=t)}function rS(r,e,t){let i=ps(r,e);i&&(i.pointOpacity=t)}function T2(r,e,t){let i=ps(r,e);i&&(i.dragMode=t,t!=="NONE"&&!i.points&&(i.points=!0))}function M2(r,e,t){let i=ps(r,e);!i||!wm(t)||(i.color=t,i.colorLatex="")}function iS(r,e,t){let i=ps(r,e);i&&(i.colorLatex=t)}function Zm(r,e){r.isExpanded=e}function A2(r,e,t){let i=ps(r,e);i&&(i.hidden=t,t&&L2(r))}function o2(r,e,t){let i=ps(r,e);i&&(i.boundingBoxes=t,L2(r))}function L2(r){let e=[];r.columnModels.forEach(t=>{t.boundingBoxes&&!t.hidden&&(e=e.concat(t.boundingBoxes))}),r.boundingBoxes=e}function yS(r,e){let t=ps(r,e);return t?!t.points&&!t.lines:!0}function yu(r,e,t){if(e.row===0){let o=r.columnModels[e.column].id,s=ps(r,o);if(!s)return;s.latex=t,e.column>=r.columnModels.length-1&&fS(r);return}for(var i=r.columnModels[e.column],n=i.values.length;n<e.row-1;n++)i.values[n]="";r.columnModels[i.index].values[e.row-1]=t,e.column>0&&O2(r.columnModels[i.index])}function O2(r){for(;r.values.length>0&&!r.values[r.values.length-1];)r.values.pop()}function P2(r,e){return!!r.columnModels[e.column]&&e.row>=0}function _2(r){let e;if(r.values){for(e of r.values)if(e!=="")return!1}if(r.computedValues){for(e of r.computedValues)if(e!=="")return!1}return!0}function tw(r,e,t){let i=r.columnModels[t];return i.disabled?i.computedValues[e]||"":i.values[e]||""}function F2(r){let e=wa(r),t=ef(r);for(let i=0;i<t;i++)if(tw(r,e-1,i)!=="")return!1;return!0}function vM(r){var e=r&&r.id;if(r&&r.type==="table"){var t=Jo(r);if(t){var i=r.columnModels[t.column];e=i?i.id:void 0}else e=void 0}return e}function R2(r,e,t){var i=r.getAllSelectedItems(),n={};for(var o of i){var s=vM(o);s!==void 0&&(n[s]=!0,t[s]||e.selectSketch(s))}for(let a in t)n[a]||e.deselectSketch(a);return n}var Ul=function(r){if(!r)return;let e=r.getBoundingClientRect();return{top:e.top+window.scrollY,left:e.left+window.scrollX}},Gc=function(r,e){Object.assign(r.style,e)};function B2(r){return!!(r&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length))}var xa=function(r,e,t){let i,n=e.getBoundingClientRect().height,o=r.getBoundingClientRect().height,s=Ul(r),a=Ul(e);if(!s||!a)return!1;let l=e.scrollTop,c=s.top+l-a.top,u=c-t,p=o+c+t-n;return u>=p?i=Math.min(Math.max(l,p),u):i=.5*(u+p),i!==l?(e.scrollTop=i,e.scrollTop!=l):!1};var vz=1,Cz=2,Dz=4,Sz=8,wS=15,K2=12,U2=3,H2=1,q2=2,z2=3,$2=4,nf=5,rw=6;function bu(r,e,t){let i=[],n=r.length;if(t===nf)for(let o=0;o<n;o+=2){let s=e.mapX(r[o]),a=e.mapY(r[o+1]);i.push(s,a)}else if(t===rw)for(let o=0;o<n;o+=2){let s=e.mapX(r[o+1]),a=e.mapY(r[o]);i.push(s,a)}else if(t===H2)for(let o=0;o<r.length;o+=2){let s=r[o],a=r[o+1],l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}else if(t===q2)for(let o=0;o<r.length;o+=2){let s=r[o],a=r[o+1];a<0&&(a=0);let l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}else if(t===z2)for(let o=0;o<r.length;o+=2){let s=r[o]*Math.PI/180,a=r[o+1],l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}else if(t===$2)for(let o=0;o<r.length;o+=2){let s=r[o]*Math.PI/180,a=r[o+1];a<0&&(a=0);let l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}return i}function iw(r,e,t,i=3){let[n,o,s,a]=r,{x:l,y:c}=e.mathToPixels.mapPoint({x:n,y:o}),{x:u,y:p}=e.mathToPixels.mapPoint({x:s,y:a}),g=Math.min(i,Math.max(e.screen.width,e.screen.height)),h={xmin:-g,ymin:-g,xmax:e.screen.width+g,ymax:e.screen.height+g},b=l-u,C=c-p,D=-b,S=-C,V=l-h.xmin,k=h.xmax-l,T=c-h.ymin,A=h.ymax-c,R=[],P=[];if(b!==0){let B=V/b,q=k/D;b<0?(R.push(B),P.push(q)):(R.push(q),P.push(B))}if(C!==0){let B=T/C,q=A/S;C<0?(R.push(B),P.push(q)):(R.push(q),P.push(B))}(t===17||t===24)&&(R.push(0),P.push(1)),t===19&&R.push(0);let W=Math.max(...R),H=Math.min(...P);if(W>H)return{mapped:[l,c,u,p],clipped:[]};let j=l+D*W,ne=c+S*W,le=l+D*H,w=c+S*H;return j<h.xmin&&le<h.xmin||j>h.xmax&&le>h.xmax||ne<h.ymin&&w<h.ymin||ne>h.ymax&&w>h.ymax?{mapped:[l,c,u,p],clipped:[]}:{mapped:[l,c,u,p],clipped:[j,ne,le,w]}}function xS(r,e){return vS(r,e,wS,!0)}function bS(r,e,t,i){let n=[],o,s,a,l;i?(s=r[0],a=r[1],o=2,l=e(s,a),l&&n.push(s,a)):(s=r[r.length-2],a=r[r.length-1],o=0,l=e(s,a));for(var c=o;c<r.length;c+=2){let u=s,p=a,g=l;s=r[c],a=r[c+1],l=e(s,a),!(!l&&!g)&&(l&&g&&n.push(s,a),l&&!g&&(Array.prototype.push.apply(n,t(s,a,u,p)),n.push(s,a)),!l&&g&&Array.prototype.push.apply(n,t(u,p,s,a)))}return n}function vS(r,e,t,i){let n=e.xmin,o=e.xmax,s=e.ymin,a=e.ymax,l=function(S,V){return S>=n},c=function(S,V){return S<=o},u=function(S,V){return V>=s},p=function(S,V){return V<=a},g=function(S,V,k,T){S=S,V=V,k=k,T=T;let A=T-V;return[n,V+A*(n-S)/(k-S)]},h=function(S,V,k,T){S=S,V=V,k=k,T=T;let A=T-V;return[o,V+A*(o-S)/(k-S)]},b=function(S,V,k,T){S=S,V=V,k=k,T=T;let A=k-S;return[S+A*(s-V)/(T-V),s]},C=function(S,V,k,T){S=S,V=V,k=k,T=T;let A=k-S;return[S+A*(a-V)/(T-V),a]},D=r;return t&Dz&&(D=bS(r,l,g,i)),t&Cz&&(D=bS(D,u,b,i)),t&Sz&&(D=bS(D,c,h,i)),t&vz&&(D=bS(D,p,C,i)),D}function W2(r,e,t){let i=[],n=r[0],o=n+t,s=[];i.push(s);for(let a=0;a<r.length;a+=2){let l=r[a],c=r[a+1];if(c<0&&(c=0),l>=o){for(s=[],i.push(s),n=r[a-2],o=n;l>=o;)o+=t;a-=4}else s.push(l,c)}if(e===0)for(let a=0;a<i.length;a++)i[a].push(0,0);else{let a=t/16,l=e;for(let c=0;c<i.length;c++){let u=i[c];n=u[0],o=u[u.length-2];for(let p=o;p>n;p-=a)u.push(p,l);u.push(n,l)}}return i}function CM(r,e){return r=r.slice(),r.push(r[r.length-2],e),r.push(r[0],e),[r]}function nw(r,e,t){switch(r){case 1:return rw;case 8:case 5:case 2:return nf;case 6:return t.degreeMode?e?$2:z2:e?q2:H2}}var Bs=class{constructor(e,t,i){this.pattern=i,this.replen=this.pattern[0]+this.pattern[1],t/this.replen>1e3&&(this.pattern[0]=t*this.pattern[0]/this.replen/1e3,this.pattern[1]=t*this.pattern[1]/this.replen/1e3),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e}static getDashedPattern(e,t){let i=e.lineWidth*11/(t?3.5:2.5),n=i*7/11;return[i,n]}static getDottedPattern(e,t,i){let n=.5*e.lineWidth*.1/(i?3.5:2.5),o=n*8/.1;return t&&(o*=2),[n,o]}static getTotalSegmentLength(e){if(e.length<4)return 0;let t=0,i=0,n=e[0],o=e[1];for(;isNaN(n)||isNaN(o);){if(i+=2,i>=e.length)return 0;n=e[i],o=e[i+1]}let s,a;for(i+=2;i<e.length;i+=2)s=e[i],a=e[i+1],!(isNaN(s)||isNaN(a))&&(t+=__dcg_shared_module_exports__['X'](s-n,a-o),n=s,o=a);return t}start(e,t){this.px=e,this.py=t}next(e,t){if(this.px===null||this.py===null)throw new Error("Must call start before calling next");let i=this.pattern[this.pstate],n=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(t-this.py,2));if(n>1e-5){for(;n+this.dstaccum>=i;){let o=e-this.px,s=t-this.py,a=i-this.dstaccum;o*=a/n,s*=a/n,this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+o,this.py+s)),this.dstaccum=0,this.px+=o,this.py+=s,this.pstate=this.pstate===0?1:0,i=this.pattern[this.pstate],n-=a}this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,t))}this.px=e,this.py=t,this.dstaccum+=n}close(){this.pstate=0,this.dstaccum=0,this.px=null,this.py=null}drawSegment(e){let t=0,i=e[0],n=e[1];for(;isNaN(i)||isNaN(n);){if(t+=2,t>=e.length)return;i=e[t],n=e[t+1]}this.start(i,n);let o,s;for(t+=2;t<e.length;t+=2)o=e[t],s=e[t+1],!(isNaN(o)||isNaN(s))&&this.next(o,s);this.close()}};var Mp=10,Ap=3;function CS(r,e){return r+1e-8*(e-r)>r&&e-r>1e-300&&e-r<1e300}function J2(r,e){return r>1e-300&&CS(r,e)}
var hn=class{
    constructor(e=-10,t=10,i=-10,n=10,o=-2,s=2){
        this.xmin=e,
        this.xmax=t,
        this.ymin=i,
        this.ymax=n,
        this.zmin=o,
        this.zmax=s
    }
    static fromObject({xmin:e,xmax:t,ymin:i,ymax:n,zmin:o,zmax:s}){
        return new hn(e,t,i,n,o,s)
    }
    toObject(){
        return{xmin:this.xmin,ymin:this.ymin,zmin:this.zmin,xmax:this.xmax,ymax:this.ymax,zmax:this.zmax}
    }
    equals(e){
        return!(this.xmin!==e.xmin||this.ymin!==e.ymin||this.zmin!==e.zmin||this.xmax!==e.xmax||this.ymax!==e.ymax||this.zmax!==e.zmax)
    }
    isXValid(e){
        return e==="linear"?CS(this.xmin,this.xmax):J2(this.xmin,this.xmax)
    }
    isYValid(e){
        return e==="linear"?CS(this.ymin,this.ymax):J2(this.ymin,this.ymax)
    }
    isZValid(){
        return this.zmin===void 0||this.zmax===void 0?!1:CS(this.zmin,this.zmax)
    }
    isValid(e){
        return this.isXValid(e.xAxisScale)&&this.isYValid(e.yAxisScale)
    }
    isSquare(e,t){
        return Math.abs(e.height-e.width*this.aspectRatio(t))<1
    }
    isSquare3D(){
        let{xmin:e,xmax:t,ymin:i,ymax:n,zmin:o,zmax:s}=this;
        if(o===void 0||s===void 0)
            return!1;
        let a=[t-e,n-i,s-o];
        return Math.min(...a)/Math.max(...a)>.99999
    }
    aspectRatio(e){
        let t=Mp/Ap,
            i=e.yAxisScale==="linear"?this.ymax-this.ymin:Math.log10(this.ymax/this.ymin)*t,
            n=e.xAxisScale==="linear"?this.xmax-this.xmin:Math.log10(this.xmax/this.xmin)*t;
        return i/n
    }
    getSquaredAxisLimits({axis:e,screen:t,settings:i}){
        let[n,o,s,a,l]=e==="y"?[
            {min:this.ymin,max:this.ymax},
            {min:this.xmin,max:this.xmax},
            t.height/t.width,
            i.yAxisScale,
            i.xAxisScale
        ]:[
            {min:this.xmin,max:this.xmax},
            {min:this.ymin,max:this.ymax},
            t.width/t.height,
            i.xAxisScale,i.yAxisScale
        ];
        if(a==="logarithmic"){
            let h=Math.log(n.max)-Math.log(n.min),
                b=l==="logarithmic"?Math.log(o.max)-Math.log(o.min):(o.max-o.min)*Ap/(Mp*Math.LOG10E),
                D=.5*(s*b-h);
            return{min:Math.exp(Math.log(n.min)-D),max:Math.exp(Math.log(n.max)+D)}
        }
        let c=n.max-n.min,
            g=.5*((l==="logarithmic"?(Math.log10(o.max)-Math.log10(o.min))*Mp/Ap:o.max-o.min)*s-c);
        return{min:n.min-g,max:n.max+g}
    }
    squareXAxis(e,t){
        let{min:i,max:n}=this.getSquaredAxisLimits({axis:"x",screen:e,settings:t}),
            o=new hn(i,n,this.ymin,this.ymax);
        return o.isXValid(t.xAxisScale)?o:this
    }
    squareYAxis(e,t){
        let{min:i,max:n}=this.getSquaredAxisLimits({axis:"y",screen:e,settings:t}),
            o=new hn(this.xmin,this.xmax,i,n);
        return o.isYValid(t.yAxisScale)?o:this
    }
    squareCrop(e,t){
        return this.aspectRatio({xAxisScale:t.xAxisScale,yAxisScale:t.yAxisScale})>e.height/e.width?this.squareYAxis(e,t):this.squareXAxis(e,t)
    }
    polarDiameter(){
        let e=Math.abs(this.xmax),
            t=Math.abs(this.xmin),
            i=Math.abs(this.ymax),
            n=Math.abs(this.ymin);
        return 1.5*Math.max(e,t,i,n)
    }
    largestR(){
        return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))
    }
    smallestR(){
        return this.xmin<=0&&this.xmax>=0&&this.ymin<=0&&this.ymax>=0?0:this.xmin<=0&&this.xmax>=0?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&this.ymax>=0?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))
    }
};
var DS={IS_HOVERED:1.2,IS_PRESSED:1.4,IS_GHOSTED:.4},
    ow={IS_HOVERED:.5,IS_DEPRESSED:.3},SM={IS_GHOSTED:.4},
    SS={IS_HOVERED:.3,IS_DEPRESSED:.5},ES={IS_GHOSTED:.4},
    sw=1;
function gn(r,e){
    let t=r;
    t._dcgSaveClassName&&t._dcgSaveClassName(e)
}
function Hi(r){
    let e=r;
    e._dcgRestoreClassName&&e._dcgRestoreClassName()
}
var wu;
function X2(r,e){
    if(wu&&wu.color===e&&wu.img===r)
        return wu.canvas;
    wu?(
        wu.color=e,
        wu.img=r
    ):
        wu={
            color:e,
            img:r,
            canvas:document.createElement("canvas")
        };
    var t=wu.canvas;
    t.width=0,
    t.width=r.width,
    t.height=r.height;
    var i=t.getContext("2d");
    return i.drawImage(r,0,0),
        i.fillStyle=e,
        i.globalCompositeOperation="source-atop",
        i.fillRect(0,0,r.width,r.height),
        t
}
function kS(r,e,t,i){
    let n=r.formula;
    if(!n||!n.dimensions.x)
        return;
    let o=n.dimensions;
    for(var s=0;s<o.x.length;s++){
        var a=o.x[s],
            l=o.y[s],
            c=o.width[s],
            u=o.height[s],
            p=o.radianAngle[s];
        if(!(!isFinite(a)||!isFinite(l)||!isFinite(c)||!isFinite(u)||!isFinite(p))){
            gn(e,"dcg-svg-image"),
            e.save(),
            Hi(e),
            e.globalAlpha=o.opacity[s];
            var g=t.mapy(u)-t.mapy(0),
                h=t.mapx(c)-t.mapx(0),
                b=p===0?1:Math.abs(h/c*(u/g)),
                C=t.mapx(a),
                D=t.mapy(l),
                S=C-h/2,
                V=D+g*b/2,
                k=u<0?-1:1,
                T=c<0?-1:1,
                A=S*T,
                R=V*k,
                P=Math.abs(h),
                W=Math.abs(g);
            p!==0&&(
                e.translate(C,D),
                e.scale(1,1/b),
                e.rotate(p),
                e.translate(-C,-D)
            ),
            e.scale(T,k);
            var H=!1,
                j=!1;
                H=i.shouldDrawHovered(r.id,s),
                j=i.shouldDrawPressed(r.id,s);
            var ne=r.imageObj,
                le=ne;
            j
                ?r.depressedImageObj
                    ?le=r.depressedImageObj
                    :le=X2(ne,"rgba(50,50,50,0.2)")
                :H&&(
                    r.hoveredImageObj
                        ?le=r.hoveredImageObj
                        :le=X2(ne,"rgba(200,200,200,0.2)")
                ),
            e.drawImage(le,A,R,P,W*b),
            ba(r)&&r.controller.isTraceEnabled()&&(
                e.beginPath(),
                e.rect(A,R,P,W*b),
                e.restore(),
                e.save(),
                e.strokeStyle="#6993C7",
                e.lineWidth=2,
                e.stroke()
            ),
            e.restore()
        }
    }
}
function Ks(r,e){
    let t=r;
    t._dcgStartNamedGroup&&t._dcgStartNamedGroup(e)
}
function aw(r,e){
    let t=r;
    t._dcgSetTitle&&t._dcgSetTitle(e)
}
function Us(r){
    let e=r;
    e._dcgEndNamedGroup&&e._dcgEndNamedGroup()
}
function Q2(r){
    return r.uncommitted
        ?"#ccc"
        :!r.selected&&!r.hovered&&Z2(r)===1
            ?__dcg_shared_module_exports__['Q'](r.color,.2)
            :r.color
}
function Z2(r){
    let e=.6;
    return r.hidden
        ?r.selected
            ?e=.4
            :e=.25
        :r.selected||r.isPoint
            ?e=1
            :r.hovered&&(
                e=.8
            ),
    r.isTransparentObject&&(
        e*=.3
    ),
    e
}
function Ez(r){
    return r.hidden
        ?r.isPoint
            ?0
            :r.selected
                ?.3
                :.2
        :r.selected||r.isPoint||r.hovered
            ?1
            :.7
}
function eN(r,e){
    r=r.replace(/#/,"");
    if(r.length===3)
        var t=parseInt(r.slice(0,1)+r.slice(0,1),16),
            i=parseInt(r.slice(1,2)+r.slice(1,2),16),
            n=parseInt(r.slice(2,3)+r.slice(2,3),16);
    else if(r.length===6)
        var t=parseInt(r.slice(0,2),16),
            i=parseInt(r.slice(2,4),16),
            n=parseInt(r.slice(4,6),16);
    else
        var t=0,
            i=0,
            n=0;
    return`rgba(${t}, ${i}, ${n}, ${e})`
}
function cw(r){
    return eN(Q2(r),Ez(r))
}
function GS(r){
    return eN(Q2(r),Z2(r))
}
function IS(r){
    return Math.abs(Math.abs(r)-Math.PI/2)<1e-6
}
var MS={};
function oN(r={}){
    return Object.keys(r).length
}
function TS(r,e={}){
    return oN(e)===0
        ?r
        :r.filter((t,i)=>!e[i])
}
function tN(r,e){
    let t=[];
    for(let i=0;i<r;i++)
        t.push(e);
    return t
}
function Vz(){
    return!!Object.keys(MS).length
}
var kM=function(r,e){
    let t=3;
    return e&&(
            t+=e
        ),
        new hn(-t,r.width+t,-t,r.height+t)
};
function rN(r,e){
    let{displayAsRightAngle:t,rx:i,ry:n,startAngle:o,deltaAngle:s,yscreen:a,xscreen:l}=r;
    if(t){
        let c=i*Math.cos(-o),
            u=i*Math.cos(-o-s),
            p=n*Math.sin(-o),
            g=n*Math.sin(-o-s);
        e.moveTo(l+c,a+p),
        e.lineTo(l+c+u,a+p+g),
        e.lineTo(l+u,a+g)
    }else
        e.ellipse(l,a,i,n,0,-o,-o-s,s>0)
}
var $n=class{
    constructor(e,t,i){
        if(
            this.controller=e,
            this.getExpressionAriaLabel=i,
            t.config.plaidMode
        ){
            let n=["RED","BLUE","GREEN","PURPLE","ORANGE","BLACK"];
            for(let o of n)
                MS[__dcg_shared_module_exports__['S'][o]]=document.createElement("img"),
                MS[__dcg_shared_module_exports__['S'][o]].setAttribute("src","/assets/img/april-fools/"+o.toLowerCase()+".png")
        }
    }
    redrawToCtx(e,t,i,n,o,s,a,l){
        Ks(e,"expressions");
        let c=t.settings.highlight,
            u=this.controller.isGeometry();
        o.forEach(p=>{
            let g=i[p],
                h=n[p];
            g!==void 0&&(
                u&&t.settings.setProperty("highlight",g.showHighlight),
                Ks(e,"sketch"),
                t.settings.takingScreenshot&&aw(e,this.getExpressionAriaLabel(p)),
                $n.drawSketchToCtx({
                    sketch:i[p],
                    ctx:e,
                    projection:t,
                    poiLabelsLayer:s,
                    clickableObjectsLayer:a,
                    geometryContext:this.controller.getGeoModel(),
                    showMovablePoints:l==null?void 0:l.showMovablePoints
                }),
                Us(e)
            ),
            h&&h.shouldGraph&&h.foreground&&kS(h,e,t,a)
        }),
        Us(e),
        t.settings.setProperty("highlight",c)
    }
    static eachSegment(e,t){
        for(let i of e.branches)
            if(i.graphMode!==15)
                for(let n of i.segments)
                    t(i,n)
    }
    static drawSketchToCtx({sketch:e,ctx:t,projection:i,poiLabelsLayer:n,clickableObjectsLayer:o,geometryContext:s,showMovablePoints:a}){
        var C,D,S,V,k;
        if(!e.branches||!e.branches.length)
            return;
        let l=t.lineWidth,
            c=t.globalAlpha,
            u=i.settings.globalCurveColor
                ?i.settings.globalCurveColor
                :e.color,
            p=MS[u],
            g;
        p&&p.complete&&p.naturalWidth>0
            ?g=t.createPattern(p,"repeat")
            :g=u,
        t.lineJoin="round",
        t.lineCap="round";
        let h=!!i.settings.takingScreenshot,
            b=!!a;
        for(let T of e.branches){
            if(T.graphMode===3||T.graphMode===4||T.graphMode===15||T.graphMode===22)
                continue;
            let A=1;
            o.shouldDrawHovered(e.id,T.listIndex)&&(
                A=DS.IS_HOVERED
            ),
            o.shouldDrawPressed(e.id,T.listIndex)&&(
                A=DS.IS_PRESSED
            ),
            o.shouldDrawGhosted(e.id)&&(
                A=DS.IS_GHOSTED
            ),
            A*=(C=s==null?void 0:s.getToolFadeOpacity(e.id))!=null
                ?C
                :1,
            A*=i.settings.getFillOpacityMultiplier(),
            t.strokeStyle=u,
            t.fillStyle=T.color&&!i.settings.globalCurveColor&&!Vz()
                ?T.color
                :g,
            T.graphMode!==6&&(
                t.desmos_batching=!0,
                t.beginPath()
            );
            for(let R of T.segments){
                let P=(D=T.graphMode)!=null
                    ?D
                    :2;
                if(P===7&&!i.settings.disableFill)
                    $n.fillPolygonToCtx(t,i,R,T.fillOpacity===void 0?NaN:T.fillOpacity*A);
                else if(P!==8){
                    let W=T.operator,
                        H=!i.settings.disableFill&&(W=="<"||W==">"||W=="<="||W==">="),
                        j=W=="<="||W=="<";
                    H&&$n.fillGraphStrokeToCtx(t,i,R,j,P)
                }
            }
            t.globalAlpha=$n._clampedOpacity(T.fillOpacity===void 0?NaN:T.fillOpacity*A,.4),
            T.graphMode!==6&&(
                t.fill(),
                t.desmos_batching=!1
            ),
            t.globalAlpha=1;
            for(let R of T.segments){
                let P=2;
                T.graphMode&&(
                    P=T.graphMode
                );
                let W=R,
                    H=T.lineWidth!==void 0,
                    j=T.lineWidth,
                    ne=2.5,
                    le=(S=T.arrowMode)!=null
                        ?S
                        :"DEFAULT";
                if(
                    t.strokeStyle=T.color,
                    t.fillStyle=T.color,
                    H&&(j<=0||!isFinite(j))
                )
                    continue;
                t.lineWidth=H?j:ne;
                let w=i.settings.graphLineWidth/ne;
                e.tokenSelected
                    ?w*=2
                    :e.tokenHovered&&(
                        w*=1.5
                    ),
                t.lineWidth*=w,
                t.globalAlpha*=i.settings.curveOpacity,
                t.globalAlpha=$n._clampedOpacity(i.settings.curveOpacity===1?1:T.lineOpacity,.9);
                let B=T.operator,
                    q="default";
                B==="<"||B===">"||B==="!="
                    ?q="DASHED"
                    :B==="<="||B===">="
                        ?q="SOLID"
                        :e.style==="DASHED"||T.style==="DASHED"
                            ?q="DASHED"
                            :(e.style==="DOTTED"||T.style==="DOTTED")&&(
                                q="DOTTED",
                                H&&(
                                    t.lineWidth*=2
                                )
                            ),
                t.globalAlpha*=(
                    V=s==null?void 0:s.getToolFadeOpacity(e.id)
                )!=null
                    ?V
                    :1;
                let M=!T.isIntersectionExtension&&o.shouldDrawHovered(e.id,T.listIndex),
                    ae=!T.isIntersectionExtension&&o.shouldDrawPressed(e.id,T.listIndex),
                    se=o.shouldDrawGhosted(e.id);
                se
                    ?t.globalAlpha*=SM.IS_GHOSTED
                    :(ae||M)&&(
                        t.save(),
                        t.lineWidth+=4.5,
                        t.globalAlpha*=ae
                            ?ow.IS_DEPRESSED
                            :ow.IS_HOVERED,
                        $n.drawGraphStrokeToCtx(t,i,W,{
                            type:q,
                            graphMode:P,
                            op:B,
                            arrowMode:le,
                            arrowHeadBaseWidth:t.lineWidth-4.5,
                            opacityMultiplier:ae
                                ?ow.IS_DEPRESSED
                                :ow.IS_HOVERED}),
                        t.restore()
                    ),
                $n.drawGraphStrokeToCtx(t,i,W,{
                    type:q,
                    graphMode:P,
                    op:B,
                    arrowMode:le,
                    opacityMultiplier:((k=s==null?void 0:s.getToolFadeOpacity(e.id))!=null?k:1)*(se?SM.IS_GHOSTED:sw)
                })
            }
        }
        t.lineWidth=l,
        t.globalAlpha=c,
        t.strokeStyle=u,
        $n.eachSegment(e,function(T,A){
            var R;
            if(T.graphMode===3&&T.showPoint||T.graphMode===4&&h){
                let P=A,
                    W=[],
                    H;
                if(T.interactiveLabel&&e.labels)
                    for(let ge=0,he=e.labels.length;ge<he;ge++){
                        let ye=e.labels[ge];
                        if(ye.type==="poi"){
                            let fe=n.isOpenPOI(ye.poi),
                                Se=n.getHoveredPOI()===ye.poi;
                            W.push(fe||Se),
                            !fe&&Se&&(
                                H=ge
                            )
                        }
                    }
                let j=T.graphMode===4&&h&&!b&&T.pointOpacity===1,
                    ne=1;
                typeof T.pointSize=="number"
                    ?ne=T.pointSize/9
                    :Array.isArray(T.pointSize)&&(
                        ne=T.pointSize.map(function(ge){
                            return ge/9
                        })
                    );
                let le;
                Array.isArray(T.color)&&(
                    le=T.color
                );
                let w=o.getHoveredObjectById(e.id),
                    B=o.shouldDrawHovered(e.id,void 0),
                    q=o.getPressedObject(),
                    M=o.shouldDrawPressed(e.id,q==null?void 0:q.listIndex),
                    ae=o.shouldDrawGhosted(e.id),
                    se=T.droppedIndices;
                if((B||M)&&!ae){
                    let ge=P.length;
                    se&&(
                        ge+=oN(se)
                    );
                    let he=tN(ge,0),
                        ye=Array.isArray(ne)
                            ?ne.slice()
                            :tN(ge,ne);
                    M&&q
                        ?q.listIndex===void 0?(
                                he=he.map(()=>SS.IS_DEPRESSED),
                                ye=ye.map(fe=>fe*1.5)
                            ):(
                                he[q.listIndex]=SS.IS_DEPRESSED,
                                ye[q.listIndex]*=1.5
                            )
                        :B&&w&&(
                            he=he.map((fe,Se)=>w.listIndexes===void 0||w.listIndexes[Se]?SS.IS_HOVERED:fe),
                            ye=ye.map((fe,Se)=>w.listIndexes===void 0||w.listIndexes[Se]?fe*1.5:fe)
                        ),
                    $n.drawPointsToCtx({
                        ctx:t,
                        projection:i,
                        segment:P,
                        style:T.style,
                        sizeOverrideIdxs:W,
                        opacityOverrideIdx:H,
                        sizeFactor:ye,
                        opacityFactor:he,
                        colorOverrides:le,
                        baseOpacity:T.pointOpacity,
                        droppedIndices:se,
                        sketch:e,
                        isKeyboardFocused:o.isKeyboardFocused(e.id,void 0)
                    }),
                    t.restore()
                }
                $n.drawPointsToCtx({
                    ctx:t,
                    projection:i,
                    segment:P,
                    style:T.style,
                    sizeOverrideIdxs:W,
                    opacityOverrideIdx:H,
                    sizeFactor:ne,
                    opacityFactor:((R=s==null?void 0:s.getToolFadeOpacity(e.id))!=null?R:1)*(ae?ES.IS_GHOSTED:sw),
                    colorOverrides:le,
                    baseOpacity:j?.9:T.pointOpacity,
                    droppedIndices:se,
                    sketch:e
                })
            }
        }.bind(this))
    }
    static drawGraphStrokeToCtx(e,t,i,n){
        let o={arrowHeadBaseWidth:e.lineWidth},
            {type:s,graphMode:a,op:l,arrowMode:c,arrowHeadBaseWidth:u}=Object.assign({},o,n);
        if(a===20||a===21){
            let[C,D,S]=i,
                V=t.mathToPixels.mapX(C),
                k=t.mathToPixels.mapY(D),
                T=t.mathToPixels.dangerouslyGetXScaleFactor(),
                A=t.mathToPixels.dangerouslyGetYScaleFactor(),
                R=Math.abs(S*T),
                P=Math.abs(S*A),
                W,
                H;
            if(
                a===21?(
                    W=-i[3],
                    H=-i[4]
                ):(
                    W=0,
                    H=2*Math.PI
                ),
                e.save(),
                gn(e,"dcg-svg-curve"),
                e.desmos_batching||e.beginPath(),
                s==="DASHED"
            ){
                let j=Bs.getDashedPattern(e,!!t.settings.highlight);
                e.setLineDash(j)
            }else if(s==="DOTTED"){
                let j=Bs.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight);
                e.setLineDash(j)
            }
            e.ellipse(V,k,R,P,0,W,H,W>H),
            e.desmos_batching||e.stroke(),
            Hi(e),
            e.restore();
            return
        }else if(a===23){
            let[C,D,S,V,k]=i,
                T=!k&&IS(V),
                A=df(V,t),
                R=t.mathToPixels.mapX(C),
                P=t.mathToPixels.mapY(D),
                W=t.mathToPixels.dangerouslyGetXScaleFactor(),
                H=t.mathToPixels.dangerouslyGetYScaleFactor(),
                j=W>H?W/H:1,
                ne=W>H?1:H/W,
                le=Math.abs(j*A),
                w=Math.abs(ne*A);
            if(
                e.save(),
                gn(e,"dcg-svg-curve"),
                e.globalAlpha=.4*n.opacityMultiplier,
                e.desmos_batching||e.beginPath(),
                e.moveTo(R,P),
                e.lineTo(R+le*Math.cos(-S),P+w*Math.sin(-S)),
                rN({
                    displayAsRightAngle:T,
                    rx:le,
                    ry:w,
                    startAngle:S,
                    deltaAngle:V,
                    yscreen:P,
                    xscreen:R
                },e),
                e.lineTo(R,P),
                !e.desmos_batching&&!k&&e.fill(),
                e.globalAlpha=n.opacityMultiplier,
                e.desmos_batching||e.beginPath(),
                rN({
                    displayAsRightAngle:T,
                    rx:le,
                    ry:w,
                    startAngle:S,
                    deltaAngle:V,
                    yscreen:P,
                    xscreen:R
                },e),
                k
            ){
                let B=-S-V,
                    q=R+le*Math.cos(B),
                    M=P+w*Math.sin(B);
                IM(e,q,M,-S,-V,10,le)
            }
            e.globalAlpha=n.opacityMultiplier,
            e.desmos_batching||e.stroke(),
            e.lineWidth=1.5,
            e.globalAlpha=.2*n.opacityMultiplier,
            e.moveTo(R+1.5*le*Math.cos(-S),P+1.5*w*Math.sin(-S)),
            e.lineTo(R,P),
            e.lineTo(R+1.5*le*Math.cos(-S-V),P+1.5*w*Math.sin(-S-V)),
            e.stroke(),
            Hi(e),
            e.restore()
        }else if(a===17||a===18||a===19||a===24){
            let{clipped:C,mapped:D}=iw(i,t,a,e.lineWidth);
            if(C.length===0)
                return;
            let[S,V,k,T]=C,
                [A,R,P,W]=D;
            e.save(),
            gn(e,"dcg-svg-curve");
            let H;
            if(
                e.desmos_batching||e.beginPath(),
                s=="DASHED"?(
                    H=new Bs(e,Bs.getTotalSegmentLength(C),Bs.getDashedPattern(e,!!t.settings.highlight)),
                    H.drawSegment(C)
                ):s=="DOTTED"?(
                    H=new Bs(e,Bs.getTotalSegmentLength(C),Bs.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),
                    H.drawSegment(C)
                ):(
                    e.moveTo(S,V),
                    e.lineTo(k,T)
                ),
                a===17
            ){
                let j=iN(s)*u,
                    {startArrow:ne,endArrow:le}=Mz(Tz(a,c));
                ne&&Ic(e,P,W,A,R,j),
                le&&Ic(e,A,R,P,W,j)
            }else if(a===24&&(A!==P||R!==W)){
                let j=iN(s)*u;
                Ic(e,A,R,P,W,j)
            }
            e.desmos_batching||e.stroke(),
            Hi(e),
            e.restore();
            return
        }
        let p=nw(a,l!=="=",t.settings),
            g=bu(i,t.mathToPixels,p),
            h=xS(g,kM(t.screen,e.lineWidth));
        if(h.length===0)
            return;
        e.save(),
        gn(e,"dcg-svg-curve");
        let b;
        if(
            e.desmos_batching||e.beginPath(),
            s=="DASHED"
        )
            b=new Bs(e,Bs.getTotalSegmentLength(h),Bs.getDashedPattern(e,!!t.settings.highlight)),
            b.drawSegment(h);
        else if(s=="DOTTED")
            b=new Bs(e,Bs.getTotalSegmentLength(h),Bs.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),
            b.drawSegment(h);
        else if((s==="SOLID"||s==="default")&&e.lineWidth===1)
            if(h.length>4||h[0]!==h[2]&&h[1]!==h[3]){
                e.moveTo(h[0],h[1]);
                for(let D=0;D<h.length;D+=2)
                    e.lineTo(h[D],h[D+1])
            }else{
                e.moveTo(__dcg_shared_module_exports__['ca'](h[0]),__dcg_shared_module_exports__['ca'](h[1]));
                for(let D=0;D<h.length;D+=2)
                    e.lineTo(__dcg_shared_module_exports__['ca'](h[D]),__dcg_shared_module_exports__['ca'](h[D+1]))
            }
        else{
            e.moveTo(h[0],h[1]);
            for(let C=0;C<h.length;C+=2)
                e.lineTo(h[C],h[C+1])
        }
        e.desmos_batching||e.stroke(),
        Hi(e),
        e.restore()
    }
    static mapPointToScreen(e,t,i){
        let o=e.mapx(t);
        if(o<-20||o>e.screen.width+20)
            return null;
        let s=e.mapy(i);
        return s<-20||s>e.screen.height+20?null:{x:o,y:s}
    }
    static drawPointToCtx(e){
        let{ctx:t,projection:i,sketch:n,x:o,y:s}=e,
            {sizeFactor:a}=e,
            l=t.lineWidth,
            c=t.fillStyle,
            u=t.strokeStyle,
            p=$n.mapPointToScreen(i,o,s);
        if(!p||e.sizeFactor!==void 0&&(e.sizeFactor<=0||!isFinite(e.sizeFactor)))
            return!1;
        gn(t,"dcg-svg-point"),
        e.alpha!==void 0
            ?t.globalAlpha=e.alpha
            :t.globalAlpha=.9,
        e.opacityFactor!==void 0&&(
            t.globalAlpha*=e.opacityFactor
        ),
        t.desmos_batching||t.beginPath();
        let g=i.settings.pointLineWidth;
        if(
            e.overrideSize&&(
                g=i.settings.config.projectorMode?17:11,
                t.lineWidth=g
            ),
            n.tokenSelected
                ?a
                    ?a*=2
                    :a=2
                :n.tokenHovered&&(
                    a
                        ?a*=1.5
                        :a=1.5
                ),
            a!==void 0&&(
                g*=a,
                t.lineWidth=g
            ),
            e.colorOverride&&(
                t.fillStyle=e.colorOverride,
                t.strokeStyle=e.colorOverride
            ),
            e.style==="CROSS"
        ){
            let h=g*.4;
            t.moveTo(p.x-h,p.y-h),
            t.lineTo(p.x+h,p.y+h),
            t.moveTo(p.x+h,p.y-h),
            t.lineTo(p.x-h,p.y+h),
            t.lineWidth=g*.3
        }else if(e.style==="OPEN"){
            let h=g*.42;
            t.moveTo(p.x+h,p.y),
            t.arc(p.x,p.y,h,0,Math.PI*2,!0),
            t.closePath(),
            t.fillStyle="white",
            t.lineWidth=g*.25,
            t.fill()
        }else
            t.moveTo(p.x-.1,p.y-.1),
            t.lineTo(p.x-.1,p.y+.1),
            t.lineTo(p.x+.1,p.y+.1),
            t.lineTo(p.x+.1,p.y-.1);
        if(
            t.desmos_batching||t.stroke(),
            t.globalAlpha=1,
            e.isKeyboardFocused
        ){
            let h=g/2+6;
            t.lineWidth=2,
            t.strokeStyle="#6A93D2",
            t.beginPath(),
            t.moveTo(p.x+h,p.y),
            t.arc(p.x,p.y,h,0,Math.PI*2,!0),
            t.stroke(),
            t.closePath()
        }
        return t.lineWidth=l,
            t.fillStyle=c,
            t.strokeStyle=u,
            Hi(t),
            !0
    }
    static drawPointsToCtx(e){
        let{ctx:t,projection:i,segment:n,style:o,sizeOverrideIdxs:s,opacityOverrideIdx:a,sizeFactor:l,opacityFactor:c,colorOverrides:u,baseOpacity:p,droppedIndices:g}=e,
            h=t.lineWidth;
        t.lineWidth=i.settings.pointLineWidth;
        let b;
        Array.isArray(p)?(
            b=p.map(function(C){
                return $n._clampedOpacity(C,.9)
            }.bind(this)),
            b=TS(b,g)
        ):b=$n._clampedOpacity(p,.9),
        Array.isArray(l)&&(
            l=TS(l,g)
        ),
        Array.isArray(c)&&(
            c=TS(c,g)
        ),
        u&&(
            u=TS(u,g)
        );
        for(let C=0;C<n.length;C++)
            $n.drawPointToCtx({
                ctx:t,
                projection:i,
                sketch:e.sketch,
                x:n[C][0],
                y:n[C][1],
                alpha:a===C?.6:Array.isArray(b)?b[C]:b,style:o,
                overrideSize:s[C],
                sizeFactor:Array.isArray(l)?l[C]:l,
                opacityFactor:Array.isArray(c)?c[C]:c,
                colorOverride:u&&u[C],
                isKeyboardFocused:e.isKeyboardFocused
            });
            t.lineWidth=h
    }
    static fillGraphStrokeToCtx(e,t,i,n,o){
        e.globalAlpha=o===6?.2:.4;
        let s=null,
            a=null,
            l;
        if(o===6){
            a=wS;
            let u=n?0:t.viewport.polarDiameter(),
                p=t.settings.degreeMode?180:2*Math.PI;
            s=W2(i,u,p)
        }else o===2?(
            a=U2,
            l=n?t.viewport.ymin:t.viewport.ymax,
            s=CM(i,l)
        ):o===1&&(
            a=K2,
            l=n?t.viewport.xmin:t.viewport.xmax,
            s=CM(i,l)
        );
        if(s===null||a===null)
            return;
        let c=kM(t.screen);
        for(let u of s){
            let p=nw(o,!0,t.settings),
                g=bu(u,t.mathToPixels,p),
                h=vS(g,c,a,!1);
            if(h.length>=6){
                gn(e,"dcg-svg-region"),
                e.desmos_batching||e.beginPath(),
                e.moveTo(h[0],h[1]);
                for(let b=2;b<h.length;b+=2)
                    e.lineTo(h[b],h[b+1]);
                e.lineTo(h[0],h[1]),
                e.desmos_batching||e.fill(),
                Hi(e)
            }
        }
        e.globalAlpha=1
    }
    static _clampedOpacity(e,t){
        return typeof e!="number"?t:e<0?0:e>1?1:isFinite(e)?e:t
    }
    static fillPolygonToCtx(e,t,i,n){
        let o=kM(t.screen);
        e.globalAlpha=$n._clampedOpacity(n*t.settings.getFillOpacityMultiplier(),.4);
        let s=bu(i,t.mathToPixels,nf),
            a=vS(s,o,wS,!1);
        if(a.length>=6){
            gn(e,"dcg-svg-region"),
            e.desmos_batching||e.beginPath(),
            e.moveTo(a[0],a[1]);
            for(let l=2;l<a.length;l+=2)
                e.lineTo(a[l],a[l+1]);
            e.desmos_batching||e.fill(),
            Hi(e)
        }
        e.globalAlpha=1
    }
};
function Tz(r,e){
    return r===17?e==="DEFAULT"?"NONE":e:"NONE"
}
function Mz(r){
    switch(r){
        case"NONE":return{startArrow:!1,endArrow:!1};
        case"POSITIVE":return{startArrow:!1,endArrow:!0};
        case"BOTH":return{startArrow:!0,endArrow:!0};
        default:
            let e=r;
            throw new Error("Unexpected arrowMode: "+e)
    }
}
function iN(r){
    switch(r){
        case"default":
        case"SOLID":
        case"DASHED":
            return 4;
        case"DOTTED":
            return 2;
        default:
            let e=r;
            throw new Error("Unexpected line style "+e)
    }
}
function Ic(r,e,t,i,n,o){
    let s=Math.atan2(n-t,i-e),
        a=i-o*Math.cos(s-Math.PI/9),
        l=n-o*Math.sin(s-Math.PI/9),
        c=i-o*Math.cos(s+Math.PI/9),
        u=n-o*Math.sin(s+Math.PI/9),
        p=i-(o-2)*Math.cos(s-Math.PI/18),
        g=n-(o-2)*Math.sin(s-Math.PI/18),
        h=i-(o-2)*Math.cos(s+Math.PI/18),
        b=n-(o-2)*Math.sin(s+Math.PI/18);
    r.moveTo(i,n),
    r.lineTo(a,l),
    r.lineTo(c,u),
    r.lineTo(i,n),
    r.lineTo(p,g),
    r.lineTo(h,b),
    r.lineTo(i,n)
}
function IM(r,e,t,i,n,o,s){
    let a=i+n,
        l=o*Math.min(1,Math.max(.5,Math.abs(n)/.8)),
        c=n<=0,
        u=Math.PI/2;
    s<25
        ?u+=.25
        :u+=.1,
    c||(
        u*=-1
    );
    let p=e+Math.cos(a+u),
        g=t+Math.sin(a+u);
    Ic(r,p,g,e,t,l)
}
function df(r,e){
    let t=20;
    return e.settings.config.projectorMode&&(t*=1.4),
        t
}
var LS=class{
    constructor(e){
        this.savedPOI=[],
        this.controller=e
    }
    redrawToCtx(e,t,i,n,o,s){
        let a=[];
        for(var l=0;l<s.length;l++){
            var c=s[l],
                u=i[c];
            if(u){
                u.showHighlight&&!this.controller.isGeometry()&&this.drawSketchHighlight({
                    sketch:u,
                    ctx:e,
                    projection:t,
                    poiLabelsLayer:n,
                    clickableObjectsLayer:o,
                    geometryContext:this.controller.getGeoModel()
                });
                var p=u.getPOI();
                (u.showPOI||p.length&&p[0].isAttachedToPlottedPoint())&&a.push.apply(a,this.drawPOIs(p,e,"#AAAAAA",t))
            }
        }
        this.savedPOI=a
    }
    getDrawnPOI(){
        return this.savedPOI
    }
    drawSketchHighlight(e){
        e.projection.settings.setProperty("highlight",!0),
        $n.drawSketchToCtx(e),
        e.projection.settings.setProperty("highlight",!1)
    }
    drawPOIs(e,t,i,n){
        t.lineWidth=n.settings.pointLineWidth,
        t.strokeStyle=i||"#AAAAAA",
        t.fillStyle=i||"#AAAAAA",
        t.lineJoin="round",
        t.lineCap="round";
        var o=t.globalAlpha;
        t.globalAlpha=.01;
        var s=[],
            a,
            l=e.length,
            c;
        if(l&&e[0].isAttachedToPlottedPoint())
            for(a=0;a<l;a++)
                c=e[a],
                $n.mapPointToScreen(n,c.x,c.y)&&s.push(c);
        else
            for(a=0;a<l;a++)
                c=e[a],
                $n.drawPointToCtx(__dcg_shared_module_exports__['a']({ctx:t,projection:n},c))&&s.push(c);
        return t.globalAlpha=o,
            s
    }
};
var OS=class{
    redrawToCtx(e,t,i){
        if(i){
            e.save(),
            e.lineWidth=2,
            e.fillStyle="rgba(0,0,0,.15)",
            e.strokeStyle="rgba(0,0,0,.4)";
            var n=t.mapx(i.left),
                o=t.mapy(i.top),
                s=t.mapx(i.right),
                a=t.mapy(i.bottom),
                l=s-n,
                c=a-o;
            e.fillRect(n,o,l,c),
            e.strokeRect(n,o,l,c),
            e.restore()
        }
    }
};
var Cu=__dcg_shared_module_exports__['h'](X());
var{If:q7}=Cu.Components,
US=class extends Cu.Class{init(){this.controller=this.props.grapher().controller,this.poiController=this.props.grapher().poiController}template(){return Cu.createElement(q7,{predicate:this.bindFn(this.showCursor)},()=>Cu.createElement("div",{class:Cu.const("dcg-geo-keyboard-cursor"),style:()=>({top:`${this.getPosition().y}px`,left:`${this.getPosition().x}px`})}))}getPosition(){let e=this.poiController.getGeoKeyboardPt(),t=this.props.grapher().getProjection();return{x:t.mapx(e.x),y:t.mapy(e.y)}}showCursor(){return this.controller.isVirtualMouseAllowed()}};var mf,Lt,mw,WM,$M;function ia(r,e){var t=Object.keys(e),i;for(i=0;i<t.length;i++)r=r.replace(new RegExp("\\{"+t[i]+"\\}","gi"),e[t[i]]);return r}function HS(r){var e,t,i;if(!r)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="";do for(t="",i=0;i<12;i++)t+=e[Math.floor(Math.random()*e.length)];while(r[t]);return t}function z7(r,e){var t,i,n={},o,s;for(r=r.split(","),e=e||10,t=0;t<r.length;t+=2)i="&"+r[t+1]+";",o=parseInt(r[t],e),n[i]="&#"+o+";";return n["\\xa0"]="&#160;",n}function $7(r){var e={left:"start",right:"end",center:"middle",start:"start",end:"end"};return e[r]||e.start}$M=z7("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);mf={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};mw=function(r,e){this.__root=r,this.__ctx=e};mw.prototype.addColorStop=function(r,e){var t=this.__ctx.__createElement("stop"),i,n;t.setAttribute("offset",r),e.indexOf("rgba")!==-1?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,n=i.exec(e),t.setAttribute("stop-color",ia("rgb({r},{g},{b})",{r:n[1],g:n[2],b:n[3]})),t.setAttribute("stop-opacity",n[4])):t.setAttribute("stop-color",e),this.__root.appendChild(t)};WM=function(r,e){this.__root=r,this.__ctx=e};Lt=function(r){var e={width:500,height:500,enableMirroring:!1},t;if(arguments.length>1?(t=e,t.width=arguments[0],t.height=arguments[1]):r?t=r:t=e,!(this instanceof Lt))return new Lt(t);this._randomPostfix="-"+function(){return"xxxxxxxx".replace(/x/g,function(n){return(Math.random()*16|0).toString(16)})}(),this._svgClassNames=[],this.width=t.width||e.width,this.height=t.height||e.height,this.enableMirroring=t.enableMirroring!==void 0?t.enableMirroring:e.enableMirroring,this.canvas=this,this.__document=t.document||document,t.ctx?this.__ctx=t.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)};Lt.prototype.__createElement=function(r,e,t){typeof e=="undefined"&&(e={});var i=this.__document.createElementNS("http://www.w3.org/2000/svg",r),n=Object.keys(e),o,s;for(t&&(i.setAttribute("fill","none"),i.setAttribute("stroke","none")),o=0;o<n.length;o++)s=n[o],i.setAttribute(s,e[s]);var a=this._svgClassNames&&this._svgClassNames[this._svgClassNames.length-1];return a&&i.setAttribute("class",a),i};Lt.prototype.__setDefaultStyles=function(){var r=Object.keys(mf),e,t;for(e=0;e<r.length;e++)t=r[e],this[t]=mf[t].canvas};Lt.prototype.__applyStyleState=function(r){var e=Object.keys(r),t,i;for(t=0;t<e.length;t++)i=e[t],this[i]=r[i]};Lt.prototype.__getStyleState=function(){var r,e={},t=Object.keys(mf),i;for(r=0;r<t.length;r++)i=t[r],e[i]=this[i];return e};Lt.prototype.__applyStyleToCurrentElement=function(r){var e=this.__currentElement,t=this.__currentElementsToStyle;t&&(e.setAttribute(r,""),e=t.element,t.children.forEach(function(h){h.setAttribute(r,"")}));var i=Object.keys(mf),n,o,s,a,l,c;for(n=0;n<i.length;n++)if(o=mf[i[n]],s=this[i[n]],o.apply){if(s instanceof WM){if(s.__ctx)for(;s.__ctx.__defs.childNodes.length;)a=s.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[a]=a,this.__defs.appendChild(s.__ctx.__defs.childNodes[0]);e.setAttribute(o.apply,ia("url(#{id})",{id:s.__root.getAttribute("id")}))}else if(s instanceof mw)e.setAttribute(o.apply,ia("url(#{id})",{id:s.__root.getAttribute("id")}));else if(o.apply.indexOf(r)!==-1&&o.svg!==s)if((o.svgAttr==="stroke"||o.svgAttr==="fill")&&s.indexOf("rgba")!==-1){l=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,c=l.exec(s),e.setAttribute(o.svgAttr,ia("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var u=c[4],p=this.globalAlpha;p!=null&&(u*=p),e.setAttribute(o.svgAttr+"-opacity",u)}else{var g=o.svgAttr;if(i[n]==="globalAlpha"&&(g=r+"-"+o.svgAttr,e.getAttribute(g)))continue;e.setAttribute(g,s)}}};Lt.prototype.__closestGroupOrSvg=function(r){return r=r||this.__currentElement,r.nodeName==="g"||r.nodeName==="svg"?r:this.__closestGroupOrSvg(r.parentNode)};Lt.prototype.getSerializedSvg=function(r){var e=new XMLSerializer().serializeToString(this.__root),t,i,n,o,s,a;if(a=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,a.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),r)for(t=Object.keys($M),i=0;i<t.length;i++)n=t[i],o=$M[n],s=new RegExp(n,"gi"),s.test(e)&&(e=e.replace(s,o));return e};Lt.prototype.getSvg=function(){return this.__root};Lt.prototype._dcgStartNamedGroup=function(r){var e=this.__createElement("g");e.setAttribute("id",r+this._randomPostfix);var t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e};Lt.prototype._dcgEndNamedGroup=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElement||(this.__currentElement=this.__root.childNodes[1])};Lt.prototype._dcgSaveClassName=function(r){this._svgClassNames.push(r),this.__currentElement&&this.__currentElement.tagName==="path"&&!this.__currentDefaultPath&&(this.__currentElement.getAttribute("class")||this.__currentElement.setAttribute("class",r))};Lt.prototype._dcgRestoreClassName=function(){this._svgClassNames.pop()};Lt.prototype.save=function(){var r=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(r),this.__currentElement=r,this.__stack.push(this.__getStyleState())};Lt.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var r=this.__stack.pop();this.__applyStyleState(r)};Lt.prototype.__addTransform=function(r){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var t=this.__createElement("g");e.appendChild(t),this.__currentElement=t}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=r,this.__currentElement.setAttribute("transform",i)};Lt.prototype.scale=function(r,e){e===void 0&&(e=r),this.__addTransform(ia("scale({x},{y})",{x:r,y:e}))};Lt.prototype.rotate=function(r){var e=r*180/Math.PI;this.__addTransform(ia("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))};Lt.prototype.translate=function(r,e){this.__addTransform(ia("translate({x},{y})",{x:r,y:e}))};Lt.prototype.transform=function(r,e,t,i,n,o){this.__addTransform(ia("matrix({a},{b},{c},{d},{e},{f})",{a:r,b:e,c:t,d:i,e:n,f:o}))};Lt.prototype.beginPath=function(){var r,e;this.__currentDefaultPath="",this.__currentPosition={},r=this.__createElement("path",{},!0),e=this.__closestGroupOrSvg(),e.appendChild(r),this.__currentElement=r};Lt.prototype.__applyCurrentDefaultPath=function(){var r=this.__currentElement;r.nodeName==="path"?r.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",r.nodeName)};Lt.prototype.__addPathCommand=function(r){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=r};Lt.prototype.moveTo=function(r,e){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:r,y:e},this.__addPathCommand(ia("M {x} {y}",{x:r,y:e}))};Lt.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")};Lt.prototype.lineTo=function(r,e){this.__currentPosition={x:r,y:e},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(ia("L {x} {y}",{x:r,y:e})):this.__addPathCommand(ia("M {x} {y}",{x:r,y:e}))};Lt.prototype.bezierCurveTo=function(r,e,t,i,n,o){this.__currentPosition={x:n,y:o},this.__addPathCommand(ia("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:r,cp1y:e,cp2x:t,cp2y:i,x:n,y:o}))};Lt.prototype.quadraticCurveTo=function(r,e,t,i){this.__currentPosition={x:t,y:i},this.__addPathCommand(ia("Q {cpx} {cpy} {x} {y}",{cpx:r,cpy:e,x:t,y:i}))};var zM=function(r){var e=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return[r[0]/e,r[1]/e]};Lt.prototype.arcTo=function(r,e,t,i,n){var o=this.__currentPosition&&this.__currentPosition.x,s=this.__currentPosition&&this.__currentPosition.y;if(!(typeof o=="undefined"||typeof s=="undefined")){if(n<0)throw new Error("IndexSizeError: The radius provided ("+n+") is negative.");if(o===r&&s===e||r===t&&e===i||n===0){this.lineTo(r,e);return}var a=zM([o-r,s-e]),l=zM([t-r,i-e]);if(a[0]*l[1]===a[1]*l[0]){this.lineTo(r,e);return}var c=a[0]*l[0]+a[1]*l[1],u=Math.acos(Math.abs(c)),p=zM([a[0]+l[0],a[1]+l[1]]),g=n/Math.sin(u/2),h=r+g*p[0],b=e+g*p[1],C=[-a[1],a[0]],D=[l[1],-l[0]],S=function(T){var A=T[0],R=T[1];return R>=0?Math.acos(A):-Math.acos(A)},V=S(C),k=S(D);this.lineTo(h+C[0]*n,b+C[1]*n),this.arc(h,b,n,V,k)}};Lt.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")};Lt.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")};Lt.prototype.rect=function(r,e,t,i){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(r,e),this.lineTo(r+t,e),this.lineTo(r+t,e+i),this.lineTo(r,e+i),this.lineTo(r,e),this.closePath()};Lt.prototype.fillRect=function(r,e,t,i){var n,o;n=this.__createElement("rect",{x:r,y:e,width:t,height:i},!0),o=this.__closestGroupOrSvg(),o.appendChild(n),this.__currentElement=n,this.__applyStyleToCurrentElement("fill")};Lt.prototype.strokeRect=function(r,e,t,i){var n,o;n=this.__createElement("rect",{x:r,y:e,width:t,height:i},!0),o=this.__closestGroupOrSvg(),o.appendChild(n),this.__currentElement=n,this.__applyStyleToCurrentElement("stroke")};Lt.prototype.__clearCanvas=function(){for(var r=this.__closestGroupOrSvg(),e=r.getAttribute("transform"),t=this.__root.childNodes[1],i=t.childNodes,n=i.length-1;n>=0;n--)i[n]&&t.removeChild(i[n]);this.__currentElement=t,this.__groupStack=[],e&&this.__addTransform(e)};Lt.prototype.clearRect=function(r,e,t,i){if(r===0&&e===0&&t===this.width&&i===this.height){this.__clearCanvas();return}var n,o=this.__closestGroupOrSvg();n=this.__createElement("rect",{x:r,y:e,width:t,height:i,fill:"#FFFFFF"},!0),o.appendChild(n)};Lt.prototype.createLinearGradient=function(r,e,t,i){var n=this.__createElement("linearGradient",{id:HS(this.__ids),x1:r+"px",x2:t+"px",y1:e+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(n),new mw(n,this)};Lt.prototype.createRadialGradient=function(r,e,t,i,n,o){var s=this.__createElement("radialGradient",{id:HS(this.__ids),cx:i+"px",cy:n+"px",r:o+"px",fx:r+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(s),new mw(s,this)};Lt.prototype.__parseFont=function(){var r=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,e=r.exec(this.font),t={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(t.decoration="underline"),this.__fontHref&&(t.href=this.__fontHref),t};Lt.prototype.__wrapTextLink=function(r,e){if(r.href){var t=this.__createElement("a");return t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.href),t.appendChild(e),t}return e};Lt.prototype.__applyText=function(r,e,t,i){var n=this.__parseFont(),o=this.__closestGroupOrSvg(),s=this.__createElement("text",{"font-family":n.family,"font-size":n.size,"font-style":n.style,"font-weight":n.weight,"text-decoration":n.decoration,x:e,y:t,"text-anchor":$7(this.textAlign)},!0);s.appendChild(this.__document.createTextNode(r)),this.__currentElement=s,this.__applyStyleToCurrentElement(i),o.appendChild(this.__wrapTextLink(n,s))};Lt.prototype.fillText=function(r,e,t){this.__applyText(r,e,t,"fill")};Lt.prototype.strokeText=function(r,e,t){this.__applyText(r,e,t,"stroke")};Lt.prototype.measureText=function(r){return this.__ctx.font=this.font,this.__ctx.measureText(r)};Lt.prototype.arc=function(r,e,t,i,n,o){if(i!==n){i=i%(2*Math.PI),n=n%(2*Math.PI),i===n&&(n=(n+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var s=r+t*Math.cos(n),a=e+t*Math.sin(n),l=r+t*Math.cos(i),c=e+t*Math.sin(i),u=o?0:1,p=0,g=n-i;g<0&&(g+=2*Math.PI),o?p=g>Math.PI?0:1:p=g>Math.PI?1:0,this.lineTo(l,c),this.__addPathCommand(ia("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:t,xAxisRotation:0,largeArcFlag:p,sweepFlag:u,endX:s,endY:a})),this.__currentPosition={x:s,y:a}}};Lt.prototype.clip=function(){var r=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),t=HS(this.__ids),i=this.__createElement("g");this.__applyCurrentDefaultPath(),r.removeChild(this.__currentElement),e.setAttribute("id",t),e.appendChild(this.__currentElement),this.__defs.appendChild(e),r.setAttribute("clip-path",ia("url(#{id})",{id:t})),r.appendChild(i),this.__currentElement=i};Lt.prototype.drawImage=function(){var r=Array.prototype.slice.call(arguments),e=r[0],t,i,n,o,s=0,a=0,l,c,u,p,g,h,b,C,D,S,V;if(r.length===3)t=r[1],i=r[2],l=e.width,c=e.height,n=l,o=c;else if(r.length===5)t=r[1],i=r[2],n=r[3],o=r[4],l=e.width,c=e.height;else if(r.length===9)s=r[1],a=r[2],l=r[3],c=r[4],t=r[5],i=r[6],n=r[7],o=r[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);u=this.__closestGroupOrSvg(),b=this.__currentElement;var k="translate("+t+", "+i+")";if(e instanceof Lt){if(p=e.getSvg().cloneNode(!0),p.childNodes&&p.childNodes.length>1){for(g=p.childNodes[0];g.childNodes.length;)V=g.childNodes[0].getAttribute("id"),this.__ids[V]=V,this.__defs.appendChild(g.childNodes[0]);if(h=p.childNodes[1],h){var T=h.getAttribute("transform"),A;T?A=T+" "+k:A=k,h.setAttribute("transform",A),u.appendChild(h)}}}else(e.nodeName==="CANVAS"||e.nodeName==="IMG")&&(C=this.__createElement("image"),C.setAttribute("width",n),C.setAttribute("height",o),C.setAttribute("opacity",this.globalAlpha),C.setAttribute("preserveAspectRatio","none"),(s||a||l!==e.width||c!==e.height)&&(D=this.__document.createElement("canvas"),D.width=n,D.height=o,S=D.getContext("2d"),S.drawImage(e,s,a,l,c,0,0,n,o),e=D),C.setAttribute("transform",k),C.setAttribute("xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),u.appendChild(C))};Lt.prototype.createPattern=function(r,e){var t=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=HS(this.__ids),n;return t.setAttribute("id",i),t.setAttribute("width",r.width),t.setAttribute("height",r.height),r.nodeName==="CANVAS"||r.nodeName==="IMG"?(n=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),n.setAttribute("width",r.width),n.setAttribute("height",r.height),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.nodeName==="CANVAS"?r.toDataURL():r.getAttribute("src")),t.appendChild(n),this.__defs.appendChild(t)):r instanceof Lt&&(t.appendChild(r.__root.childNodes[1]),this.__defs.appendChild(t)),new WM(t,this)};Lt.prototype.setLineDash=function(r){r&&r.length>0?this.lineDash=r.join(","):this.lineDash=null};Lt.prototype.ellipse=function(r,e,t,i,n,o,s,a){if(o!==s){o=o%(2*Math.PI),s=s%(2*Math.PI),o===s&&(s=(s+2*Math.PI-.001*(a?-1:1))%(2*Math.PI));var l=r+Math.cos(-n)*t*Math.cos(s)+Math.sin(-n)*i*Math.sin(s),c=e-Math.sin(-n)*t*Math.cos(s)+Math.cos(-n)*i*Math.sin(s),u=r+Math.cos(-n)*t*Math.cos(o)+Math.sin(-n)*i*Math.sin(o),p=e-Math.sin(-n)*t*Math.cos(o)+Math.cos(-n)*i*Math.sin(o),g=a?0:1,h=0,b=s-o;b<0&&(b+=2*Math.PI),a?h=b>Math.PI?0:1:h=b>Math.PI?1:0,this.lineTo(u,p),this.__addPathCommand(ia("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:i,xAxisRotation:n*(180/Math.PI),largeArcFlag:h,sweepFlag:g,endX:l,endY:c})),this.__currentPosition={x:l,y:c}}};Lt.prototype._dcgSetTitle=function(r){var e=this.__currentElement,t=!1,i,n=e.getElementsByTagName("title");n.length>0?i=n[0]:(i=this.__document.createElementNS("http://www.w3.org/2000/svg","title"),t=!0),i.textContent=r,t&&e.appendChild(i)};Lt.prototype.drawFocusRing=function(){};Lt.prototype.createImageData=function(){};Lt.prototype.getImageData=function(){};Lt.prototype.putImageData=function(){};Lt.prototype.globalCompositeOperation=function(){};Lt.prototype.setTransform=function(){};var aB=Lt;ct();var Du=document.createElement("canvas").getContext("2d"),Is=class{constructor(e,t){this._label=e,this._fontSize=t,this._layout=W7(e,t)}getRect(){return this.getRectWhenCenteredAt({x:0,y:0})}getRectWhenCenteredAt(e){return{left:this._layout.left+e.x,right:this._layout.right+e.x,top:this._layout.top+e.y,bottom:this._layout.bottom+e.y}}getBoundsWhenCenteredAt(e,t){switch(t){case"x":return{lower:this._layout.left+e,upper:this._layout.right+e};case"y":return{lower:this._layout.top+e,upper:this._layout.bottom+e};default:let i=t;throw new Error(`Unknown axis: ${i}`)}}getWidth(){return this._layout.right-this._layout.left}getHeight(){return this._layout.bottom-this._layout.top}getDimensionAlongAxis(e){switch(e){case"x":return this.getWidth();case"y":return this.getHeight();default:let t=e;throw new Error(`Unknown axis: ${t}`)}}clampBoundsWithinRect(e,t){let i,n;return e.x+this._layout.left<t.left?i=t.left-this._layout.left:e.x+this._layout.right>t.right?i=t.right-this._layout.right:i=e.x,e.y+this._layout.top<t.top?n=t.top-this._layout.top:e.y+this._layout.bottom>t.bottom?n=t.bottom-this._layout.bottom:n=e.y,{x:i,y:n}}getValue(){return this._label.value}getMinusWidth(){return this.getValue()<0?(Is.setCtxFontSize(Du,this._fontSize),Du.measureText("-1").width-Du.measureText("1").width):0}getString(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string}drawCenteredAt(e,t,i){let n=t.x,o=Is.computeBaselineFromCenter(t.y,this._fontSize);i&&gn(e,i),e.save(),i&&Hi(e),Is.setCtxFontSize(e,this._fontSize),this._label.superscript?(e.strokeText(this._label.mantissa,this._layout.mantissa_x+n,this._layout.mantissa_y+o),e.strokeText(this._label.superscript,this._layout.superscript_x+n,this._layout.superscript_y+o),e.fillText(this._label.mantissa,this._layout.mantissa_x+n,this._layout.mantissa_y+o),e.fillText(this._label.superscript,this._layout.superscript_x+n,this._layout.superscript_y+o)):(e.strokeText(this._label.string,this._layout.mantissa_x+n,this._layout.mantissa_y+o),e.fillText(this._label.string,this._layout.mantissa_x+n,this._layout.mantissa_y+o)),e.restore()}static computeBaselineFromCenter(e,t){return e+.272*t}static setCtxFontSize(e,t){e.font=t+"px Arial",e.textAlign="center"}};function W7(r,e){if(r.superscript){let t=e;Is.setCtxFontSize(Du,t);let i=Du.measureText(r.mantissa).width,n=Math.round(.8*e);Is.setCtxFontSize(Du,n);let o=Du.measureText(r.superscript).width,s=0,a=e/5,l=i/2+o/2,c=-e/4,u=c-n/2,p=a+t/2,g=s-i/2,h=l+o/2;return{top:u,bottom:p,left:g,right:h,mantissa_height:t,mantissa_width:i,mantissa_x:s,mantissa_y:a,superscript_height:n,superscript_width:o,superscript_x:l,superscript_y:c}}else{let t=e;Is.setCtxFontSize(Du,e);let i=Du.measureText(r.string).width,n=0,o=0,s=o-t/2,a=o+t/2,l=n-i/2,c=n+i/2;return{top:s,bottom:a,left:l,right:c,mantissa_height:t,mantissa_width:i,mantissa_x:n,mantissa_y:o}}}function j7(r,e,t,i){let n=Math.ceil(r/t),o=Math.floor(e/t),s=1/t;if(!(n>o)&&!(o-n>1e4))for(let a=n;a<=o;a++)i(a/s)}var jM={base:10,major:[1,2,5],minor:[5,4,5]},J7={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},Y7={base:2,major:[Math.PI/3],minor:[3]};function X7(r){return r?{base:10,major:[r,2*r,5*r],minor:[4,4,5]}:jM}function JM(r,e){let{major:t,minor:i,base:n}=e,o=1/0,s=1/0;for(let a=0;a<t.length;a++){let l=t[a],c=Math.ceil(Math.log(r/l)/Math.log(n)),u=l*Math.pow(n,c);if(u<o){o=u;let p=i[a];s=o/p}}return{major:o,minor:s}}function Q7(r,e,t){return 1+(e-r)/t}function lB(r){let e=r.screen.width,t=r.screen.height,i=r.viewport.xmax-r.viewport.xmin,n=r.viewport.ymax-r.viewport.ymin,o=r.settings.pixelsPerLabel;return{majorStepX:o/e*i,majorStepY:o/t*n}}function Op(r){let e=l=>{let[c,u,p,g,h]=l==="x"?[r.viewport.xmin,r.viewport.xmax,r.settings.xAxisStep,r.settings.xAxisNumbers,r.settings.xAxisMinorSubdivisions]:[r.viewport.ymin,r.viewport.ymax,r.settings.yAxisStep,r.settings.yAxisNumbers,r.settings.yAxisMinorSubdivisions],b=u-c,C=Math.abs(p!=null?p:NaN),D=0,S=0;if(C&&C!==Math.PI){let V=Q7(c,u,C);if(V>=3&&V<100){let k=0;if(g){let A=0;j7(c,u,C,function(R){let P=new Is(__dcg_shared_module_exports__['Cb'](R,b),r.settings.labelSize);A=Math.max(P.getDimensionAlongAxis(l),A)}),k=A+10}else k=h===1?8:20;let T=l==="x"?"width":"height";V*k<=r.screen[T]&&(D=C,C===3||C===5?S=1:S=C/4)}}if(!D){let V=lB(r)[l==="x"?"majorStepX":"majorStepY"],k=JM(V,__dcg_shared_module_exports__['Cb'](C,b).string.indexOf("\u03C0")>=0?V>=1?J7:Y7:X7(C));D=k.major,S=k.minor}return{majorStep:D,minorStep:S}},t=()=>{var l,c;if(Math.abs((l=r.settings.xAxisStep)!=null?l:NaN)===Math.abs((c=r.settings.yAxisStep)!=null?c:NaN)){let{xmin:g,xmax:h,ymin:b,ymax:C}=r.viewport,D=r.screen.width/(h-g),S=r.screen.height/(C-b),V=D/S,k=.01;if(V>=1-k&&V<=2){let{majorStep:T,minorStep:A}=e("y");return{x:{majorStep:T,minorStep:A},y:{majorStep:T,minorStep:A}}}if(V<=1-k&&V>=.5){let{majorStep:T,minorStep:A}=e("x");return{x:{majorStep:T,minorStep:A},y:{majorStep:T,minorStep:A}}}}return{x:e("x"),y:e("y")}},i=()=>{let{xAxisScale:l,yAxisScale:c}=r.settings,u=l==="logarithmic",p=c==="logarithmic";return!u&&!p?t():{x:u?{majorStep:NaN,minorStep:NaN}:e("x"),y:p?{majorStep:NaN,minorStep:NaN}:e("y")}},{x:n,y:o}=i(),{xAxisMinorSubdivisions:s=0,yAxisMinorSubdivisions:a=0}=r.settings;return{majorStepX:n.majorStep,minorStepX:s>0?n.majorStep/s:n.minorStep,majorStepY:o.majorStep,minorStepY:a>0?o.majorStep/a:o.minorStep}}function cB(r){let e=lB(r),t=JM(e.majorStepX,jM),i=JM(e.majorStepY,jM),n=t.major>i.major?t:i;return{majorStepR:n.major,minorStepR:n.minor}}ct();function pi(){if(document.activeElement){var r=O(document.activeElement);gp(r)&&O(document.activeElement).trigger("blur")}}ct();uu();var qS=class{constructor(e,t){this.cb=e;this.document=t;this.observedAriaLiveElements=new WeakMap;this.destroyed=!1;this.onAriaLabelFocus=e=>{let t=e.target;if(this.isElement(t)){let i=t.getAttribute("aria-label");i&&this.cb(i,"label")}};this.document.documentElement.addEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver=new MutationObserver(i=>this.handleAriaLiveContentMutations(i)),t.documentElement.querySelectorAll('[aria-live="assertive"]').forEach(i=>this.startObservingAriaLiveElement(i)),this.treeObserver=new MutationObserver(i=>this.handleDocumentTreeMutations(i)),this.treeObserver.observe(t.documentElement,{childList:!0,subtree:!0,attributeFilter:["aria-live"]})}destroy(){this.destroyed=!0,this.document.documentElement.removeEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver.disconnect()}isObservingElement(e){return!!this.observedAriaLiveElements.get(e)}handleAriaLiveContentMutations(e){var i;let t=new Map;for(let n of e){if(!this.observedAriaLiveElements.get(n.target))continue;let o=t.get(n.target);o||(o=[],t.set(n.target,o)),o.push(n)}for(let[n,o]of t){let s=n.cloneNode(!0),a=[s.textContent||""];for(let l=o.length-1;l>=0;l--){let c=o[l];switch(c.type){case"attributes":{c.attributeName!==null&&s.setAttribute(c.attributeName,c.oldValue||""),a.push(s.textContent||"");break}case"characterData":{c.oldValue!==null&&(s.textContent=c.oldValue),s.textContent&&s.textContent!==a[a.length-1]&&a.push(s.textContent);break}case"childList":{if(c.addedNodes.length>1||c.removedNodes.length>1)throw new Error(`Expected at most one removed node and one added node, but got ${c.removedNodes.length} removed nodes and ${c.addedNodes.length} added nodes`);c.addedNodes.length===1&&((i=s.firstChild)==null||i.remove()),c.removedNodes.length===1&&c.removedNodes.forEach(u=>s.appendChild(u.cloneNode(!0))),s.textContent&&s.textContent!==a[a.length-1]&&a.push(s.textContent);break}}}for(let l of a.reverse())this.cb(l,"alert")}}startObservingAriaLiveElement(e){this.destroyed||e.getAttribute("aria-live")==="assertive"&&(this.observedAriaLiveElements.get(e)||(this.observedAriaLiveElements.set(e,!0),e.textContent&&this.cb(e.textContent,"alert"),this.ariaLiveContentObserver.observe(e,{attributes:!0,characterData:!0,childList:!0,attributeOldValue:!0,characterDataOldValue:!0})))}stopObservingAriaLiveElement(e){this.observedAriaLiveElements.set(e,!1)}handleDocumentTreeMutations(e){for(let t of e)t.addedNodes.forEach(i=>{this.isElement(i)&&i.getAttribute("aria-live")==="assertive"&&this.startObservingAriaLiveElement(i)}),this.isElement(t.target)&&t.attributeName==="aria-live"&&(t.target.getAttribute("aria-live")==="assertive"?this.startObservingAriaLiveElement(t.target):this.stopObservingAriaLiveElement(t.target)),t.removedNodes.forEach(i=>{this.isElement(i)&&(this.stopObservingAriaLiveElement(i),i.querySelectorAll('[aria-live="assertive"]').forEach(n=>this.stopObservingAriaLiveElement(n)))})}isElement(e){var i;let t=(i=this.document.defaultView)==null?void 0:i.Element;return t?e instanceof t:!1}};var Yh,zS=[],dB="",Z7;function ho(){Yh&&(Yh.textContent="")}function Ht(r){zS.push(r)}function xe(r){if(r!==void 0&&Ht(r),Yh&&zS.length>0){let e=zS.join(" ").replace(/ +(?= )/g,"");Yh.setAttribute("aria-relevant",dB===e&&di?"all":"additions text"),Yh.textContent=e,dB=e}zS.length=0}O(()=>{Yh||(O("body").append("<p aria-live='assertive' aria-atomic='true' class='dcg-aria-alert'></p>"),Yh=document.querySelector(".dcg-aria-alert")),Gs().logAria&&(Z7=new qS((e,t)=>__dcg_shared_module_exports__['k'].log(`[aria ${t}] ${e}`),document))});var ace=__dcg_shared_module_exports__['h'](uB());ct();var pB=["exp|exponent ln|natural-log log","total length mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","TScore|t-score Tscore|t-score tscore|t-score","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with"].join(" "),e$=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");pB+=" "+e$;var t$="alpha beta sqrt theta phi pi tau nthroot cbrt sum prod integral percent infinity infty cross";function Id(r){r||(r={});let e=[t$];return r.disallowAns||e.push("ans"),r.disallowFrac||e.push("frac"),r.additionalCommands&&(e=e.concat(r.additionalCommands)),e.join(" ")}function $a(r){r||(r={});let e=pB;return r.additionalOperators&&r.additionalOperators.length&&(e=`${e} ${r.additionalOperators.join(" ")}`),r.includeGeometryFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['Yc']).join(" ")),r.include3DFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['Zc']).join(" ")),e}var hB=window.MathQuill.noConflict().getInterface(3);hB.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:Id(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){return!HC&&(dp||up)?O('<span class="dcg-mathquill-input-span" tabindex=0 role="textbox" style="display:inline-block;height:1px;width:1px">')[0]:TP&&MP?O('<textarea readonly inputmode="none" autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">').on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0})[0]:O('<textarea inputmode="none" autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">')[0]},autoOperatorNames:$a(),quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,disableAutoSubstitutionInSubscripts:!0,interpretTildeAsSim:!0});var $l=hB;var i$=/`[^`]*`/g,n$=/^[\+\-]?[\d]*(\.\d+)?$/,o$=r=>{if(r!=null){let e=r.match(/`/g);return(e!=null&&e.length||0)%2==0}return!0},s$=r=>{let e=[];if(r==null||r.length==0)return e;let t=0,i;for(;i=i$.exec(r);){let o=r.slice(t,i.index);o.length>0&&e.push({from:t,to:i.index,type:"text",text:o}),t=i.index+i[0].length,e.push({from:i.index,to:t,type:"math",text:i[0].slice(1,-1)})}let n=r.slice(t);return n.length>0&&e.push({from:t,to:r.length,type:"text",text:n}),e},gB=$l.StaticMath(document.createElement("span"));function Vs(r){let e="",t=[];o$(r)?t=s$(r):t=[{from:0,to:r.length,type:"text",text:r}];for(let i of t)e+=i.type==="text"?i.text:Hs(i.text);return e}function Hs(r){let e="";return n$.test(r)?(/^\+/.test(r)?(e="positive ",r=r.slice(1)):/^\-/.test(r)&&(e="negative ",r=r.slice(1)),e+=r.replace(/(\.)([0-9]+)/g,(t,i,n)=>i+n.split("").join(" ").trim())):(gB.latex(r),e=gB.mathspeak().trim()),e}
var Oi=__dcg_shared_module_exports__['h'](X());
ct();
var a$=1,
Su=class{
    constructor(e,t,i,n,o,s,a){
        this.x=e,
        this.y=t,
        this.type=i,
        this.sketch=n,
        this.branch=o,
        this.pointIdxOnBranch=s,
        this.bareLabel=a===void 0?!1:a,
        this.id=a$++
    }
    getLabel(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        return e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""
    }
    getGraphMode(){
        return this.sketch.branches[this.branch].graphMode
    }
    getCompiledFunction(){
        let e=this.sketch.branches[this.branch];
        if(!(!("compiled"in e)||!e.compiled))
            return e.compiled.fn
    }
    isAttachedToPlottedPoint(){
        return this.type===1006||this.type===1008
    }
    isMovable(){
        return this.getGraphMode()===4
    }
    isPersistent(){
        return this.type===1008
    }
    getLabelSize(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        return this.type===1008&&e&&"labelSize"in e?e.labelSize===void 0?1:e.labelSize:1
    }
    getLabelRotation(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        return this.type===1008&&e&&"labelAngle"in e?e.labelAngle===void 0?0:e.labelAngle:0
    }
    getPointOpacity(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        if(e&&"pointOpacity"in e){
            let t=e.pointOpacity;
            if(t!==void 0){
                let i;
                return Array.isArray(t)?i=t[this.pointIdxOnBranch]:i=t,
                    isFinite(i)?Math.max(0,Math.min(1,i)):.9
            }
        }
        return this.isMovable()?1:.9
    }
    getPointSize(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        if(this.isMovable())
            return 22;
        if(e&&"pointSize"in e){
            let t=e.pointSize;
            if(t!==void 0){
                let i;
                return Array.isArray(t)?i=t[this.pointIdxOnBranch]:i=t,
                    isFinite(i)?Math.max(0,i):9
            }
        }
        return 9
    }
    getTextOutline(){
        if(this.hasEditableLabel())
            return!1;
        let e=this.sketch&&this.sketch.branches[this.branch];
        return this.type===1008&&e&&"suppressTextOutline"in e?!e.suppressTextOutline:!0
    }
    hasInteractiveLabel(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        return e&&"interactiveLabel"in e?!!e.interactiveLabel:!1
    }
    hasEditableLabel(){
        let e=this.sketch&&this.sketch.branches[this.branch];
        return e&&"editableLabel"in e?!!e.editableLabel:!1
    }
    isBareLabel(){
        return this.bareLabel
    }
    getMovablePoint(){
        return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch)
    }
    isSelected(){
        return this.sketch.showHighlight
    }
};
function WS(r,e,t){
    return Math.max(e,Math.min(t,r))
}
var ff=class{
    constructor(e){let t=e.data,i=e.width,n=e.height;this.imageData=e;for(let l=1;l<i;l++)t[l]+=t[l-1];for(let l=1;l<n;l++)t[l*i]+=t[l*i-i];let o=i*n-i-n+1,s=i-1;for(var a=0;a<o;a++){let l=1+a%s,u=(1+Math.floor(a/s))*i,p=l-1+u,g=l+u-i,h=l-1+u-i;t[u+l]+=t[p]+t[g]-t[h]}}getSumForValidRect(e){let t=e.left-1,i=e.right-1,n=e.top-1,o=e.bottom-1,s=this.imageData.width,a=this.imageData.data,l=a[t+n*s],c=a[i+n*s],u=a[t+o*s],p=a[i+o*s];return t>=0&&n>=0?p-c-u+l:t>=0?p-u:n>=0?p-c:p}getSum(e){let t={left:WS(Math.floor(e.left),0,this.imageData.width),right:WS(Math.ceil(e.right),0,this.imageData.width),top:WS(Math.floor(e.top),0,this.imageData.height),bottom:WS(Math.ceil(e.bottom),0,this.imageData.height)};return t.left>=t.right||t.top>=t.bottom?0:this.getSumForValidRect(t)}};var _p=1/2,Pp=document.createElement("canvas"),QM=[];function l$(r,e){if(!(e.width*e.height>0))return new ff({width:0,height:0,data:[]});Pp.width=0,Pp.width=Math.round(e.width*_p),Pp.height=Math.round(e.height*_p);let i=Pp.getContext("2d");i.save(),i.scale(Pp.width/r.canvas.width,Pp.height/r.canvas.height),i.drawImage(r.canvas,0,0),i.restore();var n=i.getImageData(0,0,Pp.width,Pp.height),o=n.data;o.length/4,QM.length,QM=new Array(o.length/4);for(var s=QM,a=0;a<s.length;a++)s[a]=o[a*4+3];var l=new ff({width:n.width,height:n.height,data:s});return l}function mB(r){for(var e=0;e<r.length;e++){var t=c$(e,r);r[e]=[t]}return r.map(function(i){return i[0]})}function c$(r,e){var t=1/0,i=-1,n=e[r];if(n.length===1)return n[0];for(var o=0;o<n.length;o++){var s=e[r][o].staticScore,a=d$(r,o,e),l=s+a;(i===-1||l<t)&&(t=l,i=o)}return n[i]}function d$(r,e,t){for(var i=0,n=t[r][e],o=0;o<t.length;o++)if(o!==r){for(var s=0,a=t[o],l=a.length-1;l>=0;l--){var c=a[l],u=Math.max(0,Math.min(n.right,c.right)-Math.max(n.left,c.left)),p=Math.max(0,Math.min(n.bottom,c.bottom)-Math.max(n.top,c.top));s+=u*p}i+=s/a.length}return i}function u$(r,e){var t=e.getSum({left:r.left*_p,right:r.right*_p,top:r.top*_p,bottom:r.bottom*_p});return t/=200,t/=_p*_p,t}function p$(r,e){var t=0;return e.forEach(function(i){t+=fB(r,i)}),t}function h$(r,e){var t=fB(r,e);return 10*(r.width*r.height-t)}function fB(r,e){var t=Math.max(0,Math.min(r.right,e.right)-Math.max(r.left,e.left)),i=Math.max(0,Math.min(r.bottom,e.bottom)-Math.max(r.top,e.top));return t*i}function yB(r,e,t){let i;return()=>(i||(i={domObstructions:t,viewport:{left:0,right:e.width,top:0,bottom:e.height},integralImage:l$(r,e)}),i)}function jS(r,e){if(!(e.length<=1)){var t=r();for(var i of e)i.staticScore+=h$(i,t.viewport),i.staticScore+=p$(i,t.domObstructions),i.staticScore+=u$(i,t.integralImage)}}function bB(r,e){var t=e.nakedLabel?0:e.pt_radius,i=Math.round(t/Math.sqrt(2)),n=[],o=e.pt_x,s=e.pt_y,a=e.width,l=e.height,c=400;n.push({cx_s:0,cy_s:0,cx_a:0,cy_a:0,staticScore:c,orientation:"center",matches:{default:1,center:1,center_auto:1,auto_center:1}}),n.push({cx_s:.5,cx_a:t+3,cy_s:0,cy_a:0,staticScore:c,orientation:"right",matches:{default:1,right:1,center_auto:1,auto_right:1}}),n.push({cx_s:-.5,cx_a:-t-3,cy_s:0,cy_a:0,staticScore:c,orientation:"left",matches:{default:1,left:1,center_auto:1,auto_left:1}}),n.push({cx_s:0,cx_a:0,cy_s:-.5,cy_a:-t,staticScore:c,orientation:"above",matches:{default:1,above:1,auto_center:1,above_auto:1}}),n.push({cx_s:-.5,cx_a:-i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tl",matches:{default:1,above_left:1,above_auto:1,auto_left:1}}),n.push({cx_s:.5,cx_a:i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tr",matches:{default:1,above_right:1,above_auto:1,auto_right:1}}),n.push({cx_s:0,cx_a:0,cy_s:.5,cy_a:t,staticScore:c,orientation:"below",matches:{default:1,below:1,auto_center:1,below_auto:1}}),n.push({cx_s:-.5,cx_a:-i,cy_s:.5,cy_a:i,staticScore:c,orientation:"bl",matches:{default:1,below_left:1,below_auto:1,auto_left:1}}),n.push({cx_s:.5,cx_a:i,cy_s:.5,cy_a:i,staticScore:c,orientation:"br",matches:{default:1,below_right:1,below_auto:1,auto_right:1}});var u=Math.cos(e.rotation),p=Math.sin(e.rotation),g=n.map(function(h){var b=h.cx_s*a+h.cx_a,C=h.cy_s*l+h.cy_a;let D=b*u-C*p,S=C*u+b*p,V=`calc(${h.cx_s*100-50}% + ${h.cx_a}px)`,k=`calc(${h.cy_s*100-50}% + ${h.cy_a}px)`,T=-a/2,A=a/2,R=-l/2,P=l/2;if(e.rotation){let W=g$([{x:T*u-R*p,y:R*u+T*p},{x:T*u-P*p,y:P*u+T*p},{x:A*u-R*p,y:R*u+A*p},{x:A*u-P*p,y:P*u+A*p}]);T=W.left,A=W.right,R=W.top,P=W.bottom}return T=Math.round(o+D+T),A=Math.round(o+D+A),R=Math.round(s+S+R),P=Math.round(s+S+P),{pt_x:Math.round(o),pt_y:Math.round(s),left:T,right:A,top:R,bottom:P,width:A-T,height:P-R,transform:`translate(${V},${k})`,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.enforceOrientation&&e.enforceOrientation!=="default"?g=__dcg_shared_module_exports__['n'](g,function(h){return!!h.matches[e.enforceOrientation]}):e.nakedLabel?g=__dcg_shared_module_exports__['n'](g,function(h){return h.orientation==="center"}):e.keepOrientation&&e.priorOrientation?g=__dcg_shared_module_exports__['n'](g,function(h){return h.orientation===e.priorOrientation}):g=__dcg_shared_module_exports__['n'](g,function(h){return h.orientation!=="center"}),jS(r,g),g}function wB(r,e){var t=[],i=e.width,n=e.height,o=i/2,s=n/2,a=e.pt_x1,l=e.pt_y1,c=e.pt_x2,u=e.pt_y2,p=5,g=(u-l)/(c-a),h=Math.atan2(u-l,c-a)+Math.PI/2,b=p*Math.cos(h),C=p*Math.sin(h),D=Math.min(l,u)-Math.abs(C)-n,S=Math.max(l,u)+Math.abs(C),V=[.5,.4,.6,.2,.8],k=[0,20,20,40,40],T=[];for(let j of V)T.push({x:a*(1-j)+c*j,y:l*(1-j)+u*j});for(let j=0;j<T.length;j++){let ne=T[j];var A,R,P,W;if(g>=2||g<=-2){P=W=ne.y-s;let q=Math.abs((c-a)/(u-l)*s)+Math.abs(b);A=ne.x+q,R=ne.x-q-i}else if(g<=.05&&g>=-.05){A=R=ne.x-o;let q=Math.abs(g*o)+Math.abs(C);P=ne.y-q-n,W=ne.y+q}else b>0?(A=ne.x+b,R=ne.x-b-i):(A=ne.x+b-i,R=ne.x-b),C>0?(P=ne.y+C,W=ne.y-C-n):(P=ne.y+C-n,W=ne.y-C);P<D?P=D:P>S&&(P=S),W<D?W=D:W>S&&(W=S);let le=(c-a)*(P-l)-(u-l)*(A-a)>0,w=j.toString()+(le?"-a":"-b");t.push({pt_x:ne.x,pt_y:ne.y,left:A,top:P,staticScore:k[j],orientation:w,matches:{[w]:1}});let B=j.toString()+(le?"-b":"-a");t.push({pt_x:ne.x,pt_y:ne.y,left:R,top:W,staticScore:k[j],orientation:B,matches:{[B]:1}})}var H=t.map(function(j){let ne=Math.round(j.left),le=Math.round(j.left+i),w=Math.round(j.top),B=Math.round(j.top+n);return{pt_x:Math.round(j.pt_x),pt_y:Math.round(j.pt_y),transform:`translate(${j.left-j.pt_x}px,${j.top-j.pt_y}px)`,left:ne,right:le,top:w,bottom:B,width:le-ne,height:B-w,staticScore:e.priorOrientation===j.orientation?j.staticScore-20:j.staticScore,orientation:j.orientation,matches:j.matches}});return e.keepOrientation&&e.priorOrientation&&(H=__dcg_shared_module_exports__['n'](H,function(j){return j.orientation===e.priorOrientation})),jS(r,H),H}function xB(r,e){var t=[],i=e.pt_x,n=e.pt_y,o=e.width,s=e.height;let a=-(e.startAngle+e.deltaAngle/2),l=e.isRightAngle?e.radius*Math.sqrt(2)-1:e.radius+4,c=l+Math.sqrt(e.width*e.width/4+e.height*e.height/4),u=[],p=c*Math.sin(a);p>l+1/2*s&&(p=l+1/2*s),p<-l-1/2*s&&(p=-l-1/2*s),u.push({x:i+c*Math.cos(a)-o/2,y:n+p-s/2});for(let h=0;h<u.length;h++){let b=u[h],C=h.toString()+"-a";t.push({pt_x:b.x,pt_y:b.y,left:b.x,top:b.y,staticScore:0,orientation:C,matches:{[C]:1}})}var g=t.map(function(h){let b=Math.round(h.left),C=Math.round(h.left+o),D=Math.round(h.top),S=Math.round(h.top+s);return{pt_x:Math.round(h.pt_x),pt_y:Math.round(h.pt_y),transform:`translate(${h.left-h.pt_x}px,${h.top-h.pt_y}px)`,left:b,right:C,top:D,bottom:S,width:C-b,height:S-D,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.keepOrientation&&e.priorOrientation&&(g=__dcg_shared_module_exports__['n'](g,function(h){return h.orientation===e.priorOrientation})),jS(r,g),g}function vB(r,e){for(var t=[],i=e.width,n=e.height,o=10,s=Math.round(o/Math.sqrt(2)),a=0,l=50,c=0,u=0,p=0,g=0;g<e.path.length-2;g+=2)p+=1,c+=e.path[g],u+=e.path[g+1];var h=c/p,b=u/p;t.push({left:h-i/2,top:b-n/2,staticScore:a,orientation:"center",matches:{center:1}}),t.push({left:h+o+3,top:b-n/2,staticScore:l,orientation:"right",matches:{right:1}}),t.push({left:h-(o+i)-3,top:b-n/2,staticScore:l,orientation:"left",matches:{left:1}}),t.push({left:h-i/2,top:b-(n+o),staticScore:l,orientation:"top",matches:{top:1}}),t.push({left:h-(i+s),top:b-(n+s),staticScore:l,orientation:"tl",matches:{tl:1}}),t.push({left:h+s,top:b-(n+s),staticScore:l,orientation:"tr",matches:{tr:1}}),t.push({left:h-i/2,top:b+o,staticScore:l,orientation:"bottom",matches:{bottom:1}}),t.push({left:h-(i+s),top:b+s,staticScore:l,orientation:"bl",matches:{bl:1}}),t.push({left:h+s,top:b+s,staticScore:l,orientation:"br",matches:{br:1}});var C=t.map(function(D){let S=Math.round(D.left),V=Math.round(D.left+i),k=Math.round(D.top),T=Math.round(D.top+n);return{pt_x:Math.round(h),pt_y:Math.round(b),transform:`translate(${D.left-h}px,${D.top-b}px)`,left:S,right:V,top:k,bottom:T,width:V-S,height:T-k,staticScore:e.priorOrientation===D.orientation?D.staticScore-20:D.staticScore,orientation:D.orientation,matches:D.matches}});return e.keepOrientation&&e.priorOrientation&&(C=__dcg_shared_module_exports__['n'](C,function(D){return D.orientation===e.priorOrientation})),jS(r,C),C}function g$(r){let e=r[0].x,t=r[0].x,i=r[0].y,n=r[0].y;for(var o=r.length-1;o>=1;o--){let{x:s,y:a}=r[o];s<e&&(e=s),s>t&&(t=s),a<i&&(i=a),a>n&&(n=a)}return{left:e,right:t,top:i,bottom:n}}var JS=__dcg_shared_module_exports__['h'](X());var CB=__dcg_shared_module_exports__['h'](X());var oa=__dcg_shared_module_exports__['h'](X());function Vt(r){return{shouldBeFocused:()=>Qh(r),onFocusedChanged:e=>{ZM(r,e)}}}function Qh(r){let e=r.predicate;if(e&&!e())return!1;let t=r.controller.getFocusLocation();return t&&__dcg_shared_module_exports__['G'](t,r.location)}function ZM(r,e){let t=r.predicate;t&&!t()||(e?r.controller.dispatch({type:"set-focus-location",location:r.location}):r.controller.dispatch({type:"blur-focus-location",location:r.location}))}var{If:eA}=oa.Components,Vd=class extends oa.Class{init(){this.controller=this.props.controller()}template(){return oa.createElement("span",{class:()=>{var t,i;let e=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-static-token":(i=(t=this.props).isStatic)==null?void 0:i.call(t),"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.hasLabel(),"dcg-child-of-hovered-token":e==="child","dcg-parent-of-hovered-token":e==="parent","dcg-assignment-token":!!this.getAssignment()}},style:()=>({color:this.getColor()}),role:this.bindFn(this.getAriaRole),"aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabindex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?Vt({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut)},oa.createElement("span",{class:oa.const("dcg-token-background")}),oa.createElement("span",{class:()=>({"dcg-token-icon":!0,[this.getAdditionalTokenClass()]:this.getAdditionalTokenClass(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()})},oa.createElement(eA,{predicate:()=>!!this.getIcon()},()=>oa.createElement("i",{class:this.bindFn(this.getIcon)}))),oa.createElement(eA,{predicate:()=>!!this.getAssignment()},()=>oa.createElement(tt,{latex:this.bindFn(this.getAssignment),config:this.const({})})),oa.createElement(eA,{predicate:()=>this.hasLabel()},()=>oa.createElement("span",{class:()=>({"dcg-token-label":!0})},()=>this.getLabel())))}getAdditionalTokenClass(){if(this.getAssignment()||this.hasError())return"";switch(this.getIconType()){case"glider":return"dcg-token-glider";case"line":return"dcg-token-line";case"segment":return"dcg-token-segment";case"ray":return"dcg-token-ray";case"intersection":return"dcg-token-intersection";case"midpoint":return"dcg-token-midpoint";case"parallel":return"dcg-token-parallel";case"perpendicular":return"dcg-token-perpendicular";case"rotate":return"dcg-token-rotate";case"circle":return"dcg-token-circle";case"arc":return"dcg-token-arc";case"vector":return"dcg-token-vector";case"dilate":return"dcg-token-dilate";case"reflect":return"dcg-token-reflect";case"translate":return"dcg-token-translate";case"transformation":return"dcg-token-transformation";case"point":return"dcg-token-point";case"polygon":return"dcg-token-polygon";case"angle":return"dcg-token-angle";case"angles":return"dcg-token-angles";case"directedangle":return"dcg-token-directedangle"}return""}getIdFromParentRef(e){if(e)return this.controller.getExpressionIdForIdentifier(e[0])}parentOrChildHovered(){var c,u,p,g,h,b;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let e=this.controller.getHoveredTokenIdentifier();if(!e)return!1;let t=this.controller.getExpressionIdForIdentifier(e),i=this.props.identifier(),n=this.props.controller().getExpressionIdForIdentifier(i)||"";if(!t)return!1;let o=this.controller.getItemModel(t),s=this.controller.getItemModel(n);if(!o||o.type!=="expression"||!s||s.type!=="expression")return!1;let a=((p=(u=(c=o.formula)==null?void 0:c.geometry)==null?void 0:u.call)==null?void 0:p.parents)||[],l=((b=(h=(g=s.formula)==null?void 0:g.geometry)==null?void 0:h.call)==null?void 0:b.parents)||[];for(let C=0;C<a.length;C++)if(this.getIdFromParentRef(a[C])===n)return"parent";for(let C=0;C<l.length;C++)if(this.getIdFromParentRef(l[C])===t)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){let e=this.props.identifier();this.currentlyActiveIdentifier&&e!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let e=this.currentlyActiveIdentifier;e&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:e,style:"hovered"}))})}isHidden(){return this.getTokenInfo().isHidden}hasError(){let e=this.getTokenInfo();return!e||e.hasError}getIcon(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"dcg-icon-error";switch(e.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":return"dcg-icon-point";case"translate":case"vector":return"dcg-icon-translation";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":return"dcg-icon-angle";case"polygon":return"dcg-icon-polygon-solid";default:return}}hasLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";let e=this.getTokenInfo().label.trim();return e.length<=2?e:""}getAssignment(){let e=this.props.identifier();return e[0]!=="$"?__dcg_shared_module_exports__['Ib'](e):""}getAriaLabel(){let{description:e}=this.getTokenInfo();return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:e}):e}isTransformation(){var e;return((e=this.getTokenInfo())==null?void 0:e.groupType)==="transformation"}getColor(){if(this.getAssignment())return;let e=this.getTokenInfo();return this.hasError()?"#fa824c":this.isTransformation()||this.isHidden()?"#aaa":e.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let e=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(e)}onPointerOver(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.handle()}onTap(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||(e.handle(),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!e.shiftKey}))}isTokenSelected(){let e=this.getTokenInfo();return!!(e&&e.isSelected)}getAriaRole(){var e,t;if(!((t=(e=this.props).isStatic)!=null&&t.call(e)))return this.props.insideGroup()?"option":"button"}};var yf=r=>{let e=function(){return r};return e.isDcgViewConst=!0,e},bf=class{constructor(e,t,i){this.tokenController=e,this.mathNode=t,this.isStatic=i}updateTokens(e){if(!this.mathNode)return;if(!this.lastTokenInfo||this.lastTokenInfo.latex!==e)if(!this.tokenController.doesLatexContainToken(e))this.lastTokenInfo={latex:e,tokens:[]};else{let i=[];this.mathNode.querySelectorAll(".dcg-mq-token").forEach(n=>{i.push(n)}),this.lastTokenInfo={latex:e,tokens:i}}let t=this.lastTokenInfo.tokens;for(let i of t){let n=i.dcgTokenView;if(n)n.update();else{let o=i.getAttribute("data-dcg-mq-token")||"",s=CB.mountToNode(Vd,i,{controller:yf(this.tokenController),identifier:yf("$"+o),insideMQ:yf(!0),insideGroup:yf(!1),putInTabOrder:yf(!1),isStatic:yf(this.isStatic)});i.dcgTokenView=s}}}};var tt=class extends JS.Class{template(){return this.children.length===1?this.children[0]:JS.createElement("div",{didMount:e=>this.didMountMathquill(e)})}didMount(){this.children.length===1&&this.didMountMathquill(this.findRootNode())}didMountMathquill(e){this.props.tokenController&&(this.mathquillTokenHelper=new bf(this.props.tokenController(),e,!0)),this.staticMath=$l.StaticMath(e,__dcg_shared_module_exports__['a']({},this.props.config())),e.classList.add("dcg-static-mathquill-view"),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillAria(),this.updateMathquillLatex(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}updateMathquillLatex(){if(!this.staticMath)return;let e=this.props.latex();this.lastLatex!==e&&(this.staticMath.latex(e),this.lastLatex=e,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){if(!this.staticMath||!this.props.getAriaLabel)return;let e=this.props.getAriaLabel();e!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(e)}};ct();var Rce=function(){{var r="_*_";O.Event.prototype.wasHandled=function(e){e=e||r;var t=this.originalEvent,i=t&&t.handledBy;if(i&&i[e])return!0;if(e!==r)return!1;var n=O(this.target).closest("[handleEvent]");return n.length&&n[0]!==this.currentTarget?n.attr("handleEvent")!=="false":!1},O.Event.prototype.handle=function(e){e=e||r;var t=this.originalEvent;if(t){var i=t.handledBy;i||(i=t.handledBy={}),i[e]=!0}}}}();var Cl=__dcg_shared_module_exports__['h'](X());ct();function wf(r){let e=__dcg_shared_module_exports__['Yb'](r),t=0;for(;!__dcg_shared_module_exports__['_b'](e);)t+=1,e=__dcg_shared_module_exports__['Zb'](e);return t}var{If:f$}=Cl.Components,xf=500,it=class extends Cl.Class{constructor(){super(...arguments),this.lastLatexProp="",this.wasFocusedLastUpdate=!1}template(){return Cl.createElement("div",{class:Cl.const("dcg-mq-container")},Cl.createElement(f$,{predicate:()=>this.getPlaceholder().trim().length>0},()=>Cl.createElement("span",{class:Cl.const("dcg-mq-placeholder")},Cl.createElement(tt,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()}))),Cl.createElement("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:e=>this.didMountMathquill(e),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0}))}didMount(){this.children.length===1&&this.didMountMathquill(this.findRootNode())}willUnmount(){this.$mathField.off(".view"),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(e){let t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props.config()),{handlers:{reflow:i=>{this.props.onReflow&&this.mathField&&this.props.onReflow(i)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:i=>{this.mathField&&this.viewCanAcceptText(i)&&(this.props.onUserTypedText?this.props.onUserTypedText(i):(this.mathField.typedText(i),this.props.onUserChangedLatex(this.mathField.latex())))},overrideKeystroke:(i,n)=>{if(i==="Backspace"&&n.preventDefault(),!this.mathField)return;if(i==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return n.preventDefault();let o=Re(n);if(o==="Up"||o==="Down"||o==="Left"||o==="Right"||o==="Esc"){let s=[];n.ctrlKey&&s.push("Ctrl"),n.metaKey&&s.push("Meta"),n.altKey&&s.push("Alt"),n.shiftKey&&s.push("Shift"),s.length?(s.push(o),i=s.join("-")):i=o}this.props.onUserPressedKey?this.props.onUserPressedKey(i,n):(this.mathField.keystroke(i,n),this.props.onUserChangedLatex(this.mathField.latex())),this.maybeTriggerOnSelectionChange()}});this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(t.substituteTextarea=()=>O('<textarea autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">')[0]),this.props.tokenController&&(this.mathquillTokenHelper=new bf(this.props.tokenController(),e,!1)),this.$mathField=O(e),this.mathField=$l.MathField(e,t),e._mqMathFieldInstance=this.mathField,e._mqViewInstance=this,this.$mathField.on("focusin.view focusout.view",i=>this.onFocusEvent(i)).on("paste.view",i=>this.onPasteEvent(i)),!HC&&(dp||up)&&this.$mathField.on("keypress.view",i=>this.onKeypressEvent(i)),this.hookupMQTapTouch(),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillAria(),this.updateMathquillLatex(),this.updateMathquillFocused(),this.updateMathquillPostLabel(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}onFocusEvent(e){let t=this.isFocused();t!==this.shouldBeFocused()&&this.props.onFocusedChanged(t,e)}onPasteEvent(e){let t="",i=window.clipboardData,n=e.originalEvent;i&&i.getData?t=i.getData("Text"):n&&n.clipboardData&&n.clipboardData.getData&&(t=n.clipboardData.getData("text/plain"));var o=this.viewCanAcceptText(t);return!o&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),o}viewCanAcceptText(e){return it.canAcceptText(this.mathField,this.props.capExpressionSize(),e)}static canAcceptText(e,t,i){if(!e)return!1;if(!t)return!0;let n=e.latex();return wf(n)+wf(i)<=xf}onKeypressEvent(e){if(e.stopPropagation(),e.preventDefault(),!!this.mathField){var t=e.key&&e.key.length===1?e.key:void 0;t&&this.viewCanAcceptText(t)&&(this.props.onUserTypedText?this.props.onUserTypedText(t):(this.mathField.typedText(t),this.props.onUserChangedLatex(this.mathField.latex())))}}hookupMQTapTouch(){this.$mathField.on("dcg-tap.view",e=>{let t="dcg-tapend.mathquill-selection-change";if(O(document).on(t,()=>{this.maybeTriggerOnSelectionChange(),O(document).off(t)}),e.device!=="touch"||e.wasHandled()||!this.mathField)return;let i=e.changedTouches[0];this.mathField.clickAt(i.clientX,i.clientY,i.target),this.isFocused()||this.mathField.focus();let n;setTimeout(function(){n=Date.now()},0),this.mathField.ignoreNextMousedown(function(){return n===void 0?!0:Date.now()-n<500})})}updateMathquillAria(){if(!this.mathField)return;let e=this.props.getAriaLabel();e!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(e)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let e=this.props.latex();this.mathField&&this.lastLatexProp!==e&&(this.props.capExpressionSize()&&wf(e)>xf||(this.lastLatexProp=e,this.mathField.latex()!==e&&this.mathField.latex(e)))}updateMathquillFocused(){if(!this.mathField)return;let e=this.isFocused(),t=this.shouldBeFocused();t&&t!==this.wasFocusedLastUpdate&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.mathField.select(),this.wasFocusedLastUpdate=t,e!==t&&(t?this.mathField.focus():this.mathField.blur())}isFocused(){return!!(document.activeElement&&O(document.activeElement).closest(this.$mathField).length)}shouldBeFocused(){return this.props.isFocused()}maybeTriggerOnSelectionChange(){let e=this.props.onSelectionChanged;if(!e||!this.mathField)return;let t=this.mathField.selection();__dcg_shared_module_exports__['G'](t,this.lastSelection)||(this.lastSelection=t,e(t))}static getFocusedMathquill(){if(!document.activeElement)return;let e=O(document.activeElement).closest(".dcg-mq-editable-field")[0];if(e)return e._mqMathFieldInstance}static getMQViewInstance(e){let t=e.el();if(t)return t._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(e,t,i){var n=e.selection();let o=n.startIndex===0&&n.endIndex===n.latex.length;if((t==="Up"||t==="Down")&&o)return e.keystroke(t,i),!0;e.keystroke(t,i);var s=e.selection(),a=s.latex!==n.latex||s.startIndex!==n.startIndex||s.endIndex!==n.endIndex;return!a}static simulateKeypress(e,t){var i=it.getMQViewInstance(e);i&&(i.props.onUserPressedKey?i.props.onUserPressedKey(t):(e.keystroke(t),i.props.onUserChangedLatex(e.latex())),i.maybeTriggerOnSelectionChange())}static simulateUserChangedLatex(e){var t=it.getMQViewInstance(e);t&&t.mathField&&t.props.onUserChangedLatex(t.mathField.latex())}static handleKeystrokeAndDecideIfSpecialEvent(e,t,i){return t==="Enter"||t==="Delete"&&e.latex()===""||t==="Backspace"&&e.latex()===""?!0:t==="Up"||t==="Down"||t==="Left"||t==="Right"?it.applyArrowKeyAndReturnIfWasAtBounds(e,t,i):(e.keystroke(t,i),!1)}};function DB(r,e){r.translate(e.left,e.top)}function y$(r,e){var t=document.createRange();t.selectNode(r);var i=t.getBoundingClientRect(),n=i.width>0&&i.height>0;if(!n)return;var o=window.getComputedStyle(r.parentElement),s=r.nodeValue||"";if(!s)return;var a=parseFloat(o.fontSize);let l=-.228*a,c=o.fontStyle+" "+o.fontWeight+" "+o.fontSize+" "+o.fontFamily;return{type:"text",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterY,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},text:s,color:o.color||"#000",font:c,y:i.height+l,hasOutline:e.hasOutline}}function SB(r,e,t){r.save(),r.font=e.font,t?(r.strokeStyle="#FFF",r.lineWidth=3,r.miterLimit=2,r.strokeText(e.text,0,e.y)):(r.fillStyle=e.color,r.fillText(e.text,0,e.y)),r.restore()}function EB(r,e,t){r.save(),t?(r.strokeStyle="#FFF",r.lineWidth=3):(e.fillColor&&(r.fillStyle=e.fillColor),e.strokeColor&&(r.strokeStyle=e.strokeColor)),r.beginPath();for(let i of e.instructions)switch(i.type){case"moveTo":r.moveTo(i.x,i.y);break;case"lineTo":r.lineTo(i.x,i.y);break;case"arcTo":r.arcTo(i.cx,i.cy,i.x,i.y,i.radius);break;case"ellipse":r.ellipse(i.centerX,i.centerY,i.radiusX,i.radiusY,i.rotation,i.startAngle,i.endAngle,i.anticlockwise);break}r.closePath(),t?r.stroke():(e.strokeColor&&r.stroke(),e.fillColor&&r.fill()),r.restore()}function b$(r,e){var t=r.getBoundingClientRect(),i=t.width>0&&t.height>0;if(i){var n=5,o=3,s=-n,a=t.width+n,l=-n,c=t.height+n,u=[{type:"moveTo",x:s+o,y:l},{type:"lineTo",x:a-o,y:l},{type:"arcTo",cx:a,cy:l,x:a,y:l+o,radius:o},{type:"lineTo",x:a,y:c-o},{type:"arcTo",cx:a,cy:c,x:a-o,y:c,radius:o},{type:"lineTo",x:s+o,y:c},{type:"arcTo",cx:s,cy:c,x:s,y:c-o,radius:o},{type:"lineTo",x:s,y:l+o},{type:"arcTo",cx:s,cy:l,x:s+o,y:l,radius:o}];return{type:"path",disableGlow:!0,rect:{left:t.left-e.pointCenterX,right:t.right-e.pointCenterX,top:t.top-e.pointCenterY,bottom:t.bottom-e.pointCenterY},instructions:u,strokeColor:"#C2C2C2",fillColor:"rgba(255,255,255,.75)"}}}function w$(r,e,t){var i=r.getBoundingClientRect(),n=i.width>0&&i.height>0;if(n){var o=i.width,s=parseFloat(e.borderTopWidth||"1px"),a=e.borderTopColor||"#000",l=[{type:"moveTo",x:0,y:0},{type:"lineTo",x:o,y:0},{type:"lineTo",x:o,y:s},{type:"lineTo",x:0,y:s}];return{type:"path",rect:{left:i.left-t.pointCenterX,right:i.right-t.pointCenterX,top:i.top-t.pointCenterY,bottom:i.bottom-t.pointCenterY},instructions:l,fillColor:a}}}function kB(r,e){var t=Math.sqrt(r[0]*r[0]+r[1]*r[1]),i=Math.sqrt(e[0]*e[0]+e[1]*e[1]),n=r[0]*e[0]+r[1]*e[1],o=Math.acos(n/(t*i));return r[0]*e[1]-r[1]*e[0]<0&&(o*=-1),o}function x$(r,e,t,i,n,o,s,a,l){var c=Math.cos(n),u=Math.sin(n),p=(r-a)/2,g=(e-l)/2,h=c*p+u*g,b=-u*p+c*g,C=t*t,D=i*i,S=h*h,V=b*b,k=Math.sqrt((C*D-C*V-D*S)/(C*V+D*S));o===s&&(k*=-1);var T=k*t*b/i,A=-k*i*h/t,R=(r+a)/2,P=(e+l)/2,W=c*T-u*A+R,H=u*T+c*A+P,j=[1,0],ne=[(h-T)/t,(b-A)/i],le=[(-h-T)/t,(-b-A)/i],w=kB(j,ne),B=kB(j,le);return{centerX:W,centerY:H,radiusX:t,radiusY:i,startAngle:w,endAngle:B,rotation:n,anticlockwise:s===0}}var GB={};function v$(r,e){var t=r+"-"+e,i=GB[t];if(i)return i;i=[],GB[t]=i;var n=e.split(" ");if(n.length!==4)return i;var o=parseFloat(n[0]),s=parseFloat(n[2]),a=parseFloat(n[1]),l=parseFloat(n[3]),c=s-o,u=l-a;function p(R){return(R-o)/c}function g(R){return(R-a)/u}var h="[0-9-.]+",b="(M"+h+" "+h+")",C="(L"+h+" "+h+")",D="(A"+h+" "+h+" "+h+" "+h+" "+h+" "+h+" "+h+")",S=new RegExp(b+"|"+C+"|"+D,"g"),V=r.match(S);if(!V||!V.length)return i;var k=NaN,T=NaN;for(let R of V){var A=R.substr(1).split(" ").map(parseFloat);switch(R[0]){case"M":k=p(A[0]),T=g(A[1]),i.push({type:"moveTo",x:k,y:T});break;case"L":k=p(A[0]),T=g(A[1]),i.push({type:"lineTo",x:k,y:T});break;case"A":let P=A[0]/c,W=A[1]/u,H=A[2],j=A[3],ne=A[4],le=p(A[5]),w=g(A[6]),B=x$(k,T,P,W,H,j,ne,le,w);k=le,T=w,i.push(__dcg_shared_module_exports__['a']({type:"ellipse"},B));break}}return i}function C$(r,e){var t=r.childNodes[0];if(!(!t||t.nodeName!=="path")){var i=r.getBoundingClientRect(),n=i.width>0&&i.height>0;if(n){var o=t.getAttribute("d")||"",s=r.getAttribute("viewBox")||"",a=v$(o,s),l=window.getComputedStyle(r),c=i.width,u=i.height;a=__dcg_shared_module_exports__['j'](a);for(let p of a)switch(p.type){case"moveTo":case"lineTo":p.x*=c,p.y*=u;break;case"arcTo":p.x*=c,p.y*=u,p.cx*=c,p.cy*=u,p.radius*=c;break;case"ellipse":p.centerX*=c,p.centerY*=u,p.radiusX*=c,p.radiusY*=u;break;default:return p}return{type:"path",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterX,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},fillColor:l.color||"#000",instructions:a}}}}function IB(r,e,t){var i=window.getComputedStyle(r);if(i.borderTopWidth!=="0px"){let a=w$(r,i,e);a&&t.push(a)}for(var n=r.childNodes,o=0;o<n.length;o++){var s=n[o];if(s.nodeType===3){let a=y$(s,e);a&&t.push(a)}else if(s.nodeName==="svg"){let a=C$(s,e);a&&t.push(a)}else s.nodeType===1&&IB(s,e,t)}}function YS(r,e){let t=[];if(e.hasBorder){let i=b$(r,e);i&&t.push(i)}return IB(r,e,t),t}function XS(r,e){gn(e,"dcg-svg-label"),e.save(),Hi(e);for(let t of r){switch(e.save(),DB(e,t.rect),t.type){case"path":t.disableGlow||EB(e,t,!0);break;case"text":t.hasOutline&&SB(e,t,!0);break;default:return t}e.restore()}for(let t of r){switch(e.save(),DB(e,t.rect),t.type){case"path":EB(e,t,!1);break;case"text":SB(e,t,!1);break;default:return t}e.restore()}e.restore()}var{Input:D$}=Oi.Components,{For:VB,Switch:S$,IfElse:E$}=Oi.Components;function k$(r,e){return e?e.getPOIById(r):null}function Zh(r,e){return 1e3*(r.pixelsToMath.mapX(r.mathToPixels.mapX(e)+.5)-r.pixelsToMath.mapX(r.mathToPixels.mapX(e)-.5))}function ZS(r,e){return 1e3*(r.pixelsToMath.mapY(r.mathToPixels.mapY(e)+.5)-r.pixelsToMath.mapY(r.mathToPixels.mapY(e)-.5))}function G$(r,{x:e,y:t}){let i=Zh(r,e),n=ZS(r,t);return{xscale:i,yscale:n}}function I$(r,e){var t,i=!1;let n="",o="";if(r.type==="poi"){let p=r.poi,{xscale:g,yscale:h}=G$(e,p);t=p.getLabel();let b=p.getGraphMode(),C;var s=p.type===1007&&p.getCompiledFunction();if(s){var a=b===1,l=a?p.y:p.x;if(C=__dcg_shared_module_exports__['Db'](l,g,h,s),a){var c=C[0];C[0]=C[1],C[1]=c}}else C=[__dcg_shared_module_exports__['Cb'](p.x,g),__dcg_shared_module_exports__['Cb'](p.y,h)];i=!isFinite(C[1].value),n=C[0].superscript?C[0].mantissa+"^{"+C[0].superscript+"}":C[0].string,o=C[1].superscript?C[1].mantissa+"^{"+C[1].superscript+"}":C[1].string,n==="undefined"&&(n="\\mathrm{undefined}"),o==="undefined"&&(o="\\mathrm{undefined}")}else t=r.text;var u=t&&__dcg_shared_module_exports__['_c'](t);return t?u==="latex"?{is_hole:i,type:"latex",text:t.substr(1,t.length-2)}:u==="text"?{is_hole:i,type:"text",text:t}:{is_hole:i,type:"mixed",text:t}:r.type==="poi"?r.poi.hasEditableLabel()?{is_hole:i,type:"text",text:""}:{is_hole:i,type:"latex",text:"\\left("+n+",\\space "+o+"\\right)"}:{is_hole:i,type:"text",text:"?"}}function TB(r,e,t){let i=r.s("graphing-calculator-label-poi-unknown"),n=e.getProjection();return!n||!n.viewport||t&&(i=eg(r,t.x,t.y)),i}var vf=class extends Oi.Class{constructor(){super(...arguments),this.labelsDirty=!1}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.cachedLabelDict={},this.cachedLabelOrder=[],this.hoveredPOI=void 0,this.openedPOI2Sketch={},this.takingScreenshot=!1}template(){return Oi.createElement(VB,{each:()=>this.cachedLabelOrder},Oi.createElement("div",{class:Oi.const("dcg-graph-outer"),style:this.const({"z-index":0}),didMount:this.bindFn(this.didMountRoot)},e=>Oi.createElement("div",{class:()=>this.getLabelClasses(e),style:()=>this.getLabelStyles(e),didMount:t=>this.linkLabelContainerNode(e,t)},Oi.createElement("div",{class:Oi.const("dcg-pt"),style:()=>this.getDotStyles(e)}),Oi.createElement("div",{class:Oi.const("dcg-label"),didMount:t=>this.linkLabelDOMNode(e,t)},this.renderLabelContent(e)))))}renderLabelContent(e){return Oi.createElement(S$,{key:()=>this.getLabelContent(e).type},t=>t==="text"?Oi.createElement("span",{class:Oi.const("dcg-label-raw-text")},()=>this.getLabelContent(e).text):t==="latex"?Oi.createElement(tt,{latex:()=>this.getLabelContent(e).text,config:this.bindFn(this.getMQConfig)}):t==="mixed"?Oi.createElement(VB,{each:()=>__dcg_shared_module_exports__['$c'](this.getLabelContent(e).text),key:(i,n)=>`${i}${n}`},Oi.createElement("span",null,i=>E$(()=>__dcg_shared_module_exports__['_c'](i)==="latex",{true:()=>Oi.createElement(tt,{latex:()=>i.substr(1,i.length-2),config:this.bindFn(this.getMQConfig)}),false:()=>Oi.createElement("span",{class:Oi.const("dcg-label-raw-text")},()=>i)}))):t==="MATH"?Oi.createElement("div",{class:()=>({"dcg-editable-label-border":!0,"dcg-do-not-blur":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['Q'](this.getEditableLabelTextColor(e),.3)})},Oi.createElement(it,{latex:()=>this.getEditableLabelText(e),placeholder:()=>"",isFocused:()=>this.shouldEditableLabelBeFocused(e),capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:Oi.const(!1),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:TB(this.controller,this.grapher,this.cachedLabelDict[e])}),getAriaPostLabel:this.const(""),onUserChangedLatex:i=>this.onLabelInput(i,e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>this.onEditableLabelFocusChange(i,e),hasError:this.const(!1),noFadeout:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})):Oi.createElement("div",{class:()=>({"dcg-resizing-text-input-container":!0,"dcg-editable-label-border":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['Q'](this.getEditableLabelTextColor(e),.3)}),onScroll:i=>{i.target&&(i.target.scrollLeft=0)}},Oi.createElement(D$,{"aria-label":()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:TB(this.controller,this.grapher,this.cachedLabelDict[e])}),onInput:i=>this.onLabelInput(i,e),value:()=>this.getEditableLabelText(e),onFocus:()=>this.onEditableLabelFocusChange(!0,e),onBlur:()=>this.onEditableLabelFocusChange(!1,e)}),Oi.createElement("span",{class:Oi.const("dcg-text-input-content")},()=>this.getEditableLabelText(e)||" ")))}getSketchIdFromLabelId(e){var t=this.cachedLabelDict[e];if(t)return t.sketchId}getEditableLabelTextColor(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"#000";let i=this.controller.getItemModel(t);return!i||i.type!=="expression"?"#000":kc(i)}onEditableLabelFocusChange(e,t){let i=this.getSketchIdFromLabelId(t);i&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"editable-label",id:i}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"editable-label",id:i}}),this.update())}shouldEditableLabelBeFocused(e){let t=this.getSketchIdFromLabelId(e),i=this.controller.getFocusLocation();return!(!i||i.type!=="editable-label"||!t||i.id!==t)}onLabelInput(e,t){let i=this.getSketchIdFromLabelId(t);if(!i)return;let n=this.controller.getItemModel(i);if(!n||n.type!=="expression")return;let o=e;this.controller.getItemEditableLabelMode(i)==="MATH"&&o.length>0&&(o="`"+o+"`"),this.controller.dispatch({type:"set-item-label",id:i,label:o})}getEditableLabelText(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"";let i=this.controller.getItemModel(t);return!i||i.type!=="expression"?"":this.controller.getItemEditableLabelMode(t)==="MATH"?i.label.substr(1,i.label.length-2):i.label}linkLabelDOMNode(e,t){var i=this.cachedLabelDict[e];i&&(i.labelDOM=t)}linkLabelContainerNode(e,t){var i=this.cachedLabelDict[e];i&&(i.containerDOM=t)}getLabelClasses(e){var t=this.cachedLabelDict[e];return t?t.classes:{}}getLabelStyles(e){var t=this.cachedLabelDict[e];return t?t.styles:{}}getDotStyles(e){var t=this.cachedLabelDict[e];return t?t.dotStyles:{}}getLabelContent(e){var t=this.cachedLabelDict[e];if(t){let i=this.getSketchIdFromLabelId(e);if(!i)return{is_hole:!1,type:"text",text:""};let n=this.controller.getItemEditableLabelMode(i);return t.classes["dcg-editable-label"]&&n!==void 0&&n!=="NONE"?{is_hole:!1,type:n,text:""}:t.content}return{is_hole:!1,type:"text",text:""}}didMountRoot(e){this.node=e}computeHoveredLabel(e,t){var i;this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-opened-poi"):(i=this.computeLabel({poi:this.hoveredPOI,type:"poi"},e,t,"hovered"),this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-closed-poi")):this.grapher.setLayerClass("hoveredPOI",void 0);var n=this.getHoveredInteractiveLabel();n&&!n.bareLabel?this.grapher.setLayerClass("interactiveLabel","dcg-mouse-over-opened-poi"):this.grapher.setLayerClass("interactiveLabel",void 0),i&&this.saveLabelToCache(i)}computeTraceLabel(e,t){if(this.traceInfo){var i=this.traceInfo.pt;if(i){var n=new Su(i.x,i.y,1007,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch,0),o=this.computeLabel({poi:n,type:"poi"},e,t,"trace");o&&this.saveLabelToCache(o)}}}computeLabel(e,t,i,n){let o=e.type==="poi"?e.poi.id+"":e.id;n==="trace"&&(o="*trace*");let s=e.poi,a=t.mapx(s.x),l=t.mapy(s.y),c=a,u=l;if(e.type!=="poi"&&(a=0,l=0),t.coordsAreOnscreen(a,l,20)){if(this.isHiddenInteractiveLabel(s))return;let p=!1,g,h=s.sketch,b=h&&h.branches[0];b&&(p=!!("nakedLabel"in b&&b.nakedLabel),g="labelOrientation"in b?b.labelOrientation:void 0);let C=h.id,D=this.controller.getItemModel(C);if(s.hasEditableLabel()&&D&&D.type==="expression"&&!ta(D))return;let S=I$(e,t),V=s.pointIdxOnBranch,k=s.getLabelSize();this.grapher.settings.config.projectorMode&&(k*=1.2),Array.isArray(k)&&(k=k[V]);let T=s.getLabelRotation();Array.isArray(T)&&(T=T[V]);let A=s.getPointOpacity()*this.controller.getGeoModel().getToolFadeOpacity(C),R=!!s.getTextOutline(),P=s.isPersistent(),W=s.isAttachedToPlottedPoint(),H=s.hasInteractiveLabel(),j=s.hasEditableLabel()&&!this.takingScreenshot,ne=!!(D&&D.type==="expression"&&fa(D)),le=this.grapher.clickableObjectsLayer.shouldDrawPressed(C,s.pointIdxOnBranch),w=this.grapher.clickableObjectsLayer.shouldDrawHovered(C,s.pointIdxOnBranch),B=this.grapher.clickableObjectsLayer.isKeyboardFocused(C,s.pointIdxOnBranch),q=h.color;if(le){let Oe=__dcg_shared_module_exports__['fa'](q);Oe.l>.2?Oe.l-=.2:Oe.l+=.1,q=Oe.toString()}else if(w){let Oe=__dcg_shared_module_exports__['fa'](q);Oe.l>.2?Oe.l-=.1:Oe.l+=.2,q=Oe.toString()}let M=!P,ae=!!W;H&&(ae=!0,M=!0),n==="trace"&&(ae=!1,M=!0);let se=i[o],ge=se&&se.labelDOM,he=se&&se.containerDOM,ye=se&&se.width,fe=se&&se.height,Se=se&&se.orientation,de={"dcg-poi-label":!0,"dcg-tracept":n==="trace","dcg-opened":n==="opened","dcg-hole":S.is_hole,"dcg-show-border":M,"dcg-hide-dot":ae,"dcg-naked-label":p,"dcg-editable-label":j,"dcg-has-outline":R,"dcg-focus":B,"dcg-underlined-label":!!(ne&&D&&D.type==="expression"&&D.hidden)};isFinite(k)||(k=1);let Ee=Math.round(k*1100)/10,U={left:a+"px",top:l+"px","font-size":Ee+"%"};T&&!this.takingScreenshot&&(U.transform=`rotate(${T}rad)`),P&&q&&(U.color=q),U.opacity=`${Math.min(.99,A)}`;let ce={};return n==="trace"&&(ce["background-color"]=q,ce["border-color"]=q),{id:o,sketchId:C,poi:s,x:s.x,y:s.y,screenX:a,screenY:l,top:u,left:c,width:ye,height:fe,labelDOM:ge,containerDOM:he,forcedOrientation:g,isNakedLabel:p,isClickable:ne,orientation:Se,rotation:T,classes:de,styles:U,dotStyles:ce,content:S,hasBorder:s.hasEditableLabel(),opacity:A,hasOutline:R||s.hasEditableLabel(),objectSpec:e.type!=="poi"?e.type==="angle"?{type:e.type,segments:[t.mapx(e.segments[0]),t.mapy(e.segments[1]),e.segments[2],e.segments[3]]}:{type:e.type,segments:t.map_xy_pairs(e.segments)}:void 0}}}computeAllLabels(e,t){var i={},n,o,s=this.grapher.graphSketches;this.grapher.getSketchOrder().forEach(c=>{var u=s[c];if(u){var p=u.labels;if(p.length)for(var g=0;g<p.length;g++){let h=p[g],b=this.computeLabel(h,e,t,"opened");b&&(Array.isArray(u.color)&&(b.styles.color=u.color[g]),this.saveLabelToCache(b))}}});var a={};for(n in this.openedPOI2Sketch){var l=k$(n,s[this.openedPOI2Sketch[n]]);l&&(a[n]=l.sketch.id,o=this.computeLabel({poi:l,type:"poi"},e,t,"opened"),o&&this.saveLabelToCache(o))}return this.openedPOI2Sketch=a,i}saveLabelToCache(e){var t=e.id;this.cachedLabelDict[t]||this.cachedLabelOrder.push(t),this.cachedLabelDict[t]=e}markLabelsDirty(){this.labelsDirty=!0}getInteractiveLabelUnderPoint(e){let t;for(var i=this.cachedLabelOrder.length-1;i>=0;i--){let n=this.cachedLabelOrder[i],o=this.cachedLabelDict[n];if(!o||!o.width||!o.height)continue;let s=o.screenX,a=o.screenY,{left:l,top:c,width:u,height:p}=o;if(u>0&&p>0&&e.x>s+l&&e.x<s+l+u&&e.y>a+c&&e.y<a+c+p){let g=this.getSketchIdFromLabelId(n);if(g===void 0)continue;let h=this.controller.getItemModel(g);if(!h||h.type!=="expression")continue;if(Gm(h))return{type:"editable",model:h};!t&&j_(h)?t={type:"draggable",label:{model:h,x:o.x,y:o.y}}:!t&&o.isClickable&&(t={type:"clickable",model:h,poi:o.poi})}}return t}positionLabels(e,t,i,n,o){var s=!this.labelsDirty;this.labelsDirty=!1;var a=[];t.forEach(p=>{var g=i[p];if(!g||!g.labelDOM)return;let h,b=this.getSketchIdFromLabelId(p);if(b!==void 0){let R=this.grapher.getGraphSketch(b);R&&R.branches&&(h=R.branches[0].pointSize)}(h===void 0||typeof h!="number"||h<0)&&(h=9);let D=(this.grapher.settings.config.projectorMode?14:10)*h/9;var S=g.screenX,V=g.screenY,k=g.labelDOM.clientWidth,T=g.labelDOM.clientHeight;if(!(k>0&&T>0))return;let A=0;this.takingScreenshot&&g.hasBorder&&(A=5),a.push({renderedLabel:g,pt_x:S,pt_y:V,pt_radius:D+A,rotation:g.rotation,nakedLabel:g.isNakedLabel,width:k,height:T,keepOrientation:s,priorOrientation:g.orientation,enforceOrientation:g.forcedOrientation})});var l=yB(e,n,o),c=a.map(p=>{if(p.renderedLabel.objectSpec){if(p.renderedLabel.objectSpec.type==="segment")return wB(l,{pt_x1:p.renderedLabel.objectSpec.segments[0],pt_y1:p.renderedLabel.objectSpec.segments[1],pt_x2:p.renderedLabel.objectSpec.segments[2],pt_y2:p.renderedLabel.objectSpec.segments[3],pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""});if(p.renderedLabel.objectSpec.type==="polygon")return vB(l,{path:p.renderedLabel.objectSpec.segments,pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""});if(p.renderedLabel.objectSpec.type==="angle"){let g=p.renderedLabel.objectSpec.segments,h=this.grapher.settings.config.projectorMode?30:20;return xB(l,{pt_x:g[0],pt_y:g[1],startAngle:g[2],deltaAngle:g[3],isRightAngle:IS(g[3]),radius:h,pt_radius:10,width:p.width,height:p.height,keepOrientation:p.keepOrientation,priorOrientation:p.priorOrientation||""})}}else return bB(l,p);return[]}),u=mB(c);u.forEach(function(p,g){var h=a[g].renderedLabel;h.orientation=p.orientation;let b=p.left-p.pt_x,C=p.top-p.pt_y;h.left=b,h.top=C,h.width=p.width,h.height=p.height;var D=h.labelDOM;if(D){D.style.transform=p.transform,O(D).data("orientation",p.orientation);var S=h.containerDOM;S&&(S.style.left=p.pt_x+"px",S.style.top=p.pt_y+"px"),setTimeout(()=>D.classList.add("dcg-enable-transition"),1)}})}copyToCtx(e){Ks(e,"labels");var t=this.node.getBoundingClientRect();this.cachedLabelOrder.forEach(i=>{var n=this.cachedLabelDict[i];if(!n)return;var o=n.labelDOM;if(!o)return;let s={pointCenterX:n.screenX,pointCenterY:n.screenY,hasOutline:!!n.hasOutline,hasBorder:!!n.hasBorder};var a=this.computeRotatedCenter(s.pointCenterX,s.pointCenterY,n.rotation);let l=YS(o,s);e.save(),e.globalAlpha=n.opacity,e.rotate(n.rotation),e.translate(a.x-t.left,a.y-t.top),XS(l,e),e.restore()}),Us(e)}computeRotatedCenter(e,t,i){var n=Math.cos(-i),o=Math.sin(-i),s=e*n-t*o,a=t*n+e*o;return{x:s,y:a}}drawForScreenshot(e,t,i,n,o){this.takingScreenshot=!0,this.redraw(e,t,n,o),this.takingScreenshot=!1,this.copyToCtx(i)}redraw(e,t,i,n){var o=this.cachedLabelDict;this.cachedLabelDict={},this.cachedLabelOrder=[],this.computeAllLabels(e,o),this.computeHoveredLabel(e,o),this.computeTraceLabel(e,o),this.update(),this.positionLabels(t,this.cachedLabelOrder,this.cachedLabelDict,i,n)}clearOpenedPOI(){this.openedPOI2Sketch={}}closePOI(e){delete this.openedPOI2Sketch[e.id]}openPOI(e){this.openedPOI2Sketch[e.id]=e.sketch.id}isOpenPOI(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)}isOpenInteractiveLabel(e){return this.isOpenPOI(e)?e.hasInteractiveLabel():!1}isHiddenInteractiveLabel(e){return!e||!e.hasInteractiveLabel()?!1:!this.isOpenPOI(e)&&this.getHoveredPOI()!==e}setHoveredPOI(e){this.hoveredPOI=e}getHoveredPOI(){return this.hoveredPOI}getHoveredInteractiveLabel(){var e=this.getHoveredPOI();if(e&&e.hasInteractiveLabel())return e}setTraceInfo(e){this.traceInfo=e}isTracing(){return!!this.traceInfo}getTraceInfo(){return this.traceInfo}getMQConfig(){return this.controller.getMathquillConfig({})}};function eE(r,e){let t=r[e];return Array.isArray(t)&&r.tableInfo?t[r.tableInfo.rowIndex]:t}var bw=class{constructor(e){this.grapher=e,this.renderedPointsIdOrder=[],this.renderedPoints={}}redraw(e,t,i){var n=this.grapher.graphSketches,o=this.renderedPoints;this.renderedPoints={},this.renderedPointsIdOrder=[];let s=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),a=s==null?void 0:s.calcId,l=(s==null?void 0:s.listIndex)||0;var c=S=>{let V=!!s&&a===S.sketch.id&&l===S.listIndex;var k=this.processPOI(e,t,S,o[S.id],i,V);k&&(this.renderedPoints[S.id]=k,this.renderedPointsIdOrder.push(S.id))};this.grapher.getSketchOrder().forEach(S=>{var V=n[S];V&&(V.getMovablePoints().forEach(c),V.getStaticLabeledPoints().forEach(c))});var u=this.renderedPoints[this.hoveredPointId],p=this.renderedPoints[this.pressedPointId],g=u&&u.poi,h=p&&p.poi;g||this.setHoveredPointId(void 0),h||this.setPressedPointId(void 0);var b=h||g,C,D;b?(C=b.type==="movable-point"&&b.tableInfo&&b.tableInfo.dragX,D=b.type==="movable-point"&&b.tableInfo&&b.tableInfo.dragY,C&&D||!C&&!D?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point"):C?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ew"):this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ns")):this.grapher.setLayerClass("movablePoints",void 0),this.getPOIUnderAttention()||(this.lastAriaAlert=void 0)}_clampedOpacity(e){return e<0?0:e>1?1:__dcg_shared_module_exports__['L'](e)?e:1}getAllRenderedObjects(e){return this.renderedPointsIdOrder.filter(t=>e?this.renderedPoints[t].type===e:!0).map(t=>this.renderedPoints[t])}getOrderedTabTargets(e){let t=[];return this.renderedPointsIdOrder.forEach(i=>{let n=this.renderedPoints[i];if(e&&n.type!==e||this.getTabIndex(i)===-1)return;let o=n.poi;t.push({calcId:o.sketch.id,listIndex:o.listIndex,polygonEdge:void 0,description:this.grapher.controller.isGeometry()?void 0:this.getAriaLabel(i)})}),t}drawForScreenshot(e,t,i,n){var o=this.grapher.graphSketches;for(let c in o){var s=o[c],a=s.branches[0],l;a.graphMode===4&&(l=a.pointOpacity),s.getMovablePoints().forEach(u=>{var p={screenX:t.mapx(u.x),screenY:t.mapy(u.y),color:u.color,pointOpacity:l,animationPercent:0};this.drawMovablePointOnCtx(e,u.sketch,p,i,n)})}}processPOI(e,t,i,n,o,s){var a=i.id,l=i.x,c=i.y,u=t.mapx(l),p=t.mapy(c),g=t.coordsAreOnscreen(u,p,20);if(!(!g&&!s)){if(!n){var h=i.sketch?this.grapher.controller.getItemModel(i.sketch.id):void 0;i.type==="movable-point"?n={type:"movable",id:a,pointOnScreen:g,poi:i,projection:t,screenX,screenY,color:eE(i,"color"),pointOpacity:eE(i,"pointOpacity"),pointIsHovered:!1,pointIsPressed:!1,lastHoverActionTime:0,animationPercent:0}:h&&h.type==="expression"&&h.label!==void 0&&h.showLabel&&rn(h)!=="NONE"?n={type:"draggable-label",id:a,pointOnScreen:g,poi:i,projection:t,screenX,screenY}:n={type:"static",id:a,pointOnScreen:g,poi:i,projection:t,screenX,screenY}}return n.pointOnScreen=g,n.poi=i,n.projection=t,n.screenX=u,n.screenY=p,n.type==="movable"&&(n.color=eE(n.poi,"color"),n.pointOpacity=eE(n.poi,"pointOpacity"),this.updateMovablePointAnimation(n,s),this.drawMovablePointOnCtx(e,n.poi.sketch,n,o)),n}}drawMovablePointOnCtx(e,t,i,n,o){var b;var s;o?s=o:s=this.grapher.settings.config.projectorMode?13.5:10.5,t.tokenSelected?s*=2:t.tokenHovered?s*=1.5:t.showHighlight&&(s*=1.2);var a=Array.isArray(i.color)?i.color[0]:i.color,l=i.screenX,c=i.screenY,u=i.animationPercent||0;n.push({left:l-s,right:l+s,top:c-s,bottom:c+s}),e.save();var p=e.globalAlpha;let g=this.shouldDrawGhosted(t.id)?ES.IS_GHOSTED:sw;var h=this._clampedOpacity(g*i.pointOpacity);h*=(b=this.grapher.controller.getGeoModel().getToolFadeOpacity(t.id))!=null?b:1,e.fillStyle=a,e.globalAlpha=.35*h,e.beginPath(),e.moveTo(l+s,c),e.arc(l,c,s,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=h,s*=.3+.7*u,e.beginPath(),e.moveTo(l+s,c),e.arc(l,c,s,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=p,e.restore()}updateMovablePointAnimation(e,t){var i=Date.now(),n=e.id,o=this.hoveredPointId===n||t,s=this.pressedPointId===n;e.pointIsPressed=s,o!==e.pointIsHovered&&(e.pointIsHovered=o,e.lastHoverActionTime=i);var a=e.animationPercent||0,l=i-e.lastHoverActionTime,c=.004*l;s?a=1:o?(a+=c,a>=1?a=1:this.requestRedrawNextFrame()):(a-=c,a<=0?a=0:this.requestRedrawNextFrame()),e.animationPercent=a}shouldDrawGhosted(e){if(!e)return!1;let t=this.grapher.controller.getItemModel(e);return!t||t.type!=="expression"?!1:Ba(t)}getTabIndex(e){if(this.grapher.controller.getActiveTool()!=="selection")return-1;let t=this.renderedPoints[e];if(!t)return-1;let i=t.poi,n=this.grapher.controller.getItemEditableLabelMode(i.sketch.id),o=this.grapher.controller.getItemModel(i.sketch.id),s=o&&o.type==="expression"&&!fa(o)&&(t.type==="movable"||n===void 0||n==="NONE");var a=this.grapher.settings;let l=a.config.graphpaper&&a.config.enableTabindex;return s&&l?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getAriaLabel(e){var t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){var i;if(this.grapher.controller.isGeometry())return!1;let e=(i=this.getPOIUnderAttention())==null?void 0:i.id;if(e){let n=this.renderedPoints[e];if(!n||n.type==="static")return this.lastAriaAlert=void 0,!1}let t=this.getAriaAlert({id:e,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});return this.lastAriaAlert=t,t&&t.completeMessage?(xe(t.completeMessage),!0):!1}getAriaAlert(e){let{id:t,lastAriaAlert:i,includeUsageInstructions:n}=e;if(!t)return;var o=this.renderedPoints[t];if(!o)return;i&&i.id!==t&&(i=void 0);var s=o.poi,a=o.pointOnScreen,l=o.projection;if(!s||!l)return;var c=l.viewport;if(!c)return;var u=i&&i.label,p=s.ariaLabel,g=u!==p,h=i&&i.coordX,b=i&&i.coordY,C=s.x,D=s.y,S=C!==h||D!==b,V=eg(this.grapher.controller,C,D);let{controller:k}=this.grapher;var T=p||k.s("graphing-calculator-narration-movable-point-prefix"),A=(o.type==="movable"||o.type==="draggable-label")&&n?k.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",R=a?"":k.s("graphing-calculator-narration-movable-point-off-screen-prompt"),P;return i?g?P=T+R:S?P=V+R:P="":P=T+". "+V+A+R,{id:t,coordX:C,coordY:D,label:p,completeMessage:P}}setHoveredPointId(e){e!==this.hoveredPointId&&(this.hoveredPointId=e,this.requestRedrawNextFrame())}isMovingPoint(){return!!this.pressedPointId}setPressedPointId(e){e!==this.pressedPointId&&(this.pressedPointId=e,this.requestRedrawNextFrame())}getPOIUnderAttention(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(!e)return;let t=e.listIndex||0;for(let i in this.renderedPoints){let o=this.renderedPoints[i].poi;if(o.sketch.id===e.calcId&&o.listIndex===t)return o}}requestRedrawNextFrame(){this.grapher.controller.requestRedrawGraph()}};function eg(r,e,t){return qi(r,e)+" "+zi(r,t)}function qi(r,e){let t=r.getGraphSettings().showXAxis,i=r.get2dProjection();if(!i)return"";let{width:n}=i.screen;return t?r.s("graphing-calculator-narration-audio-trace-property-x",{x:Hs(__dcg_shared_module_exports__['Cb'](e,Zh(i,e)).latex)}):r.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(i.mathToPixels.mapX(e)/n*1e3)/10})}function zi(r,e){let t=r.getGraphSettings().showYAxis,i=r.get2dProjection();if(!i)return"";let{height:n}=i.screen;return t?r.s("graphing-calculator-narration-audio-trace-property-y",{y:Hs(__dcg_shared_module_exports__['Cb'](e,Zh(i,e)).latex)}):r.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(i.mathToPixels.mapY(e)/n*1e3)/10})}var V$=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function MB(r){return r===1/0||r===-1/0}var tg=V$?Math.hypot:function(r,e){if(MB(r)||MB(e))return 1/0;if(isNaN(r)||isNaN(e))return NaN;if(r===0&&e===0)return 0;if(Math.abs(r)>Math.abs(e)){let t=e/r;return Math.abs(r)*Math.sqrt(t*t+1)}else{let t=r/e;return Math.abs(e)*Math.sqrt(t*t+1)}};function Cf(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,i]=__dcg_shared_module_exports__['pa'](e),n=__dcg_shared_module_exports__['ka'](r.x0-t,r.y0-i);return{x:t,y:i,radius:n}}function tE(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,i]=__dcg_shared_module_exports__['pa'](e);return{startAngle:Math.atan2(r.y0-i,r.x0-t),deltaAngle:__dcg_shared_module_exports__['qa'](e)}}var AB=(r,e)=>({x:r.x-e.x,y:r.y-e.y}),T$=(r,e)=>r.x*e.x+r.y*e.y;function iE(r,e){return tg(r.x-e.x,r.y-e.y)}function LB(r,e){let t={x:r.x1,y:r.y1},i={x:r.x2,y:r.y2},n=AB(e,t),o=AB(i,t),s=iE(t,i),a=s*s;return T$(n,o)/a}function iA(r){return[{x1:r.left,y1:r.top,x2:r.left,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.top,x2:r.right,y2:r.top,extendStart:!1,extendEnd:!1},{x1:r.right,y1:r.top,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.bottom,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1}]}function M$(r){let{angle:e,width:t,height:i,center:n}=r,o=n.x,s=n.y,a=Math.cos(-e),l=Math.sin(-e),c=t/2,u=i/2,p={x:o+a*-c-l*-u,y:s+l*-c+a*-u},g={x:o+a*c-l*-u,y:s+l*c+a*-u},h={x:o+a*c-l*u,y:s+l*c+a*u},b={x:o+a*-c-l*u,y:s+l*-c+a*u};return[{x1:p.x,y1:p.y,x2:g.x,y2:g.y,extendStart:!1,extendEnd:!1},{x1:g.x,y1:g.y,x2:h.x,y2:h.y,extendStart:!1,extendEnd:!1},{x1:h.x,y1:h.y,x2:b.x,y2:b.y,extendStart:!1,extendEnd:!1},{x1:b.x,y1:b.y,x2:p.x,y2:p.y,extendStart:!1,extendEnd:!1}]}function A$(r,e){let t=iA(r);return!!(nE(e,t[0])||nE(e,t[1])||nE(e,t[2])||nE(e,t[3]))}function L$(r,e){let t=iA(r);return!!(Td(e,t[0],!1)||Td(e,t[1],!1)||Td(e,t[2],!1)||Td(e,t[3],!1)||Td(e,t[0],!0)||Td(e,t[1],!0)||Td(e,t[2],!0)||Td(e,t[3],!0))}function O$(r,e){let t=iA(r);return!!(Fp(e,t[0],!1)||Fp(e,t[1],!1)||Fp(e,t[2],!1)||Fp(e,t[3],!1)||Fp(e,t[0],!0)||Fp(e,t[1],!0)||Fp(e,t[2],!0)||Fp(e,t[3],!0))}function P$(r,e){return r.left<=e.left&&r.right>=e.right&&r.top<=e.top&&r.bottom>=e.bottom}function _$(r,e){return r.left<=e.x&&e.x<=r.right&&r.top<=e.y&&e.y<=r.bottom}function oE(r,e){if(!e.extendStart){let t=r.left<=e.x1&&e.x1<=r.right,i=r.top<=e.y1&&e.y1<=r.bottom;if(t&&i)return!0}return A$(r,e)}function NB(r,e){let t={x:e.x0,y:e.y0};return!!(_$(r,t)||O$(r,e))}function BB(r,e){let t={left:e.x-e.radius,right:e.x+e.radius,top:e.y-e.radius,bottom:e.y+e.radius};return!!(P$(r,t)||L$(r,e))}function F$(r,e){let t=r.x-e.center.x,i=r.y-e.center.y,n=Math.atan2(i,t),o=tg(t,i),s={x:o*Math.cos(n+e.angle),y:o*Math.sin(n+e.angle)};return Math.abs(s.x)<=e.width/2&&Math.abs(s.y)<=e.height/2}function KB(r,e){if(e.length<4)return!1;let t={x1:NaN,y1:NaN,x2:e[0],y2:e[1],extendStart:!1,extendEnd:!1};for(var i=2;i<e.length;i+=2)if(t.x1=t.x2,t.y1=t.y2,t.x2=e[i],t.y2=e[i+1],oE(r,t))return!0;return!1}function UB(r,e){var t=M$(e);for(let i of t)if(oE(r,i))return!0;return!!F$({x:r.left,y:r.top},e)}function R$(r,e,t){let i=e.x1-r.x,n=e.x2-r.x,o=e.y1-r.y,s=e.y2-r.y,a=r.radius,l=n-i,c=s-o,u=l*l+c*c,p=i*s-n*o,g=Math.sqrt(a*a*u-p*p);if(g<0)return;if(c>=0)var h=1;else var h=-1;let b=t?-1*h:1*h;return{x:r.x+(p*c+b*h*l*g)/u,y:r.y+(-p*l+b*Math.abs(c)*g)/u}}function N$(r,e){let t=r.y2-r.y1,i=r.x1-r.x2,n=e.y2-e.y1,o=e.x1-e.x2,s=t*r.x1+i*r.y1,a=n*e.x1+o*e.y1,l=t*o-n*i;if(l!==0)return{x:(o*s-i*a)/l,y:(t*a-n*s)/l}}function rA(r,e){let t=LB(e,r);return!(isNaN(t)||t<0&&!e.extendStart||t>1&&!e.extendEnd)}function B$(r,e){let{x:t,y:i}=Cf(e),{startAngle:n,deltaAngle:o}=tE(e),s=Math.atan2(r.y-i,r.x-t);return __dcg_shared_module_exports__['W'](s,n,o)}function Td(r,e,t){let i=R$(r,e,t);if(i!=null&&rA(i,e))return i}function Fp(r,e,t){let i=Td(Cf(r),e,!1)||PB,n=_B(t,FB(r,i),RB(e));if(n||(i=Td(Cf(r),e,!0)||PB,n=_B(t,FB(r,i),RB(e))),n&&B$(i,r))return i}var PB={x:NaN,y:NaN};function nE(r,e){let t=N$(r,e);if(t!=null&&rA(t,r)&&rA(t,e))return t}function _B(r,e,t){let i=e.x*t.y-e.y*t.x;return i>0&&r||i<0&&!r}function FB(r,e){let{x:t,y:i}=Cf(r),{deltaAngle:n}=tE(r);return n>0?{x:i-e.y,y:e.x-t}:{x:e.y-i,y:t-e.x}}function RB(r){return{x:r.x2-r.x1,y:r.y2-r.y1}}var Er=__dcg_shared_module_exports__['h'](X());var Wn=__dcg_shared_module_exports__['h'](X());ct();function sE(r){return O(r).find(':input:enabled, [tabindex="0"], a[href]').filter(":visible:not([aria-hidden=true]):not([aria-disabled=true])")}function HB(r){return function(t){if(Re(t)==pl&&r){let i=sE(r);if(i.length===0)return;let n=i.first(),o=i.last();t.shiftKey&&n.is(":focus")?(t.preventDefault(),o.trigger("focus")):(!t.shiftKey&&o.is(":focus")||document.activeElement&&!i.is(":focus"))&&(t.preventDefault(),n.trigger("focus"))}}}ct();function Md(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}var{IfElse:U$,Switch:H$}=Wn.Components,q$=500,Ts=5,nA=class extends Wn.Class{init(){this.latexKey=0,this.uuid=this.props.uuid()}template(){return Wn.createElement("div",{class:()=>({[this.getCustomClassName()]:!0,"dcg-tooltip-positioning-container":!0,"dcg-latex-tooltip-positioning-container":!!this.props.renderAsLatex,"dcg-tooltip-gravity-ne-se":this.props.gravity()==="ne"||this.props.gravity()==="se","dcg-tooltip-gravity-nw-sw":this.props.gravity()==="nw"||this.props.gravity()==="sw","dcg-tooltip-gravity-n-s":this.props.gravity()==="n"||this.props.gravity()==="s","dcg-tooltip-gravity-e-w":this.props.gravity()==="e"||this.props.gravity()==="w"}),style:()=>({top:`${this.props.hitAreaRect().top+(this.props.offset().top||0)}px`,left:`${this.props.hitAreaRect().left+(this.props.offset().left||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`})},Wn.createElement("div",{class:Wn.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},U$(()=>!!this.props.renderAsLatex,{true:()=>Wn.createElement("div",{role:Wn.const("tooltip"),id:this.const(this.uuid),class:()=>({"dcg-tooltip-message":!0,"dcg-latex":!0,"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck(),"dcg-tooltip-overflow":this.messageOverflows()}),style:()=>({"max-width":`${this.getMaxWidth()}px`}),didMount:e=>{this.tooltipMessage=e}},Wn.createElement(H$,{key:()=>this.latexKey},()=>this.props.renderAsLatex().view(this.props.tooltip()))),false:()=>Wn.createElement("div",{role:Wn.const("tooltip"),id:this.const(this.uuid),class:Wn.const("dcg-tooltip-message"),style:()=>({background:this.getBackgroundColor(),cursor:this.props.isStickyAndNotStuck()?"pointer":"default"})},this.props.tooltip)})),Wn.createElement("div",{class:()=>({"dcg-tooltip-arrow":!0,[this.getTooltipGravityClass()]:!0}),style:()=>this.props.renderAsLatex?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}))}getTooltipGravityClass(){switch(this.props.gravity()){case"n":case"ne":case"nw":return"dcg-tooltip-gravity-n";case"s":case"se":case"sw":return"dcg-tooltip-gravity-s";case"e":return"dcg-tooltip-gravity-e";case"w":return"dcg-tooltip-gravity-w"}}willUpdate(){this.latexKey++}getCustomClassName(){return this.props.class?this.props.class():""}messageOverflows(){return this.tooltipMessage&&this.tooltipMessage.getBoundingClientRect().width>=this.getMaxWidth()}getArrowWithBorderStyle(){let e=this.props.gravity(),t="10px",i=this.getBackgroundColor(),n="#bbb",o=this.props.isStickyAndNotStuck()?".95":"1",s="8px",a={width:s,height:s,border:`1px solid ${n}`,background:i,opacity:o};switch(e){case"s":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"});case"sw":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{top:"100%",right:t,"margin-top":"1px","border-right":"0","border-bottom":"0"});case"se":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{top:"100%",left:t,"margin-top":"1px","border-right":"0","border-bottom":"0"});case"n":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"});case"nw":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{bottom:"100%",right:t,"margin-bottom":"1px","border-left":"0","border-top":"0"});case"ne":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{bottom:"100%",left:t,"margin-bottom":"1px","border-left":"0","border-top":"0"});case"e":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"});case"w":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"});default:return e}}getSolidArrowStyle(){let e=this.props.gravity(),t=`${this.props.hitAreaRect().width/2}px`,i=this.getBackgroundColor(),n=`transparent transparent ${i} transparent`,o=`${i} transparent transparent transparent`,s=`transparent ${i} transparent transparent`,a=`transparent transparent transparent ${i}`,l=`-${Ts}px`;switch(e){case"s":return{top:"100%",left:"50%",border:`${Ts}px solid transparent`,"border-color":n,"margin-top":l,"margin-left":l};case"sw":return{top:"100%",right:t,border:`${Ts}px solid transparent`,"border-color":n,"margin-top":l,"margin-right":l};case"se":return{top:"100%",left:t,border:`${Ts}px solid transparent`,"border-color":n,"margin-top":l,"margin-left":l};case"n":return{bottom:"100%",left:"50%",border:`${Ts}px solid transparent`,"border-color":o,"margin-bottom":l,"margin-left":l};case"nw":return{bottom:"100%",right:t,border:`${Ts}px solid transparent`,"border-color":o,"margin-bottom":l,"margin-right":l};case"ne":return{bottom:"100%",left:t,border:`${Ts}px solid transparent`,"border-color":o,"margin-bottom":l,"margin-left":l};case"e":return{top:"50%",left:"100%",border:`${Ts}px solid transparent`,"border-color":s,"margin-left":`-${Ts}px`,"margin-top":l};case"w":return{top:"50%",right:"100%",border:`${Ts}px solid transparent`,"border-color":a,"margin-right":l,"margin-top":l};default:return e}}getBackgroundColor(){return this.props.renderAsLatex?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMaxWidth(){let t=this.props.gravity(),i=this.props.hitAreaRect().left+(this.props.offset().left||0),n=i+this.props.hitAreaRect().width,o=.5*this.props.hitAreaRect().width+i,s=5,a=window.innerWidth-5;switch(t){case"se":case"ne":case"e":return a-i;case"sw":case"nw":case"w":return n-s;case"s":case"n":return Math.min(a-o,o-s)*2;default:return t}}getMessageStyle(){let e=this.props.hitAreaRect(),t=this.props.gravity(),i=this.props.maxWidth();switch(t){case"s":return{top:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-top":`${Ts}px`,"text-align":"center"};case"sw":return{top:"100%",width:`${i}px`,right:"0","margin-top":`${Ts}px`,"text-align":"right"};case"se":return{top:"100%",width:`${i}px`,"margin-top":`${Ts}px`,"text-align":"left"};case"n":return{bottom:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-bottom":`${Ts}px`,"text-align":"center"};case"nw":return{bottom:"100%",right:"0",width:`${i}px`,"margin-bottom":`${Ts}px`,"text-align":"right"};case"ne":return{bottom:"100%",width:`${i}px`,"margin-bottom":`${Ts}px`,"text-align":"left"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-left":`${Ts}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-right":`${Ts}px`,"text-align":"right"};default:return t}}};function z$(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var Ke=class extends Wn.Class{init(){this.uuid=`dcg-tooltip-${Md()}`}template(){return Wn.createElement("div",{class:Wn.const("dcg-tooltip-hit-area-container"),handleevent:Wn.const("true"),didMount:e=>{this.isMounted=!0,this.hitAreaNode=e,this.setupEventListeners(this.hitAreaNode)},onTap:()=>{if(this.shouldStickOnTargetClick())if(this.isStuck)this.clearTimeouts(),this.hideTooltip();else{if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.stickTooltip()}else if(this.shouldShowOnTapstart()){if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.setUpHideOnExternalMousedown()}}},this.children)}shouldShowOnTapstart(){return this.props.showOnTapstart&&this.props.showOnTapstart()}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let e=this.hitAreaNode.getBoundingClientRect(),t=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:i,originalLeft:n}=this.wrapperRef,o=e.top-t.top,s=e.left-t.left;Math.abs(o-i)>3||Math.abs(s-n)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(e){if(this.props.disabled&&this.props.disabled())return;let t=this.props.delay?this.props.delay():q$;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(e,t)}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(e){O(e).on("tipsyshow",t=>{t.target===e&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",t=>{t.target!==e||this.isStuck||this.handleHideEvent()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){O(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,e=>{this.wrapperRef&&(O(e.target).closest(this.hitAreaNode).length||O(e.target).closest(this.wrapperRef.elt).length||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let e=this.hitAreaNode.getBoundingClientRect(),t=document.createElement("div");t.className="dcg-tooltip-mount-pt";let i=O(this.hitAreaNode).closest(".dcg-tap-container")[0],n=z$();(!!n&&O(this.hitAreaNode).closest(n).length>0&&O(n).closest(".dcg-tap-container").length>0?n:i).appendChild(t);let s=t.getBoundingClientRect(),a=e.left-s.left,l=e.top-s.top,c=Math.min(200,this.props.maxParentWidthOverflow?e.width+2*this.props.maxParentWidthOverflow():1/0),u={tooltip:this.props.tooltip,class:this.props.class,isStickyAndNotStuck:()=>this.shouldStickOnTargetClick()&&!this.isStuck,offset:()=>this.props.offset?this.props.offset():{},gravity:()=>this.props.gravity?this.props.gravity():"s",renderAsLatex:this.props.renderAsLatex,maxWidth:()=>c,hitAreaRect:()=>({top:l||0,left:a||0,width:e.width||0,height:e.height||0}),uuid:()=>this.uuid};this.setupEventListeners(t),O(t).on("dcg-tap",()=>{this.shouldStickOnTargetClick()&&this.stickTooltip()});let p=Wn.mountToNode(nA,t,u);O(document).on(`keydown.dcg-tooltip-${this.uuid}`,h=>{Re(h)===Do&&this.hideTooltip()});let g=()=>this.updateTooltip();window.addEventListener("scroll",g,!0),this.wrapperRef={elt:t,view:p,originalLeft:a,originalTop:l,onScroll:g},this.assignAriaDescribedBy()}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,O(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),this.restoreAriaDescribedBy(),Wn.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}assignAriaDescribedBy(){let e=sE(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy=e.getAttribute("aria-describedby"),e.setAttribute("aria-describedby",this.uuid)}restoreAriaDescribedBy(){let e=sE(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy?e.setAttribute("aria-describedby",this.originalDescribedBy):e.removeAttribute("aria-describedby")}shouldStickOnTargetClick(){return!!this.props.sticky&&this.props.sticky()}};var Eu=__dcg_shared_module_exports__['h'](X());var aE=class extends Eu.Class{template(){return Eu.createElement("div",{class:Eu.const("dcg-dot-dot-dropdown")},Eu.createElement("span",null),Eu.createElement("span",null),Eu.createElement("span",null))}};var Wa=__dcg_shared_module_exports__['h'](X());var Df=class extends Wa.Class{template(){return Wa.createElement("span",{class:Wa.const("dcg-navigate-back"),onTap:this.props.onBack,"aria-label":this.props.ariaLabel,role:Wa.const("button"),tabindex:Wa.const("0"),handleEvent:Wa.const("true"),manageFocus:this.const(Vt({controller:this.props.controller(),location:{type:"geo-header-back-link"}}))},Wa.createElement("i",{class:Wa.const("dcg-icon-chevron-left"),"aria-hidden":Wa.const("true")}),Wa.createElement("div",{class:Wa.const("dcg-navigate-back-message")},this.props.message))}};var{If:$$,Switch:W$}=Er.Components,lE=class extends Er.Class{init(){this.controller=this.props.controller(),this.focusOrder=[{type:"geo-header-back-link"},{type:"multi-select-delete-icon"},{type:"multi-select-show-hide-icon"},{type:"multi-select-transformations-icon"},{type:"multi-select-more-icon"}]}template(){return Er.createElement("div",{class:Er.const("dcg-multi-select-header dcg-animate-in-after-initial-load"),onKeydown:this.bindFn(this.handleKeydown),onTapStart:this.bindFn(this.clearSelection),role:Er.const("toolbar"),"aria-label":this.bindFn(this.getSelectedCountString)},Er.createElement(Df,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-geometry-deselect-all"),controller:this.props.controller,message:this.bindFn(this.getSelectedCountString),onBack:this.bindFn(this.onDone)}),Er.createElement(Ke,{tooltip:this.bindFn(this.getDeleteItemString)},Er.createElement("span",{"aria-label":this.bindFn(this.getDeleteItemString),role:Er.const("button"),tabindex:Er.const("-1"),handleEvent:Er.const("true"),class:Er.const("dcg-multi-select-icon-button dcg-delete-btn"),onTap:this.bindFn(this.deleteSelected),manageFocus:this.const(Vt({controller:this.controller,location:{type:"multi-select-delete-icon"}}))},Er.createElement("i",{class:Er.const("dcg-icon-trashcan"),"aria-hidden":Er.const("true")}))),Er.createElement(W$,{key:this.bindFn(this.getSelectedItemsKey)},()=>Er.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-show-hide-btn":!0,"dcg-any-visible-objects":this.anyVisible()}),handleEvent:Er.const("true"),tabindex:Er.const("-1"),role:Er.const("button"),onTap:this.bindFn(this.toggleItemsVisible),manageFocus:this.const(Vt({controller:this.controller,location:{type:"multi-select-show-hide-icon"}}))},Er.createElement("div",{"aria-hidden":()=>!this.anyVisible()},()=>this.controller.s("graphing-calculator-text-geometry-hide-objects",{count:new uo(this.getSelectedCount())})),Er.createElement("div",{"aria-hidden":this.bindFn(this.anyVisible)},()=>this.controller.s("graphing-calculator-text-geometry-show-objects",{count:new uo(this.getSelectedCount())})))),Er.createElement($$,{predicate:()=>this.controller.isSomeTransformToolVisible()},()=>Er.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-transformations-button":!0,"dcg-transformations-open":this.isTransformationsMenuOpen()}),handleEvent:Er.const("true"),tabindex:Er.const("-1"),role:Er.const("button"),"dcg-open-menu-guid":()=>ww(),onTap:this.bindFn(this.toggleTransformationsMenu),manageFocus:this.const(Vt({controller:this.controller,location:{type:"multi-select-transformations-icon"}}))},this.bindFn(this.getTransformationsString),Er.createElement("i",{class:Er.const("dcg-icon-caret-down"),"aria-hidden":Er.const("true")}))),Er.createElement(Ke,{tooltip:this.bindFn(this.getMoreString)},Er.createElement("span",{"aria-label":this.bindFn(this.getMoreString),role:Er.const("button"),tabindex:Er.const("-1"),handleEvent:Er.const("true"),"aria-expanded":this.bindFn(this.isMoreMenuOpen),class:Er.const("dcg-multi-select-icon-button dcg-more-options"),"dcg-open-menu-guid":()=>rg(),manageFocus:this.const(Vt({controller:this.controller,location:{type:"multi-select-more-icon"}})),onTap:this.bindFn(this.toggleMoreMenu)},Er.createElement(aE,null))))}handleKeydown(e){let t=Re(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let n=__dcg_shared_module_exports__['z'](this.focusOrder,i);if(n===-1)return;e.preventDefault(),e.stopPropagation();let o=n;t==="Left"?o=Math.max(0,n-1):t==="Right"?o=Math.min(this.focusOrder.length-1,n+1):t==="Home"?o=0:t==="End"&&(o=this.focusOrder.length-1),o!==n&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[o]})}getSelectedCountString(){return this.controller.getGrapherDimensions().width<450?"":this.controller.s("graphing-calculator-text-geometry-selected-objects",{count:new uo(this.getSelectedCount())})}getDeleteItemString(){return this.controller.s("graphing-calculator-text-geometry-delete-selected-objects",{count:new uo(this.getSelectedCount())})}getMoreString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-more-dropdown")}getTransformationsString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-transform")}getSelectedItemsKey(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['r'](e,"id").join("-")}clearSelection(e){e.wasHandled()||this.onDone()}toggleItemsVisible(){this.anyVisible()?this.hideSelected():this.showSelected()}anyVisible(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['p'](e,t=>!Ba(t))}isFolderMenuOpen(){return this.controller.isItemSettingsMenuOpen(j$())}isMoreMenuOpen(){return this.controller.isItemSettingsMenuOpen(rg())}isTransformationsMenuOpen(){return this.controller.isItemSettingsMenuOpen(ww())}toggleMoreMenu(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:rg(),focusFirstOption:e.device==="keyboard"}})}toggleTransformationsMenu(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-transformations",guid:ww(),focusFirstOption:e.device==="keyboard"}})}getSelectedCount(){return this.controller.getAllSelectedItems().length}hideSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!1}})}showSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!0}})}onDone(){this.controller.dispatch({type:"set-none-selected"})}deleteSelected(){this.controller.dispatch({type:"delete-all-selected-items"})}};function j$(){return"**multi-select-folder**"}function rg(){return"**multi-select-more**"}function ww(){return"**multi-select-transformations**"}var ig=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-box-selection-display-name";this.toolType="selection";this.icon=[{type:"stroked-path",color:"#aaa",path:[35,35,51,35,51,51,35,51,35,35]},{type:"filled-polygon",color:"#000",path:[50,50,63.5,62,58.25,62.75,62,72.5,59.75,74,55.25,64.25,50.75,68,50,50]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['sb'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['nb']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}tryCommitResults(){return{committed:void 0}}shouldExpandLists(){return!1}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}shouldShowTransformationPreview(){return!1}};function qB(r,e){return r===void 0?e===void 0:!(e===void 0||r.calcId!==e.calcId||r.listIndex!==e.listIndex||r.polygonEdge!==e.polygonEdge)}var cE=class{constructor(e){this.poiController=e,this.controller=e.controller,this.grapher=e.manager}getKeyboardAttention(){return this.objectUnderAttention}setKeyboardAttention(e){this.objectUnderAttention=e}findNonGeometryTabTargetsInGraph(){let e=this.grapher.imageLayer.getOrderedTabTargets(),t=this.grapher.clickableObjectsLayer.getOrderedTabTargets(),i=this.grapher.movablePointsLayer.getOrderedTabTargets();return e.concat(t).concat(i)}findTabbableObjectsForCurrentTool(e){let t=e==null?void 0:e.calcId,i={};this.controller.isGeometry()&&this.controller.getGeoModel().getAllChoosableDefsUnordered({mode:"tab"}).forEach(p=>{var h;i[p.calcId]||(i[p.calcId]=[]);let g={calcId:p.calcId,listIndex:p.listIndex,polygonEdge:(h=p.polygonEdgeInfo)==null?void 0:h.edgeNumber};i[p.calcId].push(g)});let n=this.controller.getGeoModel().getCurrentTool();(!this.controller.isGeometry()||n.isValidNextInputType(__dcg_shared_module_exports__['Pa']))&&this.findNonGeometryTabTargetsInGraph().filter(u=>!(n instanceof ig&&this.controller.isClickableId(u.calcId))).forEach(u=>{var g;let p=(g=u.listIndex)!=null?g:0;if(!i[u.calcId])i[u.calcId]=[];else if(p&&!(!this.controller.isGeometry()||n.shouldExpandLists()))return;i[u.calcId][p]?i[u.calcId][p].description=u.description:i[u.calcId].push(u)});let o=[],s=-1,a=!1,l=this.grapher.getSketchOrder();for(let c=l.length-1;c>=0;c--){let u=l[c];u===t&&(s=o.length);let p=i[u];if(p){p.sort((g,h)=>g.listIndex!==h.listIndex?g.listIndex===void 0?-1:h.listIndex===void 0?1:g.listIndex-h.listIndex:g.polygonEdge!==h.polygonEdge?g.polygonEdge===void 0?-1:h.polygonEdge===void 0?1:g.polygonEdge-h.polygonEdge:0);for(let g of p)u===t&&(a||(s=o.length),qB(g,e)&&(a=!0)),o.push(g)}}return{targets:o,currentTabIndex:s,currentIsTabbable:a}}findNextObjFromKeyboard(e,t){let{targets:i,currentIsTabbable:n,currentTabIndex:o}=this.findTabbableObjectsForCurrentTool(t);if(!i.length)return;if(o===-1)return e==="next"?{wrapped:!1,target:i[0]}:{wrapped:!1,target:i[i.length-1]};let s=!1,a=o;return e==="prev"?a-=1:n&&(a+=1),a===-1?(s=!0,a=i.length-1):a>=i.length&&(s=!0,a=0),{wrapped:s,target:i[a]}}focusNextObjFromKeyboard(e={}){let t={allowWrapping:!0,selectNonClickables:!1,direction:"next"},{direction:i,allowWrapping:n,selectNonClickables:o}=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),e),s=this.findNextObjFromKeyboard(i,this.getKeyboardAttention());return!s||!n&&s.wrapped?(o&&this.controller.dispatch({type:"set-none-selected"}),!1):(s.wrapped&&this.controller.isVirtualMouseAllowed()?this.resetBackToGeoKeyboardPt():(o&&(this.controller.isClickableId(s.target.calcId)||!this.controller.isGeoItem(s.target.calcId)?this.controller.dispatch({type:"set-none-selected"}):this.controller.dispatch({type:"set-selected-id",id:s.target.calcId})),this.updateKeyboardAttention(s.target,{describe:!0})),!0)}updateKeyboardAttention(e,t){let i=this.getKeyboardAttention();qB(e,i)||(this.setKeyboardAttention(e),this.poiController.moveGeoKeyboardPtToFocusedItem(t),t.describe&&this.poiController.describeFocusedItem({includeDetails:!0}))}clearAttentionIfNotTabbable(){let{currentIsTabbable:e}=this.findTabbableObjectsForCurrentTool(this.getKeyboardAttention());e||this.updateKeyboardAttention(void 0,{describe:!1})}handleGrapherGainedFocus(){if(this.controller.getGeoModel().speakCurrentGeoToolHint(),this.controller.isVirtualMouseAllowed())this.resetBackToGeoKeyboardPt();else{let t=this.findTabbableObjectsForCurrentTool(void 0).targets;t.length?(this.setKeyboardAttention(void 0),this.updateKeyboardAttention(t[0],{describe:!0})):xe(this.controller.s("graphing-calculator-narration-geometry-no-tool-inputs"))}}resetBackToGeoKeyboardPt(){this.updateKeyboardAttention(void 0,{describe:!0}),this.poiController.geoKeyboardPt.x=this.poiController.geoKeyboardPt.lastArrowedX,this.poiController.geoKeyboardPt.y=this.poiController.geoKeyboardPt.lastArrowedY,this.poiController.handleGeoKeyboardPtMove()}};function oA(r,e){if(r.indexOf("\\idref_{")===0){let t=r.indexOf("}"),i=r.slice(8,t);return e(i)+r.slice(t+1)}else return r}function sA(r,e,t){let i=s=>t?s.map(a=>oA(a,t)):s;switch(r.type){case"point-reference":return{latex:`${r.id}=${r.parents[0]}`,color:r.color};case"point":var{x:n,y:o}=r;return{latex:r.id+"=\\left("+__dcg_shared_module_exports__['kc'](n)+","+__dcg_shared_module_exports__['kc'](o)+"\\right)",color:r.color};case"glider":return{latex:r.id+"=\\operatorname{glider}\\left("+i(r.parents)[0]+","+__dcg_shared_module_exports__['kc'](r.t)+"\\right)",color:r.color};case"polygon":{let c="";return!e&&r.connectBorder&&(c=","+r.parents[0]),{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+c+"\\right)",color:r.color}}case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"parallel":case"perpendicular":case"intersection":case"midpoint":case"vector":return{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"translate":case"reflect":case"dilate":case"rotate":{let c=r.type==="dilate"||r.type==="rotate"?[...i([r.parents[0]]),r.parents[1]]:i(r.parents);return{latex:`${r.id}\\left(x\\right)=\\operatorname{${r.type}}\\left(x,${c.join(",")}\\right)`,color:r.color}}case"angle":case"directedangle":return{showAngleLabel:!0,latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"angles":case"directedangles":return{showAngleLabel:e,latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":""),color:r.color};case"polygon-segment":return{latex:r.id+"="+i(r.parents)[0]+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":"")+".\\operatorname{segments}\\left["+(r.edgeNumber+1)+"\\right]",color:r.color};case"slider":return{latex:r.latex,color:r.color,sliderInfo:r.sliderInfo};case"transformed-object":return;case"expression-edit-preview-latex":if(r.rhsLatex==="")return;let s="\\operatorname{angle}\\left(";return{showAngleLabel:r.rhsLatex.trim().startsWith(s),latex:r.id+"="+r.rhsLatex,color:r.color};default:return r}}function aA(r,e){__dcg_shared_module_exports__['vb'](r.valueType)?r.value.forEach((t,i)=>{e({valueType:__dcg_shared_module_exports__['wb'](r.valueType),value:t},i+1)}):e(r,void 0)}function ng(r,e){let{controller:t,expandLists:i=!0}=r;t.getAllItemModels().concat(t.getAllToolPreviewItems()).forEach(o=>{var p;if(!xp(o))return;let s=o.formula.typed_constant_value,a=o.formula.geometry,l=a.identifier,c=l?__dcg_shared_module_exports__['Ib'](l):"\\idref_{"+o.id+"}",u=!t.getItemModel(o.id);i?aA(s,(g,h)=>{var D;let b=c+(h===void 0?"":"\\left["+h+"\\right]"),C={calcId:o.id,data:a,hidden:!o.shouldGraph,isGraphable:(D=o.formula)==null?void 0:D.is_graphable,assignment:c,listIndex:h!==void 0?h-1:void 0,typedRuntimeValue:g,referenceLatex:b};e(C,u)}):e({calcId:o.id,data:a,hidden:!o.shouldGraph,isGraphable:(p=o.formula)==null?void 0:p.is_graphable,assignment:c,listIndex:void 0,typedRuntimeValue:s,referenceLatex:c},u)})}function J$(r,e){switch(r.valueType){case __dcg_shared_module_exports__['Va']:return{valueType:__dcg_shared_module_exports__['Ra'],value:r.value[e]};case __dcg_shared_module_exports__['cb']:return{valueType:__dcg_shared_module_exports__['bb'],value:r.value[e]};case __dcg_shared_module_exports__['ab']:return{valueType:__dcg_shared_module_exports__['$a'],value:r.value[e]};case __dcg_shared_module_exports__['ib']:return{valueType:__dcg_shared_module_exports__['hb'],value:r.value[e]};case __dcg_shared_module_exports__['qb']:return{valueType:__dcg_shared_module_exports__['pb'],value:r.value[e]};case __dcg_shared_module_exports__['gb']:return{valueType:__dcg_shared_module_exports__['fb'],value:r.value[e]};case __dcg_shared_module_exports__['_a']:return{valueType:__dcg_shared_module_exports__['Za'],value:r.value[e]};case __dcg_shared_module_exports__['eb']:return{valueType:__dcg_shared_module_exports__['db'],value:r.value[e]};case __dcg_shared_module_exports__['kb']:return{valueType:__dcg_shared_module_exports__['jb'],value:r.value[e]};case __dcg_shared_module_exports__['mb']:return{valueType:__dcg_shared_module_exports__['lb'],value:r.value[e]};case __dcg_shared_module_exports__['Xa']:case __dcg_shared_module_exports__['Ta']:case __dcg_shared_module_exports__['Sa']:case __dcg_shared_module_exports__['ob']:case __dcg_shared_module_exports__['Ua']:case __dcg_shared_module_exports__['Ya']:case __dcg_shared_module_exports__['Wa']:throw new Error("Programming Error: unexpected type "+__dcg_shared_module_exports__['ub'](r.valueType));default:throw r.valueType,new Error("Programming Error: expected a list type but found "+__dcg_shared_module_exports__['ub'](r.valueType))}}function lA(r,e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{referenceLatex:r.assignment+"\\left["+e+"\\right]",typedRuntimeValue:J$(r.typedRuntimeValue,e),listIndex:e})}function cA(r){switch(r){case __dcg_shared_module_exports__['Ra']:return"Point";case __dcg_shared_module_exports__['bb']:return"Circle";case __dcg_shared_module_exports__['db']:return"Arc";case __dcg_shared_module_exports__['Za']:return"Polygon";case __dcg_shared_module_exports__['fb']:return"Line";case __dcg_shared_module_exports__['$a']:return"Segment";case __dcg_shared_module_exports__['hb']:return"Ray";case __dcg_shared_module_exports__['pb']:return"Vector";case __dcg_shared_module_exports__['jb']:return"Angle";case __dcg_shared_module_exports__['lb']:return"Angle"}}function zB(r){if(!r)return;let e=r.typedRuntimeValue;return cA(e.valueType)}var Pi=class{constructor(e){this.model=e;this.s=e.s}createOutput(){return this.model.createCustomToolOutput(this.getSpec())}clearTentativeOutputs(){let e=this.getSpec();var t={},i=this.model.getNonObjectsState().ui.currentTool.idMap;for(let n in i){let o=i[n];!this.model.isObjectALockedToolInput(o)&&this.model.isObjectUncommitted(o)&&(t[n]=o)}this.model.deleteObjectsAndRememberReusableId(t),this.model.tentativelyMatchToolInput(e,""),this.createOutput()}shouldReferenceSpecificItemInList(e,t){return!t}getExpandedReferenceForDef(e,t){return this.shouldReferenceSpecificItemInList(e,t)?e.referenceLatex:e.assignment}getListIndexForHover(e,t){if(this.shouldReferenceSpecificItemInList(e,t))return e.listIndex}_getOrCreatePoint(e,t,i){var c,u;let n=this.model.getOrCreatePointNearMouse(e,i);if(n.type==="def")return{createdNew:!1,def:n.def,reference:this.getExpandedReferenceForDef(n.def,t),previewOnly:!1};let o=this.createPointDefinition(n.spec,t),s=n.spec.type==="point-reference"?n.spec.targetSpec.parentDefs:n.spec.parentDefs,a=0;for(let p=0;p<s.length;p++){let g=s[p];if(g.polygonEdgeInfo){let h=this.model.createToolInputDependency({type:"polygon-segment",parents:[(c=g.polygonEdgeInfo)==null?void 0:c.polygonDef.referenceLatex],edgeNumber:((u=g.polygonEdgeInfo)==null?void 0:u.edgeNumber)||0},this.getSpec(),a);o.parents[p]=h,a+=1,this.model.setObjectHovered({tokenId:h,listIndex:void 0})}else this.model.setObjectHovered({calcId:g.calcId,listIndex:this.getListIndexForHover(g,t)})}return{createdNew:!0,def:void 0,reference:this.model._createInputObject(o),previewOnly:o.type==="point"&&o.previewOnly}}_isReadyToCommit(){return this.model.getNonObjectsState().ui.currentTool.inputIndex>=this.getSpec().inputs.length}_getFirstMissingInput(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool;return this.getSpec().inputs[e]}canNextInputBePoint(){let e=this._getFirstMissingInput();return e&&e.type==="point"?!0:!!(e&&e.type==="union"&&e.valueTypes.indexOf(__dcg_shared_module_exports__['Ra'])!==-1)}getNonPointInputType(){let e=this._getFirstMissingInput();if(!(!e||e.type==="point"))return e.type==="union"?e:e.type}isValidNextInputType(e){if(this.canNextInputBePoint()&&__dcg_shared_module_exports__['yb'](e,__dcg_shared_module_exports__['Ra']))return!0;let t=this._getFirstMissingInput();if(!t)return!1;let i=[];if(t.type==="union")i=t.valueTypes;else{let n=t.type;switch(n){case"point":i=[__dcg_shared_module_exports__['Ra']];break;case"straight":i=[__dcg_shared_module_exports__['fb'],__dcg_shared_module_exports__['hb'],__dcg_shared_module_exports__['$a'],__dcg_shared_module_exports__['pb']];break;case"angle":i=[__dcg_shared_module_exports__['jb'],__dcg_shared_module_exports__['lb']];break;case"arc":i=[__dcg_shared_module_exports__['db']];break;case"circle":i=[__dcg_shared_module_exports__['bb']];break;case"polygon":i=[__dcg_shared_module_exports__['Za']];break;case"segment":i=[__dcg_shared_module_exports__['$a']];break;case"number":i=[__dcg_shared_module_exports__['Qa']];break;case"vector":i=[__dcg_shared_module_exports__['pb']];break;default:return n}}return i.some(n=>__dcg_shared_module_exports__['yb'](e,n))}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['sb'].filter(e=>this.isValidNextInputType(e))}getHint(){let e=this._getFirstMissingInput();return e?e.hint!==void 0?this.s(e.hint):this.s("graphing-calculator-text-geometry-select-hint",{type:e.type}):""}tryCommitResults(){if(this.model.attemptLockToolInputIn(this.getSpec()),this._isReadyToCommit()){let e=this.model.getUncommittedObjects();for(let i in e)e[i].type==="expression-edit-preview-latex"&&delete e[i];let t=__dcg_shared_module_exports__['a']({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:e,toolIdToLatex:t}}return{committed:void 0}}onMove(e){var o,s;this.clearTentativeOutputs();let t=this.canNextInputBePoint(),i=this.getNonPointInputType(),n=!1;if(t||i){if(i){let a=this.model.getObjectDefUnderMouse(e.pt,e.tolerance);if(a&&this.model.objectIsInstanceOf(a,i))if(a.polygonEdgeInfo){let l=this.model.createToolInputDependency({type:"polygon-segment",parents:[(o=a.polygonEdgeInfo)==null?void 0:o.polygonDef.referenceLatex],edgeNumber:((s=a.polygonEdgeInfo)==null?void 0:s.edgeNumber)||0},this.getSpec(),0);this.model.setObjectHovered({tokenId:l,listIndex:void 0});let c=l;this.model.tentativelyMatchToolInput(this.getSpec(),c),n=!0}else{let l=this.getExpandedReferenceForDef(a,e.shift);this.model.setObjectHovered({calcId:a.calcId,listIndex:this.getListIndexForHover(a,e.shift)}),this.model.tentativelyMatchToolInput(this.getSpec(),l),n=!0}}if(!n&&t){let a=this._getOrCreatePoint(e.pt,e.shift,e.tolerance);n=!a.previewOnly,a!=null&&a.def&&!a.createdNew&&!a.previewOnly&&this.model.setObjectHovered({calcId:a.def.calcId,listIndex:this.getListIndexForHover(a.def,e.shift)}),this.toolType!=="custom"&&!!this.model.getNonObjectsState().ui.currentTool.lockedIds[a.reference]||this.model.tentativelyMatchToolInput(this.getSpec(),a.reference)}}return this.createOutput(),n}getNumberInputLatex(){let e=this.getSpec(),{idMap:t,inputIndex:i}=this.model.getNonObjectsState().ui.currentTool,n=e.inputs[i];return n&&n.type==="number"&&t[n.id]||""}onNumberInput(e){this.clearTentativeOutputs(),this.model.tentativelyMatchToolInput(this.getSpec(),e),this.createOutput()}createPointDefinition(e,t){let i=e.parentDefs,n;switch(e.type){case"point-reference":{n={type:"point-reference",parents:[this.getExpandedReferenceForDef(i[0],t)]};break}default:{let o=i.map(s=>this.getExpandedReferenceForDef(s,t));n=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{parents:o})}}return n}shouldExpandLists(){return!0}shouldUseJitEdges(){return!0}shouldHighlightRelevantObjects(){return!0}shouldShowTransformationPreview(){return!1}};function dE(r,e){if(typeof e=="object")return e.valueTypes.some(t=>__dcg_shared_module_exports__['yb'](r,t));switch(e){case"point":return r===__dcg_shared_module_exports__['Ra'];case"straight":return r===__dcg_shared_module_exports__['fb']||r===__dcg_shared_module_exports__['hb']||r===__dcg_shared_module_exports__['$a']||r===__dcg_shared_module_exports__['pb'];case"angle":return r===__dcg_shared_module_exports__['jb']||r===__dcg_shared_module_exports__['lb'];case"arc":return r===__dcg_shared_module_exports__['db'];case"circle":return r===__dcg_shared_module_exports__['bb'];case"polygon":return r===__dcg_shared_module_exports__['Za'];case"segment":return r===__dcg_shared_module_exports__['$a'];case"vector":return r===__dcg_shared_module_exports__['pb'];case"number":return r===__dcg_shared_module_exports__['Qa'];default:return e}}function Rp(r){let e=r[1][0],t=r[1][1],i=r[1][0]+r[0][0],n=r[1][1]+r[0][1];return[[e,t],[i,n]]}function Sf(r){let e=r.formula.geometry&&r.formula.geometry.call;return!e||!e.parents?[]:e.parents.map(t=>t===void 0?"":t[0])}function ku(r,e={}){let t=r.formula.typed_constant_value.value,i=r.formula.typed_constant_value.valueType;return e.listIndex!==void 0&&__dcg_shared_module_exports__['vb'](i)&&(i=__dcg_shared_module_exports__['wb'](i),t=t[e.listIndex]),{value:t,valueType:i}}function $B(r,e,t){var h,b,C,D,S,V;let i,n=[],o=(h=r.formula.geometry.call)==null?void 0:h.symbol,s=((b=r.formula.assignment)==null?void 0:b[0])==="$",a=Sf(r),l=e.getGeoTokenInfoFromIdentifier(a[0]),c=e.getGeoTokenInfoFromIdentifier(a[1]),{value:u}=ku(r,t),p=u[0],g=u[1];switch(o){case"intersection":r.label?i=e.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:Vs(r.label)}):s?i=e.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:(C=r.formula.assignment)!=null?C:""}),t.includeDetails&&typeof p=="number"&&typeof g=="number"&&l!==void 0&&c!==void 0?n.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-and-intersection",{itemDescription:i,parent1:l.description,parent2:c.description,x:qi(e,p),y:zi(e,g)})):n.push(i);break;case"midpoint":r.label?i=e.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:Vs(r.label)}):s?i=e.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:(D=r.formula.assignment)!=null?D:""}),t.includeDetails&&typeof p=="number"&&typeof g=="number"&&l!==void 0?n.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-and-parent",{itemDescription:i,parent:l.description,x:qi(e,p),y:zi(e,g)})):n.push(i);break;case"glider":r.label!==void 0&&r.label!==""?i=e.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:Vs(r.label)}):s?i=e.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:(S=r.formula.assignment)!=null?S:""}),t.includeDetails&&typeof p=="number"&&typeof g=="number"?n.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:qi(e,p),y:zi(e,g)})):n.push(i);break;default:r.label!==void 0&&r.label!==""?i=e.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:Vs(r.label)}):s?i=e.s("graphing-calculator-narration-geometry-unlabeled-point",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:(V=r.formula.assignment)!=null?V:""}),t.includeDetails&&typeof p=="number"&&typeof g=="number"?n.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:qi(e,p),y:zi(e,g)})):n.push(i)}return n}function WB(r,e,t){var g,h,b,C;let i,n=[],o=((g=r.formula.assignment)==null?void 0:g[0])==="$",{value:s}=ku(r,t),a=(h=s[0])==null?void 0:h[0],l=(b=s[0])==null?void 0:b[1],c=s[1],u=e.get2dProjection(),p=u&&u.viewport;return o?i=e.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-circle-with-assignment",{assignment:(C=r.formula.assignment)!=null?C:""}),t.includeDetails&&p&&typeof a=="number"&&typeof l=="number"&&typeof c=="number"?n.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-with-radius",{itemDescription:i,x:qi(e,a),y:zi(e,l),radius:Hs(__dcg_shared_module_exports__['Cb'](c,p.xmax-p.xmin).latex)})):n.push(i),n}function jB(r,e,t){var h,b,C,D,S,V,k,T;let i="",n=[],o=((h=r.formula.assignment)==null?void 0:h[0])==="$",{value:s}=ku(r,t);o?i=e.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-arc-with-assignment",{assignment:(b=r.formula.assignment)!=null?b:""});let a=(C=s[0])==null?void 0:C[0],l=(D=s[0])==null?void 0:D[1],c=(S=s[1])==null?void 0:S[0],u=(V=s[1])==null?void 0:V[1],p=(k=s[2])==null?void 0:k[0],g=(T=s[2])==null?void 0:T[1];return t.includeDetails&&typeof a=="number"&&typeof l=="number"&&typeof c=="number"&&typeof u=="number"&&typeof p=="number"&&typeof g=="number"?n.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-with-middle-and-end",{itemDescription:i,x1:qi(e,a),y1:zi(e,l),x2:qi(e,c),y2:zi(e,u),x3:qi(e,p),y3:zi(e,g)})):n.push(i),n}function JB(r,e,t){var g,h,b,C,D,S,V,k;let{value:i}=ku(r,t),n=i.length;if(t.polygonEdge!==void 0)if(t.polygonEdge>=0&&t.polygonEdge<i.length){let T=i[t.polygonEdge],A=i[(t.polygonEdge+1)%i.length];i=[T,A]}else return[e.s("shared-calculator-narration-item-unknown")];let o,s=[],a=((g=r.formula.assignment)==null?void 0:g[0])==="$",l=(h=i[0])==null?void 0:h[0],c=(b=i[0])==null?void 0:b[1],u=(C=i[1])==null?void 0:C[0],p=(D=i[1])==null?void 0:D[1];return n===3?a?o=e.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:r.id}):o=e.s("graphing-calculator-narration-geometry-triangle-with-assignment",{assignment:(S=r.formula.assignment)!=null?S:""}):n===4?a?o=e.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:r.id}):o=e.s("graphing-calculator-narration-geometry-quadrilateral-with-assignment",{assignment:(V=r.formula.assignment)!=null?V:""}):a?o=e.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:r.id,sideCount:n}):o=e.s("graphing-calculator-narration-geometry-polygon-with-assignment",{assignment:(k=r.formula.assignment)!=null?k:"",sideCount:n}),t.polygonEdge!==void 0?t.includeDetails&&typeof l=="number"&&typeof c=="number"&&typeof u=="number"&&typeof p=="number"?s.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:o,x1:qi(e,l),y1:zi(e,c),x2:qi(e,u),y2:zi(e,p)})):s.push(o):t.includeDetails&&typeof l=="number"&&typeof c=="number"?s.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:o,x:qi(e,l),y:zi(e,c)})):s.push(o),s}function YB(r,e,t){var D,S,V,k,T,A,R,P,W,H,j,ne;let i="",n=[],o=(D=r.formula.geometry.call)==null?void 0:D.symbol,s=((S=r.formula.assignment)==null?void 0:S[0])==="$",a=Sf(r),l=e.getGeoTokenInfoFromIdentifier(a[0]),c=e.getGeoTokenInfoFromIdentifier(a[1]),{value:u,valueType:p}=ku(r,t),g,h,b,C;return o==="vector"?[[g,h],[b,C]]=Rp(u):(g=(V=u[0])==null?void 0:V[0],h=(k=u[0])==null?void 0:k[1],b=(T=u[1])==null?void 0:T[0],C=(A=u[1])==null?void 0:A[1]),o==="parallel"?s?i=e.s("graphing-calculator-narration-geometry-unlabeled-parallel",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-parallel-with-assignment",{assignment:(R=r.formula.assignment)!=null?R:""}):o==="perpendicular"?s?i=e.s("graphing-calculator-narration-geometry-unlabeled-perpendicular",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-perpendicular-with-assignment",{assignment:(P=r.formula.assignment)!=null?P:""}):p===__dcg_shared_module_exports__['fb']?s?i=e.s("graphing-calculator-narration-geometry-unlabeled-line",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-line-with-assignment",{assignment:(W=r.formula.assignment)!=null?W:""}):p===__dcg_shared_module_exports__['hb']?s?i=e.s("graphing-calculator-narration-geometry-unlabeled-ray",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-ray-with-assignment",{assignment:(H=r.formula.assignment)!=null?H:""}):p===__dcg_shared_module_exports__['$a']?s?i=e.s("graphing-calculator-narration-geometry-unlabeled-segment",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:(j=r.formula.assignment)!=null?j:""}):p===__dcg_shared_module_exports__['pb']&&(s?i=e.s("graphing-calculator-narration-geometry-unlabeled-vector",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-vector-with-assignment",{assignment:(ne=r.formula.assignment)!=null?ne:""})),(o==="parallel"||o==="perpendicular")&&t.includeDetails&&typeof g=="number"&&typeof h=="number"&&typeof b=="number"&&typeof C=="number"&&l!==void 0&&c!==void 0?n.push(e.s("graphing-calculator-narration-geometry-item-to-line-passing-through-point-at-coordinates-to-coordinates",{itemDescription:i,parent1:l.description,parent2:c.description,x1:qi(e,g),y1:zi(e,h),x2:qi(e,b),y2:zi(e,C)})):t.includeDetails&&typeof g=="number"&&typeof h=="number"&&typeof b=="number"&&typeof C=="number"?n.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:i,x1:qi(e,g),y1:zi(e,h),x2:qi(e,b),y2:zi(e,C)})):n.push(i),n}function XB(r,e,t){var g,h,b,C;let i="",n=[],{value:o,valueType:s}=ku(r,t),a=(g=o[0])==null?void 0:g[0],l=(h=o[0])==null?void 0:h[1],c=(b=r.formula.assignment)!=null?b:"",u="",p=(C=e.getGrapher())==null?void 0:C.getGraphSketch(r.id);if(p&&"labels"in p){let D=p.labels;D.length>0&&"text"in D[0]&&(u=Vs(D[0].text))}if(s===__dcg_shared_module_exports__['jb']?/^\$/.test(c)?u!==""?i=e.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{measurementText:u}):i=e.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:r.id}):u!==""?i=e.s("graphing-calculator-narration-geometry-angle-with-measurement-and-assignment",{measurementText:u,assignment:c}):i=e.s("graphing-calculator-narration-geometry-angle-with-assignment",{assignment:c}):s===__dcg_shared_module_exports__['lb']&&(/^\$/.test(c)?u!==""?i=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{measurementText:u}):i=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:r.id}):u!==""?i=e.s("graphing-calculator-narration-geometry-directed-angle-with-measurement-and-assignment",{measurementText:u,assignment:c}):i=e.s("graphing-calculator-narration-geometry-directed-angle-with-assignment",{assignment:c})),t.includeDetails&&typeof a=="number"&&typeof l=="number"){let D=Sf(r),S=e.getGeoTokenInfoFromIdentifier(D[0]),V=e.getGeoTokenInfoFromIdentifier(D[1]),k=e.getGeoTokenInfoFromIdentifier(D[2]);S!==void 0&&V!==void 0&&k!==void 0?n.push(e.s("graphing-calculator-narration-geometry-angle-at-coordinates-through-points",{itemDescription:i,x1:qi(e,a),y1:zi(e,l),parent1:S.description,parent2:V.description,parent3:k.description})):S!==void 0?n.push(e.s("graphing-calculator-narration-geometry-angle-of-polygon-at-coordinates",{itemDescription:i,parent:S.description,x:qi(e,a),y:zi(e,l)})):n.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:qi(e,a),y:zi(e,l)}))}else n.push(i);return n}function QB(r,e,t){let{value:i,valueType:n}=ku(r,t),o=[],s=i.length;switch(__dcg_shared_module_exports__['wb'](n)){case __dcg_shared_module_exports__['Ra']:o.push(e.s("graphing-calculator-narration-geometry-list-of-points",{count:s}));break;case __dcg_shared_module_exports__['bb']:o.push(e.s("graphing-calculator-narration-geometry-list-of-circles",{count:s}));break;case __dcg_shared_module_exports__['db']:o.push(e.s("graphing-calculator-narration-geometry-list-of-arcs",{count:s}));break;case __dcg_shared_module_exports__['Za']:o.push(e.s("graphing-calculator-narration-geometry-list-of-polygons",{count:s}));break;case __dcg_shared_module_exports__['fb']:o.push(e.s("graphing-calculator-narration-geometry-list-of-lines",{count:s}));break;case __dcg_shared_module_exports__['hb']:o.push(e.s("graphing-calculator-narration-geometry-list-of-rays",{count:s}));break;case __dcg_shared_module_exports__['$a']:o.push(e.s("graphing-calculator-narration-geometry-list-of-segments",{count:s}));break;case __dcg_shared_module_exports__['jb']:o.push(e.s("graphing-calculator-narration-geometry-list-of-angles",{count:s}));break;case __dcg_shared_module_exports__['lb']:o.push(e.s("graphing-calculator-narration-geometry-list-of-directed-angles",{count:s}));break;default:o.push(e.s("graphing-calculator-narration-geometry-list-of-any",{count:s}));break}return o[0]=`${o[0]}.`,o}function $i(r,e){if(!r)return"";let{controller:t}=r;if(r.type==="expression"){let i=t.isItemSecret(r.id);switch(e){case"describe":return i?t.s("graphing-calculator-narration-describe-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-describe-expression",{index:r.displayIndex});case"delete":return i?t.s("graphing-calculator-narration-delete-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-delete-expression",{index:r.displayIndex});case"duplicate":return i?t.s("graphing-calculator-narration-duplicate-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-duplicate-expression",{index:r.displayIndex});case"show":return i?t.s("graphing-calculator-narration-show-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-show-expression",{index:r.displayIndex});case"hide":return i?t.s("graphing-calculator-narration-hide-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-hide-expression",{index:r.displayIndex});case"show-options":return i?t.s("graphing-calculator-narration-show-options-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-show-options-expression",{index:r.displayIndex});case"hide-options":return i?t.s("graphing-calculator-narration-hide-options-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-hide-options-expression",{index:r.displayIndex});case"create_table":return i?t.s("graphing-calculator-narration-create-table-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-create-table-expression",{index:r.displayIndex});case"rename":return i?t.s("graphing-calculator-narration-rename-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-rename-expression",{index:r.displayIndex})}}if(r.type==="image")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-image",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-image",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-image",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-image",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-image",{index:r.displayIndex});case"show-options":return t.s("graphing-calculator-narration-show-options-image",{index:r.displayIndex});case"hide-options":return t.s("graphing-calculator-narration-hide-options-image",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-image-title",{index:r.displayIndex})}if(r.type==="text")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-text",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-text",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-text",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-text",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-text",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-text-title",{index:r.displayIndex})}if(r.type==="table")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-table",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-table",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-table",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-table",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-table",{index:r.displayIndex});case"rename":return t.s("graphing-calculator-narration-rename-table",{index:r.displayIndex})}if(r.type==="folder"){let i=!!r.title;switch(e){case"describe":return i?t.s("graphing-calculator-narration-describe-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-describe-folder-index",{index:r.displayIndex});case"collapse":return i?t.s("graphing-calculator-narration-collapse-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-collapse-folder-index",{index:r.displayIndex});case"expand":return i?t.s("graphing-calculator-narration-expand-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-expand-folder-index",{index:r.displayIndex});case"show":return i?t.s("graphing-calculator-narration-show-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-show-folder-index",{index:r.displayIndex});case"hide":return i?t.s("graphing-calculator-narration-hide-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-hide-folder-index",{index:r.displayIndex});case"duplicate":return i?t.s("graphing-calculator-narration-duplicate-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-duplicate-folder-index",{index:r.displayIndex});case"delete":return i?t.s("graphing-calculator-narration-delete-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-delete-folder-index",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-folder-title",{index:r.displayIndex})}}switch(e){case"describe":return t.s("graphing-calculator-narration-describe");case"delete":return t.s("graphing-calculator-narration-delete");case"duplicate":return t.s("graphing-calculator-narration-duplicate");case"expand":return t.s("graphing-calculator-narration-expand");case"collapse":return t.s("graphing-calculator-narration-collapse");case"show":return t.s("graphing-calculator-narration-show");case"hide":return t.s("graphing-calculator-narration-hide");case"show-options":return t.s("graphing-calculator-narration-show-options");case"hide-options":return t.s("graphing-calculator-narration-hide-options");case"create_table":return t.s("graphing-calculator-narration-create-table");case"rename":return t.s("graphing-calculator-narration-rename");case"edit_title":return t.s("graphing-calculator-narration-edit-title");default:return e}}function xw(r,e,t={includeDetails:!0}){var o,s,a;if(!r)return e.s("graphing-calculator-narration-geometry-nothing-selected");let i=t.description?t.description:"";if(r.type!=="expression"){if(r.type==="image"){let l=i!==""?i:$i(r,"describe"),{x:c,y:u}=r.formula.dimensions;c&&u&&typeof c[0]=="number"&&typeof u[0]=="number"?i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:l,x:qi(e,c[0]),y:zi(e,u[0])}):i=l}}else(!r.latex||!((o=r.formula)!=null&&o.typed_constant_value))&&(i=i!==""?i:$i(r,"describe"));!i&&xp(r)?(i=Y$(r,e,t),i=Q$(i,r,e,t)):t.includeDetails&&t.poi&&!((a=(s=t.poi)==null?void 0:s.sketch)!=null&&a.showPOI)&&(i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:qi(e,t.poi.x),y:zi(e,t.poi.y)}));let n=i;return t.includeSelectionState&&!Ym(r)&&(n=Z$(n,r,e)),Ym(r)&&(n=e.s("shared-calculator-narration-item-clickable",{item:n})),n}function Y$(r,e,t={includeDetails:!0}){let i=r.formula.geometry&&r.formula.geometry.call,n=i&&i.symbol,o=Sf(r),{value:s,valueType:a}=ku(r,t);if(!s)return e.s("shared-calculator-narration-item-unknown");let l=[];if(__dcg_shared_module_exports__['vb'](a))l=QB(r,e,t);else switch(a){case __dcg_shared_module_exports__['Ra']:l=$B(r,e,t);break;case __dcg_shared_module_exports__['bb']:l=WB(r,e,t);break;case __dcg_shared_module_exports__['db']:l=jB(r,e,t);break;case __dcg_shared_module_exports__['Za']:l=JB(r,e,t);break;case __dcg_shared_module_exports__['fb']:case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['$a']:case __dcg_shared_module_exports__['pb']:l=YB(r,e,t);break;case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['lb']:l=XB(r,e,t);break;default:l.push(e.s("shared-calculator-narration-item-unknown"))}let c=l.join(" ");return n==="apply"&&typeof o[0]=="string"&&(c=X$(c,r,e)),c}function X$(r,e,t){let i="",n=Sf(e),o=t.getItemsByIdentifier(n[0]);for(let s of o){if(s.type!=="expression")continue;let a=s.formula.geometry;if(!(!a||!a.call)){i=a.call.symbol;break}}switch(i){case"dilate":return t.s("graphing-calculator-narration-geometry-dilated-item",{item:r});case"rotate":return t.s("graphing-calculator-narration-geometry-rotated-item",{item:r});case"translate":return t.s("graphing-calculator-narration-geometry-translated-item",{item:r});case"reflect":return t.s("graphing-calculator-narration-geometry-reflected-item",{item:r});default:return t.s("graphing-calculator-narration-geometry-transformed-item",{item:r})}}function Q$(r,e,t,i){var n,o;return i.listIndex!==void 0&&((o=(n=e.formula)==null?void 0:n.geometry)!=null&&o.valueType)&&__dcg_shared_module_exports__['vb'](e.formula.geometry.valueType)?t.s("graphing-calculator-narration-item-with-list-index",{listIndex:i.listIndex+1,item:r}):i.polygonEdge!==void 0?t.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:i.polygonEdge+1,item:r}):r}function Z$(r,e,t){return e&&ba(e)?t.s("shared-calculator-narration-item-selected",{item:r}):t.s("shared-calculator-narration-item-unselected",{item:r})}function uE(r){if(!r)return 0;if(r.type==="image"&&r.listIndex)return r.listIndex;if("poi"in r)return r.poi.pointIdxOnBranch;if("branchInfo"in r&&r.branchInfo.sketch){let e=r.branchInfo.branch,t=r.branchInfo.sketch.branches[e];return"listIndex"in t&&t.listIndex||0}return 0}var rW=0,Ad=class{constructor(e,t){this.geoKeyboardPt={x:NaN,y:NaN,lastArrowedX:NaN,lastArrowedY:NaN};this.grapherIsPressed=!1;this.canceledGeoToolplayWhilePressed=!1;this.manager=e,this.controller=e.controller,this.keyboardAttentionManager=new cE(this),this.graphSettings=t,this.elt=this.manager.elt,this.id=rW++,!(!this.graphSettings.config.graphpaper||this.graphSettings.config.disableMouseInteractions)&&(this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeydownEventHandler(),this.addManualUnhoverListener(),this.addGeoEventHandlers())}remove(){this.removeAllGlobalMouseListeners(),this.removeManualUnhoverListener(),this.removeAllGeoListeners(),this.removeHoverEventHandler()}addGlobalMouseListener(e,t){let i=e.split(" ");for(let n of i){let o=n+".dcg-poiController-"+this.id;O(document).on(o,t)}}removeAllGeoListeners(){O(document).off(".dcg-poiController-geo-"+this.id)}removeAllGlobalMouseListeners(){O(document).off(".dcg-poiController-"+this.id)}getToleranceByDevice(e){return e==="touch"?20:10}addGeoEventHandlers(){let e="keydown.dcg-poiController-geo-"+this.id,t="keyup.dcg-poiController-geo-"+this.id,i=e+" "+t;O(document).on(i,n=>{this.controller.isGeoToolActive()&&this.handleGeoShiftKeyChange(n.shiftKey)}),O(document).on("mouseleave.dcg-poiController-geo-"+this.id,()=>{if(this.controller.isGeoToolActive()&&!this.grapherIsPressed){let n=this.controller.getGeoModel();n.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),n.onPreviewChange()}}),O(document).on("dcg-tapend.dcg-poiController-geo-"+this.id,n=>{this.controller.isGeoToolActive()&&this.handleGeoTapEnd(n)})}removeHoverEventHandler(){O(document).off(".dcg-poiController-global-hover-"+this.id)}addHoverEventHandler(){let e="dcg-tapmove.dcg-poiController-global-hover-"+this.id;O(document).on(e,t=>{if(this.controller.isGeoToolActive()&&this.handleGeoTapMove(t)||t.device==="touch")return;let i=document.elementFromPoint(t.clientX,t.clientY),n=!!i&&!!O(i).closest(".dcg-grapher").length,o=this.manager.poiLabelsLayer,s=this.getMouseRelativeToGrapher(t),a=this.getToleranceByDevice(t.device),l;n&&(l=this.getFeatureUnderPoint(s,a));let c;if(l&&l.type==="movable-point"){let S=l.poi,V=S&&S.getMovablePoint();c=V&&V.id}let u,p=0;l&&l.isClickable&&!this.isBoxSelectActive(t)&&!this.manager.movablePointsLayer.isMovingPoint()&&!this.manager.traceLayer.isTracing()&&(u=l.model,p=uE(l));let g=this.manager.clickableObjectsLayer,h={};u&&(h[u.id]={listIndexes:p===void 0?void 0:{[p]:!0}}),g.setHoveredObjects(h);let b;l&&"poi"in l&&l.poi&&(!l.poi.isAttachedToPlottedPoint()||l.poi.hasInteractiveLabel())&&(b=l.poi),b!==o.getHoveredPOI()&&(this.controller.isTraceEnabled()?o.setHoveredPOI(b):o.setHoveredPOI(void 0),this.controller.requestRedrawGraph());let C=!1;if(l&&l.type==="image"){let S=Cd(l.model),V=l.isClickable;C=S&&!V}let D=!1;l&&l.type==="draggable-label"&&(D=!0),C||D?this.manager.setLayerClass("extraMoveCursor","dcg-mouse-over-movable-point"):this.manager.setLayerClass("extraMoveCursor",""),this.manager.movablePointsLayer.setHoveredPointId(c)})}addManualUnhoverListener(){let e=()=>{let t=this.manager;t.poiLabelsLayer.setHoveredPOI(void 0),t.clickableObjectsLayer.setHoveredObjects({}),this.controller.requestRedrawGraph()};O(window).on("blur.dcg-poiController-"+this.id,e),O(this.elt).on("mouseleave",e)}removeManualUnhoverListener(){O(window).off(".dcg-poiController-"+this.id)}addTouchEventHandlers(){O(this.elt).on("touchstart",e=>{if(!this.isViewportLocked()){O(e.target).is(":not(input, textarea)")&&e.preventDefault();return}let t=this.getMouseRelativeToGrapher(e),i=this.getToleranceByDevice(e.device),n=this.getFeatureUnderPoint(t,i);n&&(n.type==="image"&&!ba(n.model)&&!Cd(n.model)||n.type==="sketch-branch"&&this.graphSettings.config.onlyTraceSelected&&!n.sketch.selected||O(e.target).is(":not(input, textarea)")&&e.preventDefault())}),O(this.elt).on("dcg-tapstart",e=>{if(this.controller.isGeoToolActive()&&this.handleGeoTapStart(e)){e.handle();return}let t=this.getMouseRelativeToGrapher(e),i=this.getToleranceByDevice(e.device),n=this.getFeatureUnderPoint(t,i);if(!n){this.isBoxSelectActive(e)||this.controller.dispatch({type:"set-none-selected"}),this.isBoxSelectActive(e)?this.startBoxSelect(e):this.manager.viewportController.beginPanning(e);return}if(n.isClickable&&!this.isBoxSelectActive(e)){let a="model"in n&&n.model;a?this.manager.clickableObjectsLayer.setPressedObject({id:a.id,listIndex:uE(n)}):this.manager.clickableObjectsLayer.setPressedObject(void 0)}else this.manager.clickableObjectsLayer.setPressedObject(void 0);if(n.type==="editable-label"){e.handle();return}else pi();if(n.type==="draggable-label"){this.startMovingPoints({poiUnderMouse:void 0,evt:e,points:[{type:"draggable-label",label:n.label,startScreenPt:t}]}),e.handle();return}if(n.type==="clickable-label"&&e.handle(),n.type==="image"&&Cd(n.model)&&!this.isBoxSelectActive(e)){let a=!!n.isClickable;if(this.startMovingPoints({poiUnderMouse:void 0,evt:e,points:[{type:"image",image:n.model,startScreenPt:t,shouldDelayUntilRealMove:a}]}),!a){e.handle();return}}let o=!1,s=n.model;if(this.controller.isGeometry()&&s&&s.type==="expression"&&s.formula.geometry){!this.isBoxSelectActive(e)&&!this.controller.isItemSelected(s.id)&&this.controller.dispatch({type:"set-none-selected"});let a;"poi"in n&&(a=n.poi),o=this.startReverseDrag(s.id,e,a),o&&n.type!=="static-point"&&this.manager.clickableObjectsLayer.setPressedObject({id:s.id,listIndex:uE(n)})}if(n.type==="movable-point"&&(e.handle(),e.handle("do-not-clear-poi-labels"),!o)){this.startMovingPoints({poiUnderMouse:n.poi,evt:e,points:[{type:"poi",poi:n.poi,startScreenPt:t}]});return}if(n.type==="static-point"&&!n.isClickable){let a=n.poi;if(this.controller.isGeometry()){if(a&&a.hasInteractiveLabel()){this._togglePOIUnderPoint(t,i)&&e.handle("do-not-clear-poi-labels");return}}else if(a){this._togglePOIUnderPoint(t,i)&&e.handle("do-not-clear-poi-labels");return}(!n.sketch.selected||this.isBoxSelectActive(e))&&n.model&&this.selectItemIfNotSecret(n.model.id,this.isBoxSelectActive(e));return}if(!o&&this._togglePOIUnderPoint(t,i)){e.handle(),e.handle("do-not-clear-poi-labels");return}if(!o&&n.type==="sketch-branch"&&!n.isClickable){let a=!this.controller.isTraceEnabled();if(this.graphSettings.config.onlyTraceSelected){if(e.handle("do-not-clear-poi-labels"),!a&&n.sketch.selected&&!this.isBoxSelectActive(e)){this.startTracingBranch(n.branchInfo,t),e.handle();return}}else{let l=!this.controller.isListEnabled();if(a&&l||(this.selectItemIfNotSecret(n.sketch.id,this.isBoxSelectActive(e)),a))return;this.startTracingBranch(n.branchInfo,t),e.handle(),e.handle("do-not-clear-poi-labels");return}}this.addGlobalMouseListener("dcg-tapmove",a=>{this.manager.clickableObjectsLayer.isAnObjectPressed()?t=this.getMouseRelativeToGrapher(a):(this.removeAllGlobalMouseListeners(),this.manager.viewportController.beginPanning(a))}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",a=>{this.removeAllGlobalMouseListeners();let l=this.manager.clickableObjectsLayer.getPressedObject(),c=l&&l.id;this.manager.clickableObjectsLayer.setPressedObject(void 0);let u=this.getFeatureUnderPoint(t,i);if(u&&u.isClickable){let p="model"in u&&u.model;p&&p.id===c&&!a.wasHandled("dragged-clickable-object")&&!this.isBoxSelectActive(a)&&this.controller.dispatch({type:"clickable-item-clicked",id:p.id,listIndex:uE(u)});return}if(!o){if(u&&u.type==="sketch-branch"&&(!u.sketch.selected||this.isBoxSelectActive(a))){this.selectItemIfNotSecret(u.model.id,this.isBoxSelectActive(a));return}if(u&&(u.type==="movable-point"||u.type==="static-point")){(!u.sketch.selected||this.isBoxSelectActive(a))&&u.model&&this.selectItemIfNotSecret(u.model.id,this.isBoxSelectActive(a));return}if(u&&u.type==="image"){this.selectItemIfNotSecret(u.model.id,this.isBoxSelectActive(a));return}}})})}isBoxSelectActive(e){if(!this.controller.isMultiSelectEnabled())return!1;let t=this.controller.getActiveTool();return t==="selection"&&e.shiftKey||t==="box-selection"}isViewportLocked(){return this.graphSettings.config.lockViewport||this.graphSettings.userLockedViewport}addKeydownEventHandler(){O(this.elt).on("keydown",e=>{var s,a,l;if(this.manager.getAudioTrace().getAudioTraceActive())return;let t=this.manager.movablePointsLayer.getPOIUnderAttention(),i=this.manager.imageLayer.getFocusedImage(),n=Re(e),o=Di(e);if((n==="Up"||n==="Down"||n==="Left"||n==="Right")&&this.controller.isGraphPaperFocused()){e.stopPropagation(),e.preventDefault();let c=this.keyboardAttentionManager.getKeyboardAttention();if(c&&this.controller.shouldAllowMovingPointsWithKeyboard()){let u=i?i.centerId:c.calcId;if(!u)return;let p=this.getDraggablePointOrAncestors(u);this.movePointsFromKeyboard(p,e),this.controller.getEvaluator().notifyWhenSynced(()=>{this.describeFocusedItem({includeDetails:!0})})}else this.controller.isVirtualMouseAllowed()&&(this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),this.moveGeoPointFromKeyboard(e))}else if(n==="Tab"&&this.controller.isGraphPaperFocused()){let c=e.shiftKey?"prev":"next",u=this.keyboardAttentionManager.getKeyboardAttention();if(!(this.controller.getActiveTool()!=="selection")&&!u&&c==="prev")return;this.handleTabEvent(c,e)}else if((n==="Enter"||n==="Space")&&this.controller.isGraphPaperFocused()&&this.controller.getActiveTool()==="selection"){let c=this.keyboardAttentionManager.getKeyboardAttention();if(c){let u=this.controller.getItemModel(c.calcId);if(u&&!this.isBoxSelectActive(e)){let p=u.type==="expression"&&fa(u),g=u.type==="image"&&Bh(u);(p||g)&&this.controller.dispatch({type:"clickable-item-clicked",id:c.calcId,listIndex:c.listIndex})}}e.preventDefault(),e.stopPropagation();return}else if(this.controller.isGeometry()&&this.controller.isGraphPaperFocused()){let c=!1;if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey){let u;if(o==="O"?u={type:"multi-select-more",guid:rg(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}:o==="A"&&(u={type:"multi-select-transformations",guid:ww(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}),u){e.preventDefault(),e.stopPropagation();let p=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&p&&this.controller.getItemModel(p.calcId)&&this.controller.dispatch({type:"set-selected-id",id:p.calcId}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:u})}}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey){if(n==="Enter"||n==="Space")if(e.preventDefault(),this.controller.getActiveTool()!=="selection"&&e.stopPropagation(),this.controller.getActiveTool()==="box-selection"){let u=((s=this.keyboardAttentionManager.getKeyboardAttention())==null?void 0:s.calcId)||"";this.controller.isClickableId(u)&&(u=""),this.selectItemIfNotSecret(u,!0),this.describeFocusedItem({includeDetails:!1})}else this.tapGeoPointFromKeyboard(e);else if(o==="?")e.preventDefault(),e.stopPropagation(),this.controller.getGeoModel().speakCurrentGeoToolHint();else if(o==="D")e.preventDefault(),e.stopPropagation(),this.describeFocusedItem({includeDetails:!0});else if(n==="Backspace"||n==="Del"){e.preventDefault(),e.stopPropagation();let u=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&u&&this.controller.getItemModel(u.calcId)&&this.controller.dispatch({type:"set-selected-id",id:u.calcId}),this.controller.dispatch({type:"delete-all-selected-items"}),c=!0}else if(o==="-"||o==="="){e.preventDefault(),e.stopPropagation();let u=this.controller.getAllVisibleGeoToolbarItems(),p=u.findIndex(g=>(g==null?void 0:g.current)===this.controller.getActiveTool());for(let g=1;g<u.length;g++){let h=p+(o==="-"?-g:g);h<0&&(h=u.length+h),h>u.length-1&&(h=h-u.length);let b=(a=u[h])==null?void 0:a.current;if(this.selectGeoTool(b)){c=!0;break}}}else if(o==="["||o==="]"){e.preventDefault(),e.stopPropagation();let p=this.controller.getAllVisibleGeoToolbarItems().find(b=>(b==null?void 0:b.current)===this.controller.getActiveTool());if(!p)return;let g=p.dropdown||[p.current];if(g.length===0)return;let h=g.indexOf(p.current);for(let b=1;b<g.length;b++){let C=h+(o==="["?-b:b);C<0&&(C=g.length+C),C>g.length-1&&(C=C-g.length);let D=g[C];if(this.selectGeoTool(D)){c=!0;break}}}else if(!e.shiftKey&&o!==void 0&&o>="0"&&o<="9"){let u=(l=this.controller.getAllVisibleGeoToolbarItems()[e.which-49])==null?void 0:l.current;c=this.selectGeoTool(u)}}c&&this.handleGeoKeyboardPtMove()}else t&&(o==="X"||o==="Y"||o==="L"||o==="C")?this.speakPoint(t,o):i&&(o==="X"||o==="Y"||o==="L")&&this.manager.imageLayer.speakImageAttribute(i,o)})}selectGeoTool(e){return e?this.controller.isGeoToolEnabled(e)?(this.controller.dispatch({type:"select-geo-tool",tool:e}),!0):(xe(this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.controller.getGeoModel().getDisplayNameForTool(e)})),!1):!1}getMouseRelativeToGrapher(e){let t=this.elt.getBoundingClientRect(),i=e.touches?e.touches[0]:e,n=i.clientX-t.left,o=i.clientY-t.top;return{x:n,y:o}}_getStyledPointRadiusAdjustments(){return{radiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!1),selectedRadiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!0),movablePoint:this.graphSettings.config.projectorMode?30/2:22/2}}_getStyledPointRadiusForPOI(e,t){if(e.isMovable())return t.movablePoint;{let i=e.getPointSize()/2,n=e.isSelected()?t.selectedRadiusMultiplier:t.radiusMultiplier;return i*n}}handleTabEvent(e,t){let i=this.controller.getActiveTool()!=="selection";if(this.keyboardAttentionManager.focusNextObjFromKeyboard({direction:e,allowWrapping:i,selectNonClickables:this.controller.getActiveTool()==="selection"})){t==null||t.preventDefault(),t==null||t.stopPropagation();return}else if(!i){this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),e==="prev"&&(t==null||t.preventDefault(),t==null||t.stopPropagation(),this.manager.speakGrapherFocusAriaLabel());return}}_getDistanceFromStyledPOI(e,t){let i=this._getStyledPointRadiusForPOI(e,t.adjustments),n=Math.max(0,t.tolerance-i),o=t.projection.map_pt(e),s=__dcg_shared_module_exports__['X'](o.x-t.screenPt.x,o.y-t.screenPt.y),a=Math.max(0,s-i);if(a<=n)return a}_getClosestPoint(e,t,i){let n=1/0,o,s={projection:this.manager.getProjection(),adjustments:this._getStyledPointRadiusAdjustments(),screenPt:t,tolerance:i};for(let a of e){let l=this._getDistanceFromStyledPOI(a,s);l!==void 0&&l<n&&(n=l,o=a)}return o}findIdsThatIntersectBox(e){let t={},i=this.manager.getSketchOrder();for(let n=i.length-1;n>=0;n--){let o=i[n],s=this.controller.getItemModel(o);if(s){if(s.type==="expression"){let a=this.manager.getGraphSketch(o);if(!a||fa(s)||this.controller.isItemNotSelectableBecauseItsSecret(o))continue;let l=a.branches;if(!l||!l.length)continue;for(let c=0;c<l.length;c++)if(this.doesBoxIntersectBranch(l[c],e)){t[s.id]=!0;break}}else if(s.type==="image"){let a=this.manager.getGraphImage(o);if(!a)continue;Ad.doesBoxIntersectAnyImage(a,e)&&(t[s.id]=!0)}}}return this.manager.poiDotsLayer.getDrawnPOI().forEach(n=>{let o=n.sketch.id,s=this.controller.getItemModel(o);s&&s.type==="expression"&&fa(s)||this.controller.isItemNotSelectableBecauseItsSecret(o)||n.isBareLabel()||(n.isMovable()||n.isAttachedToPlottedPoint())&&Ad.doesBoxIntersectPOI(n,e)&&(t[o]=!0)}),t}_getStyledLineAdjustments(){return{thicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!1),selectedThicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!0)}}_getStyledLineThicknessForBranch(e,t,i){let n=Math.max(0,"lineWidth"in e&&e.lineWidth||0)/2;return t?n*i.selectedThicknessMultiplier:n*i.thicknessMultiplier}_getDistanceFromStyledBranch(e,t,i,n){let o=this._getStyledLineThicknessForBranch(e,t,n.adjustments),s=this.calculateDistanceFromBranch(e,n.screenPt,n.projection,i),a=Math.max(0,s-o),l=Math.max(0,n.tolerance-o);if(a<=l)return a}getFeatureUnderPoint(e,t){let i=this.manager.poiLabelsLayer,n=this.manager.getProjection();if(this.manager.scaleAxis)return;let o=i.getInteractiveLabelUnderPoint(e);if(o)switch(o.type){case"editable":return{type:"editable-label",model:o.model,isClickable:void 0};case"draggable":return{type:"draggable-label",label:o.label,isClickable:void 0};case"clickable":return{type:"clickable-label",model:o.model,poi:o.poi,isClickable:!0}}let s=this.manager.getSketchOrder(),a={},l=1,c,u={adjustments:this._getStyledLineAdjustments(),projection:n,screenPt:e,tolerance:t};for(let k=s.length-1;k>=0;k--){let T=s[k],A=this.controller.getItemModel(T),R=l;if(a[T]=R,!!A){if(A.type==="expression"){let P=this.manager.getGraphSketch(T);if(!P)continue;let W=P.branches;if(!W||!W.length)continue;if(P.showHighlight&&!this.controller.isGeometry()&&(R=-1/0,a[T]=R),!c||c.stackingContext>=R){let H=fa(A);for(let j=0;j<W.length;j++){let ne=W[j],le=this._getDistanceFromStyledBranch(ne,P.showHighlight,H,u);if(le!==void 0){let w=!1;c?(R<c.stackingContext||R===c.stackingContext&&le<c.distance-3.5)&&(w=!0):w=!0,w&&(c={type:"sketch-branch",model:A,sketch:P,distance:le,stackingContext:R,branchInfo:{id:P.id,branch:j,sketch:P}})}}}}else if(A.type==="image"){let P=this.manager.getGraphImage(T);if(!P)continue;let W=this.getImageInfoUnderMouse(P,n.pixelsToMath.mapPoint(e),t);if(!W)continue;P.foreground?(l+=1,R=l,a[T]=R,l+=1):(R=1/0,a[T]=R),(!c||c.stackingContext>R)&&(c={type:"image",model:P,distance:0,stackingContext:R,listIndex:W.listIndex})}}}let p=[],g=[],h=[],b=[],C=c?c.stackingContext:1/0;this.manager.poiDotsLayer.getDrawnPOI().forEach(k=>{var T;if(!k.isBareLabel())if(k.isMovable()){let A=k.sketch.id,R=this.controller.getItemModel(A),P=R&&R.type==="expression"&&((T=R.formula.geometry)==null?void 0:T.call);P&&P.symbol==="glider"?p.push(k):g.push(k)}else k.isAttachedToPlottedPoint()?a[k.sketch.id]<=C&&h.push(k):b.push(k)});let D=this._getClosestPoint(p,e,t);if(D||(D=this._getClosestPoint(g,e,t)),D)return{type:"movable-point",poi:D,isClickable:void 0,sketch:D.sketch,model:this.controller.getItemModel(D.sketch.id)};let S=this._getClosestPoint(b,e,t);if(S)return{type:"poi",poi:S,isClickable:!1,model:void 0};let V=this._getClosestPoint(h,e,t);if(V){let k=this.controller.getItemModel(V.sketch.id);return k&&k.type==="expression"&&fa(k)?{type:"static-point",poi:V,sketch:V.sketch,isClickable:!0,model:k}:{type:"static-point",poi:V,isClickable:!1,sketch:V.sketch,model:k}}if(c){if(c.type==="sketch-branch")return{type:"sketch-branch",branchInfo:c.branchInfo,sketch:c.sketch,model:c.model,isClickable:fa(c.model),isSelected:this.controller.isItemSelected(c.sketch.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0};if(c.type==="image")return{type:"image",model:c.model,isClickable:Bh(c.model),listIndex:c.listIndex,isSelected:this.controller.isItemSelected(c.model.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0}}}_togglePOIUnderPoint(e,t){if(!this.controller.isTraceEnabled())return;let i=this.getFeatureUnderPoint(e,t);if(!i||i.isClickable)return!1;let n="poi"in i&&i.poi;return!n||n.isBareLabel()?!1:(this.manager.poiLabelsLayer.isOpenPOI(n)?(this.manager.poiLabelsLayer.closePOI(n),this.manager.poiLabelsLayer.setHoveredPOI(void 0)):(this.manager.poiLabelsLayer.openPOI(n),this.speakPoint(n)),this.controller.requestRedrawGraph(),!0)}getImageInfoUnderMouse(e,t,i){if(!e)return;let n=e.formula;if(!n)return;let o=n.dimensions;if(!(!o.x||!o.y||!o.width||!o.height||!o.radianAngle||!e.shouldGraph))for(let s=o.x.length-1;s>=0;s--){let a=o.x[s],l=o.y[s],c=o.radianAngle[s],u=a+Math.cos(c)*(t.x-a)-Math.sin(c)*(t.y-l),p=l+Math.sin(c)*(t.x-a)+Math.cos(c)*(t.y-l),g=.5*Math.abs(o.width[s]),h=.5*Math.abs(o.height[s]);if(u>a-g&&u<a+g&&p>l-h&&p<l+h)return{listIndex:s}}}doesBoxIntersectBranch(e,t){let i=!1,n=!1;switch(e.graphMode){case 5:case 8:case 2:break;case 6:i=!0;break;case 1:n=!0;break;case 18:case 17:case 19:return oE(t,{x1:e.segments[0][0],y1:e.segments[0][1],x2:e.segments[0][2],y2:e.segments[0][3],extendStart:e.graphMode===18,extendEnd:e.graphMode!==17});case 20:return BB(t,{x:e.segments[0][0],y:e.segments[0][1],radius:e.segments[0][2]});case 21:case 23:{let[s,a]=e.segments[0],[l,c,u]=e.graphMode===21?this.getBoxIntersectArgsForArc(e):this.getBoxIntersectArgsForAngleMarker(e),p=(u-c)/2+c;return NB(t,{x0:s+l*Math.cos(c),y0:a+l*Math.sin(c),x1:s+l*Math.cos(p),y1:a+l*Math.sin(p),x2:s+l*Math.cos(u),y2:a+l*Math.sin(u)})}default:return!1}let o=e.segments;for(let s=0;s<o.length;s++){let a=o[s];if(i){let l=a;a=[];for(let c=0;c<l.length;c+=2){let u=l[c],p=l[c+1];a.push(p*Math.cos(u),p*Math.sin(u))}}else if(n){let l=a;a=[];for(let c=0;c<l.length;c+=2)a.push(l[c+1],l[c])}if(KB(t,a))return!0}return!1}getBoxIntersectArgsForArc(e){return[e.segments[0][2],e.segments[0][3],e.segments[0][4]]}getBoxIntersectArgsForAngleMarker(e){let t=e.segments[0][3],i=this.manager.getProjection(),n=df(t,i),o=i.pixelsToMath.dangerouslyGetXScaleFactor(),s=i.pixelsToMath.dangerouslyGetYScaleFactor();return[Math.abs(Math.min(o,s))*n,e.segments[0][2],e.segments[0][2]+t]}static doesBoxIntersectAnyImage(e,t){let i=e.formula;if(!i)return;let n=i.dimensions;if(!(!n.x||!n.y||!n.width||!n.height||!n.radianAngle||!e.shouldGraph)){for(let o=n.x.length-1;o>=0;o--)if(UB(t,{width:n.width[o],height:n.height[o],angle:n.radianAngle[o],center:{x:n.x[o],y:n.y[o]}}))return!0;return!1}}static doesBoxIntersectPOI(e,t){return t.left<=e.x&&e.x<=t.right&&t.top<=e.y&&e.y<=t.bottom}calculateDistanceFromBranch(e,t,i,n){if(e&&e.graphMode===7&&(n||this.controller.isGeometry())){let s=e.segments,a=i.pixelsToMath.mapCoordinatePair([t.x,t.y]);for(let l=0;l<s.length;l++)if(__dcg_shared_module_exports__['ja'](s[l],a))return 0;return 1/0}let o=Ad.getBranchesDistanceInfo(e,t,i,n,this.controller.isGeometry());return o?o.minDistance:1/0}static getBranchesDistanceInfo(e,t,i,n,o){let s=t.x,a=t.y,{mathToPixels:l,pixelsToMath:c}=i;switch(e.graphMode){case 5:if(!o&&!n)return;break;case 8:if(!n)return;break;case 6:if(!n)return;break;case 2:case 1:break;case 23:{let[S,V,k,T]=e.segments[0],A=l.dangerouslyGetXScaleFactor(),R=l.dangerouslyGetYScaleFactor(),[P,W]=c.mapCoordinatePair([s,a]),H=df(T,i),j=H/A,ne=1/0,le=W-V,w=P-S,B=Math.atan2(le,w);if(__dcg_shared_module_exports__['W'](B,k,T))__dcg_shared_module_exports__['X'](le*R,w*A)<=H+7&&(ne=0);else{let q=__dcg_shared_module_exports__['_'](P,W,S+j*Math.cos(k),V+j*Math.sin(k),S,V),M=__dcg_shared_module_exports__['_'](P,W,S+j*Math.cos(k+T),V+j*Math.sin(k+T),S,V),ae=__dcg_shared_module_exports__['X'](A*(q[0]-P),R*(q[1]-W)),se=__dcg_shared_module_exports__['X'](A*(M[0]-P),R*(M[1]-W));ne=Math.min(ae,se)}return{closestPoint:{x:s,y:a},minDistance:ne,secondDistance:ne}}break;case 18:case 17:case 19:case 24:{if(!e.segments.length)return null;let S=l.mapX(e.segments[0][0]),V=l.mapY(e.segments[0][1]),k=l.mapX(e.segments[0][2]),T=l.mapY(e.segments[0][3]),A=e.graphMode===18,R=e.graphMode===18||e.graphMode===19,P=__dcg_shared_module_exports__['$'](s,a,S,V,k,T,A,R);if(!P)return null;let W=__dcg_shared_module_exports__['X'](P[0]-s,P[1]-a);return{closestPoint:{x:P[0],y:P[1]},minDistance:W,secondDistance:W}}case 21:case 20:{let S=e.segments[0][0],V=e.segments[0][1],k=e.segments[0][2],T=e.graphMode===21?e.segments[0][3]:0,A=e.graphMode===21?e.segments[0][4]:Math.PI*2,R=__dcg_shared_module_exports__['aa'](c.mapX(s),c.mapY(a),S,V,k,T,A);if(!R)return null;let P=l.mapCoordinatePair(R),W=__dcg_shared_module_exports__['X'](P[0]-s,P[1]-a);return{closestPoint:{x:P[0],y:P[1]},minDistance:W,secondDistance:W}}default:return}let u=1/0,p=1/0,g,h;for(let S=0;S<e.segments.length;S++){let V=e.segments[S];for(let k=0;k<V.length-3;k+=2){let T=V[k],A=V[k+1],R=V[k+2],P=V[k+3];if(e.graphMode===6){let q=A,M=T;T=q*Math.cos(M),A=q*Math.sin(M);let ae=P,se=R;R=ae*Math.cos(se),P=ae*Math.sin(se)}e.graphMode===1&&([T,A]=[A,T],[R,P]=[P,R]);let[W,H]=l.mapCoordinatePair([T,A]),[j,ne]=l.mapCoordinatePair([R,P]),le=__dcg_shared_module_exports__['_'](0,0,W-s,H-a,j-s,ne-a),w=__dcg_shared_module_exports__['X'](le[0],le[1]);le[e.graphMode===1?1:0]<0?w<u&&(u=w,g=le):w<p&&(p=w,h=le)}}let b=u<p?g:h;if(!b)return;let C=b[0]+s,D=b[1]+a;return{closestPoint:{x:C,y:D},minDistance:Math.min(u,p),secondDistance:Math.max(u,p)}}static getBranchesTracePoint(e,t,i,n){let o,s=i.pixelsToMath.mapPoint(t);switch(e.graphMode){case 20:case 21:{let H=e.graphMode===21?e.segments[0][3]:0,j=e.graphMode===21?e.segments[0][4]:Math.PI*2;o=__dcg_shared_module_exports__['aa'](s.x,s.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],H,j);break}case 18:case 19:case 17:o=__dcg_shared_module_exports__['$'](s.x,s.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],e.segments[0][3],e.graphMode===18,e.graphMode!==17);break}if(o)return{x:o[0],y:o[1]};if(!e)return;let a="compiled"in e&&e.compiled,l=a&&a.fn;if(!l)return;let c=this.getBranchesDistanceInfo(e,t,i,!1,n);if(!c)return;let{mathToPixels:u,pixelsToMath:p}=i,g,h;e.graphMode===2?(h="x",g="y"):(h="y",g="x",u=new __dcg_shared_module_exports__['xc'](u.yScale,u.xScale),p=u.inverse());let b=Math.pow(c.minDistance/c.secondDistance,2),C=c.closestPoint[h]*(1-b)+t[h]*b,D=.5,S=.5,V=u.mapY(l(p.mapX(C-D))),k=u.mapY(l(p.mapX(C))),T=u.mapY(l(p.mapX(C+D))),A=D*Math.min(1,S/Math.abs(V-k)),R=D*Math.min(1,S/Math.abs(T-k));isFinite(A)||(A=D),isFinite(R)||(R=D);let P=Li(p.mapX(C-A),p.mapX(C+R)),W=l(P);if(!isFinite(u.mapY(W))){let H=u.mapX(P)-D,j=u.mapX(P)+D,ne=p.mapX(H),le=p.mapX(j),w=l(ne),B=l(le),q=u.mapY(w),M=u.mapY(B);Math.abs(q-t[g])<Math.abs(M-t[g])?W=w:W=B}return{x:e.graphMode===2?P:W,y:e.graphMode===2?W:P}}getPointInfo(e){switch(e.type){case"movable-point":case"static-labeled-point":return e3(e);case"poi":return e3(e.poi.getMovablePoint());case"movable-point-parent":return{calcId:e.id,isReverseDrag:!0};case"image":return{calcId:e.image.formula.center_reference_id,isReverseDrag:!1};case"draggable-label":return{calcId:e.label.model.id,isReverseDrag:!1};default:return e}}getDraggablePointOrAncestors(e){var a,l;if(!this.controller.isGeometry()){let c=this.controller.getItemModel(e);return c&&c.type==="expression"&&TD(c)&&((l=(a=c.formula)==null?void 0:a.typed_constant_value)==null?void 0:l.valueType)===__dcg_shared_module_exports__['Ra']?[{type:"movable-point-parent",id:e,x:c.formula.typed_constant_value.value[0],y:c.formula.typed_constant_value.value[1],shouldDelayUntilRealMove:!0}]:[]}let t=[e].concat(this.controller.getAllSelectedItems().map(c=>c.id)),i=!1,n={},o=[];ng({controller:this.controller},(c,u)=>{if(!u&&c.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Ra']&&c.data.isMovablePoint){let[p,g]=c.typedRuntimeValue.value;n[c.calcId]={id:c.calcId,value:{x:p,y:g}}}});let s=this.controller.getGeoModel().getComputedBoard().computeReversibilityLineages(t);for(let c in s){let u=n[c];if(!u){i=!0;break}o.push({type:"movable-point-parent",id:c,x:u.value.x,y:u.value.y,shouldDelayUntilRealMove:!0,transformations:s[c]})}return i?[]:o}getFeatureCenterMathPoint(e){switch(e.type){case"poi":return e.poi;case"movable-point-parent":let t={x:e.x,y:e.y};if(e.transformations){let i=__dcg_shared_module_exports__['Ka'](e.transformations.forward,[t.x,t.y]);t={x:i[0],y:i[1]}}return t;case"image":return{x:e.image.formula.dimensions.x[0],y:e.image.formula.dimensions.y[0]};case"draggable-label":return{x:e.label.x,y:e.label.y}}}startReverseDrag(e,t,i){let n=this.getMouseRelativeToGrapher(t),o=this.getDraggablePointOrAncestors(e).map(s=>__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},s),{startScreenPt:n}));return o.length>0?(this.startMovingPoints({poiUnderMouse:i,evt:t,points:o}),!0):!1}startMovingPoints(e){let t=e.evt,i=e.points,n=!1,o=!1,s=i.map(this.getPointInfo),a=this.controller;function l(){o=!0,a.dispatch({type:"start-moving-points",points:s})}let c=!1;for(let b of i)if(b.shouldDelayUntilRealMove){c=!0;break}c||l();let u;e.poiUnderMouse&&e.poiUnderMouse.isMovable()&&(u=e.poiUnderMouse.getMovablePoint().id),this.manager.movablePointsLayer.setPressedPointId(u);let p=i.map(b=>{let C=this.manager.getProjection().map_pt(this.getFeatureCenterMathPoint(b));return{x:b.startScreenPt.x-C.x,y:b.startScreenPt.y-C.y}}),g,h=()=>{if(!g)return;n=!0,o||l();let b=this.manager.getProjection(),C=this.getMouseRelativeToGrapher(g);g=void 0,this.controller.dispatch({type:"on-move-points",points:i.map(this.getPointInfo),screenPts:p.map(function(D){return{x:C.x-D.x,y:C.y-D.y}}),transform:i.map(D=>D.type==="movable-point-parent"?D.transformations:void 0),previousScreenPts:i.map(D=>D.startScreenPt),projection:b})};this.manager.registerMovablePointListener(h),this.addGlobalMouseListener("dcg-tapmove",b=>{g=b}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",b=>{if(h(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.setPressedPointId(void 0),o&&(b.handle("dragged-clickable-object"),this.controller.dispatch({type:"stop-moving-points",points:i.map(this.getPointInfo)})),!n){let C=this.getMouseRelativeToGrapher(t),D=this.getToleranceByDevice(t.device),S=this.getFeatureUnderPoint(C,D);if(S&&S.type==="movable-point")if(this.controller.isGeometry())(!S.sketch.selected||this.isBoxSelectActive(b))&&S.model&&this.selectItemIfNotSecret(S.model.id,this.isBoxSelectActive(b));else return;else if(S&&S.type==="sketch-branch"){let V=S.model;V&&V.formula.geometry&&!S.isClickable&&(!S.sketch.selected||this.isBoxSelectActive(b))&&this.selectItemIfNotSecret(S.model.id,this.isBoxSelectActive(b))}}})}startTracingBranch(e,t){this.manager.markLabelsDirty(),this.lastScreenPt=t;let i=this.manager.getProjection(),o=e.sketch.branches[e.branch],s=Ad.getBranchesTracePoint(o,t,i,this.controller.isGeometry());s&&this.speakPoint(s),this.manager.traceLayer.setTraceInfo({pt:s,branchInfo:e}),this.controller.requestRedrawGraph(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))}stopTracingBranch(e){this.manager.markLabelsDirty();let t=this.manager.poiLabelsLayer.getHoveredPOI();t&&!this.manager.poiLabelsLayer.isOpenPOI(t)&&(this.manager.poiLabelsLayer.openPOI(t),this.speakPoint(t),this.controller.requestRedrawGraph()),this.lastScreenPt=void 0,this.manager.traceLayer.setTraceInfo(void 0),this.controller.requestRedrawGraph(),this.removeAllGlobalMouseListeners()}handleTraceUpdate(e){if(!this.manager.traceLayer.traceInfo)return;let t=this.manager.getProjection(),i;if(e)i=this.getMouseRelativeToGrapher(e),this.lastScreenPt=i,this.manager.markLabelsDirty();else if(this.lastScreenPt)i=this.lastScreenPt;else return;let n=1/0,o=-1,s=this.manager.traceLayer.traceInfo,a=this.manager.graphSketches[s.branchInfo.sketch.id];if(!a)return;s.branchInfo.sketch=a;let l=s.branchInfo.sketch.branches;for(let p=0;p<l.length;p++){let g=this.calculateDistanceFromBranch(l[p],i,t,!1);g<n&&(o=p,n=g)}let c=l[o],u=c?Ad.getBranchesTracePoint(c,i,t,this.controller.isGeometry()):void 0;u&&this.speakPoint(u),this.manager.traceLayer.traceInfo.branchInfo.branch=o,this.manager.traceLayer.traceInfo.pt=u,this.controller.requestRedrawGraph()}hasNonlinearMoveStrategy(e){if(!e||e.type!=="movable-point-parent")return!1;let t=this.controller.getItemModel(e.id);if(!t||t.type!=="expression"||!t.formula)return!1;let i=t.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}movePointsFromKeyboard(e,t){if(!t)return;let i=this.manager.getProjection(),n=e.map(h=>{let{x:b,y:C}=i.map_pt(this.getFeatureCenterMathPoint(h));return{x:b,y:C}}),o=0,s=0,a=Re(t),l=(i.pixelCoordinates.right-i.pixelCoordinates.left)/40,c=(i.pixelCoordinates.bottom-i.pixelCoordinates.top)/40,u=a==="Up"||a==="Down"?c:l;u=t.shiftKey?u*5:u;let p,g;if(a==="Up"?(g="y",s-=u,p=t.shiftKey?"bigup":"up"):a==="Down"?(g="y",s+=u,p=t.shiftKey?"bigdown":"down"):a==="Left"?(g="x",o-=u,p=t.shiftKey?"bigdown":"down"):a==="Right"&&(g="x",o+=u,p=t.shiftKey?"bigup":"up"),p){let h=n.map(({x:C,y:D})=>({x:C+o,y:D+s})),b;g==="x"||e.some(C=>this.hasNonlinearMoveStrategy(C))?b={x:p}:g==="y"&&(b={y:p}),this.controller.dispatch({type:"on-move-points",points:e.map(C=>this.getPointInfo(C)),screenPts:h,previousScreenPts:n,transform:e.map(C=>C.type==="movable-point-parent"?C.transformations:void 0),projection:i,keyboardDirection:b})}}getGeoKeyboardPt(){return this.initGeoKeyboardPt(),this.geoKeyboardPt}setGeoKeyboardPt(e){this.geoKeyboardPt=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.geoKeyboardPt),{x:e.x,y:e.y}),e.fromArrowKeys&&(this.geoKeyboardPt.lastArrowedX=e.x,this.geoKeyboardPt.lastArrowedY=e.y),this.controller.requestRedrawGraph()}initGeoKeyboardPt(){if(!isNaN(this.geoKeyboardPt.x)&&!isNaN(this.geoKeyboardPt.y))return;let e=this.manager.getProjection();if(!e)return;let t=e.viewport,i=Op(e),n=i.minorStepX,o=i.minorStepY,s=Math.round((t.xmin+t.xmax)/2/n)*n,a=Math.round((t.ymin+t.ymax)/2/o)*o;this.setGeoKeyboardPt({x:s,y:a})}moveGeoPointFromKeyboard(e){if(!e)return;this.initGeoKeyboardPt();let t=this.manager.getProjection();if(!t)return;let i=t.viewport,n=Op(t),o=n.minorStepX/4,s=n.minorStepY/4,a=this.geoKeyboardPt.x,l=this.geoKeyboardPt.y,c=Re(e);if(c==="Down"?e.ctrlKey?l=i.ymin:l=Math.max(Math.round((l-s)/s)*s,i.ymin):c==="Up"?e.ctrlKey?l=i.ymax:l=Math.min(Math.round((l+s)/s)*s,i.ymax):c==="Left"?e.ctrlKey?a=i.xmin:a=Math.max(Math.round((a-o)/o)*o,i.xmin):c==="Right"&&(e.ctrlKey?a=i.xmax:a=Math.min(Math.round((a+o)/o)*o,i.xmax)),a!==this.geoKeyboardPt.x||l!==this.geoKeyboardPt.y){this.setGeoKeyboardPt({x:a,y:l,fromArrowKeys:!0}),this.handleGeoKeyboardPtMove(e),Ht(eg(this.controller,this.geoKeyboardPt.x,this.geoKeyboardPt.y));let u=this.manager.clickableObjectsLayer.getHoveredObjects();for(let p in u){let g=this.controller.getItemModel(p);g!==void 0&&Ht(this.controller.s("graphing-calculator-narration-geometry-near-item",{item:xw(g,this.controller,{includeDetails:!1})}))}xe()}}handleGeoKeyboardPtMove(e){this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),i=!!(e&&e.shiftKey);t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:i,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange()}tapGeoPointFromKeyboard(e){var l;this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),i=this.controller.getActiveTool(),n=t.getCurrentTool(),o=(l=n.getSpec)==null?void 0:l.call(n),s=!!e.shiftKey,a=t.onMouseAction("release",{pt:this.geoKeyboardPt,shift:s,tolerance:this.getToleranceByDevice("keyboard")});a.committed&&this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects",shiftKey:e.shiftKey},a)),t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:s,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange(),this.speakGeoReleaseAction(i,o,a.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}speakGeoReleaseAction(e,t,i){var n;if(i!==void 0){let o=Object.keys(i);if(!o.length||!t)return;let s="";if(e==="point"||e==="expression-edit"){for(let a in i){let l=i[a];if(l){if(l.type==="point-reference"){s=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name");break}else if(l.type==="intersection"){s=this.controller.s("graphing-calculator-text-geometry-intersection");break}else if(l.type==="glider"){s=this.controller.s("graphing-calculator-text-geometry-glider");break}}}s===""&&(s=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name"))}else switch((n=t.outputs[0])==null?void 0:n.type){case"arc":s=this.controller.s("graphing-calculator-text-geometry-tool-arc-display-name");break;case"circle":s=this.controller.s("graphing-calculator-text-geometry-tool-circle-display-name");break;case"line":s=this.controller.s("graphing-calculator-text-geometry-tool-line-display-name");break;case"segment":s=this.controller.s("graphing-calculator-text-geometry-tool-segment-display-name");break;case"ray":s=this.controller.s("graphing-calculator-text-geometry-tool-ray-display-name");break;case"vector":s=this.controller.s("graphing-calculator-text-geometry-tool-vector-display-name");break;case"parallel":s=this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");break;case"perpendicular":s=this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");break;case"midpoint":s=this.controller.s("graphing-calculator-text-geometry-tool-midpoint-display-name");break;case"polygon":s=this.controller.s("graphing-calculator-text-geometry-tool-polygon-display-name");break;case"angle":s=this.controller.s("graphing-calculator-text-geometry-tool-angle-display-name");break;case"reflect":s=this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");break;case"translate":s=this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");break;case"dilate":s=this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");break;case"rotate":s=this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");break;default:s=this.controller.s("shared-calculator-narration-item-unknown")}o.length===1?xe(this.controller.s("graphing-calculator-narration-geometry-added-object-type",{type:s})):s!=="graphing-calculator-text-geometry-point"?o.length===2?xe(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-point",{type:s})):xe(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-points",{type:s,points:o.length-1})):xe(this.controller.s("graphing-calculator-narration-geometry-added-points",{points:o.length}))}else this.controller.getGeoModel().speakCurrentGeoToolHint()}describeFocusedItem(e){let t=this.keyboardAttentionManager.getKeyboardAttention(),i=this.controller.getItemModel((t==null?void 0:t.calcId)||"");this.controller.getEvaluator().notifyWhenSynced(()=>{var n,o;if(!this.controller.isGeometry()){if(i&&i.type==="image"&&((n=this.manager.imageLayer.getFocusedImage())==null?void 0:n.id)===i.id){this.manager.imageLayer.speakAriaAlert();return}else if(i&&((o=this.manager.movablePointsLayer.getPOIUnderAttention())==null?void 0:o.sketch.id)===i.id&&this.manager.movablePointsLayer.speakAriaAlert())return}xe(xw(i,this.controller,{includeDetails:e.includeDetails,description:t==null?void 0:t.description,poi:this.manager.movablePointsLayer.getPOIUnderAttention(),listIndex:t==null?void 0:t.listIndex,polygonEdge:t==null?void 0:t.polygonEdge,includeSelectionState:this.controller.isGeometry()&&(this.controller.getActiveTool()==="box-selection"||this.controller.getActiveTool()==="selection")}))})}getPointFromFocusedItem(){let e=this.keyboardAttentionManager.getKeyboardAttention(),t=this.controller.getItemModel((e==null?void 0:e.calcId)||"");if(!t||t.type!=="expression"||!t.latex)return;let i=t.formula.typed_constant_value;if(!i||!this.manager.getProjection())return;let o=i.valueType,s=i.value;if(__dcg_shared_module_exports__['vb'](i.valueType)){let u=e==null?void 0:e.listIndex;u&&(o=__dcg_shared_module_exports__['wb'](o),s=s[u])}let a=e==null?void 0:e.polygonEdge;if(o===__dcg_shared_module_exports__['Za']&&a!==void 0&&a>=0&&s.length>a){let u=s[a],p=s[(a+1)%s.length];o=__dcg_shared_module_exports__['$a'],s=[u,p]}let l=NaN,c=NaN;return o===__dcg_shared_module_exports__['Ra']?(l=s[0],c=s[1]):o===__dcg_shared_module_exports__['fb']||o===__dcg_shared_module_exports__['hb']||o===__dcg_shared_module_exports__['$a']?(l=(s[0][0]+s[1][0])/2,c=(s[0][1]+s[1][1])/2):o===__dcg_shared_module_exports__['pb']?(l=s[1][0]+s[0][0]/2,c=s[1][1]+s[0][1]/2):(l=s[0][0],c=s[0][1]),{x:l,y:c}}moveGeoKeyboardPtToFocusedItem(e){let t=this.getPointFromFocusedItem();if(!t)return;let{x:i,y:n}=t,o=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getGeoModel().setObjectHovered({calcId:(o==null?void 0:o.calcId)||"",listIndex:void 0}),!isNaN(i)&&!isNaN(n)?(this.setGeoKeyboardPt({x:i,y:n}),this.controller.isVirtualMouseAllowed()&&e.describe&&xe(this.controller.s("graphing-calculator-narration-geometry-moved-to-coordinates",{x:qi(this.controller,i),y:zi(this.controller,n)}))):this.controller.isVirtualMouseAllowed()&&e.describe&&xe(this.controller.s("graphing-calculator-narration-geometry-unable-to-move"))}speakPoint(e,t){if(!(!e||!this.manager.getAudioTrace()||!this.manager.getProjection()))switch(t){case"X":xe(qi(this.controller,e.x));break;case"Y":xe(zi(this.controller,e.y));break;case"L":"ariaLabel"in e&&e.ariaLabel?xe(e.ariaLabel):xe(this.controller.s("graphing-calculator-narration-poi-graph-point"));break;case"C":"sketch"in e&&xe(zh(this.controller,e.sketch.color))}}selectItemIfNotSecret(e,t){this.controller.isItemNotSelectableBecauseItsSecret(e)||(!this.controller.isMultiSelectEnabled()||!t?this.controller.dispatch({type:"set-selected-id",id:e}):this.controller.dispatch({type:"toggle-selected-with-multi-select",id:e}))}convertTouchEventToMathPoint(e){let{clientX:t,clientY:i}=e.changedTouches[0],n=this.manager.elt.getBoundingClientRect();return this.controller.getGeoModel().convertCanvasPixelsToPoint({x:t-n.left,y:i-n.top})}handleGeoTapStart(e){let t=this.controller.getGeoModel();this.grapherIsPressed=!0,this.canceledGeoToolplayWhilePressed=!1;let i=!!e.shiftKey,n=this.convertTouchEventToMathPoint(e);return this.geoMouse=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{shift:i}),t.onMouseAction("move",{pt:n,shift:i,tolerance:this.getToleranceByDevice(e.device)}).handled?(ZB(e)?this.handleGeoTapMove(e):(t.onPreviewChange(),this.updateGeoHoveredObjects()),t.getToolMode()==="expression-edit"&&e.preventDefault(),!0):!1}handleGeoShiftKeyChange(e){let t=this.geoMouse;if(!t||t.shift===e)return;t.shift=e;let i=this.controller.getGeoModel();i.onMouseAction("move",{pt:{x:t.x,y:t.y},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),i.onPreviewChange()}handleGeoTapMove(e){let t=this.controller.getGeoModel(),i;if(this.isEventWithinInstance(e)||this.grapherIsPressed){let n=this.convertTouchEventToMathPoint(e),o=!!e.shiftKey;this.geoMouse=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{shift:o}),i=t.onMouseAction("move",{pt:n,shift:o,tolerance:this.getToleranceByDevice(e.device)}).handled}else this.geoMouse=void 0,t.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),i=!0;return t.onPreviewChange(),i}replayGeoTapMove(){let e=this.controller.getGeoModel(),t=this.geoMouse;t&&(e.onMouseAction("move",{pt:{x:t.x,y:t.y},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),e.onPreviewChange())}handleGeoTapEnd(e){var a;if(!this.grapherIsPressed)return;let t=this.controller.getGeoModel();this.grapherIsPressed=!1,this.geoMouse=void 0;let i=this.canceledGeoToolplayWhilePressed?{committed:void 0}:t.onMouseAction("release",{pt:this.convertTouchEventToMathPoint(e),shift:!!e.shiftKey,tolerance:this.getToleranceByDevice(e.device)});this.canceledGeoToolplayWhilePressed=!1,i.committed&&this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects",shiftKey:e.shiftKey},i)),this.isEventWithinInstance(e)&&ZB(e)?this.handleGeoTapMove(e):t.onPreviewChange();let n=this.controller.getActiveTool(),o=t.getCurrentTool(),s=(a=o.getSpec)==null?void 0:a.call(o);this.speakGeoReleaseAction(n,s,i.committed),t.getToolMode()==="expression-edit"&&e.preventDefault()}isEventWithinInstance(e){return e.target?O(e.target).closest(this.manager.elt).length:0}updateGeoHoveredObjects(){let e=this.controller.getGeoModel(),t={};e.getHoveredItems().forEach(i=>{let n;if("tokenId"in i){let o=this.controller.getGeoTokenInfoFromIdentifier(__dcg_shared_module_exports__['Kb'](i.tokenId));n=o&&o.calcId}else n=i.calcId;if(n!==void 0){let o=t[n];o?i.listIndex===void 0?o.listIndexes=void 0:o.listIndexes!==void 0&&(o.listIndexes[i.listIndex]=!0):t[n]={listIndexes:i.listIndex===void 0?void 0:{[i.listIndex]:!0}}}}),this.manager.clickableObjectsLayer.setHoveredObjects(t)}cancelGeoToolplay(){this.canceledGeoToolplayWhilePressed=this.grapherIsPressed,this.updateGeoHoveredObjects()}startBoxSelect(e){let t={};this.controller.getAllSelectedItems().forEach(o=>t[o.id]=!0);let i=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(e)),n;this.addGlobalMouseListener("dcg-tapmove",o=>{n=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(o));let s={left:Math.min(i.x,n.x),top:Math.min(i.y,n.y),right:Math.max(i.x,n.x),bottom:Math.max(i.y,n.y)};this.manager.setBoxSelectRectangle(s);let a=this.findIdsThatIntersectBox(s);this.controller.dispatch({type:"set-all-selected-ids",ids:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),a)})}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",o=>{this.removeAllGlobalMouseListeners(),this.manager.setBoxSelectRectangle(void 0),n||this.controller.dispatch({type:"set-none-selected"})})}};function ZB(r){return r.device==="mouse"}function e3(r){return{calcId:r.sketch.id,isReverseDrag:!1,scaleFactor:r.type==="movable-point"?r.scaleFactor:void 0,tableInfo:r.type==="movable-point"?r.tableInfo:void 0}}ct();
var Lc=class{
    constructor(e=0,t=0,i=1,n=i){
        this.tx=e,this.ty=t,this.sx=i,this.sy=n
    }
    toJSON(){
        return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}
    }
    compose(e){
        return new Lc(this.sx*e.tx+this.tx,this.sy*e.ty+this.ty,this.sx*e.sx,this.sy*e.sy)
    }
    translate(e,t){
        let i=t===void 0?e.x:t.x-e.x,n=t===void 0?e.y:t.y-e.y;
        return new Lc(this.tx+i,this.ty+n,this.sx,this.sy)
    }
    scale(e,t){
        return Lc.scale(e,t).compose(this)
    }
    scaleAtPoint(e,t,i=t){
        return Lc.scaleAtPoint(e,t,i).compose(this)
    }
    mapX(e){
        return this.sx*e+this.tx
    }
    mapY(e){
        return this.sy*e+this.ty
    }
    mapPoint(e){
        return{x:this.mapX(e.x),y:this.mapY(e.y)}
    }
    mapRect(e){
        return{left:this.mapX(e.left),right:this.mapX(e.right),bottom:this.mapY(e.bottom),top:this.mapY(e.top)}
    }
},
Dl=Lc;
Dl.scale=function(e,t=e){return new Lc(0,0,e,t)},
Dl.translate=function(e,t){return new Lc().translate(e,t)},
Dl.scaleAtPoint=function(e,t,i=t){return i===void 0&&(i=t),new Lc(e.x*(1-t),e.y*(1-i),t,i)},
Dl.fromRects=function(e,t){let i=(t.right-t.left)/(e.right-e.left),n=(t.top-t.bottom)/(e.top-e.bottom);return new Lc(t.left-i*e.left,t.bottom-n*e.bottom,i,n)},
Dl.fromJSON=function(e){return new Lc(e.tx,e.ty,e.sx,e.sy)};
var Oc=class{
    constructor(e,t,i){
        this.screen=e,
        this.viewport=t,
        this.settings=i,
        this.mathCoordinates=__dcg_shared_module_exports__['wc'](t),
        this.pixelCoordinates=__dcg_shared_module_exports__['vc'](e),
        this.updateScalePairs()
    }
    updateScalePairs(){
        let{xAxisScale:e,yAxisScale:t}=this.settings;
        this.mathToPixels=__dcg_shared_module_exports__['xc'].fromRects(this.mathCoordinates,this.pixelCoordinates,{xAxisScale:e,yAxisScale:t}),
        this.pixelsToMath=this.mathToPixels.inverse()
    }
    mapx(e){
        return this.mathToPixels.mapX(e)
    }
    mapy(e){
        return this.mathToPixels.mapY(e)
    }
    reverse_mapx(e){
        return this.pixelsToMath.mapX(e)
    }
    reverse_mapy(e){
        return this.pixelsToMath.mapY(e)
    }
    mapAlongAxis(e,t){
        switch(t){
            case"x":return this.mapx(e);
            case"y":return this.mapy(e);
            default:{let i=t;throw new Error(`Unknown axis: ${i}`)}
        }
    }
    reverseMapAlongAxis(e,t){
        switch(t){
            case"x":return this.reverse_mapx(e);
            case"y":return this.reverse_mapy(e);
            default:{let i=t;throw new Error(`Unknown axis: ${i}`)}
        }
    }
    map_pt(e){
        return this.mathToPixels.mapPoint(e)
    }
    map_xy_pairs(e){
        for(var t=[],i=0;i<e.length;i+=2)
            t.push(this.mapx(e[i])),
            t.push(this.mapy(e[i+1]));
        return t
    }
    reverse_map_pt(e){
        return this.pixelsToMath.mapPoint(e)
    }
    coordsAreOnscreen(e,t,i=0){
        return e>-i&&t>-i&&e<this.screen.width+i&&t<this.screen.height+i
    }
    closestPointOnScreen(e){
        let t=this.pixelCoordinates;
        return{x:Math.min(Math.max(e.x,t.left),t.right),y:Math.min(Math.max(e.y,t.top),t.bottom)}
    }
};
var{log10:pE}=Math;
function dA(r,e){
    var t=e.x-r.x,
        i=e.y-r.y,
        n=.5*(r.x+e.x),
        o=.5*(r.y+e.y),
        s=.5*__dcg_shared_module_exports__['X'](t,i);
    return{center:Pc(n,o),radius:s}
}
function t3(r,e){
    var t={x:2*r.x-e.x,y:2*r.y-e.y};
    return dA(e,t)
}
function r3(r,e){
    for(var t=[],i=0;i<r.length;i++)
        t.push(Pc(r[i].pageX-e.left,r[i].pageY-e.top));
    return t
}
function Pc(r,e){
    return{x:r,y:e}
}
function i3(r){
    return Pc(.5*(r.left+r.right),.5*(r.bottom+r.top))
}
var oW=0,
hE=class{
    constructor(e,t){
        this.s=bc(()=>this.grapher.settings.config.language);
        this.grapher=e,
        this.elt=e.elt,
        this.id=oW++,
        this.controller=t,
        this.isScalingEnabled=!1,
        this.mousePt=Pc(0,0),
        this.lastScrollZoom=Date.now(),
        this.preventScrollZoom=!1,
        this.addMouseWheelEventHandler(),
        this.addTouchEventHandler()
    }
    remove(){
        O(window).off(".viewportcontroller-"+this.id)
    }
    getViewport(){
        return this.grapher.getProjection().viewport
    }
    getProjection(){
        return this.grapher.getProjection()
    }
    isViewportLocked(){
        var e=this.getProjection().settings;
        return e.config.lockViewport||e.userLockedViewport
    }
    updateMouse(e){
        var t=this.elt.getBoundingClientRect();
        this.mousePt=Pc(e.clientX-t.left,e.clientY-t.top)
    }
    updateScaleAxis(){
        this.isMouseInViewport()&&(
            this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"
        ),
        this.updateCursor(),
        this.controller.requestRedrawGraph()
    }
    updateCursor(){
        this.elt.classList.toggle("dcg-scale-horizontal",this.grapher.scaleAxis==="x"),
        this.elt.classList.toggle("dcg-scale-vertical",this.grapher.scaleAxis==="y"),
        this.elt.classList.toggle("dcg-scale-both",this.grapher.scaleAxis==="both")
    }
    isMouseNearOrigin(){
        var e=this.getProjection(),
            t=e.mathToPixels.mapPoint(Pc(0,0));
        return Math.abs(this.mousePt.x-t.x)<50&&Math.abs(this.mousePt.y-t.y)<50
    }
    isMouseNearXAxis(){
        var e=this.getProjection(),
            t=e.pixelCoordinates,
            i=e.mathToPixels.mapY(0);
        return i=Math.min(Math.max(t.top,i),t.bottom),
            Math.abs(this.mousePt.y-i)<40&&e.settings.showXAxis
    }
    isMouseNearYAxis(){
        var e=this.getProjection(),
            t=e.pixelCoordinates,
            i=e.mathToPixels.mapX(0);
        return i=Math.min(Math.max(t.left,i),t.right),
            Math.abs(this.mousePt.x-i)<40&&e.settings.showYAxis
    }
    isMouseInViewport(){
        var e=this.getProjection(),
            t=e.mathCoordinates,
            i=e.pixelsToMath.mapPoint(this.mousePt);
        return i.x>=t.left&&i.x<=t.right&&i.y>=t.bottom&&i.y<=t.top
    }
    _setViewportWithoutCancellingAnimation(e){
        if(e.isValid(this.controller.getAxisScaleSettings())&&!e.equals(this.getViewport())){
            var i=this.getProjection();
            this.grapher._setProjection(new Oc(i.screen,e,i.settings))
        }
    }
    setViewport(e){
        this.cancelAnimation(),
        this._setViewportWithoutCancellingAnimation(e)
    }
    setScreen(e){
        var t=this.getProjection();
        let i=t.settings.squareAxes?t.viewport.squareYAxis(e,t.settings):t.viewport;
        var n=new Oc(e,i,t.settings);
        this.grapher._setProjection(n)
    }
    getTransformedViewport(e){
        let{pixelCoordinates:t,mathCoordinates:i,settings:n}=this.getProjection(),
            {xAxisScale:o,yAxisScale:s}=n,
            a=e.mapRect(t);
        var l=__dcg_shared_module_exports__['xc'].fromRects(i,a,{xAxisScale:o,yAxisScale:s})
            .inverse()
            .mapRect(t);
        return new hn(l.left,l.right,l.bottom,l.top)
    }
    transformViewport(e){
        this.setViewport(this.getTransformedViewport(e)),
        (this.grapher.scaleAxis==="x"||this.grapher.scaleAxis==="y")&&this.controller.markSquareAxesAfterUserEditedViewport()
    }
    animateToViewport(e){
        this.cancelAnimation();
        let t=this.getProjection(),
            i=t.viewport,
            n=t.mathToPixels;
        var o=0,
            s,
            a=l=>{
                s||(s=l);
                var c=(l-s)/500;
                if(o+=c,o<1){
                    this.__animationTimeout=requestAnimationFrame(a);
                    let u=n.interpolateX(i.xmin,e.xmin,o),
                        p=n.interpolateX(i.xmax,e.xmax,o),
                        g=n.interpolateY(i.ymin,e.ymin,o),
                        h=n.interpolateY(i.ymax,e.ymax,o);
                    this._setViewportWithoutCancellingAnimation(new hn(u,p,g,h)),
                    this.grapher.debounceUserRequestedViewportChange()
                }else
                    this.setViewport(hn.fromObject(e)),
                    this.grapher.debounceUserRequestedViewportChange(),
                    this.controller.markSquareAxesAfterUserEditedViewport()
            };
        this.__animationTimeout=requestAnimationFrame(a)
    }
    cancelAnimation(){
        cancelAnimationFrame(this.__animationTimeout)
    }
    addMouseWheelEventHandler(){
        var e=!1,
            t,
            i;
        O(window).on("scroll.viewportcontroller-"+this.id,function(s){
            e=!0
        }),
        O(window).on("wheel.viewportcontroller-"+this.id,function(s){
            t=s.clientX,
            i=s.clientY
        }),
        O(window).on("mousemove.viewportcontroller-"+this.id,function(s){
            if(e){
                var a=s.clientX-t,
                    l=s.clientY-i,
                    c=a*a+l*l;
                c<100||(e=!1)
            }
        });
        var n=0,
            o=s=>{
                let a=s.originalEvent;
                if(a.deltaX===0&&a.deltaY===0)
                    return;
                var l=Date.now();
                let c=l-this.lastScrollZoom;
                if(this.preventScrollZoom&&c>50&&(this.preventScrollZoom=!1),
                        this.lastScrollZoom=l,
                        this.preventScrollZoom)
                    return;
                var u=this.getProjection();
                if(this.isViewportLocked())
                    return;
                var p=u.mathToPixels;
                if(e)
                    return;
                a.preventDefault(),
                this.updateMouse(a);
                var g=p.mapPoint(Pc(0,0));
                let b=(a.deltaY===0?-a.deltaX:-a.deltaY)>0?1:-1;
                var C=this.isMouseNearOrigin()&&b>0?g:this.mousePt;
                if(n>0)
                    return;
                n+=1,
                requestAnimationFrame(function(){
                    n--
                });
                let{xAxisScale:D,yAxisScale:S}=u.settings,
                    V=.0625;
                (D==="logarithmic"||S==="logarithmic")&&c<25&&(
                    V*=Math.max(10,c)/25
                );
                var k=b>0?1+V:1/(1+V),
                    T=this.grapher.scaleAxis,
                    A=T==="x"||T==="both"||!T?k:1,
                    R=T==="y"||T==="both"||!T?k:1;
                let P=Dl.scaleAtPoint(C,A,R),
                    W=this.getTransformedViewport(P);
                b==-1&&this.tooBig(W)||b==1&&this.tooSmall(W)||(
                    this.transformViewport(P),
                    this.grapher.debounceUserRequestedViewportChange()
                )
            };
        O(this.elt).on("wheel",o)
    }
    applyPanTouchChanges(e,t){
        if(!this.isViewportLocked()&&!this.isScalingEnabled){
            var i=Pc(t[0].x-e[0].x,t[0].y-e[0].y);
            this.transformViewport(Dl.translate(i)),
            this.grapher.debounceUserRequestedViewportChange()
        }
    }
    chooseDragScaleCenter(){
        var e=this.getProjection(),
            t=e.pixelCoordinates,
            i=e.mathToPixels.mapX(0),
            n=e.mathToPixels.mapY(0);
        return i=Math.min(Math.max(t.left,i),t.right),
            n=Math.min(Math.max(t.top,n),t.bottom),
            Pc(i,n)
    }
    applyScaleTouchChanges(e,t){
        if(this.isViewportLocked())
            return;
        var i=this.grapher.scaleAxis,
            n,
            o;
        if(e.length===2&&t.length===2)
            n=dA(e[0],e[1]),
            o=dA(t[0],t[1]);
        else if(t.length===1){
            var s=this.chooseDragScaleCenter();
            n=t3(s,e[0]),
            o=t3(s,t[0])
        }else
            return;
        var a=o.radius/n.radius,
            l=i==="y"?1:a,
            c=i==="x"?1:a,
            u=Dl.scaleAtPoint(n.center,l,c).translate(n.center,o.center);
        let p=this.getTransformedViewport(u);
        a<1&&this.tooBig(p)||a>1&&this.tooSmall(p)||(
            this.transformViewport(u),
            this.grapher.debounceUserRequestedViewportChange()
        )
    }
    addTouchEventHandler(){
        var e=[],
            t=!1,
            i=!0,
            n=!0,
            o=h=>{
                t||this.isViewportLocked()||(
                    this.updateMouse(h),
                    this.isScalingEnabled&&this.updateScaleAxis()
                )
            };
        O(window).on("mousemove.viewportcontroller-"+this.id,o),
        this.beginPanning=h=>{
            var b=this.getProjection();
            if(!this.isViewportLocked()&&!t&&h.touches.length===h.changedTouches.length){
                t=!0,
                this.grapher.isDragging=!0,
                this.updateMouse(h);
                var C=b.mathToPixels.mapPoint(Pc(0,0)),
                    D=this.grapher.scaleAxis;
                (D==="x"||D==="both")&&(i=this.mousePt.x>C.x),
                (D==="y"||D==="both")&&(n=this.mousePt.y>C.y),
                this.controller.dispatch({type:"grapher/drag-start"}),
                O(document).on("dcg-tapmove.graphdrag",p),
                O(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",g)
            }
        };
        var s=h=>{
                if(!(h.length<2)){
                    var b=this.grapher.getProjection(),
                        C=b.pixelCoordinates,
                        D=b.mathToPixels.mapX(0),
                        S=b.mathToPixels.mapY(0),
                        V=40;
                    D=Math.min(Math.max(C.left,D),C.right),
                    S=Math.min(Math.max(C.top,S),C.bottom);
                    var k=h[1].x-h[0].x,
                        T=h[1].y-h[0].y;
                    return Math.abs(h[0].x-D)<V&&Math.abs(h[1].x-D)<V&&Math.abs(T)>3*Math.abs(k)&&b.settings.showYAxis?"y"
                        :Math.abs(h[0].y-S)<V&&Math.abs(h[1].y-S)<V&&Math.abs(k)>3*Math.abs(T)&&b.settings.showXAxis?"x"
                        :"both"
                }
            },
            a=h=>(
                this.grapher.scaleAxis||(
                    this.grapher.scaleAxis=s(h)
                ),
                this.grapher.scaleAxis
            ),
            l=()=>{
                this.grapher.scaleAxis&&(
                    this.grapher.scaleAxis=void 0,
                    this.controller.requestRedrawGraph(),
                    this.updateCursor()
                )
            },
            c=()=>{
                this.isScalingEnabled=!1,
                this.preventScrollZoom=!0,
                l()
            },
            u=h=>h.altKey||h.ctrlKey||h.metaKey,
            p=h=>{
                if(t&&!this.isViewportLocked()){
                    var b=r3(h.touches,Ul(this.elt));
                    if(e.length===2&&b.length===2)
                        a(b),
                        this.applyScaleTouchChanges(e,b);
                    else if(e.length===1&&this.isScalingEnabled){
                        this.updateMouse(h);
                        var C=this.grapher.scaleAxis,
                            D=this.getProjection(),
                            S=D.mathToPixels.mapPoint(Pc(0,0)),
                            V,
                            k,
                            T=5,
                            A=i?1:-1,
                            R=n?1:-1;
                        if((C==="x"||C==="both")&&(V=this.mousePt.x>S.x+T*A),
                                (C==="y"||C==="both")&&(k=this.mousePt.y>S.y+T*R),
                                C==="x"&&i!==V||C==="y"&&n!==k||C==="both"&&i!==V&&n!==k)
                            return;
                        this.applyScaleTouchChanges(e,b)
                    }else
                        l();
                    e.length===1&&this.applyPanTouchChanges(e,b),
                    this.controller.dispatch({type:"grapher/drag-move"}),
                    e=b
                }
            },
            g=h=>{
                t&&(
                    this.cancelAnimation(),
                    e=r3(h.touches,Ul(this.elt)),
                    h.touches.length===0&&(
                        t=!1,
                        this.grapher.isDragging=!1,
                        O(document).off(".graphdrag"),
                        this.grapher.debounceUserRequestedViewportChange(),
                        this.controller.dispatch({type:"grapher/drag-end"})
                    ),
                    (h.touches.length===0||h.touches.length===1&&!this.isScalingEnabled)&&l()
                )
            };
        O(window).on("keydown.viewportcontroller-"+this.id,h=>{
            this.controller.isGeoToolActive()||this.isViewportLocked()||(Re(h)===pb&&!u(h)&&this.shouldAllowShiftScaling()?(
                this.isScalingEnabled=!0,
                this.grapher.scaleAxis||this.updateScaleAxis()
            ):c())
        }),
        O(window).on("keyup.viewportcontroller-"+this.id+" blur.viewportcontroller-"+this.id,c)
    }
    shouldAllowShiftScaling(){
        return!this.controller.isGeometry()
    }
    zoom(e){
        var t=this.getProjection().pixelCoordinates;
        if(e==="in"){
            let n=this.getTransformedViewport(Dl.scaleAtPoint(i3(t),2));
            this.tooSmall(n)||this.animateToViewport(n),
            xe(this.s("graphing-calculator-narration-viewport-zoom-in"))
        }else if(e==="out"){
            let n=this.getTransformedViewport(Dl.scaleAtPoint(i3(t),.5));
            this.tooBig(n)||this.animateToViewport(n),
            xe(this.s("graphing-calculator-narration-viewport-zoom-out"))
        }else if(e==="square"){
            var i=this.getSquareViewport();
            this.getProjection().settings.setProperty("squareAxes",!0),
            this.animateToViewport(i),
            xe(this.s("graphing-calculator-narration-viewport-zoom-square"))
        }else
            e==="default"&&this.setDefaultViewport()
    }
    tooBig(e){
        let t=this.getProjection(),
            {xAxisScale:i,yAxisScale:n}=t.settings,
            {xmin:o,xmax:s,ymin:a,ymax:l}=e;
        return i==="logarithmic"&&pE(s)-pE(o)>60||n==="logarithmic"&&pE(l)-pE(a)>60||this.controller.isGeometry()&&s-o>1e5
    }
    tooSmall(e){
        let{xmin:t,xmax:i}=e;
        return this.controller.isGeometry()&&i-t<1e-4
    }
    zoomSquareImmediately(){
        this.setViewport(this.getSquareViewport())
    }
    zoomCustom(e){
        this.animateToViewport(e),
        xe(this.s("graphing-calculator-narration-viewport-updated"))
    }
    setDefaultViewport(){
        let e=this.controller.getDefaultViewport();
        this.animateToViewport(e),
        xe(this.s("graphing-calculator-narration-viewport-default"))
    }
    isDefaultViewportRestored(){
        let e=this.getProjection(),
            {xAxisScale:t,yAxisScale:i}=e.settings,
            n=t==="linear",
            o=i==="linear",
            s=e.viewport,
            a=this.controller.getDefaultViewport(),
            l=n?s.xmax-s.xmin:Math.log(s.xmax/s.xmin),
            c=o?s.ymax-s.ymin:Math.log(s.ymax/s.ymin),
            u=n?s.xmin-a.xmin:Math.log(s.xmin/a.xmin),
            p=n?s.xmax-a.xmax:Math.log(s.xmax/a.xmax),
            g=o?s.ymin-a.ymin:Math.log(s.ymin/a.ymin),
            h=o?s.ymax-a.ymax:Math.log(s.ymax/a.ymax),
            b=.025;
        return Math.abs(u/l)<b&&Math.abs(p/l)<b&&Math.abs(g/c)<b&&Math.abs(h/c)<b
    }
    getSquareViewport(){
        let e=this.getProjection();
        return e.settings.lastChangedAxis==="y"?e.viewport.squareXAxis(e.screen,e.settings):e.viewport.squareYAxis(e.screen,e.settings)
    }
};
var Ow=__dcg_shared_module_exports__['h'](X());
ct();
var Ld=class{
    constructor(e,t){
        this.width=e,
        this.height=t
    }
};
var gE=class{
    constructor(e,t){
        this.color="#000000",
        this.style="normal",
        this.showPOI=!1,
        this.showHighlight=!1,
        this.selected=!1,
        this.tokenHovered=!1,
        this.tokenSelected=!1,
        this.labels=[],
        this.id=e,
        this.branches=t!==void 0?t:[],
        this.getPOI().forEach(i=>{
            i.type===1008&&this.labels.push({type:"poi",poi:i})
        }),
        t.forEach((i,n)=>{
            if(i.graphMode===22){
                if(i.objectType===17){
                    let o=new Su(0,0,1008,this,n,0,!1);
                    this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"segment",poi:o,segments:i.segments[0],text:i.labels&&i.labels[0]||""})
                }else if(i.objectType===16){
                    let o=new Su(0,0,1008,this,n,0,!1);
                    this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"polygon",poi:o,segments:i.segments[0],text:i.labels&&i.labels[0]||""})
                }else if(i.objectType===23){
                    let o=new Su(0,0,1008,this,n,0,!1);
                    this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"angle",poi:o,segments:i.segments[0],text:i.labels&&i.labels[0]||""})
                }
            }
        })
    }
    getPOI(){
        if(this.__cachedPOI)
            return this.__cachedPOI;
        this.__cachedPOI=[],
        this.__cachedPOIIds={};
        for(let e=0;e<this.branches.length;e++){
            let t=this.branches[e];
            if(t.graphMode===1||t.graphMode===2){
                let i=t.poi;
                i.zeros&&this._pushPOI(i.zeros,e,1002),
                i.intercept&&this._pushPOI(i.intercept,e,1003),
                i.extrema&&this._pushPOI(i.extrema,e,1004),
                i.intersections&&this._pushPOI(i.intersections,e,1001)
            }else if(t.graphMode===3||t.graphMode===4){
                let i=t.poi,
                    n=t.graphMode===3&&t.interactiveLabel===!0;
                if(t.showLabel===!0||n){
                    let o=t.nakedLabel;
                    i.defined&&this._pushPOI(i.defined,e,1008,o)
                }else
                    i.defined&&this._pushPOI(i.defined,e,1006)
            }
        }
        return this.__cachedPOI
    }
    getBranchPOI(e){return this.getPOI().filter(t=>t.branch===e)}getMovablePoints(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];let e=this.branches[0];if(e&&e.segments.length===1&&e.graphMode===4){let t=e.segments[0];for(let i=0;i<t.length;i++){let n;e.tableId&&(n={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[i].index,dragX:e.movablePointInfo[i].dragX,dragY:e.movablePointInfo[i].dragY});let o=e.scaleFactors?e.scaleFactors[0][i]:void 0,s=n?n.rowIndex:i,a=e.segments.length===1&&e.labels&&e.labels[i]?e.labels[i]:void 0,l=e.hasOwnProperty("pointOpacity")?e.pointOpacity:1;this.__cachedMovablePoints.push({type:"movable-point",id:"movable:["+this.id+","+s+"]",listIndex:s,sketch:this,color:this.color,pointOpacity:l,tableInfo:n,scaleFactor:o,x:t[i][0],y:t[i][1],label:a,ariaLabel:a&&Vs(a)})}}return this.__cachedMovablePoints}getMovablePointByIndex(e){return this.getMovablePoints()[e]}getStaticLabeledPoints(){if(this.__cachedStaticLabeledPoints)return this.__cachedStaticLabeledPoints;let e=this.branches[0];return this.__cachedStaticLabeledPoints=[],this.getPOI().forEach(t=>{if(t.type!==1006&&t.type!==1008||e.graphMode!==3)return;var i=e.showLabel;let n=t.getLabel();!i&&n===""||this.__cachedStaticLabeledPoints.push({type:"static-labeled-point",id:"static["+this.id+","+t.id+"]",listIndex:t.pointIdxOnBranch,x:t.x,y:t.y,sketch:t.sketch,label:n,ariaLabel:n!==""?Vs(n):void 0})}),this.__cachedStaticLabeledPoints}_pushPOI(e,t,i,n=!1){for(let o=0,s=e.x.length;o<s;o++){let a=new Su(e.x[o],e.y[o],i,this,t,o,n);e.intersects&&(a.intersects=e.intersects[o]),this.__cachedPOI.push(a),this.__cachedPOIIds[a.id]=a}}updateIntersections(e){for(let i=0,n=this.branches.length;i<n;i++){let o=this.branches[i];o.graphMode!==15&&o.graphMode!==22&&(o.poi.intersections=e[i])}let t=this.__cachedPOI;this.__cachedPOI=[],t.forEach(i=>{i.type!==1001?this.__cachedPOI.push(i):delete this.__cachedPOIIds[i.id]});for(let i=0;i<this.branches.length;i++){let n=this.branches[i];if(n.graphMode===1||n.graphMode===2){let o=n.poi;o.intersections&&this._pushPOI(o.intersections,i,1001)}}}getPOIById(e){return this.__cachedPOIIds[e]}updateFrom(e){if(!e)return;this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.selected=e.selected,this.tokenSelected=e.tokenSelected,this.tokenHovered=e.tokenHovered;let t=this.branches[0].graphMode;if(t===3||t===4){let i=!0;for(let n=0;n<this.__cachedPOI.length;n++){let o=e.__cachedPOI[n],s=this.__cachedPOI[n];if(!o||o.type!==s.type){i=!1;break}}if(i)for(let n=0;n<this.__cachedPOI.length;n++){let o=e.__cachedPOI[n],s=this.__cachedPOI[n];delete this.__cachedPOIIds[s.id],this.__cachedPOIIds[o.id]=s,s.id=o.id}}}};var aW={};__dcg_shared_module_exports__['g'](aW,{default:()=>uA});var uA=__dcg_shared_module_exports__['i']("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==");zl();var Ef=.075,pA=.0015,cW=125,dW=330,uW=2e3,gA=class{suspend(){return new Promise((e,t)=>{if(this.audioContext)this.audioContext.suspend().then(()=>{e()}).catch(i=>{Yo(i),t(i)});else{e();return}})}getResumedAudioContext(){return new Promise((e,t)=>{if(!this.audioContext){let i=window.AudioContext||window.webkitAudioContext;if(!i){t();return}try{this.audioContext=new i({latencyHint:"interactive",sampleRate:44100})}catch(n){Yo(n),t(n)}}this.audioContext&&(this.audioContext.state==="running"?this.loadPOI().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}):this.audioContext.resume().then(()=>this.loadPOI()).then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(i=>{Yo(i),t(i)}))})}loadPOI(){return new Promise((e,t)=>{if(!this.audioContext){t();return}if(this.poiBuffer){e();return}this.audioContext.decodeAudioData(uA.buffer.slice(0)).then(i=>{this.poiBuffer=i,e()}).catch(i=>{Yo(i),t()})})}},vw=class{constructor({controller:e,audioPointMove:t,animationFinished:i,audioEnabled:n}){this.controller=e,this.audioSpeed=50,this.audioVolume=.5,this.audioPointMove=t,this.animationFinished=i,this.audioEnabled=n,this.audioContextManager=new gA}releaseAudio(){this.playbackSupported&&(this.stop(),this.audioContextManager.suspend())}prepareAudio(){this.audioContextManager.getResumedAudioContext().then(()=>{this.playbackSupported=!0}).catch(()=>{this.playbackSupported=!1})}stop(){this.playTimeout&&(cancelAnimationFrame(this.playTimeout),this.playTimeout=void 0),this.bufferSource&&(this.bufferSource.stop(),this.bufferSource.disconnect(),this.bufferSource=void 0),this.animationFinished()}isAnimating(){return this.playTimeout!==void 0}getAudioSpeed(){return this.audioSpeed}setAudioSpeed(e){this.audioSpeed=e}getAudioVolume(){return this.audioVolume}setAudioVolume(e){this.audioVolume=e,this.gainMaster!==void 0&&(this.gainMaster.gain.value=this.audioVolume)}getPlaybackSupported(){return this.playbackSupported}playBranchByIndex(e,t,i){!this.audioEnabled()||t<0||t>=e.branches.length||this.isAnimating()||_c(e.branches[t])&&this.playBranch(e.branches[t],t,i).then(()=>{this.stop()})}playSketch(e,t){if(!this.audioEnabled())return;let i=e.branches;if(i.length===0)return;let n=-1,o=()=>{for(n+=1;n<i.length&&!_c(i[n]);)n+=1;n<i.length?this.playBranch(i[n],n,t).then(()=>{o()}):this.stop()};o()}playPoint(e,t){!this.audioEnabled()||!fW(e)||this.audioContextManager.getResumedAudioContext().then(i=>{let{audioContext:n,poiBuffer:o}=i,s=n.sampleRate,a=s*Ef,l=n.createBuffer(2,a,s),c=this.audioSpeed/10;wW(l,e,t,c,o),this.connectBuffer(l,n)})}connectBuffer(e,t){if(!this.audioEnabled()||!t)return;this.gainMaster=t.createGain(),this.gainMaster.connect(t.destination),this.gainMaster.gain.value=this.audioVolume;let i=t.createBufferSource();this.bufferSource=i,i.buffer=e,i.connect(this.gainMaster),i.start()}playBranch(e,t,i){return new Promise((n,o)=>{if(!this.audioEnabled()){o();return}this.audioContextManager.getResumedAudioContext().then(s=>{let{viewport:a}=i,{audioContext:l,poiBuffer:c}=s,u=this.audioSpeed/10,p=CW(e,i);if(!p.segments.length){o();return}let g=l3(a,p.graphMode),h=c3(p),b=p.graphMode===1?i.settings.yAxisScale:i.settings.xAxisScale,C=p.graphMode===1?i.settings.xAxisScale:i.settings.yAxisScale,D=__dcg_shared_module_exports__['sc'](b,[g.independentMin,g.independentMax],[0,u]),S=__dcg_shared_module_exports__['tc'](D,h.independentMax)-__dcg_shared_module_exports__['tc'](D,h.independentMin);if(p.discrete&&(S+=Ef),!isFinite(S)){o();return}let V=l.sampleRate,k=Math.floor(V*S),T=l.createBuffer(2,k,V);d3(T,p,i,b,C,u,c),this.connectBuffer(T,l);let A=l.currentTime,R=()=>{if(this.playTimeout!==void 0&&cancelAnimationFrame(this.playTimeout),l.state!=="running"){o();return}let W=l.currentTime-A,H=__dcg_shared_module_exports__['uc'](b,h.independentMin,h.independentMax,W/S);if(this.audioPointMove(t,H),W<S)this.playTimeout=requestAnimationFrame(R);else{n();return}};R(),this.controller.dispatch({type:"render"})}).catch(()=>{o()})})}};function pW(){return{amplitude:0,phase:0,noiseVal:0,lowerOctaveGain:0,upperOctaveGain:0}}function n3(r,e){let t=e;return r===1&&(t=.5),isFinite(t)||(t=.5),t=Math.max(Math.min(t,1),0),{left:Math.cos(Math.PI/2*t),right:Math.sin(Math.PI/2*t)}}function hW(r,{independent:e,dependent:t},i,n,o){let{phase:s,noiseVal:a,lowerOctaveGain:l,upperOctaveGain:c}=r,u=0,p=0,g=0;return isFinite(i)?(s+=i/n,o<4*pA?(p=0,g=0):(p=.5,g=e>=0?.15:0),t<0&&(a=s3(a),u+=.1*a)):(a=s3(a),u+=.04*a),l+=(p-l)/(n*pA),c+=(g-c)/(n*pA),u+=l*o3(s)+c*o3(2*s),{amplitude:u,phase:s,noiseVal:a,lowerOctaveGain:l,upperOctaveGain:c}}function gW(r){return Math.min(Math.max(dW*Math.pow(2,r),cW),uW)}function o3(r){return .8782*(hA(r)+.25*hA(2*r)+.25*hA(3*r))}function hA(r){return Math.sin(2*Math.PI*r)}function s3(r){let e=Math.random()*2-1;return(r+.2*e)/1.02}function mW(r,e,t,i){let n=r.getChannelData(0),o=e.getChannelData(0),s=e.getChannelData(1);for(let a=0;a<n.length&&a+t<o.length;a++)o[a+t]+=n[a]*i.left,s[a+t]+=n[a]*i.right}function Wl(r,e){if(r.isGeoUIActive()&&r.getAllToolPreviewItems().filter(i=>i.id===e.id).length>0)return!1;for(let t of e.branches)if(_c(t))return!0;return!1}function _c(r){switch(r.graphMode){case 1:case 2:case 3:case 4:return r.segments.length>0;default:return!1}}function a3(r){for(let e=0;e<r.branches.length;e++)if(_c(r.branches[e]))return e;return 0}function Cw(r,e){let t=0;for(let i=0;i<=e;i++)_c(r.branches[i])&&(t+=1);return t}function fW(r){switch(r.graphMode){case 1:case 2:case 3:case 4:return!0;default:return!1}}function l3(r,e){switch(e){case 2:case 3:case 4:return{independentMin:r.xmin,independentMax:r.xmax,dependentMin:r.ymin,dependentMax:r.ymax};case 1:return{independentMin:r.ymin,independentMax:r.ymax,dependentMin:r.xmin,dependentMax:r.xmax};default:throw mA(e)}}function c3(r){let e=r.clippedSegments[0],t=r.clippedSegments[r.clippedSegments.length-1],i=e[0],n=t[t.length-2];return{independentMin:i,independentMax:n}}function yW(r){switch(r.graphMode){case 2:case 3:case 4:return{independent:r.x,dependent:r.y};case 1:return{independent:r.y,dependent:r.x};default:throw mA(r.graphMode)}}function bW(r,e){if(r===1)return e.y;if(r===2)return e.x;throw mA(r)}function mA(r){return`Unexpected graph mode. Received ${r}`}function d3(r,e,t,i,n,o,s){let{viewport:a}=t,l=r.sampleRate,c=r.getChannelData(0),u=r.getChannelData(1),p=e.graphMode,g=l3(a,p),h=c3(e),b=0,C=0,D=c.length-1,S=pW(),V=__dcg_shared_module_exports__['sc'](i,[g.independentMin,g.independentMax],[0,o]);function k(R,P){return __dcg_shared_module_exports__['tc'](V,P)-__dcg_shared_module_exports__['tc'](V,R)}let T=__dcg_shared_module_exports__['sc'](n,[g.dependentMin,g.dependentMax],[0,1]),A=__dcg_shared_module_exports__['sc'](i,[g.independentMin,g.independentMax],[0,1]);for(let R=0;R<c.length;R++){let P;if(e.discrete){let B=Ef*l;P=(R-B/2)/(D-B)}else P=R/D;let W;P<0?W=h.independentMin:P>1?W=h.independentMax:W=__dcg_shared_module_exports__['uc'](i,h.independentMin,h.independentMax,P);let H=n3(p,__dcg_shared_module_exports__['tc'](A,W));for(;b<e.segments.length&&e.segments[b][C]<W;)C+=2,C>=e.segments[b].length&&(b+=1,C=0);let j=e.segments[b],ne=NaN,le=(D-R)/l;if(j&&C+1<j.length){let B=+j[C-2],q=+j[C-1],M=+j[C],ae=+j[C+1],se=k(B,W),ge=k(W,M);if(e.discrete)se<ge?se<Ef/2&&(W=B,ne=q,le=Math.min(le,Ef/2-se)):ge<Ef/2&&(W=M,ne=ae);else if(j.length>2&&C-2>=0&&C+1<j.length){let he=j[j.length-2];le=Math.min(le,k(W,he));let ye=k(B,M);ne=__dcg_shared_module_exports__['uc'](n,q,ae,se/ye)}}let w=NaN;g.dependentMin<=ne&&ne<=g.dependentMax&&(w=gW(__dcg_shared_module_exports__['tc'](T,ne))),S=hW(S,{independent:W,dependent:ne},w,l,le),c[R]+=S.amplitude*H.left,u[R]+=S.amplitude*H.right}if(s&&e.poi&&e.poi.intersections){let R=bW(e.graphMode,e.poi.intersections);for(let P of R){let W=k(h.independentMin,h.independentMax),H=k(h.independentMin,P),j=Math.round(H/W*D);mW(s,r,j,n3(p,__dcg_shared_module_exports__['tc'](A,P)))}}}function wW(r,e,t,i,n){let o=DW(e),s=e.graphMode===1?t.settings.yAxisScale:t.settings.xAxisScale,a=e.graphMode===1?t.settings.xAxisScale:t.settings.yAxisScale;d3(r,o,t,s,a,i,n)}function xW(r,e){return r[0]-e[0]}function vW(r,e,t){let i=bu(r,e.mathToPixels,t),n=xS(i,{xmin:0,xmax:e.screen.width,ymin:0,ymax:e.screen.height}),o=e.pixelsToMath;return t===rw&&(o=new __dcg_shared_module_exports__['xc'](o.yScale,o.xScale)),bu(n,o,t)}function CW(r,e){switch(r.graphMode){case 2:case 1:{let t=[];for(let i of r.segments){let n=r.graphMode===2?nf:rw,o=vW(i,e,n);o.length>2&&t.push(o)}return{graphMode:r.graphMode,discrete:!1,segments:r.segments,clippedSegments:t,poi:r.poi}}case 3:case 4:{let{viewport:t}=e,i=r.segments[0].slice();i.sort(xW);let n=[],o=[];for(let s of i)n.push(s[0],s[1]),s[0]>=t.xmin&&s[1]<=t.xmax&&s[1]>=t.ymin&&s[1]<=t.ymax&&o.push(s[0],s[1]);return{graphMode:2,discrete:!0,segments:[n],clippedSegments:[o],poi:void 0}}default:throw new Error(`Unimplemented graph mode: ${r.graphMode}`)}}function DW(r){let{independent:e,dependent:t}=yW(r),i=[e,t],o={graphMode:r.graphMode===1?1:2,discrete:!0,segments:[i],clippedSegments:[i]};return r.intersects!==void 0&&(o.poi={intersections:{x:[r.x],y:[r.y]}}),o}function SW(r,e,t){return{x:r.x,y:r.y,branch:r.branch,reportedBranch:t,type:r.type,graphMode:e,intersects:r.intersects}}var kf=101,Dw=class{constructor(e,t,i){this.grapher=i,this.controller=e,this.audiograph=t,this.reset()}reset(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0}resetToFirstBranch(){let e=this.getCurrentSketch();this.branch=e?a3(e):0}getBranchPoints(e){let t=[];if(e>=0)for(let i of this.getSampledPoints())i.branch===e&&t.push(i);return t}resetTracePoint(){this.drawTrace(this.getCurrentPoint())}drawTrace(e){let t=this.getCurrentSketch();if(!e||!t)return;let i=t.branches[this.branch];if(!i||i.graphMode===3)return;let o={x:e.x,y:e.y},s={branchInfo:{branch:e.branch,id:t.id,sketch:t},pt:o};__dcg_shared_module_exports__['G'](s,this.grapher.traceLayer.getTraceInfo())||(this.grapher.traceLayer.setTraceInfo(s),this.controller.requestRedrawGraph())}moveToOrigin(){let e=this.getCurrentSketch();if(!e||!Wl(this.controller,e))return;let t=e.branches[this.branch];if(!_c(t))return;let i=t.graphMode;if(i===2)this.setIndependent("x",0);else if(i===1)this.setIndependent("y",0);else if(i===3){let n=this.getSortedPOI()[0];this.setIndependent("x",n?n.x:0)}}getCurrentSketch(){let e,t=this.getSelectedItem();if(t){let i=this.audiograph.getFocusedCell();if(t.type==="table"){if(i&&(e=this.getGraphSketchForTableCell(t,i)),!e){for(let n of t.columnModels)if(e=this.grapher.getGraphSketch(n.id),e!==void 0)break}}else e=this.grapher.getGraphSketch(t.id)}return e}getFirstTraceableSketch(e){let t,i=this.controller.getItemCount(),n=this.controller.shouldAudioTraceReverseExpressions();for(let o=0;o<i;o++){let s=n?i-1-o:o,a=this.controller.getItemModelByIndex(s);if(a&&this.canTrace(a)){let l=n?this.prevTableColumn(a):this.nextTableColumn(a);if(l?(this.audiograph.setFocusedCell(l),t=this.getGraphSketchForTableCell(a,l)):t=this.grapher.getGraphSketch(a.id),t){e&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:s});break}}}return t}canTrace(e){if(e.type==="image")return!1;if("shouldGraph"in e){let t=this.grapher.getGraphSketch(e.id);return t?Wl(this.controller,t):!1}return!1}getTraceableExpressionCount(){let e=0,t=this.controller.getItemCount();for(let i=0;i<t;i++){let n=this.controller.getItemModelByIndex(i);n&&this.canTrace(n)&&e++}return e}computeStepSizes(){let e=this.grapher.getProjection().viewport;if(!e)return;let t=e.xmin,i=e.xmax,n=e.ymin,o=e.ymax,s=this.getCurrentSketch();if(!s||!Wl(this.controller,s))return;let a=s.branches[this.branch];if(!_c(a))return;let l=a.graphMode;if(l===2)this.independent<t?this.independent=t:this.independent>i&&(this.independent=i);else if(l===1)this.independent<n?this.independent=n:this.independent>o&&(this.independent=o);else if(l===3){let c,u;this.independent<t?(u=this.getSortedPOI()[0],this.independent=u&&u.x!==void 0?u.x:0):this.independent>i&&(c=this.getSortedPOI(),u=c[c.length-1],this.independent=u&&u.x!==void 0?u.x:0)}}getPoint(e,t){let i,n=this.getCurrentSketch();if(!n||!Wl(this.controller,n))return i;let o,s,a,l=0,c=n.branches[e];if(!c)return;let u=Cw(n,e);"compiled"in c&&c.compiled&&(a=c.compiled.fn),s=c.graphMode;let p=this.grapher.getProjection(),{mathToPixels:g,pixelsToMath:h,screen:b}=p;if(s===2){let C=h.mapX(g.mapX(t)+b.width/(kf-1));o=this.getInterveningPOIs(t,C,e,s)[0],(!o||o.x!==t||o.branch!==e)&&(o=void 0,l=a?a(t):0),o?i={x:o.x,y:o.y,type:o.type,typeChain:o.typeChain,branch:o.branch,reportedBranch:u,graphMode:s,intersects:o.intersects}:a&&(i={x:t,y:l,branch:e,reportedBranch:u,graphMode:s})}else if(s===1){let C=h.mapY(g.mapY(t)-b.height/(kf-1));o=this.getInterveningPOIs(t,C,e,s)[0],(!o||o.y!==t||o.branch!==e)&&(o=void 0,l=a?a(t):0),o?i={x:o.x,y:o.y,type:o.type,typeChain:o.typeChain,branch:o.branch,reportedBranch:u,graphMode:s,intersects:o.intersects}:a&&(i={y:t,x:l,branch:e,reportedBranch:u,graphMode:s})}else if(s===3){let C=h.mapX(g.mapX(t)+b.width/(kf-1));o=this.getInterveningPOIs(t,C,e,s)[0],o&&o.x===t&&o.branch===e?i={x:o.x,y:o.y,type:o.type,typeChain:o.typeChain,branch:o.branch,reportedBranch:u,graphMode:s,intersects:o.intersects}:i={x:t,y:NaN,branch:e,reportedBranch:u,graphMode:s}}return i}getSampledPoints(){return this.sampledPoints.length===0&&this.updateSampledPoints(),this.sampledPoints}updateSampledPoints(){let e=this.getCurrentSketch();if(!e||!Wl(this.controller,e))return;let t=[],i=this.grapher.getProjection(),n=i.viewport;for(let o=0;o<e.branches.length;o++){let s=e.branches[o];if(!_c(s))continue;let a=s.graphMode,l=0,c=0,u=[],p;if(a===2||a===3)l=n.xmin,c=n.xmax,p=(g,h,b)=>i.mathToPixels.interpolateX(g,h,b);else if(a===1)l=n.ymin,c=n.ymax,p=(g,h,b)=>i.mathToPixels.interpolateY(g,h,b);else continue;for(let g=0;g<kf;g++){let h=p(l,c,g/(kf-1)),b=__dcg_shared_module_exports__['Cb'](h).value,C=p(l,c,(g+1)/(kf-1)),D=__dcg_shared_module_exports__['Cb'](C).value,S=this.getInterveningPOIs(b,D,o,a);if(S.length>0)u.push.apply(u,S);else{let V=this.getPoint(o,b);V&&u.push(V)}}t.push.apply(t,this.removeDuplicates(u,a))}this.sampledPoints=t}getCurrentPoint(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint}updateCurrentPoint(e){if(e){this.currentPoint=e;let t=e.graphMode;t===2||t===3?this.independent=e.x!==void 0?e.x:0:t===1&&(this.independent=e.y!==void 0?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)}prevPoint(){this.moveToPoint(-1)}nextPoint(){this.moveToPoint(1)}firstPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[0])}lastPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[e.length-1])}moveToPoint(e){let t=this.getCurrentPoint();if(!t)return;if(t.graphMode===3){this.moveToPOI(e);return}let i=this.getSampledPoints(),n=this.getClosestPointIndexOnSameBranch(i,t);if(n!==-1){let o=n+e;o<=0?(o=0,Ht(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))):o>=i.length-1&&(o=i.length-1,Ht(this.controller.s("graphing-calculator-narration-audio-trace-last-point")));let s=i[o];this.updateCurrentPoint(s)}}canMoveToPrevPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToPrevPOI();let t=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(t,e);return i!==-1&&i>0}canMoveToNextPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToNextPOI();let t=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(t,e);return i!==-1&&i<t.length-1}prevPOI(){this.moveToPOI(-1)}nextPOI(){this.moveToPOI(1)}getSortedPOI(){return(!this.pois||this.pois.length===0)&&this.updatePOI(),this.pois}updatePOI(){let e=[],t,i=[],n=this.getCurrentSketch();if(!(!n||!Wl(this.controller,n))){for(let o=0;o<n.branches.length;o++){let s=n.branches[o];if(!s)continue;let a=Cw(n,o),l=s.graphMode;if(i=[],t=n.getBranchPOI(o),t.length>0){l===2||l===3?i=__dcg_shared_module_exports__['v'](t,"x"):l===1&&(i=__dcg_shared_module_exports__['v'](t,"y"));let c=[];for(let u of i)c.push(SW(u,l,a));e.push.apply(e,this.removeDuplicates(c,l))}}this.pois=e}}removeDuplicates(e,t){let i=[];for(let n of e){if(n=__dcg_shared_module_exports__['a']({},n),n.graphMode=t,i.length===0){i.push(n);continue}let o=i[i.length-1];__dcg_shared_module_exports__['Cb'](o.x).value===__dcg_shared_module_exports__['Cb'](n.x).value&&__dcg_shared_module_exports__['Cb'](o.y).value===__dcg_shared_module_exports__['Cb'](n.y).value&&o.branch===n.branch?(o.typeChain||(o.typeChain=o.type!==void 0?[o.type]:[]),n.type!==void 0&&o.typeChain.indexOf(n.type)===-1&&o.typeChain.push(n.type),n.type===1001&&n.intersects&&o.intersects===void 0&&(o.intersects=n.intersects)):i.push(n)}return i}getInterveningPOIs(e,t,i,n){let o=[],s=this.getSortedPOI(),a=NaN;for(let l of s)l&&((n===2||n===3)&&!isNaN(l.x)?a=l.x:n===1&&!isNaN(l.y)&&(a=l.y),l.branch===i&&!isNaN(a)&&(e<=a&&a<t||t<=a&&a<e)&&o.push(l));return e>t?o.reverse():o}setIndependent(e,t){let i=this.getSampledPoints();for(let o of i)if(o&&o.hasOwnProperty(e)&&o[e]===t){if(e==="x"){this.independent=o.x!==void 0?o.x:0,this.updateCurrentPoint();return}else if(e==="y"){this.independent=o.y!==void 0?o.y:0,this.updateCurrentPoint();return}}let n=!0;if(i.length>0){let o=Math.floor((i.length-1)/2),s=i[o];s&&(e==="x"?(this.independent=s.x!==void 0?s.x:0,n=!1):e==="y"&&(this.independent=s.y!==void 0?s.y:0,n=!1))}n&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()}moveToPOI(e){if(!this.getCurrentPoint())return;let i=this.getSampledPoints(),n=this.getPOIIndexByDirection(e);n===-1?Ht(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")):this.updateCurrentPoint(i[n])}getPOIIndexByDirection(e){let t=this.getCurrentPoint();if(!t)return-1;let i=this.getSampledPoints(),n=this.getClosestPointIndexOnSameBranch(i,t),o=-1;if(n!==-1){let s=t.graphMode,a=e===1?i.length-1:0;for(let l=n;l!==a+e;l+=e){let c=i[l];if(((s===2||s===3)&&t.x!==c.x||s===1&&t.y!==c.y)&&c.type!==void 0){o=l;break}}}return o}canMoveToPrevPOI(){return this.getPOIIndexByDirection(-1)!==-1}canMoveToNextPOI(){return this.getPOIIndexByDirection(1)!==-1}getClosestPointIndexOnSameBranch(e,t){let i=-1,n=1/0;if(e.length>0&&t){let o=t.graphMode;for(let s=0;s<e.length;s++){let a=e[s];if(t.branch!==a.branch)continue;let l;o===2||o===3?l=Math.abs(a.x-t.x):l=Math.abs(a.y-t.y),l<n&&(i=s,n=l)}}return i}prevCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveDown():this.curveUp()}nextCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveUp():this.curveDown()}curveUp(){let e=this.getSelectedItem();if(!e)return;let t=this.prevTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{let i=e.index,n=this.findPrevTraceableIndex({index:i,focusTableCell:!0});if(n!==-1){let o=this.controller.getItemModelByIndex(n);o&&this.controller.dispatch({type:"set-selected-id",id:o.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}curveDown(){let e=this.getSelectedItem();if(!e)return;let t=this.nextTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{let i=e.index,n=this.findNextTraceableIndex({index:i,focusTableCell:!0});if(n!==-1){let o=this.controller.getItemModelByIndex(n);o&&this.controller.dispatch({type:"set-selected-id",id:o.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}canMoveToPrevCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}canMoveToNextCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}findPrevTraceableIndex(e){let t=e.index,i;do{t--,i=this.controller.getItemModelByIndex(t);let n=i&&this.prevTableColumn(i);if(n)return e.focusTableCell&&this.audiograph.setFocusedCell(n),t}while(i&&!this.canTrace(i));return i?t:-1}findNextTraceableIndex(e){let t=e.index,i;do{t++,i=this.controller.getItemModelByIndex(t);let n=i&&this.nextTableColumn(i);if(n)return e.focusTableCell&&this.audiograph.setFocusedCell(n),t}while(i&&!this.canTrace(i));return i?t:-1}prevTableColumn(e){return this.tableColumn(e,-1)}nextTableColumn(e){return this.tableColumn(e,1)}tableColumn(e,t){let i;if(e&&e.type==="table"){let n=this.audiograph.getFocusedCell(),o,s,a;t===-1?(o=n?Math.max(n.location.column-1,0):NaN,s=n&&n.tableId===e.id&&!isNaN(o)?o:e.columnModels.length-1,a=0):(o=n?Math.min(n.location.column+1,e.columnModels.length-1):NaN,s=n&&n.tableId===e.id&&!isNaN(o)?o:0,a=e.columnModels.length-1);let l=(a-s)/t;if(isFinite(l)&&l>=0)for(let c=s;c!==a;c+=t){let u=e.columnModels[c];if(u&&this.grapher.getGraphSketch(u.id)){i={tableId:e.id,location:{column:c,row:0}};break}}}return i}getGraphSketchForTableCell(e,t){if(!e||e.type!=="table"||!t)return;let i=e.columnModels[t.location.column];if(i)return this.grapher.getGraphSketch(i.id)}getSelectedItem(){let e=this.controller.getSelectedItem();if(e&&e.type==="folder"){var t=vM(e);return t===void 0?void 0:this.controller.getItemModel(t)}return e}};ct();var Sw=[{speed:200,displayedSpeed:"1/4 x"},{speed:100,displayedSpeed:"1/2 x"},{speed:50,displayedSpeed:"1 x"},{speed:25,displayedSpeed:"2 x"},{speed:12.5,displayedSpeed:"4 x"}],Ew=class{constructor(e,t){this.grapher=t,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new Dw(e,this,this.grapher),this.tonegen=new vw({controller:e,audioPointMove:(i,n)=>{this.agNavigator.drawTrace(this.agNavigator.getPoint(i,n))},animationFinished:()=>{this.recomputePoints(),this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},audioEnabled:()=>this.controller.getAudio()}),this.audioSpeedIndex=2,this.tonegen.releaseAudio()}remove(){}handleKeydown(e){let t=e.altKey||e.metaKey,i=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey,n=e.ctrlKey&&!e.metaKey&&!e.altKey,o=di?n:t,s=o&&(e.which===61||e.which===187),a=o&&!e.shiftKey&&(e.which===173||e.which===189),l=o&&!e.shiftKey&&Di(e)==="0";i&&Di(e)==="S"?this.agNavigator.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeCurve()):i&&Di(e)==="G"?(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeAxes()):i&&Di(e)==="T"?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):s?(e.preventDefault(),e.stopPropagation(),this.zoom("in")):a?(e.preventDefault(),e.stopPropagation(),this.zoom("out")):l?(e.preventDefault(),e.stopPropagation(),this.setDefaultViewport()):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):this.audioTraceKeydown(e))}sliderTraceKeydown(e){let t=e.altKey||e.metaKey,i=!t&&!e.ctrlKey&&!e.shiftKey;i&&Re(e)===hd||Di(e)==="J"?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):i&&Re(e)===gd||Di(e)==="L"?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):i&&Re(e)===pm?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):i&&Re(e)===um?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):!t&&(Re(e)===Eo||!e.shiftKey&&Re(e)===pl||Di(e)==="K")?(e.preventDefault(),e.stopPropagation(),this.nextSlider()):!t&&(Re(e)===So||e.shiftKey&&Re(e)===pl||Di(e)==="I")?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):i&&Re(e)===hp||Di(e)==="U"?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):i&&Re(e)===pp||Di(e)==="N"?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):(this.stopAnimations(),this.audioTraceKeydown(e))}audioTraceKeydown(e){let t=e.altKey||e.metaKey,i=t&&!e.ctrlKey&&!e.shiftKey,n=!t&&!e.ctrlKey&&!e.shiftKey,o=Di(e);if(Re(e)===So&&i)e.preventDefault(),e.stopPropagation(),ho(),this.agNavigator.prevCurve();else if(Re(e)===Eo&&i)e.preventDefault(),e.stopPropagation(),ho(),this.agNavigator.nextCurve();else if(n&&Re(e)===hd||Re(e)===So||o==="J")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"previous-point"});else if(n&&Re(e)===gd||Re(e)===Eo||o==="L")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"next-point"});else if(!t&&(Re(e)===pm||!e.shiftKey&&Re(e)===pl||o==="I"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToNextPOI();else if(!t&&(Re(e)===um||e.shiftKey&&Re(e)===pl||o==="K"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToPrevPOI();else if(n&&Re(e)===hp||o==="U")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToFirstPoint();else if(n&&Re(e)===pp||o==="N")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToLastPoint();else if(n&&o==="X")e.preventDefault(),e.stopPropagation(),this.reportX();else if(n&&o==="P")e.preventDefault(),e.stopPropagation(),this.reportPOICount();else if(n&&o==="Y")e.preventDefault(),e.stopPropagation(),this.reportY();else if(n&&o==="T")e.preventDefault(),e.stopPropagation(),this.reportType();else if(n&&o==="B")e.preventDefault(),e.stopPropagation(),this.reportBranch();else if(n&&o==="O")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToOrigin();else if(n&&o==="H")e.preventDefault(),e.stopPropagation(),this.hearGraph();else if(n&&typeof o=="string"&&o>="0"&&o<="9"){if(e.preventDefault(),e.stopPropagation(),ho(),!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}this.tonegen.stop();let s=this.agNavigator.getCurrentSketch();if(s){let a;e.which===48?a=9:a=e.which-49;let l=a,c=-1;for(let u=0;u<s.branches.length;u++)if(_c(s.branches[u])&&(l-=1),l<0){c=u;break}c>=0?this.tonegen.getPlaybackSupported()?this.tonegen.playBranchByIndex(s,c,this.grapher.getProjection()):xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")):xe(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found",{branch:a+1}))}else xe(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"))}else t&&typeof o=="string"&&o>="1"&&o<="5"?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-audio-trace-speed",speed:parseInt(o,10)-1})):!e.altKey&&!e.ctrlKey&&!e.metaKey&&o==="V"?(e.preventDefault(),e.stopPropagation(),this.controller.getAudio()?e.shiftKey?this.controller.dispatch({type:"keypad/audio-trace",command:"volume-down"}):this.controller.dispatch({type:"keypad/audio-trace",command:"volume-up"}):xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))):n&&o==="A"?(e.preventDefault(),e.stopPropagation(),ho(),this.queueAnimatingPoints(!0),xe()):n&&o==="S"&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):n&&o==="C"?(e.preventDefault(),e.stopPropagation(),this.reportColor()):n&&this.exitAudioTrace();this.controller.dispatch({type:"render"})}describeCurve(){ho();let e=this.agNavigator.getCurrentSketch();if(!e){xe(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"));return}Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-color",{color:zh(this.controller,e.color)}));let t=Cw(e,e.branches.length-1);t>1&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count",{branches:t}));let i=!1,n=!1;for(let s of e.branches)if(t===1&&s.segments.length>0&&s.hasOwnProperty("operator")){if(s.graphMode===2){if(s.operator===">"||s.operator===">="){Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above"));break}else if(s.operator==="<"||s.operator==="<="){Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below"));break}}else if(s.graphMode===1){if(s.operator===">"||s.operator===">="){Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right"));break}else if(s.operator==="<"||s.operator==="<="){Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left"));break}}}else t>1&&(s.graphMode===2||s.graphMode===1?(s.operator==="<"||s.operator==="<="||s.operator===">"||s.operator===">=")&&(i=!0):s.graphMode===7&&(n=!0));i&&n&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions"));let o=e.getPOI();if(o.length>0){let s=[];for(let a of o)s[a.type]===void 0?s[a.type]=1:s[a.type]+=1;s.forEach((a,l)=>{l===1001?Ht(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections",{count:a})):l===1002?Ht(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-root"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots",{count:a})):l===1003?Ht(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts",{count:a})):l===1004?Ht(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema",{count:a})):l===1008&&Ht(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-label"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels",{count:a}))})}xe()}describeAxes(){ho(),xe(this.getAxesDescription())}getAxesDescription(){let{showGrid:e,showXAxis:t,xAxisNumbers:i,showYAxis:n,yAxisNumbers:o,xAxisLabel:s,yAxisLabel:a}=this.grapher.settings,l=this.grapher.getProjection(),c=l.viewport,u=[],p=Hs(__dcg_shared_module_exports__['Cb'](c.xmin,Zh(l,c.xmin)).latex),g=Hs(__dcg_shared_module_exports__['Cb'](c.xmax,Zh(l,c.xmax)).latex),h=Hs(__dcg_shared_module_exports__['Cb'](c.ymin,ZS(l,c.ymin)).latex),b=Hs(__dcg_shared_module_exports__['Cb'](c.ymax,ZS(l,c.ymax)).latex);t&&(i&&s!==""?u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label",{xmin:p,xmax:g,label:s})):i&&s===""?u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range",{xmin:p,xmax:g})):!i&&s!==""?u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label",{label:s})):!i&&s===""&&u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis"))),n&&(o&&a!==""?u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label",{ymin:h,ymax:b,label:a})):o&&a===""?u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range",{ymin:h,ymax:b})):!o&&a!==""?u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label",{label:a})):!o&&a===""&&u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis"))),!t&&!n&&u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-no-visible-axes")),e&&u.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-grid"));let C=this.grapher.graphSketches,D=0;for(let S in C)Wl(this.controller,C[S])&&(D+=1);return u.push(this.controller.s("graphing-calculator-narration-audio-trace-traceable-curves",{sketchCount:new uo(D)})),u.join(" ")}queueCoordinates(e,t,i=!1){if(!this.grapher.getProjection().viewport||!e)return;let o=this.agNavigator.getCurrentSketch();(e.hasOwnProperty("branch")&&o&&o.branches.length>1&&this.lastSpokenBranch!==e.reportedBranch||t==="branch")&&typeof e.reportedBranch=="number"&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number",{branch:e.reportedBranch})),this.lastSpokenBranch=e.reportedBranch?e.reportedBranch:e.branch+1,e.hasOwnProperty("type")&&!t?Ht(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates",{type:this.describePOI(e)})):t==="type"&&Ht(this.describePOI(e)),(!t||t==="x")&&Ht(qi(this.controller,e.x)),(!t||t==="y")&&Ht(zi(this.controller,e.y)),i&&xe()}describePOI(e){if(e.typeChain){let t=[];for(let i=0;i<e.typeChain.length;i++)t.push(this.poiTypeToText(e,i));return t.join(", ")}else return this.poiTypeToText(e)}poiTypeToText(e,t){switch(t&&e.typeChain?e.typeChain[t]:e.type){case 1001:let n=this.getIntersectingCurves(e);return n!==""?this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves",{curves:n}):this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection");case 1002:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root");case 1003:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept");case 1004:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum");case 1006:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition");case 1007:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace");case 1008:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label");default:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi")}}getIntersectingCurves(e){return!e||!e.intersects?"":this.getExpressionAriaLabel(e.intersects)}getExpressionAriaLabel(e){let t=this.controller.getItemModel(e);return t?t.type==="expression"&&t.label?Vs(t.label):t.type==="table"&&this.focusedCell?this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column",{index:t.displayIndex,column:this.focusedCell.location.column+1}):$i(t,"describe"):""}exitAudioTrace(e){if(this.audioTraceActive){if(this.audioTraceActive=!1,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/123"}),e||(e=this.controller.s("graphing-calculator-text-audio-trace-off")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){let t=this.agNavigator.getSelectedItem();(!t||!this.controller.isItemSelectable(t.id))&&(t=this.controller.getFirstFullyVisibleItem()),t&&this.controller.isItemSelectable(t.id)&&this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:t.type==="table"&&this.focusedCell!==void 0?__dcg_shared_module_exports__['a']({location:"cell"},this.focusedCell.location):"end"})}this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.tonegen.stop(),this.tonegen.releaseAudio(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.setTraceInfo(void 0),this.controller.requestRedrawGraph(),xe(e),this.resumeAnimations()}}isFocusInExpressionsView(){return!!this.controller.getFocusedItem()}canAudioTraceCurrentExp(){let e=this.agNavigator.getSelectedItem();return e?e.type==="table"?!!this.agNavigator.getCurrentSketch():this.agNavigator.canTrace(e):!1}enterAudioTrace(e){let t=this.agNavigator.getSelectedItem(),i=t&&t.type!=="table"&&!this.agNavigator.canTrace(t)?this.getExpressionAriaLabel(t.id):void 0,n=!1;this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),t&&i&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression",{expression:i})),n=!!i||!this.wasFocusInExpressionsView);let o;if(n)o=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else if(!i){if(t&&t.type==="expression"&&t.formula&&t.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});if(t&&t.type==="table"){let a=Jo(t);(!this.focusedCell||this.focusedCell.tableId!==t.id||a&&(a.column!==this.focusedCell.location.column||a.row!==this.focusedCell.location.row))&&(this.focusedCell=a!==void 0?{tableId:t.id,location:a}:void 0)}else this.focusedCell=void 0;o=this.agNavigator.getCurrentSketch()}if(!o)return this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});let s=o.branches[0].graphMode;if(s===8)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support")}});if(s===5)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support")}});if(s===6)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-polar-support")}});if(this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.controller.requestRedrawGraph(),!this.audioTraceActive&&(this.controller.isKeypadEnabled()||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-on"),noAria:!0,onHide:()=>this.exitAudioTrace(),hideAfter:0}}),i&&o&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression",{expression:this.getExpressionAriaLabel(o.id)})),Ht(this.controller.s("graphing-calculator-text-audio-trace-on")),this.controller.getAudio()||Ht(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")),this.pauseAnimations(),this.queueAnimatingPoints(!1),this.tonegen.prepareAudio(),(!e||!e.fromKeypad)&&(Ht(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")),this.controller.getAudio()&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")),this.agNavigator.getTraceableExpressionCount()>1&&(di?Ht(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac")):Ht(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows"))),di?Ht(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac")):Ht(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))),this.wasFocusInExpressionsView)){let a=this.controller.findEl(".dcg-graph-outer");a&&(O(a).one("focusin",()=>{setTimeout(()=>{xe()},0)}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}this.agNavigator.moveToOrigin(),Ht(this.getExpressionAriaLabel(o.id)),this.reportAudioTrace({playSound:!1}),this.wasFocusInExpressionsView||xe(),this.audioTraceActive=!0,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/audio"})}checkIfSelectedItemChanged(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(Ht(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),xe()):this.exitAudioTrace()))}pauseAnimations(){this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&(this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1}),this.sliderArray.push(t))})}resumeAnimations(){if(this.sliderArray.length!==0){for(let e=0;e<this.sliderArray.length;e++){let t=this.sliderArray[e];t.slider.isPlaying!==!0&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!0})}this.sliderArray.length=0}}stopAnimations(){this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1})})}getAnimatingVars(){let e=[];for(let t=0;t<this.sliderArray.length;t++)e.push('"'+po(this.sliderArray[t])+'"');return e}hasActiveSliders(){let e=this.controller.getAllModelsWithSliders();for(let t=0;t<e.length;t++)if(e[t].slider.isPlaying)return!0;return!1}queueAnimatingPoints(e){this.sliderArray.length===1?Ht(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")):this.sliderArray.length>1?Ht(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused",{sliders:this.sliderArray.length})):e&&Ht(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused"))}queueSliderLatex(){this.hasActiveSliders()||this.tonegen.stop();let e=this.getSelectedSlider();e?Ht(e.latex):Ht(this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown"))}getSelectedSlider(){let e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null}incrementSliderValue(){this.adjustSlider("up")}decrementSliderValue(){this.adjustSlider("down")}incrementBigSliderValue(){this.adjustSlider("bigup")}decrementBigSliderValue(){this.adjustSlider("bigdown")}nextSlider(){this.adjustSlider("next")}prevSlider(){this.adjustSlider("prev")}sliderMin(){this.adjustSlider("min")}sliderMax(){this.adjustSlider("max")}adjustSlider(e){let t=this.getSelectedSlider();if(!t){Ht(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value"));return}let i=t.latex,n=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:e}),this.queueSliderLatex(),xe();break;case"next":this.sliderIndex++,this.sliderIndex>=n&&(Ht(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")),this.sliderIndex=n-1),this.queueSliderLatex(),xe();return;case"prev":this.sliderIndex--,this.sliderIndex<0&&(Ht(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")),this.sliderIndex=0),this.queueSliderLatex(),xe();return}!t.slider.isPlaying&&i!==t.latex&&(this.queueSliderLatex(),xe())}toggleAudioTrace(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()}toggleSliderTrace(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()}enterSliderTrace(){if(this.sliderTraceActive)return;this.sliderIndex=0,this.controller.getAllModelsWithSliders().length!==0?(Ht(this.controller.s("graphing-calculator-narration-slider-trace-on")),this.queueSliderLatex(),this.sliderTraceActive=!0):(Ht(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")),this.sliderTraceActive=!1),xe()}exitSliderTrace(){this.sliderTraceActive&&(Ht(this.controller.s("graphing-calculator-narration-slider-trace-off")),this.sliderTraceActive=!1,this.sliderIndex=0,xe())}recomputePoints(){this.audioTraceActive&&(this.tonegen.isAnimating()||(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes()))}reportAndMoveToPrevPoint(){ho(),this.agNavigator.prevPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPoint(){ho(),this.agNavigator.nextPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToOrigin(){ho(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToPrevPOI(){ho(),this.agNavigator.prevPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPOI(){ho(),this.agNavigator.nextPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToFirstPoint(){ho(),this.agNavigator.firstPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToLastPoint(){ho(),this.agNavigator.lastPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportX(){ho(),this.reportAudioTrace({propToSpeak:"x",playSound:!1})}reportY(){ho(),this.reportAudioTrace({propToSpeak:"y",playSound:!1})}reportColor(){ho();let e=this.agNavigator.getCurrentSketch();e?Ht(zh(this.controller,e.color)):Ht(this.controller.s("graphing-calculator-narration-color-unknown")),xe()}reportPOICount(){ho();let e=this.agNavigator.getCurrentSketch(),t=e?e.getPOI().length:0;xe(this.controller.s("graphing-calculator-narration-audio-trace-poi-count",{x:t}))}reportType(){ho(),this.reportAudioTrace({propToSpeak:"type",playSound:!1})}reportBranch(){ho(),this.reportAudioTrace({propToSpeak:"branch",playSound:!1})}describePoint(){ho(),this.reportAudioTrace({playSound:!1}),xe()}playCurrentPoint(){let e=this.agNavigator.getCurrentPoint();e&&this.tonegen.playPoint(e,this.grapher.getProjection())}reportAudioTrace(e){let t=this.agNavigator.getCurrentPoint();if(!t)return;let i=e&&e.propToSpeak,n=this.controller.getAudio()&&this.tonegen.getPlaybackSupported()&&(e&&e.playSound!==void 0?e.playSound:!0),o=e&&e.speakCoordinates!==void 0?e.speakCoordinates:!0;this.tonegen.stop(),n&&this.playCurrentPoint(),o&&(this.queueCoordinates(t,i),setTimeout(function(){xe()},i?0:100))}adjustPlaybackSpeed(e){if(!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(e<0||e>=Sw.length)return;this.audioSpeedIndex=e;let t=Sw[e];return this.tonegen.setAudioSpeed(t.speed),xe(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed",{speed:t.displayedSpeed}))}speedUp(){this.adjustPlaybackSpeed(this.audioSpeedIndex+1)}speedDown(){this.adjustPlaybackSpeed(this.audioSpeedIndex-1)}adjustVolume(e){if(ho(),!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}let t=this.tonegen.getAudioVolume(),i=e==="up"?Math.min(100,Math.round((t+.1)*100)):Math.max(0,Math.round((t-.1)*100));this.tonegen.setAudioVolume(i/100),this.playCurrentPoint(),xe(this.controller.s("graphing-calculator-narration-audio-trace-volume",{volume:i}))}zoom(e){this.grapher.viewportController.zoom(e)}setDefaultViewport(){this.grapher.viewportController.setDefaultViewport()}getFocusedCell(){return this.focusedCell}setFocusedCell(e){this.focusedCell=e}getAudioTraceActive(){return this.audioTraceActive}hearGraph(){if(ho(),!this.controller.getAudio()){xe(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(this.tonegen.getPlaybackSupported()){this.tonegen.stop();let e=this.agNavigator.getCurrentSketch();e&&Wl(this.controller,e)?this.tonegen.playSketch(e,this.grapher.getProjection()):xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression"))}else xe(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))}stopGraph(){this.tonegen.getPlaybackSupported()&&this.tonegen.stop()}getAudioSpeedIndex(){return this.audioSpeedIndex}};var _d={};__dcg_shared_module_exports__['g'](_d,{UnicodeBraille:()=>qs,latexToNemeth:()=>Gu,latexToUeb:()=>Iu,nemethToLatex:()=>_A,uebToLatex:()=>FA,version:()=>uj});var E3=Object.defineProperty,EW=Object.getOwnPropertyNames,u3=Object.getOwnPropertySymbols,kW=Object.prototype.hasOwnProperty,GW=Object.prototype.propertyIsEnumerable,p3=(r,e,t)=>e in r?E3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gf=(r,e)=>{for(var t in e||(e={}))kW.call(e,t)&&p3(r,t,e[t]);if(u3)for(var t of u3(e))GW.call(e,t)&&p3(r,t,e[t]);return r},If=(r=>typeof __dcg_shared_module_exports__['c']!="undefined"?__dcg_shared_module_exports__['c']:typeof Proxy!="undefined"?new Proxy(r,{get:(e,t)=>(typeof __dcg_shared_module_exports__['c']!="undefined"?__dcg_shared_module_exports__['c']:e)[t]}):r)(function(r){if(typeof __dcg_shared_module_exports__['c']!="undefined")return __dcg_shared_module_exports__['c'].apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')}),EA=(r,e)=>function(){return e||(0,r[EW(r)[0]])((e={exports:{}}).exports,e),e.exports},kA=(r,e)=>{for(var t in e)E3(r,t,{get:e[t],enumerable:!0})},IW=EA({"generated/latex.jison.js"(r,e){"use strict";var t=function(){var i=function(le,w,B,q){for(B=B||{},q=le.length;q--;B[le[q]]=w);return B},n=[1,13],o=[1,14],s=[1,15],a=[1,16],l=[1,17],c=[1,21],u=[1,18],p=[1,19],g=[1,20],h=[1,22],b=[1,23],C=[1,28],D=[1,30],S=[1,31],V=[1,32],k=[1,33],T=[1,29],A=[5,21,27,38],R=[5,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],P=[5,10,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],W=[5,10,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],H={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,TEXT:25,RADICAL_OPTARG:26,CLOSE_OPTARG:27,RADICAL:28,curly_group:29,greek:30,command:31,SYMBOL:32,DELIMITER:33,DELIMITER_COMMAND:34,GREEK:35,COMMAND:36,"{":37,"}":38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"TEXT",26:"RADICAL_OPTARG",27:"CLOSE_OPTARG",28:"RADICAL",32:"SYMBOL",33:"DELIMITER",34:"DELIMITER_COMMAND",35:"GREEK",36:"COMMAND",37:"{",38:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[30,1],[31,1],[29,3],[29,2]],performAction:function(w,B,q,M,ae,se,ge){var he=se.length-1;switch(ae){case 1:return se[he-1];case 2:return M.group();case 3:this.$=M.group(se[he-2],se[he-1],se[he]);break;case 4:case 6:this.$=M.group(se[he-1],se[he]);break;case 5:case 7:this.$=M.group(se[he]);break;case 8:this.$=M.level({_:M.group(se[he-1]),"^":M.group(se[he])});break;case 9:this.$=M.level({_:M.group(se[he]),"^":M.group(se[he-1])});break;case 10:this.$=M.level({"^":M.group(se[he])});break;case 11:this.$=M.level({_:M.group(se[he])});break;case 12:case 13:this.$=se[he];break;case 14:this.$=M.processPrimes(se[he-1],se[he]);break;case 15:this.$=M.processPrimes(se[he],M.group());break;case 21:this.$=M.group(se[he-3],se[he-2],se[he]);break;case 22:this.$=M.group(se[he-2],se[he]);break;case 23:this.$=M.fraction(M.group(se[he-1]),M.group(se[he]));break;case 24:this.$=M.typeform("operator_name",M.group(se[he]));break;case 25:this.$=M.typeform("mathrm",M.group(se[he]));break;case 26:this.$=M.typeform("text",M.group(se[he]));break;case 27:this.$=M.radical(se[he],M.group(se[he-2]));break;case 28:this.$=M.radical(M.group(se[he]),M.group());break;case 29:case 30:this.$=M.radical(M.group(se[he]));break;case 35:case 36:this.$=M.terminal(se[he]);break;case 37:case 39:this.$=M.command(se[he]);break;case 38:this.$=M.greek(se[he]);break;case 40:this.$=se[he-1];break;case 41:this.$=M.group();break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:n,11:12,12:o,13:s,14:a,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:u,24:p,25:g,26:h,28:b,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{1:[3]},{5:[1,34]},{1:[2,2]},i(A,[2,5],{15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,7:35,19:l,22:c,23:u,24:p,25:g,26:h,28:b,32:C,33:D,34:S,35:V,36:k,37:T}),i(A,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:36,10:n,12:o,13:s,14:a,19:l,22:c,23:u,24:p,25:g,26:h,28:b,32:C,33:D,34:S,35:V,36:k,37:T}),i(R,[2,11],{9:37,12:o,13:s,14:a}),i(R,[2,10],{8:38,10:n}),i(P,[2,16]),i(P,[2,17]),i(P,[2,18]),i(P,[2,19]),i(P,[2,20]),{11:39,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{11:40,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{11:41,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},i(W,[2,15]),{20:42,33:D,34:S},{11:43,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{11:44,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{11:45,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{11:46,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{4:47,6:4,7:5,8:6,9:7,10:n,11:12,12:o,13:s,14:a,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:u,24:p,25:g,26:h,27:[1,48],28:b,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{11:49,17:50,20:25,22:c,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},i(P,[2,31]),i(P,[2,32]),i(P,[2,33]),i(P,[2,34]),i(P,[2,35]),{4:51,6:4,7:5,8:6,9:7,10:n,11:12,12:o,13:s,14:a,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:u,24:p,25:g,26:h,28:b,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T,38:[1,52]},i(P,[2,36]),i(P,[2,37]),i(P,[2,38]),i(P,[2,39]),{1:[2,1]},i(A,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:53,10:n,12:o,13:s,14:a,19:l,22:c,23:u,24:p,25:g,26:h,28:b,32:C,33:D,34:S,35:V,36:k,37:T}),i(A,[2,6]),i(R,[2,8]),i(R,[2,9]),i([5,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],[2,12]),i(W,[2,13]),i(W,[2,14]),{4:54,6:4,7:5,8:6,9:7,10:n,11:12,12:o,13:s,14:a,15:8,16:9,17:10,18:11,19:l,20:25,21:[1,55],22:c,23:u,24:p,25:g,26:h,28:b,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},i(P,[2,24]),i(P,[2,25]),i(P,[2,26]),{11:56,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},{27:[1,57]},{11:58,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},i(P,[2,29]),i(P,[2,30]),{38:[1,59]},i(P,[2,41]),i(A,[2,3]),{21:[1,60]},{20:61,33:D,34:S},i(P,[2,23]),{11:62,20:25,29:24,30:26,31:27,32:C,33:D,34:S,35:V,36:k,37:T},i(P,[2,28]),i(P,[2,40]),{20:63,33:D,34:S},i(P,[2,22]),i(P,[2,27]),i(P,[2,21])],defaultActions:{3:[2,2],34:[2,1]},parseError:function(w,B){if(B.recoverable)this.trace(w);else{var q=new Error(w);throw q.hash=B,q}},parse:function(w){var B=this,q=[0],M=[],ae=[null],se=[],ge=this.table,he="",ye=0,fe=0,Se=0,de=2,Ee=1,U=se.slice.call(arguments,1),ce=Object.create(this.lexer),Oe={yy:{}};for(var Qe in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Qe)&&(Oe.yy[Qe]=this.yy[Qe]);ce.setInput(w,Oe.yy),Oe.yy.lexer=ce,Oe.yy.parser=this,typeof ce.yylloc=="undefined"&&(ce.yylloc={});var Ct=ce.yylloc;se.push(Ct);var Je=ce.options&&ce.options.ranges;typeof Oe.yy.parseError=="function"?this.parseError=Oe.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function tr(Ge){q.length=q.length-2*Ge,ae.length=ae.length-Ge,se.length=se.length-Ge}e:var mr=function(){var Ge;return Ge=ce.lex()||Ee,typeof Ge!="number"&&(Ge=B.symbols_[Ge]||Ge),Ge};for(var we,Xr,xi,Le,Et,lt,dt={},Pt,Ve,ur,Ne;;){if(xi=q[q.length-1],this.defaultActions[xi]?Le=this.defaultActions[xi]:((we===null||typeof we=="undefined")&&(we=mr()),Le=ge[xi]&&ge[xi][we]),typeof Le=="undefined"||!Le.length||!Le[0]){var $t="";Ne=[];for(Pt in ge[xi])this.terminals_[Pt]&&Pt>de&&Ne.push("'"+this.terminals_[Pt]+"'");ce.showPosition?$t="Parse error on line "+(ye+1)+`:
    }
}
`+ce.showPosition()+`
Expecting `+Ne.join(", ")+", got '"+(this.terminals_[we]||we)+"'":$t="Parse error on line "+(ye+1)+": Unexpected "+(we==Ee?"end of input":"'"+(this.terminals_[we]||we)+"'"),this.parseError($t,{text:ce.match,token:this.terminals_[we]||we,line:ce.yylineno,loc:Ct,expected:Ne})}if(Le[0]instanceof Array&&Le.length>1)throw new Error("Parse Error: multiple actions possible at state: "+xi+", token: "+we);switch(Le[0]){case 1:q.push(we),ae.push(ce.yytext),se.push(ce.yylloc),q.push(Le[1]),we=null,Xr?(we=Xr,Xr=null):(fe=ce.yyleng,he=ce.yytext,ye=ce.yylineno,Ct=ce.yylloc,Se>0&&Se--);break;case 2:if(Ve=this.productions_[Le[1]][1],dt.$=ae[ae.length-Ve],dt._$={first_line:se[se.length-(Ve||1)].first_line,last_line:se[se.length-1].last_line,first_column:se[se.length-(Ve||1)].first_column,last_column:se[se.length-1].last_column},Je&&(dt._$.range=[se[se.length-(Ve||1)].range[0],se[se.length-1].range[1]]),lt=this.performAction.apply(dt,[he,fe,ye,Oe.yy,Le[1],ae,se].concat(U)),typeof lt!="undefined")return lt;Ve&&(q=q.slice(0,-1*Ve*2),ae=ae.slice(0,-1*Ve),se=se.slice(0,-1*Ve)),q.push(this.productions_[Le[1]][0]),ae.push(dt.$),se.push(dt._$),ur=ge[q[q.length-2]][q[q.length-1]],q.push(ur);break;case 3:return!0}}return!0}},j=function(){var le={EOF:1,parseError:function(B,q){if(this.yy.parser)this.yy.parser.parseError(B,q);else throw new Error(B)},setInput:function(w,B){return this.yy=B||this.yy||{},this._input=w,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var w=this._input[0];this.yytext+=w,this.yyleng++,this.offset++,this.match+=w,this.matched+=w;var B=w.match(/(?:\r\n?|\n).*/g);return B?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),w},unput:function(w){var B=w.length,q=w.split(/(?:\r\n?|\n)/g);this._input=w+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-B),this.offset-=B;var M=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),q.length-1&&(this.yylineno-=q.length-1);var ae=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:q?(q.length===M.length?this.yylloc.first_column:0)+M[M.length-q.length].length-q[0].length:this.yylloc.first_column-B},this.options.ranges&&(this.yylloc.range=[ae[0],ae[0]+this.yyleng-B]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(w){this.unput(this.match.slice(w))},pastInput:function(){var w=this.matched.substr(0,this.matched.length-this.match.length);return(w.length>20?"...":"")+w.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var w=this.match;return w.length<20&&(w+=this._input.substr(0,20-w.length)),(w.substr(0,20)+(w.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var w=this.pastInput(),B=new Array(w.length+1).join("-");return w+this.upcomingInput()+`
`+B+"^"},test_match:function(w,B){var q,M,ae;if(this.options.backtrack_lexer&&(ae={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ae.yylloc.range=this.yylloc.range.slice(0))),M=w[0].match(/(?:\r\n?|\n).*/g),M&&(this.yylineno+=M.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:M?M[M.length-1].length-M[M.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+w[0].length},this.yytext+=w[0],this.match+=w[0],this.matches=w,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(w[0].length),this.matched+=w[0],q=this.performAction.call(this,this.yy,this,B,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),q)return q;if(this._backtrack){for(var se in ae)this[se]=ae[se];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var w,B,q,M;this._more||(this.yytext="",this.match="");for(var ae=this._currentRules(),se=0;se<ae.length;se++)if(q=this._input.match(this.rules[ae[se]]),q&&(!B||q[0].length>B[0].length)){if(B=q,M=se,this.options.backtrack_lexer){if(w=this.test_match(q,ae[se]),w!==!1)return w;if(this._backtrack){B=!1;continue}else return!1}else if(!this.options.flex)break}return B?(w=this.test_match(B,ae[M]),w!==!1?w:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var B=this.next();return B||this.lex()},begin:function(B){this.conditionStack.push(B)},popState:function(){var B=this.conditionStack.length-1;return B>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(B){return B=this.conditionStack.length-1-Math.abs(B||0),B>=0?this.conditionStack[B]:"INITIAL"},pushState:function(B){this.begin(B)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(B,q,M,ae){var se=ae;switch(M){case 0:break;case 1:return this.begin("optarg"),26;break;case 2:return this.popState(),27;break;case 3:return 23;case 4:return 24;case 5:return 25;case 6:return 28;case 7:return 22;case 8:return 13;case 9:return 14;case 10:return 12;case 11:return 10;case 12:return 19;case 13:return 21;case 14:return 34;case 15:return 33;case 16:return 37;case 17:return 38;case 18:return 32;case 19:return 32;case 20:return 32;case 21:return 35;case 22:return 35;case 23:return 36;case 24:return 32;case 25:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\text))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}};return le}();H.lexer=j;function ne(){this.yy={}}return ne.prototype=H,H.Parser=ne,new ne}();typeof If!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&If.main===e&&r.main(process.argv.slice(1)))}}),k3=EA({"generated/nemeth-to-latex.jison.js"(r,e){"use strict";var t=function(){var i=function(Et,lt,dt,Pt){for(dt=dt||{},Pt=Et.length;Pt--;dt[Et[Pt]]=lt);return dt},n=[1,11],o=[1,12],s=[1,13],a=[1,70],l=[1,71],c=[1,69],u=[1,38],p=[1,39],g=[1,59],h=[1,60],b=[1,61],C=[1,62],D=[1,63],S=[1,64],V=[1,65],k=[1,66],T=[1,67],A=[1,68],R=[1,40],P=[1,34],W=[1,35],H=[1,36],j=[1,37],ne=[1,41],le=[1,42],w=[1,43],B=[1,44],q=[1,45],M=[1,46],ae=[1,47],se=[1,48],ge=[1,49],he=[1,50],ye=[1,51],fe=[1,52],Se=[1,53],de=[1,17],Ee=[1,54],U=[1,55],ce=[1,56],Oe=[1,57],Qe=[1,58],Ct=[5,12,13,14,18,24,25],Je=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,82],tr=[1,75],mr=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,77,78,79,80,82],we=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82],Xr={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,primes:10,OPEN_MODEXP:11,MODEXP_UNDER:12,MODEXP_OVER:13,CLOSE_MODEXP:14,RADICAL_INDEX:15,index_group:16,OPEN_RADICAL:17,CLOSE_RADICAL:18,level:19,LEVEL:20,BASELINE:21,frac:22,OPEN_FRAC:23,SLASH:24,CLOSE_FRAC:25,subscript_head:26,number:27,atom:28,command:29,greek:30,letter:31,comma:32,period:33,space:34,operation:35,comparison:36,level_with_comparison:37,ellipsis:38,colon:39,infinity:40,integral:41,factorial:42,ampersand:43,question_mark:44,bracket:45,",":46,".":47,"[":48,"{":49,"(":50,"]":51,"}":52,")":53,LANGLE:54,RANGLE:55,PIPE:56,DOUBLE_PIPE:57,SPACE:58,COMMAND:59,GREEK:60,LETTER:61,CAPITAL_LETTER:62,"+":63,"-":64,CDOT:65,TIMES:66,"*":67,"/":68,DIV:69,PERCENT:70,TO:71,COMPARISON:72,LEVEL_WITH_COMPARISON:73,ELLIPSIS:74,COLON:75,NUMBER:76,INFINITY:77,INTEGRAL:78,FACTORIAL:79,"&":80,PRIMES:81,"?":82,unknown:83,UNKNOWN:84,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPEN_MODEXP",12:"MODEXP_UNDER",13:"MODEXP_OVER",14:"CLOSE_MODEXP",15:"RADICAL_INDEX",17:"OPEN_RADICAL",18:"CLOSE_RADICAL",20:"LEVEL",21:"BASELINE",23:"OPEN_FRAC",24:"SLASH",25:"CLOSE_FRAC",46:",",47:".",48:"[",49:"{",50:"(",51:"]",52:"}",53:")",54:"LANGLE",55:"RANGLE",56:"PIPE",57:"DOUBLE_PIPE",58:"SPACE",59:"COMMAND",60:"GREEK",61:"LETTER",62:"CAPITAL_LETTER",63:"+",64:"-",65:"CDOT",66:"TIMES",67:"*",68:"/",69:"DIV",70:"PERCENT",71:"TO",72:"COMPARISON",73:"LEVEL_WITH_COMPARISON",74:"ELLIPSIS",75:"COLON",76:"NUMBER",77:"INFINITY",78:"INTEGRAL",79:"FACTORIAL",80:"&",81:"PRIMES",82:"?",84:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,2],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,4],[8,3],[8,4],[8,4],[8,4],[8,4],[8,3],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[19,1],[19,1],[22,5],[22,4],[22,4],[22,3],[16,2],[16,1],[7,3],[7,2],[7,2],[7,3],[7,2],[7,2],[7,1],[7,1],[7,1],[26,1],[26,1],[26,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[32,1],[33,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[34,1],[29,1],[30,1],[31,1],[31,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[36,1],[37,1],[38,1],[39,1],[27,1],[40,1],[41,1],[42,1],[43,1],[10,1],[44,1],[83,1]],performAction:function(lt,dt,Pt,Ve,ur,Ne,$t){var Ge=Ne.length-1;switch(ur){case 1:return Ne[Ge-1];case 2:return Ve.group();case 3:case 37:case 41:case 43:case 44:this.$=Ve.group(Ne[Ge-1],Ne[Ge]);break;case 4:case 38:this.$=Ve.group(Ne[Ge]);break;case 7:this.$=Ve.group(Ne[Ge-1],Ne[Ge]);break;case 9:this.$=Ve.modified_expression(Ne[Ge-5],Ne[Ge-3],Ne[Ge-1]);break;case 10:this.$=Ve.modified_expression(Ne[Ge-4],Ne[Ge-2]);break;case 11:this.$=Ve.modified_expression(Ne[Ge-3],Ne[Ge-1]);break;case 12:this.$=Ve.modified_expression(Ne[Ge-4],Ve.group(),Ne[Ge-1]);break;case 13:this.$=Ve.modified_expression(Ne[Ge-3],Ve.group(),Ne[Ge-1]);break;case 14:this.$=Ve.modified_expression(Ne[Ge-3],Ve.group(),Ve.group());break;case 15:case 16:this.$=Ve.modified_expression(Ne[Ge-2],Ve.group());break;case 17:this.$=Ve.modified_expression(Ne[Ge-1]);break;case 18:case 19:case 22:case 23:case 24:this.$=Ve.modified_expression(Ve.group());break;case 20:case 21:Ve.warnOrError("Multi-level modified expressions are not supported."),this.$=Ve.modified_expression(Ve.group());break;case 25:this.$=Ve.radical(Ne[Ge-1],Ne[Ge-3]);break;case 26:this.$=Ve.radical(Ne[Ge-1],Ve.group());break;case 27:this.$=Ve.radical(Ve.group(),Ne[Ge-2]);break;case 28:this.$=Ve.radical(Ve.group(),Ve.group());break;case 29:this.$=Ve.radical(Ne[Ge-1]);break;case 30:this.$=Ve.radical(Ve.group());break;case 31:this.$=Ve.level(Ne[Ge]);break;case 32:this.$=Ve.baseline();break;case 33:this.$=Ve.fraction(Ne[Ge-3],Ne[Ge-1]);break;case 34:this.$=Ve.fraction(Ne[Ge-2],Ve.group());break;case 35:this.$=Ve.fraction(Ve.group(),Ne[Ge-1]);break;case 36:this.$=Ve.fraction(Ve.group(),Ve.group());break;case 39:this.$=Ve.group(Ve.simple_subscript(Ne[Ge-2],Ne[Ge]),Ne[Ge-1]);break;case 40:this.$=Ve.simple_subscript(Ne[Ge-1],Ne[Ge]);break;case 42:Ve.warnOrError("Illegal use of Nemeth primes"),this.$=Ve.group(Ve.simple_subscript(Ne[Ge-2],Ne[Ge-1]),Ne[Ge]);break;case 67:this.$=Ve.terminal(",");break;case 68:this.$=Ve.terminal(".");break;case 69:this.$=Ve.terminal("[");break;case 70:this.$=Ve.terminal("\\{");break;case 71:this.$=Ve.terminal("(");break;case 72:this.$=Ve.terminal("]");break;case 73:this.$=Ve.terminal("\\}");break;case 74:this.$=Ve.terminal(")");break;case 75:this.$=Ve.terminal("\\langle ");break;case 76:this.$=Ve.terminal("\\rangle ");break;case 77:this.$=Ve.terminal("|");break;case 78:this.$=Ve.terminal("\\|");break;case 79:this.$=Ve.terminal(" ");break;case 80:this.$=Ve.command(Ne[Ge].toLowerCase());break;case 81:this.$=Ve.terminal(Ve.greek(Ne[Ge]));break;case 82:this.$=Ve.terminal(Ne[Ge].toLowerCase());break;case 83:this.$=Ve.terminal(Ne[Ge].toUpperCase());break;case 84:this.$=Ve.terminal("+");break;case 85:this.$=Ve.terminal("-");break;case 86:this.$=Ve.terminal("\\cdot ");break;case 87:this.$=Ve.terminal("\\times ");break;case 88:this.$=Ve.terminal("*");break;case 89:this.$=Ve.terminal("/");break;case 90:this.$=Ve.terminal("\\div ");break;case 91:this.$=Ve.terminal("\\%");break;case 92:this.$=Ve.terminal("\\to ");break;case 93:this.$=Ve.comparison(Ne[Ge].trim());break;case 94:this.$=Ve.level_with_comparison(Ne[Ge].trim());break;case 95:this.$=Ve.terminal("\\ldots ");break;case 96:this.$=Ve.terminal(":");break;case 97:this.$=Ve.terminal(Ne[Ge]);break;case 98:this.$=Ve.terminal("\\infty ");break;case 99:this.$=Ve.terminal("\\int ");break;case 100:this.$=Ve.terminal("!");break;case 101:this.$=Ve.terminal("\\&");break;case 102:this.$=Ve.primes(Ne[Ge]);break;case 103:this.$=Ve.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,11:n,15:o,17:s,19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{1:[3]},{5:[1,72]},{1:[2,2]},i(Ct,[2,4],{6:4,7:5,8:6,9:7,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,22:32,19:33,4:73,11:n,15:o,17:s,20:a,21:l,23:c,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe}),i(Je,[2,5]),i(Je,[2,6]),i(Je,[2,8],{10:74,81:tr}),i(mr,[2,45],{10:76,27:77,76:de,81:tr}),i(Je,[2,46],{10:78,81:tr}),i(Je,[2,47],{10:79,81:tr}),{4:80,6:4,7:5,8:6,9:7,11:n,12:[1,82],13:[1,81],14:[1,83],15:o,17:s,19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{7:86,16:84,17:[1,85],19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{4:87,6:4,7:5,8:6,9:7,11:n,15:o,17:s,18:[1,88],19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},i(we,[2,48]),i(we,[2,49]),i(we,[2,50]),i(we,[2,97]),i(we,[2,51]),i(we,[2,52]),i(we,[2,53]),i(we,[2,54]),i(we,[2,55]),i(we,[2,56]),i(we,[2,57]),i(we,[2,58]),i(we,[2,59]),i(we,[2,60]),i(we,[2,61]),i(we,[2,62]),i(we,[2,63]),i(we,[2,64]),i(we,[2,65]),i(we,[2,66]),i(we,[2,80]),i(we,[2,81]),i(we,[2,82]),i(we,[2,83]),i(we,[2,67]),i(we,[2,68]),i(we,[2,79]),i(we,[2,84]),i(we,[2,85]),i(we,[2,86]),i(we,[2,87]),i(we,[2,88]),i(we,[2,89]),i(we,[2,90]),i(we,[2,91]),i(we,[2,92]),i(we,[2,93]),i(we,[2,94]),i(we,[2,95]),i(we,[2,96]),i(we,[2,98]),i(we,[2,99]),i(we,[2,100]),i(we,[2,101]),i(we,[2,103]),i(we,[2,69]),i(we,[2,70]),i(we,[2,71]),i(we,[2,72]),i(we,[2,73]),i(we,[2,74]),i(we,[2,75]),i(we,[2,76]),i(we,[2,77]),i(we,[2,78]),{4:89,6:4,7:5,8:6,9:7,11:n,15:o,17:s,19:33,20:a,21:l,22:32,23:c,24:[1,90],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},i(we,[2,31]),i(we,[2,32]),{1:[2,1]},i(Ct,[2,3]),i(Je,[2,7]),i(Je,[2,102]),i(mr,[2,41],{27:91,76:de}),i(Je,[2,40],{10:92,81:tr}),i(Je,[2,43]),i(Je,[2,44]),{12:[1,93],13:[1,94],14:[1,95]},{12:[1,96],13:[1,97],14:[1,98]},{12:[1,100],13:[1,99],14:[1,101]},i(Je,[2,24]),{17:[1,102]},{4:103,6:4,7:5,8:6,9:7,11:n,15:o,17:s,18:[1,104],19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{7:86,16:105,17:[2,38],19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{18:[1,106]},i(we,[2,30]),{24:[1,107]},{4:108,6:4,7:5,8:6,9:7,11:n,15:o,17:s,19:33,20:a,21:l,22:32,23:c,25:[1,109],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},i(Je,[2,39]),i(Je,[2,42]),{4:110,6:4,7:5,8:6,9:7,11:n,13:[1,111],14:[1,112],15:o,17:s,19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{4:113,6:4,7:5,8:6,9:7,11:n,14:[1,114],15:o,17:s,19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},i(Je,[2,17]),{14:[1,115]},{14:[1,116]},i(Je,[2,22]),{14:[1,117]},{14:[1,118]},i(Je,[2,23]),{4:119,6:4,7:5,8:6,9:7,11:n,15:o,17:s,18:[1,120],19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{18:[1,121]},i(we,[2,28]),{17:[2,37]},i(we,[2,29]),{4:122,6:4,7:5,8:6,9:7,11:n,15:o,17:s,19:33,20:a,21:l,22:32,23:c,25:[1,123],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},{25:[1,124]},i(we,[2,36]),{13:[1,125],14:[1,126]},{4:127,6:4,7:5,8:6,9:7,11:n,14:[1,128],15:o,17:s,19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},i(Je,[2,16]),{14:[1,129]},i(Je,[2,15]),i(Je,[2,18]),i(Je,[2,20]),i(Je,[2,19]),i(Je,[2,21]),{18:[1,130]},i(we,[2,27]),i(we,[2,26]),{25:[1,131]},i(we,[2,34]),i(we,[2,35]),{4:132,6:4,7:5,8:6,9:7,11:n,14:[1,133],15:o,17:s,19:33,20:a,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:u,47:p,48:g,49:h,50:b,51:C,52:D,53:S,54:V,55:k,56:T,57:A,58:R,59:P,60:W,61:H,62:j,63:ne,64:le,65:w,66:B,67:q,68:M,69:ae,70:se,71:ge,72:he,73:ye,74:fe,75:Se,76:de,77:Ee,78:U,79:ce,80:Oe,82:Qe},i(Je,[2,11]),{14:[1,134]},i(Je,[2,14]),i(Je,[2,13]),i(we,[2,25]),i(we,[2,33]),{14:[1,135]},i(Je,[2,10]),i(Je,[2,12]),i(Je,[2,9])],defaultActions:{3:[2,2],72:[2,1],105:[2,37]},parseError:function(lt,dt){if(dt.recoverable)this.trace(lt);else{var Pt=new Error(lt);throw Pt.hash=dt,Pt}},parse:function(lt){var dt=this,Pt=[0],Ve=[],ur=[null],Ne=[],$t=this.table,Ge="",st=0,kt=0,Ae=0,Mr=2,xt=1,il=Ne.slice.call(arguments,1),Ft=Object.create(this.lexer),In={yy:{}};for(var no in this.yy)Object.prototype.hasOwnProperty.call(this.yy,no)&&(In.yy[no]=this.yy[no]);Ft.setInput(lt,In.yy),In.yy.lexer=Ft,In.yy.parser=this,typeof Ft.yylloc=="undefined"&&(Ft.yylloc={});var Vi=Ft.yylloc;Ne.push(Vi);var Qi=Ft.options&&Ft.options.ranges;typeof In.yy.parseError=="function"?this.parseError=In.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function On(Be){Pt.length=Pt.length-2*Be,ur.length=ur.length-Be,Ne.length=Ne.length-Be}e:var pa=function(){var Be;return Be=Ft.lex()||xt,typeof Be!="number"&&(Be=dt.symbols_[Be]||Be),Be};for(var Wt,vi,xo,Qr,Yd,N,$={},Z,be,oe,Ce;;){if(xo=Pt[Pt.length-1],this.defaultActions[xo]?Qr=this.defaultActions[xo]:((Wt===null||typeof Wt=="undefined")&&(Wt=pa()),Qr=$t[xo]&&$t[xo][Wt]),typeof Qr=="undefined"||!Qr.length||!Qr[0]){var Pe="";Ce=[];for(Z in $t[xo])this.terminals_[Z]&&Z>Mr&&Ce.push("'"+this.terminals_[Z]+"'");Ft.showPosition?Pe="Parse error on line "+(st+1)+`:
`+Ft.showPosition()+`
Expecting `+Ce.join(", ")+", got '"+(this.terminals_[Wt]||Wt)+"'":Pe="Parse error on line "+(st+1)+": Unexpected "+(Wt==xt?"end of input":"'"+(this.terminals_[Wt]||Wt)+"'"),this.parseError(Pe,{text:Ft.match,token:this.terminals_[Wt]||Wt,line:Ft.yylineno,loc:Vi,expected:Ce})}if(Qr[0]instanceof Array&&Qr.length>1)throw new Error("Parse Error: multiple actions possible at state: "+xo+", token: "+Wt);switch(Qr[0]){case 1:Pt.push(Wt),ur.push(Ft.yytext),Ne.push(Ft.yylloc),Pt.push(Qr[1]),Wt=null,vi?(Wt=vi,vi=null):(kt=Ft.yyleng,Ge=Ft.yytext,st=Ft.yylineno,Vi=Ft.yylloc,Ae>0&&Ae--);break;case 2:if(be=this.productions_[Qr[1]][1],$.$=ur[ur.length-be],$._$={first_line:Ne[Ne.length-(be||1)].first_line,last_line:Ne[Ne.length-1].last_line,first_column:Ne[Ne.length-(be||1)].first_column,last_column:Ne[Ne.length-1].last_column},Qi&&($._$.range=[Ne[Ne.length-(be||1)].range[0],Ne[Ne.length-1].range[1]]),N=this.performAction.apply($,[Ge,kt,st,In.yy,Qr[1],ur,Ne].concat(il)),typeof N!="undefined")return N;be&&(Pt=Pt.slice(0,-1*be*2),ur=ur.slice(0,-1*be),Ne=Ne.slice(0,-1*be)),Pt.push(this.productions_[Qr[1]][0]),ur.push($.$),Ne.push($._$),oe=$t[Pt[Pt.length-2]][Pt[Pt.length-1]],Pt.push(oe);break;case 3:return!0}}return!0}},xi=function(){var Et={EOF:1,parseError:function(dt,Pt){if(this.yy.parser)this.yy.parser.parseError(dt,Pt);else throw new Error(dt)},setInput:function(lt,dt){return this.yy=dt||this.yy||{},this._input=lt,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var lt=this._input[0];this.yytext+=lt,this.yyleng++,this.offset++,this.match+=lt,this.matched+=lt;var dt=lt.match(/(?:\r\n?|\n).*/g);return dt?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),lt},unput:function(lt){var dt=lt.length,Pt=lt.split(/(?:\r\n?|\n)/g);this._input=lt+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-dt),this.offset-=dt;var Ve=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Pt.length-1&&(this.yylineno-=Pt.length-1);var ur=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Pt?(Pt.length===Ve.length?this.yylloc.first_column:0)+Ve[Ve.length-Pt.length].length-Pt[0].length:this.yylloc.first_column-dt},this.options.ranges&&(this.yylloc.range=[ur[0],ur[0]+this.yyleng-dt]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(lt){this.unput(this.match.slice(lt))},pastInput:function(){var lt=this.matched.substr(0,this.matched.length-this.match.length);return(lt.length>20?"...":"")+lt.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var lt=this.match;return lt.length<20&&(lt+=this._input.substr(0,20-lt.length)),(lt.substr(0,20)+(lt.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var lt=this.pastInput(),dt=new Array(lt.length+1).join("-");return lt+this.upcomingInput()+`
`+dt+"^"},test_match:function(lt,dt){var Pt,Ve,ur;if(this.options.backtrack_lexer&&(ur={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ur.yylloc.range=this.yylloc.range.slice(0))),Ve=lt[0].match(/(?:\r\n?|\n).*/g),Ve&&(this.yylineno+=Ve.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Ve?Ve[Ve.length-1].length-Ve[Ve.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+lt[0].length},this.yytext+=lt[0],this.match+=lt[0],this.matches=lt,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(lt[0].length),this.matched+=lt[0],Pt=this.performAction.call(this,this.yy,this,dt,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Pt)return Pt;if(this._backtrack){for(var Ne in ur)this[Ne]=ur[Ne];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var lt,dt,Pt,Ve;this._more||(this.yytext="",this.match="");for(var ur=this._currentRules(),Ne=0;Ne<ur.length;Ne++)if(Pt=this._input.match(this.rules[ur[Ne]]),Pt&&(!dt||Pt[0].length>dt[0].length)){if(dt=Pt,Ve=Ne,this.options.backtrack_lexer){if(lt=this.test_match(Pt,ur[Ne]),lt!==!1)return lt;if(this._backtrack){dt=!1;continue}else return!1}else if(!this.options.flex)break}return dt?(lt=this.test_match(dt,ur[Ve]),lt!==!1?lt:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var dt=this.next();return dt||this.lex()},begin:function(dt){this.conditionStack.push(dt)},popState:function(){var dt=this.conditionStack.length-1;return dt>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(dt){return dt=this.conditionStack.length-1-Math.abs(dt||0),dt>=0?this.conditionStack[dt]:"INITIAL"},pushState:function(dt){this.begin(dt)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(dt,Pt,Ve,ur){var Ne=ur;switch(Ve){case 0:return this.begin("modexp"),11;break;case 1:return 21;case 2:return this.begin("modexp"),11;break;case 3:return 12;case 4:return 13;case 5:return this.popState(),14;break;case 6:return 63;case 7:return 64;case 8:return 65;case 9:return 66;case 10:return 67;case 11:return 68;case 12:return 69;case 13:return 54;case 14:return 48;case 15:return 49;case 16:return 50;case 17:return 55;case 18:return 51;case 19:return 52;case 20:return 53;case 21:return 57;case 22:return 56;case 23:return 75;case 24:return 70;case 25:return 71;case 26:return 73;case 27:return 73;case 28:return 73;case 29:return 73;case 30:return 73;case 31:return 73;case 32:return 73;case 33:return 73;case 34:return 73;case 35:return 72;case 36:return 73;case 37:return 73;case 38:return 72;case 39:return 72;case 40:return 72;case 41:return 72;case 42:return 72;case 43:return 72;case 44:return 72;case 45:return 72;case 46:return 72;case 47:return 72;case 48:return 74;case 49:return 20;case 50:return 47;case 51:return 21;case 52:return 81;case 53:return 60;case 54:return 15;case 55:return this.begin("radical"),17;break;case 56:return this.popState(),18;break;case 57:return 18;case 58:return 78;case 59:return 80;case 60:return 79;case 61:return 59;case 62:return 59;case 63:return Pt.yytext=this.matches[1],76;break;case 64:return 23;case 65:return 24;case 66:return 25;case 67:return Pt.yytext=this.matches[1],62;break;case 68:return 61;case 69:return 77;case 70:return 82;case 71:return 46;case 72:return 47;case 73:return 58;case 74:return 5;case 75:return 84}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][/])/,/^(?:[.][/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0])/,/^(?:[ ][$]O[ ])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[/][.]K[ ])/,/^(?:[ ][\^;]+[@][:][@][:][ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][/][.]K[ ])/,/^(?:[ ][@][:][@][:][ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[@][:])/,/^(?:[ ][/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]['][']['][ ])/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],inclusive:!0}}};return Et}();Xr.lexer=xi;function Le(){this.yy={}}return Le.prototype=Xr,Xr.Parser=Le,new Le}();typeof If!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&If.main===e&&r.main(process.argv.slice(1)))}}),G3=EA({"generated/ueb-to-latex.jison.js"(r,e){"use strict";var t=function(){var i=function($t,Ge,st,kt){for(st=st||{},kt=$t.length;kt--;st[$t[kt]]=Ge);return st},n=[1,15],o=[1,16],s=[1,17],a=[1,36],l=[1,18],c=[1,37],u=[1,38],p=[1,14],g=[1,46],h=[1,47],b=[1,39],C=[1,40],D=[1,41],S=[1,56],V=[1,42],k=[1,43],T=[1,44],A=[1,45],R=[1,54],P=[1,55],W=[1,57],H=[1,58],j=[1,59],ne=[1,60],le=[1,61],w=[1,62],B=[1,63],q=[1,64],M=[1,65],ae=[1,66],se=[1,67],ge=[1,68],he=[1,69],ye=[1,70],fe=[1,71],Se=[1,72],de=[1,73],Ee=[1,74],U=[1,75],ce=[1,76],Oe=[1,48],Qe=[1,49],Ct=[1,50],Je=[1,51],tr=[1,52],mr=[1,77],we=[1,53],Xr=[5,14,18,19,29,52,53,54],xi=[5,10,13,14,15,18,19,29,52,53,54],Le=[5,10,13,14,15,17,18,19,21,23,24,28,29,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88],Et=[1,85],lt=[1,86],dt=[1,87],Pt=[10,13,15,17,21,23,24,28,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88],Ve={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,atom:25,lbracket:26,rbracket:27,OPEN_GROUP:28,CLOSE_GROUP:29,command:30,greek:31,letter:32,comma:33,period:34,colon:35,infinity:36,integral:37,factorial:38,ampersand:39,question_mark:40,bracket:41,space:42,operation:43,comparison:44,ellipsis:45,primes:46,",":47,".":48,"[":49,"{":50,"(":51,"]":52,"}":53,")":54,SPACE:55,COMMAND:56,GREEK:57,CAPITAL_LETTER:58,LETTER:59,PIPE:60,DOUBLE_PIPE:61,"+":62,"-":63,CDOT:64,TIMES:65,"*":66,DIV:67,SLASH:68,PERCENT:69,TO:70,"=":71,NEQ:72,"<":73,">":74,LEQ:75,APPROX:76,GEQ:77,TILDE:78,PARALLEL:79,PERPENDICULAR:80,ELLIPSIS:81,COLON:82,INFINITY:83,INTEGRAL:84,FACTORIAL:85,"&":86,PRIMES:87,"?":88,unknown:89,UNKNOWN:90,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",28:"OPEN_GROUP",29:"CLOSE_GROUP",47:",",48:".",49:"[",50:"{",51:"(",52:"]",53:"}",54:")",55:"SPACE",56:"COMMAND",57:"GREEK",58:"CAPITAL_LETTER",59:"LETTER",60:"PIPE",61:"DOUBLE_PIPE",62:"+",63:"-",64:"CDOT",65:"TIMES",66:"*",67:"DIV",68:"SLASH",69:"PERCENT",70:"TO",71:"=",72:"NEQ",73:"<",74:">",75:"LEQ",76:"APPROX",77:"GEQ",78:"TILDE",79:"PARALLEL",80:"PERPENDICULAR",81:"ELLIPSIS",82:"COLON",83:"INFINITY",84:"INTEGRAL",85:"FACTORIAL",86:"&",87:"PRIMES",88:"?",90:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[33,1],[34,1],[26,1],[26,1],[26,1],[27,1],[27,1],[27,1],[42,1],[30,1],[31,1],[32,1],[32,1],[41,1],[41,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[45,1],[35,1],[36,1],[37,1],[38,1],[39,1],[46,1],[40,1],[89,1]],performAction:function(Ge,st,kt,Ae,Mr,xt,il){var Ft=xt.length-1;switch(Mr){case 1:return xt[Ft-1];case 2:return Ae.group();case 3:case 35:this.$=Ae.group(xt[Ft-2],xt[Ft-1],xt[Ft]);break;case 4:case 6:case 31:case 32:case 36:this.$=Ae.group(xt[Ft-1],xt[Ft]);break;case 5:case 7:case 33:case 34:this.$=Ae.group(xt[Ft]);break;case 10:case 11:case 12:this.$=Ae.basic_level(xt[Ft-1],Ae.group(xt[Ft]));break;case 13:case 17:this.$=Ae.radical(xt[Ft-1],Ae.group(xt[Ft-2]));break;case 14:case 15:this.$=Ae.radical(Ae.group(),Ae.group(xt[Ft-1]));break;case 16:this.$=Ae.radical(Ae.group(),Ae.group());break;case 18:this.$=Ae.radical(xt[Ft-1]);break;case 19:this.$=Ae.radical(Ae.group());break;case 20:this.$=Ae.fraction(xt[Ft-3],xt[Ft-1]);break;case 21:this.$=Ae.fraction(xt[Ft-2],Ae.group());break;case 22:this.$=Ae.fraction(Ae.group(),xt[Ft-1]);break;case 23:case 24:this.$=Ae.fraction(Ae.group(),Ae.group());break;case 25:this.$=Ae.fraction(Ae.group(Ae.terminal(Ae.to_number(xt[Ft-1]))),Ae.group(Ae.terminal(Ae.to_number(xt[Ft]))));break;case 26:this.$=Ae.fraction(Ae.group(Ae.terminal(Ae.to_number(xt[Ft]))),Ae.group());break;case 27:this.$=Ae.fraction(Ae.group(),Ae.group(Ae.terminal(Ae.to_number(xt[$01]))));break;case 37:this.$=Ae.group(xt[Ft-1]);break;case 38:this.$=Ae.group();break;case 39:this.$=Ae.terminal(Ae.to_number(xt[Ft]));break;case 57:this.$=Ae.terminal(",");break;case 58:this.$=Ae.terminal(".");break;case 59:this.$=Ae.terminal("[");break;case 60:this.$=Ae.terminal("\\{");break;case 61:this.$=Ae.terminal("(");break;case 62:this.$=Ae.terminal("]");break;case 63:this.$=Ae.terminal("\\}");break;case 64:this.$=Ae.terminal(")");break;case 65:this.$=Ae.terminal(" ");break;case 66:this.$=Ae.command("\\"+xt[Ft].trim().toLowerCase());break;case 67:this.$=Ae.terminal(Ae.greek(xt[Ft]));break;case 68:this.$=Ae.terminal(xt[Ft].toUpperCase());break;case 69:this.$=Ae.terminal(xt[Ft].toLowerCase());break;case 70:this.$=Ae.terminal("|");break;case 71:this.$=Ae.terminal("\\|");break;case 72:this.$=Ae.terminal("+");break;case 73:this.$=Ae.terminal("-");break;case 74:this.$=Ae.terminal("\\cdot ");break;case 75:this.$=Ae.terminal("\\times ");break;case 76:this.$=Ae.terminal("*");break;case 77:this.$=Ae.terminal("\\div ");break;case 78:this.$=Ae.terminal("/");break;case 79:this.$=Ae.terminal("\\%");break;case 80:this.$=Ae.terminal("\\to ");break;case 81:this.$=Ae.terminal("=");break;case 82:this.$=Ae.terminal("\\neq ");break;case 83:this.$=Ae.terminal("<");break;case 84:this.$=Ae.terminal(">");break;case 85:this.$=Ae.terminal("\\leq ");break;case 86:this.$=Ae.terminal("\\approx ");break;case 87:this.$=Ae.terminal("\\geq ");break;case 88:this.$=Ae.terminal("\\sim ");break;case 89:this.$=Ae.terminal("\\parallel ");break;case 90:this.$=Ae.terminal("\\perp ");break;case 91:this.$=Ae.terminal("\\ldots ");break;case 92:this.$=Ae.terminal(":");break;case 93:this.$=Ae.terminal("\\infty ");break;case 94:this.$=Ae.terminal("\\int ");break;case 95:this.$=Ae.terminal("!");break;case 96:this.$=Ae.terminal("\\&");break;case 97:this.$=Ae.primes(xt[Ft]);break;case 98:this.$=Ae.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{1:[3]},{5:[1,78]},{1:[2,2]},i(Xr,[2,5],{8:8,9:9,7:79,10:n,13:o,15:s}),i(Xr,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:80,10:n,13:o,15:s,17:a,21:l,23:c,24:u,28:p,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we}),i(xi,[2,33],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:81,17:a,21:l,23:c,24:u,28:p,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we}),i(xi,[2,34],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:82,17:a,21:l,23:c,24:u,28:p,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we}),i(Le,[2,8]),i(Le,[2,9]),i(Le,[2,28]),i(Le,[2,29]),i(Le,[2,30]),{4:83,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,27:84,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,52:Et,53:lt,54:dt,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{4:88,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,29:[1,89],30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{9:92,11:90,12:91,13:o,15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{11:93,12:94,14:[1,95],16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{4:96,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,14:[1,97],15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},i(Le,[2,39],{22:[1,98]}),i(Le,[2,40]),i(Le,[2,41]),i(Le,[2,42]),i(Le,[2,43]),i(Le,[2,44]),i(Le,[2,45]),i(Le,[2,46]),i(Le,[2,47]),i(Le,[2,48]),i(Le,[2,49]),i(Le,[2,50]),i(Le,[2,51]),i(Le,[2,52]),i(Le,[2,53]),i(Le,[2,54]),i(Le,[2,55]),i(Le,[2,56]),{4:99,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,15:s,16:11,17:a,18:[1,100],19:[1,101],20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},i(Le,[2,26]),i(Le,[2,27]),i(Pt,[2,59]),i(Pt,[2,60]),i(Pt,[2,61]),i(Le,[2,66]),i(Le,[2,67]),i(Le,[2,68]),i(Le,[2,69]),i(Le,[2,57]),i(Le,[2,58]),i(Le,[2,92]),i(Le,[2,93]),i(Le,[2,94]),i(Le,[2,95]),i(Le,[2,96]),i(Le,[2,98]),i(Le,[2,70]),i(Le,[2,71]),i(Le,[2,65]),i(Le,[2,72]),i(Le,[2,73]),i(Le,[2,74]),i(Le,[2,75]),i(Le,[2,76]),i(Le,[2,77]),i(Le,[2,78]),i(Le,[2,79]),i(Le,[2,80]),i(Le,[2,81]),i(Le,[2,82]),i(Le,[2,83]),i(Le,[2,84]),i(Le,[2,85]),i(Le,[2,86]),i(Le,[2,87]),i(Le,[2,88]),i(Le,[2,89]),i(Le,[2,90]),i(Le,[2,91]),i(Le,[2,97]),{1:[2,1]},i(Xr,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:102,10:n,13:o,15:s,17:a,21:l,23:c,24:u,28:p,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we}),i(Xr,[2,6]),i(xi,[2,31]),i(xi,[2,32]),{27:103,52:Et,53:lt,54:dt},i(Le,[2,36]),i(Le,[2,62]),i(Le,[2,63]),i(Le,[2,64]),{29:[1,104]},i(Le,[2,38]),i(Le,[2,10]),i(Le,[2,11]),i(Le,[2,12]),{4:105,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,14:[1,106],15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{4:108,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,14:[1,107],15:s,16:11,17:a,20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},i(Le,[2,16]),{14:[1,109]},i(Le,[2,19]),i(Le,[2,25]),{18:[1,110]},{4:111,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,15:s,16:11,17:a,19:[1,112],20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},i(Le,[2,24]),i(Xr,[2,3]),i(Le,[2,35]),i(Le,[2,37]),{14:[1,113]},i(Le,[2,15]),i(Le,[2,14]),{14:[1,114]},i(Le,[2,18]),{4:115,6:4,7:5,8:8,9:9,10:n,11:6,12:7,13:o,15:s,16:11,17:a,19:[1,116],20:12,21:l,23:c,24:u,25:10,26:13,28:p,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:g,48:h,49:b,50:C,51:D,55:S,56:V,57:k,58:T,59:A,60:R,61:P,62:W,63:H,64:j,65:ne,66:le,67:w,68:B,69:q,70:M,71:ae,72:se,73:ge,74:he,75:ye,76:fe,77:Se,78:de,79:Ee,80:U,81:ce,82:Oe,83:Qe,84:Ct,85:Je,86:tr,87:mr,88:we},{19:[1,117]},i(Le,[2,23]),i(Le,[2,13]),i(Le,[2,17]),{19:[1,118]},i(Le,[2,21]),i(Le,[2,22]),i(Le,[2,20])],defaultActions:{3:[2,2],78:[2,1]},parseError:function(Ge,st){if(st.recoverable)this.trace(Ge);else{var kt=new Error(Ge);throw kt.hash=st,kt}},parse:function(Ge){var st=this,kt=[0],Ae=[],Mr=[null],xt=[],il=this.table,Ft="",In=0,no=0,Vi=0,Qi=2,On=1,pa=xt.slice.call(arguments,1),Wt=Object.create(this.lexer),vi={yy:{}};for(var xo in this.yy)Object.prototype.hasOwnProperty.call(this.yy,xo)&&(vi.yy[xo]=this.yy[xo]);Wt.setInput(Ge,vi.yy),vi.yy.lexer=Wt,vi.yy.parser=this,typeof Wt.yylloc=="undefined"&&(Wt.yylloc={});var Qr=Wt.yylloc;xt.push(Qr);var Yd=Wt.options&&Wt.options.ranges;typeof vi.yy.parseError=="function"?this.parseError=vi.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function N(St){kt.length=kt.length-2*St,Mr.length=Mr.length-St,xt.length=xt.length-St}e:var $=function(){var St;return St=Wt.lex()||On,typeof St!="number"&&(St=st.symbols_[St]||St),St};for(var Z,be,oe,Ce,Pe,Be,rt={},At,yt,vt,jt;;){if(oe=kt[kt.length-1],this.defaultActions[oe]?Ce=this.defaultActions[oe]:((Z===null||typeof Z=="undefined")&&(Z=$()),Ce=il[oe]&&il[oe][Z]),typeof Ce=="undefined"||!Ce.length||!Ce[0]){var _r="";jt=[];for(At in il[oe])this.terminals_[At]&&At>Qi&&jt.push("'"+this.terminals_[At]+"'");Wt.showPosition?_r="Parse error on line "+(In+1)+`:
`+Wt.showPosition()+`
Expecting `+jt.join(", ")+", got '"+(this.terminals_[Z]||Z)+"'":_r="Parse error on line "+(In+1)+": Unexpected "+(Z==On?"end of input":"'"+(this.terminals_[Z]||Z)+"'"),this.parseError(_r,{text:Wt.match,token:this.terminals_[Z]||Z,line:Wt.yylineno,loc:Qr,expected:jt})}if(Ce[0]instanceof Array&&Ce.length>1)throw new Error("Parse Error: multiple actions possible at state: "+oe+", token: "+Z);switch(Ce[0]){case 1:kt.push(Z),Mr.push(Wt.yytext),xt.push(Wt.yylloc),kt.push(Ce[1]),Z=null,be?(Z=be,be=null):(no=Wt.yyleng,Ft=Wt.yytext,In=Wt.yylineno,Qr=Wt.yylloc,Vi>0&&Vi--);break;case 2:if(yt=this.productions_[Ce[1]][1],rt.$=Mr[Mr.length-yt],rt._$={first_line:xt[xt.length-(yt||1)].first_line,last_line:xt[xt.length-1].last_line,first_column:xt[xt.length-(yt||1)].first_column,last_column:xt[xt.length-1].last_column},Yd&&(rt._$.range=[xt[xt.length-(yt||1)].range[0],xt[xt.length-1].range[1]]),Be=this.performAction.apply(rt,[Ft,no,In,vi.yy,Ce[1],Mr,xt].concat(pa)),typeof Be!="undefined")return Be;yt&&(kt=kt.slice(0,-1*yt*2),Mr=Mr.slice(0,-1*yt),xt=xt.slice(0,-1*yt)),kt.push(this.productions_[Ce[1]][0]),Mr.push(rt.$),xt.push(rt._$),vt=il[kt[kt.length-2]][kt[kt.length-1]],kt.push(vt);break;case 3:return!0}}return!0}},ur=function(){var $t={EOF:1,parseError:function(st,kt){if(this.yy.parser)this.yy.parser.parseError(st,kt);else throw new Error(st)},setInput:function(Ge,st){return this.yy=st||this.yy||{},this._input=Ge,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ge=this._input[0];this.yytext+=Ge,this.yyleng++,this.offset++,this.match+=Ge,this.matched+=Ge;var st=Ge.match(/(?:\r\n?|\n).*/g);return st?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ge},unput:function(Ge){var st=Ge.length,kt=Ge.split(/(?:\r\n?|\n)/g);this._input=Ge+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-st),this.offset-=st;var Ae=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),kt.length-1&&(this.yylineno-=kt.length-1);var Mr=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:kt?(kt.length===Ae.length?this.yylloc.first_column:0)+Ae[Ae.length-kt.length].length-kt[0].length:this.yylloc.first_column-st},this.options.ranges&&(this.yylloc.range=[Mr[0],Mr[0]+this.yyleng-st]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Ge){this.unput(this.match.slice(Ge))},pastInput:function(){var Ge=this.matched.substr(0,this.matched.length-this.match.length);return(Ge.length>20?"...":"")+Ge.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ge=this.match;return Ge.length<20&&(Ge+=this._input.substr(0,20-Ge.length)),(Ge.substr(0,20)+(Ge.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ge=this.pastInput(),st=new Array(Ge.length+1).join("-");return Ge+this.upcomingInput()+`
`+st+"^"},test_match:function(Ge,st){var kt,Ae,Mr;if(this.options.backtrack_lexer&&(Mr={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Mr.yylloc.range=this.yylloc.range.slice(0))),Ae=Ge[0].match(/(?:\r\n?|\n).*/g),Ae&&(this.yylineno+=Ae.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Ae?Ae[Ae.length-1].length-Ae[Ae.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ge[0].length},this.yytext+=Ge[0],this.match+=Ge[0],this.matches=Ge,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ge[0].length),this.matched+=Ge[0],kt=this.performAction.call(this,this.yy,this,st,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),kt)return kt;if(this._backtrack){for(var xt in Mr)this[xt]=Mr[xt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Ge,st,kt,Ae;this._more||(this.yytext="",this.match="");for(var Mr=this._currentRules(),xt=0;xt<Mr.length;xt++)if(kt=this._input.match(this.rules[Mr[xt]]),kt&&(!st||kt[0].length>st[0].length)){if(st=kt,Ae=xt,this.options.backtrack_lexer){if(Ge=this.test_match(kt,Mr[xt]),Ge!==!1)return Ge;if(this._backtrack){st=!1;continue}else return!1}else if(!this.options.flex)break}return st?(Ge=this.test_match(st,Mr[Ae]),Ge!==!1?Ge:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var st=this.next();return st||this.lex()},begin:function(st){this.conditionStack.push(st)},popState:function(){var st=this.conditionStack.length-1;return st>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(st){return st=this.conditionStack.length-1-Math.abs(st||0),st>=0?this.conditionStack[st]:"INITIAL"},pushState:function(st){this.begin(st)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(st,kt,Ae,Mr){var xt=Mr;switch(Ae){case 0:this.begin("captext");return;case 1:return 58;case 2:return this.popState(),58;break;case 3:return 62;case 4:return 63;case 5:return 64;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 49;case 10:return 50;case 11:return 51;case 12:return 52;case 13:return 53;case 14:return 54;case 15:return 72;case 16:return 75;case 17:return 76;case 18:return 77;case 19:return 71;case 20:return 73;case 21:return 74;case 22:return 78;case 23:return 69;case 24:return 70;case 25:return 81;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 10;case 30:return 28;case 31:return 29;case 32:return 84;case 33:return 85;case 34:return 86;case 35:return 17;case 36:return 18;case 37:return 19;case 38:return 79;case 39:return 80;case 40:return 83;case 41:return kt.yytext=this.matches[1],21;break;case 42:return kt.yytext=this.matches[1],22;break;case 43:return kt.yytext=this.matches[1],24;break;case 44:return 68;case 45:return 47;case 46:return 48;case 47:return 87;case 48:return 61;case 49:return 60;case 50:return 82;case 51:return 56;case 52:return 56;case 53:return 57;case 54:return kt.yytext=this.matches[1],58;break;case 55:return 59;case 56:return;case 57:return 88;case 58:return;case 59:return 55;case 60:return 5;case 61:return 90}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[\^][9])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9])/,/^(?:[.][0])/,/^(?:[:][O])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+(?=.))/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[/]([A-J4]+))/,/^(?:[#][/]([A-J4]+))/,/^(?:[_]?[/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61],inclusive:!0}}};return $t}();Ve.lexer=ur;function Ne(){this.yy={}}return Ne.prototype=Ve,Ve.Parser=Ne,new Ne}();typeof If!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&If.main===e&&r.main(process.argv.slice(1)))}}),GA=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","binomialdist","boxplot","cdf","ceil","corr","cov","csch","distance","dotplot","erf","floor","gcf","histogram","IndependentTTest","iTTest","ittest","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","normaldist","nPr","pdf","poissondist","polygon","quantile","quartile","random","round","sech","sign","signum","sgn","stdDev","stddev","stdDevP","stddevp","stdev","stdevp","tdist","total","TScore","TScore","Tscore","tscore","tscore","TTest","ttest","var","variance","varp"],kE=GA,VW=V3(GA),IA;function I3(r){let e=!1,t=0,i="",n="";for(let o of r)if(o.type==="terminal"&&/[A-Za-z]/.test(o.value))i+=o.value,t++;else break;return n=i.replace(IA,"\\operatorname{$1}"),e=t>0&&n!==i,{modified:e,terminalCount:t,value:n}}function VA(r){return kE.indexOf(r.toLowerCase())!==-1}function GE(r){if(!Array.isArray(r))throw new Error("Operator names must be an array, got "+typeof r);for(let e of r)if(typeof e!="string")throw new Error("Operator names must be strings, found "+typeof e);kE=r,TW()}function IE(){kE=GA,IA=VW}function TW(){IA=V3(kE)}function V3(r){let e=r.sort((t,i)=>i.length-t.length||i.localeCompare(t)).join("|");return new RegExp("("+e+")","g")}var T3={};kA(T3,{command:()=>TA,fraction:()=>LW,greek:()=>MW,group:()=>MA,level:()=>A3,processPrimes:()=>AW,radical:()=>OW,terminal:()=>M3,typeform:()=>L3});function M3(r){return{type:"terminal",value:r}}function TA(r){return{type:"command",value:r}}function MW(r){return{type:"greek",value:r}}function A3(r){return{subscript:r._,superscript:r["^"],type:"level"}}function AW(r,e){let t=[],i=r.match(/'+/);if(i!==null){let n=i[0].length;for(let o=0;o<n;o++)t.push(TA("\\prime"))}return MA(t,e)}function LW(r,e){return{type:"fraction",numerator:r,denominator:e}}function L3(r,e){return{name:r,type:"typeform",value:e}}function OW(r,e){return{type:"radical",index:e,radicand:r}}function MA(...r){return Array.prototype.concat.apply([],r)}var bE={"~":"\\ ","\\,":"\\ ","\\:":"\\ ","\\;":"\\ ","\\!":"\\ "},h3={"\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},PW={"\\space":!0};function Bp(r){let e=[];for(let t=0;t<r.length;t++){let i=r[t];switch(i.type){case"command":let n=i.value.slice(1).trim();h3.hasOwnProperty(i.value)?e.push(TA(h3[i.value])):VA(n)?e.push(L3("operator_name",_W(n))):PW[i.value]||e.push(i);break;case"level":let o={subscript:i.subscript&&i.subscript.length>0?Bp(i.subscript):void 0,superscript:i.superscript&&i.superscript.length>0?Bp(i.superscript):void 0,type:i.type};(o.subscript||o.superscript)&&e.push(o);break;case"fraction":e.push({denominator:Bp(i.denominator),numerator:Bp(i.numerator),type:i.type});break;case"radical":e.push({index:i.index?Bp(i.index):void 0,radicand:Bp(i.radicand),type:i.type});break;case"terminal":FW(r.slice(t))?(e.push({type:"command",value:"\\ldots"}),t+=2):e.push({type:i.type,value:bE.hasOwnProperty(i.value)?bE[i.value]:i.value});break;case"typeform":e.push(i);break;case"greek":e.push({type:i.type,value:bE.hasOwnProperty(i.value)?bE[i.value]:i.value});break;default:throw new Error(`Unexpected item:
`+JSON.stringify({group:r,item:i}))}}return e}function _W(r){let e=[];for(let t of r)e.push(M3(t));return e}function FW(r){let e=0;for(let t=0;t<Math.min(3,r.length);t++){let i=r[t];i.type==="terminal"&&i.value==="."&&e++}return e===3}function AA(r){if(!r.hash)throw r;return{_diagnostic:{expected:r.hash.expected,message:r.message,text:r.hash.text,token:r.hash.token},location:r.hash.loc}}var O3=IW();O3.parser.yy=T3;function P3(r){try{return{isError:!1,value:O3.parser.parse(r)}}catch(e){return{isError:!0,error:AA(e)}}}function RW(r){return r.isError}function NW(r,e){return RW(r)?r:{isError:!1,value:e(r.value)}}function Vf(r,e){let t=NW(r,e);return r.warnings&&(t.warnings=r.warnings),t}function BW(r){return Vf(P3(r),e=>XW(Bp(e)))}var g3={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"};function fA(r){return/^[a-z]$/.test(r.value)?r.value.toUpperCase():/^[A-Z]$/.test(r.value)?","+r.value:/^[0-9.]$/.test(r.value)||/^[+\-()]$/.test(r.value)?r.value:g3.hasOwnProperty(r.value)?g3[r.value]:"[terminal: "+r.value+"]"}var m3={"\\Vert":"\\\\","\\cdot":"*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\ne":" /.K ","\\neq":" /.K ","\\approx":" @:@: ","\\nparallel":" /$L ","\\parallel":" $L ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\to":" $O ","\\vert":"\\"},f3={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function y3(r){return m3.hasOwnProperty(r.value)?m3[r.value]:r.value.slice(1).toUpperCase()+" "}function KW(r){return f3.hasOwnProperty(r.value)?f3[r.value]:r.value.slice(1).toUpperCase()+" "}function UW(r){return r.value==="\\space"}function HW(r,e){return r.isStartOfLine&&/^-?$/.test(e)||/\s-?$/.test(e)||r.wasFraction}function qW(r){return r.value==="\\sum"||r.value==="\\prod"}function zW(r,e){if(e>=r.length)return!1;let t=r[e];if(t.type==="terminal"){if(/^[0-9]$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^[0-9]$/.test(t.value)}return!1}function Up(r,e){let t="",i=r.levelIndicator,n=0,o=!1;for(let s=0;s<e.length;s++){zW(e,s)&&(i===""&&/[A-Z]$/.test(t)?t+=Od(i):HW(r,t)&&(t+="#"));let a=e[s],l=s<e.length-1?e[s+1]:null;switch(a.type!=="level"&&i!==r.levelIndicator&&(yA(a)?i="":(r.wasModifiedExpression&&r.levelIndicator===""?r=Sl(r,{wasModifiedExpression:!1}):t+=Od(r.levelIndicator),i=r.levelIndicator)),a.type){case"terminal":!r.wasModifiedExpression&&i!==""&&yA(a)?t+=" "+Od(i)+fA(a).trim()+" ":t+=fA(a),a.value==="."&&l&&(l.type==="terminal"&&/^[^_\d,]/.test(fA(l))||l.type==="greek")&&(t+='"'),r=Sl(r,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if(!UW(a)){let h=qW(a);h&&(t+='"'),!h&&i!==""&&yA(a)?t+=" "+Od(i)+y3(a).trim()+" ":t+=y3(a),r=Sl(r,{wasFraction:!1,wasModifiedExpression:h,wasRomanCommand:!0})}break;case"greek":t+=KW(a),r=Sl(r,{wasFraction:!1});break;case"fraction":let c=$W(r,a);t+=c.value,n=Math.max(n,c.fractionLevel),r=Sl(r,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":let u=WW(r,a);t+=u.value,n=Math.max(n,u.fractionLevel),r=Sl(r,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!r.wasModifiedExpression&&r.wasRomanCommand?(o=/\s$/.test(t),o&&(t=t.replace(/\s$/,""))):o=!1;let p=t.length>0&&/[A-Za-z]/.test(t[t.length-1])===!0,g=jW(r,p,o,a);t+=g.value,i=g.levelIndicator,r=Sl(r,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":t+=Up(r,a.value).value,a.name==="operator_name"&&(t+=" "),r=Sl(r,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1});break}}return{fractionLevel:n,levelIndicator:i,value:t}}function $W(r,e){r=Sl(r,{isStartOfLine:!1});let t=Up(r,e.numerator),i=Up(r,e.denominator),n=Math.max(t.fractionLevel,i.fractionLevel),o="";for(let a=0;a<n;a++)o+=",";let s=o+"?"+t.value;return t.levelIndicator!==r.levelIndicator&&(s+=Od(r.levelIndicator)),/\.$/.test(t.value)&&(s+='"'),s+=o+"/"+i.value,i.levelIndicator!==r.levelIndicator&&(s+=Od(r.levelIndicator)),/\.$/.test(i.value)&&(s+='"'),s+=o+"#",{fractionLevel:n+1,value:s}}function WW(r,e){let t=r.radicalLevel,i="",n="";for(let s=0;s<t;s++)n+=".";if(e.index){i+=n+"<";let s=Up(Sl(r,{isStartOfLine:!1}),e.index);i+=s.value,/\.$/.test(s.value)&&(i+='"'),s.levelIndicator!==r.levelIndicator&&(i+=Od(r.levelIndicator)),i+=">"}else i+=n+">";let o=Up(Sl(r,{isStartOfLine:!1,radicalLevel:t+1}),e.radicand);return i+=o.value,/\.$/.test(o.value)&&(i+='"'),o.levelIndicator!==r.levelIndicator&&(i+=Od(r.levelIndicator)),i+=n+"]",{fractionLevel:o.fractionLevel,value:i}}function jW(r,e,t,i){let n=r.levelIndicator,o="",s=JW(i.superscript);if(o+=s,i.subscript){r.wasModifiedExpression&&(o+="%"),n=r.levelIndicator+";";let a=Up(Sl(r,{isStartOfLine:!1,levelIndicator:n}),i.subscript);e&&/^[0-9]*(\.|\,)?[0-9]+$/.test(a.value)&&n.length<=1?n=r.levelIndicator:!r.wasModifiedExpression&&i.subscript[0]&&i.subscript[0].type!=="level"&&(o+=Od(n)),o+=a.value,/\.$/.test(a.value)&&(o+='"')}if(i.superscript){r.wasModifiedExpression&&(o+="<"),n=r.levelIndicator+"^";let a=Up(Sl(r,{isStartOfLine:!1,levelIndicator:n}),i.superscript.slice(s.length));!r.wasModifiedExpression&&i.superscript[0]&&i.superscript[0].type!=="level"&&a.value!==""&&(o+=Od(n)),o+=a.value,/\.$/.test(a.value)&&(o+='"')}return r.wasModifiedExpression?o+="]":r.wasRomanCommand&&t&&(o+=" ",n=n.slice(0,n.length-1)),{levelIndicator:n,value:o}}function JW(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="'";else break;return e}function Od(r){return r||'"'}function YW(){return{isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1}}function Sl(r,e){return Gf(Gf({},r),e)}function yA(r){return r.type==="terminal"||r.type==="command"?/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(r.value):!1}function XW(r){let e=YW();return Up(e,r).value}function QW(r){return Vf(P3(r),e=>d9(Bp(e)))}var b3={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"};function ZW(r,e,t){let i="",n=e.value,o=t&&t.type==="terminal"?t.value:"";return _3(n,r)&&(i+=";"),/^[\D]/.test(n)&&(r=Pd(r,{wasNumber:!1})),/^[a-z]$/.test(n)?r.capsLock?(r=Pd(r,{capsLock:!1}),i+=",'"+n.toUpperCase()):i+=n.toUpperCase():/^[A-Z]$/.test(n)?r.capsLock?i+=n:/[A-Z]/.test(o)?(r=Pd(r,{capsLock:!0}),i+=",,"+n):i+=","+n:(r=Pd(r,{capsLock:!1}),/^[0-9.]$/.test(n)?i+=n9(n):b3.hasOwnProperty(n)?i+=b3[n]:i+="[terminal: "+n+"]"),{value:i,ctx:r}}var w3={"\\Vert":"_\\_\\","\\cdot":'"4',"\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\ne":'"7@:',"\\neq":'"7@:',"\\approx":"^9","\\parallel":"#L","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\to":":O","\\vert":"_\\"},x3={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function e9(r,e){let t;return w3.hasOwnProperty(r.value)?t=w3[r.value]:t=r.value.slice(1).toUpperCase()+" ",_3(t,e)&&(t=";"+t),/^[\D]/.test(t)&&(e=Pd(e,{wasNumber:!1})),{value:t,ctx:e}}function t9(r){return x3.hasOwnProperty(r.value)?x3[r.value]:r.value.slice(1).toUpperCase()+" "}function r9(r){return r.value==="\\space"}function i9(r,e){if(e<r.length){let t=r[e];if(t.type==="terminal"){if(/^\d$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^\d$/.test(t.value)}}return!1}function n9(r){let e="",t="A".charCodeAt(0)-1;for(let i of r)i===","?e+="1":i==="."?e+="4":i==="0"?e+="J":e+=String.fromCharCode(t+Number(i));return e}function Hp(r,e){let t,i,n="",o=!0;for(let s=0;s<e.length;s++){i9(e,s)?(r=Pd(r,{wasNumber:!0}),o&&(n+="#",o=!1)):o=!0;let a=e[s];switch(a.type){case"terminal":let l=s<e.length-1?e[s+1]:void 0;t=ZW(r,a,l),r=t.ctx,n+=t.value,n[n.length-1]===" "&&(o=!0);break;case"command":r9(a)||(i=e9(a,r),r=i.ctx,n+=i.value,n[n.length-1]===" "&&(o=!0));break;case"greek":n+=t9(a),n[n.length-1]===" "&&(o=!0);break;case"fraction":let c=o9(r,a);n+=c.value,r=c.ctx,o=!1;break;case"radical":let u=s9(r,a);n+=u.value,o=!0;break;case"level":let p=a9(r,a);n+=p.value,r=p.ctx,o=!0;break;case"typeform":let g=Hp(r,a.value).value;n+=g,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(g)&&(n+=" ");break}}return{ctx:r,value:n}}function _3(r,e){return e.wasNumber&&/^[A-Ja-j]/.test(r)}function o9(r,e){let t=Hp(r,e.numerator),i=Hp(r,e.denominator),n;return xA(t.value)&&xA(i.value)?(r=Pd(r,{wasNumber:!0}),n=t.value+"/"+i.value.slice(1)):(r=Pd(r,{wasNumber:!1}),n="("+t.value+"./"+i.value+")"),{ctx:r,value:n}}function xA(r){return/^\#[A-J41]+$/.test(r)}function s9(r,e){let t="%",i=Hp(r,e.radicand);if(e.index){let n=Hp(r,MA(A3({"^":e.index})));t+=n.value,/\#[A-J]$/.test(n.value)&&/^[A-J]/.test(i.value)&&(t+=";")}return t+=i.value+"+",{ctx:r,value:t}}function a9(r,e){let t="",i=l9(e.superscript);t+=i;let n;if(e.subscript){let o=Hp(r,e.subscript);C3(e.subscript,o.value,0)?n="<"+v3(o.value)+">":n=o.value,r=Pd(r,{wasNumber:o.ctx.wasNumber}),n!==""&&(t+="5"+n)}if(e.superscript){let o=Hp(r,e.superscript.slice(i.length));C3(e.superscript,o.value,i.length)?n="<"+v3(o.value)+">":n=o.value,r=Pd(r,{wasNumber:o.ctx.wasNumber}),(i===""||n!=="")&&(t+="9"+n)}return{ctx:r,value:t}}function v3(r){return/^;/.test(r)?r.slice(1):r}function l9(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="7";else break;return e}function C3(r,e,t){let i=r[0],n=(e.match(/\</g)||[]).length,o=/^["|\.|_]?\</.test(e),s=(e.match(/\>/g)||[]).length,a=/["|\.|_]?\>$/.test(e);return!xA(e)&&r.length-t>1&&n===0&&s===0||n>0&&s>0&&(!o||!a)||n>1||s>1||i&&i.type==="typeform"}function c9(){return{capsLock:!1,wasNumber:!1}}function Pd(r,e){return Gf(Gf({},r),e)}function d9(r){let e=c9();return Hp(e,r).value}var vA={};kA(vA,{baseline:()=>m9,command:()=>p9,comparison:()=>g9,expression:()=>x9,fraction:()=>y9,greek:()=>C9,group:()=>D9,level:()=>LA,level_with_comparison:()=>h9,modified_expression:()=>b9,primes:()=>f9,radical:()=>w9,simple_subscript:()=>v9,terminal:()=>u9});function u9(r){return{type:"terminal",value:r}}function p9(r){return{type:"command",value:"\\"+r.trim()+" "}}var F3={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$O:"\\to ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","@:@:":"\\approx","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim "};function h9(r){let e=/[\^;]+/.exec(r),t=e?e.toString():"",i=r.slice(LA.length);return{type:"level_with_comparison",level:t,value:F3[i]}}function g9(r){return{type:"comparison",value:F3[r]}}function LA(r){return{type:"level",value:r}}function m9(){return LA("")}function f9(r){return{type:"primes",value:r}}function y9(r,e){return{type:"fraction",numerator:r,denominator:e}}function b9(r,e,t){return{type:"modified_expression",expression:r,under:e,over:t}}function w9(r,e){return{type:"radical",value:r,index:e}}function x9(r){return{type:"expression",value:r}}function v9(r,e){return{type:"simple_subscript",base:r,subscript:e}}var D3={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function C9(r){if(D3.hasOwnProperty(r))return D3[r]+" ";throw new Error("Unknown Greek letter")}function D9(...r){return Array.prototype.concat.apply([],r)}var OA=k3(),DE=OA.parser.lexer,sg=Object.create(DE),S9=sg,Gw=OA.parser.terminals_,ko=OA.parser.symbols_;sg.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],this.canAcceptPrimes=!1,DE.setInput.call(this,r,e)};sg.lex=function(){let r=-1;if(!this)return r;if(this.outputQueue.length)return this.outputQueue.shift();let e=DE.lex.call(this);for(;Gw[e]==="UNKNOWN"||!this.canAcceptPrimes&&Gw[e]==="PRIMES";)this.warn(),e=DE.lex.call(this);this.canAcceptPrimes=!0;let t,i,n=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(Gw[e]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"RADICAL_INDEX":n===ko.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(n)),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"OPEN_RADICAL":n===ko.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"SLASH":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===ko.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===ko.SLASH){t=!0;break}else if(i===ko.OPEN_FRAC){this.addMissingToken(ko.SLASH),t=!0;break}else this.pushCloseTokens(i);if(!t)return this.warn(),this.canAcceptPrimes=!1,this.lex();break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===ko.OPEN_RADICAL){t=!0;break}else if(i===ko.RADICAL_INDEX){t=!0,this.addMissingToken(ko.OPEN_RADICAL);break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_MODEXP":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===ko.OPEN_MODEXP){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)i=this.delimiterStack.pop()||-1,this.pushCloseTokens(i);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};sg.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};sg.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};sg.pushCloseTokens=function(r){switch(Gw[r]){case"OPEN_FRAC":this.addMissingToken(ko.SLASH),this.addMissingToken(ko.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(ko.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(ko.OPEN_RADICAL),this.addMissingToken(ko.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(ko.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(ko.CLOSE_MODEXP);break}};sg.pushOpenTokens=function(r){switch(Gw[r]){case"SLASH":this.addMissingToken(ko.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(ko.OPEN_FRAC),this.addMissingToken(ko.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(ko.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(ko.OPEN_MODEXP);break}};var E9=k3();function k9(r,e){e||(e={});let t=E9.parser,i=Object.create(t);i.yy=vA,i.yy.warnOrError=o=>{i.parseError(o,{recoverable:!1})};let n=Object.create(t);n.yy=Gf({warnings:[]},vA),n.yy.warnOrError=o=>{n.yy.warnings.push(o)},n.lexer=S9,e.strict?t=i:t=n;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(o){return{error:AA(o),isError:!0}}}function Kp(r,e){let t="",i=e,n="",o=!1,s="",a="",l=G9(r);for(let c=0;c<r.length;c++){let u=r[c],p=c+1<r.length?r[c+1]:null;switch(u.type){case"terminal":let g=I3(r.slice(c));g.value!==""?(t+=g.value,c+=g.terminalCount-1,o=o||g.modified):u.value===" "?(o?(n=s,t+=kw(i,n),i=n):t+="\\ ",o=!1):(l[c]===vE?t+="\\left":l[c]===CA&&(t+="\\right"),t+=u.value);break;case"comparison":n="",t+=kw(i,n),i=n,o=!1,t+=u.value;break;case"level_with_comparison":t+=kw(i,u.level),i=u.level,o=!1,t+=u.value;break;case"command":let h=u.value.slice(1).trim();p&&p.type==="terminal"&&/[a-z]/.test(p.value)?(t+=h,o=!1):VA(h)?(t+="\\operatorname{"+h+"}",o=!0):(t+=u.value,o=!0),s=i;break;case"expression":t+=u.value;break;case"fraction":t+=M9(u.numerator,u.denominator,i);break;case"modified_expression":t+=Kp(u.expression,i)+" ",u.under&&(t+="_{"+Kp(u.under,i)+"}"),u.over&&(t+="^{"+Kp(u.over,i)+"}");break;case"radical":t+="\\sqrt",u.index&&(t+="["+Kp(u.index,i)+"]"),t+="{"+Kp(u.value,i)+"}";break;case"simple_subscript":i===""?(t+=u.base.value+"_{"+u.subscript.value+"}",u.base.type==="command"&&(o=!0,s=i)):t+=u.base.value+u.subscript.value;break;case"level":t+=kw(i,u.value,a),i=u.value,u.value==="^"&&a!==""&&(a="");break;case"primes":p&&p.type==="level"&&p.value===";"?a=u.value:i!==""?(t+=Array(u.value.length+1).join("\\prime "),a=""):(t+=u.value,a="");break}}return t+=kw(i,e)+a,t.replace(/([^\\])( )$/,"$1")}var vE=1,CA=-1,wE=0,bA=2;function G9(r){let e=[],t=[];for(let i=0;i<r.length;i++){let n=r[i];if(I9(n))e.push({direction:vE,index:i}),t.push(wE);else if(V9(n)){for(;e.length&&e[e.length-1].direction===bA;)e.pop();if(e.length){let o=e.pop();if(o){let s=o.index;t[s]=vE,t.push(CA)}}else t.push(wE)}else if(T9(n))if(e.length&&e[e.length-1].direction===bA){let o=e.pop();if(o){let s=o.index;t[s]=vE,t.push(CA)}}else e.push({direction:bA,index:i}),t.push(wE);else t.push(wE)}return t}function I9(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function V9(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function T9(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function M9(r,e,t){return"\\frac{"+Kp(r,t)+"}{"+Kp(e,t)+"}"}function kw(r,e,t){let i="",n,o,s,a=Math.max(r.length,e.length);for(n=0;n<a&&r[n]===e[n];n++);for(o=r.length-1;o>=n;o--)i+="}";for(s=n;s<e.length;s++)e[s]==="^"&&(t&&(i+=t),i+="^{"),e[s]===";"&&(i+="_{");return i}function A9(r){return Kp(r,"")}function L9(r,e){return e&&e.operatorNames?GE(e.operatorNames):IE(),Vf(k9(r,e),A9)}var PA=G3(),SE=PA.parser.lexer,ag=Object.create(SE),O9=ag,EE=PA.parser.terminals_,gs=PA.parser.symbols_;ag.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],SE.setInput.call(this,r,e)};ag.lex=function(){let r=-1;if(this.outputQueue.length)return this.outputQueue.shift();let e=SE.lex.call(this);for(;EE[e]==="UNKNOWN";)this.warn(),e=SE.lex.call(this);let t,i,n=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(EE[e]){case"OPEN_FRAC":this.delimiterStack.push(e);break;case"OPEN_GROUP":this.delimiterStack.push(e);break;case"RADICAL_WITH_INDEX":n===gs.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(n)),this.delimiterStack.push(e);break;case"RADICAL":n===gs.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e);break;case"OVER":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===gs.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e),this.delimiterStack.push(e);break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===gs.OVER){t=!0;break}else if(i===gs.OPEN_FRAC){this.outputQueue.push(gs.OVER),t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_GROUP":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===gs.OPEN_GROUP){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===gs.RADICAL||i===gs.RADICAL_WITH_INDEX){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)i=this.delimiterStack.pop()||-1,this.pushCloseTokens(i);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};ag.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};ag.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};ag.pushCloseTokens=function(r){switch(EE[r]){case"OPEN_FRAC":this.addMissingToken(gs.OVER),this.addMissingToken(gs.CLOSE_FRAC);break;case"OVER":this.addMissingToken(gs.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(gs.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(gs.CLOSE_RADICAL);break}};ag.pushOpenTokens=function(r){switch(EE[r]){case"OVER":this.addMissingToken(gs.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(gs.OPEN_FRAC),this.addMissingToken(gs.OVER);break;case"CLOSE_GROUP":this.addMissingToken(gs.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(gs.RADICAL);break}};var DA={};kA(DA,{basic_level:()=>F9,bracketed_level:()=>R9,command:()=>_9,expression:()=>U9,fraction:()=>B9,greek:()=>q9,group:()=>H9,primes:()=>N9,radical:()=>K9,terminal:()=>P9,to_number:()=>z9});function P9(r){return{type:"terminal",value:r}}function _9(r){return{type:"command",value:r}}function F9(r,e){return{type:"basic_level",level:r,value:e}}function R9(r,e,t,i){return{type:"bracketed_level",level:r,lbrack:e,value:t,rbrack:i}}function N9(r){return{type:"primes",value:r.length>0?Array(r.length+1).join("'"):""}}function B9(r,e){return{type:"fraction",numerator:r,denominator:e}}function K9(r,e){return{type:"radical",value:r,index:e}}function U9(r){return{type:"expression",value:r}}function H9(...r){return Array.prototype.concat.apply([],r)}var S3={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function q9(r){if(S3.hasOwnProperty(r))return S3[r]+" ";throw new Error("Unknown Greek letter")}function z9(r){let e="",t="A".charCodeAt(0)-1;for(let i of r)i==="4"?e+=".":i==="J"?e+="0":e+=i.charCodeAt(0)-t;return e}var $9=G3();function W9(r,e){e||(e={});let t=$9.parser,i=Object.create(t);i.yy=DA;let n=Object.create(t);n.yy=Gf({warnings:[]},DA),n.lexer=O9,e.strict?t=i:t=n;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(o){return{error:AA(o),isError:!0}}}function og(r,e){let t="",i=!1,n="",o=j9(r);for(let s=0;s<r.length;s++){let a=r[s],l=s+1<r.length?r[s+1]:null;switch(a.type){case"terminal":let c=I3(r.slice(s));c.value!==""?(t+=c.value,s+=c.terminalCount-1):a.value===" "&&!i?t+="\\ ":(o[s]===CE?t+="\\left":o[s]===SA&&(t+="\\right"),t+=a.value),i=!1;break;case"command":let u=a.value.slice(1).trim();l&&l.type==="terminal"&&/[a-z]/.test(l.value)?(t+=u,i=!1):VA(u)?(t+="\\operatorname{"+u+"}",i=!0):(t+=a.value,i=!0);break;case"expression":t+=a.value;break;case"fraction":t+=Q9(a.numerator,a.denominator);break;case"radical":t+="\\sqrt",a.index&&(t+="["+og(a.index)+"]"),t+="{"+og(a.value)+"}";break;case"basic_level":t+=Z9(a.level,a.value,n),a.level==="9"&&(n="");break;case"bracketed_level":t+=ej(a.level,a.lbrack,a.value,a.rbrack,n),a.level==="9"&&(n="");break;case"primes":l&&(l.type==="basic_level"||l.type==="bracketed_level")&&l.level==="5"?n=a.value:e&&e!==""?(t+=Array(a.value.length+1).join("\\prime "),n=""):(t+=a.value,n="");break}}return t+=n,t.replace(/([^\\])( )$/,"$1")}var CE=1,SA=-1,xE=0,wA=2;function j9(r){let e=[],t=[];for(let i=0;i<r.length;i++){let n=r[i];if(J9(n))e.push({direction:CE,index:i}),t.push(xE);else if(Y9(n)){for(;e.length&&e[e.length-1].direction===wA;)e.pop();if(e.length){let o=e.pop();if(o){let s=o.index;t[s]=CE,t.push(SA)}}else t.push(xE)}else if(X9(n))if(e.length&&e[e.length-1].direction===wA){let o=e.pop();if(o){let s=o.index;t[s]=CE,t.push(SA)}}else e.push({direction:wA,index:i}),t.push(xE);else t.push(xE)}return t}function J9(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function Y9(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function X9(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function Q9(r,e){return"\\frac{"+og(r)+"}{"+og(e)+"}"}function Z9(r,e,t){let i="",n="{"+og(e,r)+"}";return r==="9"?i+=t+"^"+n:r==="5"&&(i+="_"+n),i}function ej(r,e,t,i,n){let o="",s="{"+e+og(t,r)+i+"}";return r==="9"?o+=n+"^"+s:r==="5"&&(o+="_"+s),o}var tj=og;function rj(r,e){return e&&e.operatorNames?GE(e.operatorNames):IE(),Vf(W9(r,e),t=>tj(t,""))}var R3=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,N3=10240;function ij(r){return String.fromCharCode(N3+r)}function nj(r){return r.charCodeAt(0)-N3}function oj(r){return R3[r]}function sj(r){return R3.indexOf(r)}function aj(r){let e="";for(let t of r)e+=ij(sj(t));return e}function B3(r){let e="";for(let t of r)e+=oj(nj(t));return e}function lj(r){return B3(r).replace(/[@-^]/g,e=>String.fromCharCode(e.charCodeAt(0)+32))}function cj(r){let e="";if(r)for(let t of r){let i=t.charCodeAt(0);96<=i&&i<=127&&(i-=32,t=String.fromCharCode(i)),32<=i&&i<=95&&(t=aj(t),i=t.charCodeAt(0)),10305<=i&&i<=10495&&(i=10240+(i-1024)%64,t=String.fromCharCode(i)),10240<=i&&i<=10304?e+=t:e+=String.fromCharCode(10240)}return e}function dj(r){for(let e=0;e<r.length;e++){let t=r.charCodeAt(e);if(t<10240||t>10304)return!1}return!0}function K3(r){if(!dj(r))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}function _A(r,e){return K3(r),L9(qs.toBrailleAscii(r),e)}function Gu(r,e){return e&&e.operatorNames?GE(e.operatorNames):IE(),Vf(BW(r),qs.coerceToSixDotCells)}function FA(r,e){return K3(r),rj(qs.toBrailleAscii(r),e)}function Iu(r,e){return e&&e.operatorNames?GE(e.operatorNames):IE(),Vf(QW(r),qs.coerceToSixDotCells)}var qs={coerceToSixDotCells:cj,toBrailleAscii:B3,toExpandedBrailleAscii:lj},uj="1.0.3";var pj=10240;function hj(r,e,t,i,n){let{dotSpacing:o}=r,s=1+o;var a=n.charCodeAt(0)-pj;a&1&&e.fillRect(t,i,1,1),a&2&&e.fillRect(t,i+s,1,1),a&4&&e.fillRect(t,i+2*s,1,1),a&8&&e.fillRect(t+s,i,1,1),a&16&&e.fillRect(t+s,i+s,1,1),a&32&&e.fillRect(t+s,i+2*s,1,1)}function ME(r,e){let{x:t,y:i,width:n,height:o}=e,s=r.getImageData(t,i,n,o).data;for(let a=3;a<s.length;a+=4)if(s[a]!==0)return!1;return!0}function gj(r,e){let{x:t,y:i,width:n,height:o}=e,s=r.getImageData(t,i,n,o).data;for(let a=3;a<s.length;a+=4)if(s[a]===0)return!1;return!0}function RA(r,e,t,i,n){return ME(e,LE(r,t,i,n))}function mj(r,e,t,i,n){let{dotSpacing:o}=r,s=3+2*o;for(var a=0;a<n.length;a++)hj(r,e,t+s*a,i,n[a])}function Tu(r,e){let{dotSpacing:t}=r;return(2+t)*e.length+(1+t)*(e.length-1)}function AE(r,e){let{dotSpacing:t}=r;return 3+2*t}function LE(r,e,t,i){let{cellPadding:n}=r;return{x:e-n,y:t-n,width:Tu(r,i)+2*n,height:AE(r,i)+2*n}}function VE(r,e){if(!r)return e;let t=Math.min(r.x,e.x),i=Math.min(r.y,e.y),n=Math.max(r.x+r.width,e.x+e.width)-t,o=Math.max(r.y+r.height,e.y+e.height)-i;return{x:t,y:i,width:n,height:o}}function U3(r,e,t){return Math.min(Math.max(r,e),t)}function Iw(r,e,t,i,n){return{x:U3(t,0,e.canvas.width-Tu(r,n)),y:U3(i,0,e.canvas.height-AE(r,n))}}function Vw(r,e,t,i,n){let o=e.fillStyle;e.fillStyle="white";let s=LE(r,t,i,n);e.fillRect(s.x,s.y,s.width,s.height),e.fillStyle="black",mj(r,e,t,i,n),e.fillStyle=o}function NA(r,e,t,i){let{cellPadding:n}=r;return{x:Math.round(e-(Tu(r,i)+n)),y:t}}function fj(r){return r.replace(/\u283C(?!$)/g,"")}function Vu(r,e){let t=e==="nemeth"?Gu(r):Iu(r);return t.isError?"":fj(t.value)}function Mf(r,e){return e>=0?r*Math.pow(10,e):r/Math.pow(10,-e)}function q3(r,e,t,i){let[n,o]=t,s=Math.ceil(Math.log(o-n)/Math.LN10)-1,a=s,l=5,c=15;e:for(let p=s;s-p<4;p--)for(let g of[5,2,1]){let h=Mf(g,p),b=Math.floor(n/h)+1,C=Math.ceil(o/h)-1;var u=Math.abs(i(h)-i(0));let D=Vu(String(Mf(b*g,p)),e),S=Vu(String(Mf(C*g,p)),e);if(u<Tu(r,D)+Tu(r," ")||u<Tu(r,S)+Tu(r," ")||C-b>=c)break e;a=p,l=g}return{int:l,exp:a}}function z3(r,e,t){return q3(r,e,[t.viewport.xmin,t.viewport.xmax],i=>t.mapx(i))}function yj(r,e,t){return t.viewport.isSquare(t.screen,{xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale})?z3(r,e,t):q3(r,e,[t.viewport.ymin,t.viewport.ymax],i=>t.mapy(i))}function H3(r,e){let{int:t,exp:i}=r,[n,o]=e,s=Math.ceil(n/Mf(t,i)),a=Math.floor(o/Mf(t,i)),l=[];for(var c=s;c<=a;c++)l.push(Mf(c*t,i));return l}function bj(r,e,t){return{x:H3(z3(r,e,t),[t.viewport.xmin,t.viewport.xmax]),y:H3(yj(r,e,t),[t.viewport.ymin,t.viewport.ymax])}}function $3(r,e,t,i,n){if(t.margins===void 0||e===void 0)return;let o=wj(i),s=t.margins,a=__dcg_shared_module_exports__['a']({},e.settings),l=a.showGrid&&xj(i),c=!!a.showXAxis,u=!!a.showYAxis,p=!!a.xAxisNumbers,g=a.xAxisArrowMode,h=!!a.yAxisNumbers,b=a.yAxisArrowMode,C=o.graphLineWidth,D={showGrid:!1,xAxisNumbers:!1,xAxisArrowMode:"NONE",yAxisNumbers:!1,yAxisArrowMode:"NONE",showXAxis:!1,showYAxis:!1,graphLineWidth:C,pointLineWidth:2.5,curveOpacity:1,globalCurveColor:"#000",disableFill:!0};for(let ae in D)e.settings[ae]=D[ae];let S=r.width-s.right-s.left,V=r.height-s.top-s.bottom,k=new Ld(S,V),T=e.getProjection().viewport;e.settings.squareAxes&&(T=T.squareCrop(k,e.settings));let A=new Oc(k,T,e.settings),R=r.getContext("2d"),P=document.createElement("canvas");P.width=S,P.height=V;let W=P.getContext("2d"),H=document.createElement("canvas");H.width=S,H.height=V;let j=H.getContext("2d"),ne=document.createElement("canvas");ne.width=S,ne.height=V;let le=ne.getContext("2d"),w=document.createElement("canvas");w.width=S,w.height=V;let B=w.getContext("2d"),q=document.createElement("canvas");q.width=S,q.height=V;let M=q.getContext("2d");if(R!==null&&B!==null&&W!==null&&le!==null&&M!==null&&j!==null){e.settings.disableFill=!0,e.screenshotToCanvas(w,{width:S,height:V,targetPixelRatio:1,transparentBackground:!0}),e.settings.disableFill=!1,e.screenshotToCanvas(P,{width:S,height:V,targetPixelRatio:1,transparentBackground:!0}),R.fillStyle="white",R.fillRect(0,0,r.width,r.height);let ae=Math.round(A.mapx(0)),se=Math.round(A.mapy(0)),ge=a.xAxisLabel!==""?a.xAxisLabel.replace(/ /g,"\\ "):"x",he=a.yAxisLabel!==""?a.yAxisLabel.replace(/ /g,"\\ "):"y",ye=1;if(c&&A.coordsAreOnscreen(S-6,se-8,0)){let de=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{cellPadding:o.cellPadding+ye}),Ee=2+2*AE(de,ge),U=S-2,ce=se-Ee,Oe=Vu(ge,n);({x:U,y:ce}=NA(de,U,ce,Oe)),{x:U,y:ce}=Iw(de,W,U,ce,Oe),Vw(de,M,U,ce,Oe)}if(u&&A.coordsAreOnscreen(ae+4,1,0)){let de=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{cellPadding:o.cellPadding+ye}),Ee=ae+4,U=1,ce=Vu(he,n);({x:Ee,y:U}=Iw(de,W,Ee,U,ce)),Vw(de,M,Ee,U,ce)}let{x:fe,y:Se}=bj(o,n,A);if(c){let de;for(let Ee of fe){if(Ee===0&&u)continue;let U=Math.round(A.mapx(Ee));if(!(U<2||U>A.screen.width-2)&&p){let ce=Tu(o,Vu("-1",n))-Tu(o,Vu("1",n)),Oe=Ee<0?ce+1:1,Qe=U-Oe,Ct=se+4,Je=Vu(""+Ee,n);({x:Qe,y:Ct}=Iw(o,M,Qe,Ct,Je)),RA(o,B,Qe,Ct,Je)&&(Vw(o,M,Qe,Ct,Je),de=VE(de,LE(o,Qe,Ct,Je)))}}o.embossPatternInequalities&&de&&(de=VE(de,{x:0,y:se,width:S,height:0}),le.fillStyle="white",le.fillRect(de.x,de.y,de.width,de.height))}if(u){let de;for(let Ee of Se){if(Ee===0&&c)continue;let U=Math.round(A.mapy(Ee));if(U<2||U>A.screen.height-2)continue;let ce=-Math.ceil(AE(o," ")/2);if(h){let Oe=ae-4,Qe=U+ce,Ct=Vu(""+Ee,n);({x:Oe,y:Qe}=NA(o,Oe,Qe,Ct)),{x:Oe,y:Qe}=Iw(o,M,Oe,Qe,Ct),RA(o,B,Oe,Qe,Ct)&&(Vw(o,M,Oe,Qe,Ct),de=VE(de,LE(o,Oe,Qe,Ct)))}}o.embossPatternInequalities&&de&&(de=VE(de,{x:ae,y:0,width:0,height:V}),le.fillStyle="white",le.fillRect(de.x,de.y,de.width,de.height))}if(c&&u){let de=ae-2,Ee=se+2,U=Vu(p||h?"0":"o",n);({x:de,y:Ee}=NA(o,de,Ee,U)),A.coordsAreOnscreen(de,Ee,0)&&({x:de,y:Ee}=Iw(o,M,de,Ee,U),RA(o,B,de,Ee,U)&&Vw(o,M,de,Ee,U))}for(let de of fe){let Ee=Math.round(A.mapx(de));Ee<2||Ee>A.screen.width-2||u&&de===0||l&&Tw(le,"white",Ee-1,0,V,3)}for(let de of Se){let Ee=Math.round(A.mapy(de));Ee<2||Ee>A.screen.height-2||c&&de===0||l&&Mw(le,"white",Ee-1,0,S,3)}c&&Mw(le,"white",se-3,0,S,7),u&&Tw(le,"white",ae-3,0,V,7);for(let de of fe){let Ee=Math.round(A.mapx(de));Ee<2||Ee>A.screen.width-2||u&&de===0||(l?Tw(le,TE(i),Ee,0,V):c&&Tw(le,TE(i),Ee,se-3,se+2))}for(let de of Se){let Ee=Math.round(A.mapy(de));Ee<2||Ee>A.screen.height-2||c&&de===0||(l?Mw(le,TE(i),Ee,0,S):u&&Mw(le,TE(i),Ee,ae-3,ae+2))}if(c&&Mw(le,Tf(i),se,0,S),u&&Tw(le,Tf(i),ae,0,V),b!=="NONE"&&(Sj(le,Tf(i),ae,0),b==="BOTH"&&Dj(le,Tf(i),ae,V-1)),g!=="NONE"&&(vj(le,Tf(i),S-1,se),g==="BOTH"&&Cj(le,Tf(i),0,se)),o.embossPatternInequalities)for(let de=0;de<S;de+=6)for(let Ee=0;Ee<V;Ee+=6){let U={x:de,y:Ee,width:3,height:3};gj(W,U)&&ME(le,U)&&ME(B,U)&&ME(M,U)&&Ej(j,"black",de,Ee)}o.embossPatternInequalities||R.drawImage(P,s.left,s.top),R.drawImage(ne,s.left,s.top),R.drawImage(w,s.left,s.top),R.drawImage(q,s.left,s.top),o.embossPatternInequalities&&R.drawImage(H,s.left,s.top)}for(let ae in D)e.settings[ae]=a[ae]}function wj(r){if(r==="etc8"||r==="etc11")return{dotSpacing:0,cellPadding:1,graphLineWidth:1.75,embossPatternInequalities:!0};if(r==="vpmax8"||r==="vpmax11")return{dotSpacing:1,cellPadding:2,graphLineWidth:1,embossPatternInequalities:!1};{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function xj(r){if(r==="etc8"||r==="etc11")return!1;if(r==="vpmax8"||r==="vpmax11")return!0;{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function Tf(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(145, 145, 145)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function TE(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(219, 219, 219)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function Tw(r,e,t,i,n,o=1){let s=r.fillStyle;r.fillStyle=e,r.fillRect(t-1,i,o,n-i),r.fillStyle=s}function Mw(r,e,t,i,n,o=1){let s=r.fillStyle;r.fillStyle=e,r.fillRect(i,t-1,n-i,o),r.fillStyle=s}function vj(r,e,t,i){let n=r.fillStyle;r.fillStyle=e;for(var o=-2;o<=2;o++)r.fillRect(t-Math.abs(o),i-1+o,1,1);r.fillStyle=n}function Cj(r,e,t,i){let n=r.fillStyle;r.fillStyle=e;for(var o=-2;o<=2;o++)r.fillRect(t+Math.abs(o),i-1+o,1,1);r.fillStyle=n}function Dj(r,e,t,i){let n=r.fillStyle;r.fillStyle=e;for(var o=-2;o<=2;o++)r.fillRect(t-1+o,i-Math.abs(o),1,1);r.fillStyle=n}function Sj(r,e,t,i){let n=r.fillStyle;r.fillStyle=e;for(var o=-2;o<=2;o++)r.fillRect(t-1+o,i+Math.abs(o),1,1);r.fillStyle=n}function Ej(r,e,t,i){let n=r.fillStyle;r.fillStyle=e,r.fillRect(t+1,i,1,1),r.fillRect(t,i+1,1,1),r.fillRect(t+1,i+1,1,1),r.fillRect(t+2,i+1,1,1),r.fillRect(t+1,i+2,1,1),r.fillStyle=n}var qp={};qp.vpmax8={width:170,height:220,margins:{left:5,top:15,right:5,bottom:50},name:r=>r.s("graphing-calculator-label-braille-size-vpmax8")};qp.vpmax11={width:230,height:220,margins:{left:15,top:15,right:5,bottom:5},name:r=>r.s("graphing-calculator-label-braille-size-vpmax11")};qp.etc8={width:96,height:96,margins:{left:5,top:15,right:0,bottom:0},name:r=>r.s("graphing-calculator-label-braille-size-etc8")};qp.etc11={width:132,height:134,margins:{left:10,top:15,right:5,bottom:5},name:r=>r.s("graphing-calculator-label-braille-size-etc11")};
var zs=__dcg_shared_module_exports__['h'](X());var{If:Gj}=zs.Components,
OE=class extends zs.Class{
    init(){
        this.grapher=this.props.grapher(),
        this.controller=this.grapher.controller,
        this.width=0,
        this.height=0,
        this.pixelRatio=0
    }
    getDevicePixelRatio(){
        return window.devicePixelRatio||1
    }
    template(){
        return zs.createElement("div",{
            class:zs.const("dcg-graph-outer"),
            role:zs.const("img"),
            "aria-roledescription":()=>this.controller.s("graphing-calculator-narration-graphpaper-label"),
            didMount:e=>this.rootNode=e,
            manageFocus:this.const(Vt({controller:this.controller,location:{type:"graph-paper"}}))
        }, zs.createElement("div",{
            tabindex:()=>this.getShiftTabElementTabIndex(),
            onFocus:()=>{
                let e=this.rootNode.getAttribute("aria-label")||"";
                this.rootNode.setAttribute("aria-label",""),
                this.rootNode.focus(),
                this.rootNode.setAttribute("aria-label",e),
                this.controller.get2dPOIController().handleTabEvent("prev")
            }
        }), zs.createElement(Gj,{
            predicate:()=>this.isIOSAndIframe()
        },()=>zs.createElement("div",{
            style:zs.const("width:1px; height:.5px; pointer-events:none; opacity: 0;"),
            "aria-hidden":zs.const("true")
        },zs.const("text"))),zs.createElement("canvas",{
            class:zs.const("dcg-graph-inner"),
            didMount:e=>{
                this.canvasNode=e,
                this.ctx=this.canvasNode.getContext("2d"),
                this.resize(0,0)
            },
            style:()=>({position:"relative",display:"block",outline:"none","-webkit-transform":this.isIOSAndIframe()?"translate3d(0,-.25px,0)":void 0})
        }))
    }
    getShiftTabElementTabIndex(){
        var t;
        return((t=this.rootNode)==null?void 0:t.getAttribute("tabindex"))!=="0"||this.controller.getActiveTool()!=="selection"||this.rootNode===document.activeElement?"-1":"0"
    }
    isIOSAndIframe(){
        return dp&&du
    }
    resize(e,t,i){
        var n;
        i=i||this.getDevicePixelRatio(),
        !(e===this.width&&t===this.height&&i===this.pixelRatio)&&(
            this.width=e,
            this.height=t,
            this.canvasNode.style.width=e+"px",
            this.canvasNode.style.height=t+"px",
            this.canvasNode.setAttribute("width",""+e*i),
            this.canvasNode.setAttribute("height",""+t*i),
            this.pixelRatio=i,
            this.ctx=this.canvasNode.getContext("2d"),
            (n=this.ctx)==null||n.scale(i,i),
            this.update()
        )
    }
    getAriaLabel(e){
        if(this.grapher.type==="3d")
            return"";
        let t=this.grapher.getAudioTrace();
        if(!t)
            return"";
        let i=this.controller.s("graphing-calculator-narration-graphpaper-label")+". "+t.getAxesDescription();
        return e===0||t.getAudioTraceActive()||t.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})!==void 0&&(di?i+=" "+this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac"):i+=" "+this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows")),i
    }
    updateAria(e,t){
        this.rootNode.setAttribute("aria-hidden",!e||!this.grapher.settings.config.graphpaper?"true":"false"),
        this.rootNode.setAttribute("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex?"0":"-1"),
        this.rootNode.setAttribute("aria-label",this.getAriaLabel(t)),
        this.update()
    }
    speakAriaLabelAgain(){
        let e=this.rootNode.getAttribute("aria-label");
        e&&xe(e)
    }
};
var Aw=class{constructor(e){this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}redrawToCtx(e,t,i,n){this.renderedTabTargets={},this.renderedTabTargetOrder=[],Ks(e,"background-images"),(n===void 0||n.length<__dcg_shared_module_exports__['x'](i))&&(n=__dcg_shared_module_exports__['D'](i));for(let s of n){let a=i[s];a&&a.shouldGraph&&!a.foreground&&kS(a,e,t,this.grapher.clickableObjectsLayer);var o=this.controller.getItemModel(s);if(o&&o.type==="image"&&o.shouldGraph&&Cd(o)){let l=o.formula.dimensions;if(!l||!l.x||!l.y||!l.width||!l.height||!l.radianAngle)continue;for(let c=0;c<l.x.length;c++)if(isFinite(l.x[c])&&isFinite(l.y[c])&&isFinite(l.width[c])&&isFinite(l.height[c])&&isFinite(l.radianAngle[c])){this.renderedTabTargetOrder.push(s),this.renderedTabTargets[s]={id:s,description:this.getComputedDescription(o,c),x:l.x[c],y:l.y[c],radianAngle:l.radianAngle[c],width:l.width[c],height:l.height[c],widthScale:Math.abs(t.mapx(1)-t.mapx(0)),heightScale:Math.abs(t.mapy(1)-t.mapy(0)),screenX:t.mapx(l.x[c]),screenY:t.mapy(l.y[c]),centerId:o.formula.center_reference_id};break}}}Us(e),this.speakAriaAlert()}getOrderedTabTargets(){return this.getTabIndex()===-1?[]:this.renderedTabTargetOrder.map(e=>{var i;let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:void 0,polygonEdge:void 0,description:this.controller.isGeometry()||(i=this.getAriaAlert({id:t.id,includeUsageInstructions:!0}))==null?void 0:i.completeMessage}})}getStyle(e){var t=this.renderedTabTargets[e];if(!t)return;let{screenX:i,screenY:n,radianAngle:o,width:s,height:a,widthScale:l,heightScale:c}=t,u=c/l,p=s*l,g=a*c/u,h=i-p/2,b=n-g/2;var C=`translate(${h}px, ${b}px)`,D=o?` rotate(${o}rad)`:"",S=u===1?"":` scale(1,${u})`;return{position:"absolute",top:0,left:0,transform:C+S+D,width:p+"px",height:g+"px"}}getTabIndex(){if(this.controller.getActiveTool()!=="selection")return-1;var e=this.grapher.settings;return e.config.graphpaper&&e.config.enableTabindex?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?Vs(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getAriaLabel(e){var t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){if(this.controller.isGeometry())return;let e=this.getFocusedImage();if(!e){this.lastAriaAlert=void 0;return}let t=e.id,i=this.getAriaAlert({id:t,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=i,i&&i.completeMessage&&xe(i.completeMessage)}getAriaAlert(e){let{id:t,lastAriaAlert:i,includeUsageInstructions:n}=e;if(t){var o=this.controller.getItemModel(t);if(!(!o||o.type!=="image")){var s=this.renderedTabTargets[t];if(s){i&&i.id!==t&&(i=void 0);var a=i&&i.label,l=s.description,c=a!==l,u=i&&i.coordX,p=i&&i.coordY,g=s.x,h=s.y,b=g!==u||h!==p,C=this.grapher.getProjection(),D=eg(this.controller,g,h),S=l,V=n?this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",k=this.isImageFullyVisible(o,C)?"":this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"),T;return i?c?T=S+k:b?T=D+k:T="":T=S+". "+D+V+k,{id:t,coordX:g,coordY:h,label:l,completeMessage:T}}}}}getFocusedImage(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();return e?this.renderedTabTargets[e.calcId]:void 0}speakImageAttribute(e,t){if(e){var i=this.grapher.getAudioTrace();if(i){var n=this.grapher.getProjection();if(n)switch(t){case"X":xe(qi(this.controller,e.x));break;case"Y":xe(zi(this.controller,e.y));break;case"L":xe(e.description);break}}}}hasNonlinearMoveStrategy(e){if(!e)return!1;var t=this.controller.getItemModel(e);if(!t||t.type!=="expression"||!t.formula)return!1;var i=t.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}isImageFullyVisible(e,t){let i=e.formula.dimensions;if(!i||!i.x||!i.y)return!1;for(let n=0;n<i.x.length;n++)if(!t.coordsAreOnscreen(t.mapx(i.x[n]),t.mapy(i.y[n])))return!1;return!0}};function Ij(r,e){return`${r}_dcg_delim_${e}`}var Lw=class{constructor(e){this.hoveredObjects={},this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}redraw(){this.renderedTabTargets={},this.renderedTabTargetOrder=[];let e=this.grapher.getSketchOrder();for(let t of e){let i=this.controller.getItemModel(t);if(!i)continue;let n=this.grapher.getGraphSketch(t),o=this.grapher.getGraphImage(t);if(n&&i.type==="expression"&&fa(i))for(let s=0;s<n.branches.length;s++){let a=n.branches[s];if(!a.segments||a.segments.length===0)continue;let l=0;a.graphMode===3||a.graphMode===4?n.getBranchPOI(s).forEach(c=>{l=c.pointIdxOnBranch||0,isFinite(c.x)&&isFinite(c.y)&&this.addTabTarget(i,l)}):(l="listIndex"in a&&a.listIndex!==void 0?a.listIndex:0,a.segments.length>0&&this.addTabTarget(i,l))}else if(o&&o.shouldGraph&&i.type==="image"&&Bh(i)){let s=i.formula&&i.formula.dimensions;if(!s||!s.x||!s.y||!s.width||!s.height||!s.radianAngle)continue;for(let a=0;a<s.x.length;a++)isFinite(s.x[a])&&isFinite(s.y[a])&&isFinite(s.width[a])&&isFinite(s.height[a])&&isFinite(s.radianAngle[a])&&this.addTabTarget(i,a)}}Object.keys(this.hoveredObjects).length||this.pressedObject?this.grapher.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):this.grapher.setLayerClass("clickableObjects",void 0)}addTabTarget(e,t){let i=Ij(e.id,t);this.renderedTabTargetOrder.indexOf(i)!==-1||this.renderedTabTargets[i]!==void 0||(this.renderedTabTargetOrder.push(i),this.renderedTabTargets[i]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getTabIndex(e){if(this.controller.getActiveTool()!=="selection"||!this.renderedTabTargets[e])return-1;let i=this.grapher.settings;return!i.config.graphpaper||!i.config.enableTabindex?-1:0}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getCachedDescription(e){return this.renderedTabTargets[e].description}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?Vs(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getModelId(e){let t=this.renderedTabTargets[e];return t?t.id:""}getListIndex(e){let t=this.renderedTabTargets[e];if(t)return t.listIndex}isKeyboardFocused(e,t){if(!e)return!1;let i=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),n=i==null?void 0:i.calcId;return e===n&&(t===void 0||t===(i==null?void 0:i.listIndex))}shouldDrawHovered(e,t){if(!e)return!1;if(this.isKeyboardFocused(e,t))return!0;if(this.isAnObjectPressed()&&!this.isObjectPressed(e))return!1;let i=this.getHoveredObjectById(e);return i?i.listIndexes===void 0||t===void 0?!0:!!i.listIndexes[t]:!1}setHoveredObjects(e){__dcg_shared_module_exports__['G'](e,this.hoveredObjects)||(this.hoveredObjects=e,this.requestRedrawNextFrame())}getHoveredObjects(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(e){let t=__dcg_shared_module_exports__['j'](this.hoveredObjects),i=t[e.calcId],n=e.listIndex||0;return i?i.listIndexes?i.listIndexes[n]=!0:i.listIndexes={[n]:!0}:(i={listIndexes:{[n]:!0}},t[e.calcId]=i),t}else return this.hoveredObjects}getHoveredObjectById(e){return this.getHoveredObjects()[e]}shouldDrawPressed(e,t){if(!e)return!1;let i=this.pressedObject;return!i||i.id!==e?!1:t===void 0?!0:i.listIndex===t}isObjectPressed(e){return e===void 0?!1:!!(this.pressedObject&&this.pressedObject.id===e)}setPressedObject(e){!e&&!this.pressedObject||e&&this.pressedObject&&e.id===this.pressedObject.id&&e.listIndex===this.pressedObject.listIndex||(this.pressedObject=e,this.requestRedrawNextFrame())}getPressedObject(){return this.pressedObject}isAnObjectPressed(){return!!this.pressedObject}requestRedrawNextFrame(){this.controller.requestRedrawGraph()}shouldDrawGhosted(e){if(!e)return!1;let t=this.controller.getItemModel(e);return!t||t.type!=="expression"?!1:Ba(t)}};uu();var Vj=Gs().reflectionArc;function PE(r){return r.valueType===__dcg_shared_module_exports__['Ra']?r.value:r.valueType===__dcg_shared_module_exports__['Va']?r.value[0]:void 0}function Tj(r){return r.valueType===__dcg_shared_module_exports__['pb']?r.value:r.valueType===__dcg_shared_module_exports__['qb']?r.value[0]:void 0}function Mj(r){return r.valueType===__dcg_shared_module_exports__['fb']||r.valueType===__dcg_shared_module_exports__['hb']||r.valueType===__dcg_shared_module_exports__['$a']||r.valueType===__dcg_shared_module_exports__['pb']?{segment:r.valueType===__dcg_shared_module_exports__['$a'],value:r.value}:r.valueType===__dcg_shared_module_exports__['gb']||r.valueType===__dcg_shared_module_exports__['ib']||r.valueType===__dcg_shared_module_exports__['ab']||r.valueType===__dcg_shared_module_exports__['qb']?{segment:r.valueType===__dcg_shared_module_exports__['ab'],value:r.value[0]}:void 0}function W3(r){return r.valueType===__dcg_shared_module_exports__['Qa']?r.value:r.valueType===__dcg_shared_module_exports__['Ta']?r.value[0]:void 0}var _E=class{constructor(e){this.controller=e}getTransformationPreviewInfoFromItem(e){var t;if(e.type==="expression")return(t=e.formula.geometry)==null?void 0:t.transformation_preview_info}getInprogressTransformation(){let e=this.controller.getAllToolPreviewItems();for(let t of e){let i=this.getTransformationPreviewInfoFromItem(t);if(i)return i}}getHoveredOrSelectedTransformations(){let e=[];this.controller.getAllSelectedItems().forEach(a=>{if(a.type!=="expression")return;let l=this.getTransformationPreviewInfoFromItem(a);l&&e.push(l)});let i=this.controller.getHoveredTokenIdentifier();if(!i)return e;let n=this.controller.getItemsByIdentifier(i);if(n.length!==1)return e;let o=n[0];if(o.type!=="expression")return e;let s=this.getTransformationPreviewInfoFromItem(o);return s&&e.push(s),e}drawTranslationPreview(e,t,i,n){let o=t.mapx(i[0]),s=t.mapy(i[1]),a=t.mapx(n[0]),l=t.mapy(n[1]);e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.moveTo(o,s),e.lineTo(a,l),Ic(e,o,s,a,l,20),e.stroke(),e.restore()}drawReflectionPreview(e,t,i){let n=i.value,o=i.segment,[s,a,l,c]=iw([n[0][0],n[0][1],n[1][0],n[1][1]],t,18).clipped,u=(s+l)/2,p=(a+c)/2;if(o){let[V,k,T,A]=iw([n[0][0],n[0][1],n[1][0],n[1][1]],t,17).clipped;u=(V+T)/2,p=(k+A)/2}if(isNaN(u)&&isNaN(p))return;let g=40,h=g/__dcg_shared_module_exports__['X'](s-l,a-c),b=u+(c-a)*h,C=p-(l-s)*h,D=u-(c-a)*h,S=p+(l-s)*h;if(e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=4,e.moveTo(s,a),e.lineTo(l,c),Vj){let V=Math.atan2(C-p,b-u),k=g,T=g*.7;e.moveTo(b,C),e.ellipse(u,p,k,T,V,0,Math.PI,!1);let A=.35,R=V+Math.PI/2+A,P=V+Math.PI/2-A;Ic(e,b+Math.cos(R),C+Math.sin(R),b,C,10),Ic(e,D+Math.cos(P),S+Math.sin(P),D,S,10)}else e.moveTo(b,C),e.lineTo(D,S),Ic(e,u,p,b,C,10),Ic(e,u,p,D,S,10);e.stroke(),e.restore()}drawDilationPreview(e,t,i,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=3;let o=n<.6||n>1.4&&n<2?6:10,s=t.pixelsToMath.mapX(25)-t.pixelsToMath.mapX(0);[[s,0],[0,s],[-s,0],[0,-s]].forEach(a=>{let l=[i[0]+a[0],i[1]+a[1]],c=__dcg_shared_module_exports__['Ka'](__dcg_shared_module_exports__['Ha'](i,n),l),[u,p]=t.map_xy_pairs(l),[g,h]=t.map_xy_pairs(c);e.moveTo(u,p),e.lineTo(g,h),Ic(e,u,p,g,h,o)}),e.stroke(),e.restore()}drawRotationPreview(e,t,i,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=2.5,n*=-1;let o=40,[s,a]=t.map_xy_pairs(i),l=s+o,c=a,u=s+o*Math.cos(n),p=a+o*Math.sin(n),g=n<=0;e.moveTo(l,c),e.arc(s,a,o,0,n,g),IM(e,u,p,0,n,10,o),e.stroke(),e.restore()}redrawToCtx(e,t){if(!this.controller.shouldShowTransformationPreview())return;let i=this.getInprogressTransformation(),n=this.getHoveredOrSelectedTransformations();i&&n.push(i);for(let o=0;o<n.length;o++){let s=n[o],a=s.args;switch(s.type){case"translate":if(a.length===2){let l=PE(a[0]),c=PE(a[1]);l&&c&&this.drawTranslationPreview(e,t,l,c)}else if(a.length===1){let l=Tj(a[0]);if(l){let[c,u]=Rp(l);this.drawTranslationPreview(e,t,c,u)}}break;case"reflect":{let l=Mj(a[0]);l&&this.drawReflectionPreview(e,t,l)}break;case"dilate":{let l=PE(a[0]),c=W3(a[1]);l&&c!==void 0&&isFinite(c)&&c!==1&&this.drawDilationPreview(e,t,l,c)}break;case"rotate":{let l=PE(a[0]),c=W3(a[1]);l&&c!==void 0&&isFinite(c)&&c!==0&&(this.controller.isDegreeMode()&&(c*=Math.PI/180),this.drawRotationPreview(e,t,l,c))}break}}}};var{floor:lg,ceil:cg,round:Aj,log10:FE,log2:j3,abs:zp}=Math,
BE=class{
    redrawToCtx(e,t,i){
        Ks(e,"graphpaper");
        let n=t.settings.showGrid&&!t.settings.threeDMode;
        if(t.settings.polarMode&&n){
            let o=cB(t);
            Ks(e,"grid"),
            this.drawPolarGrid(e,t,o),
            Us(e),
            Ks(e,"axis"),
            this.drawAxes(e,t,i);
            let s=this.drawPolarStepNumbers(e,t,o);
            this.drawLabels(e,t,s),
            Us(e)
        }else{
            let o=Op(t),
                s=BA(t);
            n&&(
                Ks(e,"grid"),
                this.drawCartesianGrid(e,t,o,s),
                Us(e)
            );
            let a=!n&&!t.settings.threeDMode;
            Ks(e,"axis"),
            t.settings.threeDMode||this.drawAxes(e,t,i);
            let l=this.drawCartesianStepNumbers(e,t,o,a,s);
            this.drawLabels(e,t,l),
            Us(e)
        }
        Us(e)
    }
    addTextShadow(e,t){e.strokeStyle=t.settings.getBackgroundColor(),e.lineWidth=3,e.miterLimit=2}drawPolarGrid(e,t,i){e.save();let n=t.settings.minorAxisOpacity,s=1-(1-t.settings.majorAxisOpacity)/(1-n),a=__dcg_shared_module_exports__['ca'](t.mapx(0)),l=__dcg_shared_module_exports__['ca'](t.mapy(0)),c=t.screen.height/(t.viewport.ymax-t.viewport.ymin),u=t.screen.width/(t.viewport.xmax-t.viewport.xmin),p=c/u,g=u/c,h=l/p,b=t.viewport.smallestR(),C=t.viewport.largestR(),D=i.minorStepR*Math.max(1,Math.floor(b/i.minorStepR)),S=i.majorStepR*Math.max(1,Math.floor(b/i.majorStepR));e.lineWidth=1,e.strokeStyle="rgba(0, 0 , 0, "+n+")";for(let k of Fc(D,C,i.minorStepR)){gn(e,"dcg-svg-minor-gridline"),e.beginPath(),Hi(e),e.scale(1,p);let T=t.mapx(k)-a;e.moveTo(a+T,h),e.arc(a,h,T,0,2*Math.PI),e.scale(1,g),e.stroke()}let V=b>0?5:15;for(let k of Fc(0,359,V)){if((k===0||k===180)&&t.settings.showXAxis||(k===90||k===270)&&t.settings.showYAxis)continue;gn(e,"dcg-svg-minor-gridline"),e.beginPath(),Hi(e),e.moveTo(a,l);let T=t.mapx(C*Math.cos(k*Math.PI/180)),A=t.mapy(C*Math.sin(k*Math.PI/180));e.lineTo(__dcg_shared_module_exports__['ca'](T),__dcg_shared_module_exports__['ca'](A)),e.stroke()}e.lineWidth=1,e.strokeStyle="rgba(0, 0 , 0, "+s+")";for(let k of Fc(S,C,i.majorStepR)){gn(e,"dcg-svg-major-gridline"),e.beginPath(),Hi(e),e.scale(1,p);let T=t.mapx(k)-a;e.moveTo(a+T,h),e.arc(a,h,T,0,2*Math.PI),e.scale(1,g),e.stroke()}e.restore()}drawCartesianGrid(e,t,i,n=BA(t)){e.save();let{xmin:o,xmax:s,ymin:a,ymax:l}=t.viewport,c=t.screen.width,u=t.screen.height,p=u,g=0;t.settings.restrictGridToFirstQuadrant&&(o=0,a=0,p=t.mapy(0),g=t.mapx(0));let h=t.settings.minorAxisOpacity*n.x.unitOpacity,b=t.settings.minorAxisOpacity*n.y.unitOpacity,C=t.settings.majorAxisOpacity;e.lineWidth=1;let D=B=>{if(B===0&&t.settings.showYAxis)return;let q=__dcg_shared_module_exports__['ca'](t.mapx(B));q===__dcg_shared_module_exports__['ca'](0)||q===__dcg_shared_module_exports__['ca'](c)||(e.beginPath(),e.moveTo(q,0),e.lineTo(q,p),e.stroke())},S=B=>{if(B===0&&t.settings.showXAxis)return;let q=__dcg_shared_module_exports__['ca'](t.mapy(B));q===__dcg_shared_module_exports__['ca'](0)||q===__dcg_shared_module_exports__['ca'](u)||(e.beginPath(),e.moveTo(g,q),e.lineTo(c,q),e.stroke())};gn(e,"dcg-svg-minor-gridline");let{majorStepX:V,majorStepY:k,minorStepX:T,minorStepY:A}=i,R=t.settings.xAxisScale==="logarithmic",P=t.settings.yAxisScale==="logarithmic",W=R?n.x.minor:Fc(o,s,T),H=P?n.y.minor:Fc(a,l,A);e.strokeStyle="rgba(0, 0 , 0, "+h+")";for(let B of W)D(B);e.strokeStyle="rgba(0, 0 , 0, "+b+")";for(let B of H)S(B);Hi(e);let j=1-(1-C)/(1-h),ne=1-(1-C)/(1-b);gn(e,"dcg-svg-major-gridline");let le=R?n.x.major:Fc(o,s,V),w=P?n.y.major:Fc(a,l,k);e.strokeStyle="rgba(0, 0 , 0, "+j+")";for(let B of le)D(B);e.strokeStyle="rgba(0, 0 , 0, "+ne+")";for(let B of w)S(B);Hi(e),e.restore()}drawAxes(e,t,i){let n=t.settings.axisLineOffset,o=t.settings.axisOpacity.toString(),s="rgba(127,205,230,"+o+")",a="rgba(0,0,0,"+o+")",l=t.settings.xAxisArrowMode,c=t.settings.yAxisArrowMode,u=t.settings.showXAxis,p=t.settings.showYAxis,g=1,h=Math.round(t.mapx(0))-n,b=Math.round(t.mapy(0))-n,C=t.screen.height,D=t.screen.width;function S(T,A,R){e.save();let P=Math.PI/12,W=8*Math.max(e.lineWidth,1.5);e.lineJoin="round",e.fillStyle=a,e.strokeStyle=a,e.beginPath(),e.moveTo(T,A),e.lineTo(T+Math.cos(R-P)*W,A+Math.sin(R-P)*W),e.lineTo(T+Math.cos(R+P)*W,A+Math.sin(R+P)*W),e.lineTo(T,A),e.lineTo(T+Math.cos(R-P)*W,A+Math.sin(R-P)*W),e.stroke(),e.fill(),e.restore()}let V=C,k=0;t.settings.restrictGridToFirstQuadrant&&(V=b,k=h,l==="BOTH"&&(l="POSITIVE"),c==="BOTH"&&(c="POSITIVE")),p&&(Ks(e,"yaxis"),t.settings.takingScreenshot&&aw(e,t.settings.yAxisLabel||"Y axis"),e.save(),gn(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(i==="y"?g:1),e.strokeStyle=i==="y"?s:a,c==="BOTH"?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,C-2*t.settings.axisLineWidth),e.stroke(),S(h,C-t.settings.axisLineWidth,3*Math.PI/2),S(h,t.settings.axisLineWidth,Math.PI/2)):c==="POSITIVE"?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,V),e.stroke(),S(h,t.settings.axisLineWidth,Math.PI/2)):(e.beginPath(),e.moveTo(h,0),e.lineTo(h,V),e.stroke()),Hi(e),e.restore(),Us(e)),u&&(Ks(e,"xaxis"),t.settings.takingScreenshot&&aw(e,t.settings.xAxisLabel||"X axis"),e.save(),gn(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(i==="x"?g:1),e.strokeStyle=i==="x"?s:a,l==="BOTH"?(e.beginPath(),e.moveTo(2*t.settings.axisLineWidth,b),e.lineTo(D-2*t.settings.axisLineWidth,b),e.stroke(),S(t.settings.axisLineWidth,b,0),S(D-t.settings.axisLineWidth,b,Math.PI)):l==="POSITIVE"?(e.beginPath(),e.lineTo(k,b),e.lineTo(D-2*t.settings.axisLineWidth,b),e.stroke(),S(D-t.settings.axisLineWidth,b,Math.PI)):(e.beginPath(),e.lineTo(k,b),e.lineTo(D,b),e.stroke()),Hi(e),e.restore(),Us(e))}drawPolarStepNumbers(e,t,i){e.save();let n=t.settings.showGrid,o=t.settings.xAxisNumbers&&t.settings.showXAxis,s=t.settings.yAxisNumbers&&t.settings.showYAxis,a=n&&t.settings.polarNumbers,l=t.viewport.largestR(),c=t.viewport.smallestR(),u=t.viewport.xmin,p=t.viewport.xmax,g=t.viewport.ymin,h=t.viewport.ymax,b=t.screen.width,C=t.screen.height,D={left:3,right:b-3,top:3,bottom:C-3},S=t.settings.labelHangingColor,V=t.settings.getTextColor(),k=t.settings.labelSize,T=k;this.addTextShadow(e,t),e.fillStyle=V;function A(M,ae,se){let ge=Math.sqrt(M*M-ae*ae);g<=ge&&ge<=h&&se.push({x:t.mapx(ae),y:t.mapy(ge)}),g<=-ge&&-ge<=h&&se.push({x:t.mapx(ae),y:t.mapy(-ge)})}function R(M,ae,se){let ge=Math.sqrt(M*M-ae*ae);u<=ge&&ge<=p&&se.push({x:t.mapx(ge),y:t.mapy(ae)}),u<=-ge&&-ge<=p&&se.push({x:t.mapx(-ge),y:t.mapy(ae)})}let P=t.mapx(0),W=t.mapy(0),H=g<=0&&0<=h,j=u<=0&&0<=p,ne=H&&o,le=j&&s,w="";if(!ne&&!le&&n){let M=zp(P),ae=zp(P-b),se=zp(W),ge=zp(W-C),he,ye,fe,Se;M<=ae?(he="left",fe=M):(he="right",fe=ae),se<=ge?(ye="top",Se=se):(ye="bottom",Se=ge),o&&s?w=fe<=Se?he:ye:s?w=he:o&&(w=ye)}let B={left:0,right:b,top:W-1,bottom:W+1},q={left:P-1,right:P+1,top:0,bottom:C};for(let M of Fc(0,l,i.majorStepR)){let ae=[],se=[],ge=[],he=new Is(__dcg_shared_module_exports__['Cb'](M,l),k),ye=he.getRect();switch(M>0?(le&&g<=M&&M<=h&&se.push({x:P-ye.right-5,y:t.mapy(M)}),le&&g<=-M&&-M<=h&&se.push({x:P-ye.right-5,y:t.mapy(-M)}),ne&&u<=M&&M<=p&&ae.push({x:t.mapx(M),y:W-ye.top+3}),ne&&u<=-M&&-M<=p&&ae.push({x:t.mapx(-M),y:W-ye.top+3})):le&&!o&&g<=M&&M<=h?se.push({x:P-ye.right-5,y:t.mapy(M)}):ne&&!s&&u<=M&&M<=p&&ae.push({x:t.mapx(M),y:W-ye.top+3}),w){case"top":R(M,h,ge);break;case"bottom":R(M,g,ge);break;case"left":A(M,u,ge);break;case"right":A(M,p,ge);break}ae.forEach(function(fe){fe=he.clampBoundsWithinRect(fe,D),he.drawCenteredAt(e,fe,"dcg-svg-axis-value"),RE(B,he.getRectWhenCenteredAt(fe))}),se.forEach(function(fe){fe=he.clampBoundsWithinRect(fe,D),he.drawCenteredAt(e,fe,"dcg-svg-axis-value"),RE(q,he.getRectWhenCenteredAt(fe))}),ge.forEach(function(fe){fe=he.clampBoundsWithinRect(fe,D),he.drawCenteredAt(e,fe,"dcg-svg-axis-value")})}if(a){let M=Math.ceil(c/i.majorStepR),ae=Math.floor(l/i.majorStepR),ge=Math.ceil((M+ae)/2)*i.majorStepR,he=c>0?15:30;for(let ye of Fc(0,359,he)){let fe;t.settings.degreeMode?fe=ye.toString()+"\xB0":fe=__dcg_shared_module_exports__['Cb'](ye*Math.PI/180,2*Math.PI).string;let Se=e.measureText(fe).width/2,de=ge/1.05,Ee=de*Math.cos(ye*Math.PI/180),U=de*Math.sin(ye*Math.PI/180);if(Ee<u||Ee>p||U<g||U>h)continue;let ce=t.mapx(Ee),Oe=t.mapy(U);ye===0||ye===180?Oe-=T:(ye===90||ye===270)&&(ce+=Se+3);let Qe=__dcg_shared_module_exports__['ma'](ce,3+Se,b-3-Se),Ct=__dcg_shared_module_exports__['ma'](Oe,3+T,C-3-T);Ct=Is.computeBaselineFromCenter(Ct,k),gn(e,"dcg-svg-polar-axis-value"),e.save(),Hi(e),e.fillStyle=S,Is.setCtxFontSize(e,k),e.strokeText(fe,Qe,Ct),e.fillText(fe,Qe,Ct),e.restore()}}return e.restore(),{x:B,y:q}}drawLabels(e,t,i){let n=t.viewport.xmin,o=t.viewport.xmax,s=t.viewport.ymin,a=t.viewport.ymax,l=t.screen.width,c=t.screen.height,u=(o-n)/l,p=(a-s)/c,g=t.settings.getTextColor(),h=t.mapx(0),b=t.mapy(0),C=t.settings.labelSize,D=15,S=t.settings.showXAxis&&t.settings.xAxisLabel,V=t.settings.showYAxis&&t.settings.yAxisLabel,k=i.x,T=i.y;if(S&&k){gn(e,"dcg-svg-axis-label"),e.save(),Hi(e),e.fillStyle=g;let A;if(e.__xLabelOffset&&t.settings.isViewportTransient&&NE(e.__xLabelOffset.xscale,u)&&NE(e.__xLabelOffset.yscale,p)&&(A={x:e.__xLabelOffset.x+h,y:e.__xLabelOffset.y+b}),this._setAxisLabelFont(e,S,C,t),!A){let R=e.measureText(S).width,P=l-R-D,W=C;k.bottom+W<c?A={x:P,y:k.bottom+W}:A={x:P,y:k.top-W/2},e.__xLabelOffset={x:A.x-h,y:A.y-b,xscale:u,yscale:p}}e.strokeText(S,A.x,A.y),e.fillText(S,A.x,A.y),e.restore()}else e.__xLabelPosition=null;if(V&&T){gn(e,"dcg-svg-axis-label"),e.save(),Hi(e),e.fillStyle=g;let A;if(e.__yLabelOffset&&t.settings.isViewportTransient&&NE(e.__yLabelOffset.xscale,u)&&NE(e.__yLabelOffset.yscale,p)&&(A={x:e.__yLabelOffset.x+h,y:e.__yLabelOffset.y+b}),this._setAxisLabelFont(e,V,C,t),!A){let R=e.measureText(V).width,P=C,W=R+5;if(!this._isShortMathyLabel(V)){let j=R;R=P,P=j,W=R*.5}let H=0+D+P;T.left-R>0?A={x:T.left-W,y:H}:A={x:T.right+R,y:H},e.__yLabelOffset={x:A.x-h,y:A.y-b,xscale:u,yscale:p}}e.translate(A.x,A.y),this._isShortMathyLabel(V)||e.rotate(-Math.PI/2),e.strokeText(V,0,0),e.fillText(V,0,0),e.restore()}else e.__yLabelPosition=null}_isShortMathyLabel(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)}_setAxisLabelFont(e,t,i,n){this.addTextShadow(e,n),this._isShortMathyLabel(t)?e.font="italic "+Math.round(i*1.4)+"px Times":e.font=Math.round(i*1.2)+"px Arial"}drawCartesianStepNumbers(e,t,i,n,o=BA(t)){e.save();let{showXAxis:s,showYAxis:a}=t.settings,l=s&&t.settings.xAxisNumbers,c=a&&t.settings.yAxisNumbers,{xmin:u,xmax:p,ymin:g,ymax:h}=t.viewport,b=t.screen.width,C=t.screen.height,D={left:3,top:3,right:b-3,bottom:C-3};t.settings.restrictGridToFirstQuadrant&&(u=0,g=0);let S=t.settings.labelHangingColor,V=t.settings.getTextColor(),k=t.mapx(0),T=t.mapy(0),A=t.settings.labelSize;this.addTextShadow(e,t);let R={left:0,right:b,top:T-1,bottom:T+1},P={left:k-1,right:k+1,top:0,bottom:C},W=5,H=!1;if(s&&a&&(l||c)){H=!0,e.fillStyle=V;let B=new Is(__dcg_shared_module_exports__['Cb'](0,1),A);B.drawCenteredAt(e,{x:k-B.getRect().right-W,y:T-B.getRect().top+W},"dcg-svg-axis-value")}let{majorStepX:j,majorStepY:ne}=i,le=[],w=[];if(l){let B=t.settings.xAxisScale==="logarithmic",q=B?o.x.label:Fc(u,p,j);for(let M of q){let ae=B?void 0:p-u,se=__dcg_shared_module_exports__['Cb'](M,ae,B),ge=new Is(se,A);ge.getString()==="0"&&H||le.push(ge)}}if(c){let B=t.settings.yAxisScale==="logarithmic",q=B?o.y.label:Fc(g,h,ne);for(let M of q){let ae=B?void 0:h-g,se=__dcg_shared_module_exports__['Cb'](M,ae,B),ge=new Is(se,A);ge.getString()==="0"&&H||w.push(ge)}}if(n){e.save(),gn(e,"dcg-svg-tickmark");let B=t.settings.axisLineOffset,M="rgba(0,0,0,"+t.settings.axisOpacity.toString()+")";e.lineWidth=t.settings.axisLineWidth,e.strokeStyle=M;let ae=Math.round(t.mapy(0))-B,se=Math.round(t.mapx(0))-B,ge=Math.round(2*e.lineWidth)-B;e.beginPath(),le.forEach(function(he){let ye=Math.round(t.mapx(he.getValue()))-B;e.moveTo(ye,ae-ge),e.lineTo(ye,ae+ge)}),w.forEach(function(he){let ye=Math.round(t.mapy(he.getValue()))-B;e.moveTo(se-ge,ye),e.lineTo(se+ge,ye)}),e.stroke(),Hi(e),e.restore()}return le.forEach(function(B){let q={x:t.mapx(B.getValue())-.5*B.getMinusWidth(),y:T-B.getRect().top+W},M=B.clampBoundsWithinRect(q,D);e.fillStyle=q.y===M.y||t.settings.yAxisScale==="logarithmic"?V:S;let ae="dcg-svg-axis-value";q.x!==M.x&&(ae+=" dcg-svg-offcenter-axis-value"),B.drawCenteredAt(e,M,ae),RE(R,B.getRectWhenCenteredAt(M)),Hi(e)}),w.forEach(function(B){let q={x:k-W-B.getRect().right,y:t.mapy(B.getValue())},M=B.clampBoundsWithinRect(q,D);e.fillStyle=q.x===M.x||t.settings.xAxisScale==="logarithmic"?V:S;let ae="dcg-svg-axis-value";q.y!==M.y&&(ae+=" dcg-svg-offcenter-axis-value"),B.drawCenteredAt(e,M,ae),RE(P,B.getRectWhenCenteredAt(M)),Hi(e)}),e.restore(),{x:R,y:P}}};function Fc(r,e,t){let i=Math.ceil(r/t),n=Math.floor(e/t);if(!Lj({nmin:i,nmax:n}))return[];let o=[];for(var s=i;s<=n;s++)o.push(s*t);return o}var Lj=({nmin:r,nmax:e})=>isFinite(e-r)&&e-r<=1e4;function BA(r){return{x:J3("x",r),y:J3("y",r)}}function J3(r,e){let t=new Set,i=new Set,n=new Set,o=1;function s(Se){return k?e.mapx(Se):e.mapy(Se)}function a(Se,de){return zp(s(de)-s(Se))}let l=(Se,de)=>{let Ee=Se*de,U=(Se+1)*de;if(Ee<T&&U<T||Ee>A&&U>A)return;let ce=Se>=5?a(7*de,8*de):Se>=2?a(3*de,4*de):a(de,2*de),Oe=ce/a(Ee,U);if(ce<40)return;let Qe={settings:{pixelsPerLabel:e.settings.pixelsPerLabel*Oe,labelSize:e.settings.labelSize,xAxisNumber:e.settings.xAxisNumbers,yAxisNumber:e.settings.yAxisNumbers},screen:{width:ce,height:ce},viewport:{xmin:Ee,ymin:Ee,xmax:U,ymax:U}},{minorStepX:Ct,majorStepX:Je}=Op(Qe),tr=Math.max(Ee,T),mr=Math.min(U,A);for(let we=lg(tr/Ct);we<cg(mr/Ct);we++)n.add(we*Ct);for(let we=lg(tr/Je);we<cg(mr/Je);we++){let Xr=we*Je;Xr<=Ee||Xr>=U||(i.add(Xr),t.add(Xr))}},c={label:[],major:[],minor:[],unitOpacity:1},{xAxisScale:u,yAxisScale:p,pixelsPerLabel:g}=e.settings,{xmin:h,xmax:b,ymin:C,ymax:D}=e.viewport,{width:S,height:V}=e.screen,k=r==="x",[T,A]=k?[h,b]:[C,D],R=k?S:V,P=k?u:p,W=e.settings.xAxisMinorSubdivisions!==0;if(P!=="logarithmic")return c;let H=lg(FE(T)),j=cg(FE(A)),ne=cg(FE(A)-FE(T)),le=a(10**H,10**(H+1)),w=15,B=100,q=le>w,M=[];le>6.25*g&&(M=[2,3,4,6,8]),le>12*g&&(M=[2,3,4,5,6,7,8]),le>14*g&&(M=[2,3,4,5,6,7,8,9]);let ae=M.length!=0;if(w<=le&&le<=B&&(o=Math.sqrt((le-w)/(B-w))),!isFinite(ne))return c;let se=lg(R/g),ge=Math.max(1,2**Aj(j3(ne/se)));for(let Se=cg(H/ge);Se<=lg(j/ge);Se++)t.add(10**(Se*ge));i=new Set([...t]);let he=lg(R/w),ye=Math.max(1,2**cg(j3(ne/he)));for(let Se=cg(H/ye);Se<=lg(j/ye);Se++)(q?i:n).add(10**(Se*ye));if(q)for(let Se=H;Se<j;Se++){let de=10**Se;for(let Ee of M)t.add(Ee*de);if(ae){for(let Ee=2;Ee<=9;Ee++)i.add(Ee*de);for(let Ee=1;Ee<=9;Ee++)l(Ee,de)}else for(let Ee=2;Ee<=9;Ee++)n.add(Ee*de)}W&&(n=new Set);let fe=k?e.reverse_mapx(s(T)+g/4):e.reverse_mapy(s(T)-2*e.settings.labelSize);return{label:[...t].filter(Se=>fe<=Se&&Se<=A),major:[...i].filter(Se=>T<=Se&&Se<=A),minor:[...n].filter(Se=>T<=Se&&Se<=A),unitOpacity:o}}
function RE(r,e){
    e.left<r.left&&(r.left=e.left),
    e.right>r.right&&(r.right=e.right),
    e.top<r.top&&(r.top=e.top),
    e.bottom>r.bottom&&(r.bottom=e.bottom)
}
function NE(r,e){
    let t=zp(r),
        i=zp(e),
        n=1e-4;
    return zp(t-i)<=(t<i?i:t)*n
}
function Oj(){
    return new Ld(1024,768)
}
function Y3(r){
    let{xAxisScale:e,yAxisScale:t}=r;
    return new hn(...e==="linear"?[-Mp,Mp]:[10**-Ap,10**Ap],...t==="linear"?[-Mp,Mp]:[10**-Ap,10**Ap])
}
var Mu=class{
    constructor(e,t,i,n){
        this.type="2d";
        this.__screenRequested3D=new Ld(768,768);
        this.lastActiveToken={selected:void 0,hovered:void 0};
        this._layerClasses={};
        this._classLayers={};
        this.elt=e,
        this.evaluator=n,
        this.controller=i,
        this.settings=t;
        let o=Oj(),s=Y3(t).squareYAxis(o,t);
        this.setUserRequestedViewport(s),
        this.__projection=new Oc(o,s,t),
        this.markLabelsDirty=__dcg_shared_module_exports__['C'](()=>{
            this.evaluator.notifyWhenSynced(()=>{
                this.poiLabelsLayer.markLabelsDirty(),
                this.controller.requestRedrawGraph()
            })
        },300),
        this.poiController=new Ad(this,t),
        this.viewportController=new hE(this,this.controller),
        this.showPOIDots=!0,
        this.elt.style.overflow="hidden",
        this.graphSketches={},
        this.graphImages={},
        this.audioGraph=new Ew(i,this);
        var a=this;
        this.canvasLayer=Ow.mountToNode(OE,this.elt,{grapher:function(){return a}}),
        this.boxSelectLayer=new OS,
        this.elt.appendChild(this.canvasLayer.rootNode);
        var l=document.createElement("div");
        this.elt.appendChild(l),
        this.imageLayer=new Aw(this),
        this.gridLayer=new BE,
        this.poiDotsLayer=new LS(this.controller),
        this.graphsLayer=new $n(this.controller,this.settings,p=>this.audioGraph.getExpressionAriaLabel(p)),
        this.transformationPreviewLayer=new _E(this.controller),
        this.clickableObjectsLayer=new Lw(this),
        this.movablePointsLayer=new bw(this);
        var c=document.createElement("div");
        this.elt.appendChild(c),
        this.poiLabelsLayer=Ow.mountToNode(vf,c,{grapher:function(){return a}});
        var u=document.createElement("div");
        this.elt.appendChild(u),
        this.geoKeyboardCursorLayer=Ow.mountToNode(US,u,{grapher:()=>this}),
        this.traceLayer=this.poiLabelsLayer,
        this.scaleAxis=void 0,
        this.__sketchOrder=[],
        this.__redrawRequested=!1,
        this.__isRedrawingSlowly=!1,
        this.events=new Wr
    }
    privateGetGridLayer(){
        return this.gridLayer
    }
    static copyGraphProperties(e,t){
        e=__dcg_shared_module_exports__['Cc'](Lh,e);
        let i=__dcg_shared_module_exports__['a']({},e);
        delete i.viewport;
        let n=t.validateSettings(i);
        for(let o in n)
            t.setProperty(o,n[o]);
        return e
    }
    remove(){
        this.elt.remove(),
        this.poiController.remove(),
        this.viewportController.remove(),
        this.audioGraph.remove()
    }
    tick(e){
        this.__redrawRequested&&this._redrawAllLayers(),
        this.__movablePointListener&&this.__movablePointListener()
    }
    registerMovablePointListener(e){
        this.__movablePointListener=e
    }
    deregisterMovablePointListener(){
        this.__movablePointListener=void 0
    }
    setSketchOrder(e){
        __dcg_shared_module_exports__['G'](this.__sketchOrder,e)||(this.__sketchOrder=e,this.controller.requestRedrawGraph())
    }
    clear(){
        this.graphSketches={},
        this.graphImages={}
    }
    getSketchOrder(){
        return this.__sketchOrder
    }
    getGraphSketch(e){
        return this.graphSketches[e]
    }
    getGraphImage(e){
        return this.graphImages[e]
    }
    addGraphSketch(e){
        this.graphSketches[e.id]=e
    }
    removeGraphSketch(e){
        delete this.graphSketches[e]
    }
    addGraphImage(e){
        e.imageObj.width&&e.imageObj.height?(
            this.graphImages[e.id]=e,
            this.controller.requestRedrawGraph()
        ):
            O(e.imageObj).on("load.calc_load",()=>this.addGraphImage(e))
    }
    removeGraphImage(e){
        let t=this.graphImages[e];
        t&&O(t.imageObj).off("load.calc_load"),
        delete this.graphImages[e],
        this.controller.requestRedrawGraph()
    }
    setBoxSelectRectangle(e){
        this.boxSelectRectangle=e,
        this.controller.requestRedrawGraph()
    }
    getProjection(){
        return this.__projection
    }
    _setProjection(e){
        this.__projection=e,
        this.controller.requestRedrawGraph()
    }
    getAudioTrace(){
        return this.audioGraph
    }
    getDefaultViewport(){
        let e=this.getProjection();
        return Y3(this.settings).squareYAxis(e.screen,this.settings)
    }
    _updateScreenSize(e,t){
        if(e<=0||t<=0)
            return;
        let n=this.getProjection().screen;
        if(n.width===e&&n.height===t)
            return;
        this.elt.style.width=`${e}px`;
        let o=new Ld(e,t);
        this.viewportController.setScreen(o)
    }
    _setIsVisible(e){
        e!==this.isVisible&&(this.isVisible=e,e?this.controller.requestRedrawGraph():this.canvasLayer.resize(0,0))
    }
    getIsVisible(){
        return this.isVisible
    }
    update(){
        let{top:e,left:t,width:i,height:n}=this.controller.computeMajorLayout().grapher,
            o=this.controller.isGraphPaperFocused()&&!this.poiController.keyboardAttentionManager.getKeyboardAttention()&&!this.controller.getSelectedGeoExpression()&&!this.geoKeyboardCursorLayer.showCursor()&&!this.controller.inAudioTraceMode();
        this.elt.classList.toggle("dcg-grapher-focused",o),
        this.controller.isThreeDMode()&&({width:i,height:n}=this.__screenRequested3D),
        i>0&&n>0?(
            this._setIsVisible(!0),
            this._updateScreenSize(i,n),
            Gc(this.elt,{position:"absolute",left:t+"px",top:e+"px",width:i+"px",height:n+"px"})
        ):this._setIsVisible(!1)
    }
    setActiveToken(e,t){
        var i=this.lastActiveToken[t];
        this.lastActiveToken[t]=e;
        var n=e&&this.getGraphSketch(e),
            o=i&&this.getGraphSketch(i);
        o!==n&&(
            o&&(t==="selected"?o.tokenSelected=!1:t==="hovered"&&(o.tokenHovered=!1)),
            n&&(t==="selected"?n.tokenSelected=!0:t==="hovered"&&(n.tokenHovered=!0))
        ),
        this.controller.requestRedrawGraph()
    }
    deselectSketch(e){
        let t=this.getGraphSketch(e);
        t&&(
            t.selected=!1,
            t.showPOI=!1,
            t.showHighlight=!1
        )
    }
    selectSketch(e){
        let t=this.getGraphSketch(e);
        t&&(
            t.selected=!0,
            t.showPOI=this.controller.isTraceEnabled(),
            t.showHighlight=!0
        )
    }
    updateSketch(e,t){
        let i=this.getGraphSketch(e);
        if(!t.length){
            this.removeGraphSketch(e);
            return
        }
        let n=new gE(e,t);
        t[0].graphMode!==15&&(
            n.color=t[0].color,
            t[0].style&&(
                n.style=t[0].style
            )
        ),
        i&&n.updateFrom(i);
        let o=!!this.controller.getPropagatedSelectedIds()[e];
        n.selected=o,
        n.tokenHovered=e===String(this.lastActiveToken.hovered),
        n.tokenSelected=e===String(this.lastActiveToken.selected),
        n.showPOI=o&&this.controller.isTraceEnabled(),
        n.showHighlight=o,
        this.addGraphSketch(n)
    }
    updateIntersections(e,t){
        let i=this.getGraphSketch(e);
        i&&i.updateIntersections(t)
    }
    redrawAllLayers(){
        this.__redrawRequested=!0
    }
    _clear(){
        let t=this.getProjection().screen;
        if(this.canvasLayer.resize(t.width,t.height),
            !!this.canvasLayer.ctx&&(
                this.canvasLayer.ctx.clearRect(0,0,t.width,t.height),
                this.controller.isThreeDMode()&&!this.controller.getInvertedColors()
            )
        ){
            let{plane3dOpacity:n}=this.controller.getGraphSettings();
            var i=Number(n);
            (n===""||isNaN(i))&&(i=.5),
            i=__dcg_shared_module_exports__['ma'](i,.001961,1),
            this.canvasLayer.ctx.fillStyle="rgba(255,255,255,"+i+")",
            this.canvasLayer.ctx.fillRect(0,0,t.width,t.height)
        }
    }
    isDrawingPlaneFor3dMode(){
        return this.controller.showPlane3D()
    }
    redrawAllLayersSynchronously(){
        return this._redrawAllLayers()
    }
    _redrawAllLayers(){
        if(this.update(),!this.isVisible&&!this.isDrawingPlaneFor3dMode())
            return;
        this.__redrawRequested=!1,
        this._clear(),
        this.audioGraph.recomputePoints(),
        this._recomputeClickableObjects(),
        this._redrawImageLayer(),
        this._redrawGridLayer(),
        this._redrawGraphsLayer(),
        this._redrawPointsAndLabels(),
        this._redrawTransformationPreviewLayer(),
        this._redrawBoxSelectLayer(),
        this._redrawGeoKeyboardCursorLayer(),
        this._updateCanvasLayerAria(),
        this.events.triggerEvent("redraw",void 0);
        let e=this.controller.getGrapher3d();
        this.isDrawingPlaneFor3dMode()&&e&&e.webglLayer.updatePlaneMap()
    }
    _redrawGridLayer(){
        this.canvasLayer.ctx&&this.gridLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.scaleAxis)
    }
    _recomputeClickableObjects(){
        this.clickableObjectsLayer.redraw()
    }
    _redrawGraphsLayer(){
        this.canvasLayer.ctx&&this.graphsLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer)
    }
    _redrawTransformationPreviewLayer(){
        this.canvasLayer.ctx&&this.transformationPreviewLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection())
    }
    _redrawBoxSelectLayer(){
        this.canvasLayer.ctx&&this.boxSelectLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.boxSelectRectangle)
    }
    _redrawGeoKeyboardCursorLayer(){
        this.geoKeyboardCursorLayer.update()
    }
    _updateCanvasLayerAria(){
        let e=0;
        for(let t in this.graphSketches)
            Wl(this.controller,this.graphSketches[t])&&(e+=1);
        this.canvasLayer.updateAria(this.isVisible,e)
    }
    _redrawPointsAndLabels(){
        if(!this.canvasLayer.ctx)
            return;
        var e=this.getProjection();
        let t=[];
        this.controller.isThreeDMode()||this.movablePointsLayer.redraw(this.canvasLayer.ctx,e,t),
        this.showPOIDots&&!this.controller.isThreeDMode()&&this.poiDotsLayer.redrawToCtx(this.canvasLayer.ctx,e,this.graphSketches,this.poiLabelsLayer,this.clickableObjectsLayer,this.__sketchOrder);
        let i=this.elt.getBoundingClientRect();
        if(this.controller.isThreeDMode())
            this.poiLabelsLayer.drawForScreenshot(e,this.canvasLayer.ctx,this.canvasLayer.ctx,this.size(),t);
        else{
            let n=this.controller.findEl(".dcg-overgraph-pillbox-elements"),
                o=this.controller.findEl(".dcg-graphpaper-branding");
            __dcg_shared_module_exports__['l']([n,o],s=>{
                if(!s)
                    return;
                let a=s.getBoundingClientRect();
                t.push({left:a.left-i.left,top:a.top-i.top,right:a.right-i.left,bottom:a.bottom-i.top})
            }),
            this.poiLabelsLayer.redraw(e,this.canvasLayer.ctx,this.size(),t)
        }
    }
    size(){
        let e=this.canvasLayer.ctx;
        if(!e)
            return{width:0,height:0};
        let t=e.canvas.getBoundingClientRect();
        return{width:t.width,height:t.height}
    }
    _redrawImageLayer(){
        this.canvasLayer.ctx&&this.imageLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphImages,this.__sketchOrder)
    }
    _parseScreenshotOpts(e){
        return Pj(e,this.settings,this.getProjection().screen)
    }
    _syncScreenshotReturnCanvas(e){
        var t=document.createElement("canvas");
        if(e&&e.braille){
            let{embosserModel:i,brailleMode:n}=e.braille,
                o=qp[i];
            t.width=o.width,
            t.height=o.height,
            $3(t,this,o,i,n)
        }else{
            let i=this._parseScreenshotOpts(e);
            t.width=i.width*i.targetPixelRatio,
            t.height=i.height*i.targetPixelRatio,
            this.screenshotToCanvas(t,e)
        }
        return t
    }
    screenshot(e){
        return this._syncScreenshotReturnCanvas(e).toDataURL("image/png")
    }
    asyncScreenshot(e,t){
        let i=!1;
        !e.transparentBackground&&e.showLabels&&(
            e=__dcg_shared_module_exports__['j'](e),
            e.transparentBackground=!0,
            i=!0
        );
        let n=this._syncScreenshotReturnCanvas(e),
            o=n.getContext("2d"),
            s=n,
            a=o;
        e&&e.format==="svg"&&(
            i=!1,
            e.transparentBackground&&(
                e=__dcg_shared_module_exports__['j'](e),
                e.transparentBackground=!1
            ),
            a=new aB(n.width,n.height),
            s={getContext:()=>a,width:n.width,height:n.height},
            this.screenshotToCanvas(s,e)
        );
        let l=this.makeScreenshotProjection(e),
            c=[];
        if(e.showMovablePoints&&this.movablePointsLayer.drawForScreenshot(a,l,c),e.showLabels){
            var u=l.screen.width,
                p=l.screen.height,
                g=l.settings.labelSize||15,
                h=1;
            (u<200||p<200)&&(h=.9);
            let b=g*h+"px",
                C=O(`
                    <div class="dcg-calculator-api-container">
                        <div class="dcg-container">
                            <div class="dcg-grapher" style="font-size:${b}"></div>
                        </div>
                    </div>`)
                    .css({width:l.screen.width,height:l.screen.height,position:"fixed",left:"0px",top:"0px"})
                    .appendTo("body"),
                D=C.find(".dcg-grapher"),
                S=Ow.mountToNode(vf,D[0],{grapher:()=>this}),
                V={width:l.screen.width,height:l.screen.height};
            S.drawForScreenshot(l,o,a,V,c),
            C.remove()
        }
        i&&(
            a.globalCompositeOperation="destination-over",
            a.fillStyle="#FFF",
            a.fillRect(0,0,s.width,s.height)
        ),
        e&&e.format==="svg"?t(a.getSerializedSvg()):t(s.toDataURL("image/png"))
    }
    makeScreenshotProjection(e){
        let{width:t,height:i,settings:n}=this._parseScreenshotOpts(e),
            o=new Ld(t,i),
            s=this.getProjection().viewport;
        return this.settings.squareAxes&&(s=s.squareCrop(o,this.settings)),
            new Oc(o,s,n)
    }
    screenshotToCanvas(e,t){
        let i=this._parseScreenshotOpts(t),
            {targetPixelRatio:n,transparentBackground:o}=i,
            s=e.getContext("2d");
        s.scale(n,n);
        let a=this.makeScreenshotProjection(t);
        a.settings.takingScreenshot=!0,
        Ks(s,"background"),
        gn(s,"dcg-svg-background"),
        o?s.clearRect(0,0,a.screen.width,a.screen.height):(s.fillStyle="white",s.fillRect(0,0,a.screen.width,a.screen.height)),
        Hi(s),
        Us(s),
        this.imageLayer.redrawToCtx(s,a,this.graphImages,this.__sketchOrder),
        this.gridLayer.redrawToCtx(s,a),
        this.graphsLayer.redrawToCtx(s,a,this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer,t)
    }
    getImageData(e,t,i,n){
        var o;
        return(o=this.canvasLayer.ctx)==null?void 0:o.getImageData(e,t,i,n)
    }
    getState(e){
        let t=__dcg_shared_module_exports__['a']({},this.getCurrentViewport());
        this.controller.is3dProduct()||(delete t.zmin,delete t.zmax);
        let i={viewport:t};
        return this.settings.stateProperties.forEach(n=>{n!=="randomSeed"&&(!this.controller.is3dProduct()&&QP(n)||(i[n]=this.settings[n]))}),
            e.stripDefaults&&(
                i=__dcg_shared_module_exports__['Ac'](Lh,i)
            ),
            i
    }
    getUndoRedoState(){
        let e={};
        return this.settings.stateProperties.forEach(t=>{e[t]=this.settings[t]}),
            e.viewport=this.getUserRequestedViewport(),
            e
    }
    notifyAfterRedraw(e){
        if(this.__isRedrawingSlowly)
            requestAnimationFrame(this.notifyAfterRedraw.bind(this,e));
        else if(!this.__redrawRequested)
            e();
        else{
            this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;
            let t="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;
            this.events.observeEvent(t,()=>{this.events.unobserveEvent(t),e()})
        }
    }
    speakGrapherFocusAriaLabel(){
        this.canvasLayer.speakAriaLabelAgain()
    }
    getCurrentViewport(){
        return this.viewportController.getViewport().toObject()
    }
    getUserRequestedViewport(){
        return this._lastUserRequestedViewport
    }
    setUserRequestedViewport(e){
        this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),
        this._lastUserRequestedViewportUpdateToken+=1,
        this._lastUserRequestedViewport=__dcg_shared_module_exports__['j'](e)
    }
    debounceUserRequestedViewportChange(){
        this.__debouncedViewportCommit||(this.__debouncedViewportCommit=__dcg_shared_module_exports__['C']((i,n)=>{
            if(!this.isDragging&&this._lastUserRequestedViewportUpdateToken===n){
                if(this._lastUserRequestedViewport){
                    var o=hn.fromObject(this._lastUserRequestedViewport),
                        s=this.computeConcreteViewport(o);
                    if(s.equals(i))
                        return
                }
                this.controller.dispatch({type:"commit-user-requested-viewport",viewport:i})
            }
        },1e3));
        let e=this.getCurrentViewport();
        this.__debouncedViewportCommit(e,this._lastUserRequestedViewportUpdateToken)
    }
    setGrapherState(e,t){
        if((!t||!t.doNotClear)&&this.clear(),
            e=Mu.copyGraphProperties(e,this.settings),
            "viewport"in e
        ){
            let i=hn.fromObject(e.viewport);
            this.setUserRequestedViewport(i);
            let n=this.computeConcreteViewport(i);
            this.viewportController.setViewport(n)
        }
        this.controller.requestRedrawGraph()
    }
    computeConcreteViewport(e){
        let t=this.getProjection().screen;
        return this.settings.squareAxes&&!e.isSquare(t,this.controller.getAxisScaleSettings())?e.squareYAxis(t,this.settings):e
    }
    classLayers(e){
        var t,i;
        return(i=(t=this._classLayers)[e])!=null?i:t[e]=new Set
    }
    setLayerClass(e,t){
        var i=this._layerClasses[e];
        if(this._layerClasses[e]=t,i!==t){
            if(i){
                let n=this.classLayers(i);
                n.delete(e),
                n.size===0&&this.elt.classList.remove(i)
            }
            t&&(
                this.classLayers(t).add(e),
                this.elt.classList.add(t)
            )
        }
    }
    setCanvasSizeFor3D(e,t){
        this.__screenRequested3D=new Ld(e,t)
    }
    getCanvasNode(){
        return this.canvasLayer.canvasNode
    }
};
// BEGIN SNATCH
dcg.Grapher2d = Mu;
dcg.Grapher2dCanvasLayer = OE;
dcg.Grapher2dViewportController = hE;
dcg.nextViewportControllerID = () => oW++;
dcg.Size = Ld;
dcg.Matrix2x2 = Dl;
dcg.Viewport = hn;
dcg.Projection = Oc;
dcg.point = Pc;
dcg.defaultScreenSize = Oj;
dcg.defaultViewport = Y3;
dcg.projectionCenter = i3;
dcg.expandProjection = RE;
dcg.translator = bc;
dcg.dA = dA;
dcg.t3 = t3;
dcg.r3 = r3;
dcg.Ul = Ul;
dcg.Re = Re;
dcg.pE = pE;
dcg.xe = xe;
// END SNATCH
function Pj(r,e,t){let i,n,o,s,a,l;return r?(i=r.width||r.height||t.width,n=r.height||r.width||t.height,o=r.targetPixelRatio||1,o<1&&(o=1),s=(i<256||n<256)&&!r.preserveAxisNumbers,a=wc.fromObject(r.settings||e),l=!!r.transparentBackground):(i=t.width,n=t.height,o=1,s=!1,a=wc.fromObject(e),l=!1),s&&(a.setProperty("xAxisNumbers",!1),a.setProperty("yAxisNumbers",!1),a.setProperty("polarNumbers",!1)),{width:i,height:n,targetPixelRatio:o,settings:a,transparentBackground:l}}var Pw=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-selection-display-name";this.toolType="selection";this.icon=[{type:"filled-polygon",color:"#000",path:[40,30,58,46,51,47,56,60,53,62,47,49,41,54,40,30]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['sb'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['nb']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}tryCommitResults(){return{committed:void 0}}shouldExpandLists(){return!1}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}shouldShowTransformationPreview(){return!1}};var X3="graphing-calculator-text-geometry-tool-point-hint",_w=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-point-display-name",this.toolName="point",this.toolType="simple",this.icon=[{type:"point",x:50,y:50,size:"large"}]}getExpressionEditHint(t){return this.s(X3)}getSpec(){return{inputs:[{type:"point",id:"1",hint:X3}],outputs:[]}}};var Q3="graphing-calculator-text-geometry-tool-line-hint-start",Z3="graphing-calculator-text-geometry-tool-line-hint-end",Fw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-line-display-name",this.toolType="simple",this.toolName="line",this.icon=[{type:"stroked-path",path:[78,22,22,78],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(Q3):this.s(Z3)}getSpec(){return{inputs:[{type:"point",id:"1",hint:Q3},{type:"point",id:"2",hint:Z3}],outputs:[{id:"3",type:"line",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var eK="graphing-calculator-text-geometry-tool-segment-hint-start",tK="graphing-calculator-text-geometry-tool-segment-hint-end",Rw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-segment-display-name",this.toolName="segment",this.toolType="simple",this.icon=[{type:"stroked-path",path:[68,32,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(eK):this.s(tK)}getSpec(){return{inputs:[{type:"point",id:"1",hint:eK},{type:"point",id:"2",hint:tK}],outputs:[{id:"3",type:"segment",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var rK="graphing-calculator-text-geometry-tool-ray-hint-start",iK="graphing-calculator-text-geometry-tool-ray-hint-end",Nw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-ray-display-name",this.toolName="ray",this.toolType="simple",this.icon=[{type:"stroked-path",path:[78,22,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(rK):this.s(iK)}getSpec(){return{inputs:[{type:"point",id:"1",hint:rK},{type:"point",id:"2",hint:iK}],outputs:[{id:"3",type:"ray",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var nK="graphing-calculator-text-geometry-tool-circle-hint-center",oK="graphing-calculator-text-geometry-tool-circle-hint-radius",Bw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-circle-display-name",this.toolName="circle",this.toolType="simple",this.icon=[{type:"circle",x:50,y:50,radius:26},{type:"point",x:50,y:50},{type:"point",x:68,y:32}]}getExpressionEditHint(t){return t===0?this.s(nK):this.s(oK)}getSpec(){return{inputs:[{type:"point",id:"1",hint:nK},{type:"point",id:"2",hint:oK}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var sK="graphing-calculator-text-geometry-tool-arc-hint-1",aK="graphing-calculator-text-geometry-tool-arc-hint-2",lK="graphing-calculator-text-geometry-tool-arc-hint-3",Kw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-arc-display-name",this.toolName="arc",this.toolType="complex";let i=50,n=80,o=80,s=-3,a=-2.6,l=-1.7;this.icon=[{type:"arc",x:n,y:o,radius:i,startAngle:s,endAngle:l},{type:"point",x:n+i*Math.cos(s),y:o+i*Math.sin(s)},{type:"point",x:n+i*Math.cos(a),y:o+i*Math.sin(a)},{type:"point",x:n+i*Math.cos(l),y:o+i*Math.sin(l)}]}getExpressionEditHint(t){return t===0?this.s(sK):t===1?this.s(aK):this.s(lK)}getSpec(){return{inputs:[{type:"point",id:"1",hint:sK},{type:"point",id:"2",hint:aK},{type:"point",id:"3",hint:lK}],outputs:[{id:"4",type:"arc",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var cK="graphing-calculator-text-geometry-tool-parallel-hint-straight-line",dK="graphing-calculator-text-geometry-tool-parallel-hint-point",Uw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-parallel-display-name",this.toolName="parallel",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[25,50,75,30],lineWidth:"large"},{type:"stroked-path",path:[25,70,75,50],lineWidth:"large"},{type:"point",x:50,y:60,size:"medium"}]}getExpressionEditHint(t){return t===0?this.s(cK):this.s(dK)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:cK},{type:"point",id:"2",hint:dK}],outputs:[{id:"3",type:"parallel",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var uK="graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line",pK="graphing-calculator-text-geometry-tool-perpendicular-hint-point",Hw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-perpendicular-display-name",this.toolName="perpendicular",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[40,25,60,75],lineWidth:"large"},{type:"stroked-path",path:[25,60,75,40],lineWidth:"large"},{type:"point",x:50,y:50,size:"medium"}]}getExpressionEditHint(t){return t===0?this.s(uK):this.s(pK)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:uK},{type:"point",id:"2",hint:pK}],outputs:[{id:"3",type:"perpendicular",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var KA="graphing-calculator-text-geometry-tool-midpoint-hint",qw=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-midpoint-display-name",this.toolName="midpoint",this.toolType="simple",this.icon=[{type:"stroked-path",path:[32,32,68,68]},{type:"point",x:50,y:50,size:"large"},{type:"point",x:32,y:32,size:"medium"},{type:"point",x:68,y:68,size:"medium"}]}getExpressionEditHint(t){return this.getHint()}canNextInputBePoint(){return!0}getNonPointInputType(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool;if(t===0)return"segment"}getSpec(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=this.model.getUncommittedObjects(),n=t[1],o=!1;if(i[n]&&_j(i[n]))o=!0;else{let s=n&&this.model.findDefsForInputId(n)[0];o=!!(s&&s.typedRuntimeValue.valueType==__dcg_shared_module_exports__['Ra'])}return o?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['Ra'],__dcg_shared_module_exports__['$a']],id:"1",hint:KA},{type:"point",id:"2",hint:KA}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}:{inputs:[{type:"segment",id:"1",hint:KA}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"}]}]}}};function _j(r){switch(r.type){case"point":case"intersection":case"glider":case"point-reference":case"midpoint":return!0;case"polygon":case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"vector":case"parallel":case"perpendicular":case"translate":case"reflect":case"dilate":case"rotate":case"angle":case"directedangle":case"angles":case"directedangles":case"polygon-segment":case"slider":case"transformed-object":case"expression-edit-preview-latex":return!1;default:return r}}var Fj="graphing-calculator-text-geometry-tool-polygon-hint-first-point",hK="graphing-calculator-text-geometry-tool-polygon-hint-next-point",Rj="graphing-calculator-text-geometry-tool-polygon-hint-finish-point",zw=class extends Pi{constructor(t){super(t);this.model=t;this.addExtraPoint=!1;this.mouseOverFirstPoint=!1;this.mouseOverLastPoint=!1;this.displayName="graphing-calculator-text-geometry-tool-polygon-display-name",this.toolName="polygon",this.toolType="complex",this.icon=[{type:"filled-polygon",path:[55,30,30,30,35,70,70,60,55,30]},{type:"stroked-path",path:[55,30,30,30,35,70,70,60,55,30]},{type:"point",x:55,y:30},{type:"point",x:30,y:30},{type:"point",x:35,y:70},{type:"point",x:70,y:60}]}clearTentativeOutputs(){let t=this.addExtraPoint;this.addExtraPoint=!0,super.clearTentativeOutputs(),this.addExtraPoint=t}getHint(){let t=this.model.getNonObjectsState().ui.currentTool.inputIndex;return t===0?this.s(Fj):t<3?this.s(hK):this.s(Rj)}getExpressionEditHint(t){return this.s(hK)}canNextInputBePoint(){return!0}getSpec(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool,i=t;this.addExtraPoint&&(i+=1),i<2&&(i=2);for(var n={inputs:[],outputs:[]},o=[],s=0;s<i;s++){let a=s.toString();o.push({type:"reference-input",id:a}),n.inputs.push({type:"point",id:a})}return n.outputs.push({id:"polygon",type:"polygon",hidden:!1,parents:o,connectBorder:this.mouseOverFirstPoint}),n}tryCommitResults(){this.addExtraPoint=!this.mouseOverFirstPoint&&!this.mouseOverLastPoint;let t=this.getSpec();if(this.addExtraPoint=!1,this.model.attemptLockToolInputIn(t),!this.mouseOverFirstPoint&&!this.mouseOverLastPoint)return{committed:void 0};if(this._isReadyToCommit()){this.mouseOverFirstPoint=!1,this.mouseOverLastPoint=!1;let i=this.model.getUncommittedObjects(),n=__dcg_shared_module_exports__['a']({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:i,toolIdToLatex:n}}return{committed:void 0}}onMove(t){this.clearTentativeOutputs(),this.mouseOverFirstPoint=!1,this.mouseOverLastPoint=!1;let i=this.model.getObjectDefUnderMouse(t.pt,t.tolerance),{idMap:n,inputIndex:o}=this.model.getNonObjectsState().ui.currentTool;if(i){let a=this.getExpandedReferenceForDef(i,t.shift);if(this.model.objectIsInstanceOf(i,"point")&&this.model.isObjectALockedToolInput(a)&&(this.mouseOverFirstPoint=n[0]===a,this.mouseOverLastPoint=n[o-1]===a,this.mouseOverFirstPoint||this.mouseOverLastPoint))return i&&this.model.setObjectHovered({calcId:i.calcId,listIndex:this.getListIndexForHover(i,t.shift)}),this.createOutput(),!0}this.addExtraPoint=!0;let s=this._getOrCreatePoint(t.pt,t.shift,t.tolerance);return this.model.tentativelyMatchToolInput(this.getSpec(),s.reference),s.def&&!s.createdNew&&this.model.setObjectHovered({calcId:s.def.calcId,listIndex:this.getListIndexForHover(s.def,t.shift)}),this.createOutput(),this.addExtraPoint=!1,!0}};var Nj="graphing-calculator-text-geometry-tool-compass-hint-segment",Bj="graphing-calculator-text-geometry-tool-compass-hint-center",$w=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-compass-display-name",this.toolName="compass",this.toolType="complex",this.icon=[{type:"stroked-path",path:[50,50,75,50]},{type:"circle",x:50,y:50,radius:25}]}getExpressionEditHint(t){return this.getHint()}getSpec(){return{inputs:[{type:"segment",id:"1",hint:Nj},{type:"point",id:"2",hint:Bj}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"1"}]}]}}};var gK="graphing-calculator-text-geometry-tool-angle-hint-1",mK="graphing-calculator-text-geometry-tool-angle-hint-2",fK="graphing-calculator-text-geometry-tool-angle-hint-3",yK="graphing-calculator-text-geometry-tool-angles-hint-1",dg=class extends Pi{constructor(t){super(t);this.model=t;this.toolType="complex",this.displayName="graphing-calculator-text-geometry-tool-angle-display-name",this.toolName="angle",this.angleType="angle",this.anglesType="angles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}canNextInputBePoint(){return!0}shouldReferenceSpecificItemInList(t,i){return __dcg_shared_module_exports__['zb'](t.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Za'])?!0:super.shouldReferenceSpecificItemInList(t,i)}getNonPointInputType(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool;if(t===0)return"polygon"}getExpressionEditHint(t){return t===0?this.s(gK):t===1?this.s(mK):this.s(fK)}getSpec(){let{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool,n=i[1];if(!t&&!n)return{inputs:[{type:"polygon",id:"1",hint:yK}],outputs:[{id:"2",type:this.anglesType,listAccess:void 0,hidden:!1,showLabel:!0,label:"",parents:[{type:"reference-input",id:"1"}]}]};let o=[];if(n&&this.model.findDefsForInputId(n).forEach(a=>{let l=a.typedRuntimeValue;if(l.valueType===__dcg_shared_module_exports__['Za']){let c=l.value.length;c>0&&o.push({referenceLatex:a.referenceLatex,sides:c})}}),o.length){let s=[],a=2;return o.forEach(l=>{for(var c=0;c<l.sides;c++)s.push({id:a+"",type:this.anglesType,listAccess:c+1,hidden:!1,showLabel:!0,label:"",parents:[{type:"hardcoded",id:l.referenceLatex}]}),a+=1}),{inputs:[{type:"polygon",id:"1",hint:yK}],outputs:s}}return{inputs:[{type:"point",id:"1",hint:gK},{type:"point",id:"2",hint:mK},{type:"point",id:"3",hint:fK}],outputs:[{id:"4",type:this.angleType,hidden:!1,showLabel:!0,label:"",parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var Ww=class extends dg{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-directedangle-display-name",this.toolName="directedangle",this.angleType="directedangle",this.anglesType="directedangles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,isDirected:!0,startAngle:-1.325817,deltaAngle:1.325817},{type:"stroked-path",path:[35,50,41,50,37,55,35,50],color:"#000",lineWidth:"medium"},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}};var Rc=class extends Pi{generateDefaultName(){return"does not matter"}shouldShowTransformationPreview(){return!0}};var bK="graphing-calculator-text-geometry-tool-reflection-hint-choose-line",jw=class extends Rc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-reflect-display-name",this.toolName="reflection",this.toolType="transformation"}getExpressionEditHint(t){return this.s(bK)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:bK}],outputs:[{id:"2",type:"reflect",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}}};var UA="graphing-calculator-text-geometry-tool-translation-hint-from",wK="graphing-calculator-text-geometry-tool-translation-hint-to",Jw=class extends Rc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-translate-display-name",this.toolName="translation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(UA):this.s(wK)}firstInputIsVector(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=t[1],n=i&&this.model.findDefsForInputId(i)[0];return n&&n.typedRuntimeValue.valueType===__dcg_shared_module_exports__['pb']}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['Ra'],__dcg_shared_module_exports__['pb']],id:"1",hint:UA}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['Ra'],__dcg_shared_module_exports__['pb']],id:"1",hint:UA},{type:"point",id:"2",hint:wK}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}shouldShowTransformationPreview(){return this.firstInputIsVector()?!1:super.shouldShowTransformationPreview()}};var xK="graphing-calculator-text-geometry-tool-rotation-hint-center",vK="graphing-calculator-text-geometry-tool-rotation-hint-angle",Yw=class extends Rc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-rotate-display-name",this.toolName="rotation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(xK):this.s(vK)}getSpec(){return{inputs:[{type:"point",id:"1",hint:xK},{type:"number",id:"2",hint:vK,defaultLatex:this.model.controller.isDegreeMode()?"90":"\\frac{\\pi}{2}",sliderInfo:{value:this.model.controller.isDegreeMode()?"90":"1.57079632679",min:"0",max:this.model.controller.isDegreeMode()?"360":"2\\pi"}}],outputs:[{id:"3",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var CK="graphing-calculator-text-geometry-tool-dilation-hint-center",DK="graphing-calculator-text-geometry-tool-dilation-hint-scale-factor",Xw=class extends Rc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-dilate-display-name",this.toolName="dilation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(CK):this.s(DK)}getSpec(){return{inputs:[{type:"point",id:"1",hint:CK},{type:"number",id:"2",hint:DK,defaultLatex:"2",sliderInfo:{value:"2",min:"0",max:"5"}}],outputs:[{id:"3",type:"dilate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var $p=class extends Pi{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-expression-edit-display-name",this.toolType="custom",this.toolName="expression-edit"}getHint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||!t.functionSymbol)return this.getGenericHint();let i=this.model.getTool(t.functionSymbol);if(!i)return this.getGenericHint();let n=t.argIndex;return t.positionWithinArg==="end"&&(n+=1),i.getExpressionEditHint(n)}getGenericHint(){let t=this.getAllValidNextInputTypes();if(t.some(n=>n===__dcg_shared_module_exports__['Pa']||n===__dcg_shared_module_exports__['Sa']))return pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object");let i=t.filter(n=>!(__dcg_shared_module_exports__['vb'](n)&&t.find(o=>__dcg_shared_module_exports__['wb'](n)===o))).map(n=>md(__dcg_shared_module_exports__['ub'](n),fb()));return i.length===0?pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0"):i.length===1?pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1",{type:i[0]}):i.length===2?pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2",{type1:i[0],type2:i[1]}):pn("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many",{types:i.join(", ")})}getExpressionEditHint(t){return this.getHint()}getSpec(){let t=this.model.controller.getSelectedItem(),i=HA(this.model.controller.getValidCursorContext());return!i||!t||t.type!=="expression"?{inputs:[],outputs:[]}:{inputs:[{type:"union",valueTypes:i,id:"1"}],outputs:[{type:"expression-edit-preview-latex",rhsLatex:this.buildPreviewLatex(),hidden:!1,color:t.color,id:"2",parents:[]}]}}onMove(t){super.onMove(t);let{idMap:i,inputIndex:n}=this.model.getNonObjectsState().ui.currentTool,o=this.getSpec().inputs[n];return!!(o&&i[o.id])}buildPreviewLatex(){let t="",i="",n=this.model.controller.getValidCursorContext();if((n==null?void 0:n.type)==="empty")return"";(n==null?void 0:n.type)==="expression-arguments"&&((n==null?void 0:n.positionWithinArg)==="end"?t=",":(n==null?void 0:n.positionWithinArg)==="start"&&(i=","));let o=this.model.getNonObjectsState().ui.currentTool.idMap,s=t+o[1]+i,a=this.model.controller.getSelectedItem();if((a==null?void 0:a.type)!=="expression")return"";let l=it.getFocusedMathquill(),c=l==null?void 0:l.selection();if((c==null?void 0:c.latex)!==a.latex)return"";let u=a.latex.slice(0,c.startIndex)+s+a.latex.slice(c.endIndex);return jo(a)?u.slice(a.latex.indexOf("=")+1):u}canNextInputBePoint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||t.expressionType!=="FunctionCall"&&t.expressionType!=="List")return!1;let i=HA(t);if(!i)return!1;let n=!1;for(let o of i){if(__dcg_shared_module_exports__['zb'](o,__dcg_shared_module_exports__['Pa']))return!1;__dcg_shared_module_exports__['zb'](o,__dcg_shared_module_exports__['Ra'])&&(n=!0)}return n}shouldHighlightRelevantObjects(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)==="empty")return!1;let i=HA(t);return!(!i||i.some(n=>__dcg_shared_module_exports__['zb'](n,__dcg_shared_module_exports__['Pa']))||i.every(n=>__dcg_shared_module_exports__['zb'](n,__dcg_shared_module_exports__['Qa'])||__dcg_shared_module_exports__['zb'](n,__dcg_shared_module_exports__['jb'])||__dcg_shared_module_exports__['zb'](n,__dcg_shared_module_exports__['lb'])))}};function HA(r){if((r==null?void 0:r.type)==="empty")return[__dcg_shared_module_exports__['jb'],__dcg_shared_module_exports__['lb'],__dcg_shared_module_exports__['kb'],__dcg_shared_module_exports__['mb'],__dcg_shared_module_exports__['pb']];let e=(r==null?void 0:r.type)==="expression-arguments"?r.allowedTypesForInsertedArg:r==null?void 0:r.allowedTypes;return e==null?void 0:e.filter(t=>!__dcg_shared_module_exports__['zb'](t,__dcg_shared_module_exports__['rb']))}var Kj={selection:Pw,point:_w,line:Fw,segment:Rw,ray:Nw,circle:Bw,arc:Kw,parallel:Uw,perpendicular:Hw,midpoint:qw,polygon:zw,compass:$w,angle:dg,directedangle:Ww,reflect:jw,translate:Jw,rotate:Yw,dilate:Xw,"box-selection":ig,"expression-edit":$p},qA=Kj;function Uj(r,e){var s;if(e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['nb'])return[];let t=e.data.call;if(!t||!t.parents)return[];let i=t.symbol,n=t.parents.map(Af),o;switch(i){case"circle":{let[a,l]=n,c=l&&((s=r[l])==null?void 0:s.typedRuntimeValue.valueType);c&&__dcg_shared_module_exports__['zb'](c,__dcg_shared_module_exports__['$a'])?o=[a]:o=[a,l];break}case"apply":{o=[n[1]];break}case"parallel":case"perpendicular":{o=[n[1]];break}case"polygon":{o=n.every(a=>a!==void 0)?n:[];break}default:o=n}return o.filter(EK)}var Hj=[[1,0],[0,0],!1],KE=class{constructor(e,t){let i=(e==null?void 0:e.list)||[];t&&(i=i.concat(t)),this.list=i;let n=(e==null?void 0:e.forward)||Hj;t&&(n=__dcg_shared_module_exports__['Ia'](n,t.value)),this.forward=n,this.inverse=__dcg_shared_module_exports__['Ja'](n)}add(e){return new KE(this,e)}equals(e){if(this.list.length!==e.list.length)return!1;for(let t=this.list.length-1;t>=0;t--){let i=this.list[t],n=e.list[t];if(!__dcg_shared_module_exports__['G'](i,n))return!1}return!0}isCompletelyRigid(){return this.list.length===0}},Qw=KE;Qw.COMPLETELY_RIGID=new KE(void 0);function qj(r){var i,n;let e={},t={};for(let o in r){let s=r[o];if(!s)continue;for(let l of((i=s.data.call)==null?void 0:i.parents)||[]){let c=Af(l);c&&(e[c]||(e[c]=[]),(n=e[c])==null||n.push(s.assignment))}let a=Uj(r,s);t[s.assignment]=a}return{parentToChildren:e,childToReversibilityParents:t}}function SK(r){let e=[],t={},i,n=1,o=2;function s(a){var l;t[a]!==o&&(t[a]=n,(l=r[a])==null||l.forEach(s),t[a]=o,e.unshift(a))}for(let a in r)t[a]===i&&s(a);return e}function zA(r,e){var p,g,h,b,C,D,S,V,k,T;let t={},i={},n={},o={},s={};for(let A of e)s[A]=!0,n[A]=Qw.COMPLETELY_RIGID;let{parentToChildren:a,childToReversibilityParents:l}=qj(r);for(let A of SK(l)){let R=r[A];if(!R)return{};let P=(p=R.data.call)==null?void 0:p.symbol,W=(((g=R.data.call)==null?void 0:g.parents)||[]).map(Af).filter(EK);if(n[R.assignment])if(R.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Ra']&&!P)t[R.assignment]=n[R.assignment];else if(P==="glider"&&W.length&&!s[W[0]])i[R.assignment]=n[R.assignment];else{let H=n[R.assignment];if(P==="apply"){let ne=(h=r[W[0]])==null?void 0:h.typedRuntimeValue;if((ne==null?void 0:ne.valueType)!==__dcg_shared_module_exports__['nb'])return{};H=H.add(ne)}let j=(b=l[R.assignment])!=null?b:[];for(let ne of j)n[ne]?H.equals(n[ne])||(n[ne]=Qw.COMPLETELY_RIGID,o[ne]=!0):n[ne]=H}}let c={};for(let A in n)c[A]=!0;for(let A of SK(a))if(c[A]){for(let R of a[A]||[])c[R]=!0;if(n[A]){let R=l[A]||[];for(let P of R)o[P]&&(o[A]=!0)}}for(let A in i){let P=(((D=(C=r[A])==null?void 0:C.data.call)==null?void 0:D.parents)||[]).map(Af)[0];P&&c[P]&&(o[P]=!0)}for(let A in r){if(!c[A])continue;let R=r[A],P=(S=R==null?void 0:R.data.call)==null?void 0:S.symbol,W=(((V=R==null?void 0:R.data.call)==null?void 0:V.parents)||[]).map(Af);if(P==="apply"&&n[A]){let H=W[1],j=W[0];if(!H||!j)return{};let ne=(((T=(k=r[j])==null?void 0:k.data.call)==null?void 0:T.parents)||[]).map(Af),le=ne.some(B=>B&&c[B]);if(n[A].isCompletelyRigid()&&n[H].isCompletelyRigid()||le){o[H]=!0;for(let B of ne)B&&(o[B]=!0)}}}let u=[];for(let A in o)s[A]||u.push(A);return u.length?zA(r,e.concat(u)):__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),i)}function Af(r){return r?__dcg_shared_module_exports__['Ib'](r[0]):void 0}function EK(r){return r!==void 0}var Zw=class{constructor(){this._nextId=0;this._defs={}}clear(){this._nextId=0,this._defs={}}add(e,t){let i;t?(i=e.assignment,e.listIndex!==void 0&&(i+="\\left["+e.listIndex+"\\right]")):i="**geo-internal-id-"+this._nextId++,this._defs[i]=e}computeReversibilityLineages(e){var a;let t=this.buildAssignmentMap(),i={};for(let l in t){let c=t[l];c&&(i[c.calcId]=c)}let n=[];for(let l of e){let c=i[l];if(!c)return{};n.push(c.assignment)}let o=zA(this.buildAssignmentMap(),n),s={};for(let l in o){let c=(a=t[l])==null?void 0:a.calcId;c&&(s[c]=o[l])}return s}buildAssignmentMap(){let e={};for(let t in this._defs){let i=this._defs[t];i&&(e[i.assignment]=i)}return e}getDepthValues(){var c,u;var e={},t={};let i=this.buildAssignmentMap();for(let p in i){let g=i[p];if(!g)continue;let h=__dcg_shared_module_exports__['Kb'](g.assignment),b=[],C=[];(c=g.data.call)!=null&&c.parents?C=(u=g.data.call)==null?void 0:u.parents:g.data.assignmentRhsReference&&(C=[g.data.assignmentRhsReference]),C.forEach(D=>{let S=D&&D[0];S&&(b.push(S),t[S]||(t[S]=[]),t[S].push(__dcg_shared_module_exports__['Kb'](h)))}),e[h]=b}let n=p=>{if(o[p]!==void 0)return o[p];var g=-1,h=e[p]||[];for(let C=0;C<h.length;C++){let D=n(h[C]);D>g&&(g=D)}let b=g+1;return o[p]=b,b};var o={};for(var s in e)o[s]=n(s);var a={},l={};for(var s in t){let g=o[s],h=1/0;t[s].forEach(b=>{let C=o[b];C>g&&(g=C),C<h&&(h=C)}),a[s]=g,l[s]=h}return{createdDepth:o,lastReferencedDepth:a,firstReferencedDepth:l}}};function kK(r,e,t){let n=.5/(2*t*e);return Li(r-n,r+n)}function ex(r,e,t,i,n=0){let o=__dcg_shared_module_exports__['Z'](r.x,r.y,0,t[0],t[1],0,i[0],i[1],0);n&&(o+=n);let a=.5/(__dcg_shared_module_exports__['oa'](t,i)*e);return Li(o-a,o+a)}function Nc(r,e){for(let t of e)t&&(t.min!==void 0&&r<t.min?r=t.min:t.max!==void 0&&r>t.max&&(r=t.max));return r}function UE(r,e,t,i){if(!t)return 0;var n=r.mapx(1)-r.mapx(0);switch(t.valueType){case __dcg_shared_module_exports__['bb']:{let s=e.x-t.value[0][0],a=e.y-t.value[0][1],l=Math.atan2(a,s)/(2*Math.PI);l<0&&(l+=1),l=kK(l,n,t.value[1]);let c=Nc(0,[i]),u=Nc(1,[i]);if(l>=c&&l<=u)return l;{let p=__dcg_shared_module_exports__['ua'](t.value,c),g=__dcg_shared_module_exports__['ua'](t.value,u),h=__dcg_shared_module_exports__['oa'](p,[e.x,e.y]),b=__dcg_shared_module_exports__['oa'](g,[e.x,e.y]);return h<=b?c:u}}case __dcg_shared_module_exports__['db']:{let s=__dcg_shared_module_exports__['xa'](t.value);if(!s)return 0;if(s.type==="segment"){let a=ex(e,n,s.start,s.end);return Nc(a,[{min:0,max:1},i])}else if(s.type==="rays"){let a=__dcg_shared_module_exports__['oa'](s.start1,[e.x,e.y]),l=__dcg_shared_module_exports__['oa'](s.start2,[e.x,e.y]),c=!i||i.min===void 0?-1/0:i.min,u=!i||i.max===void 0?1/0:i.max;return a<l?c>0?u>=1?1:c:Nc(-ex(e,n,s.start1,s.end1),[{min:void 0,max:0},i]):u<1?c<=0?0:u:Nc(ex(e,n,s.start2,s.end2,1),[{min:1,max:void 0},i])}else if(s.type=="arc"){let[a,l]=s.center,{radius:c,startAngle:u}=s,p=__dcg_shared_module_exports__['qa'](t.value),g=e.x-a,h=e.y-l,b=__dcg_shared_module_exports__['V'](Math.atan2(h,g),u,p);if(b>=0&&b<=1)b=kK(b,n,c);else{let S=iE(e,{x:a+c*Math.cos(u),y:l+c*Math.sin(u)}),V=iE(e,{x:a+c*Math.cos(u+p),y:l+c*Math.sin(u+p)});S<=V?b=0:b=1}let C=Nc(0,[i]),D=Nc(1,[i]);if(b>=C&&b<=D)return b;{let S=__dcg_shared_module_exports__['va'](t.value,C),V=__dcg_shared_module_exports__['va'](t.value,D),k=__dcg_shared_module_exports__['oa'](S,[e.x,e.y]),T=__dcg_shared_module_exports__['oa'](V,[e.x,e.y]);return k<=T?C:D}}return Nc(0,[i])}case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['$a']:case __dcg_shared_module_exports__['fb']:{let s=ex(e,n,t.value[0],t.value[1]);return Nc(s,[{min:t.valueType===__dcg_shared_module_exports__['fb']?void 0:0,max:t.valueType!==__dcg_shared_module_exports__['$a']?void 0:1},i])}case __dcg_shared_module_exports__['Za']:{let s=t.value,a=1/0,l=Nc(0,[i]),c=i&&i.min!==void 0?i.min:-1/0,u=i&&i.max!==void 0?i.max:1/0,p=Math.floor(Math.max(c,0)),g=Math.ceil(Math.min(u,s.length));for(let h=p;h<g;h++){let b=s[h],C=s[(h+1)%s.length],D=Nc(ex(e,n,b,C,h),[{min:h,max:h+1},i]),S=__dcg_shared_module_exports__['wa'](t.value,D),V=__dcg_shared_module_exports__['oa'](S,[e.x,e.y]);V<a&&(a=V,l=D)}return l}case __dcg_shared_module_exports__['Ra']:case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:case __dcg_shared_module_exports__['pb']:return 0;default:return t}}function GK(r,e){switch(r.valueType){case __dcg_shared_module_exports__['bb']:return __dcg_shared_module_exports__['ua'](r.value,e);case __dcg_shared_module_exports__['db']:return __dcg_shared_module_exports__['va'](r.value,e);case __dcg_shared_module_exports__['hb']:return __dcg_shared_module_exports__['ta'](r.value,e);case __dcg_shared_module_exports__['$a']:return __dcg_shared_module_exports__['sa'](r.value,e);case __dcg_shared_module_exports__['fb']:return __dcg_shared_module_exports__['ra'](r.value,e);case __dcg_shared_module_exports__['Za']:return __dcg_shared_module_exports__['wa'](r.value,e);case __dcg_shared_module_exports__['Ra']:case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:case __dcg_shared_module_exports__['pb']:return[NaN,NaN];default:return r}}function zj(r,e){if(!e)return!1;let{left:t,right:i,top:n,bottom:o}=r.pixelCoordinates,{x:s,y:a}=e.mathPoint;if(e.transform){let l=e.model.formula.typed_constant_value;if((l==null?void 0:l.valueType)!==__dcg_shared_module_exports__['Ra'])throw new Error(`Expected movable point to be a Point but found ${l?__dcg_shared_module_exports__['tb'](l.valueType):void 0} instead`);s=s!=null?s:l.value[0],a=a!=null?a:l.value[1],[s,a]=__dcg_shared_module_exports__['Ka'](e.transform.forward,[s,a])}if(s!==void 0){let l=r.mathToPixels.mapX(s);if(l<t-.5||l>i+.5)return!1}if(a!==void 0){let l=r.mathToPixels.mapY(a);if(l<n-.5||l>o+.5)return!1}return!0}function IK(r,e){if(e.length===1&&!zj(r,e[0]))return!1;let t=!1;for(let i of e){if(i.newPointLatex){let n=i.model.latex;ya(i.model,i.newPointLatex),t=t||n!==i.model.latex}for(let n in i.sliderUpdates){let{value:o,model:s}=i.sliderUpdates[n];i.commitSliderSoftLimits&&Sm(s);let a=s.latex;tD(s,o),t=t||a!==s.latex}}return t}function VK({projection:r,transform:e,controller:t,strategy:i,mode:n,clampToViewport:o}){var T;let s=t.getItemModel(i.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);let a=n==="up"||n==="bigup",l=((T=s.slider)==null?void 0:T.step)!==""&&(a&&!s.slider.hardMax||!a&&!s.slider.hardMin);i.compiled.fn||__dcg_shared_module_exports__['Wb'](i.compiled);let c=i.compiled.fn;e&&(c=A=>__dcg_shared_module_exports__['Ka'](e.forward,i.compiled.fn(A)));let u=A=>{let[R,P]=c(A);return{x:R,y:P}=r.mathToPixels.mapPoint({x:R,y:P}),[R,P]},p=ma(s),[g,h]=u(p),b=IT(s,n,{ignoreSoftLimits:l}),C=b,[D,S]=u(C),V=__dcg_shared_module_exports__['X'](D-g,S-h);if(V<1){let A=__dcg_shared_module_exports__['ia'](u,[g+(D-g)/V,h+(S-h)/V],C,C>p?C:i.min,C<p?C:i.max,1);if(A){let R=Li(A[0],A[1]);(n==="bigup"||n==="bigdown")&&(R=p+(R-p)*5);let P=Rl(s,__dcg_shared_module_exports__['ha'](R,i.min,i.max),{ignoreSoftLimits:l}),[W,H]=u(P);__dcg_shared_module_exports__['X'](W-g,H-h)>V&&(b=P)}}o&&(b=MK(r,ma(s),b,c));let k=c(b);return{mathPoint:{x:k[0],y:k[1]},sliderUpdates:{[i.id]:{model:s,value:b}}}}function TK({controller:r,projection:e,transform:t,strategy:i,targetScreenPoint:n,clampToViewport:o}){let s={mathPoint:{},sliderUpdates:{}},a=r.getItemModel(i.id);if(!a||a.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${a==null?void 0:a.type}`);i.compiled.fn||__dcg_shared_module_exports__['Wb'](i.compiled);let l=i.compiled.fn;t&&(l=k=>__dcg_shared_module_exports__['Ka'](t.forward,i.compiled.fn(k)));let c=k=>{let[T,A]=l(k);return{x:T,y:A}=e.mathToPixels.mapPoint({x:T,y:A}),[T,A]},u=i.initialValue,p=i.min,g=i.max,h=[n.x,n.y],b=__dcg_shared_module_exports__['ia'](c,h,u,p,g,1);if(!b)return s;let C=Li(b[0],b[1]);p!==void 0&&C<p&&(C=p),g!==void 0&&C>g&&(C=g);let D=Rl(a,C,{ignoreSoftLimits:!0});o&&(D=MK(e,ma(a),D,l));let[S,V]=l(D);return s.mathPoint.x=S,s.mathPoint.y=V,s.sliderUpdates[a.id]={value:D,model:a},s}function WA({controller:r,projection:e,transform:t,strategy:i,targetScreenPoint:n}){let o=e.reverse_map_pt(n);if(t){let u=__dcg_shared_module_exports__['Ka'](t.inverse,[o.x,o.y]);o={x:u[0],y:u[1]}}let s=i.type==="updateSliderForGlider"?{min:i.min,max:i.max}:void 0,a=UE(e,o,i.movesOn,s);if(!isFinite(a))return;let l=GK(i.movesOn,a),c={mathPoint:{x:l[0],y:l[1]},newPointLatex:void 0,sliderUpdates:{}};if(i.type==="updateGliderParameter"){let u=i.span;c.newPointLatex=u.input.slice(0,u.start)+__dcg_shared_module_exports__['lc'](a)+u.input.slice(u.end)}else if(i.type==="updateSliderForGlider"){let u=r.getItemModel(i.id);u&&u.type==="expression"&&(c.sliderUpdates[u.id]={value:a,model:u})}return c}function MK(r,e,t,i){let n=u=>{let[p,g]=i(u);return r.mathToPixels.mapPoint({x:p,y:g})},o=({x:u,y:p})=>{let{left:g,right:h,top:b,bottom:C}=r.pixelCoordinates;return u>=g&&u<=h&&p>=b&&p<=C},s=e,a=n(e),l=t,c=n(t);if(o(c)||!o(a))return t;for(;;){let u=a.x-c.x,p=a.y-c.y;if(u*u+p*p<.5)break;let g=__dcg_shared_module_exports__['ga'](s,l);if(g===s||g===l){[s,l]=o(a)?[s,s]:[l,l];break}let h=n(g);o(h)!==o(a)?[l,c]=[g,h]:[s,a]=[g,h]}return Li(s,l)}function jA({controller:r,projection:e,transform:t,formula:i,moveStrategy:n,dragMode:o,targetScreenPoint:s,clampToViewport:a}){if(t){let{x:h,y:b}=e.pixelsToMath.mapPoint(s),[C,D]=__dcg_shared_module_exports__['Ka'](t.inverse,[h,b]);s=e.mathToPixels.mapPoint({x:C,y:D})}var l=e.pixelsToMath.mapRect({left:s.x-.5,right:s.x+.5,top:s.y+.5,bottom:s.y-.5}),c=[{min:l.left,max:l.right},{min:l.top,max:l.bottom}];let u={mathPoint:{},sliderUpdates:{}},[p,g]=n;if(p.type==="updateCoordinate"||g.type==="updateCoordinate"){let h=$j(i,c,o);if(h){let{latex:b,x:C,y:D}=h;(C!==void 0||D!==void 0)&&(u.newPointLatex=b,u.mathPoint.x=C!=null?C:u.mathPoint.x,u.mathPoint.y=D!=null?D:u.mathPoint.y)}}for(let h of[0,1]){let b=n[h];if($A(h,o)&&b.type==="updateSlider"){let C=r.getItemModel(b.id);if(!C||C.type!=="expression")continue;let[D,S]=b.coefficients,V=Li(S*c[h].min+D,S*c[h].max+D),k=Rl(C,V,{ignoreSoftLimits:!0}),T=(k-D)/S;if(!a||t){u.mathPoint[h===0?"x":"y"]=T,u.sliderUpdates[C.id]={value:k,model:C};continue}let[A,R]=h===0?[e.mathCoordinates.left,e.mathCoordinates.right]:[e.mathCoordinates.bottom,e.mathCoordinates.top],P=T<A?A:T>R?R:void 0;P!==void 0&&Bl(C)===void 0?(u.mathPoint[h===0?"x":"y"]=P,u.sliderUpdates[C.id]={value:S*P+D,model:C}):(u.mathPoint[h===0?"x":"y"]=T,u.sliderUpdates[C.id]={value:k,model:C})}}return u}function $j(r,e,t){if(!r.move_strategy)throw new Error("Programming error: expected move_strategy to be defined.");var i=Li(e[0].min,e[0].max),n=Li(e[1].min,e[1].max);let[o,s]=r.move_strategy,a=!1,l=!1,c,u="",p=0;if(o.type==="updateCoordinate"&&$A(0,t)&&(c=o.inputSpan.input,a=!0,u+=c.slice(p,o.inputSpan.start),u+=__dcg_shared_module_exports__['lc'](i),p=o.inputSpan.end),s.type==="updateCoordinate"&&$A(1,t)&&(c=s.inputSpan.input,l=!0,u+=c.slice(p,s.inputSpan.start),u+=__dcg_shared_module_exports__['lc'](n),p=s.inputSpan.end),c!==void 0)return u+=c.slice(p),{latex:u,x:a?i:void 0,y:l?n:void 0}}function $A(r,e){switch(e){case"X":return r===0;case"Y":return r===1;case"XY":return!0;default:return!1}}function AK(r,e,t){t.forEach(i=>{Wj(r,e,i)})}function LK(r,e,t,i,n,o,s){var u;let a=!1,l=e.length===1,c=[];for(let p=0;p<e.length;p++){let g=e[p];if(g.tableInfo){Jj(r,g,i[p],n),a=!0;continue}let h=r.getItemModel(g.calcId);if(h){if(h.type==="image")a=a||Qj(r,h,g,i[p],n);else if(h.type==="expression"){let b=Zj({controller:r,movedExpr:h,dragMode:(u=rn(h,{isReverseDrag:g.isReverseDrag}))!=null?u:"NONE",currentScreenPoint:t[p],targetScreenPoint:i[p],projection:n,transform:o&&o[p],isOnlyPoint:l,keyboardDirection:s});b&&c.push(b)}}}return a=a||IK(n,c),a}function OK(r,e){e.forEach(t=>{jj(r,t)})}function Wj(r,e,t){if(t.tableInfo){ui(e,void 0);let a=r.getItemModel(t.tableInfo.tableId);if(!a||a.type!=="table")return;bM(a,!0)}else{let a=r.getItemModel(t.calcId);if(!a||!(a.type==="expression"||a.type==="image")||!a.formula||!a.formula.move_strategy)return;for(var i=a.formula.move_strategy,n=0;n<i.length;n++){let l=i[n];if(i[n].type==="updateCoordinate"||i[n].type==="updateGliderParameter")a.type==="image"?tM(a,!0):a.type==="expression"&&MT(a,!0);else if(l.type==="updateSlider"||l.type==="updateSliderNonlinear"||l.type==="updateSliderForGlider"){var o=r.getItemModel(l.id);if(!o||o.type!=="expression")continue;var s;if(a.type==="expression"?s=rn(a,{isReverseDrag:t.isReverseDrag}):s=void 0,s==="NONE"||n===0&&s==="Y"||n===1&&s==="X")continue;kb(o,!0)}}}}function jj(r,e){for(let t of r.getAllItemModels())t.type==="table"?t.draggingOnGraphpaper&&bM(t,!1):t.type==="expression"?(t.sliderDragging&&kb(t,!1),t.draggingOnGraphpaper&&MT(t,!1)):t.type==="image"&&t.draggingOnGraphpaper&&tM(t,!1)}function Jj(r,e,t,i){var n=e.tableInfo.tableId,o=e.tableInfo.rowIndex,s=e.tableInfo.columnId,a=e.tableInfo.dragX,l=e.tableInfo.dragY,c=r.getItemModel(n);if(!(!c||c.type!=="table")){var u=ps(c,s);if(u){var p=i.closestPointOnScreen(t),g=i.pixelsToMath.mapRect(PK(p,.5)),h={x:__dcg_shared_module_exports__['kc'](Li(g.left,g.right)),y:__dcg_shared_module_exports__['kc'](Li(g.top,g.bottom))};if(a&&yu(c,{row:o+1,column:0},h.x),l){let b=u.index;yu(c,{row:o+1,column:b},h.y)}}}}function PK(r,e){return{left:r.x-e,right:r.x+e,top:r.y+e,bottom:r.y-e}}function Yj(r,e,t){if(t[0]===0&&t[1]===0)return{x:e.x,y:e.y,width:r.width,height:r.height};let i=Math.cos(r.radianAngle),n=Math.sin(r.radianAngle),o=e.x-r.x,s=e.y-r.y;if(t[0]===0)return{x:r.x,y:r.y,width:r.width,height:2*t[1]*(i*s+n*o)};if(t[1]===0)return{x:r.x,y:r.y,width:2*t[0]*(i*o-n*s),height:r.height};var a=2*(r.width*t[0]*(i*o-n*s)+r.height*t[1]*(n*o+i*s))/(r.width*r.width+r.height*r.height);return{x:r.x,y:r.y,width:a*r.width,height:a*r.height}}function Xj(r,e,t){let i=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}],n=["x","y","width","height"],o={x:1/0,y:1/0,width:1/0,height:1/0},s={x:-1/0,y:-1/0,width:-1/0,height:-1/0};for(let a of i){let l=Yj(r,a,t);for(let c of n)o[c]=Math.min(o[c],l[c]),s[c]=Math.max(s[c],l[c])}return{min:o,max:s}}function tx(r){return r===void 0?NaN:r[0]}function Qj(r,e,t,i,n){var se;var o=e.formula;if(!o||((se=o.move_strategy)==null?void 0:se.length)!==4)return!1;var s=o.dimensions,a={x:tx(s.x),y:tx(s.y),width:tx(s.width),height:tx(s.height),radianAngle:tx(s.radianAngle)},l=t.scaleFactor||[0,0],c=l[0]!==0&&l[1]!==0,u=n.closestPointOnScreen(i),p=n.pixelsToMath.mapRect(PK(u,c?.05:.5)),g=Xj(a,p,l),h=n.mathToPixels.mapRect({left:a.x-.5*a.width,right:a.x+.5*a.width,top:a.y-.5*a.height,bottom:a.y+.5*a.height}),b=Math.abs(h.right-h.left),C=Math.abs(h.bottom-h.top),D=n.mathToPixels.mapRect({left:g.min.x-.5*g.min.width,right:g.min.x+.5*g.min.width,top:g.min.y-.5*g.min.height,bottom:g.min.y+.5*g.min.height}),S=Math.abs(D.right-D.left),V=Math.abs(D.bottom-D.top);if(S<b&&S<1||V<C&&V<1)return!1;var k=["width","height","x","y"];let T=!1;for(var A=0;A<k.length;A++){var R=k[A],P=o.move_strategy[A];switch(P.type){case"updateCoordinate":var W=Li(g.min[R],g.max[R]),H=P.inputSpan.input,j=__dcg_shared_module_exports__['kc'](W);switch(R){case"width":case"height":qa(e,R,j);break;case"x":if(o.move_strategy[3].type==="updateCoordinate"){let he=o.move_strategy[3],ye=Li(g.min.y,g.max.y),fe=__dcg_shared_module_exports__['kc'](ye),Se=H.slice(0,P.inputSpan.start)+j+H.slice(P.inputSpan.end,he.inputSpan.start)+fe+H.slice(he.inputSpan.end);qa(e,"center",Se)}else{let he=H.slice(0,P.inputSpan.start)+j+H.slice(P.inputSpan.end);qa(e,"center",he)}break;case"y":if(o.move_strategy[2].type!=="updateCoordinate"){let he=H.slice(0,P.inputSpan.start)+j+H.slice(P.inputSpan.end);qa(e,"center",he)}break;default:return R}T=!0;break;case"updateSlider":var ne=r.getItemModel(P.id);if(!ne||ne.type!=="expression")continue;var le=P.coefficients[0],w=P.coefficients[1],B=w*g.min[R]+le,q=w*g.max[R]+le,M=Li(B,q),ae=ne.latex;tD(ne,M),ne.latex!==ae&&(T=!0);break}}return T}function Zj({controller:r,movedExpr:e,dragMode:t,currentScreenPoint:i,targetScreenPoint:n,projection:o,transform:s,isOnlyPoint:a,keyboardDirection:l}){var b,C;let c=e.formula;if(!c||((b=c.move_strategy)==null?void 0:b.length)!==2)return;let[u,p]=c.move_strategy;if(a&&u.type==="updateCoordinate"&&p.type==="updateCoordinate"){let D=o.reverse_map_pt(n),S=JA(o,D);S&&(n=o.map_pt(S))}let g=a?o.closestPointOnScreen(n):n;if(!l){let D;switch(u.type){case"updateSliderNonlinear":D=TK({controller:r,projection:o,transform:s,strategy:u,targetScreenPoint:g,clampToViewport:a});break;case"updateGliderParameter":case"updateSliderForGlider":D=WA({controller:r,projection:o,transform:s,strategy:u,targetScreenPoint:g});break;default:D=jA({controller:r,projection:o,transform:s,formula:c,moveStrategy:c.move_strategy,dragMode:t,targetScreenPoint:g,clampToViewport:a})}return D&&__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},D),{commitSliderSoftLimits:!1,transform:s,model:e})}let h;if(u.type==="updateSliderNonlinear"){if(!(l!=null&&l.x))return;h=VK({projection:o,transform:s,controller:r,strategy:u,mode:l.x,clampToViewport:a})}else if(u.type==="updateGliderParameter"||u.type==="updateSliderForGlider")h=WA({controller:r,projection:o,transform:s,strategy:u,targetScreenPoint:g});else{let D=l.x?0:1,S=l.x?g.x-i.x:g.y-i.y,V=c.move_strategy[D];if(V.type==="updateSlider"){let k=r.getItemModel(V.id);if((k==null?void 0:k.type)!=="expression")throw new Error(`Programming error: updateSlider move strategy should point to an expression item, but found ${k==null?void 0:k.type}`);let T=Bl(k);if(T){let A=o.mathToPixels.mapPoint({x:0,y:0}),R=V.coefficients[1],P=Math.abs(D===0?o.mathToPixels.mapX(T/R)-A.x:o.mathToPixels.mapY(T/R)-A.y),W=Math.ceil(1/P);S=P*W*(S>0?1:-1);let H=(C=l.x)!=null?C:l.y;(H==="bigup"||H==="bigdown")&&(S*=5)}}h=jA({controller:r,projection:o,transform:s,formula:c,moveStrategy:c.move_strategy,dragMode:t,targetScreenPoint:{x:i.x+(D===0?S:0),y:i.y+(D===1?S:0)},clampToViewport:a})}return h&&__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},h),{commitSliderSoftLimits:!0,transform:s,model:e})}function JA(r,e){if(!r.settings.showGrid)return;let t=Op(r),i=t.minorStepX,n=t.minorStepY,o=r.map_pt(e),s=Math.round(e.x/i)*i,a=Math.round(e.y/n)*n,l=5,c={x:s,y:a},u=r.map_pt(c);if(__dcg_shared_module_exports__['X'](u.x-o.x,u.y-o.y)<=l)return c}function RK(r,e){let t={i:0,x:NaN,y:NaN},i={i:1,x:NaN,y:NaN};if(!r||!e)return[t,i];let n=_K(r.typedRuntimeValue),o=_K(e.typedRuntimeValue);if(!n||!o)return[t,i];let s=FK(n,o);return t.x=s[0],t.y=s[1],s=FK(o,n),i.x=s[0],i.y=s[1],[t,i]}function _K(r){switch(r.valueType){case __dcg_shared_module_exports__['$a']:case __dcg_shared_module_exports__['fb']:case __dcg_shared_module_exports__['hb']:return{type:"straight",def:r.value};case __dcg_shared_module_exports__['pb']:return{type:"straight",def:Rp(r.value)};case __dcg_shared_module_exports__['bb']:return{type:"circle",def:r.value};case __dcg_shared_module_exports__['db']:return{type:"arc",def:r.value}}}function FK(r,e){switch(r.type){case"straight":switch(e.type){case"straight":return __dcg_shared_module_exports__['Ba'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['za'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Da'](r.def,e.def)}case"circle":switch(e.type){case"straight":return __dcg_shared_module_exports__['Aa'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['ya'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Ca'](r.def,e.def)}case"arc":switch(e.type){case"straight":return __dcg_shared_module_exports__['Fa'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Ea'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Ga'](r.def,e.def)}}return[NaN,NaN]}var NK=[{key:"compass",objects:"Segment + Point"},{key:"midpoint",objects:"Segment"},{key:"parallel",objects:"Line + Point"},{key:"perpendicular",objects:"Line + Point"},{key:"image",objects:"2 Points"}];function Bc(r){return __dcg_shared_module_exports__['F'](r)}function Kc(r){this.setState(r)}Kc.prototype.setState=function(r){this.state=r};Kc.prototype.getState=function(){return this.state};Kc.prototype.set=function(r,e){if(arguments.length===1){this.state=r;return}else if(typeof r=="string"){this.state=Bc(this.state),this.state[r]=e;return}var t=r.length-2,i=r[t+1],n;this.state=n=Bc(this.state);for(var o=0;o<=t;o++){var s=r[o];n=n[s]=Bc(n[s])}n[i]=e};Kc.prototype.deepMutate=function(r,e){if(arguments.length===1){e=r,this.state=__dcg_shared_module_exports__['j'](this.state),e(this.state);return}else if(typeof r=="string"){this.state=Bc(this.state),this.state[r]=__dcg_shared_module_exports__['j'](this.state[r]),e(this.state[r]);return}for(var t=r.length-2,i=r[t+1],n=this.state=Bc(this.state),o=0;o<=t;o++){var s=r[o];n=n[s]=Bc(n[s])}n=n[i]=__dcg_shared_module_exports__['j'](n[i]),e(n)};Kc.prototype.shallowMutate=function(r,e){if(arguments.length===1){e=r,this.state=Bc(this.state),e(this.state);return}else if(typeof r=="string"){this.state=Bc(this.state),this.state[r]=Bc(this.state[r]),e(this.state[r]);return}for(var t=r.length-1,i=this.state=Bc(this.state),n=0;n<=t;n++){var o=r[n];i=i[o]=Bc(i[o])}e(i)};Kc.areShallowEqual=function(r,e){};Kc.areDeepEqual=function(r,e){};function Lf(r){return r?!!(eJ(r)&&r!=="Vector"||r==="Circle"||r==="Arc"||r==="Polygon"):!1}function eJ(r){if(!r)return!1;switch(r){case"Line":case"Ray":case"Vector":case"Segment":return!0}return!1}var tJ=!0,rJ=!1,KK="**dcg_geo_tool_output_slider**";function iJ(){return{point:__dcg_shared_module_exports__['S'].PURPLE,line:__dcg_shared_module_exports__['S'].BLUE,circle:__dcg_shared_module_exports__['S'].GREEN,polygon:__dcg_shared_module_exports__['S'].BLUE,angle:__dcg_shared_module_exports__['S'].BLACK}}function nJ(r,e){let t=[],i=r.parents;for(let n=0;n<i.length;n++){let o=i[n];o.type==="hardcoded"?t[n]=o.id:t[n]=e[o.id]}return t}var rx=class{constructor(e){this._nextObjectId=0;this.clear(),this.controller=e,this.s=this.controller.s,this._tools={};for(let t in qA)this._tools[t]=new qA[t](this)}onPreviewChange(){var s;var e=this.controller.getToolPreviewJSONState(),t=this.getUncommittedObjects();if(this.getCurrentTool()instanceof $p&&!this.controller.getValidCursorContext()){t=__dcg_shared_module_exports__['a']({},t);for(let a in e){let l=e[a];l.type==="expression-edit-preview-latex"&&(t[a]=l)}}for(var n in t){var o=t[n];o.type==="polygon"&&this.isObjectHovered(o.parents[0])&&o.parents.push(o.parents[0])}__dcg_shared_module_exports__['G'](e,t)?this.controller.dispatch({type:"render"}):this.controller.dispatch({type:"set-tool-preview-state",state:t}),(s=this.controller.get2dPOIController())==null||s.updateGeoHoveredObjects()}peekNextObjectId(){return"\\token{"+this._nextObjectId.toString()+"}"}generateObjectId(){let e=this.peekNextObjectId();return this._nextObjectId+=1,e}updateNextObjectId(e){e>this._nextObjectId&&(this._nextObjectId=e)}clear(){let e={objects:{},ui:{currentTool:{name:"selection",idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:{}},colors:iJ()},hoveredObjects:[],uncommittedIds:{},selectedIds:{},nextSelectionNumber:1,fadeAnimations:{},maxAnimationEndTime:0};this.store?this.store.set(e):this.store=new Kc(e)}onMouseAction(e,t){e==="release"&&this.controller.clearRecentlyUsedComplexTool();let i=this.getCurrentTool();if(i instanceof $p&&!this.controller.getValidCursorContext())return{committed:void 0,handled:!1};if(i.getNumberInputLatex())return{committed:void 0,handled:!1};switch(this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.clearHoveredObjects(),e){case"move":return{committed:void 0,handled:i.onMove(t)};case"release":i.onMove(t);let n=i.tryCommitResults();return n.committed?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{handled:!0}):{committed:void 0,handled:!1}}}getNonObjectsState(){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.store.getState()),{objects:void 0})}getCurrentTool(){return this.getTool(this.getToolMode())}getTool(e){return this._tools[e]}defaultColorForObject(e,t){switch(t.type){case"point":case"point-reference":case"midpoint":case"glider":case"intersection":return e.colors.point;case"line":case"segment":case"polygon-segment":case"ray":case"vector":case"perpendicular":case"parallel":return e.colors.line;case"circle":case"compass":case"arc":return e.colors.circle;case"polygon":return e.colors.polygon;case"angle":case"angles":case"directedangle":case"directedangles":return e.colors.angle;case"dilate":case"translate":case"reflect":case"rotate":return __dcg_shared_module_exports__['S'].GRAY;case"transformed-object":case"slider":return __dcg_shared_module_exports__['S'].BLACK;case"expression-edit-preview-latex":return t.color||__dcg_shared_module_exports__['S'].BLACK;default:return t}}_deselectAll(){this.store.shallowMutate(e=>{e.nextSelectionNumber=1,e.selectedIds={}})}_modifySelection(e){let t=this.getNonObjectsState().nextSelectionNumber;this.store.shallowMutate("selectedIds",i=>{for(let n in e)e[n]?i[n]||(i[n]=t,t+=1):delete i[n]}),this.store.set("nextSelectionNumber",t)}_addObjects(e){this.store.shallowMutate("objects",t=>{for(let i of e)t[i.id]=i})}_deleteObjects(e){if(!e.length)return;let t={};this.store.shallowMutate("objects",i=>{for(let n of e)t[n]=rJ,delete i[n]}),this._modifySelection(t),this.store.shallowMutate("uncommittedIds",i=>{for(let n of e)delete i[n]})}createCustomToolOutput(e){this.generateIdsForNewToolOutputs(e);let{idMap:t}=this.getNonObjectsState().ui.currentTool,i=[],n=this.getNonObjectsState().ui;for(let o of e.outputs){let s=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{id:t[o.id],color:this.defaultColorForObject(n,o),parents:nJ(o,t)});i.push(s)}for(let o of e.inputs)if(o.type==="number"&&o.sliderInfo){let s=t[o.id];if(ga(s)){let a=d_(s);if(a&&a in __dcg_shared_module_exports__['Nb'])continue;this.controller.getItemsByIdentifier(__dcg_shared_module_exports__['Kb'](s)).length||i.push({type:"slider",latex:s+"="+o.sliderInfo.value,sliderInfo:o.sliderInfo,id:KK,parents:[],hidden:!1,color:"#000"})}}this._shouldNewObjectsBeMarkedUncommitted()&&this.store.shallowMutate("uncommittedIds",o=>{for(let s of i)o[s.id]=!0}),this._addObjects(i)}_getReusableIdForCurrentInput(e){let t=this.getCurrentTool();if(!t.getSpec)return;let{inputIndex:i,reusableInputIdMap:n}=this.getNonObjectsState().ui.currentTool,s=t.getSpec().inputs[i];if(!s)return;let a=s.id;return e!==void 0&&(a+="-"+e),n[a]}_createInputObject(e,t){let i,n=this._shouldNewObjectsBeMarkedUncommitted();n?i=this._getReusableIdForCurrentInput(t)||this.generateObjectId():i=this.generateObjectId(),n&&this.store.set(["uncommittedIds",i],!0);let o=this.defaultColorForObject(this.getNonObjectsState().ui,e),s=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({hidden:e.type==="point"&&!!e.previewOnly},e),{id:i,color:o});return this._addObjects([s]),i}attemptLockToolInputIn(e){let{currentTool:t}=this.getNonObjectsState().ui,i=t.inputIndex,n=e.inputs[i];if(!n)return;let o=n.id,s=t.idMap[o],a=s&&this.store.getState().objects[s];if(!s){this.getCurrentTool().canNextInputBePoint()||this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}if(a&&a.type==="point"&&a.previewOnly){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}this.store.set(["ui","currentTool","inputIndex"],i+1),this.store.set(["ui","currentTool","lockedIds",s],!0);for(var l=0;l<2;l++){let c=o+"-"+l,u=t.idMap[c];u&&this.store.set(["ui","currentTool","lockedIds",u],!0)}this.maybeFillInDefaultNumberInput(e),this.updateFadeAnimations()}maybeFillInDefaultNumberInput(e){let{currentTool:t}=this.getNonObjectsState().ui,i=t.inputIndex,n=e.inputs[i];n&&n.type==="number"&&n.defaultLatex&&!t.idMap[n.id]&&this.getCurrentTool().onNumberInput(n.defaultLatex)}generateIdsForNewToolOutputs(e){let{idMap:t}=this.getNonObjectsState().ui.currentTool,i=!1,n={};for(let o of e.outputs)t[o.id]||(i=!0,n[o.id]=this.generateObjectId());i&&this.store.set(["ui","currentTool","idMap"],__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),n))}tentativelyMatchToolInput(e,t){let{currentTool:i}=this.getNonObjectsState().ui,n=i.inputIndex,o=e.inputs[n];if(!o)return;let s=o.id;this.store.set(["ui","currentTool","idMap",s],t)}createToolInputDependency(e,t,i){let n=this._createInputObject(e,i),{currentTool:o}=this.getNonObjectsState().ui,s=o.inputIndex,a=t.inputs[s];if(!a)throw new Error("programming error: could not find input "+s+" in spec");let l=a.id;return this.store.set(["ui","currentTool","idMap",l+"-"+i],n),n}isObjectALockedToolInput(e){return!!this.getNonObjectsState().ui.currentTool.lockedIds[e]}getEnabledAdditionalTools(){return NK.filter(e=>!0)}getAdditionalTools(){return this.getEnabledAdditionalTools()}isAnyAdditionalToolEnabled(){return this.getAdditionalTools().length>0}setObjectSelected(e){let t={};t[e]=tJ,this._modifySelection(t)}setObjectsSelected(e){__dcg_shared_module_exports__['l'](e,t=>{this.setObjectSelected(t)})}deleteSelectedObjects(){let e=this.getSelectedObjectIdsUnsorted();this._deleteObjects(e)}isObjectHovered(e){let t=this.getNonObjectsState().hoveredObjects;for(let i of t)if("calcId"in i&&i.calcId===e)return!0;return!1}isObjectUncommitted(e){return!!this.getNonObjectsState().uncommittedIds[e]}getUncommittedObjectIds(){return Object.keys(this.getNonObjectsState().uncommittedIds)}getUncommittedObjects(){let e={},t=this.store.getState().objects,i=this.getUncommittedObjectIds();for(let n of i)e[n]=t[n];return e}isValidNextInputType(e){let t=this.getCurrentTool(),i=t.getNonPointInputType();return e&&__dcg_shared_module_exports__['vb'](e)&&(e=__dcg_shared_module_exports__['wb'](e)),!!(i&&e&&dE(e,i)||t.canNextInputBePoint()&&e&&dE(e,"point"))}recordCommittedOutput(e){this.store.shallowMutate(["ui","currentTool","outputHistory"],t=>{t[e]=!0})}updateFadeAnimations(){let e=this.controller.getAllItemModels(),t=Date.now(),i=-1/0;this.store.shallowMutate(["fadeAnimations"],n=>{var a,l;if(this.getCurrentTool().shouldHighlightRelevantObjects())for(let c of e){if(c.type!=="expression"||!c.latex)continue;let u=c.id,p=(a=c.formula)==null?void 0:a.geometry,g;p!=null&&p.unconstructable?g="fade-out":this.isValidNextInputType(__dcg_shared_module_exports__['Ra'])&&Lf(cA(p==null?void 0:p.valueType))||p!=null&&p.valueType&&__dcg_shared_module_exports__['zb'](p.valueType,__dcg_shared_module_exports__['Za'])&&this.isValidNextInputType(__dcg_shared_module_exports__['$a'])||this.isValidNextInputType(p==null?void 0:p.valueType)||this.store.getState().ui.currentTool.outputHistory[u]?g="fade-in":g="fade-out";let h=this.store.getState().fadeAnimations[u];if(h&&h.type!==g){let b=__dcg_shared_module_exports__['ma'](t-h.start,0,150),C=t+b-150;n[u]={type:g,start:C},i=Math.max(i,C)}else if(g==="fade-out"){let b=(l=h==null?void 0:h.start)!=null?l:t;n[u]={type:"fade-out",start:b},i=Math.max(i,b)}}else{for(let c in n)n[c]={type:"fade-in",start:t-150};i=t-150}}),isFinite(i)&&this.store.set("maxAnimationEndTime",i+150)}getToolFadeOpacity(e){let t=this.controller.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return 1;let i=this.store.getState().fadeAnimations[t.id];if(!i)return 1;let n=Date.now(),o=__dcg_shared_module_exports__['ma']((n-i.start)/150,0,1),s=i.type==="fade-in"?.2:1,a=i.type==="fade-in"?1:.2;return s*(1-o)+a*o}isFading(){return Date.now()<=this.store.getState().maxAnimationEndTime}isObjectSelected(e){return!!this.getNonObjectsState().selectedIds[e]}getSelectedObjectIdsUnsorted(){return Object.keys(this.getNonObjectsState().selectedIds)}getSelectedObjectIdsSorted(){let e=this.getNonObjectsState().selectedIds,t=this.getSelectedObjectIdsUnsorted();return __dcg_shared_module_exports__['v'](t,n=>e[n])}deselectAllObjects(){this._deselectAll()}getToolMode(){return this.getNonObjectsState().ui.currentTool.name}setToolMode(e){let t=this.getToolMode();this.store.set(["ui","currentTool"],{name:e,idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:e!==t?{}:this.store.getState().ui.currentTool.outputHistory}),this.updateFadeAnimations(),e!==t&&this.controller.isGraphPaperFocused()&&(Ht(this.getCurrentToolDisplayName()+"."),this.speakCurrentGeoToolHint())}resetToolMode(){this.setToolMode(this.getToolMode())}areAnyObjectsHovered(){return!!this.getNonObjectsState().hoveredObjects.length}setObjectHovered(e){this.store.deepMutate(t=>{t.hoveredObjects.push(e)})}objectIsInstanceOf(e,t){let i=e==null?void 0:e.typedRuntimeValue.valueType;if(i)return dE(i,t)}getSelectionBox(){return this.getTool("selection").getSelectionBox()}commitObjects(){this.store.set("uncommittedIds",{}),this.store.set("objects",{})}applyTransformation(e){}getProjection(){return this.controller.get2dProjection()}_getPixelsAwayFromDef(e,t,i){let n=i.typedRuntimeValue;switch(n.valueType){case __dcg_shared_module_exports__['Ra']:{let s=t.mapx(n.value[0]),a=t.mapy(n.value[1]);return __dcg_shared_module_exports__['X'](e.x-s,e.y-a)-6}case __dcg_shared_module_exports__['fb']:case __dcg_shared_module_exports__['$a']:case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['pb']:{let o,s,a,l;if(n.valueType===__dcg_shared_module_exports__['pb']){let[[g,h],[b,C]]=Rp(n.value);o=t.mapx(g),a=t.mapy(h),s=t.mapx(b),l=t.mapy(C)}else o=t.mapx(n.value[0][0]),a=t.mapy(n.value[0][1]),s=t.mapx(n.value[1][0]),l=t.mapy(n.value[1][1]);let c=n.valueType===__dcg_shared_module_exports__['fb'],u=n.valueType===__dcg_shared_module_exports__['fb']||n.valueType===__dcg_shared_module_exports__['hb'],p=__dcg_shared_module_exports__['$'](e.x,e.y,o,a,s,l,c,u);return p?__dcg_shared_module_exports__['X'](p[0]-e.x,p[1]-e.y):1/0}case __dcg_shared_module_exports__['bb']:{let o=n.value[0][0],s=n.value[0][1],a=n.value[1],l=0,c=Math.PI*2,u=t.reverse_mapx(e.x),p=t.reverse_mapy(e.y),g=__dcg_shared_module_exports__['aa'](u,p,o,s,a,l,c);return g?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['X'](g[0]-u,g[1]-p):1/0}case __dcg_shared_module_exports__['db']:{let o=__dcg_shared_module_exports__['xa'](n.value);if(!o)return 1/0;let s=(a,l,c,u)=>{let p=t.mapx(a[0]),g=t.mapy(a[1]),h=t.mapx(l[0]),b=t.mapy(l[1]),C=__dcg_shared_module_exports__['$'](e.x,e.y,p,g,h,b,c,u);return C?__dcg_shared_module_exports__['X'](C[0]-e.x,C[1]-e.y):1/0};if(o.type==="arc"){let a=t.reverse_mapx(e.x),l=t.reverse_mapy(e.y),c=__dcg_shared_module_exports__['aa'](a,l,o.center[0],o.center[1],o.radius,o.startAngle,o.endAngle);return c?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['X'](c[0]-a,c[1]-l):1/0}else return o.type==="segment"?s(o.start,o.end,!1,!1):Math.min(s(o.start1,o.end1,!1,!0),s(o.start2,o.end2,!1,!0))}case __dcg_shared_module_exports__['Za']:{let o=[];return n.value.forEach(s=>{o.push(t.mapx(s[0]),t.mapy(s[1]))}),__dcg_shared_module_exports__['ja'](o,[e.x,e.y])?0:1/0}case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['lb']:{let o=t.screen.width/(t.viewport.xmax-t.viewport.xmin),s=t.screen.height/(t.viewport.ymax-t.viewport.ymin),[[a,l],c,u]=n.value,p=df(u,t),g=p/o,h=t.reverse_mapx(e.x),b=t.reverse_mapy(e.y),C=1/0,D=b-l,S=h-a,V=Math.atan2(D,S);if(__dcg_shared_module_exports__['W'](V,c,u))__dcg_shared_module_exports__['X'](D*s,S*o)<=p+7&&(C=0);else{let k=__dcg_shared_module_exports__['_'](h,b,a+g*Math.cos(c),l+g*Math.sin(c),a,l),T=__dcg_shared_module_exports__['_'](h,b,a+g*Math.cos(c+u),l+g*Math.sin(c+u),a,l),A=__dcg_shared_module_exports__['X'](o*(k[0]-h),s*(k[1]-b)),R=__dcg_shared_module_exports__['X'](o*(T[0]-h),s*(T[1]-b));C=Math.min(A,R)}return C}case __dcg_shared_module_exports__['nb']:return 1/0;default:return 1/0}}getAllChoosableDefsUnordered(e){var g;if(!this.controller.isGeometry())return[];let t=[],i=e.mode==="tab",n=e.mode==="mouse",o=i&&this.controller.getActiveTool()==="box-selection",s=!1,a=!1,l=this.getCurrentTool();(g=l.isValidNextInputType)!=null&&g.call(l,__dcg_shared_module_exports__['Ra'])&&(s=!0),l.shouldUseJitEdges()&&(l.isValidNextInputType(__dcg_shared_module_exports__['$a'])||l.isValidNextInputType(__dcg_shared_module_exports__['fb'])||l.isValidNextInputType(__dcg_shared_module_exports__['hb']))&&(a=!0);let c=n&&s;c&&(a=!0);let{lockedIds:u,reusableInputIdMap:p}=this.store.getState().ui.currentTool;return ng({controller:this.controller,expandLists:!this.controller.isGeometry()||l.shouldExpandLists()},(h,b)=>{var D,S;if(!h.isGraphable)return;let C=h.assignment;for(let V in p)if(p[V]===C&&!u[C])return;if(!h.hidden&&!h.data.unconstructable&&!(this.getToolMode()==="expression-edit"&&((D=h.data)!=null&&D.depends_on_selected))&&!(o&&this.controller.isClickableId(h.calcId))&&!(i&&this.isObjectALockedToolInput(h==null?void 0:h.assignment))&&!(i&&b)){if(a&&h.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Za']){let V=h;if(V.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Za']){let k=V.typedRuntimeValue.value;for(let T=0;T<k.length;T++){let A=k[T],R=k[(T+1)%k.length],P=V.referenceLatex+".\\operatorname{segments}\\left["+(T+1)+"\\right]",W={calcId:V.calcId,listIndex:V.listIndex,hidden:V.hidden,assignment:P,referenceLatex:P,data:V.data,typedRuntimeValue:{valueType:__dcg_shared_module_exports__['$a'],value:[A,R]},polygonEdgeInfo:{edgeNumber:T,polygonDef:V}};t.push(W)}}}if(c&&!__dcg_shared_module_exports__['zb'](h.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Za'])){t.push(h);return}if((S=l.isValidNextInputType)!=null&&S.call(l,h.typedRuntimeValue.valueType)){t.push(h);return}}}),t}_getObjectsUnderMouse(e,t){let i=this.getAllChoosableDefsUnordered({mode:"mouse"}),n=this.getProjection(),o=[];i.forEach(l=>{let c=this._getPixelsAwayFromDef(e,n,l),u=l.polygonEdgeInfo?-1:0;if(c<=t){let p={def:l,layerNumber:u,pixelsAway:c};o.push(p)}});let s=this.controller.get2dSketchOrder(),a={};for(let l=0;l<s.length;l++)a[s[l]]=l;return o.sort((l,c)=>{let u=c.layerNumber-l.layerNumber;if(u!==0)return u;let p=l.pixelsAway-c.pixelsAway;if(p!==0)return p;let g=a[l.def.calcId];return a[c.def.calcId]-g}),o}convertCanvasPixelsToPoint(e){return this.getProjection().reverse_map_pt(e)}convertPointToCanvasPixels(e){return this.getProjection().map_pt(e)}deleteObjectsAndRememberReusableId(e){for(let t in e)this._deleteObjects([e[t]]);this._deleteObjects([KK]),this.store.shallowMutate(["ui","currentTool"],t=>t.reusableInputIdMap=e)}getObjectDefUnderMouse(e,t){let i=this.convertPointToCanvasPixels(e),n=this._getObjectsUnderMouse(i,t)[0];return n&&n.def}getOrCreatePointNearMouse(e,t){let i=this.convertPointToCanvasPixels(e),n=this._getObjectsUnderMouse(i,t),o=[];for(let g of n){let h=g.def,b=zB(h);b==="Point"?o.push({def:h,type:b}):Lf(b)&&o.push({def:h,type:b})}let{def:s,type:a}=o[0]||{},{def:l,type:c}=o[1]||{},u=this.controller.isGeoToolEnabled("point");if(a==="Point")return{type:"def",def:s};if(Lf(a)&&Lf(c)){let g=RK(s,l).map(h=>({x:h.x,y:h.y,i:h.i,pixelsFromPoint:sJ(this.getProjection(),tg(h.x-e.x,h.y-e.y))}));if(g.sort((h,b)=>h.pixelsFromPoint-b.pixelsFromPoint),g=g.filter(h=>h.pixelsFromPoint<5),g[0]){let h=g[0].i===0?[s,l]:[l,s],b=this.findIncidentPointDef(s,l);if(b!=null&&b.hidden){let C=!1,D;if(aA(b.typedRuntimeValue,(S,V)=>{let[k,T]=S.value,A=this.getProjection().mathToPixels.mapPoint({x:k,y:T});tg(A.x-i.x,A.y-i.y)<t&&(C=!0,D=V)}),C)return D!==void 0&&(b=lA(b,D)),{type:"spec",spec:{type:"point-reference",targetSpec:{type:"intersection",parentDefs:h},parentDefs:[b]}}}return{type:"spec",spec:{type:"intersection",parentDefs:h}}}else if(u)return UK(this.getProjection(),e,s)}else if(u&&Lf(a))return UK(this.getProjection(),e,s);let p=oJ(this.getProjection(),e);return{type:"spec",spec:{type:"point",x:p.x,y:p.y,parentDefs:[],previewOnly:!u}}}findIncidentPointDef(e,t){let i=e.typedRuntimeValue.valueType,n=t.typedRuntimeValue.valueType,o={};ng({controller:this.controller,expandLists:!1},a=>{if(a.data.identifier&&__dcg_shared_module_exports__['zb'](a.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Ra'])){let l=a.data.identifier;o[l]=a}});let s=__dcg_shared_module_exports__['hc']({getGeometryTree:a=>a.data.call,isPointOrListOfPoints:a=>__dcg_shared_module_exports__['zb'](a.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Ra']),lookup:a=>o[a],resolvesTo:(a,l)=>a===l.data.identifier},e,i,t,n);if(s){let[a,l]=s,c=o[a];return l===void 0?c:lA(c,l)}}_shouldNewObjectsBeMarkedUncommitted(){return this.getToolMode()!=="selection"}clearHoveredObjects(){this.store.set("hoveredObjects",[])}getHoveredItems(){return this.store.getState().hoveredObjects}cancelToolplay(){this._deleteObjects(this.getUncommittedObjectIds()),this.clearHoveredObjects(),this.resetToolMode()}isToolplayActive(){return this.getNonObjectsState().ui.currentTool.inputIndex>0}getComputedBoard(){let e=new Zw;return ng({controller:this.controller},(t,i)=>{e.add(t,i)}),e}findDefsForInputId(e){let t=[];return ng({controller:this.controller},i=>{(i.assignment===e||i.referenceLatex===e)&&t.push(i)}),t}isCreatingNewTransform(){return this.getCurrentTool().toolType==="transformation"}getCurrentToolDisplayName(){return this.controller.s(this.getCurrentTool().displayName)}isCurrentToolComplex(){return this.getCurrentTool().toolType==="complex"}isCurrentToolSingleUse(){return this.getCurrentTool().toolType==="transformation"}getIconInstructionsForTool(e){let t=this.getTool(e);return t?t.icon:[]}getDisplayNameForTool(e){let t=this.getTool(e);return t?this.controller.s(t.displayName):""}speakCurrentGeoToolHint(){xe(this.getCurrentTool().getHint())}};function oJ(r,e){var t=JA(r,e);t&&(e=t);var i=.5/HK(r);return{x:Li(e.x-i,e.x+i),y:Li(e.y-i,e.y+i)}}function HK(r){return r.mapx(1)-r.mapx(0)}function sJ(r,e){return HK(r)*e-6}function UK(r,e,t){var i=UE(r,e,t.typedRuntimeValue);return{type:"spec",spec:{type:"glider",t:i,parentDefs:[t]}}}function aJ(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var lJ="ID_",Fd=function(){function r(){aJ(this,r),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return r.prototype.register=function(t){var i=lJ+this._lastID++;return this._callbacks[i]=t,i},r.prototype.unregister=function(t){this._callbacks[t]||ix(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t),delete this._callbacks[t]},r.prototype.waitFor=function(t){this._isDispatching||ix(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var i=0;i<t.length;i++){var n=t[i];if(this._isPending[n]){this._isHandled[n]||ix(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n);continue}this._callbacks[n]||ix(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this._invokeCallback(n)}},r.prototype.dispatch=function(t){this._isDispatching&&ix(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(t);try{for(var i in this._callbacks)this._isPending[i]||this._invokeCallback(i)}finally{this._stopDispatching()}},r.prototype.isDispatching=function(){return this._isDispatching},r.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},r.prototype._startDispatching=function(t){for(var i in this._callbacks)this._isPending[i]=!1,this._isHandled[i]=!1;this._pendingPayload=t,this._isDispatching=!0},r.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},r}();function ix(r,e,t,i,n,o,s,a){if(e===void 0)throw new Error("invariant requires an error message argument");if(!r){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[t,i,n,o,s,a],u=0;l=new Error(e.replace(/%s/g,function(){return c[u++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}var Au=class{constructor(e=100){this.clear(),this._sizeLimit=e}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function e(t){try{return JSON.stringify(t,null,2)}catch(i){return"[[could not jsonify]]"}}return{currentState:e(this._stack[this._stackPointer]),undoState:e(this._stack[this._stackPointer-1]),redoState:e(this._stack[this._stackPointer+1])}}addState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(e),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(e)}replaceInteriorState(e){this._stack.length===0?(this._stack.push(e),this._stackPointer=0):this._stack[this._stackPointer]=e}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};function cJ(r){typeof r.min=="number"&&(r.min=""+r.min),typeof r.max=="number"&&(r.max=""+r.max),typeof r.step=="number"&&(r.step=""+r.step)}function dJ(r){r.slider&&cJ(r.slider),typeof r.id!="string"&&(r.id=""+r.id)}function uJ(r){let e=pJ(r)+1,t={},i,n;for(let o of r)if(dJ(o),o.type==="folder")i=o.id,t[o.id]&&(o.id=""+e,e+=1),n=o.id,t[o.id]=!0,o.hasOwnProperty("folderId")&&delete o.folderId;else{if(i!==void 0&&o.folderId===i?o.folderId=n:(o.folderId&&(o.folderId=""),i=void 0,n=void 0),o.type==="table"&&Array.isArray(o.columns))for(let s of o.columns)t[s.id]&&(s.id=""+e,e+=1),t[s.id]=!0;t[o.id]&&(o.id=""+e,e+=1),t[o.id]=!0}}function qK(r,e){let t=parseFloat(e);return t!==Math.floor(t)?r:Math.max(r,t)}function pJ(r){let e=0;for(let t of r)if(e=qK(e,t.id),t.type==="table"&&Array.isArray(t.column))for(let i of t.columns)qK(e,i.id);return e}function HE(r){let e=__dcg_shared_module_exports__['j'](r);return Array.isArray(e.expressions.list)&&uJ(e.expressions.list),e}var YA={NONE:"NONE",POSITIVE:"POSITIVE",BOTH:"BOTH"},hJ={expression:!0,table:!0,image:!0,folder:!0,text:!0};function gJ(r){if(r.type){if(hJ.hasOwnProperty(r.type))return r.type;throw new Error("Invalid item type: '"+r.type+"'.")}return r.text!==void 0?"text":r.columns!==void 0||r.headings!==void 0?"table":"expression"}function qE(r){return r.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function mJ(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=qE(r[t]):t==="values"?e[t]=r[t].map(qE):e[t]=r[t]);return e}function fJ(r){var e=gJ(r),t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="latex"?t[i]=qE(r[i]):t[i]=r[i]);return t.type=e,t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(mJ):t[i]=r[i]);return t.type=e,t;case"image":for(i in r)r.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?t[i]=qE(r[i]):t[i]=r[i]);return t.type=e,t;case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t.type=e,t}}var zK={none:YA.NONE,both:YA.BOTH,positive:YA.POSITIVE};function yJ(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="xAxisArrows"||t==="yAxisArrows"||(e[t]=r[t]));return e.xAxisArrowMode=zK[r.xAxisArrows||"none"],e.yAxisArrowMode=zK[r.yAxisArrows||"none"],e}function $K(r){if(r.version)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=yJ(r.graph),e.expressions={list:r.expressions.list.map(fJ)},e.version=0,e}var bJ=1;function zE(r){return r.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function wJ(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=zE(r[t]):t==="values"?e[t]=r[t].map(zE):e[t]=r[t]);return e}function xJ(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="latex"?t[i]=zE(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(wJ):t[i]=r[i]);return t;case"image":for(i in r)r.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?t[i]=zE(r[i]):t[i]=r[i]);return t;case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function WK(r){if(r.version)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(xJ)},e.version=bJ,e}var vJ=2,CJ="#C0504D",DJ="#4F81BD",SJ="#9BBB59",EJ="#8064A2",kJ="#F79646",GJ="#000000";function jK(r){switch(r){case CJ:return __dcg_shared_module_exports__['S'].RED;case DJ:return __dcg_shared_module_exports__['S'].BLUE;case SJ:return __dcg_shared_module_exports__['S'].GREEN;case EJ:return __dcg_shared_module_exports__['S'].PURPLE;case kJ:return __dcg_shared_module_exports__['S'].ORANGE;case GJ:return __dcg_shared_module_exports__['S'].BLACK;default:return r}}function IJ(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="color"?e[t]=jK(r[t]):e[t]=r[t]);return e}function VJ(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="color"?t[i]=jK(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(IJ):t[i]=r[i]);return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function JK(r){if(r.version>1)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(VJ)},e.version=vJ,e}var TJ=3;function XA(r){if(typeof r=="string")return r;if(r===void 0)return"";var e=r+"";return e=e.replace(/1e\+?([-\d]+)/,"10^{$1}"),e=e.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),e}function MJ(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="sliderMax"||i==="sliderMin"||i==="sliderInterval"?t[i]=XA(r[i]):i==="domain"?t[i]={max:XA(r[i].max),min:XA(r[i].min)}:t[i]=r[i]);return t.hasOwnProperty("sliderMin")&&t.sliderInterval===void 0&&(t.sliderInterval=""),t;case"image":case"table":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function YK(r){if(r.version>2)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(MJ)},e.version=TJ,e}var AJ=4;function XK(r){switch(r){case"point":return"POINT";case"cross":return"CROSS";case"open":return"OPEN";case"normal":return"SOLID";case"dashed":return"DASHED";case"dotted":return"DOTTED";default:return r}}function LJ(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="style"?e[t]=XK(r[t]):e[t]=r[t]);return e}function OJ(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="style"?t[i]=XK(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(LJ):t[i]=r[i]);return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function QK(r){if(r.version!==3)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(OJ)},e.version=AJ,e}function PJ(r){var e={},t;for(var i in r)if(r.hasOwnProperty(i))switch(t=r[i],i){case"showAxes":e.showXAxis=t,e.showYAxis=t;break;case"showLabels":e.xAxisNumbers=t,e.yAxisNumbers=t,e.polarNumbers=t;break;case"labelXMode":e.xAxisStep=t==="pi"?Math.PI:0;break;case"labelYMode":e.yAxisStep=t==="pi"?Math.PI:0;break;default:e[i]=t}return e}function _J(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="showPoints"||t==="showLine"||(e[t]=r[t]));return(r.showPoints!==void 0||r.showLine!==void 0)&&(r.showPoints&&r.showLine?e.columnMode="POINTS_AND_LINES":r.showPoints?e.columnMode="POINTS":r.showLine?e.columnMode="LINES":(e.hidden=!0,e.columnMode="POINTS")),e}function FJ(r){var e=r.type,t={},i;switch(e){case"expression":r.hidden===void 0?r.hasOwnProperty("graphed")?t.hidden=!r.graphed:r.hasOwnProperty("userRequestedGraphing")?t.hidden=r.userRequestedGraphing==="never":t.hidden=!1:t.hidden=r.hidden;for(i in r)if(r.hasOwnProperty(i)&&!(i==="graphed"||i==="userRequestedGraphing"||i==="hidden")&&i!=="slider"){if(i==="color"){typeof r.color=="object"?t.color=r.color.value:t.color=r.color;continue}if(i==="style"){t.style=r.style==="normal"?"SOLID":r.style;continue}if(i==="sliderInterval"){t.sliderInterval=r.sliderInterval==="undefined"?"":r.sliderInterval;continue}t[i]=r[i]}return t;case"table":if(r.headings||r.columns){var n=r.headings?r.headings:r.columns;if(t.columns=n.map(_J),r.rows)for(var o=0;o<t.columns.length;o++){var s=t.columns[o];s.values=[];for(var a=0;a<r.rows.length;a++)s.values.push(r.rows[a][o])}}for(i in r)r.hasOwnProperty(i)&&(i==="rows"||i==="headings"||i==="columns"||(t[i]=r[i]));return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function ZK(r){if(r.version!==4)throw new Error("Unexpected version: "+r.version);var e={version:5,graph:PJ(r.graph),expressions:{list:r.expressions.list.map(FJ)}};return e}var RJ=6;function NJ(r){return r.length<2?!1:r[0]==="`"&&r[r.length-1]==="`"}function BJ(r){if(NJ(r))return{raw:r,parts:[r]};for(var e=["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"],t="({"+e.join("})|({")+"})",i=new RegExp(t,"g"),n=[],o=0,s=0,a;a=i.exec(r);){s=a.index,s>o&&n.push(r.substr(o,s-o));var l=a[0],c=l.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");n.push({symbol:c,str:l}),o=a.index+l.length}return o<r.length&&n.push(r.substr(o)),{raw:r,parts:n}}function KJ(r){var e={};for(var t in r)if(r.hasOwnProperty(t)&&t!=="style")if(t==="values"&&(e[t]=r[t].map(function(i){return i?""+i:""})),t==="columnMode"&&!r.hasOwnProperty("points")&&!r.hasOwnProperty("lines"))switch(r[t]){case"LINES":e.points=!1,e.lines=!0;break;case"POINTS_AND_LINES":e.points=!0,e.lines=!0;break;default:e.points=!0,e.lines=!1}else e[t]=r[t];return e.hasOwnProperty("pointStyle")||(e.pointStyle="POINT"),e.hasOwnProperty("lineStyle")||(e.lineStyle="SOLID"),e.id=""+e.id,e}var eU={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};function UJ(r){var e=BJ(r),t="";return __dcg_shared_module_exports__['l'](e.parts,function(i){t+=typeof i=="object"&&i.str?"$"+i.str:i}),t}function HJ(r,e){var t=r.latex.split("=");if(t.length===2){var i=Si(t[1],e);if(isFinite(i)){var n=r.slider.hardMin?Si(r.slider.min||"-10",e):void 0,o=r.slider.hardMax?Si(r.slider.max||"10",e):void 0,s=r.slider.step?Si(r.slider.step,e):void 0,a=__dcg_shared_module_exports__['Rb']({target:i,step:s,hardMin:n,hardMax:o});a.min||(delete r.slider.hardMin,delete r.slider.min),a.max||(delete r.slider.hardMax,delete r.slider.max),a.step||delete r.slider.step}}}function qJ(r,e,t,i){var n=r.type,o={},s;switch(n){case"folder":for(s in r)r.hasOwnProperty(s)&&(s==="memberIds"||(o[s]=r[s]));break;case"expression":for(s in r)if(r.hasOwnProperty(s)){if(s==="style"&&!r.hasOwnProperty("pointStyle")&&!r.hasOwnProperty("lineStyle")){var a=r[s];__dcg_shared_module_exports__['q'](["POINT","OPEN","CROSS"],a)?(o.pointStyle=a,o.lineStyle="SOLID"):__dcg_shared_module_exports__['q'](["SOLID","DASHED","DOTTED"],a)?(o.pointStyle="POINT",o.lineStyle=a):(o.pointStyle="POINT",o.lineStyle="SOLID");continue}eU.hasOwnProperty(s)?(o.slider=o.slider||{},o.slider[eU[s]]=r[s]):o[s]=r[s],r.label&&(o.label=UJ(r.label))}o.latex&&o.slider&&!o.slider.isPlaying&&HJ(o,i),o.hasOwnProperty("fillOpacity")||(o.fillOpacity=.4),o.label===!1&&(o.label=""),o.labelSize||(o.labelSize="medium"),o.labelOrientation||(o.labelOrientation="default"),o.verticalLabel||(o.verticalLabel=!1),o.interactiveLabel||(o.interactiveLabel=!1);break;case"image":for(s in r)!r.hasOwnProperty(s)||s==="x"||s==="y"||(o[s]=r[s]);o.center="\\left("+(r.x||"0")+","+(r.y||"0")+"\\right)",o.angle=r.angle||"0",o.foreground=!!o.foreground;break;case"text":for(s in r)r.hasOwnProperty(s)&&(o[s]=r[s]);break;case"table":for(s in r)r.hasOwnProperty(s)&&(s==="columns"?o[s]=r[s].map(KJ):o[s]=r[s]);break;default:throw new Error("Unexpected expression type: "+n)}if(o.id=""+o.id,r.type==="folder")e.folderId=o.id,e.memberIds=r.memberIds,o.folderId="";else{var l=t[o.id];e.memberIds&&e.memberIds[l]?o.folderId=e.folderId:(o.folderId="",e.folderId=void 0,e.memberIds=void 0)}return o}function zJ(r){for(var e=0,t=/^[0-9]+$/,i=r.length-1;i>=0;i--){var n=r[i],o=n.id,s;if(t.test(o)&&(s=parseInt(o,10),s>e&&(e=s)),n.type==="table"&&n.columns)for(var a=n.columns.length-1;a>=0;a--)o=n.columns[a].id,t.test(o)&&(s=parseInt(o,10),s>e&&(e=s))}return e+1}function tU(r){if(r.version!==5)throw new Error("Unexpected version: "+r.version);var e=!!(r.graph&&r.graph.degreeMode),t=r.expressions.list,i=-1,n={},o={},s={};return{version:RJ,graph:r.graph,expressions:{list:t.map(function(l){return n[l.id]?(i===-1&&(i=zJ(t)),o[i]=l.id,l=__dcg_shared_module_exports__['j'](l),l.id=i+"",i+=1):o[l.id]=l.id,n[l.id]=!0,qJ(l,s,o,e)})}}}function QA(r){if(r.version!==6)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="expression"&&t.domain){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{parametricDomain:{min:t.domain.min,max:t.domain.max}});return delete i.domain,i}return t});return{version:7,randomSeed:r.randomSeed,graph:r.graph,expressions:{list:e}}}function $J(r){return r.length===1?`0${r}`:r}function Rd(){let r=new Uint8Array(16);if(typeof crypto!="undefined")crypto.getRandomValues(r);else if(typeof msCrypto!="undefined")msCrypto.getRandomValues(r);else return __dcg_shared_module_exports__['da'](Date.now().toString()+Math.random().toString());return Array.prototype.slice.call(r).map(t=>$J(t.toString(16))).join("")}function ZA(r){let e=r.split("_");return e.length===2&&e[1]&&e[1].length===1?e[0]+"_{"+e[1]+"}":r}function rU(r){return r=__dcg_shared_module_exports__['j'](r),!r.rules&&(r.assignment||r.expression)&&(r.rules=[{id:"1",assignment:r.assignment||"",expression:r.expression||""}]),delete r.assignment,delete r.expression,r}function nx(r){let e=/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g;return r.replace(e,t=>{switch(t){case"\\operatorname{stdev}p":return"\\operatorname{stdevp}";case"\\operatorname{stddev}p":return"\\operatorname{stddevp}";case"\\operatorname{stdDev}P":return"\\operatorname{stdDevP}";case"\\operatorname{var}iance":return"\\operatorname{variance}";default:return""}})}function WJ(r){return r.columns?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{columns:r.columns.map(jJ)}):r}function jJ(r){let{latex:e,values:t}=r,i=__dcg_shared_module_exports__['a']({},r);return e&&(i.latex=nx(e),i.latex=ZA(i.latex)),t&&(i.values=t.map(function(n){return n?nx(n):""})),i}function eL(r){if(r.version!==7)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="image"){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{opacity:""});t.hasOwnProperty("stringOpacity")?i.opacity=t.stringOpacity:t.hasOwnProperty("opacity")?i.opacity=t.opacity+"":delete i.opacity,t.clickableInfo&&(i.clickableInfo=rU(t.clickableInfo)),delete i.stringOpacity;for(let n in t)if(n==="x"||n==="y"||n==="width"||n==="height"){let o=t[n];o&&(i[n]=nx(o))}return i}else if(t.type==="expression"){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{fillOpacity:"",lineStyle:"SOLID"});if(t.lineStyle==="SINGLE_PIXEL"?i.lineWidth="1":t.hasOwnProperty("lineStyle")?i.lineStyle=t.lineStyle:delete i.lineStyle,i.hasOwnProperty("lineWidth")||(i.lineWidth=""),i.hasOwnProperty("lineOpacity")||(i.lineOpacity=""),i.hasOwnProperty("pointOpacity")||(i.pointOpacity=""),i.hasOwnProperty("pointSize")||(i.pointSize=""),i.hasOwnProperty("colorLatex")||(i.colorLatex=""),typeof t.latex=="string"&&(i.latex=nx(t.latex)),t.latex&&(i.latex=nx(t.latex)),t.hasOwnProperty("stringFillOpacity")?i.fillOpacity=t.stringFillOpacity:t.hasOwnProperty("fillOpacity")?i.fillOpacity=t.fillOpacity+"":delete i.fillOpacity,i.slider&&t.slider&&t.slider.newLoopMode&&(i.slider=__dcg_shared_module_exports__['j'](i.slider),i.slider.loopMode=t.slider.newLoopMode,delete i.slider.newLoopMode),i.residualVariable&&(i.residualVariable=ZA(i.residualVariable)),i.regressionParameters){i.regressionParameters={};for(let n in t.regressionParameters){let o=ZA(n),s=t.regressionParameters[n];i.regressionParameters[o]=s}}return t.clickableInfo&&(i.clickableInfo=rU(t.clickableInfo)),i}else if(t.type==="table")return WJ(t);return t});return{version:8,randomSeed:r.randomSeed||Rd(),graph:r.graph,expressions:{list:e}}}function JJ(r,e,t){if(r.verticalLabel)switch(delete e.verticalLabel,t?e.labelAngle="90":e.labelAngle="\\frac{\\pi}{2}",r.labelOrientation){case"above":e.labelOrientation="right";break;case"below":e.labelOrientation="left";break;case"left":e.labelOrientation="above";break;case"right":e.labelOrientation="below";break}r.extendedLabelOrientation&&(e.labelOrientation=r.extendedLabelOrientation,delete e.extendedLabelOrientation)}function YJ(r,e){if(r.vizProps)switch(r.vizProps.dotplotSize){case"small":e.pointSize="9";break;case"large":e.pointSize="20";break}if(r.vizProps){let t=__dcg_shared_module_exports__['a']({},r.vizProps);delete t.dotplotSize,Object.keys(t).length?e.vizProps=t:delete e.vizProps}}function tL(r){return r.filter(({assignment:e,expression:t})=>!!e&&!!t)}function rL(r){return r.map(({assignment:e,expression:t})=>`${e}\\to ${t}`).join(",")||""}function iL(r){let e=JSON.stringify(r),t=/_(\d)|_\{(\d+)\}/g,i,n={};for(;(i=t.exec(e))!==null;){let o=i[1]!==void 0?i[1]:i[2];n[o]=!0}return n}function nL(r,e){for(let t=e+1;;t++)if(!r[t])return t}function iU(r){let e=JSON.stringify(r),t=/"(\d+)"/g,i,n={};for(;(i=t.exec(e))!==null;){let o=i[1]!==void 0?i[1]:i[2];n[o]=!0}return n}function nU(r,e){for(let t=e+1;;t++)if(!r[t])return t}function XJ(r){if(/^\d+$/.test(r)){let e=parseInt(r,10);return e===0?"\\infty":""+Math.round(1e3/e)}else return`\\frac{1000}{${r}}`}function QJ(r,e){let t={handlerLatex:r,playing:!0,open:!0};return e!==void 0&&(t.minStepLatex=XJ(e)),t}function oL(r){if(r.version!==8)throw new Error(`Unexpected version: ${r.version}`);var e=!1;r.graph&&r.graph.degreeMode&&(e=!0);let t=r.expressions.ticker||Om,i=0,n,o=0,s,a=[];for(let u of r.expressions.list)switch(u.type){case"expression":{let p=__dcg_shared_module_exports__['a']({},u);JJ(u,p,e),YJ(u,p);let g;if(u.clickableInfo&&u.clickableInfo.rules){let l=u.clickableInfo,{rules:h}=l,C=__dcg_shared_module_exports__['d'](l,["rules"]),D=tL(h),S=rL(D);if(D.length>1){n||(n=iL(r)),i=nL(n,i),s||(s=iU(r)),o=nU(s,o);let V=`A_{${i}}`;C.latex=V,g={type:"expression",id:""+o,latex:`${V}=${S}`},u.folderId!==void 0&&(g.folderId=u.folderId)}else C.latex=S;p.clickableInfo=C}p.clickableInfo&&p.clickableInfo.enabled&&p.hidden&&(p.clickableInfo.enabled=!1),a.push(p),g&&a.push(g);break}case"image":{if(u.clickableInfo&&u.clickableInfo.rules){let p=__dcg_shared_module_exports__['a']({},u),c=u.clickableInfo,{rules:g}=c,b=__dcg_shared_module_exports__['d'](c,["rules"]),C=tL(g),D=rL(C),S;if(C.length>1){n||(n=iL(r)),i=nL(n,i),s||(s=iU(r)),o=nU(s,o);let V=`A_{${i}}`;b.latex=V,S={type:"expression",id:""+o,latex:`${V}=${D}`},u.folderId!==void 0&&(S.folderId=u.folderId)}else b.latex=D;p.clickableInfo=b,a.push(p),S&&a.push(S)}else a.push(u);break}case"simulation":{let p;if(u.clickableInfo&&u.clickableInfo.rules){let h=tL(u.clickableInfo.rules);p=rL(h)}else p="";if(u.isPlaying&&p!==""){n||(n=iL(r)),i=nL(n,i);let h=`A_{${i}}`;p=`${h}=${p}`,t=QJ(h,u.fps)}let g={type:"expression",id:u.id,latex:p};u.folderId!==void 0&&(g.folderId=u.folderId),a.push(g);break}default:a.push(u);break}return{version:9,randomSeed:r.randomSeed||Rd(),graph:r.graph,expressions:{list:a,ticker:t}}}function oU(r){r.clickableInfo&&(r.description===void 0&&r.clickableInfo.description!==void 0&&(r.description=r.clickableInfo.description),delete r.clickableInfo.description,Object.keys(r.clickableInfo).length===0&&delete r.clickableInfo)}function ZJ(r){switch(r.labelSize){case"small":r.labelSize="0.85";break;case"medium":r.labelSize="1";break;case"large":r.labelSize="1.35";break;default:break}}function eY(r){let e=0,t=/^[0-9]+$/;for(var i=r.length-1;i>=0;i--){var n=r[i];let o=n.id;if(t.test(o)){let s=parseInt(o,10);s>e&&(e=s)}if(n.type==="table"&&n.columns){for(let s=n.columns.length-1;s>=0;s--)if(o=n.columns[s].id,!!o&&t.test(o)){let a=parseInt(o,10);a>e&&(e=a)}}}return e}function sL(r){if(r.version!==9)throw new Error(`Unexpected version: ${r.version}`);let e=[],t={},i=eY(r.expressions.list);for(let o of r.expressions.list)switch(o.type){case"expression":{let l=__dcg_shared_module_exports__['a']({},o);oU(l),ZJ(l),e.push(l);break}case"image":{let l=__dcg_shared_module_exports__['a']({},o);oU(l);let c=l.description;(c===void 0||c==="")&&l.draggable&&l.center!==void 0&&l.center!==""&&(t[l.center]===void 0?t[l.center]=[l]:t[l.center].push(l)),e.push(l);break}case"table":let s=__dcg_shared_module_exports__['a']({},o);if(!s.columns||!ga(s.columns[0].latex)){e.push(s);break}let a=s.columns[0].latex;for(let l=1;l<s.columns.length;l++){let c=s.columns[l];if(!c.lines||!xc(c.latex,a))continue;delete c.lines,i++;let u={type:"expression",latex:"y="+eD(c.latex,a,"x"),id:`${i}`};c.color&&(u.color=c.color),c.lineStyle&&(u.lineStyle=c.lineStyle),c.lineWidth&&(u.lineWidth=c.lineWidth),c.lineOpacity&&(u.lineOpacity=c.lineOpacity),e.push(u)}e.push(s);break;default:e.push(o);break}for(let o of e){if(o.type!=="expression"||o.latex===void 0||o.latex===""||o.latex.indexOf("=")===-1||o.dragMode===void 0||o.dragMode==="NONE"||o.label===void 0||o.label==="")continue;let s=o.latex.slice(0,o.latex.indexOf("=")),a=t[s];if(a!==void 0)for(let l of a)l.description=o.label}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:10,expressions:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.expressions),{list:e})})}function tY(r){let e=/[ \\]*=[ \\]*\\operatorname\{(dilation|reflection|rotation|translation)\}\\left\(/g;return r.type!=="expression"||!r.latex||(r.latex=r.latex.replace(e,(t,i)=>{switch(i){case"dilation":return"\\left(x\\right)=\\operatorname{dilate}\\left(x,";case"rotation":return"\\left(x\\right)=\\operatorname{rotate}\\left(x,";case"reflection":return"\\left(x\\right)=\\operatorname{reflect}\\left(x,";case"translation":return"\\left(x\\right)=\\operatorname{translate}\\left(x,";default:return""}})),r}function aL(r){if(r.version!==10)throw new Error(`Unexpected version: ${r.version}`);let e=__dcg_shared_module_exports__['a']({},r.graph);delete e.projectorMode;let t=__dcg_shared_module_exports__['a']({},r.expressions);if((e==null?void 0:e.product)==="geometry-calculator"){let i=[];for(let n of t.list)switch(n.type){case"expression":{let o=__dcg_shared_module_exports__['a']({},n);tY(o),i.push(o);break}default:i.push(n)}t.list=i}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:11,graph:e,expressions:t})}function sU(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:10})}var lL=[$K,WK,JK,YK,QK,ZK,tU,QA,eL,oL,sL,aL];var jl=11;function Uc(r){if(r.version>jl)return typeof console!="undefined"&&console.warn&&console.warn("Loading saved state with version "+r.version+" but last known version is "+jl+". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),HE(r);if(r.hasOwnProperty("version")&&!lL[r.version])return typeof console!="undefined"&&console.warn&&console.warn("State has invalid version "+r.version+". If a version is present, it should be a non-negative integer less than or equal to "+jl+"."),HE(r);for(r.hasOwnProperty("version")||(r=lL[0](r));r.version<jl;)r=lL[r.version+1](r);return HE(r)}function rY(r){return sU(r)}function aU(r){return rY(Uc(r))}var lU=r=>({value:"0",min:"0",max:r.degreeMode?"360":"2\\pi"}),iY={latex:void 0,polarDomainMin:void 0,polarDomainMax:void 0,parametricDomainMin:void 0,parametricDomain3DuMin:void 0,parametricDomain3DvMin:void 0,clickableInfoLatex:void 0,parametricDomainMax:void 0,parametricDomain3DuMax:void 0,parametricDomain3DvMax:void 0,colorLatex:void 0,tableColumnColorLatex:void 0,cdfMin:()=>({value:"0",min:"-10",max:"10"}),cdfMax:()=>({value:"0",min:"-10",max:"10"}),pointSize:()=>({value:9+"",min:"0",max:"10"}),tableColumnPointSize:()=>({value:9+"",min:"0",max:"10"}),labelAngle:lU,labelSize:()=>({value:"1",min:"0",max:"5"}),lineWidth:()=>({value:2.5+"",min:"0",max:"10"}),resolution:()=>({value:"50",min:"2",max:"100",step:"1"}),checkers:()=>({value:__dcg_shared_module_exports__['pc']+"",min:"1",max:"1000"}),tableColumnLineWidth:()=>({value:2.5+"",min:"0",max:"10"}),fillOpacity:()=>({value:.4+"",min:"0",max:"1"}),lineOpacity:()=>({value:.9+"",min:"0",max:"1"}),tableColumnLineOpacity:()=>({value:.9+"",min:"0",max:"1"}),pointOpacity:()=>({value:.9+"",min:"0",max:"1"}),tableColumnPointOpacity:()=>({value:.9+"",min:"0",max:"1"}),sliderMin:void 0,sliderMax:void 0,sliderStep:void 0,residualVariable:void 0,tableHeader:void 0,tableCellValue:void 0,imageOpacity:()=>({value:"1",min:"0",max:"1"}),imageCenter:void 0,imageHeight:()=>({value:"10",min:"-10",max:"10"}),imageWidth:()=>({value:"10",min:"-10",max:"10"}),imageAngle:lU,tickerMinStep:()=>({value:"0",min:"0"}),tickerHandler:void 0},cU={rgb:{paramBounds:r=>({value:"0",min:"0",max:"255",step:"1"})},hsv:{paramBounds:r=>r===0?{value:"0",min:"0",max:"360",step:"1"}:{value:"0.5",min:"0",max:"1"}}};function pU(r,e,t){var i=r.map(function(s){return{location:s.location,parsed:__dcg_shared_module_exports__['gc'](s.latex)}}),n={};for(let s of e)for(let a of i){var o=nY(s,a,t);o&&o.length&&(n[s]=o[0])}return n}function nY(r,{parsed:e,location:t},i){if(e.type==="Identifier"&&e._symbol===r){let o=iY[t];return o?[o(i)]:void 0}e.type==="Assignment"&&(e=e._expression);let n=[];switch(e.type){case"FunctionCall":{let o=e._symbol;if(cU.hasOwnProperty(o)){let s=cU[o];e.args.forEach(function(a,l){if(a.type==="Identifier"&&a._symbol===r){var c=s.paramBounds(l);c&&n.push(c)}})}break}default:return}return n}function Go(r,e,t){let i=sY(r,e,t);on(r,i)}function on(r,e){if(r.focusLocation=e,!e||(e.type==="ticker"&&(r.getListModel().ticker.playing=!1,ui(r.getListModel(),void 0)),e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-folder-btn"||e.type==="add-ticker-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="regression-output"||e.type==="graph-paper"))return;let t=r.getItemModel(e.id);if(e.type==="expression-menu"){ui(r.getListModel(),void 0);return}else ui(r.getListModel(),t);t&&t.type==="expression"&&Ka(t,!1)}function sY(r,e,t){let i=r.getItemModel(e);if(!i)return;let n=r.isInEditListMode()||r.isItemReadonly(i.id);switch(i.type){case"expression":return{type:n?"readonly-expression":i.type,id:e};case"folder":case"text":return{type:i.type,id:e};case"table":{let s={row:1,column:0},a=!1;return t&&(t.location==="cell"?s={row:t.row,column:t.column}:t==="end"?s={row:wa(i),column:0}:t==="start"?s={row:0,column:0}:t==="container"&&(a=!0)),a?{type:"table-container",id:e}:{type:i.type,id:e,location:s}}case"image":return{type:i.type,id:e,location:"name"};default:return i}}function hU(r){var e=r.getSelectedItem();if(e&&e.type==="expression"&&!e.readonly){Go(r,e.id);return}if(e&&e.type==="table"&&r.focusLocation&&!e.readonly)return;var t=r.getFirstFullyVisibleItem();let i=r.getListModel();for(;t&&(t.type!=="expression"||t.readonly);)t=Hh(i,t.index);if(t){Go(r,t.id);return}let n=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Ec(r.getListModel(),n),Go(r,n.id)}function gU(r){let e=r.focusLocation;if(e&&!(e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-ticker-btn"||e.type==="add-folder-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="regression-output"||e.type==="graph-paper"))return r.getItemModel(e.id)}function _f(r,e,t){on(r,{type:"table",id:e,location:t})}function fU(r,e,t){var i=r.getItemModel(e);if(!i||i.type!=="table")return;let n=i;var o=Jo(n),s=o?o.row:-1,a=o?o.column:-1,l=n.columnModels,c=wa(n),u=l.length,p=(D,S)=>{D===-1?cL(r):D>c?dL(r):(S===-1?(S=u-1,D--):S===u&&(D++,S=0),_f(r,e,{row:D,column:S}))},g=D=>{c>2&&v2(n,s-1),_f(r,e,{row:D,column:a})},h=D=>{a===0||u<=2||(C2(n,a),_f(r,e,{row:s,column:D}))};let b=!!n.columnModels[0].disabled;switch(t){case"Left":p(s,a-1);break;case"Right":p(s,a+1);break;case"Up":p(s-1,a);break;case"Down":p(s+1,a);break;case"Enter":if(s>=c)return hL(r);if(a>0||b)return p(s+1,a);if(s===c-1){let D=D2(n,s);yM(n,s);for(var C=0;C<D.length;C++)yu(n,{row:s+1,column:C},D[C]);_f(r,e,{row:s+1,column:a});return}yM(n,s),_f(r,e,{row:s+1,column:a});break;case"Backspace":s===0?a===0?uL(r):a===u-1||a===1&&u===3?p(0,a-1):h(a-1):a!==0?p(s,a-1):s===c||b?p(s-1,a):g(s-1);break;case"Delete":s===0?a===0?pL(r):a<u-1&&h(a):s>=c||b||g(s);break}}function cL(r){var e=r.getSelectedItem();!e||r.inAudioTraceMode()||(!YD(r.getListModel())&&r.getTickerOpen()&&on(r,{type:"ticker",location:"handler"}),e=r.getSelectedItem(),!e)||Go(r,e.id,"end")}function dL(r){var t;if(!r.inAudioTraceMode()){if(((t=r.getFocusLocation())==null?void 0:t.type)==="ticker"){let i=Um(r.getListModel());if(i)return Go(r,i.id,"start")}if(!XD(r.getListModel())&&!r.isInEditListMode()){let i=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Ec(r.getListModel(),i),ui(r.getListModel(),i)}var e=r.getSelectedItem();e&&Go(r,e.id,"start")}}function uL(r){if(r.isInEditListMode())return;var e=r.getSelectedItem();if(!e||r.getItemCount()===1&&e.type==="expression")return;var t=e.type==="text";let i=Ua(e);if(i){let n=r.getNumberOfItemsInFolder(i.id);if(e.index===i.index+n){us(e,"");return}}if(gL(r,{moveSelection:!0}),t&&dl&&du){ui(r.getListModel(),void 0);return}e=r.getSelectedItem(),e&&Go(r,e.id,"end")}function pL(r){if(!r.isInEditListMode()){var e=r.getSelectedItem();e&&(r.getItemCount()===1&&e.type==="expression"||(mL(r,{moveSelection:!0}),e=r.getSelectedItem(),e&&Go(r,e.id,"start")))}}function hL(r){if(!r.isInEditListMode()){var e=r.getSelectedItem();if(e){if(e.type==="text"&&dl&&du){pi(),ui(r.getListModel(),void 0);return}if(Qb(e).length&&r.areSlidersEnabled())return r.createSlidersForItem(e.id,Qb(e).concat(""));var t=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()}),i=e.index+1;e.type==="folder"&&e.collapsed&&(i+=r.getNumberOfItemsInFolder(e.id)),xl(r.getListModel(),t,i),ui(r.getListModel(),t),e.type==="folder"&&!e.collapsed?us(t,e.id):e.type!=="folder"&&e.folderId&&us(t,e.folderId),e=r.getSelectedItem(),e&&Go(r,e.id)}}}function gL(r,{moveSelection:e}){let t=r.getSelectedItem(),i=r.getListModel();if(!t||t.readonly)return;let n=Uh(i,t.index);if(r._removeExpressionSynchronously(t),e){if(!n){let o=Um(i);o&&(n=o)}ui(i,n)}else ui(i,void 0)}function mL(r,{moveSelection:e}){let t=r.getSelectedItem(),i=r.getListModel();if(!t||t.readonly)return;let n=Hh(i,t.index);if(r._removeExpressionSynchronously(t),e){if(!n){let o=$D(i);o&&(n=o)}ui(i,n)}else ui(i,void 0)}function lY(r){switch(r){case"histogram":case"dotplot":return 12;case"boxplot":return 40}return 1/0}function cY(r){return r==="boxplot"||r==="dotplot"||r=="histogram"}function dY(r){return r==="boxplot"?3:.5}function uY(r,e){if(r.type==="dotplot"||r.type==="histogram"){let n=Math.max(1,r.xmax-r.xmin)*80/(r.binWidth?r.binWidth:1),o=.5*(e.screen.width-n)/n;return Math.max(.2,o)}return .5}function pY(r,e,t){r=__dcg_shared_module_exports__['j'](r);let i=1.2;return e&&r.xmax<0&&r.xmin<0&&r.xmax/(r.xmin-r.xmax)<i&&(r.xmax=0),e&&r.xmax>0&&r.xmin>0&&r.xmin/(r.xmax-r.xmin)<i&&(r.xmin=0),t&&r.ymax<0&&r.ymin<0&&r.ymax/(r.ymin-r.ymax)<i&&(r.ymax=0),t&&r.ymax>0&&r.ymin>0&&r.ymin/(r.ymax-r.ymin)<i&&(r.ymin=0),r}function hY(r,e,t,i){let n=r.type,o=uY(r,e),s=dY(n),a,l,c,u;if(r.xmin===r.xmax&&(t?(r.xmin-=.5,r.xmax+=.5):(r.xmin*=.5,r.xmax/=.5)),r.ymin===r.ymax&&(i?(r.ymin-=.5,r.ymax+=.5):(r.ymin*=.5,r.ymax/=.5)),t){let p=(r.xmax-r.xmin)*o;a=r.xmin-p,l=r.xmax+p}else{let p=(r.xmax/r.xmin)**o;a=r.xmin/p,l=r.xmax*p}if(i){let p=(r.ymax-r.ymin)*s;c=r.ymin-p,u=r.ymax+p}else{let p=(r.ymax/r.ymin)**s;c=r.ymin/p,u=r.ymax*p}if(cY(n)){let p=e.screen.height/e.screen.width,g=(l-a)*p;if(g>r.ymax-r.ymin&&g<lY(n)*(r.ymax-r.ymin)){let h=.5*(r.ymax+r.ymin);u=h+.5*g,c=h-.5*g}}return{xmin:a,xmax:l,ymin:c,ymax:u}}function fL(r,e){var t=sx(r,e);if(!t)return!1;let{xAxisScale:i,yAxisScale:n}=e.settings;if(!hn.fromObject(t).isValid({xAxisScale:i,yAxisScale:n}))return!1;var s=e.mapx(t.xmin),a=e.mapx(t.xmax),l=e.mapy(t.ymin),c=e.mapy(t.ymax),u=10,p=Math.abs(s)<=u&&Math.abs(c)<=u&&Math.abs(a-e.screen.width)<=u&&Math.abs(l-e.screen.height)<=u;return!p}function sx(r,e){let t=1/0,i=-1/0,n=1/0,o=-1/0,s=0,a=r.length,l=e.settings.xAxisScale==="linear",c=e.settings.yAxisScale==="linear";for(let u=0;u<a;u++){let p=pY(r[u],l,c);if(!isFinite(p.xmax-p.xmin)||!isFinite(p.ymax-p.ymin)){s+=1;continue}if(!l&&!(p.xmax>0&&p.xmin>0)||!c&&!(p.ymax>0&&p.ymin>0)){s+=1;continue}let g=hY(p,e,l,c);g.xmin<t&&(t=g.xmin),g.xmax>i&&(i=g.xmax),g.ymin<n&&(n=g.ymin),g.ymax>o&&(o=g.ymax)}if(s!==a)return{xmin:t,xmax:i,ymin:n,ymax:o}}function yU(r){switch(r){case"letters":return"capitalLetters";case"noQwertyLetters":return"noQwertyCapitalLetters";case"noQwertyCapitalLetters":return"noQwertyLetters";default:return"letters"}}function yL(r){return{keypadMinimized:!EP,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,expressionsVisible:!!r.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0}}var wU={xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:"",zmin:"",zmax:""};function xU(r){return r in wU}function gY(r){let e=r.split("\xD7");return(e.length>1&&e[0]==="1"?e.slice(1):e).join("\\cdot")}function ug(r,e){let t=__dcg_shared_module_exports__['Cb'](r,e),i="";if(t.mantissa)i=gY(t.mantissa)+"^{"+t.superscript+"}";else{let n=t.string.split("/");n.length===2?n[0][0]==="-"?i="-\\frac{"+n[0].slice(1)+"}{"+n[1]+"}":i="\\frac{"+n[0]+"}{"+n[1]+"}":i=t.string}return i=i.replace(/π/,"\\pi"),i}function mY(r,e){let t=e.xAxisScale==="linear"?r.xmax-r.xmin:void 0,i=e.yAxisScale==="linear"?r.ymax-r.ymin:void 0,n={xmin:ug(r.xmin,t),xmax:ug(r.xmax,t),ymin:ug(r.ymin,i),ymax:ug(r.ymax,i)};return r.zmin!==void 0&&r.zmax!==void 0&&(n.zmin=ug(r.zmin,r.zmax-r.zmin),n.zmax=ug(r.zmax,r.zmax-r.zmin)),n}function bU(r,e){return r===0?"":ug(r,e)}function vU(r,e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},mY(r,e.scales)),{xstep:bU(e.steps.xAxisStep,r.xmax-r.xmin),ystep:bU(e.steps.yAxisStep,r.ymax-r.ymin)})}function bL(){return{limitLatex:__dcg_shared_module_exports__['a']({},wU)}}ct();zl();var yY={version:jl,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},Ff=yY;ct();function CU(r){let e=[],t=r.getAllItemModels();for(let i of t){let n=r.getItemRootNodeById(i.id);n&&e.push(n)}return e}function bY(r){let e=r.getAllItemModels();for(let t=e.length-1;t>=0;t--){let i=e[t];if(i.dcgView)return i.id}}function DU(r,e){let t=CU(r),i=0,n=t.length-1;for(;i<=n;){let o=i+Math.floor((n-i)/2),s=t[o],a=s.getBoundingClientRect();if(a.top>e)n=o-1;else if(a.bottom<e)i=o+1;else return s}}function wY(r,e){let t=CU(r),i=0,n=t.length-1,o;for(;i<=n;){let s=i+Math.floor((n-i)/2),a=t[s];a.getBoundingClientRect().top>e?(n=s-1,o=a):i=s+1}return o}function SU(r,e){let t=cx(r);if(!t)return;if(e){let n=r.getItemRootNodeById(e);if(n){let o=n.getBoundingClientRect();if(o.height>0&&o.top<=t.top&&o.bottom>=t.top)return e}}let i=DU(r,t.top);return i?O(i).attr("expr-id"):wL(r)}function EU(r,e){let t=cx(r);if(!t)return;let i=bY(r);if(!i)return;if(e){let o=r.getItemRootNodeById(e);if(o){let s=o.getBoundingClientRect();if(s.height>0&&s.top<=t.bottom&&s.bottom>=t.bottom||e===i&&s.bottom<=t.bottom)return e}}let n=DU(r,t.bottom);return n&&O(n).attr("expr-id")||i}function wL(r){let e=cx(r);if(!e)return;let t=wY(r,e.top-2);if(t)return O(t).attr("expr-id")}function ax(r){return r.findEl(".dcg-exppanel")}function lx(r){return ax(r)}function cx(r){let e=ax(r);if(e)return e.getBoundingClientRect()}function kU(r){let e=ax(r);if(!e)return;let t=e.getBoundingClientRect(),i=e.scrollTop;return t.top-i}function GU(r){let e=r.findEl(".dcg-expressionlist");if(!e)return;let t=e.getBoundingClientRect();return{width:t.width,height:t.height}}function IU(r){let e=lx(r);if(!e)return;let t=e.querySelector(".dcg-drag-container > *");if(!t)return;let i=t.getBoundingClientRect();return{width:i.width,height:i.height}}ct();var dx=class{constructor(e){this.active=!1,this.controller=e;let t=lx(e);t&&(this.exppanel=t)}startDragging(e){this.active=!0,this.mousePt=e,this.setupEventListeners()}applyDrag(){var k;let t=this.controller.getListModel().dragState;if(!t)return;this.scheduleUpdateScroll();let i=this.measureDOM(t);if(!i)return;let{floatingPreviewRect:n,dragState:o,visibleRects:s}=i,a=this.controller.getItemModel(o.firstItemId);if(!a)return;let l=a.index,c=s[0];if(c&&c.id!==a.id){let T=this.controller.getItemModel(c.id);T&&T.index>l&&(l=T.index-1)}let{cachedNamedAssignmentLatex:u,cachedTokenAssignmentLatex:p}=o;for(let{id:T,rect:A}of s){if(T===a.id)continue;let R=this.controller.getItemModel(T);if(!R)return;if(R.index<a.index){if(n.top<A.top+A.height/2){l=R.index;break}}else n.bottom>A.top+A.height/2&&(l=R.index,R.type==="folder"&&R.collapsed&&(l+=this.controller.getNumberOfItemsInFolder(R.id)))}let g,h;l>a.index?(g=l,h=l+1):l<a.index?(g=l-1,h=l):(g=l-1,h=l+1);let b=this.controller.getItemModelByIndex(g),C=this.controller.getItemModelByIndex(h),D="",S="";b&&(b.type==="folder"?D=b.id:D=b.folderId),C&&(C.type==="folder"?S=C.id:S=C.folderId);let V="";if(D&&(S===D?a.type==="folder"?l=a.index:V=D:a.type!=="folder"&&this.isPreviewTopContainedInFolder(i,D)&&(V=D)),a.type==="expression")if(o.renderType==="token"){if(t.renderType==="expression"&&(u=a.latex,this.controller.convertToTokenAssignment(a,p)),o.dragTarget.type==="token")l=o.dragTarget.originalIndex,V=((k=this.controller.getGeometryFolder())==null?void 0:k.id)||"";else if(o.dragTarget.type==="expression"){let T=this.controller.getGeometryFolder();if(T){let A=this.controller.getNumberOfItemsInFolder(T.id);a.type==="expression"&&a.folderId===T.id&&(A-=1),l=T.index+A+1,V=T.id}}}else o.renderType==="expression"&&t.renderType==="token"&&(p=a.latex,this.controller.convertToNamedAssignment(a,u));return{dragState:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{cachedNamedAssignmentLatex:u,cachedTokenAssignmentLatex:p}),newIndex:l,folderId:V}}measureDOM(e){let t=kU(this.controller),i=GU(this.controller),n=IU(this.controller);if(t===void 0||!i||!n)return;let o=i.height,s=n.height,a=!1,l=this.controller.getExppanelSelector(),c=l==null?void 0:l.querySelector(".dcg-template-expressioneach"),u=c==null?void 0:c.getBoundingClientRect();u&&u.top<=e.mousePt.y&&(a=!0);let p=!1,g=l==null?void 0:l.querySelector(".dcg-geo-show-constructions-pane"),h=g==null?void 0:g.getBoundingClientRect();h&&h.bottom>e.mousePt.y&&(p=!0);let b=!1;(e.dragTarget.type==="token"&&!a||e.dragTarget.type==="expression"&&p&&!a&&this.controller.canDraggedItemBeMovedIntoTokenPane())&&(b=!0);let C=e.grabOffset;b?C={x:n.width/2,y:n.height/2}:e.dragTarget.type==="token"&&(C={x:0,y:n.height/2});let D=e.mousePt.y-C.y+2,S=D-t;S=Math.max(S,-s/2),S=Math.min(S,o-s);let V=0;if(b){V=e.mousePt.x-C.x;let W=4;V=Math.min(V,i.width-n.width-W),V=Math.max(V,0),S=Math.max(S,2)}let k={left:V,top:D,bottom:D+s,height:s},T=this.controller.findFirstVisibleItem(),A=this.controller.findLastVisibleItem(),R=[];if(T&&A)for(var P=T.index;P<=A.index;P++){let W=this.controller.getItemModelByIndex(P);if(!W)continue;let H=this.controller.getItemRootNodeById(W.id);if(H&&W.id!==e.firstItemId){let j=H.getBoundingClientRect();R.push({id:W.id,rect:j})}}return{dragState:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{itemTop:S,itemLeft:V,renderType:b?"token":"expression"}),floatingPreviewRect:k,visibleRects:R}}isPreviewTopContainedInFolder(e,t){let{visibleRects:i,floatingPreviewRect:n}=e;for(let{id:o,rect:s}of i)if(s.top<=n.top&&s.bottom>=n.top){let a=this.controller.getItemModel(o);if(!a)return!1;if(a.type==="folder"&&a.id===t||a.type!=="folder"&&a.folderId===t)return!0}return!1}scheduleUpdateScroll(){this.updateScrollScheduled||(this.updateScrollScheduled=!0,requestAnimationFrame(()=>{this.updateScroll(),this.updateScrollScheduled=!1}))}stop(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})}setupEventListeners(){O(document).on("dcg-tapmove.dragdrop",e=>{this.mousePt.x=e.changedTouches[0].clientX,this.mousePt.y=e.changedTouches[0].clientY,this.controller.dispatch({type:"update-dragdrop",mousePt:this.mousePt})}),O(document).on("dcg-tapend.dragdrop",e=>{this.stop(),e.handle("dragdrop")})}tearDownEventListeners(){O(document).off(".dragdrop")}updateScroll(){if(this.active){var e=this.exppanel.getBoundingClientRect(),t=0;t=Math.min(t,this.mousePt.y-e.top),t=Math.max(t,this.mousePt.y-e.bottom+30),t=t*e.height/900,t&&(this.exppanel.scrollTop=this.exppanel.scrollTop+t)}}};var xY={loga:r=>{r.write("\\log_{}"),r.typedText("("),r.keystroke("Left"),r.keystroke("Down")},nthroot:r=>{r.write("\\sqrt[]{}"),r.keystroke("Left"),r.keystroke("Left")},ddx:r=>{r.write("\\frac{d}{dx}")},arcsin:r=>{r.write("sin^{-1}"),r.typedText("(")},arccos:r=>{r.write("cos^{-1}"),r.typedText("(")},arctan:r=>{r.write("tan^{-1}"),r.typedText("(")},arcsec:r=>{r.write("sec^{-1}"),r.typedText("(")},arccsc:r=>{r.write("csc^{-1}"),r.typedText("(")},arccot:r=>{r.write("cot^{-1}"),r.typedText("(")},"A^T":r=>{r.typedText("^T"),r.keystroke("Right")},"A^-1":r=>{r.typedText("^-1"),r.keystroke("Right")},"A^2":r=>{r.typedText("^2"),r.keystroke("Right")},"a^2":r=>{r.typedText("^2"),r.keystroke("Right")},"a^3":r=>{r.typedText("^3"),r.keystroke("Right")},"a/b":r=>{r.write("\\frac{}{}"),r.keystroke("Left")},integral:r=>{r.cmd("integral")}};function Rf(r,e){xY[e](r)}ct();function VU(r){if(!r)return;let e=[];for(let t of r.split(" ")){let i=t.indexOf("|"),n=i!==-1?t.slice(0,i):t;e.push(n)}return e}function Nf(r,e,t){let i=VU(t);return e==="nemeth"?Gu(r,{operatorNames:i}):e==="ueb"?Iu(r,{operatorNames:i}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function WE(r,e,t){let i=VU(t);return e==="nemeth"?_A(r,{operatorNames:i}):e==="ueb"?FA(r,{operatorNames:i}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}var Ms=__dcg_shared_module_exports__['h'](X());var Bf=__dcg_shared_module_exports__['h'](X());ct();var{Input:vY}=Bf.Components,pg=class extends Bf.Class{init(){this.ASCIICharacters=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0};let e;for(e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))}template(){return Bf.createElement(vY,{class:this.const("dcg-braille-input dcg-do-blur"),tabindex:()=>this.props.tabindex?this.props.tabindex():0,readonly:()=>this.props.isStatic()?"true":void 0,autocomplete:this.const("off"),autocorrect:this.const("off"),autocapitalize:this.const("off"),spellcheck:this.const("false"),onKeydown:this.bindFn(this.onKeydown),onKeyup:this.bindFn(this.onKeyup),onInput:this.bindFn(this.props.onInput),value:()=>this.props.value(),"aria-label":()=>this.props.ariaLabel()||Fa(""),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.props.didUnmount),placeholder:()=>this.props.placeholder?this.props.placeholder():"",size:()=>this.props.size&&this.props.size()})}didMount(e){this.rootNode=e,O(this.rootNode).on("focus",t=>{this.props.shouldFocus()||this.props.onFocusedChanged(!0,t.originalEvent||t)}).on("blur",t=>{this.props.shouldFocus()&&this.props.onFocusedChanged(!1,t.originalEvent||t)}),this.props.didMount(e),this.updateFocus()}didUpdate(){this.updateFocus()}updateFocus(){this.rootNode&&(this.props.shouldFocus()&&document.activeElement!==this.rootNode&&this.rootNode.focus(),!this.props.shouldFocus()&&document.activeElement===this.rootNode&&this.rootNode.blur())}onKeydown(e){let t=this.charCodes.indexOf(e.which);!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.sixKeyModel),{keysDown:this.addKey(this.sixKeyModel.keysDown,t),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,t)}),e.preventDefault()):this.props.onKeydown&&this.props.onKeydown(e)}onKeyup(e){let t=this.charCodes.indexOf(e.which),i=!1;return!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.sixKeyModel),{keysDown:this.removeKey(this.sixKeyModel.keysDown,t)}),this.sixKeyModel.keysDown===0&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.sixKeyModel),{stickyKeysDown:0}))):i=!0,i||e.preventDefault(),i}addKey(e,t){return e|1<<t}removeKey(e,t){return e&~(1<<t)}bitsToASCII(e){return String.fromCharCode(this.ASCIITable[e])}addCharacter(e){this.rootNode&&!this.props.isStatic()&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))}isSixKeyInput(){return typeof this.props.sixKeyInput=="function"&&this.props.sixKeyInput()}};var{If:CL}=Ms.Components,Cn=class extends Ms.Class{init(){this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.currentBrailleMode=this.props.mode(),this.hasTranslationError=!1,this.currentLatex=this.props.latex()}isFocused(){return this.brailleInput!==void 0&&document.activeElement==this.brailleInput}getBrailleShouldFocus(){return this.props.mode()!=="none"&&this.props.brailleShouldFocus&&this.props.brailleShouldFocus()}isStatic(){return!!this.props.isStatic&&this.props.isStatic()}isInline(){return!!this.props.isInline&&this.props.isInline()}hasError(){return!!this.props.hasError&&this.props.hasError()}willUpdate(){let e=this.currentLatex!==this.props.latex(),t=this.props.mode(),i=t!==this.currentBrailleMode&&t!=="none";this.isFocused()&&!e&&!i||(this.currentLatex=this.props.latex(),(i||!this.hasTranslationError||e||this.isStatic())&&(this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.hasTranslationError=!1),this.currentBrailleMode=t)}onBrailleInput(e){if(!this.props.onBrailleInput)return;let t=this.getLatexFromBraille(e);this.hasTranslationError=t.isError;let i=this.props.capExpressionSize&&this.props.capExpressionSize();if(!t.isError&&i&&i.exceedsLimit(t.value)){i.onExpressionSizeExceeded();return}this.currentBrailleValue=e,t.isError||(this.currentLatex=t.value,this.props.onBrailleInput(t.value))}getBrailleFromLatex(e,t=!1){let i=Nf(e,this.props.mode(),this.props.operatorNames&&this.props.operatorNames());return i.isError?"":t?i.value:qs.toExpandedBrailleAscii(i.value)}getLatexFromBraille(e){return WE(qs.coerceToSixDotCells(e),this.props.mode(),this.props.operatorNames&&this.props.operatorNames())}getBrailleLabel(e){return this.getBrailleFromLatex(e.replace(/\s/,"\\ "))}shouldShowBraille(){let e=this.props.mode();return e==="nemeth"||e==="ueb"}isOverflowingLeft(){return this.brailleInput?this.brailleInput.scrollLeft>0:!1}isOverflowingRight(){if(!this.brailleInput)return!1;let e=this.brailleInput.getBoundingClientRect().width,t=this.brailleInput.scrollWidth,i=this.brailleInput.scrollLeft;return t>e+i+2}didMountBrailleInput(e){this.brailleInput=e}didUnmountBrailleInput(){this.brailleInput=void 0}getTooltipGravity(){let e=this.props.tooltipOptions&&this.props.tooltipOptions();return e&&e.gravity?e.gravity:"se"}getTooltipDelay(){let e=this.props.tooltipOptions&&this.props.tooltipOptions();return e&&e.delay?e.delay:0}handleBrailleFocusChanged(e,t){this.props.onBrailleFocusedChanged&&this.props.onBrailleFocusedChanged(e,t),this.brailleInput&&(e&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.brailleInput.select(),this.isStatic()&&this.brailleInput.scrollTo(0,0))}getTooltipText(){let e=this.props.placeholder&&!this.isFocused()?this.props.placeholder():"";return Fa(this.props.latex()||e)}template(){return Ms.createElement("div",{class:Ms.const("dcg-mathquill-wrapper")},Ms.createElement(CL,{predicate:()=>this.shouldShowBraille()},()=>Ms.createElement("div",{class:()=>({"dcg-mathquill-braille":!0,"dcg-focus":this.getBrailleShouldFocus(),"dcg-invalid":this.hasError(),"dcg-mathquill-static-braille":this.isStatic(),"dcg-mathquill-braille-overflow-left":this.isOverflowingLeft(),"dcg-mathquill-braille-overflow-right":this.isOverflowingRight()}),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0},Ms.createElement(Ke,{class:this.const("dcg-mathquill-braille-tooltip"),renderAsLatex:()=>({view:this.props.tooltipOptions().latexView}),tooltip:()=>this.getTooltipText(),gravity:this.bindFn(this.getTooltipGravity),delay:this.bindFn(this.getTooltipDelay),showOnTapstart:this.const(!0)},Ms.createElement(CL,{predicate:()=>this.isInline()},()=>Ms.createElement("span",{class:Ms.const("dcg-inline-braille")},()=>Fa(this.getBrailleFromLatex(this.props.latex(),!0)))),Ms.createElement(CL,{predicate:()=>!this.isInline()},()=>Ms.createElement(pg,{ariaLabel:()=>Fa(this.props.ariaLabel?this.getBrailleLabel(this.props.ariaLabel()):""),didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.handleBrailleFocusChanged),shouldFocus:this.bindFn(this.getBrailleShouldFocus),onKeydown:this.props.onBrailleKeydown,onInput:this.bindFn(this.onBrailleInput),sixKeyInput:this.props.sixKeyInput,value:()=>this.currentBrailleValue,placeholder:()=>Fa(this.props.placeholder?this.getBrailleFromLatex(this.props.placeholder()):""),tabindex:()=>this.props.tabindex?this.props.tabindex():0,isStatic:this.bindFn(this.isStatic),size:()=>this.currentBrailleValue&&this.currentBrailleValue.length||1}))))),Ms.createElement("div",{class:Ms.const("dcg-typeset-math"),style:()=>({display:this.shouldShowBraille()&&!this.isInline()?"none":void 0}),"aria-hidden":()=>this.shouldShowBraille()},this.children))}};function Da(){if(!(!document.activeElement||!O(document.activeElement).hasClass("dcg-braille-input")))return document.activeElement}function Kf(r){return!r||O(r).val()===""}function CY(r){for(let e in r)return!1;return!0}function DY(r){var i;if(r.type!=="expression")return;let e=r.formula.assignment;return e||((i=r.formula.geometry)==null?void 0:i.identifier)}function SY(r){var t,i;let e={lookupIdentifier:{},lookupCalcId:{}};for(let n of r){let o={calcId:n.id,identifier:DY(n),referencesTheseIdentifiers:{},referencedByTheseCalcIds:{}};e.lookupCalcId[o.calcId]=o,o.identifier&&(e.lookupIdentifier[o.identifier]=o)}for(let n of r){let o=e.lookupCalcId[n.id];if(o){if(n.type==="expression"){n.folderId===__dcg_shared_module_exports__['Jc']&&(o.isGarbageCollectable=!n.readonly,(n.latex.indexOf("\\operatorname{segments}")!==-1||Kl(n))&&(o.deleteIfNotReferenced=!0));let s=(i=(t=n.formula.geometry)==null?void 0:t.call)==null?void 0:i.parents;s&&s.forEach(a=>{if(!a)return;let l=a[0];TU(e,o,l)})}Rm(n,s=>{var a=s.match(/(\\token{[0-9]+})/g);if(a)for(let l of a){let c=__dcg_shared_module_exports__['Kb'](l);c!==o.identifier&&TU(e,o,c)}})}}return e}function TU(r,e,t){e.referencesTheseIdentifiers[t]=!0;let i=r.lookupIdentifier[t];i&&(i.referencedByTheseCalcIds[e.calcId]=!0)}function EY(r,e,t){var c;let i=[];for(let u of e){let p=r.lookupCalcId[u];if(p){i.push(p);var n=p.referencesTheseIdentifiers;for(let g in n){let h=r.lookupIdentifier[g];h&&delete h.referencedByTheseCalcIds[p.calcId]}}}var o={};for(let u in t)for(let p of t[u]){let g=r.lookupIdentifier[p];g&&delete g.referencedByTheseCalcIds[u],o[p]=!0}var s={};for(let u of i){let p=u.referencesTheseIdentifiers;for(let h in p)o[h]=!0;let g=u.identifier;if(g){var a=(c=r.lookupIdentifier[g])==null?void 0:c.referencedByTheseCalcIds;if(a)for(let h in a){let b=r.lookupCalcId[h];b&&b.isGarbageCollectable&&(s[h]=!0)}}}for(let u in o){let p=r.lookupIdentifier[u];if(p&&p.deleteIfNotReferenced){var l=p.referencedByTheseCalcIds;p.calcId&&p.isGarbageCollectable&&CY(l)&&(s[p.calcId]=!0)}}for(let u of i)delete r.lookupCalcId[u.calcId],u.identifier&&delete r.lookupIdentifier[u.identifier];return Object.keys(s)}function MU(r,e,t){var c,u;let i=r.getAllItemModels(),n=e.map(p=>p.id),o=SY(i.concat(e));var s={};let a={};for(let p in t){let{nextLatex:g}=t[p],h=r.getItemModel(p);if((h==null?void 0:h.type)!=="expression")continue;let b={};for(let D of((u=(c=h.formula.geometry)==null?void 0:c.call)==null?void 0:u.parents)||[]){if(!D)continue;let[S]=D;b[S]=!0}for(let D in b)xc(g,__dcg_shared_module_exports__['Ib'](D))&&delete b[D];let C=Object.keys(b);C.length&&(a[p]=C)}let l=Object.keys(a).length>0;for(;n.length||l;){l=!1,n=EY(o,n,a);for(let p of n)s[p]=!0}return Object.keys(s)}var AU={version:jl,randomSeed:"",graph:{product:"graphing-3d",threeDMode:!0,viewport:{xmin:-2,ymin:-2,zmin:-2,xmax:2,ymax:2,zmax:2}},expressions:{list:[{id:"1",type:"expression"}]}};var Uf={version:jl,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25},showGrid:!1,product:"geometry-calculator",showXAxis:!1,showYAxis:!1,degreeMode:!0},expressions:{list:[{type:"folder",id:__dcg_shared_module_exports__['Jc'],title:"geometry",secret:!0},{id:"1",type:"expression"}]}};function jE(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(r)}function DL(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry-beta\/./.test(r)}function kY(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/3d\/./.test(r)}function SL(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry\/./.test(r)}function LU(r){return jE(r)?"graphing":DL(r)?"geometry-calculator":SL(r)?"geometry":kY(r)?"graphing-3d":void 0}var OU={translate:!0,reflect:!0,dilate:!0,rotate:!0},bye=__dcg_shared_module_exports__['a']({selection:!0,point:!0,line:!0,segment:!0,ray:!0,circle:!0,arc:!0,parallel:!0,perpendicular:!0,midpoint:!0,polygon:!0,compass:!0,angle:!0,directedangle:!0,"box-selection":!0,"expression-edit":!0},OU),Hf=Object.keys(OU);function ux(r){switch(r){case"parallel":case"perpendicular":case"compass":return!0}return!1}function PU(r){var e;switch(r.type){case"tick":return!1;case"tick-ticker":return!1;case"on-evaluator-changes":return!!((e=r.eventUpdates)!=null&&e.userAction);default:return!0}}var hg=class{constructor(e){this.__nextItemId=0;this.__pendingImageUploads={};this.__lastSelectedIdsForPropagation={};this.nextSubscription=0;this.subscriptions={};this._queuedCallbacks=[];this._hasUnsavedChanges=!1;this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;this.lastParsableObjects={};this.isExpressionSearchStrValidForReplace=!1;this.isExpressionReplaceStrValidForReplace=!1;this.expressionSearchCount=0;this.expressionSearchOpen=!1;this.geoUIActive=!1;this.showConstructionsOpen=!1;this.showGeoNotice=!1;this.activeTool="selection";this.geometryGettingStartedMessageState="pick-a-tool";this.activeTokens={selected:void 0,hovered:void 0};this.apiMethodCallStack=[];this.canShowKeyboardShortcuts=!1;this.toastData={};this.s=bc(()=>this.graphSettings.config.language);this.raw=(e,t)=>Fa(e,t);this.hasTranslation=e=>{let t=this.graphSettings.config.language;return gT(e,t)};this.unpack=e=>{let t=this.graphSettings.config.language;return md(e,t)};this.dispatch=e=>{if(e.type==="blur-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="set-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="tick"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}e.type==="tick"||jh("dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.isDispatching()&&jh("dispatch-in-dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.dispatch(e),this.onEventsEmitted&&this.onEventsEmitted(this.enqueuedEvents);let t;for(;t=this._queuedCallbacks.shift();)t()};this._requiresTickNextFrame=!1;this.cachedGeoTokenDepths={};this.cachedGeoTokenInfo={};this.toolPreviewJSONState={};this.updateViews=()=>{for(var e in this.subscriptions)this.subscriptions[e]()};this.bugsnagContext="";this.inPrintMode=!1;this.lastInfiniteScrollFirstDOM=void 0;this.lastInfiniteScrollLastDOM=void 0;this.hasDispatchSinceLastInfiniteScrollUpdate=!1;this.stateStack=new Au;this.isCurrentlyDoingSetState=!1;this.isCurrentlyDoingRestoreState=!1;var t,i;this.graphSettings=e,(i=(t=this.graphSettings).setController)==null||i.call(t,this),this.listModel=ER(this),this.layoutModel=yL(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=bL(),this.geometryToolbarModel=CR(),this.imageRetryState={lastAttemptTime:0,attempts:0},this.makeGeoAPI(),this.setupDispatcher()}hasGeoNotice(){return this.isGeometry()?this.showGeoNotice:!1}hasUnsavedChanges(){return this._hasUnsavedChanges}getExpressionSearchOpen(){return this.expressionSearchOpen}getShowConstructionsOpen(){return this.showConstructionsOpen}getGeoToolbarSuppressedByAuthor(){return this.geometryToolbarModel.toolbar==="none"&&!this.shouldShowAuthorFeatures()}shouldShowGeoToolbar(){return this.isGeoUIActive()&&!this.getGeoToolbarSuppressedByAuthor()}isGeoUIActive(){return this.geoUIActive}isGeoToolActive(){return this.activeTool!=="selection"&&this.activeTool!=="box-selection"}getActiveTool(){return this.activeTool}getGeoModel(){return this.geoModel}getGeoToolbarGroupKeys(){return qD(this.geometryToolbarModel,this.shouldShowAuthorFeatures()).groups}getGeoToolbarItemsForGroup(e){let{items:t}=qD(this.geometryToolbarModel,this.shouldShowAuthorFeatures());return t[e]}getAllVisibleGeoToolbarItems(){let e=this.getGeoToolbarGroupKeys(),t=[];for(let i of e){let n=this.getGeoToolbarItemsForGroup(i);n&&t.push(n)}return t}getTickerOpen(){return this.areActionsEnabled()?this.listModel.ticker.open:!1}getTickerPlaying(){return this.areActionsEnabled()?this.listModel.ticker.playing:!1}hasVisibleAndUndoableToast(){return typeof this.toastData.undoCallback=="function"}toastUndo(){typeof this.toastData.undoCallback=="function"&&(this.toastData.undoCallback(),this.dispatch({type:"toast/close"}))}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}enqueueEvent(e,t){var n;let i=t&&this.apiMethodCallStack.length===0&&PU(t)||!!((n=this.enqueuedEvents[e])!=null&&n.isUserInitiated)||e==="userMovedPoint";this.enqueuedEvents[e]={isUserInitiated:i}}pushAPIMethodCall(){this.apiMethodCallStack.push(!0)}popAPIMethodCall(){this.apiMethodCallStack.pop()}getGrapherDimensions(){let e=this.getGrapher();if(!e)return{width:0,height:0};let{width:t,height:i}=e.getProjection().screen;return{width:t,height:i}}setRandomSeed(e){this.graphSettings.setProperty("randomSeed",e)}getRandomSeed(){return this.graphSettings.randomSeed}shouldDispatchTickNextFrame(){return!!this._requiresTickNextFrame}markTickRequiredNextFrame(){this._requiresTickNextFrame=!0}handleTick(e){this.areActionsEnabled()&&dR(this.listModel.ticker,{currentFrameTime:e,previousFrameTime:this.lastFrameTime})?this.dispatch({type:"tick-ticker",time:e}):this.shouldDispatchTickNextFrame()&&this.dispatch({type:"tick",time:e}),this.getGeoModel().isFading()&&this.requestRedrawGraph(),this.lastFrameTime=e}setupDispatcher(){this.dispatcher=new Fd,this.dispatcher.register(e=>{var l;let t=this.getSelectedItem(),i=this.getFocusLocation();this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let n;this.enqueuedEvents={change:void 0,graphReset:void 0,clearUnsavedChanges:void 0,openDrawer:void 0,showHotkeysModal:void 0,userMovedPoint:void 0,userClickedObject:void 0,userEditedLabel:void 0},e.type==="tick"&&(this._requiresTickNextFrame=!1),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.handleDispatchedAction(e),this.constrainMultiSelect(),this.updateTheComputedWorld();var o=this.getImageToRetry();(this.getPlayingSliders().length>0||this.isDragDropActive()||o)&&this.markTickRequiredNextFrame(),o&&this.retryLoadingFailedImage(o),this.updateGeometryGettingStartedMessageState(),e.type!=="undo"&&e.type!=="redo"&&!this.isDragDropActive()&&this.commitUndoRedoSynchronously(e),this.requestParseForAllItems(),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.enqueuedEvents.change&&((l=this.getGrapher2d())==null||l.markLabelsDirty()),this.enqueuedEvents.clearUnsavedChanges?this._hasUnsavedChanges=!1:this.enqueuedEvents.change&&(this._hasUnsavedChanges=!0);let s=this.getSelectedItem();s?(!t||t.guid!==s.guid)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0):this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let a=this.getFocusLocation();a&&!__dcg_shared_module_exports__['G'](a,i)&&this.getFocusedItem()==s&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0),i&&t&&t.type==="table"&&i.type==="table"&&(!a||a.type!=="table"||i.id!==a.id)&&t.isExpanded&&(Zm(t,!1),a||(n=t)),a&&s&&s.type==="table"&&h2(s),(e.type==="adjust-slider-by-dragging-thumb"||e.type==="adjust-slider-by-keyboard")&&(n=this.getItemModel(e.id)),this.updateRenderShellsBeforePaint(),this.updateViews(),n?this.scrollItemIntoView(n):this.shouldScrollSelectedItemIntoViewAfterDispatch&&this.scrollSelectedItemIntoView(),this.updateDragDrop(),this.updateRenderShellsAfterDispatch()})}updateGeometryGettingStartedMessageState(){if(!this.isGeometry())return;let e=this.geometryGettingStartedMessageState,t=this.getActiveTool(),i=t==="selection"||t==="box-selection"||t==="expression-edit";if(e==="hidden")return;if(this.isGraphSettingsOpen()||this.getGraphSettings().showGrid||this.getGraphSettings().showYAxis){this.geometryGettingStartedMessageState="hidden";return}let n=this.getItemModelByIndex(1);if(this.getItemCount()>2||!n||n.type!=="expression"||n.latex!==""||this.geoModel.getNonObjectsState().ui.currentTool.inputIndex>0){this.geometryGettingStartedMessageState="hidden";return}i||(this.geometryGettingStartedMessageState="construct")}getGeometryGettingStartedMessageState(){return this.geometryGettingStartedMessageState}handleDispatchedAction(e){var u,p,g,h,b,C,D,S,V,k,T;switch(e.type){case"render":break;case"undo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.undo();break;case"redo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":e.key==="Enter"?hL(this):e.key==="Up"?cL(this):e.key==="Down"?dL(this):e.key==="Backspace"?uL(this):e.key==="Delete"&&pL(this);break;case"select-previous-expression":YD(this.listModel);break;case"select-next-expression":XD(this.listModel);break;case"toggle-label-for-all-selected-points":this.toggleLabelForAllSelectedObjects();break;case"update-all-selected-items":{let w=e.update;if(e.update.prop==="folderId"){let B;if(e.update.createFolder){B=this.generateId();let fe=this.createItemModel({type:"folder",id:B,title:e.update.value}),Se=this.getItemCount()-1,de=Km(this.listModel,Se);de&&de.type==="expression"&&de.latex===""?this._toplevelReplaceItemAt(this.getItemCount()-1,fe,!1):Ec(this.listModel,fe)}else B=e.update.value;let q=this.getItemModel(B);if(!q||q.type!=="folder")return;let M={},ae={};this.getAllSelectedItems().forEach(fe=>{var Se;if(!(fe.type==="folder"||fe.folderId===B)&&(M[fe.id]=fe,fe.type==="expression")){let de=(Se=fe.formula.geometry)==null?void 0:Se.call;if(de&&de.symbol==="apply"){let Ee=de.parents[0]&&de.parents[0][0];Ee&&(ae[Ee]=!0)}}});for(let fe in ae){let Se=$m(this.listModel,fe);Se.length===1&&Se[0].folderId!==B&&(M[Se[0].id]=Se[0])}let se={},ge=[];for(let fe in M){let Se=M[fe];ge.push(Se)}ge.forEach(fe=>{if(fe.type==="expression"){let Se=LT(fe);Se&&(se[fe.id]=Se)}}),ge.sort((fe,Se)=>fe.index-Se.index);let he=this.findLastSubscriptForLetters();ge.forEach(fe=>{if(fe.type==="expression"){var Se=se[fe.id];if(Se){let de=this.getAutonameLatexForExpression(fe,he);Gp(this.listModel,Se,de)}}}),ge.forEach(fe=>{Jm(this.listModel,fe.id)});let ye=q.index+this.getNumberOfItemsInFolder(B)+1;ge.forEach(fe=>{xl(this.listModel,fe,ye),ye+=1}),ge.forEach(fe=>{us(fe,B)})}else if(w.prop==="visible")this.getAllSelectedItems().forEach(B=>{this._setItemHidden(B.id,!w.value),w.value===!1&&B.type==="expression"&&_h(B,!1)});else if(e.update.prop==="color"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&dD(q,B)})}else if(e.update.prop==="colorLatex"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&Nb(q,B)})}else if(e.update.prop==="showLabel"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&_h(q,B)})}else if(e.update.prop==="label"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&gu(q,B)})}else if(e.update.prop==="dragMode"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&Fh(q,B)})}else if(e.update.prop==="lineWidth"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&km(q,B)})}else if(e.update.prop==="lineOpacity"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&Em(q,B)})}else if(e.update.prop==="lineStyle"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&hD(q,B)})}else if(e.update.prop==="strictIntersection"){let B=e.update.value;this.getAllSelectedItems().forEach(q=>{q.type==="expression"&&W_(q,B)})}}break;case"delete-all-selected-items":let A=uM(this.listModel,Object.keys(this.getSelectedExpressionIds()));this.garbageCollectGeo(A,{}),this.ensureAtLeastOneVisibleItem(),xe(this.s("graphing-calculator-narration-items-deleted",{count:new uo(A.length)}));break;case"upward-delete-selected-expression":gL(this,{moveSelection:!1});break;case"downward-delete-selected-expression":mL(this,{moveSelection:!1});break;case"table-show-more-rows":{let w=this.getItemModel(e.id);if(!w||w.type!=="table")return;let B=Wh(w);if(!B)return;ui(this.listModel,w),Zm(w,!0),on(this,{type:"table",id:w.id,location:{row:B.min,column:0}})}break;case"navigate-table-by-key":fU(this,e.id,e.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(e.id,e.setFocusAfterDelete);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(e.id,e.setFocusAfterDelete);break;case"expression-zoom-fit":this._expressionZoomFit(e.id,e.focusAfterTap);break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(e.id,e.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(e.state));break;case"duplicate-expression":{let w=this.getItemModel(e.id);if(!w||w.type==="folder")return;this.copyExpressionToIndex(w,w.index+1)}break;case"duplicate-folder":{let{id:w}=e,B=this.getItemModel(w);if(!B||B.type!=="folder")return;let q=this.createItemModel(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},MD(B,{stripDefaults:!1})),{id:this.generateId()})),M=this.getNumberOfItemsInFolder(w),ae=M+1;this._toplevelInsertItemAt(B.index+ae,q,!1,void 0);let se=B.index+1,ge=se+M;for(let he=se;he<=ge;he++){let ye=Km(this.listModel,he);if(!ye||ye.type==="folder")return;this.copyExpressionToIndex(ye,he+ae,q.id)}}break;case"insert-item-at-index":{let w=this.createItemModel(e.state);this._toplevelInsertItemAt(e.index,w,e.focus,e.folderId)}break;case"new-expression-at-end":{this.setGeoTool("selection");let w=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),Ec(this.listModel,w),Go(this,w.id)}break;case"new-expression":{let w=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-text":{let w=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-folder":{let w=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-images":this._uploadImagesAndWaitForThemToLoad({files:e.files}),this._closeAddExpression();break;case"change-image":this._uploadImagesAndWaitForThemToLoad({files:e.files,id:e.id});break;case"new-table":{let w=this._createTableItem();this._toplevelNewItemAtSelection(w,{shouldFocus:!0}),this._closeAddExpression()}break;case"paste-table":this._pasteTable(e.data);break;case"insert-several-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._insertSeveralExpressions(e.expressions);break;case"append-number-list":this._appendNumberList(e.latex);break;case"remove-item-by-id":Jm(this.listModel,e.id);break;case"replace-item-at-index":{let w=this.createItemModel(e.state);this._toplevelReplaceItemAt(e.index,w,e.focus)}break;case"create-sliders-for-item":this.createSlidersForItem(e.id,e.variables);break;case"create-sliders-for-ticker":this.createSlidersForTicker(e.variables);break;case"convert-image-to-draggable":this.convertImageToDraggable(e.id);break;case"start-dragdrop":{let w=this.getItemModel(e.dragTarget.calcId);if(!w)return;let B={x:0,y:0},q=this.getItemRootNodeById(w.id);if(q){let se=q.getBoundingClientRect();B.y=e.grabPt.y-se.top,B.x=e.grabPt.x-se.left}this.isItemSelected(w.id)?ui(this.listModel,w):ui(this.listModel,void 0);let M=!1,ae=1;w.type==="folder"&&(ae+=this.getNumberOfItemsInFolder(w.id),w.collapsed||(M=!0,Mm(w,!0))),Xb(this.listModel,{firstItemId:w.id,numberOfItems:ae,expandFolder:M,grabOffset:B,mousePt:e.mousePt,dragTarget:e.dragTarget,renderType:e.dragTarget.type,itemTop:0,itemLeft:0}),this.dragdrop_expressions.startDragging(e.mousePt)}break;case"update-dragdrop":{let w=this.listModel.dragState;if(!w)return;Xb(this.listModel,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},w),{mousePt:e.mousePt}))}break;case"stop-dragdrop":{let w=this.listModel.dragState;if(!w)return;let B=this.getItemModel(w.firstItemId);if(!B)return;B.type==="folder"&&w.expandFolder&&Mm(B,!1),Xb(this.listModel,void 0),this.ensureAtLeastOneVisibleItem()}break;case"set-selected-id":{let w=this.getItemModel(e.id);ui(this.listModel,w)}break;case"set-all-selected-ids":gM(this.listModel,e.ids);break;case"toggle-selected-with-multi-select":hM(this.listModel,e.id);break;case"set-selected-index":{let w=this.getItemModelByIndex(e.index);ui(this.listModel,w)}break;case"set-none-selected":ui(this.listModel,void 0);break;case"set-focus-location":{let w=e.location?e.location.type:"";if(w==="expression"&&this.setGeoTool("selection"),w==="table"&&(this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{inEditListMode:!1})),w==="graph-paper"){this.setGraphPaperFocus({isFocused:!0});break}on(this,e.location)}break;case"focus-first-expression":{this.focusFirstExpression();break}case"move-focus-to-item":Go(this,e.id,e.where);break;case"blur-focus-location":this.isFocusLocationFocused(e.location)&&on(this,void 0),((u=e.location)==null?void 0:u.type)==="graph-paper"&&this.setGraphPaperFocus({isFocused:!1});break;case"set-folder-collapsed":{let w=this.getItemModel(e.id);if(!w||w.type!=="folder")return;Mm(w,e.isCollapsed)}break;case"set-all-folders-collapsed":t2(this.listModel,e.isCollapsed);break;case"set-item-secret":{let w=this.getItemModel(e.id);if(!w)return;fM(w,e.isSecret)}break;case"set-item-readonly":{let{id:w,readonly:B}=e,q=this.getItemModel(w);if(!q)return;if(uS(q,B),q.type==="folder")for(let M of TR(this.listModel,w))uS(M,B)}break;case"set-tablecolumn-color":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;M2(w,e.columnId,e.color)}break;case"set-tablecolumn-colorlatex":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;iS(w,e.columnId,e.colorLatex)}break;case"set-show-cdf":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;pF(w,e.showCDF)}break;case"set-cdf-min":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;SD(w,e.latex)}break;case"set-cdf-max":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;ED(w,e.latex)}break;case"toggle-item-hidden":this._toggleItemHidden(e.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(e.tableId,e.columnId);break;case"toggle-item-settings-menu":this.isItemSettingsMenuOpen(e.menu.guid)?this.closeItemSettingsMenu():(this.listModel.openItemMenu=e.menu,e.menu.focusFirstOption&&(e.menu.type==="geo-tool-dropdown"?on(this,{type:"geo-basic-tool-menu-item",tool:e.menu.tools[0]}):e.menu.type==="multi-select-more"||e.menu.type==="multi-select-transformations"?on(this,{type:"generic-menu",where:"start"}):on(this,{type:"expression-menu",id:e.menu.model.id,location:"start"})));break;case"close-item-settings-menu":this.closeItemSettingsMenu();break;case"toggle-fraction-evaluation":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;let B=vp(w);N_(w,!B)}break;case"set-item-label":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;gu(w,e.label),this.enqueueEvent("userEditedLabel",e)}break;case"set-item-showlabel":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;_h(w,e.showLabel),!e.showLabel&&!Dp(w)&&(Kb(w,!1),mD(w,"NONE"))}break;case"set-item-color":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;dD(w,e.color)}break;case"set-item-description":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression"&&w.type!=="image")return;w.type==="expression"?B_(w,e.description):w.type==="image"&&UF(w,e.description)}break;case"set-item-fill":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;FT(w,e.fill),this._setItemHidden(w.id,Rh(w))}break;case"set-image-opacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;zF(w,e.opacity),this._setItemHidden(w.id,!1)}break;case"set-image-in-foreground":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;eM(w,e.foreground)}break;case"image-upload-error":this.__pendingImageUploads[e.token]&&(delete this.__pendingImageUploads[e.token],this._showToast({message:this.s("graphing-calculator-text-toast-image-upload-failed")}));break;case"image-upload-success":{if(this.__pendingImageUploads[e.token])if(delete this.__pendingImageUploads[e.token],e.id){let w=this.getItemModel(e.id);w&&w.type==="image"&&$F(w,e.url)}else{let w=this.createItemModel({type:"image",id:this.generateId(),width:e.width,height:e.height,image_url:e.url,name:e.name});this._toplevelNewItemAtSelection(w,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={})}break;case"image-load-success":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;RD(w,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0}}break;case"image-load-error":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;RD(w,"failed")}break;case"image-retry-loading":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;rM(w)}break;case"set-item-dragmode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Fh(w,e.dragMode)}break;case"set-tablecolumn-dragmode":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;T2(w,e.columnId,e.dragMode),e.dragMode!=="NONE"&&this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-points":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;xM(w,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,yS(w,e.columnId))}break;case"set-tablecolumn-lines":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;I2(w,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,yS(w,e.columnId))}break;case"set-tablecolumn-linestyle":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;V2(w,e.columnId,e.lineStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-linewidth":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;ZD(w,e.columnId,e.lineWidth),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-lineopacity":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;eS(w,e.columnId,e.lineOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointsize":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;tS(w,e.columnId,e.pointSize),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointopacity":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;rS(w,e.columnId,e.pointOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointstyle":{let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;G2(w,e.columnId,e.pointStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-item-points":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;RT(w,e.points),this._setItemHidden(e.id,Rh(w)),!e.points&&w.dragMode!=="NONE"&&Fh(w,"NONE")}break;case"set-item-pointstyle":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;NT(w,e.pointStyle),this._setItemHidden(e.id,!1)}break;case"set-item-lines":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;BT(w,e.lines),this._setItemHidden(e.id,Rh(w))}break;case"set-item-surfaces":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;H_(w,e.surfaces),this._setItemHidden(e.id,Rh(w))}break;case"set-item-linestyle":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;hD(w,e.lineStyle),this._setItemHidden(e.id,!1)}break;case"set-item-arrow-mode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;q_(w,e.value),this._setItemHidden(e.id,!1);break}case"set-item-label-dropdown-open":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;U_(w,e.open)}break;case"set-item-fillopacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;_b(w,e.fillOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-lineopacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Em(w,e.lineOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-pointopacity":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Fb(w,e.pointOpacity),w.showLabel||this._setItemHidden(e.id,!1)}break;case"set-item-pointsize":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Rb(w,e.pointSize),this._setItemHidden(e.id,!1)}break;case"set-item-linewidth":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;km(w,e.lineWidth),this._setItemHidden(e.id,!1)}break;case"set-item-resolution":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;uD(w,e.resolution),this._setItemHidden(e.id,!1)}break;case"set-item-checkers":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;pD(w,e.checkers),this._setItemHidden(e.id,!1)}break;case"set-item-polar-coordinate-system":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;K_(w,e.polarCoordinateSystem),this._setItemHidden(e.id,!1)}break;case"set-item-colorlatex":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Nb(w,e.colorLatex)}break;case"set-item-labelSize":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Bb(w,e.labelSize)}break;case"set-item-labelangle":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;gD(w,e.labelAngle)}break;case"set-item-label-orientation":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;KT(w,e.labelOrientation)}break;case"set-suppress-text-outline":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;z_(w,e.suppressTextOutline)}break;case"set-item-interactive-label":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Kb(w,e.interactiveLabel),e.interactiveLabel&&mD(w,"NONE")}break;case"set-item-editable-label-mode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;w.editableLabelMode!=="NONE"&&e.editableLabelMode!=="NONE"&&w.editableLabelMode!==e.editableLabelMode&&gu(w,""),mD(w,e.editableLabelMode),e.editableLabelMode!=="NONE"&&Kb(w,!1)}break;case"plot-residuals":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;var t=w.formula.regression;if(!t)return;var i=t.residualSuggestionId;if(!i)return;var n=this.getItemModel(i);if(!n)return;fS(n,{latex:__dcg_shared_module_exports__['Ib'](t.residualVariable),columnIndex:n.columnModels.length-1})}break;case"toggle-logmode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;var o=w.isLogModeRegression;_T(w,!o)}break;case"set-item-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;let B=e.latex,q=w.latex;if(this.garbageCollectGeo([],{[w.id]:{prevLatex:q,nextLatex:B}}),(B==='"'||B==="note")&&this.areNotesEnabled()){let M=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(w.index,M,!0)}else if(B==="")wF(w);else if(B==="ticker"&&this.canAddTicker())this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._removeExpressionSynchronously(w);else if(B==="folder"&&this.areFoldersEnabled()){let M=this.createItemModel({id:this.generateId(),type:"folder"});Ua(w)?(this._toplevelNewItemAtSelection(M,{shouldFocus:!0}),ya(w,"")):this._toplevelReplaceItemAt(w.index,M,!0)}else if(B==="table"){let M=this._createTableItem();this._toplevelReplaceItemAt(w.index,M,!0)}else!this.isGeometry()&&(B==="betchacant"||B==="pride"||B==="teapot"&&this.is3dProduct())?this.runAfterDispatch(()=>{this.triggerEasterEgg&&this.triggerEasterEgg(B)}):(ya(w,B),this.lastUserUpdatedExpressionItem=w)}break;case"set-visualization-prop":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;D_(w,e.prop,e.value)}break;case"set-clickableinfo-prop":{let w=this.getItemModel(e.id);if(!w)return;w.type==="expression"?S_(w,e.prop,e.value):w.type==="image"&&ND(w,e.prop,e.value)}break;case"set-clickableinfo-rule-latex":{let w=this.getItemModel(e.id);if(!w)return;w.type==="expression"?nD(w,e.latex):w.type==="image"&&ZF(w,e.latex)}break;case"set-folder-title":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="folder")return;DF(w,e.title)}break;case"set-image-mq-attribute":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;qa(w,e.attribute,e.latex)}break;case"set-image-name":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;HF(w,e.name)}break;case"set-image-draggable":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;let B=Am(w);if(!B)return;ZT(w,e.draggable),e.draggable&&(rn(B)==="NONE"||B.dragMode==="AUTO")&&Fh(B,"XY")}break;case"set-graph-settings":{let w=!this.isThreeDMode();"threeDMode"in e&&e.threeDMode&&w&&((p=this.grapher3d)==null||p.controls.prepareTransitionFrom2Dto3D());for(let q in e)q!=="type"&&(q==="xAxisScale"?this.switchAxisScale("xAxisScale",e.xAxisScale):q==="yAxisScale"?this.switchAxisScale("yAxisScale",e.yAxisScale):this.graphSettings.setProperty(q,e[q]));this.grapher3d&&this.isThreeDMode()&&(this.grapher2d.redrawAllLayersSynchronously(),"backgroundColor3d"in e&&this.grapher3d.webglLayer.setBackgroundColor(e.backgroundColor3d)),(w||!("threeDMode"in e))&&this.apply3dProps(e)}break;case"set-polar-mode":if(this.graphSettings.setProperty("polarMode",e.polarMode),e.polarMode){let w=this.graphSettings.xAxisScale==="logarithmic"||this.graphSettings.yAxisScale==="logarithmic",B=this.getGrapher2d();w&&B&&(this.graphSettings.setProperty("xAxisScale","linear"),this.graphSettings.setProperty("yAxisScale","linear"),B.viewportController.setViewport(B.getDefaultViewport()),B.getProjection().updateScalePairs())}break;case"set-polar-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Ib(w,e.latex)}break;case"set-polar-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Ab(w,e.latex)}break;case"set-parametric-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Vb(w,e.latex)}break;case"set-parametric-domain3Du-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Tb(w,e.latex)}break;case"set-parametric-domain3Dv-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Mb(w,e.latex)}break;case"set-parametric-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Lb(w,e.latex)}break;case"set-parametric-domain3Du-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Ob(w,e.latex)}break;case"set-parametric-domain3Dv-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Pb(w,e.latex)}break;case"set-note-text":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="text")return;VF(w,e.text)}break;case"set-edit-list-mode":{let w=Wm(this.listModel);if(this.setEditListMode(e.isEditListMode),e.focusExpressionList){if(w===void 0&&(w=this.getItemModelByIndex(0)),!w)return;Go(this,w.id,w.type==="table"&&e.isEditListMode?"container":"start")}else ui(this.listModel,void 0),on(this,void 0)}break;case"set-ghost-mode":this.getGraphSettings().config.setProperty("ghostMode",e.value);break;case"set-projector-mode":this.getGraphSettings().config.setProperty("projectorMode",e.value),this.isThreeDMode()&&this.grapher2d.redrawAllLayersSynchronously();break;case"set-inverted-colors":this.getGraphSettings().config.setProperty("invertedColors",e.value);break;case"set-tablecell-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.tableId);if(!w||w.type!=="table")return;yu(w,e.cell,e.latex)}break;case"set-state":this.externalSetState(e.state,e.opts);break;case"set-blank":this.externalSetState(this.getBlankState({degreeMode:e.degreeMode}),e.opts);break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges",e);break;case"reset-graph":{let w=this.getState();this.externalSetState(this.graphSettings.defaultState,{allowUndo:!0});let B=this.getItemModelByIndex(0);B&&Go(this,B.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-reset"),undoCallback:()=>this.dispatch({type:"set-state",state:w,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"clear-graph":{if(this.triggerClearGraph){this.runAfterDispatch(()=>this.triggerClearGraph());return}let w=this.getState();this.externalSetState(this.getBlankState(),{allowUndo:!0});let B=this.getItemModelByIndex(0);B&&Go(this,B.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-cleared"),undoCallback:()=>this.dispatch({type:"set-state",state:w,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"on-evaluator-changes":{if(this.onEvaluatorChangesSpy&&this.onEvaluatorChangesSpy(e.changes,e.timingData,e.graphData,e.eventUpdates),QR(this.listModel,e.changes),!e.graphData)break;for(let w in e.graphData.addedGraphs){let B=e.graphData.addedGraphs[w];if(__dcg_shared_module_exports__['Ub'](B)){let q=B.filter(ae=>!__dcg_shared_module_exports__['ic'](ae.graphMode)),M=B.filter(ae=>__dcg_shared_module_exports__['ic'](ae.graphMode));(g=this.grapher2d)==null||g.updateSketch(w,q),(h=this.grapher3d)==null||h.updateSketch(w,M),XR(this.listModel,w,B)}}for(let w in e.graphData.removedGraphs)(b=this.grapher2d)==null||b.removeGraphSketch(w),(C=this.grapher3d)==null||C.removeGraphSketch(w);if(this.isThreeDMode())(D=this.grapher2d)==null||D.redrawAllLayersSynchronously();else{for(let w in e.graphData.intersections){let B=e.graphData.intersections[w];__dcg_shared_module_exports__['Ub'](B)&&((S=this.grapher2d)==null||S.updateIntersections(w,B))}(V=this.get2dPOIController())==null||V.handleTraceUpdate()}if(e.eventUpdates){let w=!1;for(let B in e.eventUpdates.updates)if(this.doesIdentifierBlockActionUpdate(B)){w=!0;break}if(!w){for(let B in e.eventUpdates.updates)this.updateLatexForIdentifier(B,e.eventUpdates.updates[B]);e.eventUpdates.objectClicked&&this.enqueueEvent("userClickedObject",e),this.onActionUpdatesAppliedSpy&&this.onActionUpdatesAppliedSpy(e.eventUpdates)}}}break;case"add-helper-expression":BR(this.listModel,e.state);break;case"tick":this._tickSliders(e.time);break;case"tick-ticker":this.tickTicker(e.time);break;case"adjust-slider-by-keyboard":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;f_(w,e.adjustment)}break;case"adjust-slider-by-dragging-thumb":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;y_(w,e.target)}break;case"set-slider-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Cm(w,e.latex)}break;case"set-slider-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Dm(w,e.latex)}break;case"set-slider-steplatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Gb(w,e.latex)}break;case"set-slider-dragging":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;kb(w,e.dragging)}break;case"play-slider-from-min":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;let B=yl(w);if(isNaN(B))return;let q=bp(w.latex,B);Ka(w,!1),ya(w,q),Ka(w,!0)}break;case"set-slider-isplaying":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;Ka(w,e.isPlaying)}break;case"set-slider-loopmode":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;F_(w,e.loopMode)}break;case"set-slider-animationperiod":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression")return;R_(w,e.animationPeriod)}break;case"show-expressions-list":this._showExpressions(e.focusHideIcon);break;case"hide-expressions-list":this._hideExpressions(e.focusShowIcon);break;case"open-drawer":this.enqueueEvent("openDrawer",e);break;case"re-randomize":this.setRandomSeed(Rd());break;case"resize-exp-list":this._setExpListWidth(e.expListWidth);break;case"toast/show":this._showToast(e.toast);break;case"toast/close":this.closeToast();break;case"toast/undo":let R=this.toastData.undoCallback;R&&this.runAfterDispatch(R),this.toastData={};break;case"toast/learn-more":let P=this.toastData.learnMoreCallback;P&&this.runAfterDispatch(P),this.toastData={};break;case"start-moving-points":AK(this,this.listModel,e.points);break;case"stop-moving-points":OK(this,e.points);break;case"on-move-points":LK(this,e.points,e.previousScreenPts,e.screenPts,e.projection,e.transform,e.keyboardDirection)&&this.enqueueEvent("userMovedPoint",e);break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(e.viewport);break;case"commit-user-requested-rotation":this.graphSettings.setProperty("worldRotation3D",e.worldRotation3D),this.graphSettings.setProperty("axis3D",e.axis3D),this.graphSettings.setProperty("speed3D",e.speed3D);break;case"toggle-lock-viewport":this.graphSettings.setProperty("userLockedViewport",!this.graphSettings.userLockedViewport);break;case"set-axis-limit-latex":this._setAxisLimitLatex(e.limit,e.latex),this.lastDirectlyEditedViewport=(k=this.getGrapher())==null?void 0:k.getCurrentViewport();break;case"toggle-graph-settings":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{graphSettingsOpen:!this.layoutModel.graphSettingsOpen}),ui(this.listModel,void 0),e.focusOnOpen&&(this.layoutModel.graphSettingsOpen?this.getGraphSettings().config.projectorMode?on(this,{type:"settings",location:"large-size"}):on(this,{type:"settings",location:"default-size"}):on(this,{type:"settings",location:"icon"}));break;case"close-graph-settings":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{graphSettingsOpen:!1}),e.focusIconAfterClose&&on(this,{type:"settings",location:"icon"});break;case"toggle-add-expression":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{addExpressionOpen:!this.layoutModel.addExpressionOpen}),e.focusOnOpen&&this.layoutModel.addExpressionOpen&&on(this,{type:"add-expression-btn"});break;case"close-add-expression":this._closeAddExpression(),e.focusIconAfterClose&&on(this,{type:"add-item-btn"});break;case"ui/container-resized":this.layoutMeasurements={width:e.size.width,height:e.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"expression-size-exceeded":this._showToast({message:this.s("graphing-calculator-text-toast-expression-size-limit")});break;case"keypad/set-layout":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:e.layout,keypadFunctionsOpen:!1});break;case"keypad/set-minimized":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadMinimized:e.minimized,keypadLayout:"mainNumbers"}),this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||hU(this),xe(e.minimized?this.s("graphing-calculator-narration-keypad-hidden"):this.s("graphing-calculator-narration-keypad-visible"));break;case"keypad/type-text":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let w=it.getFocusedMathquill();w&&it.canAcceptText(w,this.getCapExpressionSize(),e.text)&&(w.typedText(e.text),it.simulateUserChangedLatex(w))});break;case"keypad/press-key":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let w=it.getFocusedMathquill();w&&it.simulateKeypress(w,e.key)});break;case"keypad/audio-trace":this.handleAudioTraceCommand(e.command);break;case"set-audio-trace-speed":this.setAudioTraceSpeed(e.speed);break;case"keypad/custom-command":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let w=it.getFocusedMathquill();w&&(Rf(w,e.command),it.simulateUserChangedLatex(w))});break;case"keypad/shift":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:yU(this.getKeypadLayout()),keypadFunctionsOpen:!1});break;case"keypad/123":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:"mainNumbers",keypadFunctionsOpen:!1});break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:"letters",keypadFunctionsOpen:!1}):this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1});break;case"keypad/audio":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadMinimized:!1,keypadLayout:"audio",keypadFunctionsOpen:!1});break;case"keypad/functions":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()});break;case"grapher/drag-start":break;case"grapher/drag-move":break;case"grapher/drag-end":break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.listModel.openItemMenu=void 0,this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{isFileDraggedOver:!0});break;case"file-is-not-dragged-over":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{isFileDraggedOver:!1});break;case"zoom":(T=this.getGrapher())==null||T.viewportController.zoom(e.direction);break;case"set-hovered-image":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;ND(w,"hoveredImage",e.url)}break;case"set-depressed-image":{let w=this.getItemModel(e.id);if(!w||w.type!=="image")return;ND(w,"depressedImage",e.url)}break;case"clickable-item-clicked":this.handleClickableItemClicked(e.id,e.listIndex);break;case"action-single-step":{let w=this.getItemModel(e.id);if(!w||w.type!=="expression"||!w.formula.action_value)return;this.evaluator.addActionStepEvent(w.id)}break;case"update-expression-search-str":this.updateExpressionSearchStr(e.str);break;case"update-expression-replace-str":this.updateExpressionReplaceStr(e.str);break;case"rename-identifier-global":this.suggestedIdentifierRename=void 0,Gp(this.listModel,e.search,e.replace);break;case"rename-identifier-in-item":this.suggestedIdentifierRename=void 0;let W=this.getItemModel(e.id);W&&W.type==="folder"?Gp(this.listModel,e.search,e.replace,{limitToFolder:e.id}):Gp(this.listModel,e.search,e.replace,{limitToItem:e.id});break;case"update-ticker-handlerlatex":this.updateTickerHandlerLatex(e.latex);break;case"update-ticker-minsteplatex":this.updateTickerMinStepLatex(e.latex);break;case"set-braille-mode":this.setBrailleMode(e.mode);break;case"set-six-key-input":this.setSixKeyInput(e.useSixKeyInput);break;case"set-show-constructions-open":if(this.showConstructionsOpen=e.open,e.setFocus)if(!e.open)on(this,{type:"geo-show-constructions-icon"});else for(let w in this.cachedGeoTokenInfo){let{calcId:B}=this.cachedGeoTokenInfo[w];if(this.getItemModel(B)){on(this,{type:"geo-token",identifier:w});break}}break;case"select-geo-tool":this.listModel.openItemMenu=void 0,this.clearRecentlyUsedComplexTool(),this.setGeoTool(e.tool),__dcg_shared_module_exports__['Xb'](e.tool)||e.tool==="selection"||ui(this.listModel,void 0),e.focusGraphPaper&&this.setGraphPaperFocus({isFocused:!0}),this.closeToast();break;case"cancel-geo-toolplay":this.cancelGeoToolplay();break;case"commit-geo-objects":{let w=[],B=[];var s=this.findLastSubscriptForLetters(),a={};let q=ge=>{let he=a[ge];if(he)return he.assignmentLatex;let ye=this.getItemModel(ge);if(!ye||ye.type!=="expression")return ge;var fe=this._autoNameExpression(ye,s);return he=a[ge]={model:ye,assignmentLatex:fe},he.assignmentLatex},M=[];for(let ge in e.committed){var l=e.committed[ge];__dcg_shared_module_exports__['Xb'](l.type)&&M.push(ge);var c=sA(l,!0,q);c&&(c.sliderInfo?B.push({latex:c.latex,color:c.color,sliderInfo:c.sliderInfo}):w.push(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},c),{tokenId:ge})))}let ae=this.listModel.__toolPreviewIdToModel;if(w.length){let ge=this.getGeometryFolder(),he=ge?ge.index+this.getNumberOfItemsInFolder(ge.id)+1:0;w.forEach(ye=>{var Se;let fe;for(let de in ae){let Ee=ae[de];if(((Se=jo(Ee))==null?void 0:Se.latex)===ye.tokenId){fe=Ee;break}}fe?(fe.latex=ye.latex,fe.color=ye.color,fe.showLabel=!!ye.showLabel,fe.showAngleLabel=ye.showAngleLabel!==!1,ge&&(fe.folderId=ge.id)):fe=this.createItemModel({id:this.generateId(),type:"expression",showLabel:ye.showLabel,showAngleLabel:ye.showAngleLabel,latex:ye.latex,folderId:ge&&ge.id,color:ye.color}),ge?(xl(this.listModel,fe,he),he+=1):Ec(this.listModel,fe),this.getGeoModel().recordCommittedOutput(fe.id),this.recordComplexToolUse()})}B.forEach(ge=>{let he;for(let ye in ae){let fe=ae[ye];if(fe.latex===ge.latex){he=fe;break}}he?(he.latex=ge.latex,he.color=ge.color,Cm(he,ge.sliderInfo.min),Dm(he,ge.sliderInfo.max)):he=this.createItemModel({id:this.generateId(),type:"expression",latex:ge.latex,color:ge.color,slider:{hardMin:!0,hardMax:!0,min:ge.sliderInfo.min,max:ge.sliderInfo.max}}),xl(this.listModel,he,0),this.getGeoModel().recordCommittedOutput(he.id)}),M.length===1&&this.transformAllSelectedItemsByAssignmentLatex(M[0]),this.geoModel.isCurrentToolSingleUse()&&this.setGeoTool("selection");let se=e.toolIdToLatex[1];if(this.geoModel.getToolMode()==="expression-edit"&&se){let ge=oA(se,q);this.writeIdentifierIntoCurrentMathquill(ge)}this.isGeometry()&&this.getGeoModel().updateFadeAnimations()}break;case"rename-identifier":{let w=e.from,B=e.to,q=__dcg_shared_module_exports__['Kb'](w),M=this.getGeometryFolder();M&&this.getItemsByIdentifier(q).forEach(ae=>{e.geoFolder&&ae.folderId!==M.id?(us(ae,M.id),Ip(this.listModel,ae.index,M.index+1,1)):!e.geoFolder&&ae.folderId===M.id&&(Ip(this.listModel,ae.index,M.index+this.getNumberOfItemsInFolder(M.id),1),us(ae,""))}),Gp(this.listModel,w,B)}break;case"set-active-token":this.activeTokens[e.style]=e.identifier;break;case"unset-active-token":this.activeTokens[e.style]===e.identifier&&(this.activeTokens[e.style]=void 0);break;case"select-expression-that-defines-token":{let w=this.getExpressionIdForIdentifier(e.identifier);if(!w||(this.setGeoTool("selection"),this.isItemNotSelectableBecauseItsSecret(w)))return;e.multiSelectMode||e.toggle?hM(this.listModel,w):this.tryInsertTokenIntoMathquill(w,void 0)||ui(this.listModel,this.getItemModel(w))}break;case"close-expression-search":this.expressionSearchOpen=!1,this.updateExpressionSearchStr("");let H=this.getItemModelByIndex(0);H&&Go(this,H.id,"end");break;case"open-expression-search":this.expressionSearchOpen=!0,this.focusLocation={type:"search-expressions"};let j=e.latex;e.rename&&!ga(j)&&(j="");let ne=e.rename?j?`\\operatorname{rename}\\ ${j}\\to`:"\\operatorname{rename}\\ ":j;this.updateExpressionSearchStr(ne);break;case"open-ticker":this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._closeAddExpression();break;case"close-ticker":this.listModel.ticker.open=!1,this.listModel.ticker.playing=!1,this.listModel.ticker.minStepLatex="",this.listModel.ticker.handlerLatex="";break;case"toggle-ticker":this.listModel.ticker.playing=!this.listModel.ticker.playing,this.listModel.ticker.lastTickTime=void 0,this.pauseAllSliders();break;case"set-tool-preview-state":this.setToolPreviewState(e.state);break;case"apply-transformation-to-selected":this.transformAllSelectedItemsByAssignmentLatex(e.assignmentLatex),this.closeItemSettingsMenu();break;case"dismiss-geo-notice":this.showGeoNotice=!1,e.focusFirstExpression&&this.focusFirstExpression();break;case"set-geometry-toolbar":{DR(this.geometryToolbarModel,e.toolbar);break}case"set-geometry-custom-toolbar-setting":{HD(this.geometryToolbarModel,e.tool,e.value);break}case"set-author-mode":{this.setAuthorMode(e.enabled);break}default:return e}}switchAxisScale(e,t){var n;if(!t||t===this.graphSettings[e])return;this.graphSettings.setProperty("polarMode",!1);let i;this.getAllItemModels().forEach(o=>{if(this.isExpressionZoomFit(o)){if(!this.getBoundingBoxesForZoomFit(o))return;i=o.id}}),this.graphSettings.setProperty(e,t),(n=this.getGrapher2d())==null||n.getProjection().updateScalePairs(),!(i&&this._expressionZoomFit(i,!1,!0))&&this.enforceAxisLimitsForScale(e)}clearRecentlyUsedComplexTool(){clearTimeout(this.recentlyCompletedComplexToolTimeout),this.recentlyCompletedComplexToolTimeout=void 0}recordComplexToolUse(){let e=this.getActiveTool();ux(e)&&(clearTimeout(this.recentlyCompletedComplexToolTimeout),this.recentlyCompletedComplexToolTimeout=setTimeout(()=>{this.recentlyCompletedComplexToolTimeout=void 0,this.dispatch({type:"render"})},2e3))}getComplexToolWasRecentlyUsed(){return!!this.recentlyCompletedComplexToolTimeout}enforceAxisLimitsForScale(e){let t=this.getGrapher2d();if(!t)return;let i=t.getDefaultViewport();if(!i)return;e==="xAxisScale"?(this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['Hb'](i.xmin)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['Hb'](i.xmax))):(this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['Hb'](i.ymin)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['Hb'](i.ymax))),this.graphSettings.xAxisScale===this.graphSettings.yAxisScale&&(this.graphSettings.setProperty("lastChangedAxis",e==="xAxisScale"?"y":"x"),t.viewportController.zoomSquareImmediately(),this.markSquareAxesAfterUserEditedViewport());let n=t.viewportController.getViewport(),o=t.getProjection(),{xmin:s,xmax:a,ymin:l,ymax:c}=n,u=this.getGraphSettings().config.logScales;if(e==="xAxisScale"&&u){let p=o.mapx(s),g=o.mapx(a),h=Li(o.reverse_mapx(p-.25),o.reverse_mapx(p+.25)),b=Li(o.reverse_mapx(g-.25),o.reverse_mapx(g+.25));this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['Hb'](h)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['Hb'](b))}if(e==="yAxisScale"&&u){let p=o.mapy(l),g=o.mapy(c),h=Li(o.reverse_mapy(p-.25),o.reverse_mapy(p+.25)),b=Li(o.reverse_mapy(g-.25),o.reverse_mapy(g+.25));this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['Hb'](h)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['Hb'](b))}this.lastDirectlyEditedViewport=t.getCurrentViewport()}updateGraphSettingsViewportLimitsLatex(e){this._setAxisLimitLatex("xmin",e.xmin+""),this._setAxisLimitLatex("xmax",e.xmax+""),this._setAxisLimitLatex("ymin",e.ymin+""),this._setAxisLimitLatex("ymax",e.ymax+""),this._setAxisLimitLatex("zmin",e.zmin+""),this._setAxisLimitLatex("zmax",e.zmax+"")}transformAllSelectedItemsByAssignmentLatex(e){var g,h;let t=JD(this.listModel),i=this.findLastTokenNumber()+1,n=this.findLastSubscriptForLetters(),o=this.getGeometryFolder(),s=o?o.index+this.getNumberOfItemsInFolder(o.id)+1:0,a={};for(let b of t){if(b.type!=="expression")continue;var l=b.formula.geometry;if(!l)continue;var c=(g=b.formula.typed_constant_value)==null?void 0:g.valueType;if(!c||__dcg_shared_module_exports__['zb'](c,__dcg_shared_module_exports__['nb']))continue;var u=(h=jo(b))==null?void 0:h.latex;u||(u=this._autoNameExpression(b,n));let C=`\\token{${i}}`;i+=1;let D=`${C}=${e}\\left(${u}\\right)`,S=this.createItemModel({id:this.generateId(),type:"expression",showLabel:b.showLabel&&!b.label,showAngleLabel:b.showAngleLabel&&!b.label,latex:D,folderId:o&&o.id,color:b.color});a[S.id]=!0,o?(xl(this.listModel,S,s),s+=1):Ec(this.listModel,S)}let p=Object.keys(a);if(p.length&&gM(this.listModel,a),p.length===1){let b=p[0];this.runAfterDispatch(()=>{this.getItemModel(b)&&this.get2dPOIController().keyboardAttentionManager.updateKeyboardAttention({calcId:b,listIndex:void 0,polygonEdge:void 0},{describe:!1})})}}convertToTokenAssignment(e,t=""){var o;let i=(o=jo(e))==null?void 0:o.latex,n=t?Db(t)||"":"\\token{"+(this.findLastTokenNumber()+1)+"}";i?Gp(this.listModel,i,n):ya(e,n+"="+e.latex)}convertToNamedAssignment(e,t=""){let i=LT(e);if(!i)return;let n=t?Db(t):this.getAutonameLatexForExpression(e);n?Gp(this.listModel,i,n):ya(e,t)}getAutonameLatexForExpression(e,t){if(t||(t=this.findLastSubscriptForLetters()),OT(e)==="point"&&e.label&&ga(e.label)&&this.countGlobalIdentifierOccurences(e.label)===0)return e.label;var i=A_(e),n=(t[i]||0)+1;return t[i]=n,i+"_{"+n+"}"}_autoNameExpression(e,t){let i=this.getAutonameLatexForExpression(e,t);return ya(e,i+"="+e.latex),i}isGeoToolVisible(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:Kh(this.geometryToolbarModel,e)}isGeoToolEnabled(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:_m(this.geometryToolbarModel,e)}isSomeTransformToolVisible(){return Hf.some(e=>this.isGeoToolVisible(e))}setGeoTool(e){if(!this.geoUIActive||this.activeTool===e||!this.isGeoToolEnabled(e))return;SR(this.geometryToolbarModel,e,this.shouldShowAuthorFeatures()),this.activeTool=e,this.getGeoModel().setToolMode(e),this.cancelGeoToolplay()}cancelGeoToolplay(){var t;let e=this.getGeoModel();e.cancelToolplay(),e.deselectAllObjects(),this.setToolPreviewState({}),(t=this.get2dPOIController())==null||t.cancelGeoToolplay()}setToolPreviewState(e){var i;this.toolPreviewJSONState=e;var t=this.listModel.__toolPreviewIdToModel;this.listModel.__toolPreviewIdToModel={};for(let n in e){let o=e[n],s=sA(o,!1);if(!s)continue;let a;for(let l in t){let c=t[o.type==="expression-edit-preview-latex"?Bm:l];if(((i=jo(c))==null?void 0:i.latex)===n){a=c;break}}a?(a.latex=s.latex,a.color=s.color,a.showAngleLabel=!!s.showAngleLabel,a.hidden=o.hidden):a=lD({id:o.type==="expression-edit-preview-latex"?Bm:this.generateId(),type:"expression",color:s.color,latex:s.latex,showAngleLabel:!!s.showAngleLabel,hidden:o.hidden},this),this.listModel.__toolPreviewIdToModel[a.id]=a}}isGeoItem(e){let t=this.getItemModel(e);return t&&t.type==="expression"&&t.formula&&t.formula.geometry&&!t.formula.error}getSelectedGeoExpression(){var e=this.getSelectedItem();if(e&&this.isGeoItem(e.id)&&e.type==="expression")return e}getGeometryFolder(){let e=this.getItemModel(__dcg_shared_module_exports__['Jc']);return e&&e.type==="folder"?e:void 0}isItemInGeoFolder(e){var t=this.getItemModel(e);return!t||t.type==="folder"?!1:t.folderId===__dcg_shared_module_exports__['Jc']}isGeoFolder(e){return e.id===__dcg_shared_module_exports__['Jc']}isItemNotSelectableBecauseItsSecret(e){return!(this.shouldShowAuthorFeatures()||this.isItemInGeoFolder(e)||!this.isItemSecret(e))}pauseAllSliders(){this.getPlayingSliders().forEach(e=>{Ka(e,!1)})}countGlobalIdentifierOccurences(e){return _R(this.listModel,e)}handleClickableItemClicked(e,t){let i=this.getItemModel(e);Ym(i)&&this.evaluator.addClickEvent(i.id,t)}canAddTicker(){return!this.getTickerOpen()}countIdentifierAssignments(e){return $m(this.listModel,e).length}doesIdentifierBlockActionUpdate(e){var t=this.getFocusLocation(),i=$m(this.listModel,e);for(let n of i)if((t==null?void 0:t.type)==="expression"&&t.id===n.id||P_(n))return!0;return!1}getItemsByIdentifier(e){return $m(this.listModel,e)}isAtLeastOnePointSelected(){let e=this.getAllSelectedItems();for(var t=0;t<e.length;t++){let i=e[t];if(i.type==="expression"&&Kl(i))return!0}return!1}toggleLabelForAllSelectedObjects(){let e=[],t=[];this.getAllSelectedItems().forEach(n=>{n.type==="expression"&&Kl(n)&&(n.showLabel?t.push(n):e.push(n))});let i=/^([A-Z])([0-9]*)$/;if(e.length){let n=0;this.getAllItemModels().forEach(o=>{if(o.type!=="expression"||!o.showLabel||!o.label)return;let s=o.label.match(i);if(!s)return;let a=s[1].charCodeAt(0)-65;s[2]&&(a+=parseInt(s[2])*26),a>=n&&(n=a+1)}),e.forEach(o=>{if(!o.label){let s=n;n++;let a=String.fromCharCode(s%26+65),l=Math.floor(s/26),c=l>0?l+"":"";gu(o,a+c)}_h(o,!0)})}else t.length&&t.forEach(n=>{i.test(n.label)&&gu(n,""),_h(n,!1)})}updateLatexForIdentifier(e,t){var i=$m(this.listModel,e);if(i.length===1){var n=i[0];n.slider.isPlaying?(Ka(n,!1),ya(n,t),Ka(n,!0)):ya(n,t)}}updateExpressionSearchStr(e){this.rawExpressionSearchStr=e;let t="\\operatorname{rename}";if(e.indexOf(t)===0){let n=e.slice(t.length).replace(/\\ /g,"").split(/\\to(?![a-zA-Z])/);n.length===2?(this.expressionSearchStr=n[0],this.isExpressionSearchStrValidForReplace=ga(this.expressionSearchStr),this.updateExpressionReplaceStr(n[1])):(this.expressionSearchStr=n[0],this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""));let o=OR(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?o:0}else this.expressionSearchStr=e.length>1&&"rename".indexOf(e)===0?"":e,this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""),this.filterItemsBySearch()}filterItemsBySearch(){if(!this.getExpressionReplaceStr()){let e=PR(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?e:0}}updateExpressionReplaceStr(e){this.expressionReplaceStr=e,this.isExpressionReplaceStrValidForReplace=ga(e)}getIsExpressionSearchStrValidForReplace(){return this.isExpressionSearchStrValidForReplace}getIsExpressionReplaceStrValidForReplace(){return this.isExpressionReplaceStrValidForReplace}isSearchReplaceValid(){return this.getIsExpressionSearchStrValidForReplace()&&this.getIsExpressionReplaceStrValidForReplace()}shouldShowReplaceIcon(){return this.isSearchReplaceValid()}updateTickerHandlerLatex(e){this.listModel.ticker.handlerLatex=e}updateTickerMinStepLatex(e){this.listModel.ticker.minStepLatex=e}getRawExpressionSearchStr(){return this.rawExpressionSearchStr||""}getExpressionSearchStr(){return this.expressionSearchStr||""}getExpressionReplaceStr(){return this.expressionReplaceStr||""}getExpressionSearchCount(){return this.expressionSearchCount||0}getTicker(){return this.listModel.ticker}getTickerHandlerLatex(){return this.listModel.ticker.handlerLatex||""}getTickerMinStepLatex(){return this.listModel.ticker.minStepLatex||""}getTickerAvgDelta(){return this.listModel.ticker.avgDelta}getBrailleMode(){return this.graphSettings.config.brailleMode}setBrailleMode(e){this.graphSettings.config.setProperty("brailleMode",e)}getSixKeyInput(){return this.graphSettings.config.sixKeyInput}setSixKeyInput(e){this.graphSettings.config.setProperty("sixKeyInput",e)}getBrailleControls(){return this.graphSettings.config.brailleControls}setBrailleControls(e){this.graphSettings.config.setProperty("brailleControls",e)}getAudio(){return this.graphSettings.config.audio}setAudio(e){this.graphSettings.config.setProperty("audio",e)}setEditListMode(e){this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{inEditListMode:e})}generateTableXSubscript(){return WD(this.listModel)}findLastTokenNumber(){return FR(this.listModel)}findLastSubscriptForLetters(){return RR(this.listModel)}_createTableItem(){let e=this.generateTableXSubscript(),t=wM(e,[[],[]],this);return this.createItemModel(t)}_populateSettingsViewLimitLatex(){let e=this.getGrapher();if(!e)return;let t=e.getCurrentViewport();this.isGraphSettingsOpen()&&__dcg_shared_module_exports__['G'](t,this.lastDirectlyEditedViewport)||(this.settingsViewModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.settingsViewModel),{limitLatex:vU(t,{steps:this.getAxisStepSettings(),scales:this.getAxisScaleSettings()})}))}getAxisStepSettings(){return{xAxisStep:this.graphSettings.xAxisStep,yAxisStep:this.graphSettings.yAxisStep}}getAxisScaleSettings(){return{xAxisScale:this.graphSettings.xAxisScale,yAxisScale:this.graphSettings.yAxisScale}}getDefaultAxisScaleSettings(){var t,i;let{defaultState:e}=this.graphSettings;return{xAxisScale:((t=e==null?void 0:e.graph)==null?void 0:t.xAxisScale)||"linear",yAxisScale:((i=e==null?void 0:e.graph)==null?void 0:i.yAxisScale)||"linear"}}getSettingsViewModel(){return this.settingsViewModel}getListModel(){return this.listModel}getGeometryToolbarModel(){return this.geometryToolbarModel}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return this.getGraphSettings().getBackgroundColor()}getTextColor(){return this.getGraphSettings().getTextColor()}getPillboxBackgroundColor(){return __dcg_shared_module_exports__['Q'](this.getBackgroundColor(),-.07)}subToChanges(e){let t=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[t]=e,()=>{delete this.subscriptions[t]}}updateTheComputedWorld(){var u,p,g,h,b,C,D;qh(this.listModel);let t=this.getSelectedItem()&&this.activeTool==="expression-edit"&&this.listModel.__toolPreviewIdToModel[Bm]&&((u=this.getGrapher())!=null&&u.graphSketches[Bm])?"preview":"actual";NR(this.listModel,t),(p=this.grapher2d)==null||p.setSketchOrder(this.listModel.drawOrder),(g=this.grapher3d)==null||g.setSketchOrder(this.listModel.drawOrder);let i={},n=S=>{var k;let V=(k=jo(S))==null?void 0:k.identifier;V&&(V[0]==="$"||S.formula.geometry)&&V&&(i[V]?i[V].multiple=!0:i[V]={model:S,multiple:!1})};for(let S of this.getAllToolPreviewItems())PT(S),n(S);for(let S of this.getAllItemModels())switch(S.type){case"expression":PT(S),n(S);break;case"image":WF(S);break;case"table":x2(S);break;case"folder":vF(S);break;case"text":MF(S);break;default:return S}this.geoUIActive=this.isGeometry()&&!this.getGraphSettings().config.hideGeoUI,this.cachedGeoTokenInfo={};for(let S in i){let{multiple:V,model:k}=i[S],T="blue",A="unknown",R="unknown",P=!1,W=!1,H=!1,j=Ba(k);!V&&k?(T=kc(k),P=M_(k),R=O_(k),A=OT(k),k.error&&(W=!0,T="#")):(A="error",W=!0),A&&k?this.isItemSelected(k.id)&&(H=!0):W=!0;let ne=xw(k,this,{includeDetails:!1}),le=(k==null?void 0:k.label)||"";this.cachedGeoTokenInfo[S]={groupType:A,iconType:R,isList:P,hasError:W,color:T,isSelected:H,isHidden:j,description:ne,label:le,calcId:k&&k.id||""}}this.cachedGeoTokenDepths={};let{createdDepth:o,firstReferencedDepth:s}=this.geoModel.getComputedBoard().getDepthValues();for(let S in this.cachedGeoTokenInfo){let{calcId:V}=this.cachedGeoTokenInfo[S],k=this.getItemModel(V);if(!k)continue;let T=S;if(!(S in o)&&k.type==="expression"&&(V===this.getDraggedItemId()||k===this.getFocusedItem())){let j=k.formula.assignment;j&&j in o&&(T=j)}let A=o[T]||0,R=s[T];R=isFinite(R)?R:0;let P=Math.max(A,R-1)+"",W=this.cachedGeoTokenDepths[P];W||(W=[],this.cachedGeoTokenDepths[P]=W);let H=this.cachedGeoTokenInfo[S];W.push({color:H.color,groupType:H.groupType,identifier:S,calcId:V})}cR(this.listModel.ticker);let a=this.getFocusLocation();if(a&&a.type==="expression"&&a.isFakeGraphFocus&&(this.getValidCursorContext()||on(this,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{isFakeGraphFocus:void 0}))),this.isCurrentFocusLocationValid()||on(this,void 0),this.listModel.openItemMenu){let S=this.getOpenMenuIcon();document.body&&S&&document.body.contains(S)||(this.listModel.openItemMenu=void 0)}let l=this.getSelectedItem();l&&!this.getItemModel(l.id)&&ui(this.listModel,void 0),this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.propagateActiveTokens(),this.isKeypadOpen()||(this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1})),this.updateSuggestedIdentifierRenameInfo(),this.isGeometry()&&l&&l.type==="expression"?this.getValidCursorContext()?(this.setGeoTool("expression-edit"),this.geoModel.updateFadeAnimations()):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection");let c=this.getValidCursorContext();this.isGeometry()&&this.getGeoModel().getToolMode()==="expression-edit"&&!__dcg_shared_module_exports__['G'](c,this.lastCursorContext)&&this.runAfterDispatch(()=>{var S;(S=this.get2dPOIController())==null||S.replayGeoTapMove()}),this.lastCursorContext=c,(b=(h=this.grapher2d)==null?void 0:h.poiController)!=null&&b.keyboardAttentionManager.getKeyboardAttention()&&!this.isGraphPaperFocused()&&((D=(C=this.grapher2d)==null?void 0:C.poiController)==null||D.keyboardAttentionManager.setKeyboardAttention(void 0)),this.isGeometry()&&(bR(this.geometryToolbarModel),this.isGeoToolEnabled(this.getActiveTool())||this.setGeoTool("selection")),this.runAfterDispatch(()=>{var S,V;this.isThreeDMode()||((S=this.grapher2d)==null||S.audioGraph.checkIfSelectedItemChanged(l?l.id:void 0),this.focusLocation&&this.focusLocation.type!=="graph-paper"&&((V=this.grapher2d)==null||V.audioGraph.exitAudioTrace()))})}getOpenMenuIcon(){let e=this.getOpenItemMenu();if(!e)return;let t=e.guid;return this.findEl(`[dcg-open-menu-guid="${t}"]`)}propagateSelection(){let e=this.getGrapher();e?this.__lastSelectedIdsForPropagation=R2(this,e,this.__lastSelectedIdsForPropagation):this.__lastSelectedIdsForPropagation={}}propagateActiveTokens(){var e,t;this.isThreeDMode()||((e=this.grapher2d)==null||e.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.selected),"selected"),(t=this.grapher2d)==null||t.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.hovered),"hovered"))}getHoveredTokenIdentifier(){return this.activeTokens.hovered}doesLatexContainToken(e){return L_(e)}getToolPreviewJSONState(){return this.toolPreviewJSONState}garbageCollectGeo(e,t){if(!this.isGeometry())return;let i=MU(this,e,t);i.length&&uM(this.listModel,i)}ensureAtLeastOneVisibleItem(){if(HR(this.listModel)){let e=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});Ec(this.listModel,e)}}getExpressionIdForIdentifier(e){if(e){var t=this.getItemsByIdentifier(e);if(t.length===1)return t[0].id}}getValidCursorContext(){var n;let e=this.getSelectedItem();if(!e||e.type!=="expression")return;let t=e.formula.cursor_context,i=(n=it.getFocusedMathquill())==null?void 0:n.selection();if((t==null?void 0:t.type)==="expression-arguments"){let{argIndex:o,positionWithinArg:s}=t;if(!(o===t.argCount-1&&s==="end"||t.positionWithinArg==="start-to-end"&&(i==null?void 0:i.startIndex)!==void 0&&(i==null?void 0:i.startIndex)===(i==null?void 0:i.endIndex)))return}if((e==null?void 0:e.type)==="expression"&&e.latex===(t==null?void 0:t.selection.input)&&(i==null?void 0:i.startIndex)===(t==null?void 0:t.selection.start)&&(i==null?void 0:i.endIndex)===(t==null?void 0:t.selection.end)&&(i==null?void 0:i.latex)===(t==null?void 0:t.selection.input))return t}tryInsertTokenIntoMathquill(e,t){if(!this.isGeometry()||!e)return!1;var i=this.getItemModel(e);if(!i||i.type!=="expression")return!1;let n=i.formula.typed_constant_value;t===0&&(!n||!__dcg_shared_module_exports__['vb'](n.valueType))&&(t=void 0);var o,s,a=po(i);if(a?s=__dcg_shared_module_exports__['Ib'](a):i.formula.geometry&&(s=this.getAutonameLatexForExpression(i),o=s),!s)return!1;t!==void 0&&(s+="\\left["+(t+1)+"\\right]");var l=this.getFocusLocation();if(!l||!this.seemsLikeInsertingTokenWillImproveThings(n==null?void 0:n.valueType))return!1;var c=l.type==="expression";return c?(o&&(rn(i)==="NONE"&&i.dragMode==="AUTO"&&Fh(i,"NONE"),ya(i,o+"="+i.latex)),this.writeIdentifierIntoCurrentMathquill(s),!0):!1}seemsLikeInsertingTokenWillImproveThings(e){let t=this.getValidCursorContext();if(t){if(!e)return!1;let i=__dcg_shared_module_exports__['vb'](e)?__dcg_shared_module_exports__['wb'](e):e;return(t.type==="expression-arguments"?t.allowedTypesForInsertedArg:t.allowedTypes).some(o=>__dcg_shared_module_exports__['yb'](i,o))}return!1}writeIdentifierIntoCurrentMathquill(e){this.runAfterDispatch(()=>{let t=this.getValidCursorContext(),i=it.getFocusedMathquill();if(!i)return;let n="",o="";(t==null?void 0:t.type)==="expression-arguments"&&((t==null?void 0:t.positionWithinArg)==="end"?n=",":(t==null?void 0:t.positionWithinArg)==="start"&&(o=","));let s=`${n}${e}${o}`,a=!1;if((t==null?void 0:t.type)==="expression-arguments"&&t.polygonVertices){let{argIndex:l,polygonVertices:c,positionWithinArg:u}=t;(e===c.firstLatex||e===c.lastLatex)&&(u==="end"||u==="start-to-end")&&l===t.argCount-1&&(s="",a=!0)}else(t==null?void 0:t.type)==="expression-arguments"&&(a=t.isLastValidArg);it.canAcceptText(i,this.getCapExpressionSize(),s)&&(i.write(s),it.simulateUserChangedLatex(i),a&&i.keystroke("Right"))})}getSelectedExpressionIds(){return zR(this.listModel)}getPropagatedSelectedIds(){return this.__lastSelectedIdsForPropagation}areParsableObjectsEqual(e,t){return e===t?!0:__dcg_shared_module_exports__['G'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{regressionParameters:void 0}),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{regressionParameters:void 0}))}requestParseForAllItems(){var n,o,s;(this.isCurrentlyDoingSetState||this.isCurrentlyDoingRestoreState)&&(this.lastParsableObjects={},this.evaluator.clearStatementsAndStartCompleteState(),this.isCurrentlyDoingRestoreState&&this.evaluator.markUndoRedoState());var e={},t=this.lastParsableObjects;for(let a of this.getAllItemModels())switch(a.type){case"expression":case"image":case"table":e[a.guid]=a.cachedParsableState;break;case"folder":case"text":break;default:return a}for(let a of AR(this.listModel))e[a.guid]=a.cachedParsableState;for(let a of qm(this.listModel)){let l=this.getSelectedItem(),c=this.activeTool==="polygon";if(this.activeTool==="expression-edit"&&(l==null?void 0:l.type)==="expression"&&((o=(n=l.formula.geometry)==null?void 0:n.call)==null?void 0:o.symbol)==="polygon"&&((s=l.formula.cursor_context)==null?void 0:s.type)==="expression-arguments"){let{positionWithinArg:u,argIndex:p}=l.formula.cursor_context;c=(u==="end"||u==="start-to-end")&&p===l.formula.geometry.call.parents.length-1}e[a.guid]=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a.cachedParsableState),{shouldOmitLastPolygonSegment:c})}let i=this.getFocusedItem();if((i==null?void 0:i.type)==="expression"){let a=it.getFocusedMathquill(),l=a==null?void 0:a.selection();(l==null?void 0:l.latex)===i.latex&&(e[i.guid]=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},i.cachedParsableState),{latexSelection:{start:l.startIndex,end:l.endIndex}}))}this.listModel.ticker.cachedParsableState&&(e[this.listModel.ticker.guid]=this.listModel.ticker.cachedParsableState);for(let a of wR(this.geometryToolbarModel))e[a.id]=a;for(let a in t){let l=t[a],c=e[a];if(l.type==="image"&&(!c||c.type!==l.type||c.guid!==l.guid)&&this.grapher2d&&this.grapher2d.removeGraphImage(l.id),!c&&(this.evaluator.removeStatement(l.id),l.type==="table"))for(let u of l.columns)this.evaluator.removeStatement(u.id)}for(let a in e){let l=e[a],c=t[a];if(l.type==="image"&&(!c||l.type!==c.type||l.guid!==c.guid)&&this.grapher2d){let u=this.getItemModel(l.id);u&&u.type==="image"&&this.grapher2d.addGraphImage(u)}this.areParsableObjectsEqual(l,c)||(this.grapher2d&&l.type==="statement"&&l.latex===""&&this.grapher2d.removeGraphSketch(l.id),this.evaluator.addStatement(l))}this.lastParsableObjects=e}getViewState(){let e=this.getGrapher();if(e){let t=e.getProjection();return{viewport:t.viewport.toObject(),screen:t.screen,xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale,degreeMode:t.settings.degreeMode}}else return}getTokenRenderInfoByIdentifier(e){let t=this.cachedGeoTokenInfo[e];return t||(t={iconType:"unknown",isList:!1,hasError:!0,isSelected:!1,groupType:"unknown",color:"",isHidden:!1,description:"",label:"",calcId:""}),t}setEvaluator(e){this.evaluator=e}getEvaluator(){return this.evaluator}setGrapher2d(e){this.grapher2d=e}setGrapher3d(e){this.grapher3d=e}getGrapher(){return this.isThreeDMode()?this.grapher3d:this.grapher2d}getGrapher2d(){return this.grapher2d}getGrapher3d(){return this.grapher3d}get2dPOIController(){var e;return(e=this.grapher2d)==null?void 0:e.poiController}isDefaultViewportRestored(){var e;return!!((e=this.getGrapher())!=null&&e.viewportController.isDefaultViewportRestored())}requestRedrawGraph(){var e,t;(e=this.grapher2d)==null||e.redrawAllLayers(),this.isThreeDMode()&&((t=this.grapher3d)==null||t.redrawAllLayers())}get2dProjection(){var e;return(e=this.grapher2d)==null?void 0:e.getProjection()}get2dSketchOrder(){var e;return(e=this.grapher2d)==null?void 0:e.getSketchOrder()}getBoundingBoxesForZoomFit(e){if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.shouldGraph||!e.formula.is_graphable)))return e.boundingBoxes}isExpressionZoomFit(e){if(this.isThreeDMode())return!1;let t=this.getBoundingBoxesForZoomFit(e),i=this.get2dProjection();return!i||!t?!1:!fL(t,i)&&!!sx(t,i)}showExpressionZoomFitButton(e){if(this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxesForZoomFit(e),i=this.get2dProjection();return!!(i&&t&&fL(t,i))}setBugsnagContext(e){this.bugsnagContext=e}getItemRootNodeById(e){let t=this.getItemModel(e);if(t&&t.dcgView)return t.dcgView.findRootNode()}getItemSelectorById(e){return this.getItemRootNodeById(e)}generateId(){var e=this.__nextItemId;return this.__nextItemId+=1,e+""}getNextColor(){return GR(this.listModel)}getNextDisplayIndex(){return this.listModel.nextDisplayIndex}_clearPendingImageUploads(){this.__pendingImageUploads={}}isUploadingImages(){return Object.keys(this.__pendingImageUploads).length>0}getExpressionAnalysis(){return this.listModel.expressionAnalysis}createItemModel(e){return Nm(this.listModel,e)}getItemModel(e,t){return Sc(this.listModel,e,t)}getHiddenGeoItemCount(){return UR(this.listModel)}getColorById(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?"":GT(t)}getAllColorAssignments(){let e=[];for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=po(t);if(!i)continue;let n=this.getEvaluationValueForItem(t.id);(typeof n=="string"||Array.isArray(n)&&typeof n[0]=="string")&&e.push({id:t.id,assignmentLatex:__dcg_shared_module_exports__['Ib'](i)})}return e}getAllColorFunctionAssignments(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=po(t),n=AT(t);!i||!n||e.push({id:"shader",assignmentLatex:"shader:"+__dcg_shared_module_exports__['Ib'](i)})}return e}getShader(e){for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=po(t);if(i&&__dcg_shared_module_exports__['Ib'](i)===e){let n=AT(t);if(n)return n}}return{source:"",shaderFunctions:{}}}getAllImages(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels())t.type==="image"&&e.push({id:t.id,url:t.image_url,name:t.name});return e}getItemModelByIndex(e){return Km(this.listModel,e)}getItemCount(){return Yb(this.listModel)}getItemEditableLabelMode(e){let t=this.getItemModel(e);if(!(!t||t.type!=="expression"))return $_(t)}isItemSecret(e){let t=this.getItemModel(e);return t?Jb(t):!1}isItemReadonly(e){let t=this.getItemModel(e);return t?aM(t):!1}isItemSelected(e){let t=this.getItemModel(e);return!!t&&ba(t)}hasAnyItemsSelected(){return this.getAllSelectedItems().length>0}hasMultipleItemsSelected(){return this.getAllSelectedItems().length>1}isItemSelectable(e){let t=this.getItemModel(e);return t?Hm(t):!1}anyItemDependsOnRandomSeed(){return ZR(this.listModel)}areActionsEnabled(){return this.graphSettings.config.actions==="auto"?e2(this.listModel):!!this.graphSettings.config.actions}getAllItemModels(){return cM(this.listModel)}getAllToolPreviewItems(){return qm(this.listModel)}getAllModelsWithSliders(){return qR(this.listModel)}getGraphSettings(){return this.graphSettings}getAudioGraph(){var e;if(!this.isThreeDMode())return(e=this.grapher2d)==null?void 0:e.audioGraph}inAudioTraceMode(){let e=this.getAudioGraph();return!!(e&&e.audioTraceActive)}canAudioTrace(){let e=this.getAudioGraph();return e?e.canAudioTraceCurrentExp():!1}isAudioTracing(){let e=this.getAudioGraph();return e?e.tonegen.isAnimating():!1}expressionsAreFullWidth(){return this.isNarrow()||this.graphSettings.config.graphpaper===!1}getExpListWidthString(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"}getExpListWidth(){return this.rootElt?this._getExpListWidth():0}findFirstVisibleItem(){let e=SU(this,this._previousFirstVisibleId);if(this._previousFirstVisibleId=e,e)return this.getItemModel(e)}findLastVisibleItem(){let e=EU(this,this._previousLastVisibleId);if(this._previousLastVisibleId=e,e)return this.getItemModel(e)}updateRenderShellsAfterDispatch(){if(!this.rootElt||!this.isListVisible())return;let e=this.findFirstVisibleItem(),t=this.findLastVisibleItem();var i=e&&this.getItemRootNodeById(e.id),n=t&&this.getItemRootNodeById(t.id);if(i===this.lastInfiniteScrollFirstDOM&&n===this.lastInfiniteScrollLastDOM&&!this.hasDispatchSinceLastInfiniteScrollUpdate)return;this.lastInfiniteScrollFirstDOM=i,this.lastInfiniteScrollLastDOM=n,this.hasDispatchSinceLastInfiniteScrollUpdate=!1;let o=!1,s=e?e.index:1/0,a=t?t.index:1/0,l=this.listModel.dragState&&this.listModel.dragState.firstItemId,c,u=this.getOpenItemMenu();u&&u.type!=="multi-select-more"&&u.type!=="multi-select-transformations"&&u.type!=="geo-tool-dropdown"&&(c=u.model.id);for(let g of this.getAllItemModels()){var p=(g.index<s||g.index>a||g.isHiddenFromUI)&&!(g.type==="expression"&&g.sliderDragging);if(l==g.id&&(p=!1),c===g.id&&(p=!1),g.renderShell!==p&&(g.renderShell=p,o=!0,p)){let h=this.getItemRootNodeById(g.id);if(h){let b=h.getBoundingClientRect().height;b>0&&(g.cachedRenderHeight=b)}}}o&&this.markTickRequiredNextFrame()}updateRenderShellsBeforePaint(){if(this.hasDispatchSinceLastInfiniteScrollUpdate=!0,this.inPrintMode){for(let t of this.getAllItemModels())t.renderShell=!1;return}for(let t of this.getAllItemModels())t.isHiddenFromUI&&(t.renderShell=!0),t.type==="expression"&&t.sliderDragging&&(t.renderShell=!1);let e=this.getSelectedItem();e&&!this.isGeoItem(e.id)&&(e.renderShell=!1)}updateDragDrop(){let e=this.listModel.dragState;if(!e)return;let t=this.getItemModel(e.firstItemId);if(!t)return;let i=this.dragdrop_expressions.applyDrag();i&&(Xb(this.listModel,i.dragState),us(t,i.folderId),t.index!==i.newIndex&&Ip(this.listModel,t.index,i.newIndex,e.numberOfItems))}_tickSliders(e){this.getPlayingSliders().forEach(function(t){b_(t,e)})}tickTicker(e){let t=this.listModel.ticker.lastTickTime===void 0;this.evaluator.addClockTickEvent(this.listModel.ticker.id,t),uR(this.listModel.ticker,e)}stopAllSliders(){for(let e of this.getAllItemModels())e.type==="expression"&&e.slider.isPlaying&&Ka(e,!1)}getPlayingSliders(){var e=this.getAllItemModels(),t=[];for(let i of e)i.type==="expression"&&i.sliderExists&&i.slider.isPlaying&&t.push(i);return t}areAnyImagesLoading(){return kR(this.listModel)}_commitUserRequestedViewport(e){var t;(t=this.getGrapher())==null||t.setUserRequestedViewport(e)}_setAxisLimitLatex(e,t){this.settingsViewModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.settingsViewModel),{limitLatex:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.settingsViewModel.limitLatex),{[e]:t})});let n=t===""&&(e==="xstep"||e==="ystep")?0:Si(t,this.graphSettings.degreeMode),o=this.getGrapher();switch(e){case"xstep":{if(!bm(n))return;this.graphSettings.setProperty("xAxisStep",n)}break;case"ystep":{if(!bm(n))return;this.graphSettings.setProperty("yAxisStep",n)}break;case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":{if(!o)return;let s=o.viewportController.getViewport(),a="xmin";e==="xmin"&&(a="xmax"),e==="ymax"&&(a="ymin"),e==="ymin"&&(a="ymax"),e==="zmax"&&(a="zmin"),e==="zmin"&&(a="zmax");let l=Si(this.settingsViewModel.limitLatex[a]||"",this.graphSettings.degreeMode),c=hn.fromObject(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},s.toObject()),{[e]:n,[a]:l}));if(!c.isValid(this.getAxisScaleSettings()))return;o.viewportController.setViewport(c);let p;switch(e){case"xmin":case"xmax":p="x";break;case"ymin":case"ymax":p="y";break;case"zmin":case"zmax":p="z";break;default:let g=e;throw new Error(`Invalid limit: ${g}`)}this.graphSettings.setProperty("lastChangedAxis",p),this.markSquareAxesAfterUserEditedViewport()}break}if(o){let s=o.viewportController.getViewport().toObject();this._commitUserRequestedViewport(s)}}unmarkLastChangedAxis(){this.graphSettings.setProperty("lastChangedAxis",void 0)}markSquareAxesAfterUserEditedViewport(){let e=this.getGrapher();if(!e)return;let t=e.viewportController.getViewport(),i=this.isThreeDMode()?t.isSquare3D():t.isSquare(e.getProjection().screen,this.getAxisScaleSettings());this.graphSettings.setProperty("squareAxes",i)}getLockViewportConfigSetting(){return this.graphSettings.config.lockViewport}getLockViewportUserSetting(){return this.graphSettings.userLockedViewport}canUserAddExpressions(){return!!this.graphSettings.config.expressions}areNotesEnabled(){return!!this.graphSettings.config.notes}areSlidersEnabled(){return!!this.graphSettings.config.sliders}areLinksEnabled(){return!!this.graphSettings.config.links}areImagesEnabled(){let e=window.FileReader,t=dl&&ub&&ub[0]===8&&ub[1]===0&&ub[2]===0;return!!(this.graphSettings.config.images&&e&&!t)}areFoldersEnabled(){return!!this.graphSettings.config.folders}isDecimalToFractionEnabled(){return!!this.graphSettings.config.decimalToFraction}isTraceEnabled(){return!!this.graphSettings.config.trace}areFunctionsRestricted(){return!!this.graphSettings.config.restrictedFunctions}areGeometryFunctionsForceEnabled(){return!!this.graphSettings.config.forceEnableGeometryFunctions}isQwertyKeyboardEnabled(){return!!this.graphSettings.config.qwertyKeyboard}isZoomFitEnabled(){return!!this.graphSettings.config.zoomFit}canEditOnWeb(){return!!this.graphSettings.config.editOnWeb}hasTransparentBackground(){return!!this.graphSettings.config.transparentBackground}shouldAudioTraceReverseExpressions(){return!!this.graphSettings.config.audioTraceReverseExpressions}hasDefaultState(){return!!this.graphSettings.defaultState}getDefaultViewport(){var t;var e=this.graphSettings.defaultState;return e&&e.graph?e.graph.viewport:(t=this.getGrapher())==null?void 0:t.getDefaultViewport()}getColors(){return this.isThreeDMode()?__dcg_shared_module_exports__['T']:this.graphSettings.config.colors}getImageOpacities(){return["0.2","0.4","0.6","0.8","1"]}getUIDragModes(){return["X","Y","XY"]}getNumberOfItemsInFolder(e){return IR(this.listModel,e)}getEnabledDragModesForItem(e){let t=this.getItemModel(e);if(!t||t.type!=="expression")return[];let i=t.formula,n=[];if(!i.move_strategy)return n;let o=i.move_strategy[0].type!=="none",s=i.move_strategy[1].type!=="none",a=o&&s;return o&&n.push("X"),s&&n.push("Y"),a&&n.push("XY"),n}shouldShowEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:kT(t)}getEvaluationValueForItem(e){let t=this.getItemModel(e);return t?t.type!=="expression"?NaN:GT(t):NaN}canDisplayEvaluationForItemAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||Nl(t))return!1;let i=this.getEvaluationValueForItem(e);return typeof i!="number"?!1:__dcg_shared_module_exports__['Eb'](i)}shouldEvaluationForItemDisplayAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:vp(t)}getEvaluationLabelOptionsForItem(e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},g_),{displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)})}getPointStyles(){return["POINT","OPEN","CROSS"]}getLineStyles(){return["SOLID","DASHED","DOTTED"]}getOpacities(){return[.2,.4,.8]}isInEditListMode(){return this.layoutModel.inEditListMode}authorFeaturesAvailable(){return!!this.graphSettings.config.authorFeatures}shouldShowAuthorFeatures(){return this.authorFeaturesAvailable()&&!!this.graphSettings.config.authorMode}toolWillBeHiddenOrDisabled(e){return this.shouldShowAuthorFeatures()&&(!this.isGeoToolVisible(e,{ignoreAuthorMode:!0})||!this.isGeoToolEnabled(e,{ignoreAuthorMode:!0}))}setAuthorMode(e){this.graphSettings.config.setProperty("authorMode",e)}getInvertedColors(){return!!this.graphSettings.config.invertedColors}invertSwatches(){return this.isThreeDMode()&&this.getInvertedColors()}canUseAdvancedStyling(){return this.graphSettings.config.advancedStyling}isDegreeMode(){return this.graphSettings.degreeMode}isThreeDMode(){return this.graphSettings.threeDMode}showPlane3D(){let{threeDMode:e,showAxis3D:t,showPlane3D:i}=this.graphSettings;return e&&t&&i}isBeta3DMode(){return this.isThreeDMode()&&Ai("beta3d")}areLogModeRegressionsForced(){return this.graphSettings.config.forceLogModeRegressions}setAllRegressionsToLogMode(){for(let e of this.getAllItemModels())e.type==="expression"&&e.formula&&e.formula.is_regression&&_T(e,!0)}isGraphSettingsOpen(){return this.layoutModel.graphSettingsOpen}isAddExpressionOpen(){return this.layoutModel.addExpressionOpen}shouldRenderList(){if(this.layoutModel.expressionsVisible)return!0;var e=this.layoutModel.expressionsHiddenTime;return e===void 0?!1:Date.now()-e<=500}isListVisible(){return this.layoutModel.expressionsVisible}isGrapherEnabled(){return this.graphSettings.config.graphpaper!==!1}isListEnabled(){return this.graphSettings.config.expressions!==!1}areDistributionsEnabled(){return this.graphSettings.config.distributions===!0}isExpressionListFocused(){let e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"generic-menu":case"expression-menu":case"editable-label":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"new-transformation-number":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"regression-output":case"graph-paper":case"zoom-restore-btn":return!1;case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":case"table":case"image":case"readonly-expression":case"braille-output":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"expression-icon":case"image-icon":case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"action-icon":case"hide-expression-list-btn":case"show-expression-list-btn":case"top-level-icon":return!0;default:return e}}needsFakeKeypad(){if(this.inAudioTraceMode()&&this.isKeypadEnabled())return!0;let e=this.getFocusLocation();if(!e||this.getBrailleMode()!=="none"&&Da())return!1;switch(e.type){case"settings":return xU(e.location);case"new-transformation-number":case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":return!0;case"expression-menu":return e.location==="opacity"||e.location==="linewidth"||e.location==="lineopacity"||e.location==="pointopacity"||e.location==="pointsize"||e.location==="labelsize"||e.location==="labelangle"||e.location==="updaterule";case"table":{if(this.isInEditListMode())return!1;let n=e.location;if(n.row===0)return!0;var t=this.getItemModel(e.id);if(!t||t.type!=="table")return!1;let o=t.columnModels[n.column];return o?!o.disabled:!1}case"image":return e.location!=="name";case"readonly-expression":case"braille-output":case"regression-output":case"graph-paper":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"hide-expression-list-btn":case"show-expression-list-btn":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"generic-menu":case"zoom-restore-btn":return!1;case"expression-icon":case"image-icon":case"slider-icon":case"action-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"top-level-icon":return!1;case"editable-label":return this.getItemEditableLabelMode(e.id)==="MATH";default:return e}}isIdentifierRenameValid(e){return ga(e)?!LR(this.listModel,e):!1}getBrandingMode(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"}getEditLink(){return window.iframeEmbedBrandingLink}_expressionZoomFit(e,t,i=!1){let n=this.getItemModel(e);if(this.isThreeDMode()||!this.grapher2d||!this.isZoomFitEnabled()||!n||n.type!=="expression"&&n.type!=="table"||!n.boundingBoxes||!n.boundingBoxes.length)return!1;var o=this.grapher2d.viewportController;if(!("zoomCustom"in o))return!1;let s=sx(n.boundingBoxes,o.getProjection());return s?(i?o.setViewport(hn.fromObject(s)):o.zoomCustom(s),t&&on(this,{type:"zoom-restore-btn"}),!0):!1}_deleteItemAndAnimateOut(e,t){let n=this.getItemSelectorById(e);n&&(Gc(n,{transition:.2+"s",opacity:"0",transform:"scale(.1, .1)"}),setTimeout(()=>{this.dispatch({type:"finish-deleting-item-after-animation",id:e,setFocusAfterDelete:t})},1e3*.2))}_finishDeletingItemAfterAnimation(e,t){let i=this.getItemModel(e);if(!i)return;let n=this.getItemSelectorById(e),o=n&&document.activeElement&&n.contains(document.activeElement),s=Uh(this.listModel,i.index);if(this._removeExpressionSynchronously(i),!(!t||!o)){if(!s){let a=Um(this.listModel);a&&(s=a)}s&&Go(this,s.id,"end")}}_removeExpressionSynchronously(e){let t=jm(this.listModel,e.index);this.garbageCollectGeo(t,{}),this.ensureAtLeastOneVisibleItem()}setRootElt(e){this.rootElt=e,this.dragdrop_expressions=new dx(this)}getRootElt(){return this.rootElt}_hideExpressions(e){this.graphSettings.config.expressions&&(ui(this.listModel,void 0),this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{expressionsVisible:!1,expressionsHiddenTime:Date.now()}),e?on(this,{type:"show-expression-list-btn"}):pi())}_showExpressions(e){this.graphSettings.config.expressions&&(this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{expressionsVisible:!0}),e?on(this,{type:"hide-expression-list-btn"}):pi())}_showToast(e){if(this.toastData=e,this.toastData.hasOwnProperty("undoCallback")&&!_l){let i=di?this.s("graphing-calculator-text-toast-undo-cmd-z"):this.s("graphing-calculator-text-toast-undo-ctrl-z");this.toastData.message+=" "+i}clearTimeout(this._hideToastTimeout);let t=typeof e.hideAfter=="number"?e.hideAfter:6e3;t>0&&(this._hideToastTimeout=setTimeout(()=>{this.dispatch({type:"toast/close",onHide:this.toastData.onHide})},t))}_setExpressionPropertiesFromAPI(e,t){let i=this.getItemModel(e);if(i)if(i.type==="table"&&t.columns){t=__dcg_shared_module_exports__['j'](t);let s=k2(i,t);var n=Nm(this.listModel,s);this._toplevelReplaceItemAt(i.index,n,!1)}else{let s=this.getItemModel(e);if(!s)return;for(var o in t)if(t.hasOwnProperty(o))switch(o){case"slider":{if(s.type!=="expression")continue;let a=t[o];a.hasOwnProperty("min")&&Cm(s,a.min),a.hasOwnProperty("max")&&Dm(s,a.max),a.hasOwnProperty("step")&&Gb(s,a.step),a.hasOwnProperty("isPlaying")&&Ka(s,a.isPlaying)}break;case"polarDomain":{if(s.type!=="expression")continue;Ib(s,__dcg_shared_module_exports__['kc'](t.polarDomain.min)),Ab(s,__dcg_shared_module_exports__['kc'](t.polarDomain.max))}break;case"parametricDomain":{if(s.type!=="expression")continue;Vb(s,__dcg_shared_module_exports__['kc'](t.parametricDomain.min)),Lb(s,__dcg_shared_module_exports__['kc'](t.parametricDomain.max))}break;case"parametricDomain3Du":{if(s.type!=="expression")continue;Tb(s,__dcg_shared_module_exports__['kc'](t.parametricDomain3Du.min)),Ob(s,__dcg_shared_module_exports__['kc'](t.parametricDomain3Du.max))}break;case"parametricDomain3Dv":{if(s.type!=="expression")continue;Mb(s,__dcg_shared_module_exports__['kc'](t.parametricDomain3Dv.min)),Pb(s,__dcg_shared_module_exports__['kc'](t.parametricDomain3Dv.max))}break;case"hidden":this._setItemHidden(e,t.hidden);break;case"secret":fM(s,t.secret);break;case"readonly":uS(s,t.readonly);break;case"color":{if(s.type!=="expression")continue;dD(s,t.color)}break;case"dragMode":{if(s.type!=="expression")continue;Fh(s,t.dragMode)}break;case"label":{if(s.type!=="expression")continue;gu(s,t.label)}break;case"showLabel":{if(s.type!=="expression")continue;_h(s,t.showLabel)}break;case"labelSize":{if(s.type!=="expression")continue;Bb(s,t.labelSize)}break;case"labelOrientation":{if(s.type!=="expression")continue;KT(s,t.labelOrientation)}break;case"latex":if(s.type!=="expression")continue;ya(s,t.latex);break;case"points":if(s.type!=="expression")continue;RT(s,!!t.points);break;case"lines":if(s.type!=="expression")continue;BT(s,!!t.lines);break;case"pointStyle":if(s.type!=="expression")continue;NT(s,t.pointStyle);break;case"pointSize":if(s.type!=="expression")continue;Rb(s,t.pointSize);break;case"pointOpacity":if(s.type!=="expression")continue;Fb(s,t.pointOpacity);break;case"lineStyle":if(s.type!=="expression")continue;hD(s,t.lineStyle);break;case"lineWidth":if(s.type!=="expression")continue;km(s,t.lineWidth);break;case"lineOpacity":if(s.type!=="expression")continue;Em(s,t.lineOpacity);break;case"fill":if(s.type!=="expression")continue;FT(s,t.fill);break;case"fillOpacity":if(s.type!=="expression")continue;_b(s,t.fillOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+o)}}}_isParentFolderHidden(e){let t=this.getItemModel(e);if(!t)return!1;let i=Ua(t);return i?i.hidden:!1}_toggleItemHidden(e){if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{let t=this.getItemModel(e);if(!t)return;switch(t.type){case"expression":this._setItemHidden(e,!Ba(t));break;case"image":case"folder":this._setItemHidden(e,!t.hidden);break;case"table":case"text":break;default:return t}}}_toggleTableColumnHidden(e,t){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,t,!1);else{let i=this.getItemModel(e);if(!i||i.type!=="table")return;let n=ps(i,t);if(!n)return;this._setTableColumnHidden(e,t,!n.hidden)}}_setTableColumnHidden(e,t,i){let n=this.getItemModel(e);if(!n||n.type!=="table")return;let o=yS(n,t);!i&&this._isParentFolderHidden(e)&&this._setItemHidden(n.folderId,!1),A2(n,t,i),!i&&o&&xM(n,t,!0)}_setItemHidden(e,t){let i=this.getItemModel(e);if(i)switch(!t&&i.type!=="folder"&&this._isParentFolderHidden(i.id)&&this._setItemHidden(i.folderId,!1),i.type){case"expression":J_(i,t);break;case"folder":SF(i,t);break;case"image":BF(i,t);break;case"table":case"text":break;default:return i}}_addItemToEndFromAPI(e){let t=$D(this.listModel);!e.secret&&t&&t.type==="expression"&&t.latex===""&&jm(this.listModel,t.index),Ec(this.listModel,e)}copyExpressionToIndex(e,t,i){let n={stripDefaults:!1},o;switch(e.type){case"expression":o=Ph(e,n);break;case"table":o=Xm(e,n),o.columns&&o.columns.forEach(a=>{a.id=this.generateId()});break;case"image":o=FD(e,n);break;case"text":o=AD(e,n);break;default:return}let s=this.createItemModel(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{id:this.generateId()}));this._toplevelInsertItemAt(t,s,!1,i||e.folderId)}_toplevelInsertItemAt(e,t,i,n){let o=t;xl(this.listModel,o,e),n&&us(o,n),i&&Go(this,o.id)}_toplevelNewItemAtSelection(e,t){this.setGeoTool("selection");let i=this.getSelectedItem();if(i){let a=i.type==="expression"&&!i.latex;if(a&&!i.folderId&&(e.type!=="expression"||e.latex))return this._toplevelReplaceItemAt(i.index,e,t.shouldFocus);if(a&&i.folderId&&e.type!=="expression"&&e.type!=="folder")return this._toplevelReplaceItemAt(i.index,e,t.shouldFocus);if(i.type!=="folder"&&!i.folderId){let l;return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,l)}if(i.type!=="folder"&&i.folderId&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,i.folderId);if(i.type==="folder"&&!i.collapsed&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,i.id)}let n=this.getFirstFullyVisibleItem();for(n&&n.type==="folder"&&(n=this.getItemModelByIndex(n.index+1));n&&n.type!=="folder"&&n.folderId;)n=this.getItemModelByIndex(n.index+1);let o=n?n.index:this.getItemCount(),s;return this._toplevelInsertItemAt(o,e,t.shouldFocus,s)}getFirstFullyVisibleItem(){let e=wL(this);if(e)return Sc(this.listModel,e)}findEl(e){if(this.rootElt)return this.rootElt.querySelector(e)||void 0}getExppanelSelector(){return ax(this)}scrollItemIntoView(e){if(!this.rootElt||!this.isListVisible())return;let t=this.getItemSelectorById(e.id),i=lx(this);if(!(!t||!i)){if(e.type==="table"){let n=t.querySelector(".dcg-row .dcg-selected");if(n){xa(n,i,60);return}}xa(t,i,90)}}scrollSelectedItemIntoView(){let e=this.getSelectedItem();if(e){if(e&&e.type!=="folder"&&e.folderId){let t=this.getItemModel(e.folderId);t&&t.type==="folder"&&t.collapsedChildIsSelected&&(e=t)}this.scrollItemIntoView(e)}}_pasteTable(e){let t=this.getGrapher();if(!t)return;let i=WD(this.listModel),n=wM(i,e,this),o=this.createItemModel(n);this._toplevelNewItemAtSelection(o,{shouldFocus:!0}),this._closeAddExpression();let s=t.getProjection(),a=s.viewport,l=__dcg_shared_module_exports__['m'](e[0],function(p){return parseFloat(p)}),c=__dcg_shared_module_exports__['m'](e[1],function(p){return parseFloat(p)});if(this.is3dProduct())return;let u={xmin:__dcg_shared_module_exports__['t'](l),xmax:__dcg_shared_module_exports__['s'](l),ymin:__dcg_shared_module_exports__['t'](c),ymax:__dcg_shared_module_exports__['s'](c),type:"table"};if(isFinite(u.xmin)&&isFinite(u.xmax)&&isFinite(u.ymin)&&isFinite(u.ymax)&&(u.xmax>a.xmax||u.xmin<a.xmin||u.ymax>a.ymax||u.ymin<a.ymin)){let p=sx([u],s);if(p){let g=new hn(p.xmin,p.xmax,p.ymin,p.ymax);t.viewportController.setViewport(g),this._showToast({message:this.s("graphing-calculator-text-toast-zoom-to-fit"),undoCallback:()=>{this.dispatch({type:"undo"})}}),this.markSquareAxesAfterUserEditedViewport()}}}_insertSeveralExpressions(e){for(var t=0;t<e.length;t++){let i;i=this.createItemModel(e[t]),this._toplevelNewItemAtSelection(i,{shouldFocus:!0})}}_appendNumberList(e){let t=this.getSelectedItem();if(t&&t.type==="expression"){let i=t.latex,n=this.createItemModel({type:"expression",id:this.generateId(),latex:i+e});return this._toplevelReplaceItemAt(t.index,n,!0)}}_openOnWeb(){this.runAfterDispatch(()=>{let e=this.getGrapher();if(!e)return;let t=JSON.stringify(this.getState()),i=e.screenshot({width:100,height:100}),s=(this.getGraphSettings().config.crossOriginSaveTest?"/":"")+"api/v1/calculator/cross_origin_save",a=O('<input type="text" name="calc_state" />').val(t),l=O('<input type="text" name="thumb_data" />').val(i),c=O('<form target="_blank" method="POST" style="display:none;"></form>').attr("action",s).append(O('<input type="text" name="is_open_on_web" value="true" />')).append(O('<input type="text" name="my_graphs" value="false" />')).append(O('<input type="text" name="is_update" value="false" />')).append(a).append(l);O(this.rootElt).append(c),c.trigger("submit").remove()})}notifyBugsnagAboutMissingSelectedItem(e,t){let i=Wm(this.listModel);var n="";try{i?n=JSON.stringify(i.cachedUndoRedoFullState,null,2):n="undefined"}catch(a){n="[[could not stringify]]"}var o="";try{if(!i)o="undefined";else{let a={id:i.id,index:i.index,displayIndex:i.index,secretIndex:i.secretIndex,guid:i.guid,renderShell:i.renderShell,isHiddenFromUI:i.isHiddenFromUI,hasDCGView:!!i.dcgView,cachedRenderHeight:i.cachedRenderHeight};o=JSON.stringify(a,null,2)}}catch(a){o="[[could not stringify]]"}var s="";try{s=JSON.stringify(pM(this.listModel),null,2)}catch(a){s="[[could not stringify]]"}Yo("ReplaceItemAtError: no item at index",{metaData:{index:e,shouldFocus:t,selectedModelJSON:o,selectedItemJSON:n,listStateJSON:s}})}_toplevelReplaceItemAt(e,t,i){let n=t,o=this.getItemModelByIndex(e);o||this.notifyBugsnagAboutMissingSelectedItem(e,i);let s=o.type!=="folder"&&o.folderId;jm(this.listModel,e),xl(this.listModel,n,e),s&&us(n,s),i&&Go(this,n.id)}convertImageToDraggable(e){let t=this.getItemModel(e);if(!t||t.type!=="image")return;let i=t.folderId,n=t.index+1,o=t.center,s=WD(this.listModel),a=__dcg_shared_module_exports__['Ib']("C_"+s),l=this.createItemModel({id:this.generateId(),type:"expression",latex:a+"="+o,dragMode:"XY",hidden:!0});xl(this.listModel,l,n),i&&us(l,i),qa(t,"center",a),ZT(t,!0),eM(t,!0),this.listModel.openItemMenu=void 0}createSlidersForItem(e,t){let i=this.getItemModel(e);if(!i)return;let n=i.type!=="folder"&&i.folderId;return this.createSliders({model:i,folderId:n,index:i.index+1},t)}createSlidersForTicker(e){return this.createSliders({model:this.listModel.ticker,folderId:!1,index:0,doNotChangeFocus:!0},e)}createSliders({model:e,folderId:t,index:i,doNotChangeFocus:n},o){var s=[];e.type==="ticker"?BD(e,(g,h)=>{s.push({latex:g,location:h})}):Rm(e,(g,h)=>{s.push({latex:g,location:h.location})});var a=pU(s,o,{degreeMode:this.graphSettings.degreeMode});let l=e.formula?e.formula.action_value:void 0;for(var c=o.map(g=>{var h=a[g],b="1";h&&h.value!==void 0&&(b=h.value);var C;g===""?C="":l&&l.hasOwnProperty(g)?C=l[g]:C=__dcg_shared_module_exports__['Ib'](g)+"="+b;var D={type:"expression",id:this.generateId(),latex:C,color:this.getNextColor(),hidden:!!C};return h&&(h.min!==void 0&&(D.slider||(D.slider={}),D.slider.hardMin=!0,D.slider.min=h.min),h.max!==void 0&&(D.slider||(D.slider={}),D.slider.hardMax=!0,D.slider.max=h.max),h.step!==void 0&&(D.slider||(D.slider={}),D.slider.step=h.step)),D}),u=c.length-1;u>=0;u--){let g=this.createItemModel(c[u]);xl(this.listModel,g,i),t&&us(g,t)}if(n)return;let p=c[c.length-1];p.latex===""?Go(this,p.id):on(this,void 0)}_uploadImagesAndWaitForThemToLoad(e){let{files:t,id:i}=e;if(!t||t.length===0){this._showToast({message:this.s("graphing-calculator-text-toast-no-file-selected")});return}if(i&&t.length>1){this._showToast({message:this.s("graphing-calculator-text-toast-choose-one-file")});return}let n=QF({controller:this,files:t,id:i}),o=n.errors[0];o&&this._showToast({message:o});for(let s of n.tokens)this.__pendingImageUploads[s]=!0;this.isUploadingImages()&&this._showToast({message:this.s("graphing-calculator-text-toast-uploading-images"),onHide:()=>{this._clearPendingImageUploads()}})}getImageToRetry(){let e;for(let t of this.getAllItemModels())t.type==="image"&&t.loadStatus==="failed"&&(!e||e.failures>t.failures)&&(e=t);return e}retryLoadingFailedImage(e){let t=Date.now(),i=t-this.imageRetryState.lastAttemptTime,n=1e3*Math.pow(2,this.imageRetryState.attempts);this.imageRetryState.attempts>0&&i<n||(rM(e),this.imageRetryState={lastAttemptTime:t,attempts:this.imageRetryState.attempts+1})}getSelectedItem(){return Wm(this.listModel)}getAllSelectedItems(){return JD(this.listModel)}getOpenItemMenu(){return this.listModel.openItemMenu}isItemSettingsMenuOpen(e){var t=this.listModel.openItemMenu;return t?t.guid===e:!1}closeItemSettingsMenu(){let e=this.getOpenItemMenu();e!==void 0&&(e.focusFirstOption&&(e.previousFocusLocation!==void 0?on(this,e.previousFocusLocation):this.focusOpenMenuIcon()),this.listModel.openItemMenu=void 0)}focusOpenMenuIcon(){let e=this.getOpenItemMenu();e&&(e.type==="slider"?this.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:e.model.id}}):e.type==="image"?this.dispatch({type:"set-focus-location",location:{type:"image-icon",id:e.model.id}}):e.type==="table-column"?this.dispatch({type:"set-focus-location",location:{type:"table-icon",id:e.model.table.id,columnId:e.model.id}}):e.type==="geo-tool-dropdown"?this.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:e.tools[0]}}):e.type==="multi-select-more"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-more-icon"}}):e.type==="multi-select-transformations"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-transformations-icon"}}):this.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}}))}getFocusedItem(){return gU(this)}getFocusLocation(){return this.focusLocation}isFocusLocationFocused(e){let t=this.focusLocation,i=e;return!t||!i?!1:__dcg_shared_module_exports__['G'](t,i)}isCurrentFocusLocationValid(){let e=this.focusLocation;if(!e)return!0;if(e.type==="settings")return e.location==="icon"||this.isGraphSettingsOpen();if(e.type==="add-item-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn")return this.isListEnabled();if(e.type==="add-expression-btn"||e.type==="add-table-btn")return this.layoutModel.addExpressionOpen;if(e.type==="add-note-btn")return this.layoutModel.addExpressionOpen&&this.areNotesEnabled();if(e.type==="add-folder-btn")return this.layoutModel.addExpressionOpen&&this.areFoldersEnabled();if(e.type==="add-ticker-btn")return this.layoutModel.addExpressionOpen&&this.areActionsEnabled();if(e.type==="add-image-btn")return this.layoutModel.addExpressionOpen&&this.areImagesEnabled();if(e.type==="zoom-restore-btn")return!0;if(e.type==="search-expressions"||e.type==="replace-expressions")return this.expressionSearchOpen;if(e.type==="ticker")return this.listModel.ticker.open;if(e.type==="generic-menu")return!!this.getOpenItemMenu();if(e.type==="graph-paper"){let n=this.getGrapher();return!!(n&&n.getIsVisible()&&n.settings.config.graphpaper)}if(e.type==="geo-show-constructions-icon"||e.type==="geo-token"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="label-points-icon")return this.isGeoUIActive();if(e.type==="new-transformation-number"){let n=this.getGeoModel(),o=n.getCurrentTool(),s=n.getNonObjectsState().ui.currentTool.inputIndex,a=o.getSpec&&o.getSpec();return!!a&&!!a.inputs[s]&&a.inputs[s].type==="number"}if(e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon")return this.isGeoUIActive()&&this.hasAnyItemsSelected();if(e.type==="geo-basic-tool")return this.isGeoUIActive()&&e.tool!=="expression-edit";if(e.type==="regression-output")return e.parameter!=="";let t=this.getOpenItemMenu();if(e.type==="geo-basic-tool-menu-item")return this.isGeoUIActive()&&e.tool!==""&&t!==void 0&&t.type==="geo-tool-dropdown";let i;if(t&&t.type==="table-column"?i=t.model.table:i=this.getItemModel(e.id),!i)return!1;if(e.type==="change-image-btn")return this.listModel&&i.type==="image"&&this.areImagesEnabled();if(e.type==="expression-menu"){if(e.location==="start"||e.location==="end"||e.location==="updaterule"||e.location==="anywhere"||i.type==="table")return!0;if(i.type!=="expression")return!1;let{points:n,lines:o,fill:s,surfaces:a}=i;bd(i)&&(s=!0);let l=__dcg_shared_module_exports__['yc'](i.formula.expression_type,{points:n,lines:o,fill:s,surfaces:a});return!(!l.fill&&!l.points&&!l.lines&&!l.surfaces&&!i.showLabel)}if(!this.isItemSelected(e.id)&&e.type!=="editable-label")return!1;switch(e.type){case"domain-limit":return!(i.type!=="expression"||!fD(i)&&!yD(i));case"expression-icon":case"top-level-icon":return!0;case"image-icon":return i.type==="image"&&i.loadStatus!=="loading"&&i.loadStatus!=="failed"&&!i.error;case"action-icon":return!(i.type!=="expression"||!Im(i));case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"slider-limit":return!(i.type!=="expression"||!nF(i));case"table-icon":return i.type==="table"&&this.getGraphSettings().config.graphpaper;case"visualization-prop":return!(i.type!=="expression"||!CD(i));case"distribution-param":if(i.type!=="expression")return!1;let n=wl(i);return n?e.location in n.values:!1;case"cdf-limit":return i.type!=="expression"?!1:wd(i);case"image":return i.type==="image";case"folder":return i.type==="folder";case"text":return i.type==="text";case"expression":return!(i.type!=="expression"||this.isInEditListMode()||e.isFakeGraphFocus&&!this.getValidCursorContext());case"readonly-expression":return this.isItemReadonly(i.id)||i.type==="expression"&&this.isInEditListMode();case"braille-output":return i.type==="expression"&&this.getBrailleMode()!=="none";case"table":return i.type!=="table"?!1:P2(i,e.location);case"table-container":return i.type==="table"&&this.isInEditListMode();case"editable-label":return i.type!=="expression"?!1:Gm(i);default:return e}}shouldAllowMovingPointsWithKeyboard(){let e=this.getActiveTool();return e==="selection"||e==="box-selection"}isDragDropActive(){return!!this.listModel.dragState}isItemBeingDragged(e){let t=this.listModel.dragState;return!(!t||t.firstItemId!==e)}shouldRenderDraggedItemAsToken(){let e=this.listModel.dragState;return e?e.renderType==="token":!1}shouldShowTransformationPreview(){var e,t;return this.isGeometry()?!!((t=(e=this.getGeoModel())==null?void 0:e.getCurrentTool())!=null&&t.shouldShowTransformationPreview()):!1}canDraggedItemBeMovedIntoTokenPane(){var o,s,a,l,c;let e=this.getDraggedItemId();if(!e)return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression")return!1;let i=(o=t.formula.geometry)==null?void 0:o.valueType;if(i===void 0)return!1;let n=(a=(s=t.formula.geometry)==null?void 0:s.call)==null?void 0:a.parents;if(n){let u=(c=(l=t.formula.geometry)==null?void 0:l.call)==null?void 0:c.symbol;for(let p=0;p<n.length;p++){let g=n[p];if(!(u==="rotate"&&p===1||u==="dilate"&&p===1)){if(u==="glider"&&p===1){let h=T_(t),b=h&&h[1];return b&&b.type==="Decimal"}if(!g)return!1}}return!(__dcg_shared_module_exports__['zb'](i,__dcg_shared_module_exports__['nb'])&&!__dcg_shared_module_exports__['Xb'](u))}if(__dcg_shared_module_exports__['zb'](i,__dcg_shared_module_exports__['Ra'])){let u=t.latex.slice(t.latex.indexOf("=")+1);if(/^ *(\\left)*\([0-9. ,-]+(\\right)*\) *$/.test(u))return!0}return!1}getDraggedItemId(){let e=this.listModel.dragState;return e&&e.firstItemId}getDraggedIdentifier(){var i;let e=this.getRawDragState();if(!e)return;let t=this.getItemModel(e.dragTarget.calcId);if(!(!t||t.type!=="expression"))return(i=jo(t))==null?void 0:i.identifier}getRawDragState(){return this.listModel.dragState}initStateStack(){this.stateStack=new Au,this.stateStack.addState({diffState:this.getUndoRedoDiffState(),fullState:this.getUndoRedoFullState()})}getUndoRedoDiffState(){var e;return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoState(),expressions:$R(this.listModel),geometryToolbar:nM(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getUndoRedoFullState(){var e;return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoState(),expressions:pM(this.listModel),geometryToolbar:nM(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getState(e){var o,s;let t={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(t.stripDefaults=!!e.stripDefaults);let i=(s=(o=this.getGrapher())==null?void 0:o.getState(t))!=null?s:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getBlankState().graph),{degreeMode:this.graphSettings.degreeMode});var n={version:jl,randomSeed:this.getRandomSeed(),graph:i,expressions:WR(this.listModel,t)};if(this.isGeometry()){let a=yR(this.geometryToolbarModel,t);a&&(n.geometryToolbar=a)}return e&&e.avoidBackMigration?__dcg_shared_module_exports__['j'](n):aU(__dcg_shared_module_exports__['j'](n))}isGeometry(){return this.graphSettings.config.product==="geometry-calculator"}is3dProduct(){return this.graphSettings.config.product==="graphing-3d"}isMultiSelectEnabled(){return this.isGeometry()}canLoadPastedLink(e){return this.graphSettings.config.pasteGraphLink?this.isGeometry()?jE(e)||DL(e)||SL(e):jE(e):!1}getBlankState(e){if(this.isGeometry())return Uf;if(this.is3dProduct())return AU;let t;return(e==null?void 0:e.degreeMode)!==void 0?t=e.degreeMode:t=this.graphSettings.config.clearIntoDegreeMode,t?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},Ff),{graph:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},Ff.graph),{degreeMode:!0})}):Ff}externalSetState(e,t){this._clearPendingImageUploads(),this.rootElt&&O(document.activeElement).closest(this.rootElt).length&&O(document.activeElement).trigger("blur"),t||(t={}),e||(e=this.getBlankState()),typeof e=="string"&&(e=JSON.parse(e)),e&&(e=Uc(e));let i=this.graphSettings.config.product,n;if(!e.graph||e.graph.product===void 0?n="graphing":n=e.graph.product,n!==i)throw new Error(`Data Error: state appears to have been saved in the '${n}' product and cannot be opened in the '${i}' product.`);i==="geometry-calculator"&&(this.showConstructionsOpen=!1);let o=this.layoutModel;this.setState(e,t),KR(this.listModel),jD(this.listModel),this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},yL(this.graphSettings.config)),{keypadMinimized:o.keypadMinimized,keypadLayout:o.keypadLayout,keypadFunctionsOpen:o.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||!!t.forceExpressionsOpen)}),this.settingsViewModel=bL(),on(this,void 0),t.forceUnsavedChanges?this.enqueueEvent("change"):this.enqueueEvent("clearUnsavedChanges")}setState(e,t){if(this.isCurrentlyDoingSetState=!0,this.suggestedIdentifierRename=void 0,this.lastUserUpdatedExpressionItem=void 0,"graph"in e&&e.graph!==void 0){if("threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d){if("showBox3D"in e.graph&&this.grapher3d.webglLayer.showBox(e.graph.showBox3D),"showAxis3D"in e.graph&&this.grapher3d.webglLayer.showAxes(!!e.graph.showAxis3D),"showAxisLabels3D"in e.graph&&this.grapher3d.webglLayer.updateAxes(),"showPlane3D"in e.graph||"showAxis3D"in e.graph){let o=("showPlane3D"in e.graph?!!e.graph.showPlane3D:this.graphSettings.showPlane3D)&&("showAxis3D"in e.graph?!!e.graph.showAxis3D:this.graphSettings.showAxis3D);this.grapher3d.webglLayer.showPlane(o)}let n=this.grapher3d.baseplaneWidth();this.grapher2d.setCanvasSizeFor3D(n,n),this.grapher3d.webglLayer.setBackgroundColor(e.graph.backgroundColor3d)}let i=this.getGrapher();i?i.setGrapherState(e.graph):Mu.copyGraphProperties(e.graph,this.graphSettings),"threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d&&this.grapher3d.controls.copyWorldRotationToWorld()}if("expressions"in e){ui(this.listModel,void 0);let i=jR(e.expressions);i>=this.__nextItemId&&(this.__nextItemId=i+1),JR(this.listModel,e.expressions,t||{})}if(e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),(!t||!t.allowUndo)&&this.clearUndoRedoHistory(),this.setRandomSeed(e.randomSeed||Rd()),"geometryToolbar"in e){let i=e.geometryToolbar;this.geometryToolbarModel=UD(i)}}updateToState(e){if(this.isCurrentlyDoingRestoreState=!0,this.suggestedIdentifierRename=void 0,this.lastUserUpdatedExpressionItem=void 0,"graph"in e){let t=e.graph.threeDMode?this.grapher3d:this.grapher2d;t==null||t.setGrapherState(e.graph,{doNotClear:!0})}if("expressions"in e&&YR(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),"geometryToolbar"in e){let t=e.geometryToolbar;this.geometryToolbarModel=UD(t)}}commitUndoRedoSynchronously(e){let t=this.stateStack.getState(),i=t&&t.diffState,n=this.getUndoRedoDiffState();if(IY(i,n))return;let o={diffState:n,fullState:this.getUndoRedoFullState()};PU(e)?(this.stateStack.addState(o),this.enqueueEvent("change",e)):this.stateStack.replaceInteriorState(o)}undo(){if(!this.canUndo())return;this.closeToast(),this.stateStack.undo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}redo(){if(!this.canRedo())return;this.stateStack.redo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}clearUndoRedoHistory(){this.stateStack.clear()}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}closeToast(){let e=this.toastData.onHide;e&&this.runAfterDispatch(e),this.toastData={}}_closeAddExpression(){this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{addExpressionOpen:!1})}doesDOMHaveSize(){return this.layoutMeasurements.width>0&&this.layoutMeasurements.height>0}_getExpListWidth(){var e;if(this.userSpecifiedExpListWidth!==void 0){let n=this.isGeometry()?320:200;e=Math.max(280,Math.min(this.layoutMeasurements.width-n,this.userSpecifiedExpListWidth))}else{if(e=this.layoutMeasurements.width,!e)return 356;var t=.2*e+160;e=Math.min(500,Math.max(280,t))}var i=this.layoutMeasurements.width-this.getGrapherHeight();return Math.abs(i-e)<=10?i:e}_setExpListWidth(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)}getKeypadHeight(){return this.computeMajorLayout().keypad.height}isKeypadEnabled(){return!!this.graphSettings.config.keypad}isKeypadOpen(){if(!this.isKeypadEnabled())return!1;let e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e}isHideKeypadButtonVisible(){return this.getBrailleMode()==="none"&&this.isKeypadOpen()&&(!this.isNarrow()||this.inAudioTraceMode())}isKeypadFunctionsPopoverOpen(){return!!this.layoutModel.keypadFunctionsOpen}getKeypadLayout(){return this.layoutModel.keypadLayout}isLetterKeypadOpen(){let e=this.getKeypadLayout();return this.isKeypadOpen()&&(e==="letters"||e==="noQwertyLetters"||e==="capitalLetters"||e==="noQwertyCapitalLetters")}isFileDraggedOver(){return this.layoutModel.isFileDraggedOver}getGeoToolbarHeight(){return this.shouldShowGeoToolbar()?48:0}isNarrowGeometryHeader(){return this.computeMajorLayout().grapher.width<450}shouldShowMultiSelectHeader(){return this.getSelectedGeoExpression()||this.hasMultipleItemsSelected()}getGrapherHeight(){return this.layoutMeasurements.height-this.getGeoToolbarHeight()}computeMajorLayout(){var e=this.layoutMeasurements.width,t=this.layoutMeasurements.height,i=this.isNarrow(),n=this.isListVisible(),o=this.isKeypadOpen(),s=!this.isGrapherEnabled(),a=!this.isListEnabled(),l=!!this.getGraphSettings().config.projectorMode,c={left:0,top:0,width:0,height:0},u={left:0,top:0,width:0,height:0,paddingTop:0},p={left:0,top:t,width:e,height:l?i?185:193:169};a?(u.width=e,u.height=t):s?(c.width=e,c.height=t):n?i?(c.width=e,c.height=Math.round(.58*t),c.top=t-c.height,u.width=e,u.height=t-c.height):(c.width=this.getExpListWidth(),c.height=t,u.left=c.width,u.width=e-u.left,u.height=t):n||(i?(c.width=e,c.height=Math.round(.58*t),c.top=t,u.width=e,u.height=t):(c.width=this.getExpListWidth(),c.height=t,c.left=-c.width,u.width=e,u.height=t)),o&&(p.top-=p.height,a||(c.height-=p.height));let g=this.getGeoToolbarHeight();return g&&(u.top+=g,u.height-=g),{list:c,grapher:u,keypad:p}}isNarrow(){return this.isGeometry()?this.layoutMeasurements.width<600:this.layoutMeasurements.width<450}getLayoutMeasurements(){return this.layoutMeasurements}getCapExpressionSize(){return!!this.getGraphSettings().config.capExpressionSize}handleAudioTraceCommand(e){let t=this.getAudioGraph();if(t===void 0)return;let i=t.agNavigator;switch(e){case"on":this.runAfterDispatch(()=>{t.enterAudioTrace({fromKeypad:!0})});break;case"off":this.runAfterDispatch(()=>{t.exitAudioTrace()});break;case"hear-graph":t.hearGraph();break;case"stop-graph":t.stopGraph();break;case"volume-down":t.adjustVolume("down");break;case"volume-up":t.adjustVolume("up");break;case"speed-down":t.speedDown();break;case"speed-up":t.speedUp();break;case"previous-point":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPoint()});break;case"next-point":this.runAfterDispatch(()=>{t.reportAndMoveToNextPoint()});break;case"previous-poi":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPOI()});break;case"next-poi":this.runAfterDispatch(()=>{t.reportAndMoveToNextPOI()});break;case"previous-curve":this.runAfterDispatch(()=>{i.prevCurve()});break;case"next-curve":this.runAfterDispatch(()=>{i.nextCurve()});break;case"describe-point":t.describePoint();break;case"describe-curve":t.describeCurve();break;case"describe-axes":t.describeAxes();break;case"keyboard-shortcuts":this.enqueueEvent("showHotkeysModal",{type:"keypad/audio-trace",command:e});break;default:return e}}setAudioTraceSpeed(e){let t=this.getAudioGraph();t&&t.adjustPlaybackSpeed(e)}setGraphPaperFocus(e){var t;on(this,e.isFocused?{type:"graph-paper"}:void 0),(t=this.get2dPOIController())==null||t.keyboardAttentionManager.setKeyboardAttention(void 0),this.requestRedrawGraph(),e.isFocused&&this.isGeoToolActive()&&this.runAfterDispatch(()=>{var i;(i=this.get2dPOIController())==null||i.keyboardAttentionManager.handleGrapherGainedFocus()})}isGraphPaperFocused(){let e=this.getFocusLocation();return e?!!(e.type==="graph-paper"||e.type==="expression"&&e.isFakeGraphFocus):!1}isVirtualMouseAllowed(){return!(!this.isGeometry()||!this.isGraphPaperFocused()||!this.geoModel.getCurrentTool().canNextInputBePoint())}isClickableId(e){return Ym(this.getItemModel(e))}setCanShowKeyboardShortcuts(e){this.canShowKeyboardShortcuts=e}getCanShowKeyboardShortcuts(){return this.canShowKeyboardShortcuts}apply3dProps(e){if(!this.isThreeDMode()||!this.grapher3d)return;let t=this.grapher3d.webglLayer;for(let i in e)switch(i){case"showPlane3D":t.showPlane(this.showPlane3D());break;case"showBox3D":t.showBox(!!e[i]);break;case"showAxis3D":t.showAxes(!!e[i]),t.showPlane(this.showPlane3D());break;case"showAxisLabels3D":t.updateAxes();break;case"threeDMode":e[i]&&(t.updatePlaneMap(),this.grapher3d.controls.animateTransitionFrom2Dto3D());break;default:break}}getGeometryTokenCount(){if(!this.cachedGeoTokenDepths)return 0;let e=0;return __dcg_shared_module_exports__['m'](__dcg_shared_module_exports__['E'](this.cachedGeoTokenDepths),t=>e+=t?t.length:0),e}getAllGeometryConstructionIds(){return VR(this.listModel,__dcg_shared_module_exports__['Jc'])}makeGeoAPI(){this.geoModel=new rx(this)}getGeoTokenInfoFromIdentifier(e){if(e)return this.cachedGeoTokenInfo[e]}getGhostMode(){return this.getGraphSettings().config.getProperty("ghostMode")}isDispatching(){return this.dispatcher.isDispatching()}getSuggestedIdentifierRenameInfo(e){if(this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id===e)return this.suggestedIdentifierRename}updateSuggestedIdentifierRenameInfo(){if(!this.shouldShowAuthorFeatures())return;let e=this.lastUserUpdatedExpressionItem;if(!e){this.suggestedIdentifierRename=void 0;return}this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id!==e.id&&(this.suggestedIdentifierRename=void 0);var t=e.formula.assignment||"",i=t?__dcg_shared_module_exports__['Ib'](t):"";if(!this.suggestedIdentifierRename){i&&(this.suggestedIdentifierRename={id:e.id,from:i,to:i,countOfChanges:0});return}if(i!==this.suggestedIdentifierRename.to){if(this.suggestedIdentifierRename.to=i,this.suggestedIdentifierRename.from===this.suggestedIdentifierRename.to||!this.suggestedIdentifierRename.from||!this.suggestedIdentifierRename.to){this.suggestedIdentifierRename.countOfChanges=0;return}if(this.countIdentifierAssignments(t)>1){this.suggestedIdentifierRename.countOfChanges=0;return}var n=this.countGlobalIdentifierOccurences(this.suggestedIdentifierRename.from);this.suggestedIdentifierRename.countOfChanges=n}}getMathquillConfig(e){let t=e.additionalOperators||[];return{autoOperatorNames:$a({additionalOperators:t,includeGeometryFunctions:this.isGeometry(),include3DFunctions:this.is3dProduct()}),autoCommands:Id({additionalCommands:this.isGeometry()?[]:["int"],disallowAns:this.isGeometry()})}}constrainMultiSelect(){if(this.isMultiSelectEnabled())return;let e=JD(this.listModel);e.length>1&&ui(this.listModel,e[0])}focusFirstExpression(){if(!this.getGraphSettings().config.expressions)return;let e=Um(this.listModel);e&&Go(this,e.id,"end")}};function _U(r){return r&&__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0})}function IY(r,e){return __dcg_shared_module_exports__['G'](_U(r),_U(e))}var fy=__dcg_shared_module_exports__['h'](X());ct();var px=class{constructor(e){this.controller=e}handleKeydown(e){var i,n;let t=Di(e);if(Th(e))e.stopPropagation(),e.preventDefault(),this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"});else if(Mh(e))e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"redo"});else if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&t==="Z"){let o=this.controller.getSelectedItem();o&&o.id&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"expression-zoom-fit",id:o.id,focusAfterTap:!1}))}else if(e.altKey!==di&&e.metaKey===di&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.isDecimalToFractionEnabled()){let o=this.controller.getSelectedItem();o&&o.type==="expression"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:o.id}),this.controller.runAfterDispatch(()=>{vp(o)?xe(this.controller.s("shared-calculator-narration-show-as-fraction")):xe(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.altKey&&e.ctrlKey!==di&&e.metaKey===di&&t==="F"){if(this.controller.isExpressionListFocused()){let o=it.getFocusedMathquill(),s="";try{s=o.__controller.cursor.selection.join("latex")||""}catch(a){}this.controller.dispatch({type:"open-expression-search",rename:!!e.shiftKey,latex:s}),e.preventDefault(),e.stopPropagation()}}else if((e.altKey||e.metaKey)&&!e.ctrlKey&&!e.shiftKey&&t===void 0){if(Re(e)===So){let o=this.controller.getSelectedItem();o&&o.type==="folder"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:o.id,isCollapsed:!0}),xe(this.controller.s("graphing-calculator-narration-folder-collapsed")))}else if(Re(e)===Eo){let o=this.controller.getSelectedItem();o&&o.type==="folder"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:o.id,isCollapsed:!1}),xe(this.controller.s("graphing-calculator-narration-folder-expanded")))}}else if(e.shiftKey&&(e.altKey||e.metaKey)&&!e.ctrlKey){if(Re(e)===So)e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!0}),xe(this.controller.s("graphing-calculator-narration-all-folders-collapsed"));else if(Re(e)===Eo)e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!1}),xe(this.controller.s("graphing-calculator-narration-all-folders-expanded"));else if(t==="E"){if(!this.controller.isListEnabled())return;this.controller.isListVisible()?(this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}),xe(this.controller.s("graphing-calculator-narration-hide-expression-list"))):(this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1}),this.focusExpressionList()),e.preventDefault(),e.stopPropagation()}}else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey){if(t==="E"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.focusExpressionList()}else if(t==="X"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(xe(this.controller.s("graphing-calculator-narration-add-expression")),this.controller.dispatch({type:"new-expression"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-expression"))}else if(t==="O"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(xe(this.controller.s("graphing-calculator-narration-add-note")),this.controller.dispatch({type:"new-text"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-note"))}else if(t==="F"&&this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled())e.preventDefault(),e.stopPropagation(),xe(this.controller.s("graphing-calculator-narration-add-folder")),this.controller.dispatch({type:"new-folder"});else if(t==="I"&&this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled())e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.runAfterDispatch(()=>{let o=this.controller.findEl(".dcg-add-expression-container input[type=file]");o&&(O(o).trigger("click"),xe(this.controller.s("graphing-calculator-narration-add-image")))});else if(t==="T")e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(xe(this.controller.s("graphing-calculator-narration-add-table")),this.controller.dispatch({type:"new-table"})):xe(this.controller.s("graphing-calculator-narration-unable-to-add-table"));else if(t==="M"&&this.controller.isGeoUIActive()){e.preventDefault(),e.stopPropagation();let o=this.controller.getActiveTool();this.controller.shouldShowMultiSelectHeader()?this.controller.dispatch({type:"set-focus-location",location:{type:"geo-header-back-link"}}):(o==="expression-edit"&&(o="selection"),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:o}}))}else if(t==="C"&&this.controller.isGeoUIActive())e.preventDefault(),e.stopPropagation(),this.controller.getGeometryTokenCount()>0?this.controller.dispatch({type:"set-show-constructions-open",open:!0,setFocus:!0}):xe(this.controller.raw("Object navigator has no items."));else if(t==="G")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0});else if(t==="P"){if(e.preventDefault(),e.stopPropagation(),this.controller.isGeometry()){let o=this.controller.getFocusLocation(),s=this.controller.getValidCursorContext();if(o&&o.type==="expression"&&s&&s.type!=="empty"){this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:o.id,isFakeGraphFocus:!0}}),(n=(i=this.controller.getGrapher2d())==null?void 0:i.poiController)==null||n.keyboardAttentionManager.handleGrapherGainedFocus();return}}this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}else if(t==="Z"){let o=this.controller.getSelectedItem();o&&o.id&&this.controller.dispatch({type:"expression-zoom-fit",id:o.id,focusAfterTap:!1})}else if(t==="D"&&this.controller.canUserAddExpressions()){e.preventDefault(),e.stopPropagation();let o=!this.controller.isInEditListMode();this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:o,focusExpressionList:!0})}}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if(Re(e)===ul)(!document.activeElement||!gp(O(document.activeElement)))&&e.preventDefault();else if(Re(e)===Do&&!this.controller.getOpenItemMenu()&&!this.controller.isGraphSettingsOpen()){if(this.controller.isGeoUIActive()){let o=!1,s=this.controller.getGeoModel();if(this.controller.hasAnyItemsSelected()&&(this.controller.dispatch({type:"set-none-selected"}),o=!0),s.isToolplayActive()&&(this.controller.dispatch({type:"cancel-geo-toolplay"}),xe(this.controller.s("graphing-calculator-narration-geometry-tool-cancelled")),o=!0),this.controller.isGraphPaperFocused()&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),o=!0),this.controller.getActiveTool()!=="selection"&&!o){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});let a=this.controller.getFocusLocation();a&&a.type==="geo-basic-tool"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),o=!0}if(o){e.preventDefault(),e.stopPropagation();return}}this.controller.isInEditListMode()&&!this.controller.findEl(".dcg-options-menu")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0}))}}else if(!e.metaKey&&!e.shiftKey&&e.ctrlKey===di&&e.altKey===!di){if(t==="N"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"nemeth"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth"))}else if(t==="U"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"ueb"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb"))}else if(t==="Q"||t==="X"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"none"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}else if(t==="6"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation();let o=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:o}),xe(o?this.controller.s("shared-calculator-narration-six-key-mode-on"):this.controller.s("shared-calculator-narration-six-key-mode-off"))}else if(t==="D")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-graph-settings",degreeMode:!this.controller.getGraphSettings().degreeMode}),xe(this.controller.getGraphSettings().degreeMode?this.controller.s("graphing-calculator-button-settings-degrees"):this.controller.s("graphing-calculator-button-settings-radians"));else if(t==="K"){if(!this.controller.isKeypadEnabled()||this.controller.inAudioTraceMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/set-minimized",minimized:this.controller.isHideKeypadButtonVisible()})}}}focusExpressionList(){let e=this.controller.getSelectedItem();e?this.controller.dispatch({type:"move-focus-to-item",id:e.id}):this.controller.dispatch({type:"focus-first-expression"})}};ct();function kL(){if(!document.activeElement)return;let r=O(document.activeElement);gp(r)&&O("<input />").prependTo("body").trigger("focus").attr({readonly:"readonly",disabled:"true"}).trigger("blur").remove()}ct();var VY=function(){{var r=0,e=1,t=2,i=!1,n=function(){o(document),i=!0},o=function(s){i||O(s).bind("touchstart",function(a){var l=O(a.target),c=r,u=null;if(!l.closest("[disablescroll]").length)for(;c===r&&l.length&&l[0].tagName!==void 0;){var p=l.css("overflow"),g=l.css("overflow-y");if(p!=="hidden"&&p!=="visible"&&g!=="hidden"&&g!=="hidden"){var h=l.scrollTop();h!==0&&(c=t),l.scrollTop(h+1),l.scrollTop()!==h&&(c=e|c,l.scrollTop(h))}l=l.parent()}if(c!==r){u=[];for(var b=a.originalEvent.touches,C=0;C<b.length;C++){var D={};for(var S in b[C])b[C].hasOwnProperty(S)&&(D[S]=b[C][S]);u.push(D)}}O(document).on("touchmove.scrollfix",function(V){if(u){var k=u[0],T=V.originalEvent.touches[0],A=T.screenY-k.screenY;(A>0&&!(c&t)||A<0&&!(c&e))&&(c=r),A&&(u=null)}c===r&&V.preventDefault()}),O(document).on("touchend.scrollfix",function(){O(document).off(".scrollfix")})})};return{limitScrollOnElement:o,limitScrollOnDocument:n}}}();var{limitScrollOnElement:JE,limitScrollOnDocument:FU}=VY;var ar=__dcg_shared_module_exports__['h'](X());ct();var wt=__dcg_shared_module_exports__['h'](X());ct();var Jl=__dcg_shared_module_exports__['h'](X()),YE=__dcg_shared_module_exports__['h'](jU());var VL=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function JU(r,e){let t=0,i=0,n={},o={},s=a(r);if(!/^<0>/.test(s)||!/<\/0>$/.test(s))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(s));return s.slice(3,-4).trim();function a(c){if(e.isConst(c))return FY(e.getConstValue(c));if(e.isNamedBinding(c)){let u=l(n,e.getBindingName(c)),p=`{$${u}}`;if(!VL.test(p))throw new Error(`Invalid <Localize> variable: ${p}.`);return e.addBinding&&e.addBinding(u,c),n[u]=!0,p}else if(c!==r&&e.isView(c)){let u=l(o,e.getViewName(c));if(!/[a-zA-Z0-9\-_]/.test(u))throw new Error(`Invalid <Localize> subview identifier: ${u}.`);return e.addView&&e.addView(u,c),o[u]=!0,`<${u}/>`}else if(e.isBinding(c)){let u=l(n,`v${t++}`),p=`{$${u}}`;return e.addBinding&&e.addBinding(u,c),n[u]=!0,p}else{let u=`${i++}`;e.addElement&&e.addElement(u,c);let p=[];return e.forEachChild(c,g=>{p.push(a(g))}),o[u]=!0,p.length>0?`<${u}>${p.join("")}</${u}>`:`<${u}/>`}}function l(c,u){let p=0,g=u;for(;c[g];)g=`${u}-${++p}`;return g}}var _Y=!0;function FY(r){return _Y?r:r.replace(/\{|\}/g,e=>`{"${e}"}`).replace(/(^|[\s\n]+)(\[|\]|\.)/g,(e,t,i)=>`${t}{"${i}"}`)}function RY(r){return r.__DCGViewLocalizeBindingName}function NY(r){return typeof r=="function"&&r.__DCGViewLocalizeViewName}var Wi=class extends Jl.Class{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n(),this.templateString=this.serializeToTemplateString(Jl.createElement("div",null,this.children))}template(){return Jl.createElement(Jl.Components.If,{predicate:()=>this.shouldShow()},()=>Jl.createElement(Jl.Components.Switch,{key:()=>TL(this.translatedString())},e=>this.renderDeserializedTemplateNode(this.parseAndValidate(e))))}shouldShow(){let e=this.props.options&&this.props.options();return e&&e.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let e={};for(let t in this.bindingMap)e[t]=Fa(`{$${t}}`);return this.i18n.s(this.props.key(),e)}static variable(e,t){let i=()=>t();return i.__DCGViewLocalizeBindingName=e,i}static subview(e,t){let i=()=>t();return i.__DCGViewLocalizeViewName=e,i}parseAndValidate(e){let t=(0,YE.parse)(e),i={},n={};o(t);for(let s in this.elementMap)if(!n[s])return(0,YE.parse)(TL(this.templateString));for(let s in this.bindingMap)if(!i[s])return(0,YE.parse)(TL(this.templateString));return t;function o(s){if(Array.isArray(s)){for(let a of s)o(a);return}s.name==="token"?i[s.attrs.id]=!0:s.type!=="text"&&(n[s.name]=!0,o(s.children))}}renderDeserializedTemplateNode(e){if(Array.isArray(e))return e.map(t=>this.renderDeserializedTemplateNode(t));if(e.type==="text")return Jl.const(e.content||"");if(e.name==="token"){let t=this.bindingMap[e.attrs.id];return t||(()=>"")}else if(this.elementMap[e.name]){let t=this.elementMap[e.name],i=e.children.map(n=>this.renderDeserializedTemplateNode(n));return XU(t.type,t.attrs,i)}else return this.viewMap[e.name]?this.viewMap[e.name]():XU("span",{},[])}serializeToTemplateString(e){return JU(e,{isView:NY,isConst:YU,isBinding:t=>typeof t=="function",isNamedBinding:RY,getConstValue:t=>t(),getBindingName:t=>t.__DCGViewLocalizeBindingName,getViewName:t=>t.__DCGViewLocalizeViewName,addBinding:(t,i)=>{this.bindingMap[t]=i},addElement:(t,i)=>{this.elementMap[t]={type:i.tagName,attrs:i.attrs}},addView:(t,i)=>{if(this.viewMap[t])throw new Error(`Unexpected duplicate view ${t}.`);this.viewMap[t]=i},forEachChild:(t,i)=>{for(let n of t.children){if(!YU(n)&&typeof n!="function"&&n._isDCGView)throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");i(n)}}})}};function YU(r){return typeof r=="function"&&r.isDCGViewConst}function XU(r,e,t){return Jl.createElement(r,e,t)}function TL(r){return`<0>${r}</0>`.replace(new RegExp(VL.source,"g"),(t,i)=>`<token id="${i}"/>`)}ct();var QU=__dcg_shared_module_exports__['h'](X());function BY(r){let e=r.target;return e.classList.contains("dcg-exp-action-button")||e.classList.contains("dcg-icon-duplicate")||e.classList.contains("dcg-icon-remove")||e.classList.contains("dcg-icon-lock")||e.classList.contains("dcg-icon-pencil")}var Sa=class extends QU.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()}onItemViewMounted(){this._isDragCopy||(this.model.dcgView=this),this._isFirstRender=!1}onItemViewUnmounted(){this._isDragCopy||(this.model.dcgView=void 0)}isFirstRender(){return this._isFirstRender}onMouseSelect(e){if(this.controller.isInEditListMode()&&!BY(e)){this.exitEditListMode();return}this.controller.isItemReadonly(this.id)||e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}onDragPending(e){this.controller.isItemReadonly(this.model.id)||this.props.onDragPending(e)}exitEditListMode(){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0})}};var Ws=__dcg_shared_module_exports__['h'](X());var Lu=__dcg_shared_module_exports__['h'](X());var ms=class extends Lu.Class{template(){return Lu.createElement(Ke,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity},Lu.createElement("div",{class:()=>({"dcg-tooltipped-error":!0,"dcg-white":this.props.isWhite&&this.props.isWhite(),"dcg-small":this.props.size&&this.props.size()==="small"})},Lu.createElement("i",{class:Lu.const("dcg-icon-error"),"aria-hidden":Lu.const("true")})))}};var fs=__dcg_shared_module_exports__['h'](X());var $s=__dcg_shared_module_exports__['h'](X());var{If:XE}=$s.Components,Io=class extends $s.Class{template(){return $s.createElement("span",{class:()=>{var e,t,i;return{"dcg-do-not-blur":!0,"dcg-circular-icon":!0,"dcg-thick-outline":this.isThickOutline(),"dcg-white-icon":!!this.props.whiteIcon&&this.props.whiteIcon(),"dcg-hidden":this.isHidden(),"dcg-semi-transparent":this.props.semiTransparent&&this.props.semiTransparent(),"dcg-colored-icon":this.isColoredIcon(),"dcg-do-not-invert":(i=(t=(e=this.props).dontInvert)==null?void 0:t.call(e))!=null?i:!1,"dcg-has-background-image":this.hasBackgroundImage(),[this.iconModifier()]:this.iconModifier().length>0}},style:this.bindFn(this.getIconStyle)},$s.createElement(XE,{predicate:this.bindFn(this.hasBackgroundImage)},()=>$s.createElement("span",{class:$s.const("dcg-background-image"),style:()=>({"background-image":this.props.backgroundImage&&this.props.backgroundImage(),opacity:this.props.backgroundOpacity&&this.props.backgroundOpacity()})})),$s.createElement(XE,{predicate:()=>!!this.backgroundIcon()},()=>$s.createElement("i",{class:()=>({[this.backgroundIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({opacity:this.backgroundOpacity()})})),$s.createElement(XE,{predicate:()=>!!this.primaryIcon()},()=>$s.createElement("i",{class:()=>({[this.primaryIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({color:this.props.foregroundColor&&this.props.foregroundColor()})})),$s.createElement(XE,{predicate:()=>this.props.iconType()==="loading"},()=>$s.createElement("span",{class:$s.const("dcg-spinner")})))}isColoredIcon(){return!this.isThickOutline()&&!this.isHidden()&&!this.hasBackgroundImage()&&this.props.iconType()!=="loading"}iconModifier(){if(!this.props.iconModifier)return"";switch(this.props.iconModifier()){case"medium":return"dcg-modifier-size-medium";case"large":return"dcg-modifier-size-large";case"small":return"dcg-modifier-size-small";case"rotated":return"dcg-modifier-rotated";case"none":return""}}getIconStyle(){let e=!this.isHidden()&&this.props.backgroundColor?Qm(this.props.backgroundColor()):void 0;return e?{background:e}:{}}isHidden(){return this.props.iconType()==="hidden"}isThickOutline(){let e=this.props.iconType();return e==="folder"||e==="pause"||e==="play"||e==="fraction"||e==="action"||e==="metronome"}hasBackgroundImage(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()}primaryIcon(){let e=this.props.iconType();switch(e){case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-open";case"point-cross":return"dcg-icon-cross";case"point-default":return"dcg-icon-point";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":case"loading":return"";case"fraction":return"dcg-icon-fraction";case"boxplot":return"dcg-icon-boxplot";case"dotplot-cross":return"dcg-icon-dotplot-cross";case"dotplot-default":return"dcg-icon-dotplot-default";case"dotplot-open":return"dcg-icon-dotplot-open";case"histogram":return"dcg-icon-histogram";case"unfilled-distribution":case"filled-distribution":return"dcg-icon-distribution";case"action":return"dcg-icon-chevron-right";case"metronome":return"dcg-icon-metronome-2";case"arrow-right":return"dcg-icon-arrow-right";default:return e}}backgroundOpacity(){let e=this.backgroundIcon();return e==="dcg-icon-polygon-filled"||e==="dcg-icon-parametric-filled"||e==="dcg-icon-shaded-inequality-shade2"||e==="dcg-icon-distribution-fill"||e==="dcg-icon-histogram-fill"?.5:1}backgroundIcon(){let e=this.props.iconType();return e==="filled-distribution"?"dcg-icon-distribution-fill":e==="histogram"?"dcg-icon-histogram-fill":e==="polygon-dashed-filled"||e==="polygon-dotted-filled"||e==="polygon-default-filled"||e==="polygon-none-filled"?"dcg-icon-polygon-filled":e==="parametric-dashed-filled"||e==="parametric-dotted-filled"||e==="parametric-default-filled"||e==="parametric-none-filled"?"dcg-icon-parametric-filled":e==="table-points-and-lines"?"dcg-icon-lines-solid":e==="shaded-inequality"?"dcg-icon-shaded-inequality-shade2":e==="action"?"dcg-icon-minus":""}};var QE=class extends fs.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return fs.createElement("div",{class:fs.const("dcg-play-pause-icon-view")},fs.createElement(Ke,{gravity:this.const("se"),tooltip:()=>this.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing"),disabled:()=>!this.controller.getTickerPlaying(),sticky:this.const(!0)},fs.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.controller.getTickerPlaying()}),"aria-label":this.bindFn(this.getAriaLabel),role:fs.const("button"),tabindex:fs.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.toggleSliderIsPlaying()},manageFocus:this.const(Vt({controller:this.controller,location:{type:"slider-icon",id:this.model.id}}))},fs.createElement(Io,{iconType:()=>this.getIconType(),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))),fs.createElement("div",{class:fs.const("dcg-slider-menu-container")},fs.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-animation-properties-tooltip"),gravity:this.const("e")},fs.createElement("div",{class:()=>({"dcg-slider-menu-opener":!0,"dcg-menu-open":this.myOptionsOpen()}),tabindex:fs.const(0),"dcg-open-menu-guid":()=>this.getMenuGUID(),role:fs.const("button"),"aria-label":()=>this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-animation-properties"):this.controller.s("graphing-calculator-narration-show-animation-properties"),onTap:e=>{e.wasHandled("dragdrop")||e.wasLongheld()||this.toggleOptions(e)},manageFocus:this.const(Vt({controller:this.controller,location:{type:"slider-animation-properties-icon",id:this.model.id}}))},fs.createElement("i",{class:this.bindFn(this.getIcon),"aria-hidden":fs.const("true")})))))}getIcon(){return __dcg_shared_module_exports__['Ma'](this.model.slider.loopMode)}getIconType(){return!this.model.slider.isPlaying||TT(this.model)?"play":"pause"}getMenuGUID(){return"slider-"+this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"slider",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}getAriaLabel(){if(!this.model.sliderExists)return"";var e=po(this.model);return e?this.model.slider.isPlaying?this.controller.s("graphing-calculator-narration-pause-variable-animation",{variable:e}):this.controller.s("graphing-calculator-narration-play-variable-animation",{variable:e}):""}toggleSliderIsPlaying(){if(this.model.sliderExists){var e="",t=po(this.model);TT(this.model)?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-restarted",{variable:t})),this.controller.dispatch({type:"play-slider-from-min",id:this.model.id})):this.model.slider.isPlaying?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-paused",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!1})):(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-playing",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!0})),e!==""&&xe(e)}}};var Nd=__dcg_shared_module_exports__['h'](X());var ZE=class extends Nd.Class{constructor(){super(...arguments),this.isAnimating=!1,this.unmounted=!1}init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Nd.createElement("div",{class:()=>({"dcg-action-icon-view":!0,"dcg-action-icon-view-animating":this.isAnimating})},Nd.createElement("div",{class:Nd.const("dcg-circular-icon-container"),"aria-label":()=>this.controller.s("graphing-calculator-narration-run-action-icon"),role:Nd.const("button"),tabindex:Nd.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.runActionOnce()},manageFocus:this.const(Vt({controller:this.props.controller(),location:{type:"action-icon",id:this.model.id}}))},Nd.createElement(Io,{iconType:this.const("action"),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})))}willUnmount(){this.unmounted=!0}runActionOnce(){this.isAnimating=!0,this.controller.dispatch({type:"action-single-step",id:this.model.id}),setTimeout(()=>{this.isAnimating=!1,this.unmounted||this.update()},150)}};var{SwitchUnion:KY}=Ws.Components,UY="#6A93D2",ZU="#000",e5="#fff",hx=class extends Ws.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Ws.createElement("div",{class:Ws.const("dcg-expression-icon-container")},KY(this.bindFn(this.getIconMode),{error:()=>Ws.createElement(ms,{error:this.bindFn(this.getErrorMsg),isWhite:this.bindFn(this.isSelected),gravity:this.const("se")}),none:()=>Ws.createElement("span",null),slider:()=>Ws.createElement(QE,{controller:this.props.controller,model:this.props.model}),action:()=>Ws.createElement(ZE,{controller:this.props.controller,model:this.props.model}),icon:()=>Ws.createElement("div",{class:Ws.const("dcg-circular-icon-container"),role:Ws.const("button"),tabindex:Ws.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if((this.controller.isInEditListMode()||e.shiftKey)&&!this.isFraction())return this.toggleOptions(e);if(this.isFraction())return this.onToggleFractionDisplay();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),!this.isFraction()&&this.toggleOptions(e)},manageFocus:this.const(Vt({controller:this.controller,location:{type:"expression-icon",id:this.model.id}}))},Ws.createElement(Io,{iconType:this.bindFn(this.getIconType),backgroundColor:this.bindFn(this.getBackgroundColor),whiteIcon:this.bindFn(this.isSelected),foregroundColor:this.bindFn(this.getForegroundColor),iconModifier:this.bindFn(this.getIconModifier),backgroundImage:this.bindFn(this.backgroundImage),backgroundOpacity:this.const(1)}))}))}backgroundImage(){let e=this.getBackgroundColor();return e.type==="image"?`url("${e.value}")`:""}getErrorMsg(){return this.colorError()?this.controller.s("shared-calculator-error-color-not-assigned"):this.controller.unpack(this.model.error)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}isFraction(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)}getIconMode(){return this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?Nl(this.model)?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":this.isNonemptyAction()?"action":"none":"none"}toggleGraphShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}colorError(){return!!this.model.formula.rgb_value&&!this.model.formula.assignment}hasError(){return this.colorError()?!0:!!this.model.error&&!Na(this.model)&&this.controller.getBrailleMode()==="none"}hasSlider(){return!!this.model.sliderExists}isNonemptyAction(){return Im(this.model)}getDisplayProps(){let{points:e,lines:t,fill:i}=this.model;return __dcg_shared_module_exports__['yc'](this.model.formula.expression_type,{points:e,lines:t,fill:i})}getBackgroundColor(){if(!this.isFraction())return Zb(this.model);let e=this.isSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?{type:"single-color",value:e?e5:ZU}:{type:"single-color",value:""}}getForegroundColor(){if(!this.isFraction())return"";let e=this.isSelected(),t=this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id);return e!==t?e5:e?UY:ZU}onToggleFractionDisplay(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})}getIconModifier(){return Sp(this.model)&&hu(this.model,"alignedAxis")==="y"?"rotated":"none"}getIconType(){if(this.isFraction())return"fraction";if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";let e=this.model.pointStyle,t=this.model.lineStyle,i=this.getDisplayProps(),n=this.model.formula;if(Sp(this.model))return"boxplot";if(fu(this.model)){if(this.model.pointStyle==="POINT")return"dotplot-default";if(this.model.pointStyle==="CROSS")return"dotplot-cross";if(this.model.pointStyle==="OPEN")return"dotplot-open"}if(Nh(this.model))return"histogram";if(Ep(this.model))return wd(this.model)?"filled-distribution":"unfilled-distribution";if(rn(this.model)==="X")return"movable-horizontal";if(rn(this.model)==="Y")return"movable-vertical";if(rn(this.model)==="XY")return"movable-both";if(Kl(this.model))return ta(this.model)?e==="OPEN"?"point-open":e==="CROSS"?"point-cross":"point-default":i.lines&&i.points?"table-points-and-lines":i.lines?"table-lines":"table-points";if(bD(this.model))return"point-default";if(wD(this.model))return"polygon-default-filled";let o=this.getDisplayProps().fill;if(yd(this.model))return o?i.lines?t==="DASHED"?"polygon-dashed-filled":t==="DOTTED"?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":i.lines?t==="DASHED"?"polygon-dashed":t==="DOTTED"?"polygon-dotted":"polygon-default":"none";if(mu(this.model))return o?i.lines?t==="DASHED"?"parametric-dashed-filled":t==="DOTTED"?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":i.lines?t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default":"none";var s=n.operator,a=__dcg_shared_module_exports__['Pb'][s].direction!==0,l=__dcg_shared_module_exports__['Pb'][s].inclusive===!1;return n.is_shade_between||!l&&a?"shaded-inequality":l&&!a?"inequality":l&&a?"shaded-inequality":t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default"}getIconAriaLabel(){return this.isFraction()?vp(this.model)?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction"):this.myOptionsOpen()?$i(this.model,"hide-options"):this.controller.isInEditListMode()?$i(this.model,"show-options"):this.model.hidden?$i(this.model,"show"):$i(this.model,"hide")}};var sn=__dcg_shared_module_exports__['h'](X());var ek=__dcg_shared_module_exports__['h'](X());var HY=.9,gg=class extends ek.Class{template(){return ek.createElement("div",{class:()=>{var e,t;return{"dcg-color-swatch":!0,"dcg-color-evaluation":(t=(e=this.props).isEvaluation)==null?void 0:t.call(e),"dcg-light-color":dS(this.props.color(),this.props.invertSwatches(),HY)}},style:()=>({background:Qm(this.props.color())})})}};var{If:qY,SwitchUnion:zY}=sn.Components;function $Y(r,e){return __dcg_shared_module_exports__['Fb'](r,e)}var mg=class extends sn.Class{init(){this.controller=this.props.controller()}template(){return sn.createElement("div",{class:sn.const("dcg-evaluation-container")},sn.createElement("div",{didMount:e=>this.containerNode=e,class:()=>({"dcg-evaluation":!0,"dcg-do-blur":!0,"dcg-hidden":this.props.controller().isInEditListMode()}),handleEvent:sn.const("true"),tabindex:()=>this.props.focusable()&&this.controller.getBrailleMode()==="none"?"0":"-1",onFocus:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onSelectEvaluation()},onBlur:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onUnselectEvaluation()},onTap:()=>{var e;return(e=this.containerNode)==null?void 0:e.focus()}},sn.createElement(Cn,__dcg_shared_module_exports__['a']({latex:this.bindFn(this.getBrailleEvaluation),ariaLabel:this.const(""),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="braille-output"?!1:e.id===this.props.id()},onBrailleInput:()=>{},isStatic:this.const(!0),onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"braille-output",id:this.props.id()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"braille-output",id:this.props.id()}})}},go(this.controller,{gravity:"sw"})),sn.createElement("div",{class:sn.const("dcg-evaluation-label-container")},sn.createElement(qY,{predicate:()=>!!this.props.dependent()},()=>sn.createElement(tt,{latex:()=>__dcg_shared_module_exports__['Ib'](this.props.dependent()),config:this.const({})})),sn.createElement("span",{class:sn.const("dcg-equals")},sn.createElement(tt,{latex:this.const("="),config:this.const({})}))),sn.createElement("span",{class:()=>({"dcg-text-selectable":this.getEvaluationType()!=="rgbcolor","dcg-evaluation-html":!0,"dcg-color-evaluation":this.getEvaluationType()==="rgbcolor"}),didMount:this.bindFn(this.didMountEvaluation)},zY(()=>this.getEvaluationType(),{list:()=>sn.createElement("span",{class:sn.const("dcg-evaluation-list")},()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length})),fraction:()=>sn.createElement(tt,{latex:()=>__dcg_shared_module_exports__['Hb'](this.props.val(),this.getLabelOptions()),config:this.const({})}),undefined:()=>sn.createElement("span",null,sn.const("undefined")),scientific:()=>sn.createElement(tt,{latex:()=>`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`,config:this.const({})}),decimal:()=>sn.createElement(tt,{latex:()=>this.getNumberLabel().value,config:this.const({})}),rgbcolor:()=>sn.createElement(gg,{color:()=>this.getColorValue(),isEvaluation:this.const(!0),invertSwatches:()=>this.controller.invertSwatches()})})))),sn.createElement("div",{class:sn.const("dcg-clear")}))}getColorValue(){let e=this.props.id(),t=this.controller.getColorById(e);return Array.isArray(t)?{type:"color-array",value:t}:{type:"single-color",value:t}}getNumberLabel(){return $Y(this.props.val(),this.getLabelOptions())}getEvaluationType(){let e=this.props.val();return typeof e=="string"?"rgbcolor":Array.isArray(e)?typeof e[0]=="string"?"rgbcolor":"list":this.getNumberLabel().type}getLabelOptions(){return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id())}didMountEvaluation(e){this.evaluationNode=e}onSelectEvaluation(){let e=document.createRange();e.selectNodeContents(this.evaluationNode);let t=window.getSelection();t&&(t.removeAllRanges(),t=window.getSelection(),t&&t.addRange(e))}onUnselectEvaluation(){let e=window.getSelection();e&&e.removeAllRanges()}getBrailleEvaluation(){let e="";this.props.dependent()&&(e=__dcg_shared_module_exports__['Ib'](this.props.dependent())),e+="=";let t=this.getEvaluationType();switch(t){case"list":e+=this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length});break;case"fraction":e+=__dcg_shared_module_exports__['Hb'](this.props.val(),this.getLabelOptions());break;case"undefined":e="undefined";break;case"scientific":e+=`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`;break;case"decimal":e+=this.getNumberLabel().value;break;case"rgbcolor":e+=this.props.val();break;default:return t}return e}};var El=__dcg_shared_module_exports__['h'](X()),gx=class extends El.Class{template(){return this.controller=this.props.controller(),El.createElement("div",{class:El.const("dcg-unresolved")},El.createElement("i",{class:El.const("dcg-icon-error"),"aria-hidden":El.const("true")}),El.const("\xA0"),()=>this.controller.s("graphing-calculator-error-equation-contains-unresolved-details"),El.createElement("a",{href:El.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"),target:El.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))}};var ys=__dcg_shared_module_exports__['h'](X());ct();zl();var ja=__dcg_shared_module_exports__['h'](X());var{SwitchUnion:WY}=ja.Components,fr=class extends ja.Class{init(){this.controller=this.props.controller()}template(){return ja.createElement("div",{class:this.bindFn(this.getContainerClass)},WY(()=>String(this.props.readonly()),{true:()=>ja.createElement(Cn,__dcg_shared_module_exports__['a']({latex:this.bindFn(this.getStaticLatex),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.props.isFocused,isStatic:this.const(!0),onBrailleFocusedChanged:this.props.handleFocusChanged,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},go(this.props.controller())),ja.createElement(tt,{latex:this.bindFn(this.getStaticLatex),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel},ja.createElement("span",{class:ja.const("dcg-math-field"),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0,manageFocus:this.const({shouldBeFocused:()=>this.props.isFocused(),onFocusedChanged:(e,t)=>this.props.handleFocusChanged(e,t)}),tabindex:ja.const("0")}))),false:()=>ja.createElement(Cn,__dcg_shared_module_exports__['a']({latex:this.props.latex,operatorNames:()=>this.getMQConfig().autoOperatorNames||"",brailleShouldFocus:this.props.isFocused,selectOnFocus:this.const(!0),onBrailleInput:this.props.handleLatexChanged,onBrailleFocusedChanged:this.props.handleFocusChanged,onBrailleKeydown:this.bindFn(this.onBrailleKeydown),hasError:this.props.hasError,placeholder:this.props.placeholder,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},go(this.props.controller())),ja.createElement(it,{latex:this.props.latex,getAriaPostLabel:()=>{var t,i;let e=((i=(t=this.props).ariaPostLabel)==null?void 0:i.call(t))||"";return this.props.hasError()&&e===""&&(e=this.controller.s("shared-calculator-narration-math-input-error-message")),e},isFocused:this.props.isFocused,placeholder:this.props.placeholder,capExpressionSize:()=>this.controller.getCapExpressionSize(),selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel,hasError:this.props.hasError,dataLabelAttributeValue:this.props.dataLabelAttributeValue,onUserPressedKey:this.props.handlePressedKey,onUserChangedLatex:this.props.handleLatexChanged,onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.props.handleFocusChanged,needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))}))}getStaticLatex(){return this.props.latex()?this.props.latex():this.props.placeholder?this.props.placeholder():""}getContainerClass(){let e=this.props.containerClass?this.props.containerClass():{};return e["dcg-inline-math-input-view"]=!0,this.props.fullWidth&&this.props.fullWidth()&&(e["dcg-full-width-inline-math-input"]=!0),this.props.fontSize&&this.props.fontSize()==="large"&&(e["dcg-large-font-inline-math-input"]=!0),this.props.noBorder&&this.props.noBorder()&&(e["dcg-no-border-inline-math-input"]=!0),e}onBrailleKeydown(e){if(!this.props.handlePressedKey)return;let t=Re(e);t&&this.props.handlePressedKey(t,e)}getMQConfig(){return this.controller.getMathquillConfig({})}getBrailleLabel(){return this.props.brailleLabel?this.props.brailleLabel():this.props.ariaLabel()}};var Hc=__dcg_shared_module_exports__['h'](X());var Wp=class extends Hc.Class{template(){return Hc.createElement(Ke,{tooltip:()=>this.props.controller().s("shared-calculator-label-toast-learn-more")},Hc.createElement("a",{"aria-label":()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),class:Hc.const("dcg-learn-more-link"),href:this.props.href,target:Hc.const("_blank")},Hc.createElement("i",{class:Hc.const("dcg-icon-question-sign"),"aria-hidden":Hc.const("true")})))}};var{If:jY}=ys.Components,fg=class extends ys.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this.props.parameter!==void 0&&(this.parameter=this.props.parameter())}template(){return ys.createElement("div",{class:ys.const("dcg-domain dcg-do-blur"),handleEvent:ys.const("true")},ys.createElement("div",{class:ys.const("dcg-display-domain dcg-do-blur"),handleEvent:ys.const("true")},ys.createElement(fr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMinLatex(),isFocused:()=>this.getFocusedInput()==="min"+this.getDomainVariable(),placeholder:()=>__dcg_shared_module_exports__['Cb'](k_(this.model)).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-minimum",{term:this.getDomainVariable()}),brailleLabel:()=>this.controller.raw("dmin"),handleFocusChanged:e=>this.handleFocusedChanged("min"+this.getDomainVariable(),e),hasError:()=>!I_(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min"+this.getDomainVariable(),e,t),handleLatexChanged:e=>this.dispatchMinLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-min")}),ys.createElement("span",{class:ys.const("dcg-interval-interior")},ys.createElement(tt,{latex:()=>this.getDomainVariableLatex(),config:this.const({})})),ys.createElement(fr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMaxLatex(),isFocused:()=>this.getFocusedInput()==="max"+this.getDomainVariable(),placeholder:()=>__dcg_shared_module_exports__['Cb'](G_(this.model,this.getDomainVariable())).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-maximum",{term:this.getDomainVariable()}),brailleLabel:()=>this.controller.raw("dmax"),handleFocusChanged:e=>this.handleFocusedChanged("max"+this.getDomainVariable(),e),hasError:()=>!V_(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max"+this.getDomainVariable(),e,t),handleLatexChanged:e=>this.dispatchMaxLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-max")}),ys.createElement(jY,{predicate:()=>this.getDomainVariable()==="\\phi"},()=>ys.createElement(Wp,{href:this.const("https://help.desmos.com/hc/en-us/articles/15824510769805"),controller:this.props.controller}))))}handlePressedKey(e,t,i){if(!this.controller.isInEditListMode()){if(t==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(t==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}let n=it.getFocusedMathquill(),o=Da();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){var s;n?s=it.applyArrowKeyAndReturnIfWasAtBounds(n,t,i):o&&(o.selectionStart===0&&t==="Left"||o.selectionStart===O(o).val().length&&t==="Right"||t==="Up"||t==="Down")?s=!0:s=!1,s&&(i&&i.preventDefault(),t==="Left"?e==="max"+this.getDomainVariable()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"+this.getDomainVariable()}}):t==="Right"?e==="min"+this.getDomainVariable()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"+this.getDomainVariable()}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}));return}n&&(n.keystroke(t,i),e==="min"+this.getDomainVariable()?this.dispatchMinLatexIfChanged(n.latex()):e==="max"+this.getDomainVariable()&&this.dispatchMaxLatexIfChanged(n.latex()))}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){if(this.getMinLatex()!==e){if(this.getDomainType()==="unknown"){Yo("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:Ph(this.model,{stripDefaults:!0})}});return}let i=this.setMinCommand();i!==void 0&&this.controller.dispatch({type:i,id:this.id,latex:e})}}setMinCommand(){switch(this.getDomainType()){case"polar":return"set-polar-domain-minlatex";case"parametric":return"set-parametric-domain-minlatex";case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"&&Ra(this.model)||this.getDomainVariable()==="\\theta"&&bl(this.model)?"set-parametric-domain3Du-minlatex":"set-parametric-domain3Dv-minlatex"}}setMaxCommand(){switch(this.getDomainType()){case"polar":return"set-polar-domain-maxlatex";case"parametric":return"set-parametric-domain-maxlatex";case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"&&Ra(this.model)||this.getDomainVariable()==="\\theta"&&bl(this.model)?"set-parametric-domain3Du-maxlatex":"set-parametric-domain3Dv-maxlatex"}}dispatchMaxLatexIfChanged(e){if(this.getMaxLatex()!==e){if(this.getDomainType()==="unknown"){Yo("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:Ph(this.model,{stripDefaults:!0})}});return}let i=this.setMaxCommand();i!==void 0&&this.controller.dispatch({type:i,id:this.id,latex:e})}}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="domain-limit"||e.id!==this.id))return e.location}getMinLatex(){switch(this.getDomainType()){case"parametric":return Q_(this.model);case"polar":return Y_(this.model);case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"||this.getDomainVariable()==="\\theta"&&bl(this.model)?Z_(this.model):eF(this.model);default:return""}}getMaxLatex(){switch(this.getDomainType()){case"parametric":return tF(this.model);case"polar":return X_(this.model);case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"||this.getDomainVariable()==="\\theta"&&bl(this.model)?rF(this.model):iF(this.model);default:return""}}getDomainVariable(){var e;switch(this.getDomainType()){case"parametric":return"t";case"polar":return"\\theta";default:return(e=this.parameter)!=null?e:""}}getDomainVariableForDisplay(){return this.getDomainType()==="parametric"&&"dependency"in this.model.formula?this.model.formula.dependency:this.getDomainVariable()}getDomainVariableLatex(){switch(this.getDomainType()){case"parametric":case"polar":case"parametric-uv":return"\\le "+this.getDomainVariableForDisplay()+" \\le";default:return""}}getDomainType(){return Cp(this.model)||Tm(this.model)?"polar":mu(this.model)?"parametric":vD(this.model)||bl(this.model)||Ra(this.model)?"parametric-uv":"unknown"}getMQConfig(){return{autoOperatorNames:$a({})}}};var Te=__dcg_shared_module_exports__['h'](X());var kl=__dcg_shared_module_exports__['h'](X());var Gt=class extends kl.Class{template(){return kl.createElement("div",{role:kl.const("checkbox"),tabindex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},"aria-labelledby":()=>{var e,t;return(t=(e=this.props).labelledBy)==null?void 0:t.call(e)},"aria-describedby":()=>{var e,t;return(t=(e=this.props).describedBy)==null?void 0:t.call(e)},"aria-disabled":()=>this.props.disabled&&this.props.disabled(),"aria-checked":this.props.checked,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange)},kl.createElement("span",{class:kl.const("dcg-checkbox")},kl.createElement("i",{class:kl.const("dcg-icon-check"),"aria-hidden":kl.const("true")})),kl.createElement("span",{class:kl.const("dcg-checkbox-children")},this.children))}onChange(e){let t=e.target;t&&t.getAttribute("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};var{If:Yl,For:JY,IfElse:YY}=Te.Components,mx=class extends Te.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Te.createElement(Yl,{predicate:this.bindFn(this.hasRegression)},()=>Te.createElement("div",{class:Te.const("dcg-regression-container")},Te.createElement("div",{class:Te.const("dcg-handle-event"),handleEvent:Te.const("true")},Te.createElement(Yl,{predicate:this.bindFn(this.getShouldSuggestLogMode)},()=>Te.createElement("div",{class:Te.const("dcg-log-mode-toggle")},YY(()=>this.areLogModeRegressionsForced(),{true:()=>Te.createElement("div",{class:Te.const("dcg-action-log-mode-toggle dcg-no-hover-styling")},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),false:()=>Te.createElement("div",null,Te.createElement(Gt,{class:this.const("dcg-action-log-mode-toggle dcg-log-mode-checkbox"),onChange:this.bindFn(this.onTapLogMode),checked:()=>this.getIsLogModeRegression()},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),Te.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),gravity:this.const("e")},Te.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),class:Te.const("dcg-log-mode-toggle-help"),target:Te.const("_blank"),href:Te.const("https://help.desmos.com/hc/en-us/articles/204349605")},Te.createElement("i",{class:Te.const("dcg-icon-question-sign"),"aria-hidden":Te.const("true")}))))}))),Te.createElement("div",{class:Te.const("dcg-statistics"),role:Te.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-statistics")},Te.createElement("div",{class:Te.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-statistics"),Te.createElement(Yl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>Te.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip"),gravity:this.const("s")},Te.createElement("a",{class:Te.const("dcg-expression-footer-title-help"),target:Te.const("_blank"),href:Te.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip")},Te.createElement("i",{class:Te.const("dcg-icon-question-sign"),"aria-hidden":Te.const("true")})))),Te.createElement(Yl,{predicate:()=>this.getRegression().statistics.Rsquared<0},()=>Te.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),gravity:this.const("s")},Te.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),class:Te.const("dcg-expression-footer-title-help"),target:Te.const("_blank"),href:Te.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-")},Te.createElement("i",{class:Te.const("dcg-icon-question-sign"),"aria-hidden":Te.const("true")}))))),Te.createElement("div",{class:Te.const("dcg-statistics-values")},Te.createElement(Yl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("Rsquared")},()=>Te.createElement("div",null,Te.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>"R^2="+Gl(this.getRegression(),"Rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="Rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"Rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"Rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},go(this.controller)),Te.createElement(tt,{latex:()=>"R^2="+Gl(this.getRegression(),"Rsquared"),config:this.const({})},Te.createElement("span",{tabindex:Te.const("0"),manageFocus:this.const(Vt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"Rsquared"}}))}))))),Te.createElement(Yl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("rsquared")},()=>Te.createElement("div",null,Te.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>"r^2="+Gl(this.getRegression(),"rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},go(this.controller)),Te.createElement(tt,{latex:()=>"r^2="+Gl(this.getRegression(),"rsquared"),config:this.const({})},Te.createElement("span",{tabindex:Te.const("0"),manageFocus:this.const(Vt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"rsquared"}}))}))))),Te.createElement(Yl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("r")},()=>Te.createElement("div",null,Te.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>"r="+Gl(this.getRegression(),"r"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="r"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"r"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"r"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},go(this.controller)),Te.createElement(tt,{latex:()=>"r="+Gl(this.getRegression(),"r"),config:this.const({})},Te.createElement("span",{class:Te.const("dcg-r-value"),tabindex:Te.const("0"),manageFocus:this.const(Vt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"r"}}))}))))),Te.createElement(Yl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>Te.createElement("div",null,Te.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>"\\operatorname{RMSE}="+Gl(this.getRegression(),"RMSE"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="RMSE"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"RMSE"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"RMSE"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},go(this.controller)),Te.createElement(tt,{latex:()=>"\\operatorname{RMSE}="+Gl(this.getRegression(),"RMSE"),config:this.const({})},Te.createElement("span",{tabindex:Te.const("0"),manageFocus:this.const(Vt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"RMSE"}}))}))))))),Te.createElement("div",{role:Te.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-residuals"),class:Te.const("dcg-residuals")},Te.createElement("div",{class:Te.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-residuals")),Te.createElement(Cn,__dcg_shared_module_exports__['a']({latex:this.bindFn(this.getResidualVariable),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter===this.getResidualVariable()},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:this.getResidualVariable()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:this.getResidualVariable()}})},ariaLabel:this.const(""),isStatic:this.const(!0)},go(this.controller)),Te.createElement(tt,{latex:this.bindFn(this.getResidualVariable),config:this.const({})},Te.createElement("span",{class:Te.const("dcg-residuals-variable"),tabindex:Te.const("0"),manageFocus:this.const(Vt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:this.getResidualVariable()}}))}))),Te.createElement(Yl,{predicate:this.bindFn(this.getResidualSuggestionVisible)},()=>Te.createElement("div",{class:Te.const("dcg-residual-suggestion dcg-action-plot-residual dcg-btn dcg-btn-light-gray"),role:Te.const("button"),onTap:this.bindFn(this.onTapResidualsSuggestion)},()=>this.controller.s("graphing-calculator-button-regression-plot-residuals")))),Te.createElement(Yl,{predicate:()=>Object.keys(this.getRegression().parameters).length>0},()=>Te.createElement("div",{class:Te.const("dcg-parameters-container")},Te.createElement("div",{class:Te.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-parameters"),Te.createElement(Yl,{predicate:()=>this.isNonLinearRegression()},()=>Te.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact"),gravity:this.const("s")},Te.createElement("a",{class:Te.const("dcg-expression-footer-title-help"),target:Te.const("_blank"),href:Te.const("https://help.desmos.com/hc/en-us/articles/360042428612"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact")},Te.createElement("i",{class:Te.const("dcg-icon-question-sign"),"aria-hidden":Te.const("true")}))))),Te.createElement(JY,{each:()=>Object.keys(this.getRegression().parameters)},Te.createElement("div",{role:Te.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-parameters"),class:Te.const("dcg-parameters")},e=>Te.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>e+"="+tk(this.getRegression(),e),brailleShouldFocus:()=>{let t=this.controller.getFocusLocation();return!t||t.type!=="regression-output"?!1:t.parameter===e},onBrailleFocusedChanged:t=>{t?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:e}})},ariaLabel:this.const(""),isStatic:this.const(!0)},go(this.controller)),Te.createElement(tt,{latex:()=>e+"="+tk(this.getRegression(),e),config:this.const({})},Te.createElement("span",{class:Te.const("dcg-parameter"),tabindex:Te.const("0"),manageFocus:this.const(Vt({controller:this.controller,location:{type:"regression-output",parameter:e}}))}))))))),Te.createElement("div",{class:Te.const("dcg-clear")}),Te.createElement(Yl,{predicate:()=>this.hasParameterWarning()},()=>Te.createElement("div",{class:Te.const("dcg-parameter-warning")},Te.createElement("i",{class:Te.const("dcg-icon-error"),"aria-hidden":Te.const("true")}),Te.const("\xA0"),()=>this.controller.s("graphing-calculator-text-regression-potentially-inaccurate-parameters"),Te.const("\xA0"),Te.createElement("a",{href:Te.const("https://help.desmos.com/hc/en-us/articles/360042942771"),target:Te.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))))))}onTapResidualsSuggestion(){this.controller.dispatch({type:"plot-residuals",id:this.id})}onTapLogMode(){this.controller.dispatch({type:"toggle-logmode",id:this.id})}getRegression(){return this.model.formula.regression}hasRegression(){return!!this.model.formula.regression}isNonLinearRegression(){return!this.getRegression().isLinear}getResidualVariable(){return this.getRegression().residualVariable||""}getResidualSuggestionVisible(){return this.getRegression().residualSuggestionId!==void 0}areLogModeRegressionsForced(){return this.controller.areLogModeRegressionsForced()}getShouldSuggestLogMode(){return!!this.getRegression().shouldSuggestLogMode}hasParameterWarning(){return!!this.getRegression().parameterWarning}getIsLogModeRegression(){return!!this.model.isLogModeRegression}};function tk(r,e){return __dcg_shared_module_exports__['Hb'](r.parameters[e],{digits:6,smallCutoff:1e-6,bigCutoff:1e9})}function Gl(r,e){return __dcg_shared_module_exports__['Hb'](r.statistics[e],{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})}ct();var An=__dcg_shared_module_exports__['h'](X());var jn=__dcg_shared_module_exports__['h'](X());ct();ct();var rk=class extends Wr{constructor(){super();this.dragging=!1,this.guid=__dcg_shared_module_exports__['M']("dragdrop-class")}_evt2pt(t){return{x:t.changedTouches[0].pageX-this._offsetPt.x,y:t.changedTouches[0].pageY-this._offsetPt.y}}_dispatch(t,i){if(this._destroyed)return;let n=this._evt2pt(i);this.triggerEvent(t,{x:n.x,y:n.y,dx:n.x-this._startPt.x,dy:n.y-this._startPt.y,evt:i})}destroy(){O(document).off(`.${this.guid}`),this._destroyed=!0}startDrag(t,i={}){if(!this.dragging)return O(document).on(`dcg-tapmove.${this.guid}`,n=>{(n.originalEvent||n).preventDefault(),cancelAnimationFrame(this.frameThrottle),this.frameThrottle=requestAnimationFrame(()=>this.doDrag(n))}),O(document).on(`dcg-tapend.${this.guid} dcg-tapcancel.${this.guid}`,n=>this.endDrag(n)),this._offsetPt={x:0,y:0},i.origin&&(this._offsetPt={x:this._evt2pt(t).x-i.origin.x,y:this._evt2pt(t).y-i.origin.y}),this._startPt=this._evt2pt(t),this.setProperty("dragging",!0),this._dispatch("onGrab",t)}doDrag(t){this.dragging&&this._dispatch("onDrag",t)}endDrag(t){this.dragging&&(O(document).off(`.${this.guid}`),this.doDrag(t),this.setProperty("dragging",!1),this._dispatch("onDrop",t))}};var{If:XY}=jn.Components;function t5(r,e,t){return Math.min(Math.max(r,e),t)}var fx=class extends jn.Class{template(){return jn.createElement("div",{class:()=>({"dcg-slider-interior":!0,"dcg-disable-slider":this.shouldDisableSlider()}),didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag)},jn.createElement("div",{class:jn.const("dcg-track")},jn.createElement("div",{class:jn.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),jn.createElement("div",{class:jn.const("dcg-graphic")})),jn.createElement(XY,{predicate:this.bindFn(this.shouldShowZeroMarker)},()=>jn.createElement("div",{class:jn.const("dcg-zeroMarker"),style:()=>({left:this.getZeroMarkerPercent()+"%"})})),jn.createElement("div",{class:()=>({"dcg-thumb":!0,"dcg-down":this.isDragging}),role:jn.const("slider"),tabindex:jn.const("0"),disablescroll:jn.const("true"),style:()=>({left:this.getThumbPercent()+"%"}),onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-valuemin":this.props.min,"aria-valuemax":this.props.max,"aria-valuenow":this.props.value,manageFocus:this.buildFocusManager()},jn.createElement("div",{class:jn.const("dcg-graphic")}),jn.createElement("div",{class:jn.const("dcg-center")})))}willUnmount(){this.dragDrop.destroy()}didMountRoot(e){this.rootNode=e,this.dragDrop=new rk,this.isMounted=!0,this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,this.update(),this.props.onDrop&&this.props.onDrop()}),this.dragDrop.observeEvent("onGrab",()=>{this.isDragging=!0,this.update(),this.props.onGrab&&this.props.onGrab()}),this.dragDrop.observeEvent("onDrag",(t,i)=>{this.props.onDragUpdate(this.valueFromPixels(i.x))})}didMountTickMarks(e){this.tickMarksNode=e,this.renderTickMarks()}didUpdate(){this.renderTickMarks()}shouldDisableSlider(){return this.props.min()===this.props.max()}renderTickMarks(){if(this.tickMarksNode){var e=this.props.step(),t=this.props.min(),i=this.props.max(),n;if(e===void 0?n=0:n=100*e/(i-t),n<3&&(n=0),n>100&&(n=0),isNaN(n)&&(n=0),this.lastTickMarksPercent!==n){this.lastTickMarksPercent=n;var o="";if(n>0&&n<100)for(var s=n;s<100;s+=n)o+='<div class="dcg-tick" style="left:'+s+'%"></div>';this.tickMarksNode.innerHTML=o}}}shouldShowZeroMarker(){return this.props.min()<=0&&this.props.max()>=0}getZeroMarkerPercent(){var e=this.props.min(),t=this.props.max();return 100*(0-e)/(t-e)}getThumbPercent(){return 100*this.percentFromValue(this.props.value())}valueFromPixels(e){if(!this.isMounted)return 0;let t=this.props.min(),i=this.props.max(),n=this.rootNode.getBoundingClientRect().width,o=t5(e/n,0,1),s=t+(i-t)*o,a=(i-t)/n;return Li(s-a,s+a)}percentFromValue(e){let t=this.props.min(),i=this.props.max();return t5((e-t)/(i-t),0,1)}pixelsFromValue(e){if(!this.isMounted)return 0;let t=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*t}onKeyDown(e){switch(Re(e)){case So:this.props.onUpPress&&(this.props.onUpPress(),e.preventDefault());break;case Eo:this.props.onDownPress&&(this.props.onDownPress(),e.preventDefault());break;case Fl:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault());break;case Do:document.activeElement&&O(document.activeElement).trigger("blur");break;case hd:this.props.onKeyboardUpdate("down"),e.preventDefault();break;case gd:this.props.onKeyboardUpdate("up"),e.preventDefault();break;case pm:this.props.onKeyboardUpdate("bigdown"),e.preventDefault();break;case um:this.props.onKeyboardUpdate("bigup"),e.preventDefault();break;case hp:this.props.onKeyboardUpdate("min"),e.preventDefault();break;case pp:this.props.onKeyboardUpdate("max"),e.preventDefault();break}}onStartDrag(e){if(e.device==="keyboard"||!e.target)return;e.preventDefault(),pi();let t={x:0,y:0};O(e.target).closest(".dcg-thumb").length===1?t.x=this.pixelsFromValue(this.props.value()):t.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:t})}buildFocusManager(){return!this.props.onFocusedChanged||!this.props.isFocused?this.const(void 0):this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged})}};ct();var Jn=__dcg_shared_module_exports__['h'](X());var{If:QY}=Jn.Components,yx=class extends Jn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Jn.createElement("div",{class:Jn.const("dcg-slider_menu dcg-do-blur"),handleEvent:Jn.const("true"),didMount:e=>this.node=e},Jn.createElement("div",{class:Jn.const("dcg-editable-mathquill-container")},Jn.createElement(QY,{predicate:()=>!this.shouldOnlyShowStep()},()=>Jn.createElement("span",null,Jn.createElement(fr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMin?this.model.slider.min:"",isFocused:()=>this.getFocusedInput()==="min",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-minimum"),brailleLabel:()=>this.controller.raw("sldrmin"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("min",e,t),hasError:()=>!oD(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min",e,t),handleLatexChanged:e=>this.handleLatexChanged("min",e),dataLabelAttributeValue:this.const("slidermin")}),Jn.createElement("span",{class:Jn.const("dcg-interval-interior")},Jn.createElement(tt,{latex:this.bindFn(this.getDependentLatex),config:this.const({})},Jn.createElement("span",null))),Jn.createElement(fr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMax?this.model.slider.max:"",isFocused:()=>this.getFocusedInput()==="max",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-maximum"),brailleLabel:()=>this.controller.raw("sldrmax"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("max",e,t),hasError:()=>!sD(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max",e,t),handleLatexChanged:e=>this.handleLatexChanged("max",e),dataLabelAttributeValue:this.const("slidermax")}))),Jn.createElement("span",{class:()=>({"dcg-slider-step-container":!this.shouldOnlyShowStep()})},Jn.createElement("span",{class:Jn.const("dcg-slider-step-label"),"aria-hidden":Jn.const("true")},()=>this.controller.s("graphing-calculator-label-slider-step")),Jn.createElement(fr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.step,isFocused:()=>this.getFocusedInput()==="step",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-step"),brailleLabel:()=>this.controller.raw("sldrstep"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("step",e,t),hasError:()=>!aD(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("step",e,t),handleLatexChanged:e=>this.handleLatexChanged("step",e),dataLabelAttributeValue:this.const("sliderstep")}))))}handlePressedKey(e,t,i){if(!this.controller.isInEditListMode()&&!this.shouldOnlyShowStep()&&(t==="Esc"||t==="Enter")){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}});return}let n=it.getFocusedMathquill(),o=Da();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){var s;n?s=it.applyArrowKeyAndReturnIfWasAtBounds(n,t,i):o&&(o.selectionStart===0&&t==="Left"||o.selectionStart===O(o).val().length&&t==="Right"||t==="Up"||t==="Down")?s=!0:s=!1,s&&(i&&i.preventDefault(),t==="Left"&&!this.shouldOnlyShowStep()?e==="max"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"min"}}):e==="step"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):t==="Right"&&!this.shouldOnlyShowStep()?e==="min"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):e==="max"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}));return}n&&(n.keystroke(t,i),this.handleLatexChanged(e,n.latex()))}shouldOnlyShowStep(){return this.model.slider.loopMode==="PLAY_INDEFINITELY"}handleLatexChanged(e,t){e==="min"?this.dispatchMinLatexIfChanged(t):e==="max"?this.dispatchMaxLatexIfChanged(t):e==="step"&&this.dispatchStepLatexIfChanged(t)}handleFocusedChanged(e,t,i){t&&this.getFocusedInput()!==e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}}):this.getFocusedInput()===e&&this.controller.getBrailleMode()==="none"&&(!i.relatedTarget||!this.node.contains(i.relatedTarget))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.model.slider.min!==e&&this.controller.dispatch({type:"set-slider-minlatex",id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.model.slider.max!==e&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.id,latex:e})}dispatchStepLatexIfChanged(e){this.model.slider.step!==e&&this.controller.dispatch({type:"set-slider-steplatex",id:this.id,latex:e})}getDependentLatex(){var e=po(this.model)||"";return" \\le "+__dcg_shared_module_exports__['Ib'](e)+" \\le "}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="slider-limit"||e.id!==this.id))return e.location}getMQConfig(){return{autoOperatorNames:$a()}}};var{If:r5}=An.Components,bx=class extends An.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return An.createElement("span",{class:An.const("dcg-slider-container"),tapboundary:An.const("true"),onKeydown:e=>{Re(e)==="Tab"&&!e.altKey&&!e.metaKey&&!e.ctrlKey&&(e.shiftKey?this.isSliderMinFocused()&&this.controller.isInEditListMode()?(e.target!==null&&O(e.target).closest(".dcg-expressionitem").find('[tabindex="0"]:visible:first').trigger("focus"),e.preventDefault(),e.stopPropagation()):this.isSliderThumbFocused()&&(this.controller.isItemReadonly(this.model.id)||(this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}),e.preventDefault(),e.stopPropagation())):!e.shiftKey&&this.isSliderStepFocused()&&(this.controller.isInEditListMode()?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-icon",id:this.id}}):this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}),e.preventDefault(),e.stopPropagation()))}},An.createElement(r5,{predicate:this.bindFn(this.shouldShowSlider)},()=>An.createElement("div",{class:An.const("dcg-do-blur dcg-slider"),handleEvent:An.const("true")},An.createElement("div",{class:An.const("dcg-minLabel dcg-template-minlabelhtml"),role:An.const("button"),tabindex:An.const("0"),"aria-label":this.bindFn(this.getMinAriaLabel),onTap:()=>this.onEditLimit("min")},An.createElement(tt,{latex:()=>iD(this.model),config:this.const({})})),An.createElement(fx,{min:()=>yl(this.model),max:()=>vc(this.model),step:()=>Bl(this.model),value:()=>ma(this.model),ariaLabel:()=>this.controller.getBrailleMode()==="none"?'"'+po(this.model)+'"':""+po(this.model),onGrab:this.bindFn(this.onGrab),onDrop:this.bindFn(this.onDrop),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate),onUpPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Up"}),onDownPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}),onEnterPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}),isFocused:this.bindFn(this.isSliderThumbFocused),onFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-thumb",id:this.id}})}}),An.createElement("div",{class:An.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:()=>this.onEditLimit("max"),role:An.const("button"),tabindex:An.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-slider-maximum")+" "+Vs(iD(this.model))},An.createElement(tt,{latex:()=>x_(this.model),config:this.const({})})))),An.createElement(r5,{predicate:this.bindFn(this.shouldShowLimitInputs)},()=>An.createElement(yx,{model:this.props.model,controller:this.props.controller})))}getMinAriaLabel(){return this.controller.isItemReadonly(this.model.id)?this.controller.s("graphing-calculator-narration-slider-minimum")+" "+Vs(iD(this.model)):this.controller.s("graphing-calculator-narration-edit-slider-variable-limits",{variable:this.controller.getBrailleMode()==="none"?'"'+po(this.model)+'"':""+po(this.model)})}onGrab(){this.dispatchIsDraggingIfChanged(!0)}onDrop(){this.controller.dispatch({type:"set-none-selected"}),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)}onKeyboardUpdate(e){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.id,adjustment:e})}onDragUpdate(e){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:e})}onEditLimit(e){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchIsPlayingIfChanged(e){this.model.slider.isPlaying!==e&&this.controller.dispatch({type:"set-slider-isplaying",id:this.id,isPlaying:e})}dispatchIsDraggingIfChanged(e){this.model.sliderDragging!==e&&this.controller.dispatch({type:"set-slider-dragging",id:this.id,dragging:e})}shouldShowLimitInputs(){if(this.controller.isInEditListMode())return!0;if(this.controller.isItemReadonly(this.model.id))return!1;if(!oD(this.model)||!sD(this.model)||!aD(this.model)||this.model.slider.loopMode==="PLAY_INDEFINITELY")return!0;let e=this.controller.getFocusLocation();return!!(e&&(e.type==="slider-limit"||e.type==="expression"||e.type==="top-level-icon"||e.type==="readonly-expression")&&e.id===this.id)}shouldShowSlider(){return!this.shouldShowLimitInputs()}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-thumb"&&e.id===this.id)}isSliderMinFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="min")}isSliderStepFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="step")}};ct();var Dn=__dcg_shared_module_exports__['h'](X());var{For:ZY,If:eX}=Dn.Components,qc=class extends Dn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Dn.createElement("div",{class:Dn.const("dcg-create-sliders dcg-action-createslider"),handleEvent:Dn.const("true"),onTap:this.bindFn(this.onCreateSlider)},Dn.createElement("span",{class:Dn.const("dcg-msg")},()=>this.controller.s("graphing-calculator-label-add-slider")),Dn.createElement("span",{class:Dn.const("btns")},Dn.createElement(ZY,{each:()=>this.getMissingVariables().slice(0,4)},Dn.createElement("span",null,e=>Dn.createElement("div",{class:Dn.const("dcg-slider-btn-container"),var_name:this.const(e)},Dn.createElement("div",{role:Dn.const("button"),tabindex:Dn.const("0"),class:()=>({"dcg-btn-slider":!0,"dcg-btn-blue":this.getMissingVariables().length===1,"dcg-btn-light-gray":this.getMissingVariables().length!==1}),didMount:t=>{t.innerHTML=__dcg_shared_module_exports__['Jb'](e)}})))),Dn.createElement(eX,{predicate:()=>this.getMissingVariables().length>1},()=>Dn.createElement("div",{class:Dn.const("dcg-slider-btn-container dcg-all")},Dn.createElement("div",{role:Dn.const("button"),tabindex:Dn.const("0"),class:Dn.const("dcg-btn-slider dcg-btn-blue")},()=>this.controller.s("graphing-calculator-button-slider-add-all-variables"))))))}onCreateSlider(e){if(this.controller.dispatch({type:"set-none-selected"}),!e.target)return;var t=O(e.target).closest(".dcg-slider-btn-container");if(!t.length)return;let i=t.hasClass("dcg-all"),n=i?this.getMissingVariables():[t.attr("var_name")];if(this.model.type==="ticker"?this.controller.dispatch({type:"create-sliders-for-ticker",variables:this.getMissingVariables()}):this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:n}),e.device==="keyboard"){let o=this.model.id,s=this.props.controller().getItemSelectorById(o);if(!s)return;i?this.controller.dispatch({type:"move-focus-to-item",id:o}):O(s).find(".dcg-btn-blue").trigger("focus")}}getMissingVariables(){return this.model.type==="ticker"?jb(this.model):Qb(this.model)}didMount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout),this.promptAlertTimeout=setTimeout(()=>{for(var e=[],t=this.getMissingVariables(),i=0;i<t.length;i++)e.push('"'+t[i]+'"');xe(this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:e.join(",")})),this.promptAlertTimeout=0},2e3)}didUnmount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout)}};var sa=__dcg_shared_module_exports__['h'](X());var wx=class extends sa.Class{template(){return sa.createElement("div",{class:sa.const("dcg-prompt-rename"),handleEvent:sa.const("true")},()=>pn("graphing-calculator-label-rename"),sa.createElement("span",{class:sa.const("dcg-btn-light-gray"),onTap:this.props.handleRename,tabindex:sa.const(0),role:sa.const("button")},sa.createElement(tt,{latex:()=>this.props.from()+" \\to "+this.props.to(),config:this.const({})},sa.createElement("span",{style:sa.const("pointer-events:none")}))),sa.createElement("span",{class:sa.const("dcg-reference-count")},()=>pn("graphing-calculator-label-reference-count",{count:new uo(this.props.count())})))}};var Ja=__dcg_shared_module_exports__['h'](X());var As=__dcg_shared_module_exports__['h'](X());var{For:tX,If:rX}=As.Components,Rr=class extends As.Class{init(){this.config=this.props.staticConfig()}template(){return As.createElement(tX,{each:()=>this.config,key:e=>e.key},As.createElement("div",{class:As.const("dcg-segmented-control-container"),role:As.const("group"),"aria-label":this.props.ariaGroupLabel},e=>As.createElement("div",{class:()=>({"dcg-segmented-control-btn":!0,"dcg-selected":e.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled(),[e.class?e.class():""]:!!e.class}),role:As.const("button"),tabindex:As.const(0),"aria-label":()=>this.getAriaLabel(e),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-pressed":()=>e.selected(),onTap:()=>{this.isDisabled()||e.onSelect()},manageFocus:()=>{if(e.focusHelperOptions)return Vt(e.focusHelperOptions)}},As.createElement(Ke,{tooltip:()=>e.tooltip?e.tooltip():"",gravity:()=>e.tooltipGravity?e.tooltipGravity():"s",disabled:()=>!(e.tooltip&&e.tooltip())},As.createElement("div",{class:As.const("dcg-segmented-control-interior")},()=>e.label?e.label():"",As.createElement(rX,{predicate:()=>!!e.icon},()=>As.createElement("i",{class:()=>e.icon?e.icon():""})))))))}getAriaLabel(e){return e.ariaLabel?e.ariaLabel():e.label?e.label():e.tooltip?e.tooltip():""}isDisabled(){return this.props.disabled&&this.props.disabled()}getTheme(){return this.props.theme?this.props.theme():"default"}};var{Input:iX,IfElse:nX}=Ja.Components,yg=class extends Ja.Class{template(){return this.controller=this.props.controller(),Ja.createElement("div",{class:()=>({"dcg-label-visible":this.getShowLabel(),"dcg-label-container":!0,"dcg-do-blur":!0}),tapboundary:Ja.const("true"),handleEvent:Ja.const("true")},Ja.createElement(Gt,{onChange:this.bindFn(this.onCheckboxInput),checked:this.bindFn(this.getShowLabel)},()=>this.controller.s("graphing-calculator-button-label")+(this.getIsDisabled()?"":":")),nX(this.bindFn(this.hasEditableLabel),{true:()=>Ja.createElement("div",{class:Ja.const("dcg-editable-mode-toggle")},Ja.createElement(Rr,{theme:this.const("mini"),staticConfig:this.bindFn(this.getEditableLabelOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-editable-label-mode")})),false:()=>Ja.createElement(iX,{class:()=>({"dcg-label-input":!0,"dcg-disabled-input":this.getIsDisabled(),"dcg-disabled-editable-input":this.hasEditableLabel(),"dcg-readonly":this.getIsReadonly()}),disabled:this.bindFn(this.getIsReadonly),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-text"),"aria-disabled":()=>this.getIsDisabled()||this.hasEditableLabel()||this.getIsReadonly(),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)})}))}getEditableLabelOptions(){return[{key:"math",label:()=>this.controller.s("graphing-calculator-button-editable-math"),selected:()=>this.model().editableLabelMode==="MATH",onSelect:()=>this.setEditableLabelMode("MATH")},{key:"text",label:()=>this.controller.s("graphing-calculator-button-editable-text"),selected:()=>this.model().editableLabelMode==="TEXT",onSelect:()=>this.setEditableLabelMode("TEXT")}]}setEditableLabelMode(e){this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id(),editableLabelMode:e})}getIsReadonly(){return this.controller.isItemReadonly(this.model().id)}model(){return this.props.model()}id(){return this.model().id}getLabel(){return this.model().label||""}hasEditableLabel(){return Gm(this.model())}getShowLabel(){return Cc(this.model())}getIsDisabled(){return this.getLabel().length===0&&!this.getShowLabel()}onLabelInput(e){var t=e;this.controller.dispatch({type:"set-item-label",id:this.id(),label:t}),this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!!t})}onCheckboxInput(){if(this.props.useSmartPointLabeling&&this.props.useSmartPointLabeling()){this.controller.dispatch({type:"toggle-label-for-all-selected-points"});return}this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!this.getShowLabel()})}};var Il=__dcg_shared_module_exports__['h'](X());var mo=__dcg_shared_module_exports__['h'](X());var{If:i5}=mo.Components,xx=class extends mo.Class{constructor(){super(...arguments),this.focusedValues={}}template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,mo.createElement("div",{class:mo.const("dcg-cdf-footer-container dcg-do-blur"),tapboundary:mo.const("true"),handleEvent:mo.const("true")},mo.createElement(Gt,{checked:()=>wd(this.model),disabled:()=>$T(this.model)||this.controller.isItemReadonly(this.model.id),onChange:e=>{this.controller.dispatch({type:"set-show-cdf",id:this.model.id,showCDF:e})}},()=>this.controller.s("graphing-calculator-button-find-cdf")),mo.createElement(i5,{predicate:()=>wd(this.model)},()=>mo.createElement("div",null,mo.createElement("span",{class:mo.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-minimum")),mo.createElement(fr,{handleFocusChanged:e=>this.handleFocusedChanged("min",e),latex:()=>Hb(this.model),hasError:()=>!zb(this.model),isFocused:()=>this.isInputFocused("min"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-minimum"),placeholder:()=>dF(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"min"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMin),readonly:()=>this.controller.isItemReadonly(this.model.id)}),mo.createElement("span",{class:mo.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-maximum")),mo.createElement(fr,{handleFocusChanged:e=>this.handleFocusedChanged("max",e),latex:()=>qb(this.model),hasError:()=>!$b(this.model),isFocused:()=>this.isInputFocused("max"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-maximum"),placeholder:()=>uF(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"max"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMax),readonly:()=>this.controller.isItemReadonly(this.model.id)}),mo.createElement(i5,{predicate:this.bindFn(this.showEvaluation)},()=>mo.createElement("div",{class:mo.const("dcg-cdf-evaluation-container")},mo.createElement(mg,{val:()=>VD(this.model),controller:this.props.controller,dependent:this.const(""),id:()=>this.model.id,focusable:this.const(!0)}))))))}handlePressedKey(e,t,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var n=it.getFocusedMathquill();n&&(n.keystroke(e,t),i==="min"&&Hb(this.model)!==n.latex()&&this.updateCDFMin(n.latex()),i==="max"&&qb(this.model)!==n.latex()&&this.updateCDFMax(n.latex()))}updateCDFMax(e){this.controller.dispatch({type:"set-cdf-max",id:this.model.id,latex:e})}updateCDFMin(e){this.controller.dispatch({type:"set-cdf-min",id:this.model.id,latex:e})}showEvaluation(){return!(!$b(this.model)||!zb(this.model))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="cdf-limit"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"cdf-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"cdf-limit",id:this.id,location:e}})}};var bs=__dcg_shared_module_exports__['h'](X());var{If:oX,For:n5,SwitchUnion:sX}=bs.Components,qf=class extends bs.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return sX(this.bindFn(this.getSuggestionType),{list:()=>bs.createElement(n5,{each:this.bindFn(this.getListOfParameters)},bs.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},e=>bs.createElement("span",{class:bs.const("dcg-parameter-name")},()=>this.getParamName(e)))),listWithDefault:()=>bs.createElement(n5,{each:this.bindFn(this.getListOfParameters)},bs.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),onTap:this.bindFn(this.fillInDefaults)},e=>bs.createElement("span",{class:bs.const("dcg-parameter-name")},()=>this.getParamName(e),bs.createElement(oX,{predicate:()=>this.shouldShowDefaultValue(e)},()=>bs.createElement("span",{class:bs.const("dcg-default-marker")},bs.const("= "),()=>this.getDefaultValue(e)))))),individual:()=>bs.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},this.bindFn(this.getMissingRequiredParamText)),none:()=>{}})}getExtractedAndDefaultArgString(e){let{params:t,values:i,defaults:n}=e;return t.map((s,a)=>{let l=i[s],c=n[a];return l||c||""}).join(",")}fillInDefaults(){let e=wl(this.model);if(!e)return;let{symbol:t,span:i}=e,{input:n,start:o,end:s}=i,a=this.getExtractedAndDefaultArgString(e),l=`\\operatorname{${t}}\\left(${a}\\right)`,c=`${n.slice(0,o)}${l}${n.slice(s)}`;this.controller.dispatch({type:"set-item-latex",id:this.id,latex:c}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),this.controller.dispatch({type:"keypad/press-key",key:"Left"})}isMissingDefault(){if(!Ub(this.model))return!1;let e=wl(this.model);if(!e)return!1;for(var t=0;t<e.params.length;t++)if(this.shouldShowDefaultValue(e.params[t]))return!0;return!1}getSuggestionType(){return this.getListOfParameters().length>1?this.isMissingDefault()?"listWithDefault":"list":this.missingRequiredParam()?"individual":"none"}missingRequiredParam(){let e=wl(this.model);if(e&&e.params.length===1){var t=e.params[0];if(!this.getDefaultValue(t)&&!this.getParameterExtractedValue(t))return t}}getMissingRequiredParamText(){var e=this.missingRequiredParam();return e?this.controller.s("graphing-calculator-text-enter-pareneter",{param:this.getParamName(e)}):""}getDefaultValue(e){let t=wl(this.model);if(!t||!t.params)return"";for(let i=0;i<t.params.length;i++)if(t.params[i]===e)return t.defaults[i]||"";return""}getParameterExtractedValue(e){let t=wl(this.model);return t&&t.values[e]||""}shouldShowDefaultValue(e){return!this.getParameterExtractedValue(e)&&!!this.getDefaultValue(e)}getListOfParameters(){let e=wl(this.model);return e?e.params:[]}getParamName(e){switch(e){case"mean":return this.controller.s("graphing-calculator-text-parameter-name-mean");case"stdev":return this.controller.s("graphing-calculator-text-parameter-name-stddev");case"dof":return this.controller.s("graphing-calculator-text-parameter-name-dof");case"probsuccess":return this.controller.s("graphing-calculator-text-parameter-name-probsuccess");case"trials":return this.controller.s("graphing-calculator-text-parameter-name-trials");case"data":return this.controller.s("graphing-calculator-text-parameter-name-data");case"binwidth":return this.controller.s("graphing-calculator-text-parameter-name-binwidth");case"min":return this.controller.s("graphing-calculator-text-parameter-name-min");case"max":return this.controller.s("graphing-calculator-text-parameter-name-max");case"height":return this.controller.s("graphing-calculator-text-parameter-name-height");case"offset":return this.controller.s("graphing-calculator-text-parameter-name-offset");default:return e}}};var{If:aX}=Il.Components,vx=class extends Il.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Il.createElement("div",{class:Il.const("dcg-distribution-parameters-container dcg-do-blur"),tapboundary:Il.const("true"),handleEvent:Il.const("true")},Il.createElement(qf,{model:this.props.model,controller:this.props.controller}),Il.createElement(aX,{predicate:()=>zT(this.model)},()=>Il.createElement(xx,{model:this.props.model,controller:this.props.controller})))}};var ir=__dcg_shared_module_exports__['h'](X());var{SwitchUnion:lX,If:o5}=ir.Components,zf=class extends ir.Class{template(){return ir.createElement("div",{class:ir.const("dcg-toggle-container")},ir.createElement("div",{class:ir.const("dcg-expression-footer-title")},this.props.title,ir.createElement(o5,{predicate:()=>!!this.props.helpLink},()=>ir.createElement("a",{"aria-label":()=>this.props.controller().s("account-shell-link-help"),class:ir.const("dcg-expression-footer-title-help"),target:ir.const("_blank"),href:this.props.helpLink},ir.createElement("i",{class:ir.const("dcg-icon-question-sign"),"aria-hidden":ir.const("true")})))),ir.createElement(Rr,{staticConfig:this.bindFn(this.getSegmentedControlOptions),ariaGroupLabel:this.props.title,disabled:this.bindFn(this.isReadonly),theme:this.const("mini"),minButtonWidth:this.const(65)}))}isReadonly(){return this.props.controller().isItemReadonly(this.props.model().id)}getSegmentedControlOptions(){return this.props.options().map(e=>({key:e.name,label:()=>e.displayName,selected:()=>this.isSelected(e.name),onSelect:()=>{this.props.controller().dispatch({type:"set-visualization-prop",id:this.props.model().id,prop:this.props.vizProp(),value:e.name})}}))}isSelected(e){return hu(this.props.model(),this.props.vizProp())===e}},Cx=class extends ir.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,ir.createElement("div",{class:ir.const("dcg-visualization-parameters-container dcg-do-blur"),tapboundary:ir.const("true"),handleEvent:ir.const("true")},ir.createElement(qf,__dcg_shared_module_exports__['a']({},this.props)),ir.createElement("div",{class:ir.const("dcg-smaller-font")},lX(()=>this.getVisualizationType(),{boxplot:()=>ir.createElement("div",null,ir.createElement("div",{class:ir.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-visual-parameters-display-properties")),this.makeMQInput({prop:"axisOffset",siblingProps:["breadth"],default:"1",name:()=>this.controller.s("graphing-calculator-narration-visual-parameters-offset")}),this.makeMQInput({prop:"breadth",siblingProps:["axisOffset"],default:"1",name:()=>hu(this.model,"alignedAxis")==="y"?this.controller.s("graphing-calculator-narration-visual-parameters-width"):this.controller.s("graphing-calculator-narration-visual-parameters-height")}),ir.createElement(Gt,{checked:()=>!!hu(this.model,"showBoxplotOutliers"),disabled:()=>this.controller.isItemReadonly(this.model.id),onChange:this.bindFn(this.onToggleOutliers)},ir.createElement("span",{class:ir.const("dcg-parameter-name")},()=>this.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers")))),dotplot:()=>ir.createElement(o5,{predicate:()=>E_(this.model)},()=>ir.createElement("div",{class:ir.const("dcg-toggles-container")},ir.createElement(zf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"dotplotXMode",options:()=>[{name:"exact",displayName:this.controller.s("graphing-calculator-button-visual-parameters-exact")},{name:"bin",displayName:this.controller.s("graphing-calculator-button-visual-parameters-binned")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-x-values")})),ir.createElement(zf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})))),histogram:()=>ir.createElement("div",{class:ir.const("dcg-toggles-container")},ir.createElement(zf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"histogramMode",options:()=>[{name:"",displayName:this.controller.s("graphing-calculator-button-visual-parameters-count")},{name:"relative",displayName:this.controller.s("graphing-calculator-button-visual-parameters-relative")},{name:"density",displayName:this.controller.s("graphing-calculator-button-visual-parameters-density")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bar-heights"),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/360022405991")})),ir.createElement(zf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")}))),none:()=>ir.createElement("span",null)})))}makeMQInput(e){return ir.createElement("span",null,ir.createElement("span",{class:ir.const("dcg-parameter-name")},e.name,ir.const(":")),ir.createElement(fr,{latex:()=>this.getPropLatex(e),ariaLabel:e.name,placeholder:()=>e.default,isFocused:()=>this.isInputFocused(e.prop),hasError:()=>!C_(this.model,e.prop),handleFocusChanged:t=>this.handleFocusedChanged(e.prop,t),handlePressedKey:(t,i)=>this.handlePressedKey(t,i,e.prop),handleLatexChanged:t=>this.handleLatexChanged(e.prop,t),readonly:()=>this.controller.isItemReadonly(this.model.id),controller:this.props.controller}))}handlePressedKey(e,t,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var n=it.getFocusedMathquill();n&&(n.keystroke(e,t),this.handleLatexChanged(i,n.latex()))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="visualization-prop"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"visualization-prop",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"visualization-prop",id:this.id,location:e}})}getPropLatex({prop:e}){let t=hu(this.model,e);return typeof t=="string"?t:""}handleLatexChanged(e,t){hu(this.model,e)!==t&&this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:e,value:t})}onToggleOutliers(){var e=hu(this.model,"showBoxplotOutliers");this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:"showBoxplotOutliers",value:!e})}getVisualizationType(){return Ub(this.model)?Sp(this.model)?"boxplot":fu(this.model)?"dotplot":Nh(this.model)?"histogram":"none":"none"}};var nr=__dcg_shared_module_exports__['h'](X());var Dx=class extends nr.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return nr.createElement("div",{class:nr.const("dcg-ttest-footer-container dcg-do-blur"),handleEvent:nr.const("true")},nr.createElement("table",null,nr.createElement("tr",null,nr.createElement("td",null,nr.createElement("div",{class:nr.const("dcg-value"),role:nr.const("textbox"),"aria-readonly":nr.const("true"),tabindex:nr.const("0"),"aria-label":()=>"Less than: "+this.getLessThan()},nr.createElement("span",{class:nr.const("dcg-operator")},nr.createElement(tt,{config:this.const({}),latex:this.const("<")})),nr.createElement("span",{class:nr.const("dcg-evaluation")},nr.createElement(tt,{config:this.const({}),latex:()=>this.getLessThan()}))))),nr.createElement("tr",null,nr.createElement("td",null,nr.createElement("div",{class:nr.const("dcg-value"),role:nr.const("textbox"),"aria-readonly":nr.const("true"),tabindex:nr.const("0"),"aria-label":()=>"Greater than: "+this.getGreaterThan()},nr.createElement("span",{class:nr.const("dcg-operator")},nr.createElement(tt,{config:this.const({}),latex:this.const(">")})),nr.createElement("span",{class:nr.const("dcg-evaluation")},nr.createElement(tt,{config:this.const({}),latex:()=>this.getGreaterThan()}))))),nr.createElement("tr",null,nr.createElement("td",null,nr.createElement("div",{class:nr.const("dcg-value"),role:nr.const("textbox"),"aria-readonly":nr.const("true"),tabindex:nr.const("0"),"aria-label":()=>"Not equal: "+this.getNotEqual()},nr.createElement("span",{class:nr.const("dcg-operator")},nr.createElement(tt,{config:this.const({}),latex:this.const("\u2260")})),nr.createElement("span",{class:nr.const("dcg-evaluation")},nr.createElement(tt,{config:this.const({}),latex:()=>this.getNotEqual()})))))))}getLessThan(){var e=xm(this.model);return e?__dcg_shared_module_exports__['mc'](e.lessThan,5):""}getGreaterThan(){var e=xm(this.model);return e?__dcg_shared_module_exports__['mc'](e.greaterThan,5):""}getNotEqual(){var e=xm(this.model);return e?__dcg_shared_module_exports__['mc'](e.notEqual,5):""}};var gt=__dcg_shared_module_exports__['h'](X());var Sx=class extends gt.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,gt.createElement("div",{class:gt.const("dcg-stats-footer-container dcg-do-blur"),handleEvent:gt.const("true")},gt.createElement("table",null,gt.createElement("tr",null,gt.createElement("td",null,gt.createElement("div",{class:gt.const("dcg-value"),role:gt.const("textbox"),"aria-readonly":gt.const("true"),tabindex:gt.const("0"),"aria-label":()=>"Min: "+this.getMin()},gt.createElement("span",{class:gt.const("dcg-row-header")},gt.const("Min")),gt.createElement("span",{class:gt.const("dcg-evaluation")},gt.createElement(tt,{config:this.const({}),latex:this.bindFn(this.getMin)}))))),gt.createElement("tr",null,gt.createElement("td",null,gt.createElement("div",{class:gt.const("dcg-value"),role:gt.const("textbox"),"aria-readonly":gt.const("true"),tabindex:gt.const("0"),"aria-label":()=>"Q1: "+this.getQ1()},gt.createElement("span",{class:gt.const("dcg-row-header")},gt.const("Q1")),gt.createElement("span",{class:gt.const("dcg-evaluation")},gt.createElement(tt,{config:this.const({}),latex:this.bindFn(this.getQ1)}))))),gt.createElement("tr",null,gt.createElement("td",null,gt.createElement("div",{class:gt.const("dcg-value"),role:gt.const("textbox"),"aria-readonly":gt.const("true"),tabindex:gt.const("0"),"aria-label":()=>"Median: "+this.getMedian()},gt.createElement("span",{class:gt.const("dcg-row-header")},gt.const("Median")),gt.createElement("span",{class:gt.const("dcg-evaluation")},gt.createElement(tt,{config:this.const({}),latex:this.bindFn(this.getMedian)}))))),gt.createElement("tr",null,gt.createElement("td",null,gt.createElement("div",{class:gt.const("dcg-value"),role:gt.const("textbox"),"aria-readonly":gt.const("true"),tabindex:gt.const("0"),"aria-label":()=>"Q3: "+this.getQ3()},gt.createElement("span",{class:gt.const("dcg-row-header")},gt.const("Q3")),gt.createElement("span",{class:gt.const("dcg-evaluation")},gt.createElement(tt,{config:this.const({}),latex:this.bindFn(this.getQ3)}))))),gt.createElement("tr",null,gt.createElement("td",null,gt.createElement("div",{class:gt.const("dcg-value"),role:gt.const("textbox"),"aria-readonly":gt.const("true"),tabindex:gt.const("0"),"aria-label":()=>"Max: "+this.getMax()},gt.createElement("span",{class:gt.const("dcg-row-header")},gt.const("Max")),gt.createElement("span",{class:gt.const("dcg-evaluation")},gt.createElement(tt,{config:this.const({}),latex:this.bindFn(this.getMax)})))))))}getMin(){let e=vm(this.model);return e?__dcg_shared_module_exports__['lc'](e.min):""}getQ1(){let e=vm(this.model);return e?__dcg_shared_module_exports__['lc'](e.q1):""}getMedian(){let e=vm(this.model);return e?__dcg_shared_module_exports__['lc'](e.median):""}getQ3(){let e=vm(this.model);return e?__dcg_shared_module_exports__['lc'](e.q3):""}getMax(){let e=vm(this.model);return e?__dcg_shared_module_exports__['lc'](e.max):""}};var Yn=__dcg_shared_module_exports__['h'](X());var{If:cX}=Yn.Components,bg=class extends Yn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Yn.createElement("div",{class:Yn.const("dcg-action-info"),handleEvent:Yn.const("true")},Yn.createElement("span",{class:Yn.const("dcg-action-label")},Yn.const("Run ")),Yn.createElement(tt,{latex:()=>this.model.clickableInfo.latex,config:this.bindFn(this.getMQConfig)}),Yn.createElement("span",{class:Yn.const("dcg-action-label")},Yn.const(" on click")),Yn.createElement(cX,{predicate:()=>!this.controller.isItemReadonly(this.model.id)},()=>Yn.createElement("span",{class:Yn.const("dcg-click-edit"),role:Yn.const("button"),tabindex:Yn.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-action"),onTap:this.bindFn(this.editAction)},Yn.createElement("i",{class:Yn.const("dcg-icon-pencil"),"aria-hidden":Yn.const("true")}))))}editAction(){this.model.type==="expression"?this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}):this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"updaterule"}})}getMenuGUID(){return this.model.guid}getMQConfig(){return{autoOperatorNames:$a({additionalOperators:["index"]}),autoCommands:Id()}}};var Qt=__dcg_shared_module_exports__['h'](X());var{If:ik}=Qt.Components,Xl=class extends Qt.Class{init(){this.controller=this.props.controller()}template(){return Qt.createElement(ik,{predicate:this.bindFn(this.shouldShowOptions)},()=>Qt.createElement("span",{class:()=>({"dcg-expression-edit-actions":!0,"dcg-limited-height":this.limitedHeight()}),style:()=>({background:this.controller.getBackgroundColor()}),didMount:()=>{this.controller.isInEditListMode()&&xe(this.controller.s("graphing-calculator-narration-edit-list-mode-on"))},didUnmount:()=>{this.controller.isInEditListMode()||xe(this.controller.s("graphing-calculator-narration-edit-list-mode-off"))}},Qt.createElement(ik,{predicate:()=>!this.controller.hasBackgroundColor()},()=>Qt.createElement("span",{class:Qt.const("dcg-graphic"),handleEvent:Qt.const("true ")})),Qt.createElement(ik,{predicate:this.bindFn(this.canConvertToTable)},()=>Qt.createElement(Ke,{tooltip:this.bindFn(this.getConvertTooltip),gravity:this.const("s")},Qt.createElement("span",{class:Qt.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:Qt.const("true"),role:Qt.const("button"),tabindex:Qt.const("0"),"aria-label":()=>$i(this.model(),"create_table"),onTap:this.bindFn(this.onCreateTable)},Qt.createElement("i",{class:Qt.const("dcg-icon-table"),"aria-hidden":Qt.const("true")})))),Qt.createElement(ik,{predicate:()=>this.controller.shouldShowAuthorFeatures()},()=>Qt.createElement(Ke,{tooltip:this.bindFn(this.getReadonlyToggleLabel),gravity:this.const("s")},Qt.createElement("span",{class:()=>({"dcg-action-lock":!0,"dcg-exp-action-button":!0,"dcg-selected":this.isReadonly()}),handleEvent:Qt.const("true"),role:Qt.const("button"),tabindex:Qt.const("0"),"aria-label":this.bindFn(this.getReadonlyToggleLabel),onTap:this.bindFn(this.onToggleReadonly)},Qt.createElement("i",{class:Qt.const("dcg-icon-lock"),"aria-hidden":Qt.const("true")})))),Qt.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),gravity:this.const("s")},Qt.createElement("span",{class:Qt.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:Qt.const("true"),role:Qt.const("button"),tabindex:Qt.const("0"),"aria-label":()=>$i(this.model(),"duplicate"),onTap:this.bindFn(this.onDuplicateWithoutFocus)},Qt.createElement("i",{class:Qt.const("dcg-icon-duplicate"),"aria-hidden":Qt.const("true")}))),Qt.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),gravity:this.const("sw")},Qt.createElement("span",{class:Qt.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:Qt.const("true"),role:Qt.const("button"),tabindex:Qt.const("0"),"aria-label":()=>$i(this.model(),"delete"),onTap:this.bindFn(this.onDelete)},Qt.createElement("i",{class:Qt.const("dcg-icon-remove"),"aria-hidden":Qt.const("true")})))))}shouldShowOptions(){return this.controller.isInEditListMode()&&(this.controller.shouldShowAuthorFeatures()||!this.controller.isItemReadonly(this.props.id()))}model(){return this.controller.getItemModel(this.props.id())}getConvertTooltip(){return this.shouldInsertOnCreateTable()?this.controller.s("graphing-calculator-label-convert-to-table-tooltip"):this.controller.s("graphing-calculator-label-create-table")}canConvertToTable(){let e=this.model();return!!(e&&e.type==="expression"&&e.formula.is_tableable)}limitedHeight(){let e=this.model();return e&&(e.type==="image"||this.isSlider())}isSlider(){let e=this.model();return e&&e.type==="expression"&&e.sliderExists}generateSubscriptedTableColumns(e,t,i){var n={independent:t,dependent:i};if(t==="x")return n;var o=__dcg_shared_module_exports__['gc'](t);if(o.type!=="Identifier")return n;var s=__dcg_shared_module_exports__['gc'](i);if(s.type!=="FunctionCall"||s.args.length!==1)return n;var a=s.args[0];if(a.type!=="Identifier"||a._symbol!==t)return n;let l=s.getInputString(),c=a.getInputSpan(),u=l.substr(0,c.start),p=l.substr(c.end);return n.independent="x_{"+e+"}",n.dependent=u+n.independent+p,n}shouldInsertOnCreateTable(){let e=this.model();return!!e&&e.type==="expression"&&Kl(e)}onCreateTable(){let e=this.model();if(!(!e||e.type!=="expression")){var t=e.formula;if(t.is_tableable&&t.table_info){var i=t.table_info,n=e.index,o=i.independent_variable,s=i.dependent_column;if(i.by_reference){let C=this.generateSubscriptedTableColumns(this.controller.generateTableXSubscript(),o,s);o=C.independent,s=C.dependent}var a,l=[],c=[];if(i.values)for(a=0;a<i.values.length;a++){var u=i.values[a][0];l.push(isNaN(u)?"":u+"");var p=i.values[a][1];c.push(isNaN(p)?"":p+"")}else for(a=-2;a<=2;a++)l.push(a+""),c.push("");var g={id:this.controller.generateId(),type:"table",readonly:!i.by_reference&&e.readonly,columns:[{id:this.controller.generateId(),latex:o,color:this.controller.getNextColor(),hidden:!1,values:l,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""},{id:this.controller.generateId(),latex:s,color:kc(e),hidden:!1,values:c,points:!0,lines:this.shouldInsertOnCreateTable()&&!!e.lines,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""}]},h=this.controller;this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1}),this.shouldInsertOnCreateTable()?this.controller.dispatch({type:"replace-item-at-index",index:n,state:g,focus:!0}):this.controller.dispatch({type:"insert-item-at-index",index:n+1,state:g,folderId:e.folderId,focus:!0});var b=function(){h.dispatch({type:"undo"}),h.dispatch({type:"set-edit-list-mode",isEditListMode:!0,focusExpressionList:!1})};this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-table-created"),undoCallback:b}})}}}onDelete(e){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:e.device==="keyboard"})}onDuplicateWithoutFocus(){let e=this.model();e&&(e.type==="folder"?this.controller.dispatch({type:"duplicate-folder",id:this.props.id()}):this.controller.dispatch({type:"duplicate-expression",id:this.props.id()}))}isReadonly(){return this.controller.isItemReadonly(this.props.id())}onToggleReadonly(){let e=this.model();e&&this.controller.dispatch({type:"set-item-readonly",id:this.props.id(),readonly:!e.readonly})}getReadonlyIcon(){return this.isReadonly()?"dcg-icon-lock":"dcg-icon-pencil"}getReadonlyToggleLabel(){return this.isReadonly()?this.controller.s("graphing-calculator-label-unlock-expression-tooltip"):this.controller.s("graphing-calculator-label-lock-expression-tooltip")}};var Ea=__dcg_shared_module_exports__['h'](X());var{If:dX}=Ea.Components,$f=class extends Ea.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Ea.createElement(dX,{predicate:()=>this.controller.showExpressionZoomFitButton(this.model)},()=>Ea.createElement("div",{class:Ea.const("dcg-suggested-zoom-view dcg-do-blur"),handleEvent:Ea.const(!0)},Ea.createElement(Ke,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e"},Ea.createElement("i",{onTap:this.bindFn(this.onZoom),role:Ea.const("button"),tabindex:Ea.const("0"),"aria-label":this.bindFn(this.getZoomText),class:Ea.const("dcg-icon-zoom-fit")}))))}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit",id:this.model.id,focusAfterTap:e.device==="keyboard"})}};var ft=__dcg_shared_module_exports__['h'](X());var Vo=__dcg_shared_module_exports__['h'](X());var{If:uX}=Vo.Components,{Switch:pX}=Vo.Components,Ql=class extends Vo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}iconType(){return this.controller.shouldShowReplaceIcon()?"rename":this.controller.isItemReadonly(this.model.id)?this.controller.shouldShowAuthorFeatures()?"lock":"none":"delete"}getAriaLabel(){switch(this.iconType()){case"none":case"lock":return;case"rename":return $i(this.model,"rename");case"delete":return $i(this.model,"delete")}}onIconTap(){this.iconType()==="delete"?this.controller.dispatch({type:"delete-item-and-animate-out",id:this.model.id,setFocusAfterDelete:!this.controller.isInEditListMode()}):this.iconType()==="rename"&&this.controller.dispatch({type:"rename-identifier-in-item",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr(),id:this.model.id})}isIconTappable(){let e=this.iconType();return e!=="none"&&e!=="lock"}template(){return Vo.createElement(uX,{predicate:()=>!this.controller.isInEditListMode()},()=>Vo.createElement("div",{class:Vo.const("dcg-top-level-icon"),tabIndex:()=>this.isIconTappable()?0:-1,"aria-label":this.bindFn(this.getAriaLabel),handleEvent:this.bindFn(this.isIconTappable),onTap:this.bindFn(this.onIconTap),role:Vo.const("button"),manageFocus:this.const({shouldBeFocused:()=>Qh({controller:this.controller,location:{type:"top-level-icon",id:this.model.id}}),onFocusedChanged:(e,t)=>{var i;e?this.controller.dispatch({type:"set-focus-location",location:{type:"top-level-icon",id:this.model.id}}):t.relatedTarget&&!((i=t.relatedTarget)!=null&&i.closest("[data-dcg-label]"))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"top-level-icon",id:this.model.id}})}})},Vo.createElement(pX,{key:()=>this.iconType()},e=>{switch(e){case"delete":return Vo.createElement("i",{class:Vo.const("dcg-icon-remove dcg-top-level-delete"),"aria-hidden":Vo.const("true")});case"lock":return Vo.createElement("i",{class:Vo.const("dcg-icon-lock dcg-lock-indicator"),"aria-hidden":Vo.const("true")});case"rename":return Vo.createElement("i",{class:Vo.const("dcg-icon-replace"),"aria-hidden":Vo.const("true")});case"none":return Vo.createElement("span",null)}})))}};var{If:jp,SwitchUnion:gX}=ft.Components,Ex=class extends Sa{didMount(){this.onItemViewMounted(),this.lastBrailleMode=this.controller.getBrailleMode()}didMountRootNode(e){this.rootNode=e}willUnmount(){this.onItemViewUnmounted()}template(){return ft.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-mathitem":!0,"dcg-inFolder":!!this.model.folderId,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-selected":this.controller.isItemSelected(this.id)&&!this.controller.isInEditListMode(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-hasSlider":this.hasSlider(),"dcg-hasEvaluation":this.controller.shouldShowEvaluationForItem(this.id),"dcg-hasRegression":this.hasRegression(),"dcg-hasDomain":this.hasDomain()||this.hasDomain3d()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRootNode)},ft.createElement("div",{class:ft.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},ft.createElement("div",{class:ft.const("dcg-main")},ft.createElement(jp,{predicate:()=>!this.controller.isInEditListMode()&&!this.isReadonly()},()=>ft.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>Eb(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),brailleShouldFocus:()=>this.isFocused(),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onBrailleKeydown:this.bindFn(this.handleBraillePressedKey)},go(this.controller)),ft.createElement(it,{latex:()=>Eb(this.model),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:()=>this.isFocused(),tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),ft.createElement(jp,{predicate:()=>this.controller.isInEditListMode()||this.isReadonly()},()=>ft.createElement("div",{class:ft.const("dcg-edit-list-mathquill"),tabindex:()=>this.controller.getBrailleMode()==="none"?"0":"-1",onTap:()=>this.controller.isInEditListMode()?this.exitEditListMode():{},onKeydown:this.bindFn(this.handleReadonlyPressedKey),manageFocus:this.const({shouldBeFocused:()=>this.controller.getBrailleMode()!=="none"?!1:Qh({controller:this.controller,location:{type:"readonly-expression",id:this.model.id}}),onFocusedChanged:(e,t)=>{this.controller.getBrailleMode()==="none"&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}}))}})},ft.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>Eb(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),isStatic:this.const(!0),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="readonly-expression"?!1:e.id===this.id},onBrailleFocusedChanged:(e,t)=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}})}},go(this.controller)),ft.createElement(tt,{latex:()=>Eb(this.model),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),tokenController:this.props.controller}))))),ft.createElement(Ql,{controller:this.props.controller,model:this.props.model}),ft.createElement(jp,{predicate:this.bindFn(this.shouldShowFooter)},()=>ft.createElement("div",{class:this.getFooterClass()},gX(()=>this.getFooterType(),{none:()=>{},regression:()=>ft.createElement(mx,{model:this.props.model,controller:this.props.controller}),label:()=>ft.createElement(yg,{model:this.props.model,controller:this.props.controller}),slider:()=>ft.createElement(bx,{model:this.props.model,controller:this.props.controller}),domain:()=>ft.createElement(fg,{model:this.props.model,controller:this.props.controller}),domain3d:()=>ft.createElement("div",null,ft.createElement(fg,{model:this.props.model,controller:this.props.controller,parameter:()=>this.domainVariable1(this.props.model())}),ft.createElement(fg,{model:this.props.model,controller:this.props.controller,parameter:()=>this.domainVariable2(this.props.model())})),evaluation:()=>ft.createElement(mg,{id:()=>this.props.model().id,dependent:()=>po(this.model)||"",val:()=>this.controller.getEvaluationValueForItem(this.id),controller:this.props.controller,focusable:this.const(!0)}),distribution:()=>ft.createElement(vx,{model:this.props.model,controller:this.props.controller}),visualization:()=>ft.createElement(Cx,{model:this.props.model,controller:this.props.controller}),ttest:()=>ft.createElement(Dx,{model:this.props.model,controller:this.props.controller}),stats:()=>ft.createElement(Sx,{model:this.props.model,controller:this.props.controller}),unresolved:()=>ft.createElement(gx,{controller:this.props.controller})}),ft.createElement(jp,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>ft.createElement("div",{tabindex:ft.const(0),class:ft.const("dcg-expression-braille-error"),role:ft.const("button"),"aria-roledescription":ft.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},ft.createElement("i",{class:ft.const("dcg-icon-error"),"aria-hidden":ft.const("true")}),()=>this.controller.unpack(this.model.error))),ft.createElement(jp,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>ft.createElement(qc,{model:this.props.model,controller:this.props.controller})),ft.createElement(jp,{predicate:this.bindFn(this.shouldShowRenamePrompt)},()=>ft.createElement(wx,{from:this.bindFn(this.getRenameIdentifierFrom),to:this.bindFn(this.getRenameIdentifierTo),count:this.bindFn(this.getRenameCountOfChanges),handleRename:this.bindFn(this.handleRename)})),ft.createElement(jp,{predicate:this.bindFn(this.shouldShowThreeDPrompt)},()=>ft.createElement("div",{class:ft.const("dcg-create-sliders"),handleEvent:ft.const("true"),onTap:this.bindFn(this.switchTo3D)},ft.createElement("div",{class:ft.const("dcg-slider-btn-container"),var_name:this.const("3D")},ft.createElement("div",{role:ft.const("button"),tabindex:ft.const("0"),class:ft.const("dcg-btn-slider dcg-btn-light-gray")},()=>"Switch to 3D")))))),ft.createElement(jp,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>ft.createElement("div",{class:this.getFooterClass()},ft.createElement(bg,{model:this.props.model,controller:this.props.controller})))),ft.createElement("span",{class:ft.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:ft.const("true"),tapboundary:ft.const("true"),disablescroll:ft.const("true"),onTapStart:this.bindFn(this.onDragPending)},ft.createElement("span",{class:ft.const("dcg-num")},()=>this.model.displayIndex),ft.createElement("div",{class:ft.const("dcg-tab-interior dcg-action-icon-mouse")},ft.createElement(hx,{model:this.props.model,controller:this.props.controller})),ft.createElement($f,{model:this.props.model,controller:this.props.controller})),ft.createElement(Xl,{controller:this.props.controller,id:()=>this.model.id}))}domainVariable1(e){return bl(e)?"\\theta":Ra(e)?"r":"u"}domainVariable2(e){return bl(e)?"\\phi":Ra(e)?"\\theta":"v"}getRenameIdentifierFrom(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.from||""}getRenameIdentifierTo(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.to||""}getRenameCountOfChanges(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.countOfChanges||0}handleRename(){this.controller.dispatch({type:"rename-identifier-global",search:this.getRenameIdentifierFrom(),replace:this.getRenameIdentifierTo()})}didUpdate(){this.lastBrailleMode=this.controller.getBrailleMode()}shouldShowFooter(){return this.shouldShowBrailleError()||this.shouldShowSliderPrompt()||this.shouldShowRenamePrompt()||this.shouldShowThreeDPrompt()?!0:this.getFooterType()!=="none"}getFooterType(){return this.hasRegression()?"regression":this.shouldShowLabelView()?"label":this.hasSlider()?"slider":this.hasDomain()?"domain":this.hasDomain3d()?"domain3d":this.isTTest()?"ttest":this.isStats()?"stats":this.controller.shouldShowEvaluationForItem(this.id)?"evaluation":this.isToplevelDistribution()?"distribution":this.isVisualization()?"visualization":this.model.unresolved?"unresolved":"none"}shouldShowThreeDPrompt(){var e;return this.controller.is3dProduct()&&!this.controller.isThreeDMode()&&__dcg_shared_module_exports__['ic']((e=this.model.formula.graphMode3d)!=null?e:10)}switchTo3D(){this.controller.dispatch({type:"set-graph-settings",threeDMode:!0})}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-indent-in-folder dcg-fadein-bottom")}onCreateSliders(e){this.controller.dispatch({type:"create-sliders-for-item",id:this.id,variables:e})}shouldShowLabelView(){return Ai("labels")&&aF(this.model)&&!this.controller.isThreeDMode()}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?rD(this.model).length>0:!1}shouldShowRenamePrompt(){return this.getRenameCountOfChanges()>0}shouldShowActionInfo(){return!!(this.controller.areActionsEnabled()&&this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&this.hasError()}hasRegression(){return!!(this.model.formula&&this.model.formula.is_regression)}hasDomain(){return fD(this.model)}hasDomain3d(){return yD(this.model)}isToplevelDistribution(){return Ep(this.model)}isVisualization(){return CD(this.model)}isTTest(){return DD(this.model)}isStats(){return lF(this.model)}hasSlider(){return!!this.model.sliderExists}getLabelOptions(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)}getAriaLabel(e){if(this.shouldShowLabelView()){var t;this.model.label&&this.model.label!==""?t=this.model.label:e==="speech"?t=this.controller.s("graphing-calculator-narration-expression-label"):t=this.controller.raw("lbl");var i;return Cc(this.model)?i=t:e==="speech"?i=this.controller.s("graphing-calculator-narration-expression-hidden-label",{label:t}):i=this.controller.raw("h __label__",{label:t}),i}return e==="speech"?this.controller.s("shared-calculator-narration-expression-index",{index:this.model.displayIndex}):this.controller.raw("eq__index__",{index:this.model.displayIndex})}getFormulaAria(){let e=this.model.formula,t="";if(!e||Na(this.model))return t;if(this.controller.shouldShowEvaluationForItem(this.id)){t="equals ";let i=e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.constant_value;Array.isArray(i)?t+=i.length+" element list.":i!==void 0&&(t+=Hs(__dcg_shared_module_exports__['Hb'](+i,this.getLabelOptions())))}else e.error&&!this.shouldShowSliderPrompt()?t=this.controller.unpack(e.error):Ep(this.model)?t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution"):this.isTTest()&&(t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test"));if(this.model.shouldGraph&&(e.is_graphable||e.is_regression)){e.is_graphable&&e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression"):e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression"):t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph");let i=this.controller.getAudioGraph();i&&i.agNavigator.canTrace(this.model)&&(di?t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows"))}return t}handleBraillePressedKey(e){let t=Re(e);if(t){if(t==="Esc")pi(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});else if(t==="Up"||t==="Down"||t==="Enter")this.controller.dispatch({type:"on-special-key-pressed",key:t});else if(t==="Del"||t==="Backspace"){let i=Da();Na(this.model)&&Kf(i)&&(this.controller.dispatch({type:"on-special-key-pressed",key:t==="Del"?"Delete":t}),e.preventDefault(),e.stopPropagation())}}}handleReadonlyPressedKey(e){if(this.controller.isInEditListMode())return;let t=Re(e);!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(t==="Esc"?(e.preventDefault(),e.stopPropagation(),pi(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}})):(t==="Up"||t==="Down"||t==="Enter")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:t})))}handlePressedKey(e,t){var o;var i=it.getFocusedMathquill();if(i){if(t&&this.controller.isGraphPaperFocused()){let s=(o=this.controller.getGrapher2d())==null?void 0:o.poiController;if(!s)return;let a=s.keyboardAttentionManager;if(e==="Tab"||e==="Shift-Tab"){t.stopPropagation(),t.preventDefault(),a.focusNextObjFromKeyboard({direction:t.shiftKey?"prev":"next"});return}else if(e==="Left"||e==="Right"||e==="Up"||e==="Down"||e==="Shift-Left"||e==="Shift-Right"||e==="Shift-Up"||e==="Shift-Down"){t.stopPropagation(),t.preventDefault(),t&&s.moveGeoPointFromKeyboard(t);return}else if(e==="Enter"){t.stopPropagation(),t.preventDefault();let l=a.getKeyboardAttention();s.tapGeoPointFromKeyboard(t),this.controller.getEvaluator().notifyWhenSynced(()=>{let c=this.controller.getValidCursorContext(),u=this.model.formula.cursor_context;if(c&&c===u){let p=this.controller.getFocusLocation();if(p&&p.type==="expression"&&p.id===this.model.id&&!p.isFakeGraphFocus&&this.controller.dispatch({type:"set-focus-location",location:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},p),{isFakeGraphFocus:!0})}),l){let g=a.findTabbableObjectsForCurrentTool(l);g.currentIsTabbable&&a.updateKeyboardAttention(g.targets[g.currentTabIndex],{describe:!1})}}});return}else if(e==="Esc"){t.stopPropagation(),t.preventDefault(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}});return}}if(e==="Esc"){pi(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});return}else if(e==="Up"||e==="Down"){var n=it.applyArrowKeyAndReturnIfWasAtBounds(i,e,t);return n?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0}else if(e==="Delete"||e==="Backspace"){if(Na(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if(e==="Enter")return t&&(t.preventDefault(),t.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});i.keystroke(e,t),this.handleLatexChanged(i.latex())}}handleLatexChanged(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e})}doesNodeBelongToSliderLimit(e){return!e||!this.rootNode.contains(e)?!1:!!O(e).closest("[data-dcg-label]").length}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):!this.doesNodeBelongToSliderLimit(t.relatedTarget)&&this.lastBrailleMode===this.controller.getBrailleMode()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})}onMouseSelect(e){this.isReadonly()||e.device!=="keyboard"&&(e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="expression"?!1:e.id===this.id}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="slider-thumb"?!1:e.id===this.id}hasError(){return!!this.model.error&&!Na(this.model)}getMQConfig(){return this.controller.getMathquillConfig({})}};function go(r,e){let t=i=>ft.createElement(tt,{config:()=>({}),latex:()=>i});return{tooltipOptions:()=>__dcg_shared_module_exports__['a']({latexView:t},e||{}),sixKeyInput:()=>r.getSixKeyInput(),mode:()=>r.getBrailleMode(),capExpressionSize:()=>r.getCapExpressionSize()?{exceedsLimit:i=>i.length>xf,onExpressionSizeExceeded:()=>r.dispatch({type:"expression-size-exceeded"})}:void 0}}var zc=__dcg_shared_module_exports__['h'](X());ct();var{Textarea:mX}=zc.Components,Ou=class extends zc.Class{template(){return zc.createElement("div",{class:zc.const("dcg-smart-textarea-container")},zc.createElement("div",{class:zc.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),zc.createElement(mX,{class:()=>({"dcg-do-blur":!0,"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!this.props.text()}),"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},placeholder:this.bindFn(this.getPlaceholder),readonly:()=>this.props.readonly()?!0:void 0,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeydown:this.bindFn(this.onKeydownEvent)}))}getDisplayTextHTML(){let e=this.props.text()||"",t=(o,s)=>e.slice(o,s).replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=0,n="";if(this.props.showLinks()){let o=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,s=null;for(;(s=o.exec(e))!==null;){let[a]=s;n+=t(i,s.index),n+=`<a rel='nofollow ugc' href='${a}' target ='_blank'>${a}</a>`,i=o.lastIndex}}return n+=t(i),n}willUnmount(){this.textareaNode=void 0}didMountDisplay(e){this.displayNode=e,O(e).on("touchend",function(t){t.preventDefault()}),O(e).on("dcg-tap dcg-tapstart","a",function(t){t.handle()}),this.renderDisplayText()}didMountTextarea(e){this.textareaNode=e,O(e).on("dcg-tapstart",t=>{t.handle()}),O(e).on("focusin focusout",()=>this.onFocusEvent()),this.updateFocused()}didUpdate(){this.updateFocused(),this.renderDisplayText()}onFocusEvent(){if(this.textareaNode){var e=document.activeElement===this.textareaNode;this.shouldBeFocused()!==e&&this.props.onFocusChange(e)}}renderDisplayText(){if(!this.displayNode)return;let e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}isFocused(){return document.activeElement===this.textareaNode}shouldBeFocused(){return this.props.shouldFocus()}updateFocused(){if(!this.textareaNode)return;let e=this.isFocused(),t=this.shouldBeFocused();if(e!==t)if(!t)this.textareaNode.blur();else{if(dl&&du)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}}onKeydownEvent(e){var t=this.textareaNode;if(!t)return;var i=Re(e);let n=this.props.readonly(),o=this.props.readonlyAction&&this.props.readonlyAction();if(n&&o!==void 0&&o.predicate()){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(i===Fl||i===hb)&&(e.preventDefault(),o.action());return}i===Fl&&!e.metaKey?(e.preventDefault(),this.props.onSpecialKey("Enter")):i===Do?pi():i===So?(n||t.selectionStart===0&&t.selectionEnd===0)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Up")):i===Eo?(n||t.selectionStart===t.value.length&&t.selectionEnd===t.value.length)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Down")):i===ul&&!(n&&o!==void 0&&o.predicate())?t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):i===Ah&&!(n&&o!==void 0&&o.predicate())&&t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Delete")),this.props.onKeydown&&this.props.onKeydown(e)}getPlaceholder(){var e,t;if(!this.props.text())return(t=(e=this.props).placeholder)==null?void 0:t.call(e)}};var To=__dcg_shared_module_exports__['h'](X());var kx=class extends Sa{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return To.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressiontext":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id)}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},To.createElement("div",{class:To.const("dcg-fade-container")},To.createElement("div",{class:To.const("dcg-main")},To.createElement(Ou,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.text,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),ariaLabel:()=>$i(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-note-placeholder")})),To.createElement(Ql,{controller:this.props.controller,model:this.props.model})),To.createElement("span",{class:To.const("dcg-tab dcg-action-drag"),handleevent:To.const("true"),tapboundary:To.const("true"),disablescroll:To.const("true"),onTapStart:this.bindFn(this.onDragPending)},To.createElement("span",{class:To.const("dcg-num")},()=>this.model.displayIndex),To.createElement("div",{class:To.const("dcg-tab-interior")}),To.createElement("i",{class:To.const("dcg-icon-text"),"aria-hidden":To.const("true")})),To.createElement(Xl,{controller:this.props.controller,id:()=>this.model.id}))}onInput(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="text"||e.id!==this.id)}};var Yt=__dcg_shared_module_exports__['h'](X());ct();var fi=__dcg_shared_module_exports__['h'](X());var aa=__dcg_shared_module_exports__['h'](X());var{SwitchUnion:fX}=aa.Components,Gx=class extends aa.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return aa.createElement("div",{class:aa.const("dcg-table-icon-container")},fX(this.bindFn(this.typeOfIcon),{error:()=>aa.createElement(ms,{error:()=>this.controller.unpack(this.model.error),gravity:this.const("se")}),none:()=>aa.createElement("span",null),icon:()=>aa.createElement("div",{class:aa.const("dcg-circular-icon-container"),role:aa.const("button"),tabindex:aa.const("0"),"aria-label":this.bindFn(this.getIconAriaLabel),handleevent:aa.const("true"),"dcg-open-menu-guid":()=>this.getMenuGUID(),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions();if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions()},manageFocus:this.const(Vt({controller:this.controller,location:{type:"table-icon",id:this.model.table.id,columnId:this.model.id}}))},aa.createElement(Io,{iconType:this.bindFn(this.getIcon),backgroundColor:this.bindFn(this.getModelColor)}))}))}getModelColor(){return Zb(this.model)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-column",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}})}toggleGraphShown(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})}hasError(){return!!this.model.error}getIcon(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"}typeOfIcon(){return this.model.latex===""||!this.controller.getGraphSettings().config.graphpaper?"none":this.model.error?"error":this.model.index===0?"none":"icon"}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.shouldGraph?this.controller.s("graphing-calculator-narration-hide-table-column"):this.controller.s("graphing-calculator-narration-show-table-column")}};var{If:Ix}=fi.Components,Vx=class extends fi.Class{init(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.table}isRightSide(){return this.lookupCellPosition().column>=this.table.columnModels.length-1}template(){return fi.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-table-header":!0,"dcg-do-not-blur":!0,"dcg-left":this.model.index===0,"dcg-right":this.isRightSide(),"dcg-selected":this.shouldFocus()&&!this.table.readonly,"dcg-error":!!this.model.error,"dcg-leave-space-for-icon":this.leaveSpaceForIcon()}),index:()=>this.model.index,onTapStart:this.bindFn(this.focusThisCell)},fi.createElement("div",{class:fi.const("dcg-inner-border")}),fi.createElement(Ix,{predicate:()=>!this.isRightSide()&&(!this.controller.is3dProduct()||!!this.model.error)},()=>fi.createElement(Gx,{model:this.props.model,controller:this.props.controller})),fi.createElement("div",{role:fi.const("columnheader")},fi.createElement(Ix,{predicate:()=>!this.controller.isInEditListMode()&&!this.table.readonly},()=>fi.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocus),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput)},go(this.props.controller(),{gravity:"s"})),fi.createElement(it,{latex:()=>this.model.latex||"",isFocused:this.bindFn(this.shouldFocus),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),fi.createElement(Ix,{predicate:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.table.id)},()=>fi.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),tabindex:this.const(-1),isStatic:this.const(!0),brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged)},go(this.props.controller(),{gravity:"s"})),fi.createElement(tt,{latex:()=>this.model.latex||"",config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech")},fi.createElement("span",{class:fi.const("dcg-math-field dcg-cell-math-content"),role:fi.const("textbox"),"aria-readonly":fi.const("true"),tabindex:()=>this.controller.isInEditListMode()?-1:0,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),fi.createElement(Ix,{predicate:()=>this.model.dragMode!=="NONE"&&!this.model.error},()=>fi.createElement("span",{class:fi.const("dcg-drag-icon"),"dcg-drag-mode":()=>this.model.dragMode,style:()=>({color:this.model.color})},fi.createElement("i",{class:()=>({"dcg-icon-move":this.model.dragMode==="XY","dcg-icon-move-horizontal":this.model.dragMode==="X","dcg-icon-move-vertical":this.model.dragMode==="Y"}),"aria-hidden":fi.const("true")})))),fi.createElement("div",{class:fi.const("dcg-empty-line")}),fi.createElement(Ix,{predicate:()=>this.isRightSide()},()=>fi.createElement("span",{class:fi.const("dcg-fade-right")})))}leaveSpaceForIcon(){if(this.model.error||this.controller.is3dProduct())return!1;let{column:e}=this.lookupCellPosition(),t=ef(this.table);return e>0&&e<t-1}focusThisCell(e){e.wasHandled()||(e.handle(),!this.controller.isItemReadonly(this.table.id)&&(this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})))}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:0,column:this.model.index}}getAriaLabel(e){var t=this.lookupCellPosition();return e==="speech"?this.controller.s("graphing-calculator-narration-table-column-header",{column:t.column+1}):this.controller.raw("h__column__",{column:t.column+1})}getAriaPostLabel(){let e="",t=this.model;return t.shouldGraph&&(t.points||t.lines)&&!_2(t)&&(e=this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"),di?e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")),e}handlePressedKey(e,t){var i=it.getFocusedMathquill();i&&(it.handleKeystrokeAndDecideIfSpecialEvent(i,e,t)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex()))}handleKeydownOnBrailleInput(e){let t=Re(e);if(!t)return;let i=t==="Enter"||t==="Up"||t==="Down",n=Da(),o=n&&t==="Left"&&n.selectionStart===0||t==="Right"&&n.selectionStart===O(n).val().length,s=this.model.latex.length===0&&Kf(n);(i||o||(t==="Del"||t==="Backspace")&&s)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=Re(e);t!=="Tab"&&(e.preventDefault(),t==="Esc"&&pi(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))}handleLatexChanged(e){var t=this.model.latex;t!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return!this.controller.isInEditListMode()&&__dcg_shared_module_exports__['G'](this.lookupCellPosition(),Jo(this.table))}shouldFocusReadonlyCell(){return __dcg_shared_module_exports__['G'](this.lookupCellPosition(),Jo(this.table))}isNodeWithinTableCell(e){if(!e||O(e).closest(".dcg-cell").length===0)return!1;var t=this.controller.getItemRootNodeById(this.table.id);return t?O.contains(t,e):!1}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}getMQConfig(){return this.controller.getMathquillConfig({})}};var Sn=__dcg_shared_module_exports__['h'](X());ct();var{If:ML}=Sn.Components,Tx=class extends Sn.Class{init(){this.column=this.props.column(),this.controller=this.props.controller(),this.table=this.column.table}template(){return Sn.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-do-not-blur":!0,"dcg-empty":this.isEmpty(),"dcg-non-editable":!!this.column.disabled,"dcg-error":!!this.hasError(),"dcg-selected":this.shouldFocus()&&!this.controller.isItemReadonly(this.table.id)}),onTapStart:this.bindFn(this.focusThisCell)},Sn.createElement("div",{class:Sn.const("dcg-inner-border")}),Sn.createElement("div",{role:Sn.const("gridcell")},Sn.createElement(ML,{predicate:this.bindFn(this.hasError)},()=>Sn.createElement("span",{class:Sn.const("dcg-table-icon-error-container")},Sn.createElement(ms,{error:this.bindFn(this.getErrorMessage),gravity:this.const("se"),size:this.const("small")}))),Sn.createElement(ML,{predicate:()=>!this.isColumnEditable()},()=>Sn.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),ariaLabel:()=>this.getAriaLabel("braille"),tabindex:()=>this.controller.isInEditListMode()?-1:0,isStatic:this.const(!0),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:e=>(this.handleKeydownOnReadonlyCell(e),!0)},go(this.props.controller(),{gravity:"s"})),Sn.createElement(tt,{getAriaLabel:()=>this.getAriaLabel("speech"),latex:()=>this.getValue(),config:this.bindFn(this.getMQConfig)},Sn.createElement("span",{class:Sn.const("dcg-math-field dcg-cell-math-content dcg-mathquill-input-span"),role:Sn.const("textbox"),"aria-roledescription":()=>this.column.disabled?this.controller.s("graphing-calculator-narration-computed-cell-role-description"):void 0,"aria-readonly":Sn.const("true"),tabindex:()=>!this.controller.isInEditListMode()&&(!this.isEmpty()||!this.column.disabled)?0:-1,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),Sn.createElement(ML,{predicate:this.bindFn(this.isColumnEditable)},()=>Sn.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusEditableCell),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput),selectOnFocus:this.const(!0)},go(this.props.controller(),{gravity:"s"})),Sn.createElement(it,{latex:()=>this.getValue(),isFocused:this.bindFn(this.shouldFocusEditableCell),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getErrorMessage),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})))),Sn.createElement("div",{class:Sn.const("dcg-empty-line")}))}focusThisCell(e){e.wasHandled()||this.controller.isItemReadonly(this.table.id)||(e.handle(),!this.shouldFocus()&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))}handlePressedKey(e,t){var i=it.getFocusedMathquill();if(i){let n=it.handleKeystrokeAndDecideIfSpecialEvent(i,e,t);e===Do&&pi(),n?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex())}}handleKeydownOnBrailleInput(e){let t=Re(e);if(!t)return;t===Do&&pi();let i=t==="Enter"||t==="Up"||t==="Down",n=Da(),o=n&&t==="Left"&&n.selectionStart===0||t==="Right"&&n.selectionStart===O(n).val().length;(i||o||(t==="Del"||t==="Backspace")&&this.getValue().length===0)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=Re(e);t!=="Tab"&&(e.preventDefault(),t==="Esc"&&pi(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))}handleLatexChanged(e){var t=this.getValue();t!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return __dcg_shared_module_exports__['G'](this.lookupCellPosition(),Jo(this.table))}shouldFocusReadonlyCell(){return!this.controller.isInEditListMode()&&(this.controller.isItemReadonly(this.table.id)||!!this.column.disabled)&&this.shouldFocus()}shouldFocusEditableCell(){return!this.column.disabled&&this.shouldFocus()}isNodeWithinTableCell(e){if(!e||O(e).closest(".dcg-cell").length===0)return!1;var t=this.controller.getItemRootNodeById(this.table.id);return t?O.contains(t,e):!1}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:this.props.rowIdx(),column:this.column.index}}getPackedError(){return this.column.packedErrors[this.props.rowIdx()-1]}hasError(){return!!this.getPackedError()}getErrorMessage(){let e=this.getPackedError();return e?this.controller.unpack(e):""}getValue(){let e=this.props.rowIdx()-1,t=this.column.index;return tw(this.table,e,t)}isEmpty(){let e=Da();return this.getValue()===""&&Kf(e)}getAriaLabel(e){var t=this.lookupCellPosition(),i=t.row,n=t.column+1;return e==="speech"?this.controller.s("graphing-calculator-narration-table-row-column",{row:i.toString(),column:n.toString()}):this.controller.raw("r__row__c__column__",{row:i.toString(),column:n.toString()})}isColumnEditable(){return!this.column.disabled&&!this.controller.isItemReadonly(this.table.id)&&!this.controller.isInEditListMode()}getMQConfig(){return this.controller.getMathquillConfig({})}};ct();var{For:AL}=Yt.Components,Mx=class extends Sa{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Yt.createElement("div",{class:()=>({"dcg-expressionitem":!0,"dcg-expressiontable":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-faded-h":this.shouldFadeLastColumn(),"dcg-faded-v":this.shouldFadeLastRow()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountContainer),onKeydown:this.bindFn(this.onKeydown)},Yt.createElement("div",{class:Yt.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor")},Yt.createElement("div",{class:Yt.const("dcg-main")},Yt.createElement("div",{class:Yt.const("dcg-table-container"),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.getBrailleMode()==="none"?this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}):this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}),didMount:this.bindFn(this.didMountContainer),manageFocus:this.const({shouldBeFocused:this.shouldBeFocused.bind(this),onFocusedChanged:this.onFocusedChanged.bind(this)})},Yt.createElement("div",{class:Yt.const("dcg-table-sliding-container"),style:()=>({transform:`translateX(${this.computeScrolledX()}px)`})},Yt.createElement(AL,{each:()=>this.getVisibleRows(),key:e=>this.getRowGUID(e)},Yt.createElement("div",{role:Yt.const("grid"),class:Yt.const("dcg-tabledata")},e=>e.type==="show-more"?Yt.createElement("tr",{role:Yt.const("row"),class:Yt.const("dcg-show-more-row")},Yt.createElement("td",{colspan:this.bindFn(this.getColSpan)},this.bindFn(this.missingRowMessage),Yt.createElement("div",{tabindex:Yt.const(0),role:Yt.const("button"),class:Yt.const("dcg-show-more"),onTap:()=>this.controller.dispatch({type:"table-show-more-rows",id:this.id})},()=>this.controller.s("graphing-calculator-button-show-all-table-rows")))):e.type==="spacer-row"?Yt.createElement("tr",{role:Yt.const("row"),class:Yt.const("dcg-blank-row")},Yt.createElement("td",{colspan:this.bindFn(this.getColSpan),style:()=>({height:(e.endIdx-e.startIdx+1)*this.getRowHeight()+"px"})})):e.type==="header"?Yt.createElement(AL,{each:()=>this.model.columnModels,key:t=>t.guid},Yt.createElement("tr",{role:Yt.const("row"),"aria-rowindex":Yt.const(0),class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},t=>Yt.createElement(Vx,{controller:this.props.controller,model:this.const(t)}))):Yt.createElement(AL,{each:()=>this.model.columnModels,key:t=>t.guid},Yt.createElement("tr",{role:Yt.const("row"),"aria-rowindex":()=>e.index,class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},t=>Yt.createElement(Tx,{controller:this.props.controller,column:this.const(t),rowIdx:()=>e.index})))))))),Yt.createElement(Ql,{controller:this.props.controller,model:this.props.model})),Yt.createElement("span",{class:Yt.const("dcg-tab dcg-action-drag"),handleevent:Yt.const("true"),tapboundary:Yt.const("true"),disablescroll:Yt.const("true"),onTapStart:this.bindFn(this.onDragPending)},Yt.createElement("span",{class:Yt.const("dcg-num")},()=>this.model.displayIndex),Yt.createElement("div",{class:Yt.const("dcg-tab-interior")}),Yt.createElement($f,{model:this.props.model,controller:this.props.controller})),Yt.createElement(Xl,{controller:this.props.controller,id:()=>this.model.id}))}getRowGUID(e){switch(e.type){case"header":return"header";case"show-more":return"show-more";case"spacer-row":return`spacer-${e.startIdx}-${e.endIdx}`;case"standard-row":return`row-${e.index}`}}getColSpan(){return this.model.columnModels.length-1}getRowHeight(){return this.controller.getGraphSettings().config.projectorMode?38:33}getVisibleRows(){let e=[{type:"header"}],t=wa(this.model)+1;if(t<=25){for(let h=1;h<t;h++)e.push({type:"standard-row",index:h});return e}let i=Wh(this.model);if(i!==void 0){for(let h=1;h<i.min;h++)e.push({type:"standard-row",index:h});e.push({type:"show-more"});for(let h=i.max;h<t;h++)e.push({type:"standard-row",index:h});return e}let n=cx(this.controller),o=n?n.height:0,s=O(this.node).offset(),a=(s?s.top:0)-(n?n.top:0),l=O(this.node).find(".dcg-row:eq(0)").height(),c=this.getRowHeight();if(o/c>t){for(let h=1;h<t;h++)e.push({type:"standard-row",index:h});return e}let u=(-a-l)/c,p=(o-a)/c;for(var g=1;g<t;g++){let h=Jo(this.model);if(g===t-2||h&&h.row===g)e.push({type:"standard-row",index:g});else if(g>p||g<u){let b=e[e.length-1];b&&b.type==="spacer-row"?b.endIdx=g:e.push({type:"spacer-row",startIdx:g,endIdx:g})}else e.push({type:"standard-row",index:g})}return e}missingRowMessage(){let e=Wh(this.model);return e===void 0?"":this.controller.s("graphing-calculator-text-table-more-rows",{rowCount:e.max-e.min})}didMountContainer(e){this.node=e,O(e).on("scroll",()=>e.scrollLeft=0)}getSelectedCell(){return Jo(this.model)}computeScrolledX(){if(!this.getSelectedCell()||!this.node)return 0;let e=this.node.children[0],t=this.node.querySelector(".dcg-selected");if(e===null||t===null)return 0;let i=this.node.getBoundingClientRect(),n=t.getBoundingClientRect(),o=n.left-e.getBoundingClientRect().left,s=i.width-o-n.width-80,a=Math.min(0,i.width-e.scrollWidth-30);return s=Math.max(s,a),Math.min(0,s)}shouldFadeLastRow(){return F2(this.model)&&!this.isBottomFocused()}shouldFadeLastColumn(){return!this.isRightFocused()}isBottomFocused(){let e=this.getSelectedCell();return!!e&&e.row===wa(this.model)}isRightFocused(){let e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){return!!this.getSelectedCell()}onKeydown(e){this.controller.isInEditListMode()||e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey&&(Re(e)==="Up"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInColumn()):Re(e)==="Down"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInColumn()):Re(e)==="Left"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInRow()):Re(e)==="Right"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInRow()):Di(e)==="H"&&(e.preventDefault(),e.stopPropagation(),this.speakColumnHeader()))}moveToFirstCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:0,column:e.column}}})}moveToLastCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:wa(this.model),column:e.column}}})}moveToFirstCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:0}}})}moveToLastCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:wa(this.model)-1}}})}speakColumnHeader(){let e=this.controller.s("graphing-calculator-narration-table-no-column-header"),t=this.getSelectedCell();if(t){let i=this.model.columnModels[t.column].latex;i&&(e=$l.StaticMath(document.createElement("span")).latex(i).mathspeak())}xe(e)}focusHelperOptions(){return{controller:this.controller,location:{type:"table-container",id:this.model.id}}}shouldBeFocused(){return Qh(this.focusHelperOptions())}onFocusedChanged(e){if(this.controller.isInEditListMode())return ZM(this.focusHelperOptions(),e)}};var li=__dcg_shared_module_exports__['h'](X());var Ax=class extends Sa{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return li.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionfolder":!0,"dcg-inFolder":!1,"dcg-selected":this.renderAsSelected(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-collapsed":!!this.model.collapsed,"dcg-hidden":!!this.model.hidden,"dcg-has-items":this.controller.getNumberOfItemsInFolder(this.id)>0,"dcg-secretFolder":this.model.secret&&!this.controller.shouldShowAuthorFeatures()}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},li.createElement("div",{class:li.const("dcg-fade-container")},li.createElement("div",{class:li.const("dcg-main")},li.createElement("div",{role:li.const("button"),tabindex:li.const("0"),"aria-pressed":()=>this.model.collapsed,"aria-label":()=>this.model.collapsed?$i(this.model,"expand"):$i(this.model,"collapse"),class:li.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:li.const("true"),onTap:this.bindFn(this.toggleCollapsed)},li.createElement("i",{class:li.const("dcg-icon-caret-down"),"aria-hidden":li.const("true")})),li.createElement(Ou,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.title,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),placeholder:()=>this.controller.s("graphing-calculator-text-folder-placeholder")}),li.createElement(Gt,{checked:()=>this.model.secret,class:this.const("dcg-action-toggle-secret-folder dcg-do-not-blur"),style:()=>({display:this.controller.shouldShowAuthorFeatures()?void 0:"none"}),onChange:this.bindFn(this.toggleSecret)},li.createElement("span",{class:li.const("dcg-checkbox-label")},()=>this.controller.s("graphing-calculator-button-hide-folder-from-students-2")))),li.createElement(Ql,{controller:this.props.controller,model:this.props.model})),li.createElement("span",{class:li.const("dcg-tab dcg-action-drag"),handleevent:li.const("true"),tapboundary:li.const("true"),disablescroll:li.const("true"),onTapStart:this.bindFn(this.onDragPending)},li.createElement("span",{class:li.const("dcg-num")},()=>this.model.displayIndex),li.createElement("div",{class:li.const("dcg-tab-interior")},li.createElement("span",{role:li.const("button"),tabindex:li.const("0"),"aria-pressed":()=>!!this.model.hidden,"aria-label":()=>this.model.hidden?$i(this.model,"show"):$i(this.model,"hide"),class:li.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden)},li.createElement(Io,{iconType:()=>this.model.hidden?"hidden":"folder",whiteIcon:()=>this.renderAsSelected()||this.controller.isItemBeingDragged(this.model.id)})))),li.createElement(Xl,{controller:this.props.controller,id:()=>this.model.id}))}renderAsSelected(){return this.controller.isItemSelected(this.model.id)||this.model.collapsedChildIsSelected}toggleHidden(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})}toggleSecret(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})}toggleCollapsed(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})}onInput(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="folder"||e.id!==this.id)}getAriaLabel(){let e="",t="";switch((this.model.hidden?1:0)+(this.model.collapsed?16:0)+(this.model.secret?256:0)+(this.model.readonly?4096:0)){case 0:t=this.controller.s("graphing-calculator-narration-description-folder");break;case 1:t=this.controller.s("graphing-calculator-narration-description-hidden-folder");break;case 16:t=this.controller.s("graphing-calculator-narration-description-collapsed-folder");break;case 256:t=this.controller.s("graphing-calculator-narration-description-secret-folder");break;case 4096:t=this.controller.s("graphing-calculator-narration-description-readonly-folder");break;case 1+16:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder");break;case 1+256:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-folder");break;case 1+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-readonly-folder");break;case 256+16:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder");break;case 256+4096:t=this.controller.s("graphing-calculator-narration-description-secret-readonly-folder");break;case 16+4096:t=this.controller.s("graphing-calculator-narration-description-collapsed-readonly-folder");break;case 1+256+16:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder");break;case 1+16+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-readonly-folder");break;case 1+256+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-readonly-folder");break;case 16+256+4096:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-readonly-folder");break;case 1+16+256+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder");break}let c=this.controller.getNumberOfItemsInFolder(this.id);return c>0?e=this.controller.s("graphing-calculator-narration-folder-has-items",{folder:t,count:c}):e=t,e}};ct();var at=__dcg_shared_module_exports__['h'](X());function nk(r){let e=document.createElement("a");return e.href=r,e.href}var la=__dcg_shared_module_exports__['h'](X());var{SwitchUnion:yX}=la.Components,Lx=class extends la.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return la.createElement("div",{class:la.const("dcg-expression-icon-container dcg-image-icon-container")},yX(this.bindFn(this.typeOfIcon),{error:()=>la.createElement(ms,{error:()=>this.controller.unpack(this.model.error),isWhite:this.bindFn(this.isSelected),gravity:this.const("se")}),failed:()=>la.createElement("span",null),loading:()=>la.createElement(Io,{iconType:this.const("loading")}),hidden:()=>this.buildIconView(),image:()=>this.buildIconView()}))}buildIconView(){return la.createElement("div",{class:la.const("dcg-circular-icon-container"),role:la.const("button"),tabindex:la.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions(e);this.toggleImageShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions(e)},manageFocus:this.const(Vt({controller:this.controller,location:{type:"image-icon",id:this.model.id}}))},la.createElement(Io,{iconType:()=>this.typeOfIcon()==="hidden"?"hidden":"background",backgroundImage:this.bindFn(this.getBackgroundImage),backgroundOpacity:this.const(1),whiteIcon:this.bindFn(this.isSelected)}))}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}typeOfIcon(){return this.model.loadStatus==="loading"?"loading":this.model.loadStatus==="failed"?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}hasError(){return!!this.model.error&&this.controller.getBrailleMode()==="none"}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+nk(this.model.image_url)+'")',this.lastEncodedURL)}toggleImageShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}),this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:this.model.id}})}getIconAriaLabel(){return this.myOptionsOpen()?$i(this.model,"hide-options"):this.controller.isInEditListMode()?$i(this.model,"show-options"):this.model.hidden?$i(this.model,"show"):$i(this.model,"hide")}};var Zl=__dcg_shared_module_exports__['h'](X());ct();var Pu=class extends Zl.Class{init(){this.controller=this.props.controller()}template(){return Zl.createElement("div",{class:Zl.const("dcg-do-not-blur"),onTap:this.bindFn(this.newImage),handleEvent:Zl.const("true"),role:Zl.const("button"),tabindex:()=>this.props.readonly()?-1:0,"aria-label":this.props.ariaLabel,"aria-disabled":()=>this.props.readonly(),manageFocus:this.const(this.props.location?Vt({controller:this.controller,location:this.props.location()}):void 0)},this.children,Zl.createElement("input",{type:Zl.const("file"),accept:Zl.const("image/*"),style:Zl.const("display: none"),didMount:this.bindFn(this.didMountFileInput)}))}didMountFileInput(e){this.fileInputNode=e,O(e).on("change",()=>{this.props.onFileChange(e.files),e.value=""})}newImage(){this.props.readonly()||this.fileInputNode.click()}};var{If:Ox,SwitchUnion:bX}=at.Components,wg=class extends at.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return at.createElement(fr,{containerClass:()=>({"dcg-image-input-mathquill":!0,"dcg-suffix-degree":this.props.name()==="angle"&&this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":this.props.name()==="angle"&&!this.props.controller().getGraphSettings().degreeMode}),fontSize:this.const("large"),fullWidth:this.const(!0),readonly:this.props.readonly,latex:()=>this.model[this.props.name()],isFocused:()=>this.props.focusedInput()===this.props.name(),ariaLabel:()=>this.controller.raw(this.props.name()),handleFocusChanged:this.bindFn(this.handleMQFocusedChanged),hasError:()=>JF(this.model,this.props.name()),controller:this.props.controller,handlePressedKey:this.bindFn(this.handlePressedKey),handleLatexChanged:this.bindFn(this.handleLatexChanged),noBorder:()=>!this.props.focusedInput()})}getInputs(){return["center","width","angle","height","opacity"]}handlePressedKey(e,t){let i=this.props.name();var n=it.getFocusedMathquill();let o=this.getInputs(),s=o.indexOf(i);if(!this.controller.isInEditListMode()){if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});if(e==="Esc"){pi();return}}let a=-1;e==="Up"&&(a=s===1?4:s-2),e==="Down"&&(a=s===4?1:s+2),e==="Left"&&(a=s-1),e==="Right"&&(a=s+1);let l=e;if(a>=0&&a<o.length){let c=!1;if(n)c=it.applyArrowKeyAndReturnIfWasAtBounds(n,l,t);else if(e==="Up"||e==="Down")c=!0;else{let u=Da();c=u&&(e==="Left"&&u.selectionStart===0||e==="Right"&&u.selectionStart===O(u).val().length)}c&&(this.focusInput(o[a]),t&&t.preventDefault());return}n&&(n.keystroke(e,t),this.handleLatexChanged(n.latex()))}focusInput(e){this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:e}})}handleLatexChanged(e){let t=this.props.name();this.model.draggingOnGraphpaper||KF(this.model,t)!==e&&this.controller.dispatch({type:"set-image-mq-attribute",id:this.model.id,attribute:t,latex:e})}handleMQFocusedChanged(e){let t=this.props.name();e?this.props.focusedInput()!==t&&this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.model.id,location:t}})}},Px=class extends Sa{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return at.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionimage":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-input-focused":this.getFocusedInput()&&this.getFocusedInput()!=="name"}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},at.createElement("div",{class:at.const("dcg-fade-container")},at.createElement("div",{class:at.const("dcg-main")},bX(()=>this.model.loadStatus,{failed:()=>at.createElement("div",null,at.createElement("div",{class:at.const("dcg-image-failed")},()=>this.controller.s("graphing-calculator-error-failed-to-load-image")),at.createElement("div",{role:at.const("button"),tabindex:at.const(0),class:at.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loading:()=>at.createElement("div",null,at.createElement("div",{class:at.const("dcg-image-loading")},()=>this.controller.s("graphing-calculator-text-loading-image")),at.createElement("div",{role:at.const("button"),tabindex:at.const(0),class:at.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loaded:()=>at.createElement("div",{class:at.const("dcg-image-loaded")},at.createElement("div",{class:at.const("dcg-image-title-row")},at.createElement(Ou,{shouldFocus:()=>this.getFocusedInput()==="name",text:()=>this.model.name,ariaLabel:()=>$i(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-image-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onNameInput),onFocusChange:this.bindFn(this.onNameFocusChange),onSpecialKey:this.bindFn(this.onNameSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.isReadonly()}),at.createElement(Ox,{predicate:()=>this.controller.areImagesEnabled()},()=>at.createElement(Pu,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-button-change-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"change-image-btn",id:this.id}),readonly:this.bindFn(this.isReadonly)},at.createElement(Ox,{predicate:()=>!this.isReadonly()},()=>at.createElement("div",{class:at.const("dcg-action-changeimage")},()=>this.controller.s("graphing-calculator-button-change-image")))))),at.createElement("div",{class:()=>({"dcg-do-blur":!0,"dcg-image-input-grid":!0}),handleEvent:at.const("true")},at.createElement("div",{class:at.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-center")),at.createElement(wg,{name:this.const("center"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),at.createElement("div",{class:at.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-width")),at.createElement(wg,{name:this.const("width"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),at.createElement("div",{class:at.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-angle")),at.createElement(wg,{name:this.const("angle"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),at.createElement("div",{class:at.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-height")),at.createElement(wg,{name:this.const("height"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),at.createElement("div",{class:at.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-opacity")),at.createElement(wg,{name:this.const("opacity"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)})))})),at.createElement("span",{class:at.const("dcg-fadeout")}),at.createElement(Ql,{controller:this.props.controller,model:this.props.model}),at.createElement(Ox,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>at.createElement("div",{class:this.getFooterClass()},at.createElement("div",{tabindex:at.const(0),class:at.const("dcg-expression-braille-error"),"aria-roledescription":at.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},at.createElement("i",{class:at.const("dcg-icon-error"),"aria-hidden":at.const("true")}),()=>this.controller.unpack(this.model.error)))),at.createElement(Ox,{predicate:()=>_D(this.model).length>0&&this.controller.areSlidersEnabled()},()=>at.createElement("div",{class:this.getFooterClass()},at.createElement(qc,{model:this.props.model,controller:this.props.controller}))),at.createElement(Ox,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>at.createElement("div",{class:this.getFooterClass()},at.createElement(bg,{model:this.props.model,controller:this.props.controller})))),at.createElement("span",{class:at.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:at.const("true"),tapboundary:at.const("true"),disablescroll:at.const("true"),onTapStart:this.bindFn(this.onDragPending)},at.createElement("span",{class:at.const("dcg-num")},()=>this.model.displayIndex),at.createElement("div",{class:at.const("dcg-tab-interior dcg-action-icon-mouse")},at.createElement(Lx,{model:this.props.model,controller:this.props.controller}))),at.createElement(Xl,{controller:this.props.controller,id:()=>this.model.id}))}isReadonly(){return this.controller.isItemReadonly(this.id)}shouldShowActionInfo(){return!!(this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder")}onNameInput(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})}onNameFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):this.getFocusedInput()==="name"&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})}onNameSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(e&&e.type==="image"&&e.id===this.model.id)return e.location}onRetryLoad(){this.controller.dispatch({type:"image-retry-loading",id:this.id})}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&!!this.model.error}insertFiles(e){this.controller.dispatch({type:"change-image",files:e,id:this.id})}onMouseSelect(e){e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}};var _x=__dcg_shared_module_exports__['h'](X());var Fx=class extends Sa{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){let e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),_x.createElement("div",{class:_x.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:_x.const(e)})}};var Wf=__dcg_shared_module_exports__['h'](X()),Rx=class extends Wf.Class{init(){this.controller=this.props.controller()}template(){return Wf.createElement("div",{class:Wf.const("dcg-drag-container"),style:()=>({top:this.getTopPx(),left:this.getLeftPx()})},this.children)}getTopPx(){let e=this.controller.getRawDragState();if(e)return e.itemTop+"px"}getLeftPx(){let e=this.controller.getRawDragState();if(e)return e.itemLeft+"px"}};var Bd={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},ws={};ws.parse=wX;ws.RECORD_SEP=String.fromCharCode(30);ws.UNIT_SEP=String.fromCharCode(31);ws.BYTE_ORDER_MARK="\uFEFF";ws.BAD_DELIMITERS=["\r",`
`,'"',ws.BYTE_ORDER_MARK];ws.LocalChunkSize=1024*1024*10;ws.RemoteChunkSize=1024*1024*5;ws.DefaultDelimiter=",";ws.Parser=ok;ws.ParserHandle=s5;function wX(r,e){var t=xX(e),i=new s5(t),n=i.parse(r);return n}function s5(r){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,t=this,i,n,o=!1,s,a=[],l={data:[],errors:[],meta:{}};r=LL(r),this.parse=function(D){if(s=!1,!r.delimiter){var S=h(D);S.successful?r.delimiter=S.bestDelimiter:(s=!0,r.delimiter=ws.DefaultDelimiter),l.meta.delimiter=r.delimiter}if(jf(r.step)){var V=r.step;r.step=function(k){l=k,u()?c():V(c(),t)}}return r.preview&&r.header&&r.preview++,i=D,n=new ok(r),l=n.parse(i),c(),jf(r.complete)&&!o&&r.complete(l),o?{meta:{paused:!0}}:l},this.pause=function(){o=!0,n.abort(),i=i.substr(n.getCharIndex())},this.resume=function(){o=!1,n=new ok(r),n.parse(i),jf(r.complete)&&!o&&r.complete(l)},this.abort=function(){n.abort(),jf(r.complete)&&r.complete(l),i=""};function c(){return l&&s&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+ws.DefaultDelimiter+"'"),s=!1),u()&&p(),g()}function u(){return r.header&&a.length==0}function p(){if(l){for(var D=0;u()&&D<l.data.length;D++)for(var S=0;S<l.data[D].length;S++)a.push(l.data[D][S]);l.data.splice(0,1)}}function g(){if(!l||!r.header&&!r.dynamicTyping)return l;for(var D=0;D<l.data.length;D++){for(var S={},V=0;V<l.data[D].length;V++){if(r.dynamicTyping){var k=l.data[D][V];k=="true"?l.data[D][V]=!0:k=="false"?l.data[D][V]=!1:l.data[D][V]=b(k)}r.header&&(V>=a.length?(S.__parsed_extra||(S.__parsed_extra=[]),S.__parsed_extra.push(l.data[D][V])):S[a[V]]=l.data[D][V])}r.header&&(l.data[D]=S,V>a.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+a.length+" fields but parsed "+V,D):V<a.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+a.length+" fields but parsed "+V,D))}return r.header&&l.meta&&(l.meta.fields=a),l}function h(D){for(var S=[",","	","|",";",ws.RECORD_SEP,ws.UNIT_SEP],V,k,T,A=0;A<S.length;A++){var R=S[A],P=0,W=0;T=void 0;for(var H=new ok({delimiter:R,preview:10}).parse(D),j=0;j<H.data.length;j++){var ne=H.data[j].length;if(W+=ne,typeof T=="undefined"){T=ne;continue}else ne>1&&(P+=Math.abs(ne-T),T=ne)}W/=H.data.length,(typeof k=="undefined"||P<k)&&W>1.99&&(k=P,V=R)}return r.delimiter=V,{successful:!!V,bestDelimiter:V}}function b(D){var S=e.test(D);return S?parseFloat(D):D}function C(D,S,V,k){l.errors.push({type:D,code:S,message:V,row:k})}}function ok(r){var e=/^\s*$/,t,i,n,o,s,a,l,c,u,p,g,h,b,C,D,S=!1;r=r||{},i=r.delimiter,n=r.comments,o=r.step,a=r.preview,(typeof i!="string"||i.length!=1||ws.BAD_DELIMITERS.indexOf(i)>-1)&&(i=","),n===!0?n="#":(typeof n!="string"||n.length!=1||ws.BAD_DELIMITERS.indexOf(n)>-1||n==i)&&(n=!1),this.parse=function(de){if(typeof de!="string")throw"Input must be a string";return ye(de),V()},this.abort=function(){S=!0},this.getCharIndex=function(){return c};function V(){for(;c<t.length&&!(S||a>0&&D>=a);)l=='"'?A():u?R():P(),k();return T()}function k(){c++,l=t[c]}function T(){if(S&&he("Abort","ParseAbort","Parsing was aborted by the user's step function"),u&&he("Quotes","MissingQuotes","Unescaped or mismatched quotes"),w(),!jf(o))return Se()}function A(){se()&&!ae()?u=!u:(j(),u&&ae()?c++:he("Quotes","UnexpectedQuotes","Unexpected quotes"))}function R(){(q(c)||M(c))&&p++,j()}function P(){l==i?ne():q(c)?(le(),k()):M(c)?le():W()?H():j()}function W(){if(!n)return!1;var de=c==0||M(c-1)||q(c-2);return de&&t[c]===n}function H(){for(;!q(c)&&!M(c)&&c<t.length;)k()}function j(){g[b][C]+=l}function ne(){g[b].push(""),C=g[b].length-1}function le(){w(),p++,D++,g.push([]),b=g.length-1,ne()}function w(){B(),jf(o)&&(g[b]&&o(Se()),fe())}function B(){g[b].length==1&&e.test(g[b][0])&&(r.keepEmptyRows?g[b].splice(0,1):g.splice(b,1),b=g.length-1)}function q(de){return de<t.length-1&&(t[de]=="\r"&&t[de+1]==`
`||t[de]==`
`&&t[de+1]=="\r")}function M(de){return t[de]=="\r"||t[de]==`
`}function ae(){return!se()&&c<t.length-1&&t[c+1]=='"'}function se(){return!u&&ge(c-1)||ge(c+1)}function ge(de){typeof de!="number"&&(de=c);var Ee=t[de];return de<=-1||de>=t.length||Ee==i||Ee=="\r"||Ee==`
`}function he(de,Ee,U){h.push({type:de,code:Ee,message:U,line:p,row:b,index:c})}function ye(de){t=de,u=!1,c=0,D=0,p=1,fe(),g=[[""]],l=t[c]}function fe(){g=[],h=[],b=0,C=0}function Se(){return{data:g,errors:h,meta:{lines:p,delimiter:i,aborted:S,truncated:a>0&&c<t.length}}}}function xX(r){typeof r!="object"&&(r={});var e=LL(r);return(typeof e.delimiter!="string"||e.delimiter.length!=1||ws.BAD_DELIMITERS.indexOf(e.delimiter)>-1)&&(e.delimiter=Bd.delimiter),typeof e.header!="boolean"&&(e.header=Bd.header),typeof e.dynamicTyping!="boolean"&&(e.dynamicTyping=Bd.dynamicTyping),typeof e.preview!="number"&&(e.preview=Bd.preview),typeof e.step!="function"&&(e.step=Bd.step),typeof e.complete!="function"&&(e.complete=Bd.complete),typeof e.error!="function"&&(e.error=Bd.error),typeof e.encoding!="string"&&(e.encoding=Bd.encoding),typeof e.download!="boolean"&&(e.download=Bd.download),typeof e.keepEmptyRows!="boolean"&&(e.keepEmptyRows=Bd.keepEmptyRows),e}function LL(r){if(typeof r!="object")return r;var e=r instanceof Array?[]:{};for(var t in r)e[t]=LL(r[t]);return e}function jf(r){return typeof r=="function"}var{parse:a5}=ws;zl();function OL(r){var e;if(typeof r=="number")e=r+"";else if(typeof r=="string")e=r;else return!1;return e.trim().match(/^-?[0-9]*\.?[0-9]*$/)}function l5(r){let e=r.split(/\r?\n/),t=[],i=!1;if(!(e.length<2)){for(let n=0;n<e.length;n++){let o=e[n];if(!o.trim())continue;n>0&&!OL(o.replace(/,(\d{3})/g,"$1"))&&(i=!0);let s={content:o};t.push(s)}if(!i){let n=__dcg_shared_module_exports__['r'](t,"content").map(o=>o.replace(/,(\d{3})/g,"$1"));return OL(n[0])||(n=n.slice(1)),[{content:"\\left["+n.join(",")+"\\right]",numberList:!0}]}return t}}function c5(r){if(/^\s*$/.test(r))return;let e=a5(r,{preview:1e4}),t=e.data,i=[];if(e.errors.length&&!e.data.length){Yo("PapaParse.parse returned errors.",{metaData:{input:r,output:e.errors}});return}if(!(!e.data.length||e.data.length<2)){var n=t[0].length;for(let o=0;o<n;o++)i.push([]);for(let o=0;o<e.data.length;o++)if(!(o===0&&isNaN(parseFloat(t[o][0])))){if(t[o].length<2)return;if(!(!t[o][0]&&!t[o][1]))for(let s=0;s<n;s++){let a=(t[o][s]||"").replace(/,(\d{3})/g,"$1");if(a&&isNaN(parseFloat(a)))return;i[s].push(a)}}if(!(i[0].length<2))return i}}var ca=__dcg_shared_module_exports__['h'](X()),Nx=class extends ca.Class{template(){return this.controller=this.props.controller(),ca.createElement("div",{class:ca.const("dcg-expressionitem dcg-new-expression dcg-opened")},ca.createElement("div",{class:ca.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)},ca.createElement("div",{class:ca.const("dcg-new-expression-fade")})),ca.createElement("span",{class:ca.const("dcg-tab")},ca.createElement("span",{class:ca.const("dcg-num dcg-variable-index")},this.bindFn(this.getIndex)),ca.createElement("div",{class:ca.const("dcg-tab-interior")})))}getIndex(){return this.controller.getNextDisplayIndex()}newMath(){this.controller.dispatch({type:"new-expression-at-end"})}};var ht=__dcg_shared_module_exports__['h'](X());ct();var{If:Bx}=ht.Components,Kx=class extends ht.Class{init(){this.controller=this.props.controller()}template(){return ht.createElement("div",{class:ht.const("dcg-add-expression-container")},ht.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),gravity:()=>this.controller.isNarrow()?"ne":"se"},ht.createElement("span",{class:()=>({"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":this.controller.isAddExpressionOpen()}),handleEvent:ht.const("true"),role:ht.const("button"),tabindex:ht.const("0"),"aria-haspopup":ht.const("true"),"aria-expanded":()=>this.controller.isAddExpressionOpen(),"aria-label":()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),didMount:e=>{this.toggleButtonNode=e},onTap:this.bindFn(this.toggleAddExpression),manageFocus:this.const(Vt({controller:this.controller,location:{type:"add-item-btn"}}))},ht.createElement("i",{class:ht.const("dcg-icon-plus"),"aria-hidden":ht.const("true")}))),ht.createElement(Bx,{predicate:()=>this.controller.isAddExpressionOpen()},()=>ht.createElement("div",{class:()=>({"dcg-add-expression-dropdown":!0,"dcg-popover":!0,"dcg-bottom":!this.controller.isNarrow(),"dcg-right":this.controller.isNarrow()}),role:ht.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-item-menu"),didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},ht.createElement("div",{class:ht.const("dcg-popover-interior")},ht.createElement("div",{class:ht.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"),role:ht.const("button"),tabindex:ht.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-expression"),onTap:this.bindFn(this.newExpression),handleEvent:ht.const("true"),manageFocus:this.const(Vt({controller:this.controller,location:{type:"add-expression-btn"}}))},ht.createElement("i",{class:ht.const("dcg-icon-new-expression dcg-expression-icon"),"aria-hidden":ht.const("true")}),()=>this.controller.s("graphing-calculator-label-expression-lowercase")),ht.createElement(Bx,{predicate:()=>this.controller.areNotesEnabled()},()=>ht.createElement("div",{class:ht.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"),role:ht.const("button"),tabindex:ht.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-note"),onTap:this.bindFn(this.newText),handleEvent:ht.const("true"),manageFocus:this.const(Vt({controller:this.controller,location:{type:"add-note-btn"}}))},ht.createElement("i",{class:ht.const("dcg-icon-new-text dcg-expression-icon"),"aria-hidden":ht.const("true")}),()=>this.controller.s("graphing-calculator-label-note-lowercase"))),ht.createElement("div",{class:ht.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"),role:ht.const("button"),tabindex:ht.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-table"),onTap:this.bindFn(this.newTable),handleEvent:ht.const("true"),manageFocus:this.const(Vt({controller:this.controller,location:{type:"add-table-btn"}}))},ht.createElement("i",{class:ht.const("dcg-icon-new-table dcg-expression-icon"),"aria-hidden":ht.const("true")}),()=>this.controller.s("graphing-calculator-label-table-lowercase")),ht.createElement(Bx,{predicate:()=>this.controller.areFoldersEnabled()},()=>ht.createElement("div",{class:ht.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"),role:ht.const("button"),tabindex:ht.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-folder"),onTap:this.bindFn(this.newFolder),handleEvent:ht.const("true"),manageFocus:this.const(Vt({controller:this.controller,location:{type:"add-folder-btn"}}))},ht.createElement("i",{class:ht.const("dcg-icon-new-folder dcg-expression-icon"),"aria-hidden":ht.const("true")}),()=>this.controller.s("graphing-calculator-label-folder-lowercase"))),ht.createElement(Bx,{predicate:()=>this.controller.areImagesEnabled()},()=>ht.createElement(Pu,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-add-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"add-image-btn"}),readonly:this.const(!1)},ht.createElement("div",{class:ht.const("dcg-new-item dcg-action-newimage")},ht.createElement("i",{class:ht.const("dcg-icon-new-image dcg-expression-icon"),"aria-hidden":ht.const("true")}),()=>this.controller.s("graphing-calculator-label-image-lowercase")))),ht.createElement(Bx,{predicate:this.bindFn(this.showAddTicker)},()=>ht.createElement("div",{class:ht.const("dcg-new-item dcg-do-not-blur dcg-action-ticker"),role:ht.const("button"),tabindex:ht.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-ticker"),onTap:this.bindFn(this.addTicker),handleEvent:ht.const("true"),manageFocus:this.const(Vt({controller:this.controller,location:{type:"add-ticker-btn"}}))},ht.createElement("i",{class:ht.const("dcg-icon-metronome dcg-expression-icon"),"aria-hidden":ht.const("true")}),()=>this.controller.s("graphing-calculator-label-ticker-lowercase")))),ht.createElement("span",{class:ht.const("dcg-arrow")}))))}showAddTicker(){return this.controller.areActionsEnabled()&&!this.controller.getTickerOpen()}didMountPopover(e){this.popoverNode=e,O(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:t.device==="keyboard"})}),O(document).on("keydown.add-expression-view",t=>{if(Re(t)==="Esc"&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:!0}),Re(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=this.controller.getFocusLocation();if(!i)return;let n;this.showAddTicker()?n={type:"add-ticker-btn"}:this.controller.areImagesEnabled()?n={type:"add-image-btn"}:this.controller.areFoldersEnabled()?n={type:"add-folder-btn"}:n={type:"add-table-btn"},!t.shiftKey&&i.type===n.type?(this.controller.dispatch({type:"set-focus-location",location:{type:"add-item-btn"}}),t.preventDefault(),t.stopPropagation()):t.shiftKey&&i.type==="add-item-btn"&&(this.controller.dispatch({type:"set-focus-location",location:n}),t.preventDefault(),t.stopPropagation())}}),dl&&du&&O(e).on("dcg-tapstart",t=>t.preventDefault()),O(e).find(".dcg-new-item").on("touchstart",t=>t.preventDefault())}didUnmountPopover(){O(document).off(".add-expression-view")}toggleAddExpression(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"})}newExpression(){this.controller.dispatch({type:"new-expression"})}newText(){this.controller.dispatch({type:"new-text"})}newFolder(){this.controller.dispatch({type:"new-folder"})}addTicker(){this.controller.dispatch({type:"open-ticker"})}newTable(){this.controller.dispatch({type:"new-table"})}insertFiles(e){this.controller.dispatch({type:"new-images",files:e})}eventShouldClosePopover(e){let t=!!O(e.target).closest(this.popoverNode).length,i=!!O(e.target).closest(this.toggleButtonNode).length;return!(t||i)}};var mt=__dcg_shared_module_exports__['h'](X());var ec=__dcg_shared_module_exports__['h'](X());var sk=class extends ec.Class{init(){this.controller=this.props.controller()}template(){return ec.createElement("span",{role:ec.const("button"),class:()=>({"dcg-constructions-count-link":!0,"dcg-icon-btn":!0,"dcg-active":this.controller.getShowConstructionsOpen(),"dcg-do-not-blur":!0}),handleEvent:ec.const("true"),tabindex:ec.const("0"),"aria-expanded":()=>this.controller.getShowConstructionsOpen(),manageFocus:this.const(Vt({controller:this.controller,location:{type:"geo-show-constructions-icon"}})),onTap:this.bindFn(this.showAllConstructions)},ec.createElement("i",{class:ec.const("dcg-icon-geometry"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construction-icon-label")}),ec.createElement("span",{class:ec.const("dcg-construction-count")},()=>this.controller.getGeometryTokenCount()))}showAllConstructions(){this.controller.dispatch({type:"set-show-constructions-open",open:!this.controller.getShowConstructionsOpen(),setFocus:!1})}};var js=__dcg_shared_module_exports__['h'](X());var Jf=class extends js.Class{init(){this.controller=this.props.controller()}template(){return js.createElement("div",null,js.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-undo-tooltip"),gravity:this.bindFn(this.getUndoTooltipGravity),disabled:()=>!this.controller.canUndo()},js.createElement("span",{class:()=>({"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-disabled":!this.controller.canUndo()}),role:js.const("button"),tabindex:()=>this.controller.canUndo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-undo"),onTap:()=>this.controller.dispatch({type:"undo"}),"aria-disabled":()=>!this.controller.canUndo()},js.createElement("i",{class:js.const("dcg-icon-undo"),"aria-hidden":js.const("true")}))),js.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-redo-tooltip"),gravity:this.bindFn(this.getRedoTooltipGravity),disabled:()=>!this.controller.canRedo()},js.createElement("span",{class:()=>({"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-disabled":!this.controller.canRedo()}),role:js.const("button"),tabindex:()=>this.controller.canRedo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-redo"),onTap:()=>this.controller.dispatch({type:"redo"}),"aria-disabled":()=>!this.controller.canRedo()},js.createElement("i",{class:js.const("dcg-icon-redo"),"aria-hidden":js.const("true")}))))}getUndoTooltipGravity(){return this.props.undoTooltipGravity?this.props.undoTooltipGravity():this.controller.isNarrow()?"n":"s"}getRedoTooltipGravity(){return this.props.redoTooltipGravity?this.props.redoTooltipGravity():this.controller.isNarrow()?"n":"s"}};var{If:_u}=mt.Components,Ux=class extends mt.Class{init(){this.controller=this.props.controller()}template(){return mt.createElement("div",{class:()=>({"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":this.showShadow()}),role:mt.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-bar"),didMount:e=>{this.node=e},onTapStart:this.bindFn(this.clearSelectionOnMobile),style:()=>({background:this.controller.hasBackgroundColor()?this.controller.getPillboxBackgroundColor():void 0})},mt.createElement("div",{class:mt.const("dcg-left-buttons")},mt.createElement(_u,{predicate:this.bindFn(this.showHamburger)},()=>mt.createElement("span",{class:mt.const("dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:mt.const("true"),tooltip:()=>this.controller.s("graphing-calculator-label-open-graph-tooltip"),role:mt.const("button"),tabindex:mt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-open-graph"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},mt.createElement("i",{class:mt.const("dcg-icon-hamburger"),"aria-hidden":mt.const("true")}))),mt.createElement(_u,{predicate:()=>!this.controller.isInEditListMode()},()=>mt.createElement(Kx,{controller:()=>this.props.controller()})),mt.createElement(_u,{predicate:()=>this.controller.isGeoUIActive()&&!this.controller.isInEditListMode()},()=>mt.createElement(sk,{controller:this.props.controller})),mt.createElement(_u,{predicate:this.bindFn(this.showRerandomize)},()=>mt.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),gravity:()=>this.controller.isNarrow()?"n":"s"},mt.createElement("span",{class:mt.const("dcg-icon-btn"),handleEvent:mt.const("true"),role:mt.const("button"),tabindex:mt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),onTap:()=>this.controller.dispatch({type:"re-randomize"})},mt.createElement("i",{class:mt.const("dcg-icon-randomize"),"aria-hidden":mt.const("true")})))),mt.createElement(_u,{predicate:()=>this.controller.isInEditListMode()&&!this.controller.hasDefaultState()},()=>mt.createElement("span",{class:mt.const("dcg-btn-red dcg-action-clearall"),role:mt.const("button"),tabindex:mt.const("0"),onTap:()=>this.controller.dispatch({type:"clear-graph"})},()=>this.controller.s("graphing-calculator-button-clear-graph"))),mt.createElement(_u,{predicate:()=>this.controller.isInEditListMode()&&this.controller.hasDefaultState()},()=>mt.createElement("span",{class:mt.const("dcg-btn-red dcg-action-reset"),role:mt.const("button"),tabindex:mt.const("0"),onTap:()=>this.controller.dispatch({type:"reset-graph"})},()=>this.controller.s("graphing-calculator-button-reset-graph")))),mt.createElement("div",{class:mt.const("dcg-center-buttons")},mt.createElement(Jf,__dcg_shared_module_exports__['a']({},this.props))),mt.createElement("div",{class:mt.const("dcg-right-buttons")},mt.createElement(_u,{predicate:()=>!this.controller.isInEditListMode()},()=>mt.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-edit-list-tooltip"),gravity:()=>this.controller.isNarrow()?"n":"s"},mt.createElement("span",{class:mt.const("dcg-icon-btn dcg-action-toggle-edit"),handleEvent:mt.const("true"),role:mt.const("button"),tabindex:mt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-expression-list"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(Vt({controller:this.controller,location:{type:"edit-list-toggle"}}))},mt.createElement("i",{class:mt.const("dcg-icon-settings"),"aria-hidden":mt.const("true")})))),mt.createElement(_u,{predicate:()=>this.controller.isInEditListMode()},()=>mt.createElement("span",{class:mt.const("dcg-btn-primary dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:mt.const("true"),role:mt.const("button"),tabindex:mt.const("0"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(Vt({controller:this.controller,location:{type:"edit-list-toggle"}}))},()=>this.controller.s("graphing-calculator-button-done"))),mt.createElement(_u,{predicate:()=>!this.controller.isInEditListMode()&&this.controller.getGraphSettings().config.graphpaper},()=>mt.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),gravity:()=>this.controller.isNarrow()?"nw":"sw"},mt.const(" "),mt.createElement("span",{class:()=>({"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":this.controller.isNarrow()}),role:mt.const("button"),tabindex:mt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),onTap:e=>{this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:e.device==="keyboard"})},manageFocus:this.const(Vt({controller:this.controller,location:{type:"hide-expression-list-btn"}}))},mt.createElement("i",{class:mt.const("dcg-icon-hide"),"aria-hidden":mt.const("true")}))))))}showShadow(){return this.controller.getTickerOpen()||this.controller.getExpressionSearchOpen()?!1:this.props.expsScrolled()}showRerandomize(){return this.controller.anyItemDependsOnRandomSeed()}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isInEditListMode()?!1:!this.controller.isNarrow()}clearSelectionOnMobile(e){e.wasHandled()||this.controller.dispatch({type:"set-none-selected"})}toggleEditListMode(e){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!this.controller.isInEditListMode(),focusExpressionList:!1}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"edit-list-toggle"}})}};function CX(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:"0"})}var d5=CX;var DX={centerX:0,centerY:0,size:15},SX={scale:1,unit:"",visible:!1,showLegend:!1};function EX(r){let e=r.objects||{},t=__dcg_shared_module_exports__['j'](e);for(let i in t){let n=t[i];n.label&&(n.showLabel=!0)}return{version:"1",objects:t,viewport:r.viewport||DX,customTools:r.customTools||{},grid:r.grid||SX}}var u5=EX;function kX(r){return(r.type==="point"||r.type==="glider")&&!r.draggable}function GX(r){let e=r.objects||{},t=__dcg_shared_module_exports__['j'](e),i=__dcg_shared_module_exports__['j'](r.grid);for(let n in t){let o=t[n];kX(o)&&(o.draggable=!0),o.type==="angle"&&o.showLabel&&!o.label&&(o.label="{angle}"),o.type==="segment"&&o.showLabel&&!o.label&&(o.label="{length}")}return i.unit="",i.scale=1,{version:"2",objects:t,viewport:r.viewport,customTools:r.customTools||{},grid:i}}var p5=GX;function PL(r){return r&&(r.type==="circle"||r.type==="compass")}function IX(r){let e=__dcg_shared_module_exports__['j'](r.objects||{});for(let t in e){let i=e[t];if(i.type==="point")i.y=-i.y;else if(i.type==="glider"){let n=e[i.parents.host];PL(n)&&(i.t=-i.t)}else if(i.type==="intersection"){let n=e[i.parents.host1],o=e[i.parents.host2];PL(n)&&PL(o)&&(i.negRoot=!i.negRoot)}}return{version:"3",objects:e,viewport:r.viewport,customTools:r.customTools||{},graphSettings:{showGrid:!!(r.grid||{}).visible,showAxes:!1,showAxisNumbers:!1}}}var h5=IX;function VX(r){let e=__dcg_shared_module_exports__['j'](r.objects||{});for(let t in e){let i=e[t];i.draggable===!1&&(i.locked=!0),delete i.draggable}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:"4",objects:e})}var g5=VX;var ak=[d5,u5,p5,h5,g5],TX="4";function _L(r){let e=parseInt(TX,10),t=parseInt(r.version||"0",10);for(t>e&&typeof console!="undefined"&&console.warn&&console.warn(`Loading saved state with version ${t}, but last known version is ${e}. States saved in a newer version of the geometry tool may not load correctly in older versions of the tool.`),ak[t]||typeof console!="undefined"&&console.warn&&console.warn(`State has invalid version: ${t}. If a version is present, it should be a non-negative integer less than or equal to ${e}.`),t===0&&(r=ak[0](r));t<e;)t+=1,ak[t]&&(r=ak[t](r));return r}var MX=!1;function Yf(r,e){var t=e[r];return t.type==="transformed-object"?Yf(t.parents.object,e):t.type}function m5(r){switch(r){case"circle":case"compass":case"arc":return!0}return!1}function AX(r,e,t){var i=Yf(e,t);return i==="circle"||i==="compass"?r/(2*Math.PI):r}function f5(r){switch(r){case"scaled-rotation":case"vector":return!0}return!1}function LX(r){switch(r){case"point":case"midpoint":case"glider":case"intersection":case"polygon":return"P";case"line":case"segment":case"ray":case"vector":case"parallel":case"perpendicular":return"L";case"circle":case"compass":return"C";case"arc":case"angle":return"A";case"image":return"I";case"dilation":case"rotation":case"translation":case"reflection":case"scaled-rotation":return"T";case"transformed-object":return"T";default:return r}}function y5(r){let e=!MX,t=_L(r),i={},n={},o=V=>{if(n.hasOwnProperty(V))return n[V];let k=Yf(V,t.objects);if(e&&!f5(k)){let P=i.token||1;i.token=P+1;let W="\\token{"+P+"}";return n[V]=W,W}let T=LX(k),A=i[T]||1;i[T]=A+1;let R=T+"_{"+A+"}";return n[V]=R,R};function s(V){let k=i[V]||1;return i[V]=k+1,V+"_{"+k+"}"}let a=(V,k,T)=>o(V)+"=\\operatorname{"+k+"}\\left("+T.map(o).join(",")+"\\right)",{centerX:l,centerY:c,size:u}=t.viewport;u*=1.25;let p=1,g=u/(1+p),h=g*p,b={version:10,randomSeed:"",expressions:{list:[]},graph:{product:"geometry-calculator",viewport:{xmin:l-g,xmax:l+g,ymin:c-h,ymax:c+h},showGrid:!1,showXAxis:!1,showYAxis:!1,squareAxes:!0,degreeMode:!0}};t.graphSettings.showGrid&&(b.graph.showGrid=!0,b.graph.xAxisMinorSubdivisions=1,b.graph.yAxisMinorSubdivisions=1,b.graph.xAxisStep=1,b.graph.yAxisStep=1);let C=b.expressions.list,D=[],S=[];for(let V in t.objects){let k=t.objects[V],T=Yf(k.id,t.objects),A={id:k.id,type:"expression",color:k.color,hidden:!!k.hidden};if(e&&!f5(T)&&(A.folderId=__dcg_shared_module_exports__['Jc']),k.locked&&(A.dragMode="NONE"),!k.hidden&&k.label&&k.showLabel){if(A.label=k.label,A.showLabel=!0,T==="segment"&&k.label.indexOf("{length}")!==-1)if(k.label==="{length}")A.label="";else{let R=s("l"),P=R+"=\\operatorname{round}\\left(\\operatorname{length}\\left("+o(k.id)+"\\right),2\\right)";S.push({id:"len-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{length\}/g,"${"+R+"}")}if(T==="angle"&&k.label.indexOf("{angle}")!==-1)if(k.label==="{angle}")A.label="";else{let R=s("a"),P=R+"=\\operatorname{round}\\left(\\operatorname{measure}\\left("+o(k.id)+"\\right)\\right)";S.push({id:"angle-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{angle}/g,"${"+R+"}\xB0")}if(T==="polygon"&&k.label.indexOf("{area}")!==-1)if(k.label==="{area}")A.label="";else{let R=s("a"),P=R+"=\\operatorname{round}\\left(\\operatorname{area}\\left("+o(k.id)+"\\right),2\\right)";S.push({id:"area-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{area\}/g,"${"+R+"}")}if(T==="polygon"&&k.label.indexOf("{perimeter}")!==-1){let R=s("p"),P=R+"=\\operatorname{round}\\left(\\operatorname{perimeter}\\left("+o(k.id)+"\\right),2\\right)";S.push({id:"perim-"+A.id,type:"expression",latex:P}),A.label=A.label.replace(/\{perimeter\}/g,"${"+R+"}")}}switch(k.type){case"point":A.latex=o(k.id)+"=\\left("+__dcg_shared_module_exports__['lc'](k.x)+","+__dcg_shared_module_exports__['lc'](k.y)+"\\right)";break;case"glider":A.latex=o(k.id)+"=\\operatorname{glider}\\left("+o(k.parents.host)+","+__dcg_shared_module_exports__['lc'](AX(k.t,k.parents.host,t.objects))+"\\right)";break;case"intersection":let R=Yf(k.parents.host1,t.objects),P=Yf(k.parents.host2,t.objects),W=k.negRoot;(m5(R)&&!m5(P)||P==="arc")&&(W=!W),W?A.latex=a(k.id,k.type,[k.parents.host1,k.parents.host2]):A.latex=a(k.id,k.type,[k.parents.host2,k.parents.host1]);break;case"midpoint":A.latex=a(k.id,k.type,[k.parents.straight]);break;case"circle":A.latex=a(k.id,k.type,[k.parents.point1,k.parents.point2]);break;case"arc":A.latex=a(k.id,k.type,[k.parents.point1,k.parents.point2,k.parents.point3]);break;case"compass":A.latex=a(k.id,"circle",[k.parents.center,k.parents.straight]);break;case"line":case"segment":case"ray":case"vector":A.latex=a(k.id,k.type,[k.parents.point1,k.parents.point2]);break;case"parallel":case"perpendicular":A.latex=a(k.id,k.type,[k.parents.straight,k.parents.point]);break;case"polygon":A.latex=a(k.id,k.type,k.parents.points);break;case"angle":A.latex=a(k.id,k.type,[k.parents.point1,k.parents.point2,k.parents.point3]);break;case"transformed-object":A.latex=o(k.id)+"="+o(k.parents.transformation)+"\\left("+o(k.parents.object)+"\\right)";break;case"dilation":A.latex=o(k.id)+"\\left(x\\right)=\\operatorname{dilate}\\left(x,"+o(k.parents.center)+","+k.scaleFactor+"\\right)";break;case"reflection":A.latex=o(k.id)+"\\left(x\\right)=\\operatorname{reflect}\\left(x,"+o(k.parents.straight)+"\\right)";break;case"translation":A.latex=o(k.id)+"\\left(x\\right)=\\operatorname{translate}\\left(x,"+o(k.parents.from)+","+o(k.parents.to)+"\\right)";break;case"rotation":A.latex=o(k.id)+"\\left(x\\right)=\\operatorname{rotate}\\left(x,"+o(k.parents.center)+","+k.angle+"\\right)";break;case"scaled-rotation":let H=o(k.parents.center),j=o(k.parents.from),ne=o(k.parents.to);A.latex=o(k.id)+`\\left(x\\right)=\\operatorname{rotate}\\left(\\operatorname{dilate}\\left(x,${H},\\frac{\\operatorname{distance}\\left(${ne},${H}\\right)}{\\operatorname{distance}\\left(${j},${H}\\right)}\\right),${H},\\operatorname{directedangle}\\left(${j},${H},${ne}\\right)\\right)`;break;case"image":break;default:return k}A.latex&&(A.folderId===__dcg_shared_module_exports__['Jc']?D.push(A):S.push(A))}return C.push({type:"folder",id:__dcg_shared_module_exports__['Jc'],title:"geometry",secret:!0}),C.push.apply(C,D),C.push.apply(C,S),b}function b5(r){let e=__dcg_shared_module_exports__['j'](Uc(r));return e.graph.product="geometry-calculator",e}async function lk(r,e,t){let i=!1;r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-importing-graph"),hideAfter:0,toastStyle:"cover",onHide:()=>{i=!0}}});let n=()=>{i||r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-importing-graph"),toastStyle:"error",hideAfter:12e3}})},o=()=>{r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-no-folders"),toastStyle:"error",hideAfter:12e3}})},s=(l,c)=>{r.dispatch({type:"set-state",state:l}),r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-imported-graph"),undoCallback:()=>{r.dispatch({type:"set-state",state:c})}}})},a=(l,c,u)=>{if(i)return;let p=r.getSelectedItem();if(!p)return;let g=p.type==="folder",h=p.type!=="folder"&&!!p.folderId,b=g||h,C={},D=r.getState(),S=D.expressions.list;if(S.length===1&&!g&&!r.isGeometry()){s(l,D);return}if(r.isGeometry()&&u!=="graphing"){s(l,D);return}let V=l.expressions.list;for(let P=0;P<V.length;P++){let W=r.generateId(),H=V[P];if(H.type==="folder")if(b){o();return}else{C[H.id]=W,H.id=W;continue}H.folderId?H.folderId=C[H.folderId]:g?H.folderId=p.id:h&&(H.folderId=p.folderId),H.id=W}let k=__dcg_shared_module_exports__['j'](D),T=0;for(;T<S.length;){if(S[T].id===p.id){g&&(S[T].title=c);break}T+=1}let A=g?T+1:T,R=g?0:1;S.splice(A,R,...V),s(D,k)};try{let l=await fetch(`${e}?${new URLSearchParams(fd)}`,{headers:{Accept:"application/json"}});if(!l.ok)throw void 0;let c=await l.json(),u=c.state,p=LU(e);r.isGeometry()&&(p==="geometry"?u=y5(u):p==="graphing"&&(u=b5(u))),u=Uc(u),t(u,(g,h)=>{g||!h||!p?n():a(h,c.title||"",p)})}catch(l){n()}}function w5(r){if(window.clipboardData&&window.clipboardData.getData)return window.clipboardData.getData("Text");if(r&&r.clipboardData&&r.clipboardData.getData)return r.clipboardData.getData("text/plain")}var Fu=__dcg_shared_module_exports__['h'](X());ct();var{If:OX}=Fu.Components,ck=class extends Fu.Class{init(){this.guid=__dcg_shared_module_exports__['M']("dcg-exp-list-resize")}template(){return Fu.createElement(OX,{predicate:this.bindFn(this.isVisible)},()=>Fu.createElement("div",{class:Fu.const("dcg-exp-list-resizer"),onTapStart:this.bindFn(this.onTapStart)}))}isVisible(){return this.props.controller().expressionsAreFullWidth()?!1:this.props.controller().isListVisible()}onTapStart(e){this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,O(document).on(`dcg-tapmove.${this.guid}`,t=>{if(this.initialLeft===void 0||this.initialWidth===void 0)return;let i=t.changedTouches[0].clientX-this.initialLeft+this.initialWidth;this.props.controller().dispatch({type:"resize-exp-list",expListWidth:i})}),O(document).on(`dcg-tapend.${this.guid}`,this.bindFn(this.onTapEnd)),O(document).on(`dcg-tapcancel.${this.guid}`,this.bindFn(this.onTapEnd))}onTapEnd(){O(document).off(`.${this.guid}`),this.initialLeft=void 0,this.initialWidth=void 0}};var yr=__dcg_shared_module_exports__['h'](X());var{If:Hx}=yr.Components,dk=class extends yr.Class{constructor(){super(...arguments),this.justGlobalReplaced=!1}init(){this.controller=this.props.controller()}template(){return yr.createElement("div",{class:()=>({"dcg-expression-search-bar":!0,"dcg-expressions-scrolled":this.props.expsScrolled()&&!this.controller.getTickerOpen()}),role:yr.const("search")},yr.createElement("div",{class:yr.const("dcg-search-row")},yr.createElement("div",{class:yr.const("dcg-search-mathquill-container")},yr.createElement(it,{hasError:this.const(!1),getAriaLabel:()=>this.controller.s("graphing-calculator-label-search-expressions"),getAriaPostLabel:()=>this.controller.getExpressionSearchStr().length===0?this.controller.raw(""):this.shouldShowReplaceError()?this.controller.s("graphing-calculator-error-expression-replacement"):this.shouldShowSearchError()?this.controller.s("graphing-calculator-error-expression-search"):this.controller.s("shared-calculator-text-search-results",{count:new uo(this.controller.getExpressionSearchCount())}),capExpressionSize:this.const(!1),onUserChangedLatex:this.bindFn(this.onSearchChange),latex:()=>this.controller.getRawExpressionSearchStr(),isFocused:this.bindFn(this.isSearchFocused),config:this.bindFn(this.getMQConfig),onFocusedChanged:this.bindFn(this.onSearchFocusChanged),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{if(e==="Esc")t&&t.preventDefault(),this.closeSearch();else if(e==="Enter")t&&t.preventDefault(),this.onEnter();else{var i=it.getFocusedMathquill();if(!i)return;i.keystroke(e,t),this.controller.getRawExpressionSearchStr()!==i.latex()&&(this.justGlobalReplaced=!1,this.onSearchChange(i.latex()))}}}),yr.createElement("i",{class:yr.const("dcg-icon-search"),"aria-hidden":yr.const("true")}),yr.createElement(Hx,{predicate:()=>this.controller.getRawExpressionSearchStr().length===0},()=>yr.createElement("span",{class:yr.const("dcg-search-placeholder")},()=>this.controller.s("graphing-calculator-label-search-expressions"))),yr.createElement(Hx,{predicate:()=>this.shouldShowSearchError()},()=>yr.createElement("span",{class:yr.const("dcg-search-replace-icon-container")},yr.createElement(ms,{error:()=>this.controller.s("graphing-calculator-error-expression-search"),gravity:this.const("s"),size:this.const("small")}))),yr.createElement(Hx,{predicate:()=>this.controller.isSearchReplaceValid()&&!this.justGlobalReplaced},()=>yr.createElement("span",{class:yr.const("dcg-search-replace-icon-container")},yr.createElement("i",{class:yr.const("dcg-icon-replace"),role:yr.const("button"),tabindex:yr.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-replace"),onTap:this.bindFn(this.onGlobalReplace)}))),yr.createElement(Hx,{predicate:()=>this.justGlobalReplaced},()=>yr.createElement("span",{class:yr.const("dcg-search-replace-icon-container")},yr.createElement("i",{class:yr.const("dcg-icon-check"),"aria-hidden":yr.const("true")}))),yr.createElement(Hx,{predicate:()=>this.shouldShowReplaceError()},()=>yr.createElement("span",{class:yr.const("dcg-search-replace-icon-container")},yr.createElement(ms,{error:()=>this.controller.s("graphing-calculator-error-expression-replacement"),gravity:this.const("s"),size:this.const("small")})))),yr.createElement("i",{onTap:()=>this.closeSearch(),tabindex:yr.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),role:yr.const("button"),class:yr.const("dcg-icon-remove dcg-do-not-blur")})))}onGlobalReplace(){this.justGlobalReplaced=!0,setTimeout(()=>{this.justGlobalReplaced=!1,this.update()},1500),this.controller.dispatch({type:"rename-identifier-global",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr()})}onEnter(){this.controller.isSearchReplaceValid()?this.onGlobalReplace():this.controller.dispatch({type:"update-expression-search-str",str:this.controller.getRawExpressionSearchStr()})}shouldShowSearchError(){return!this.controller.getIsExpressionSearchStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}shouldShowReplaceError(){return!this.shouldShowSearchError()&&!this.controller.getIsExpressionReplaceStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}closeSearch(){this.controller.dispatch({type:"close-expression-search"})}onSearchChange(e){this.controller.dispatch({type:"update-expression-search-str",str:e})}onSearchFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"search-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"search-expressions"}})}isSearchFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="search-expressions"}onReplaceChange(e){this.controller.dispatch({type:"update-expression-replace-str",str:e})}onReplaceFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"replace-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"replace-expressions"}})}isReplaceFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="replace-expressions"}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["label","rename"]})}};var hr=__dcg_shared_module_exports__['h'](X());var{If:x5,IfDefined:PX}=hr.Components,uk=class extends hr.Class{init(){this.controller=this.props.controller()}template(){return hr.createElement("div",{class:()=>({"dcg-ticker":!0,"dcg-expressions-scrolled":this.props.expsScrolled()})},hr.createElement("div",{class:hr.const("dcg-ticker-settings-container")},hr.createElement("div",{class:hr.const("dcg-ticker-settings-internal")},hr.createElement("div",{class:hr.const("dcg-editable-mathquill-container dcg-action-definition")},hr.createElement("span",{class:hr.const("dcg-ticker-label")},()=>this.controller.raw("Run")),hr.createElement(it,{hasError:()=>!!this.getHandlerErrorString(),getAriaPostLabel:()=>{let e=this.getHandlerErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchHandlerLatexIfChanged(e),latex:()=>this.getHandlerLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),isFocused:()=>this.getFocusedInput()==="handler",config:()=>this.getMQConfig(),onFocusedChanged:e=>this.handleFocusedChanged("handler",e),selectOnFocus:this.const(!0),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("handler",e,t)}}),PX(()=>this.getHandlerErrorString(),e=>hr.createElement("span",{class:hr.const("dcg-clickable-info-error-container")},hr.createElement(ms,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),hr.createElement("div",{class:hr.const("dcg-editable-mathquill-container dcg-action-frequency")},hr.createElement("span",{class:hr.const("dcg-ticker-label")},()=>this.controller.raw("every")),hr.createElement(it,{hasError:()=>!!this.getMinStepErrorString(),getAriaPostLabel:()=>{let e=this.getMinStepErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchMinStepLatexIfChanged(e),latex:()=>this.getMinStepLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),isFocused:()=>this.getFocusedInput()==="minstep",config:this.bindFn(this.getMQConfig),onFocusedChanged:e=>this.handleFocusedChanged("minstep",e),selectOnFocus:this.const(!0),placeholder:this.const("0"),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("minstep",e,t)}}),()=>this.controller.raw("ms"),hr.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),gravity:this.const("s")},hr.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),class:hr.const("dcg-ticker-toggle-help"),target:hr.const("_blank"),href:hr.const("https://help.desmos.com/hc/en-us/articles/4407725009165")},hr.createElement("i",{class:hr.const("dcg-icon-question-sign"),"aria-hidden":hr.const("true")})))),hr.createElement(x5,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>hr.createElement(qc,{model:()=>this.props.controller().getTicker(),controller:this.props.controller}))),hr.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.iconDisabled()}),"aria-label":this.bindFn(this.getIconAriaLabel),role:hr.const("button"),tabindex:()=>this.iconDisabled()?-1:0,"aria-disabled":this.bindFn(this.iconDisabled),"aria-pressed":()=>this.controller.getTickerPlaying()&&!this.iconDisabled(),onTap:this.bindFn(this.toggleTicker),onTapStart:()=>{pi()}},hr.createElement(Io,{iconType:this.const("metronome")}),hr.createElement("div",{class:()=>({"dcg-metronome-bar":!0,"dcg-metronome-playing":this.controller.getTickerPlaying()&&!this.iconDisabled()})}),hr.createElement(x5,{predicate:()=>!this.iconDisabled()},()=>hr.createElement("div",{class:hr.const("dcg-mini-play-pause")},hr.createElement(Io,{iconType:this.bindFn(this.getPlayIcon)}))))),hr.createElement("i",{onTap:this.bindFn(this.closeTicker),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-close"),role:hr.const("link"),class:hr.const("dcg-icon-remove dcg-do-not-blur")}))}iconDisabled(){return!!(this.getMinStepErrorString()||this.getHandlerErrorString()||!this.isHandlerMaybeValid())}isHandlerMaybeValid(){var t;return((t=this.controller.getTicker().formula)==null?void 0:t.handler.status)==="maybe-valid"}closeTicker(){this.controller.dispatch({type:"close-ticker"})}toggleTicker(){this.iconDisabled()||this.controller.dispatch({type:"toggle-ticker"})}getPlayIcon(){return this.controller.getTickerPlaying()?"pause":"play"}getIconAriaLabel(){return this.controller.getTickerPlaying()?this.controller.s("graphing-calculator-label-ticker-pause"):this.controller.s("graphing-calculator-label-ticker-play")}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="ticker"))return e.location}handlePressedKey(e,t,i){let n=it.getFocusedMathquill();if(n){if(t==="Enter"&&this.shouldShowSliderPrompt()&&this.controller.dispatch({type:"create-sliders-for-ticker",variables:jb(this.props.controller().getTicker())}),t==="Right"&&e==="handler"||t==="Left"&&e==="minstep"||t==="Down"){var o=it.applyArrowKeyAndReturnIfWasAtBounds(n,t,i);if(!o)return;if(t==="Down")return this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Right"){this.handleFocusedChanged("minstep",!0);return}else if(t==="Left"){this.handleFocusedChanged("handler",!0);return}}n.keystroke(t,i),e==="handler"?this.dispatchHandlerLatexIfChanged(n.latex()):e==="minstep"&&this.dispatchMinStepLatexIfChanged(n.latex())}}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"ticker",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"ticker",location:e}})}dispatchHandlerLatexIfChanged(e){this.getHandlerLatex()!==e&&this.controller.dispatch({type:"update-ticker-handlerlatex",latex:e})}dispatchMinStepLatexIfChanged(e){this.getMinStepLatex()!==e&&this.controller.dispatch({type:"update-ticker-minsteplatex",latex:e})}getHandlerLatex(){return this.controller.getTickerHandlerLatex()}getMinStepLatex(){return this.controller.getTickerMinStepLatex()}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["dt"]})}getHandlerErrorString(){return this.getHandlerLatex()?pR(this.controller.getTicker()):void 0}getMinStepErrorString(){return hR(this.controller.getTicker())}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?jb(this.controller.getTicker()).length>0:!1}};var Xo=__dcg_shared_module_exports__['h'](X());var{For:v5,If:_X}=Xo.Components,pk=class extends Xo.Class{init(){this.controller=this.props.controller(),this.currentlyInspectedDepth=1/0,this.cachedTokenDepths={depths:{},isInvalid:!1},this.updateCachedTokenDepthInfo()}willUpdate(){this.updateCachedTokenDepthInfo()}updateCachedTokenDepthInfo(){let e="",t=!1,i=this.controller.getFocusLocation();if(i&&i.type==="expression"){let o=this.controller.getFocusedItem();(o==null?void 0:o.type)==="expression"&&(e=o.id,t=!!o.error||!!o.formula.variables.length)}if(this.cachedTokenDepths.focusedExpressionBeforeError==e&&t){this.cachedTokenDepths.isInvalid=!0;return}this.cachedTokenDepths={depths:this.controller.cachedGeoTokenDepths,isInvalid:!1,focusedExpressionBeforeError:t?void 0:e}}template(){return Xo.createElement("div",{class:()=>({"dcg-geo-show-constructions-pane":!0,"dcg-transient-error":this.cachedTokenDepths.isInvalid,"dcg-cant-drag-item":!!this.controller.getDraggedItemId()&&!this.controller.canDraggedItemBeMovedIntoTokenPane()}),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-label"),role:Xo.const("region"),didUnmount:()=>this.lastFocusedIdentifier=void 0,onKeydown:this.bindFn(this.handleKeydown)},Xo.createElement(_X,{predicate:()=>this.controller.getGeometryTokenCount()===0},()=>Xo.createElement("div",{class:Xo.const("dcg-empty-constructions")},()=>this.controller.s("graphing-calculator-text-geometry-no-constructed-objects"))),Xo.createElement(v5,{each:this.bindFn(this.getObjectDepths)},Xo.createElement("div",{class:Xo.const("dcg-displayed-sections-container")},e=>Xo.createElement("div",{class:()=>({"dcg-displayed-section-level":!0,"dcg-selected-level":parseInt(e)===this.getCurrentlyInspectedDepth(),"dcg-below-the-line":parseInt(e)>this.getCurrentlyInspectedDepth()})},Xo.createElement(v5,{each:()=>this.getTokensForDepth(e),key:(t,i)=>i},Xo.createElement("span",{role:Xo.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-depth",{depth:e})},(t,i)=>Xo.createElement("span",{class:()=>({"dcg-token-being-dragged-container":this.isTokenBeingDragged(e,i)}),onTapStart:n=>{let o=this.getCalcIdForDepth(e,i),s=this.controller.getItemModel(o);!s||s.type!=="expression"||this.controller.isItemInGeoFolder(s.id)&&this.props.onDragPending(n,{type:"token",calcId:o,originalIndex:s.index})}},Xo.createElement(Vd,{showParentChildrenHover:this.const(!0),controller:this.props.controller,identifier:()=>this.getIdentifierForDepth(e,i),insideMQ:this.const(!1),insideGroup:this.const(!0),focusLocation:()=>({type:"geo-token",identifier:this.getIdentifierForDepth(e,i)}),putInTabOrder:()=>{if(this.lastFocusedIdentifier===void 0){let n=this.getObjectDepths();this.lastFocusedIdentifier=this.getIdentifierForDepth(n[0],0)}return this.lastFocusedIdentifier===this.getIdentifierForDepth(e,i)}}))))))))}isTokenBeingDragged(e,t){let i=this.controller.getDraggedItemId();if(!i)return!1;if(this.controller.isItemInGeoFolder(i))return i==this.getCalcIdForDepth(e,t)}getCurrentlyInspectedDepth(){return Math.min(this.currentlyInspectedDepth,this.getObjectDepths().length-1)}getIdentifierForDepth(e,t){var i=this.getTokensForDepth(e)[t];return i?i.identifier:""}getCalcIdForDepth(e,t){var i=this.getTokensForDepth(e)[t];return i?i.calcId:""}getTokensForDepth(e){let{depths:t}=this.cachedTokenDepths;var i=t[e];return i||[]}getObjectDepths(){let e=Object.keys(this.cachedTokenDepths.depths);return e.sort((t,i)=>{let n=parseInt(t),o=parseInt(i);return isFinite(n)?isFinite(o)?n-o:1:-1}),e}selectItemIfNecessary(){if(this.controller.hasAnyItemsSelected())return;let e=this.controller.getFocusLocation();if((e==null?void 0:e.type)!=="geo-token")return;let{calcId:t}=this.controller.cachedGeoTokenInfo[e.identifier];!t||!this.controller.getItemModel(t)||this.controller.dispatch({type:"set-selected-id",id:t})}handleKeydown(e){let t=this.controller.getFocusLocation(),i=Re(e),n=Di(e);if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey&&n==="O"){e.preventDefault(),e.stopPropagation(),this.selectItemIfNecessary(),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:rg(),focusFirstOption:!0,previousFocusLocation:t}});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&n==="M"){if(e.preventDefault(),e.stopPropagation(),(t==null?void 0:t.type)!=="geo-token")return;let{calcId:g}=this.controller.cachedGeoTokenInfo[t.identifier];if(!g)return;let h=this.controller.getItemModel(g);if(!xp(h))return;this.controller.convertToNamedAssignment(h),us(h,""),this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:h.id}});return}if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;if(i==="Esc"){e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-show-constructions-open",open:!1,setFocus:!0});return}if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right")return;e.preventDefault(),e.stopPropagation();let o=this.getObjectDepths();if(o.length===0)return;let s="";if(t&&t.type==="geo-token")s=t.identifier;else{let g=this.getTokensForDepth(o[0])[0];if(!g)return;s=g.identifier}if(s==="")return;let a,l=-1,c=[];for(a=0;a<o.length;a++){let g=o[a];if(c=this.getTokensForDepth(g),!!c&&(l=__dcg_shared_module_exports__['z'](c,{identifier:s}),l!==-1))break}if(a===-1||l===-1)return;i==="Up"?a=Math.max(a-1,0):i==="Down"?a=Math.min(a+1,o.length-1):i==="Left"?l=Math.max(l-1,0):i==="Right"&&(l=Math.min(l+1,c.length-1));let u=this.getTokensForDepth(o[a]);if(!u)return;l=Math.min(l,u.length-1);let p=u[l].identifier;this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:p}}),this.lastFocusedIdentifier=p}};var Ro=__dcg_shared_module_exports__['h'](X());var hk=class extends Ro.Class{template(){return Ro.createElement("div",{class:Ro.const("dcg-geo-getting-started-container")},Ro.createElement("div",{class:Ro.const("dcg-geo-getting-started")},Ro.createElement("div",{class:Ro.const("dcg-geo-background-image")}),Ro.createElement("i",{class:Ro.const("dcg-icon-remove"),role:Ro.const("button"),tabindex:Ro.const("0"),"aria-label":()=>pn("shared-button-close-message"),onTap:this.props.onClose}),Ro.createElement("b",null,this.props.title),Ro.createElement("div",{class:Ro.const("dcg-geo-getting-started-message")},this.children),Ro.createElement("div",null,Ro.createElement("a",{href:this.props.btnUrl,target:Ro.const("_blank"),class:Ro.const("dcg-purple-geo-btn")},this.props.btnText))))}};var{If:Ru,For:FX,Switch:C5,SwitchUnion:RX}=wt.Components,qx=class extends wt.Class{constructor(){super(...arguments),this.guid=__dcg_shared_module_exports__['M']("listView")}init(){this.controller=this.props.controller()}template(){return wt.createElement("div",{didMount:this.bindFn(this.didMountContainer)},wt.createElement("div",{class:wt.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:()=>this.computeExppanelOuterStyle()},wt.createElement(Ru,{predicate:()=>this.controller.isFileDraggedOver()},()=>wt.createElement("div",{class:wt.const("dcg-drop-image")},wt.createElement("span",null,()=>this.controller.s("graphing-calculator-label-drop-image-here")))),wt.createElement("div",{class:()=>({"dcg-exppanel-container":!0,"dcg-add-shadow":this.controller.shouldRenderList()}),style:()=>({transform:this.controller.isListVisible()?void 0:this.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"})},wt.createElement(Ru,{predicate:()=>this.controller.shouldRenderList()},()=>wt.createElement(Ux,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),wt.createElement(Ru,{predicate:()=>this.controller.getExpressionSearchOpen()},()=>wt.createElement(dk,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),wt.createElement(Ru,{predicate:()=>this.controller.getTickerOpen()&&!this.controller.getTicker().filteredBySearch},()=>wt.createElement(uk,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),wt.createElement(Ru,{predicate:()=>this.controller.shouldRenderList()},()=>wt.createElement("div",{class:()=>({"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":this.controller.isDragDropActive(),"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-edit-list-mode":this.controller.isInEditListMode()}),style:()=>({background:this.controller.getBackgroundColor()}),onPaste:this.bindFn(this.onPaste),onTapStart:this.bindFn(this.onExppanelTapstart),didMount:this.bindFn(this.didMountExppanel)},wt.createElement("div",{class:()=>({"dcg-expressionlist":!0,"dcg-has-geo-notice":this.controller.hasGeoNotice()}),role:wt.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list")},wt.createElement(Ru,{predicate:()=>this.controller.getShowConstructionsOpen()},()=>wt.createElement(pk,{controller:this.props.controller,onDragPending:(e,t)=>this.onDragPending(e,t)})),wt.createElement(FX,{each:()=>this.controller.getAllItemModels(),key:e=>e.guid},wt.createElement("span",{class:wt.const("dcg-template-expressioneach")},e=>RX(()=>pS(e),{shell:()=>this.makeShellViewForModel(e),render:()=>this.makeViewForModel(e),none:()=>{}}))),wt.createElement(Nx,{controller:()=>this.props.controller()}),wt.createElement(C5,{key:()=>this.controller.getDraggedItemId()},e=>{if(e){let t=this.controller.getItemModel(e);return wt.createElement(Rx,{controller:this.props.controller},this.makeDragCopyViewForModel(t))}else return}),wt.createElement(Ru,{predicate:()=>this.controller.hasGeoNotice()},()=>wt.createElement("div",{class:wt.const("dcg-explist-geo-getting-started-container")},wt.createElement(hk,{onClose:e=>this.props.controller().dispatch({type:"dismiss-geo-notice",focusFirstExpression:e.device==="keyboard"}),btnUrl:this.bindFn(this.getBtnUrl),btnText:this.bindFn(this.getBtnText),title:()=>this.props.controller().s("account-shell-text-welcome-to-geometry")},wt.createElement(Wi,{i18n:this.props.controller,key:this.const("account-shell-text-geometry-expression-list-notice")},wt.const("Please share any bugs, questions, or suggestions with us!"),wt.const(" "),wt.createElement("a",{href:wt.const("mailto:feedback@desmos.com")},wt.const("feedback@desmos.com")))))),wt.createElement("div",{class:wt.const("dcg-expressions-branding"),style:()=>({opacity:this.controller.isKeypadOpen()?0:1})},wt.createElement(Ru,{predicate:()=>this.controller.canEditOnWeb()},()=>wt.createElement("span",{role:wt.const("link"),tabindex:wt.const(0),class:wt.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},wt.createElement("div",{class:wt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-graph-on-desmos")},()=>this.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo")),wt.createElement("i",{class:wt.const("dcg-icon-desmos"),"aria-hidden":wt.const("true")}))),wt.createElement(Ru,{predicate:()=>!this.controller.canEditOnWeb()},()=>wt.createElement("span",{class:wt.const("dcg-noedit-branding")},wt.createElement("div",{class:wt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),wt.createElement("i",{class:wt.const("dcg-icon-desmos"),"aria-hidden":wt.const("true")})))))))),wt.createElement(ck,{controller:this.props.controller})))}buttonStatus(){let e=new Date("Thu May 18 2023 20:00:00 GMT-0400 (Eastern Daylight Time)"),t=new Date("Thu May 18 2023 20:30:00 GMT-0400 (Eastern Daylight Time)"),i=new Date;return e>i?"upcoming":t>i?"in-progress":"done"}getBtnUrl(){return this.buttonStatus()==="done"?"https://blog.desmos.com/articles/geometry-beta-release/":"https://www.youtube.com/watch?v=WrzlHvl83m0"}getBtnText(){let e=this.buttonStatus();if(e==="done")return this.controller.s("account-shell-link-learn-more");if(e==="in-progress")return this.controller.raw("Join #DesmosLive now!");let t=new Date("Thu May 18 2023 20:00:00 GMT-0400 (Eastern Daylight Time)"),n=new Date(t.toLocaleString("en-US",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone})).getHours(),o=n>12?`${n-12}pm`:`${n}am`;return this.controller.raw(`Join #DesmosLive at ${o}!`)}makeShellViewForModel(e){return wt.createElement(Fx,{controller:this.props.controller,model:()=>e,onDragPending:()=>{},isDragCopy:()=>!1})}computeExppanelOuterStyle(){this.getListBottomAndUpdateLastExpressionPadding();let{list:e}=this.controller.computeMajorLayout(),t=0,i=e.top;return e.top>0&&!this.controller.isListVisible()&&(i-=e.height),{position:"absolute",left:t+"px",top:i+"px",width:e.width+"px",height:e.height+"px"}}makeDragCopyViewForModel(e){return this.makeViewForModel(e,!0)}makeViewForModel(e,t=!1){var i;if(e.type==="table")i=wt.createElement(Mx,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="folder")i=wt.createElement(Ax,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="text")i=wt.createElement(kx,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="image")i=wt.createElement(Px,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="expression")i=wt.createElement(C5,{key:()=>t&&this.controller.shouldRenderDraggedItemAsToken()},n=>n?wt.createElement(Vd,{showParentChildrenHover:this.const(!1),controller:this.props.controller,identifier:()=>this.controller.getDraggedIdentifier(),insideMQ:this.const(!1),insideGroup:this.const(!1),putInTabOrder:()=>!1}):wt.createElement(Ex,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t}));else return;return i}didUnmount(){O(document.documentElement).off("."+this.guid)}didMountContainer(e){this.node=e,O(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))}didMountExppanel(e){this.exppanel=e,e.onscroll=()=>this.controller.markTickRequiredNextFrame()}getListBottomAndUpdateLastExpressionPadding(){let e=this.controller.getKeypadHeight(),t=this.__listBottom||0;return this.__listBottom=e,e===0&&t!==0&&LP()&&this.padLastExpressionUntilTapEnd(t),e}padLastExpression(e){let t=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");t.style.marginBottom=e+"px"}unpadLastExpression(){let e=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");e.style.marginBottom="0"}padLastExpressionUntilTapEnd(e){this.padLastExpression(e),O(document).on("dcg-tap.animating-bottom",()=>{this.unpadLastExpression(),O(document).off("dcg-tap.animating-bottom")})}handleKeyDown(e){var s;if(this.controller.inAudioTraceMode())return;let t=Re(e),i=Di(e),n=this.controller.getSelectedItem();if(!n){(t===ul||t===Ah)&&!this.controller.needsFakeKeypad()&&this.controller.hasMultipleItemsSelected()&&this.controller.dispatch({type:"delete-all-selected-items"});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&i==="M"&&n){if(!this.controller.isGeometry()||!xp(n))return;e.preventDefault(),e.stopPropagation(),this.controller.convertToTokenAssignment(n);let a=this.controller.getGeometryFolder();if(a){let c=a.index+this.controller.getNumberOfItemsInFolder(a.id);us(n,a.id),n.index!==c&&Ip(this.controller.getListModel(),n.index,c,1)}this.controller.ensureAtLeastOneVisibleItem();let l=(s=jo(n))==null?void 0:s.identifier;l&&this.controller.getShowConstructionsOpen()&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:l}});return}let o=this.controller.getFocusLocation();if(!(this.controller.getSelectedGeoExpression()&&(o!==void 0||t!==Ah&&t!==ul))){if(e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey&&o!==void 0){if(i==="O"){e.preventDefault(),e.stopPropagation();let a;if(n.type==="expression")!n.sliderExists&&!Im(n)?(a={type:"expression",model:n,guid:n.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:n.id}})):n.sliderExists&&(a={type:"slider",model:n,guid:"slider-"+n.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:n.id}}));else if(n.type==="image")a={type:"image",model:n,guid:n.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:n.id}});else if(n.type==="table"&&o.type==="table"){let l=o.location;if(!l)return;let c=n.columnModels[l.column];if(!c||c.latex===""||!this.controller.getGraphSettings().config.graphpaper||c.error||c.index===0)return;a={type:"table-column",model:c,guid:c.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"table-icon",id:n.id,columnId:c.id}})}if(!a)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:a});return}else if(i==="D"){if(this.controller.isItemReadonly(n.id)&&!this.controller.isInEditListMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"delete-item-and-animate-out",id:n.id,setFocusAfterDelete:!0});return}}if(this.controller.isInEditListMode()&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(t===pl&&o!==void 0){let a=this.controller.getItemModelByIndex(0);if(!a)return;let l=(o.type==="readonly-expression"&&a.type==="expression"||o.type==="table-container"&&a.type==="table"||o.type===a.type)&&o.id===a.id,c={type:"edit-list-toggle"},u=this.controller.isFocusLocationFocused(c);e.shiftKey&&l?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-focus-location",location:c})):!e.shiftKey&&u&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"move-focus-to-item",id:a.id,where:a.type==="table"?"container":void 0}))}else if(t===So||t===Eo){let a=this.controller.getListModel(),l=t===So?Uh(a,n.index):Hh(a,n.index);if(!l)return;this.controller.dispatch({type:"move-focus-to-item",id:l.id,where:l.type==="table"?"container":"start"})}return}if(!(document.activeElement&&O.contains(document.body,document.activeElement))&&!O(e.target).closest(this.exppanel).length&&O.contains(document.documentElement,e.target))switch(t){case So:e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case Eo:e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case Do:e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case gd:e.preventDefault(),n&&(n.type==="expression"&&n.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:n.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:n.id}})):this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"start"}));break;case pl:e.preventDefault(),n&&this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"start"});break;case hd:e.preventDefault(),n&&(n.type==="expression"&&n.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:n.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:n.id}})):this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"end"}));break;case ul:e.preventDefault(),n&&!this.controller.isItemReadonly(n.id)&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case Ah:e.preventDefault(),n&&!this.controller.isItemReadonly(n.id)&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case Fl:e.wasHandled("create-expression-with-keyboard")||(e.preventDefault(),e.handle("create-expression-with-keyboard"),n&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||t===pb||t===hb)return;n&&(n.type==="table"||this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"end"}))}}}onDragPending(e,t){e.preventDefault(),pi();var i={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:i.x,y:i.y},o=setTimeout(()=>{O(document).off(".dragpending"),this.onDragStart(e,t,i,n)},500);O(document).on("dcg-tapmove.dragpending",s=>{n={x:s.touches[0].clientX,y:s.touches[0].clientY},(Math.abs(n.y-i.y)>3||Math.abs(n.x-i.x)>3)&&(clearTimeout(o),O(document).off(".dragpending"),this.onDragStart(e,t,i,n))}),O(document).on("dcg-tapend.dragpending",function(){clearTimeout(o),O(document).off(".dragpending")})}onDragStart(e,t,i,n){e.touches.length===1&&(e.wasHandled("dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",dragTarget:t,grabPt:i,mousePt:n}))}onExppanelTapstart(e){e.device!=="mouse"&&O(e.target).closest(".dcg-expressionitem").length===0&&pi()}onPaste(e){let t=this.controller.getGraphSettings().config;var i=w5(e);if(!i)return;var n=this.controller.getSelectedItem();if(this.controller.canLoadPastedLink(i)&&n&&n.type==="folder"&&n.title===""){e.stopPropagation(),e.preventDefault(),lk(this.controller,i,(s,a)=>a(null,s));return}if(n&&(n.type==="text"||n.type==="folder"))return;if(this.controller.canLoadPastedLink(i)){e.stopPropagation(),e.preventDefault();let s=t.pasteGraphLinkCallback?t.pasteGraphLinkCallback:(a,l)=>l(null,a);lk(this.controller,i,s);return}if(t.pasteTableData){let s=c5(i);if(s!==void 0)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:s})}let o=l5(i);if(o!==void 0){e.stopPropagation(),e.preventDefault();let s=[];o.length===1&&o[0].numberList?this.controller.dispatch({type:"append-number-list",latex:o[0].content}):(o.forEach(a=>{s.push({type:"expression",id:this.controller.generateId(),latex:a.content})}),this.controller.dispatch({type:"insert-several-expressions",expressions:s}));return}}onDrop(e){if(!this.controller.areImagesEnabled())return;let t=e.dataTransfer&&e.dataTransfer.files;t&&t.length&&this.controller.dispatch({type:"new-images",files:t})}};var dn=__dcg_shared_module_exports__['h'](X());ct();var fo=__dcg_shared_module_exports__['h'](X());var D5=__dcg_shared_module_exports__['h'](X());var Xn=class extends D5.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}getFocusedInput(){let e=this.controller.getFocusLocation(),t=this.model.type==="table-column"?this.model.table.id:this.id;if(!(!e||e.type!=="expression-menu"||e.id!==t))return e.location}handleFocusedChanged(e,t){let i=this.model.type==="table-column"?this.model.table.id:this.id;e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:i,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"expression-menu",id:i,location:t}})}onColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-color",id:this.id,color:e}):this.controller.dispatch({type:"set-tablecolumn-color",color:e,tableId:this.model.table.id,columnId:this.id}))}onCustomColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-colorlatex",id:this.id,colorLatex:e}):this.controller.dispatch({type:"set-tablecolumn-colorlatex",tableId:this.model.table.id,columnId:this.model.id,colorLatex:e}))}getModelColor(){return this.model.type==="image"?"":kc(this.model)}};var ni=__dcg_shared_module_exports__['h'](X());var Nu=__dcg_shared_module_exports__['h'](X()),an=class extends Nu.Class{template(){return Nu.createElement("div",{class:()=>({"dcg-toggle-view":!0,"dcg-toggled":this.props.toggled()}),"aria-label":()=>this.props.ariaLabel(),role:Nu.const("checkbox"),tabindex:Nu.const("0"),"aria-checked":()=>this.props.toggled(),toggled:()=>this.props.toggled(),onTap:this.bindFn(this.props.onChange)},Nu.createElement("div",{class:Nu.const("dcg-toggle-switch")}))}};var Xt=__dcg_shared_module_exports__['h'](X());var{For:FL,If:zx}=Xt.Components,Qo=class extends Xt.Class{init(){this.controller=this.props.controller()}template(){return Xt.createElement("div",{class:Xt.const("dcg-color-picker-container")},Xt.createElement(FL,{each:()=>this.getColorValues()},Xt.createElement("div",{class:Xt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Xt.createElement("div",{class:Xt.const("dcg-color-tile"),handleevent:Xt.const("true"),role:Xt.const("button"),tabindex:Xt.const("0"),"aria-label":()=>zh(this.controller,e),"aria-pressed":()=>this.isSelected(e),onTap:()=>this.props.onColorSelected(e)},Xt.createElement(gg,{color:()=>({type:"single-color",value:e}),invertSwatches:()=>this.controller.invertSwatches()}),Xt.createElement(zx,{predicate:()=>this.isSelected(e)},()=>Xt.createElement("i",{class:Xt.const("dcg-icon-check"),"aria-hidden":Xt.const("true")}))))),Xt.createElement(zx,{predicate:()=>this.getUniqueCustomColors().length>0},()=>Xt.createElement(FL,{each:this.bindFn(this.getUniqueCustomColors),key:e=>e.assignmentLatex},Xt.createElement("div",{class:Xt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Xt.createElement(Ke,{tooltip:()=>e.assignmentLatex,renderAsLatex:()=>({view:t=>Xt.createElement(tt,{config:this.const({}),latex:()=>t})})},Xt.createElement("div",{class:Xt.const("dcg-color-tile"),handleevent:Xt.const("true"),role:Xt.const("button"),tabindex:Xt.const(0),"aria-label":()=>Hs(e.assignmentLatex),"aria-pressed":()=>this.props.colorLatex()===e.assignmentLatex,onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex)},Xt.createElement(gg,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),Xt.createElement(zx,{predicate:()=>this.props.colorLatex()===e.assignmentLatex},()=>Xt.createElement("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":Xt.const("true")}))))))),Xt.createElement(zx,{predicate:()=>this.canUsePatterns()&&this.getAllImages().length>0},()=>Xt.createElement(FL,{each:this.bindFn(this.getAllImages),key:e=>e.id},Xt.createElement("div",{class:Xt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Xt.createElement(Ke,{tooltip:()=>this.controller.raw(e.name)},Xt.createElement("div",{class:Xt.const("dcg-color-tile"),handleevent:Xt.const("true"),role:Xt.const("button"),tabindex:Xt.const(0),"aria-label":()=>this.controller.raw(e.name),"aria-pressed":()=>this.props.colorLatex()===e.url,onTap:()=>this.props.onCustomColorSelected(e.url)},Xt.createElement("div",{class:()=>({"dcg-color-swatch":!0,"dcg-has-background-image":!0}),style:()=>({"background-image":'url("'+e.url+'")'})}),Xt.createElement(zx,{predicate:()=>this.props.colorLatex()===e.url},()=>Xt.createElement("i",{class:()=>"dcg-icon-check dcg-mixed-color","aria-hidden":Xt.const("true")}))))))))}canUsePatterns(){var e,t,i;return(i=(t=(e=this.props).canUsePatterns)==null?void 0:t.call(e))!=null?i:!1}hideColorFunctions(){var e,t,i;return(i=(t=(e=this.props).hideColorFunctions)==null?void 0:t.call(e))!=null?i:!1}isSelected(e){var t=this.props.colorLatex();return t&&__dcg_shared_module_exports__['r'](this.getUniqueCustomColors(),"assignmentLatex").indexOf(t)>=0?!1:this.props.selectedColor()===e}getColorValues(){return __dcg_shared_module_exports__['E'](this.controller.getColors())}getUniqueCustomColors(){if(this.props.hideCustomColors&&this.props.hideCustomColors())return[];let e=[];this.canUsePatterns()&&this.controller.isBeta3DMode()&&(e.push({id:"gradient_u",assignmentLatex:"gradient_u"},{id:"gradient_v",assignmentLatex:"gradient_v"}),e.push({id:"checkers",assignmentLatex:"checkers"})),e.push(...this.controller.getAllColorAssignments()),this.hideColorFunctions()||e.push(...this.controller.getAllColorFunctionAssignments());let t=__dcg_shared_module_exports__['w'](e,i=>i.assignmentLatex);return e.filter(i=>t[i.assignmentLatex]===1)}getAllImages(){return this.controller.getAllImages()}getColorValue(e){switch(e.id){case"gradient_u":case"gradient_v":case"checkers":case"shader":return{type:e.id};default:let t=this.controller.getColorById(e.id);return Array.isArray(t)?{type:"color-array",value:t}:/^data:image/.test(t)?{type:"image",value:t}:{type:"single-color",value:t}}}getCheckmarkClass(e){return dS(this.getColorValue(e),!1)?`dcg-icon-check ${s2(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}};var{If:RL}=ni.Components,Xf=class extends Xn{template(){return ni.createElement("div",{class:ni.const("dcg-options-menu-section")},ni.createElement("div",{class:ni.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),ni.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),ni.createElement(RL,{predicate:()=>this.props.isOpen()},()=>ni.createElement("div",{class:ni.const("dcg-options-menu-content")},ni.createElement("div",{class:ni.const("dcg-options-flex-container")},ni.createElement("div",{class:ni.const("dcg-options-left-side")},ni.createElement("div",{class:ni.const("dcg-iconed-mathquill-row dcg-line-opacity-row")},ni.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},ni.createElement("i",{class:ni.const("dcg-icon-opacity"),"aria-hidden":ni.const("true")})),ni.createElement(fr,{latex:()=>this.model.lineOpacity,placeholder:this.bindFn(this.getLineOpacity),isFocused:()=>this.getFocusedInput()==="lineopacity",ariaPostLabel:()=>this.isLineOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isLineOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchLineOpacityLatexIfChanged),dataLabelAttributeValue:this.const("line-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"lineopacity")})),ni.createElement("div",{class:ni.const("dcg-iconed-mathquill-row dcg-line-thickness-row")},ni.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),sticky:this.const(!0),gravity:this.const("se")},ni.createElement("i",{class:ni.const("dcg-icon-line-thickness"),"aria-hidden":ni.const("true")})),ni.createElement(fr,{latex:()=>this.model.lineWidth,placeholder:this.bindFn(this.getLineWidth),isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")}))),ni.createElement("div",{class:ni.const("dcg-options-right-side")},ni.createElement(RL,{predicate:this.bindFn(this.shouldShowLineStyles)},()=>ni.createElement(Rr,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),ni.createElement(RL,{predicate:this.props.isFirstOpenSection},()=>ni.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getLineWidth(){return this.isGeometryPolygon()?""+2:""+2.5}getLineOpacity(){return this.isGeometryPolygon()?""+.6:""+.9}isGeometryPolygon(){return this.controller.isGeometry()&&this.model.type==="expression"&&yd(this.model)}getPointStyleOptions(){return["SOLID","DASHED","DOTTED"].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.lineStyle===t,class:()=>"dcg-line-segmented-option",onSelect:()=>{this.onLineStyleSelected(t)}}))}getStyleIcon(e){switch(e){case"SOLID":return"dcg-icon-line-solid";case"DASHED":return"dcg-icon-line-dashed";case"DOTTED":return"dcg-icon-line-dotted"}}getStyleAria(e){let t=this.controller.s;switch(e){case"SOLID":return t("graphing-calculator-narration-line-style-solid");case"DASHED":return t("graphing-calculator-narration-line-style-dashed");case"DOTTED":return t("graphing-calculator-narration-line-style-dotted")}}isLineOpacityValid(){return this.model.type==="expression"?hF(this.model):this.model.type==="table-column"?f2(this.model):!1}isLineWidthValid(){return this.model.type==="expression"?GD(this.model):this.model.type==="table-column"?y2(this.model):!1}dispatchLineOpacityLatexIfChanged(e){this.model.lineOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-lineopacity",id:this.id,lineOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-lineopacity",tableId:this.model.table.id,columnId:this.model.id,lineOpacity:e}))}shouldShowLineStyles(){return!(this.model.type==="expression"&&bd(this.model))}onLineStyleSelected(e){this.model.lineStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linestyle",id:this.id,lineStyle:e}):this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.model.table.id,columnId:this.model.id,lineStyle:e}))}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e}):this.controller.dispatch({type:"set-tablecolumn-linewidth",tableId:this.model.table.id,columnId:this.model.id,lineWidth:e}))}toggleLinesVisible(){this.model.type==="expression"?this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.model.table.id,columnId:this.model.id,bool:!this.props.isOpen()})}};var $x=__dcg_shared_module_exports__['h'](X());var gk=class extends Xn{template(){return $x.createElement("div",{class:$x.const("dcg-options-menu-section")},$x.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>this.model.type==="expression"&&Vm(this.model)}))}};var Mo=__dcg_shared_module_exports__['h'](X());var{If:NL}=Mo.Components,mk=class extends Xn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Mo.createElement("div",{class:Mo.const("dcg-options-menu-section")},Mo.createElement("div",{class:Mo.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-fill"),Mo.createElement(NL,{predicate:()=>!this.isInequality()},()=>Mo.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleFillVisible)}))),Mo.createElement(NL,{predicate:this.props.isOpen},()=>Mo.createElement("div",{class:Mo.const("dcg-options-menu-content")},Mo.createElement("div",{class:Mo.const("dcg-iconed-mathquill-row dcg-fill-opacity-row")},Mo.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Mo.createElement("i",{class:Mo.const("dcg-icon-opacity"),"aria-hidden":Mo.const("true")})),Mo.createElement(fr,{latex:()=>this.model.fillOpacity,placeholder:this.bindFn(this.getFillOpacity),isFocused:()=>this.getFocusedInput()==="opacity",ariaPostLabel:()=>WT(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-opacity"),hasError:()=>!WT(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("fill-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"opacity")})),Mo.createElement(NL,{predicate:this.props.isFirstOpenSection},()=>Mo.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getFillOpacity(){return this.controller.isGeometry()&&yd(this.model)?""+.2:""+.4}isInequality(){return bd(this.model)}toggleFillVisible(){this.controller.dispatch({type:"set-item-fill",id:this.id,fill:!this.props.isOpen()})}dispatchOpacityLatexIfChanged(e){this.model.fillOpacity!==e&&this.controller.dispatch({type:"set-item-fillopacity",id:this.id,fillOpacity:e})}};var oi=__dcg_shared_module_exports__['h'](X());var or=__dcg_shared_module_exports__['h'](X());var{If:S5,Switch:E5}=or.Components,fk=class extends or.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return or.createElement("div",{class:or.const("dcg-clickable-image-info-view"),role:or.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-clickable-image-options")},or.createElement("div",{class:or.const("dcg-clickable-image-state-container")},or.createElement(Ke,{tooltip:()=>this.tooltip("hovered"),gravity:this.const("s")},or.createElement(Pu,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("hovered"),onFileChange:e=>this.updateImage("hovered",e),readonly:()=>this.controller.isItemReadonly(this.id)},or.createElement(E5,{key:this.bindFn(this.hoveredStatus)},()=>or.createElement("div",{class:or.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("hovered")})))),or.createElement(S5,{predicate:()=>!!this.model.clickableInfo.hoveredImage},()=>or.createElement("div",{class:or.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("hovered"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-hovered-image"),role:or.const("button"),tabIndex:or.const(0)},or.createElement("i",{class:or.const("dcg-icon-remove"),"aria-hidden":or.const("true")}))),or.createElement("div",{role:or.const("heading"),"aria-level":or.const("2"),class:or.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-hovered"))),or.createElement("div",{class:or.const("dcg-clickable-image-state-container")},or.createElement(Ke,{tooltip:()=>this.tooltip("depressed"),gravity:this.const("s")},or.createElement(Pu,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("depressed"),onFileChange:e=>this.updateImage("depressed",e),readonly:()=>this.controller.isItemReadonly(this.id)},or.createElement(E5,{key:this.bindFn(this.depressedStatus)},()=>or.createElement("div",{class:or.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("depressed")})))),or.createElement(S5,{predicate:()=>!!this.model.clickableInfo.depressedImage},()=>or.createElement("div",{class:or.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("depressed"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-depressed-image"),role:or.const("button"),tabIndex:or.const(0)},or.createElement("i",{class:or.const("dcg-icon-remove"),"aria-hidden":or.const("true")}))),or.createElement("div",{role:or.const("heading"),"aria-level":or.const("2"),class:or.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-depressed"))))}hoveredStatus(){return this.hoveredUploading?"loading":"background"}depressedStatus(){return this.depressedUploading?"loading":"background"}tooltip(e){return(e==="hovered"?this.model.clickableInfo.hoveredImage:this.model.clickableInfo.depressedImage)?e==="depressed"?this.controller.s("graphing-calculator-label-change-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-change-hovered-image-tooltip"):e==="depressed"?this.controller.s("graphing-calculator-label-add-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-add-hovered-image-tooltip")}getImageURLForState(e){let t;if(e==="hovered"){if(this.hoveredStatus()!=="background")return"";t="hoveredImage"}else{if(this.depressedStatus()!=="background")return"";t="depressedImage"}let i=this.model.clickableInfo[t];return i?`url(${i})`:`url(${this.model.image_url})`}getStyleForState(e){let t={"background-image":this.getImageURLForState(e),opacity:1};return e==="hovered"&&!this.model.clickableInfo.hoveredImage&&(t.opacity=.5),t}removeImageState(e){e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:""}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:""})}updateImage(e,t){if(!t||!t[0])return;let i=t[0];e==="hovered"&&(this.hoveredUploading=!0),e==="depressed"&&(this.depressedUploading=!0),this.controller.getGraphSettings().config.imageUploadCallback(i,(n,o)=>{e==="hovered"&&(this.hoveredUploading=!1),e==="depressed"&&(this.depressedUploading=!1),!n&&o&&(e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:o}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:o}))})}};var{If:yk,IfDefined:KX,Textarea:UX}=oi.Components,Qf=class extends Xn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return oi.createElement("div",{class:oi.const("dcg-options-menu-section dcg-clickable-section")},oi.createElement("div",{class:oi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-clickable"),oi.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-make-clickable"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleClickable)})),oi.createElement(yk,{predicate:this.props.isOpen},()=>oi.createElement("div",{class:oi.const("dcg-options-menu-content")},oi.createElement("div",{class:oi.const("dcg-clickable-menu-row")},oi.createElement("span",{class:oi.const("dcg-input-label")},()=>this.controller.s("graphing-calculator-label-update-on-click")),oi.createElement(it,{latex:()=>this.model.clickableInfo.latex,placeholder:this.const(""),isFocused:()=>this.getFocusedInput()==="updaterule",capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),getAriaPostLabel:this.const(""),hasError:()=>this.hasError(),onUserChangedLatex:e=>this.dispatchUpdateRuleLatexIfChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:e=>this.handleFocusedChanged(e,"updaterule"),dataLabelAttributeValue:this.const("click-handler"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}),KX(()=>this.packedError(),e=>oi.createElement("span",{class:oi.const("dcg-clickable-info-error-container")},oi.createElement(ms,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),oi.createElement(yk,{predicate:this.bindFn(this.isList)},()=>oi.createElement("div",{class:oi.const("dcg-clickable-list-index-notice")},oi.createElement(Wi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-list-index")},oi.const("Use"),oi.const(" "),oi.createElement("span",{class:()=>({"dcg-index-variable-marker":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-mathquill-has-focus":this.getFocusedInput()==="updaterule","dcg-do-not-blur":!0}),onTap:this.bindFn(this.insertIndex)},oi.const("index")),oi.const(" "),oi.const("to reference the clicked index in the list.")))),oi.createElement(yk,{predicate:()=>this.model.type!=="image"},()=>oi.createElement(UX,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})})),oi.createElement(yk,{predicate:()=>this.model.type==="image"},()=>oi.createElement("div",{class:oi.const("dcg-clickable-menu-row")},oi.createElement(fk,{controller:()=>this.controller,model:()=>this.model}))))))}insertIndex(){this.controller.dispatch({type:"keypad/type-text",text:"index"})}isList(){return this.model.formula?!!this.model.formula.is_concrete_list:!1}hasError(){return this.packedError()!==void 0}packedError(){if(this.model.formula.click_handler&&this.model.formula.click_handler.status==="error")return this.model.formula.click_handler.error}toggleClickable(){this.controller.dispatch({type:"set-clickableinfo-prop",id:this.model.id,prop:"enabled",value:!this.model.clickableInfo.enabled}),this.model.clickableInfo.enabled&&this.handleFocusedChanged(!0,"updaterule")}dispatchUpdateRuleLatexIfChanged(e){this.model.clickableInfo.latex!==e&&this.controller.dispatch({type:"set-clickableinfo-rule-latex",id:this.id,latex:e})}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["index"]})}};var _i=__dcg_shared_module_exports__['h'](X());var Bu=__dcg_shared_module_exports__['h'](X());var Zf=class extends Xn{template(){return Bu.createElement("div",{class:Bu.const("dcg-iconed-mathquill-row dcg-point-opacity-row")},Bu.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Bu.createElement("i",{class:Bu.const("dcg-icon-opacity"),"aria-hidden":Bu.const("true")})),Bu.createElement(fr,{latex:()=>this.model.pointOpacity,placeholder:this.bindFn(this.getPointOpacityPlaceholder),isFocused:()=>this.getFocusedInput()==="pointopacity",ariaPostLabel:()=>this.isPointOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isPointOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchPointOpacityLatexIfChanged),dataLabelAttributeValue:this.const("point-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointopacity")}))}isPointOpacityValid(){return this.model.type==="expression"?gF(this.model):this.model.type==="table-column"?w2(this.model):!1}dispatchPointOpacityLatexIfChanged(e){this.model.pointOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointopacity",id:this.id,pointOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-pointopacity",columnId:this.model.id,tableId:this.model.table.id,pointOpacity:e}))}getPointOpacityPlaceholder(){return this.getDragMode()==="NONE"?`${.9}`:"1"}getDragMode(){return this.model.type==="expression"?rn(this.model)||this.model.dragMode:this.model.dragMode}};var{If:bk}=_i.Components,ey=class extends Xn{template(){return _i.createElement("div",{class:_i.const("dcg-options-menu-section")},_i.createElement("div",{class:_i.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),_i.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),_i.createElement(bk,{predicate:this.props.isOpen},()=>_i.createElement("div",{class:_i.const("dcg-options-menu-content")},_i.createElement("div",{class:_i.const("dcg-options-flex-container")},_i.createElement("div",{class:_i.const("dcg-options-left-side")},_i.createElement(Zf,__dcg_shared_module_exports__['a']({},this.props)),_i.createElement(bk,{predicate:()=>!this.isDraggable()},()=>_i.createElement("div",{class:_i.const("dcg-iconed-mathquill-row")},_i.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-tooltip"),gravity:this.const("se"),sticky:this.const(!0)},_i.createElement("i",{class:_i.const("dcg-icon-line-thickness"),"aria-hidden":_i.const("true")})),_i.createElement(fr,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})))),_i.createElement("div",{class:_i.const("dcg-options-right-side")},_i.createElement(bk,{predicate:()=>!this.isDraggable()},()=>_i.createElement(Rr,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),_i.createElement(bk,{predicate:this.props.isFirstOpenSection},()=>_i.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getPointStyleOptions(){return["POINT","OPEN","CROSS"].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.pointStyle===t,class:()=>"dcg-point-segmented-option",onSelect:()=>{this.onPointStyleSelected(t)}}))}getStyleIcon(e){switch(e){case"POINT":return"dcg-icon-point";case"OPEN":return"dcg-icon-open";case"CROSS":return"dcg-icon-cross"}}getStyleAria(e){let t=this.controller.s;switch(e){case"POINT":return t("graphing-calculator-narration-point-style-point");case"OPEN":return t("graphing-calculator-narration-point-style-open");case"CROSS":return t("graphing-calculator-narration-point-style-cross")}}isPointSizeValid(){return this.model.type==="expression"?kD(this.model):this.model.type==="table-column"?b2(this.model):!1}onPointStyleSelected(e){this.model.pointStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointstyle",id:this.id,pointStyle:e}):this.controller.dispatch({type:"set-tablecolumn-pointstyle",columnId:this.model.id,tableId:this.model.table.id,pointStyle:e}))}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e}):this.controller.dispatch({type:"set-tablecolumn-pointsize",columnId:this.model.id,tableId:this.model.table.id,pointSize:e}))}isDraggable(){return this.getDragMode()!=="NONE"}togglePointsVisible(){this.model.type==="expression"&&ta(this.model)?this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}):this.model.type==="expression"?this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-points",columnId:this.model.id,tableId:this.model.table.id,bool:!this.props.isOpen()})}getDragMode(){return this.model.type==="expression"?rn(this.model)||this.model.dragMode:this.model.dragMode}getDefaultPointSize(){return this.model.type==="expression"&&fu(this.model)?`${14}`:`${9}`}};var dr=__dcg_shared_module_exports__['h'](X());var Ls=__dcg_shared_module_exports__['h'](X());var{For:qX}=Ls.Components,zX=[{orientation:"default",cssClass:"dcg-label-orientation-center",description:"graphing-calculator-text-label-orientation-default"},{orientation:"above",cssClass:"dcg-label-orientation-above",description:"graphing-calculator-text-label-orientation-above"},{orientation:"above_right",cssClass:"dcg-label-orientation-above-right",description:"graphing-calculator-text-label-orientation-above-right"},{orientation:"right",cssClass:"dcg-label-orientation-right",description:"graphing-calculator-text-label-orientation-right"},{orientation:"below_right",cssClass:"dcg-label-orientation-below-right",description:"graphing-calculator-text-label-orientation-below-right"},{orientation:"below",cssClass:"dcg-label-orientation-below",description:"graphing-calculator-text-label-orientation-below"},{orientation:"below_left",cssClass:"dcg-label-orientation-below-left",description:"graphing-calculator-text-label-orientation-below-left"},{orientation:"left",cssClass:"dcg-label-orientation-left",description:"graphing-calculator-text-label-orientation-left"},{orientation:"above_left",cssClass:"dcg-label-orientation-above-left",description:"graphing-calculator-text-label-orientation-above-left"}],wk=class extends Ls.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Ls.createElement("div",{class:Ls.const("dcg-label-orientation-view"),style:()=>`transform: rotate(${this.getCSSRotationValue()});`},Ls.createElement("span",{class:Ls.const("dcg-vertical-orientation-indicator")}),Ls.createElement(qX,{each:()=>zX,key:e=>e.orientation},Ls.createElement("div",{class:Ls.const("dcg-label-orientations"),role:Ls.const("radiogroup"),"aria-label":()=>this.controller.s("graphing-calculator-heading-label-orientation")},e=>Ls.createElement("div",{class:()=>({[e.cssClass]:!0,"dcg-orientation-option":!0,"dcg-selected":this.isSelected(e.orientation),"dcg-orientation-disabled":this.isDisabled(e.orientation)}),role:Ls.const("radio"),tabindex:Ls.const("0"),"aria-label":()=>this.controller.s(e.description),"aria-checked":()=>this.getOrientation()===e.orientation,onTap:()=>this.onTapOrientation(e.orientation)},Ls.createElement("i",{class:()=>({"dcg-icon-chevron-left":e.orientation!=="default"})})))))}isDisabled(e){return e!=="default"?!1:this.isPointVisible()?!0:this.model.labelOrientation==="default"}isSelected(e){return e==="default"&&e===this.model.labelOrientation?!this.isPointVisible():e===this.model.labelOrientation}isPointVisible(){return this.model.hidden?!1:ta(this.model)?!this.model.hidden:this.model.points}getCSSRotationValue(){let e=bF(this.model);return`${Array.isArray(e)?0:e}rad`}getOrientation(){return this.props.model().labelOrientation}onTapOrientation(e){e===this.getOrientation()&&(e="default"),this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})}};var{If:ty}=dr.Components,xk=class extends Xn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return dr.createElement("div",{class:dr.const("dcg-options-menu-section")},dr.createElement("div",{class:dr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-label"),dr.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLabelVisible)})),dr.createElement(ty,{predicate:this.props.isOpen},()=>dr.createElement("div",{class:dr.const("dcg-options-menu-content")},dr.createElement("div",{class:dr.const("dcg-options-flex-container")},dr.createElement("div",{class:dr.const("dcg-options-left-side")},dr.createElement(ty,{predicate:this.props.isFirstOpenSection},()=>dr.createElement(Zf,__dcg_shared_module_exports__['a']({},this.props))),dr.createElement("div",{class:dr.const("dcg-iconed-mathquill-row dcg-label-size-row")},dr.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-label-size-tooltip"),sticky:this.const(!0),gravity:this.const("se")},dr.createElement("span",{class:dr.const("dcg-font-size")},dr.const("A"))),dr.createElement(fr,{latex:()=>this.model.labelSize,placeholder:()=>"1",isFocused:()=>this.getFocusedInput()==="labelsize",ariaPostLabel:()=>jT(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-size"),hasError:()=>!jT(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelSizeIfChanged),dataLabelAttributeValue:this.const("label-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelsize")})),dr.createElement("div",{class:()=>({"dcg-iconed-mathquill-row":!0,"dcg-label-angle-row":!0,"dcg-suffix-degree":this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":!this.props.controller().getGraphSettings().degreeMode})},dr.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-angle-tooltip"),sticky:this.const(!0)},dr.createElement("i",{class:dr.const("dcg-icon-angle"),"aria-hidden":dr.const("true")})),dr.createElement(fr,{latex:()=>this.model.labelAngle,placeholder:()=>"0",isFocused:()=>this.getFocusedInput()==="labelangle",ariaPostLabel:()=>JT(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-angle"),hasError:()=>!JT(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelAngleIfChanged),dataLabelAttributeValue:this.const("label-angle"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelangle")}))),dr.createElement("div",{class:dr.const("dcg-options-right-side")},dr.createElement(wk,{controller:()=>this.controller,model:()=>this.model}))),dr.createElement(ty,{predicate:this.props.isFirstOpenSection},()=>dr.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})),dr.createElement(ty,{predicate:()=>this.controller.canUseAdvancedStyling()},()=>dr.createElement("div",{class:dr.const("dcg-label-advanced")},dr.createElement(Gt,{checked:this.bindFn(this.getWhiteTextOutline),onChange:this.bindFn(this.setWhiteTextOutline),disabled:()=>this.getEditable()},()=>this.controller.s("graphing-calculator-button-label-text-outline")),dr.createElement("div",{role:dr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-advanced")},dr.createElement(ty,{predicate:()=>this.shouldShowHoverLabelCheckbox()},()=>dr.createElement(Gt,{checked:this.bindFn(this.getInteractiveLabel),onChange:this.bindFn(this.setInteractiveLabel)},()=>this.controller.s("graphing-calculator-button-label-show-on-hover"))),dr.createElement(ty,{predicate:this.bindFn(this.shouldShowEditableLabelToggle)},()=>dr.createElement(Gt,{checked:this.bindFn(this.getEditable),onChange:this.bindFn(this.setEditable)},()=>this.controller.s("graphing-calculator-button-label-editable")))))))))}getWhiteTextOutline(){return this.getEditable()?!1:!this.model.suppressTextOutline}setWhiteTextOutline(e){this.controller.dispatch({type:"set-suppress-text-outline",id:this.id,suppressTextOutline:!e})}setInteractiveLabel(e){this.controller.dispatch({type:"set-item-interactive-label",id:this.id,interactiveLabel:e})}getInteractiveLabel(){return!!this.model.interactiveLabel}setEditable(e){if(e){let t=__dcg_shared_module_exports__['_c'](this.model.label)==="latex"?"MATH":"TEXT";this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:t})}else this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:"NONE"})}getEditable(){return this.model.editableLabelMode!=="NONE"}shouldShowEditableLabelToggle(){return ta(this.model)}shouldShowHoverLabelCheckbox(){return rn(this.model)==="NONE"}dispatchLabelAngleIfChanged(e){this.model.labelAngle!==e&&this.controller.dispatch({type:"set-item-labelangle",id:this.id,labelAngle:e})}dispatchLabelSizeIfChanged(e){this.model.labelSize!==e&&this.controller.dispatch({type:"set-item-labelSize",id:this.id,labelSize:e})}toggleLabelVisible(){this.controller.dispatch({type:"set-item-showlabel",id:this.id,showLabel:!this.props.isOpen()})}};var xs=__dcg_shared_module_exports__['h'](X());var{If:$X,For:WX}=xs.Components,ry=class extends Xn{template(){return xs.createElement("div",{class:xs.const("dcg-options-menu-section")},xs.createElement("div",{class:xs.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-drag"),xs.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-drag-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleDragEnabled)})),xs.createElement($X,{predicate:this.props.isOpen},()=>xs.createElement("div",{class:xs.const("dcg-options-menu-content")},xs.createElement(WX,{each:()=>["X","Y","XY"]},xs.createElement("div",{class:xs.const("dcg-style-icons"),role:xs.const("radiogroup")},e=>xs.createElement("div",{class:()=>({"dcg-style-icon-container":!0,"dcg-disabled":this.isDisabled(e)}),onTap:()=>this.onDragModeSelected(e),role:xs.const("radio"),tabindex:()=>this.isDisabled(e)?-1:0,"aria-label":()=>e==="X"?this.controller.s("graphing-calculator-narration-drag-mode-x"):e==="Y"?this.controller.s("graphing-calculator-narration-drag-mode-y"):e==="XY"?this.controller.s("graphing-calculator-narration-drag-mode-xy"):this.controller.raw(""),"aria-checked":()=>this.getDragMode()===e},xs.createElement(Io,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getDragMode()!==e,iconType:()=>e==="X"?"movable-horizontal":e==="Y"?"movable-vertical":"movable-both"})))))))}isDisabled(e){let t=this.controller.getEnabledDragModesForItem(this.id);return!__dcg_shared_module_exports__['q'](t,e)}onDragModeSelected(e){if(this.model.type==="expression"){if(this.isDisabled(e))return;this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e})}else{let t=this.model.id,i=this.model.table.id;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:i,columnId:t,dragMode:e})}}getDragMode(){return this.model.type==="expression"?rn(this.model)||this.model.dragMode:this.model.dragMode}toggleDragEnabled(){let e=this.getDragMode()!=="NONE"?"NONE":"XY";this.model.type==="expression"?this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e}):this.onDragModeSelected(e)}};var Zo=__dcg_shared_module_exports__['h'](X());var{If:JX}=Zo.Components,vk=class extends Xn{template(){return Zo.createElement("div",{class:Zo.const("dcg-options-menu-section")},Zo.createElement("div",{class:Zo.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Zo.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Zo.createElement(JX,{predicate:()=>this.props.isOpen()},()=>Zo.createElement("div",{class:Zo.const("dcg-options-menu-content")},Zo.createElement("div",{class:Zo.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Zo.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-3d-tooltip"),gravity:this.const("se"),sticky:this.const(!0)},Zo.createElement("i",{class:Zo.const("dcg-icon-line-thickness"),"aria-hidden":Zo.const("true")})),Zo.createElement(fr,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})),Zo.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1,hideColorFunctions:()=>!0}))))}togglePointsVisible(){this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()})}isPointSizeValid(){return this.model.type==="expression"?kD(this.model):!1}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e})}getDefaultPointSize(){return`${3}`}};var Ln=__dcg_shared_module_exports__['h'](X());var{If:BL}=Ln.Components,Ck=class extends Xn{template(){return Ln.createElement("div",{class:Ln.const("dcg-options-menu-section")},Ln.createElement("div",{class:Ln.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),Ln.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),Ln.createElement(BL,{predicate:()=>this.props.isOpen()},()=>Ln.createElement("div",{class:Ln.const("dcg-options-menu-content")},Ln.createElement("div",{class:Ln.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Ln.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Ln.createElement("i",{class:Ln.const("dcg-icon-line-thickness"),"aria-hidden":Ln.const("true")})),Ln.createElement(fr,{latex:()=>this.model.lineWidth,placeholder:()=>`${1}`,isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")})),Ln.createElement(BL,{predicate:()=>this.model.latex.indexOf("segment")===-1&&!!Ai("beta3d")},()=>Ln.createElement("div",{style:Ln.const("font-size:85%; margin-top:8px; margin-bottom: 8px")},Ln.const("Resolution:"),Ln.createElement(fr,{latex:()=>this.model.resolution,placeholder:()=>`${__dcg_shared_module_exports__['rc']}`,isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),Ln.createElement(BL,{predicate:this.props.isFirstOpenSection},()=>Ln.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1})))))}toggleLinesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()})}isLineWidthValid(){return this.model.type==="expression"?GD(this.model):!1}isResolutionValid(){return this.model.type==="expression"?ID(this.model):!1}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e})}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}};var ln=__dcg_shared_module_exports__['h'](X());var{If:Wx}=ln.Components,Dk=class extends Xn{template(){return ln.createElement("div",{class:ln.const("dcg-options-menu-section")},ln.createElement("div",{class:ln.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-surfaces"),ln.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-surfaces-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleSurfacesVisible)})),ln.createElement(Wx,{predicate:()=>this.props.isOpen()},()=>ln.createElement("div",{style:ln.const("font-size:85%; margin-top:8px")},ln.createElement(Wx,{predicate:()=>!this.isTriangle3D()&&!!Ai("beta3d")},()=>ln.createElement("div",null,ln.const("Resolution:"),ln.createElement(fr,{latex:()=>this.model.resolution,placeholder:()=>this.getDefaultResolution(),isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),ln.createElement(Wx,{predicate:()=>this.model.colorLatex==="checkers"},()=>ln.createElement("div",null,ln.const("Checkers:"),ln.createElement(fr,{latex:()=>this.model.checkers,placeholder:()=>`${__dcg_shared_module_exports__['pc']}`,isFocused:()=>this.getFocusedInput()==="checkers",ariaPostLabel:()=>this.isCheckersValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-checkers"),hasError:()=>!this.isCheckersValid(),handleLatexChanged:this.bindFn(this.dispatchCheckersLatexIfChanged),dataLabelAttributeValue:this.const("checkers"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"checkers")}))),ln.createElement(Wx,{predicate:this.props.isFirstOpenSection},()=>ln.createElement("div",{class:ln.const("dcg-options-menu-content"),style:ln.const("margin-top:8px")},ln.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1,canUsePatterns:()=>!this.isTriangle3D()}))),ln.createElement(Wx,{predicate:()=>xD(this.model)&&!!Ai("beta3d")},()=>ln.createElement("div",{style:ln.const("margin-top:8px")},ln.createElement(Rr,{staticConfig:this.bindFn(this.get3dPolarOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-dimension"),theme:this.const("mini")}))))))}toggleSurfacesVisible(){this.controller.dispatch({type:"set-item-surfaces",id:this.id,surfaces:!this.props.isOpen()})}isTriangle3D(){return wD(this.model)}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}dispatchCheckersLatexIfChanged(e){this.model.checkers!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-checkers",id:this.id,checkers:e})}isCheckersValid(){return this.model.type==="expression"?mF(this.model):!1}isResolutionValid(){return this.model.type==="expression"?ID(this.model):!1}getDefaultResolution(){if(this.model.type==="expression"){if(this.model.formula.graphMode3d===117)return`${40}`;if(oF(this.model))return`${__dcg_shared_module_exports__['qc']}`}return`${__dcg_shared_module_exports__['oc']}`}get3dPolarOptions(){return["Cylindrical","Spherical"].map(t=>({key:t,label:()=>t,selected:()=>this.isPolarCoordinateSystemSelected(t),onSelect:()=>{this.on3dOptionSelected(t)}}))}isPolarCoordinateSystemSelected(e){return"polarCoordinateSystem"in this.model?this.model.polarCoordinateSystem==e:!1}on3dOptionSelected(e){if("polarCoordinateSystem"in this.model){if(this.model.polarCoordinateSystem===e)return;this.model.type==="expression"&&this.controller.dispatch({type:"set-item-polar-coordinate-system",id:this.id,polarCoordinateSystem:e})}}};var{For:ZX,If:eQ}=fo.Components,iy=class extends fo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this.props.registerRepositionCb(this.bindFn(this.renderOffset))}template(){return fo.createElement("div",{class:()=>({"dcg-expressions-options-menu":!0,"dcg-options-menu":!0}),role:fo.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),didMount:this.bindFn(this.didMountContainer)},fo.createElement(ZX,{each:this.bindFn(this.getSections)},fo.createElement("div",null,e=>{switch(e){case"points":return fo.createElement(ey,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")}));case"label":return fo.createElement(xk,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("label"),isFirstOpenSection:()=>this.isFirstOpenSection("label")}));case"drag":return fo.createElement(ry,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")}));case"lines":return fo.createElement(Xf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")}));case"fill":return fo.createElement(mk,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("fill"),isFirstOpenSection:()=>this.isFirstOpenSection("fill")}));case"colors-only":return fo.createElement(gk,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:this.const(!0),isFirstOpenSection:this.const(!0)}));case"points3d":return fo.createElement(vk,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")}));case"lines3d":return fo.createElement(Ck,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("lines3d"),isFirstOpenSection:()=>this.isFirstOpenSection("lines3d")}));case"surfaces":return fo.createElement(Dk,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("surfaces"),isFirstOpenSection:()=>this.isFirstOpenSection("surfaces")}))}})),fo.createElement(eQ,{predicate:this.bindFn(this.isClickable)},()=>fo.createElement(Qf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>!!this.model.clickableInfo.enabled,isFirstOpenSection:this.const(!1)}))),fo.createElement("div",{class:fo.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow)}))}willUnmount(){xe(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMountContainer(e){this.containerElt=e,xe(this.controller.s("graphing-calculator-narration-options-menu-open"))}didMountArrow(e){this.arrowElt=e}renderOffset(e){if(!this.containerElt||!this.arrowElt)return;let t=this.containerElt.offsetHeight,i=0;t>e&&(i=+e-t);let n=-i<t-38;this.containerElt.style.marginTop=`${i}px`,this.arrowElt.style.marginTop=`${-i}px`,this.arrowElt.style.display=n?"":"none"}isClickable(){return this.controller.areActionsEnabled()&&YT(this.model)&&!this.controller.isItemReadonly(this.model.id)}getSections(){if(this.controller.isThreeDMode()){if(bD(this.model))return["points3d"];if(UT(this.model))return["lines3d"];if(sF(this.model)||xD(this.model))return["surfaces","lines3d"];if(HT(this.model))return["surfaces"];if(mu(this.model))return["lines3d"];if(ta(this.model))return["points3d"];if(qT(this.model))return["points3d","lines"]}return Nh(this.model)||Sp(this.model)||Vm(this.model)||cF(this.model)||Dp(this.model)?["colors-only"]:Ep(this.model)?["lines"]:fu(this.model)?["points"]:qT(this.model)?["points","label","lines"]:ta(this.model)?this.model.formula.move_strategy&&!this.controller.isThreeDMode()?["points","label","drag"]:["points","label"]:mu(this.model)||yd(this.model)?["lines","fill"]:bd(this.model)?Cp(this.model)||Tm(this.model)||Ra(this.model)?["lines"]:["lines","fill"]:["lines"]}isFirstOpenSection(e){let t=this.getSections();for(let i of t){if(i===e)return this.isSectionOpen(e);if(this.isSectionOpen(i))return!1}return!1}isSectionOpen(e){let{points:t,lines:i,fill:n,surfaces:o}=this.model,s=__dcg_shared_module_exports__['yc'](this.model.formula.expression_type,{points:t,lines:i,fill:n,surfaces:o});switch(e){case"lines":return this.model.hidden?!1:s.lines;case"label":return Cc(this.model);case"fill":return this.model.hidden?!1:bd(this.model)?!0:s.fill;case"points":return this.model.hidden?!1:ta(this.model)?!this.model.hidden:s.points;case"drag":return rn(this.model)!=="NONE";case"colors-only":return!0;case"points3d":return this.model.hidden?!1:s.surfaces;case"lines3d":return this.model.hidden?!1:s.lines;case"surfaces":return this.model.hidden?!1:s.surfaces}}};var cn=__dcg_shared_module_exports__['h'](X());var ka=__dcg_shared_module_exports__['h'](X());var{Input:tQ}=ka.Components,Sk=class extends ka.Class{init(){this.controller=this.props.controller(),this.cacheFolderList(),this.newFolderTitle=""}willUpdate(){this.cacheFolderList()}template(){return ka.createElement("div",{class:ka.const("dcg-move-to-folder")},ka.createElement("div",{class:ka.const("dcg-move-to-folder-title")},this.bindFn(this.getMoveMessage)),ka.createElement("div",{class:ka.const("dcg-move-to-folder-flex")},ka.createElement(tQ,{"aria-label":this.bindFn(this.getMoveMessage),value:()=>this.newFolderTitle,onInput:e=>{this.newFolderTitle=e,this.update()},placeholder:()=>this.controller.s("graphing-calculator-label-geometry-move-to-folder-placeholder"),didMount:e=>{e.onkeydown=function(t){let i=Re(t);(i==="Backspace"||i==="Del")&&t.stopPropagation()}},onEnterPressed:this.bindFn(this.onEnterPressed)}),ka.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.newFolderTitle}),role:ka.const("button"),tabindex:()=>this.newFolderTitle?0:-1,onTap:this.bindFn(this.createNewFolder)},()=>this.controller.s("graphing-calculator-button-move-to-folder-action"))))}getMoveMessage(){let e=new uo(this.controller.getAllSelectedItems().length);return this.controller.s("graphing-calculator-text-geometry-move-to-folder-message",{count:e})}onEnterPressed(){let e=!1;this.folderList.forEach(t=>{t.title===this.newFolderTitle&&(e=!0,this.chooseFolder(t.id))}),e||this.createNewFolder()}chooseFolder(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:e}})}createNewFolder(){this.newFolderTitle&&this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:this.newFolderTitle,createFolder:!0}})}cacheFolderList(){this.folderList=[],this.controller.getAllItemModels().forEach(e=>{e.type==="folder"&&!this.controller.isGeoFolder(e)&&this.folderList.push(e)})}};var kk=__dcg_shared_module_exports__['h'](X());var Ek=class extends kk.Class{init(){this.controller=this.props.controller(),this.cacheSelectedColor()}template(){return kk.createElement(Qo,{controller:this.props.controller,colorLatex:()=>this.colorLatex,selectedColor:()=>this.selectedColor,onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:this.const(!1)})}onCustomColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"colorLatex",value:e}})}cacheSelectedColor(){let e=__dcg_shared_module_exports__['n'](this.controller.getAllSelectedItems(),t=>t.type==="expression");if(e.length===0){this.selectedColor="",this.colorLatex="";return}this.selectedColor=kc(e[0]),this.colorLatex=e[0].colorLatex;for(let t=1;t<e.length;t++)if(this.selectedColor!==kc(e[t])||this.colorLatex!==e[t].colorLatex){this.selectedColor="",this.colorLatex="";return}}willUpdate(){this.cacheSelectedColor()}onColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"color",value:e}})}getFirstSelectedExpression(){var e=this.controller.getAllSelectedItems();for(let t of e)if(t.type==="expression")return t}};var{If:jx}=cn.Components,Gk=class extends cn.Class{init(){this.controller=this.props.controller(),this.cacheSectionValues()}willUpdate(){this.cacheSectionValues()}template(){return cn.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-options-menu":!0}),role:cn.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},cn.createElement("div",{class:cn.const("dcg-options-menu-section")},cn.createElement("div",{class:cn.const("dcg-multi-select-color-picker")},cn.createElement(Ek,{controller:this.props.controller})),cn.createElement(jx,{predicate:()=>this.sectionValues.showPointLabels!==void 0},()=>cn.createElement("div",{class:cn.const("dcg-checkbox-section")},cn.createElement(Gt,{checked:()=>!!this.sectionValues.showPointLabels,onChange:this.bindFn(this.onShowPointLabelChanged)},()=>this.controller.s("graphing-calculator-button-geometry-label-points-checkbox")))),cn.createElement(jx,{predicate:()=>this.sectionValues.singleLabelableExpressionModel!==void 0},()=>cn.createElement("div",{class:cn.const("dcg-checkbox-section")},cn.createElement(yg,{controller:this.props.controller,model:()=>this.sectionValues.singleLabelableExpressionModel,useSmartPointLabeling:()=>this.sectionValues.draggableFreePoint!==void 0}))),cn.createElement(jx,{predicate:()=>this.sectionValues.draggableFreePoint!==void 0},()=>cn.createElement("div",{class:cn.const("dcg-checkbox-section")},cn.createElement(Gt,{checked:()=>!!this.sectionValues.draggableFreePoint,onChange:this.bindFn(this.onDraggableFreePointChanged)},()=>this.controller.s("graphing-calculator-button-draggable")))),cn.createElement(jx,{predicate:()=>this.sectionValues.arrowMode!==void 0},()=>cn.createElement("div",null,()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()}))),cn.createElement(jx,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>cn.createElement(Sk,{controller:this.props.controller}))))}onShowPointLabelChanged(){this.controller.dispatch({type:"toggle-label-for-all-selected-points"})}onDraggableFreePointChanged(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"dragMode",value:e?"AUTO":"NONE"}})}cacheSectionValues(){this.sectionValues=this.computeSectionValues()}computeSectionValues(){var o;let e={showPointLabels:[],singleLabelableExpressionModel:[],draggableFreePoint:[],arrowMode:[]},t=this.controller.getAllSelectedItems();for(let s of t){if(s.type!=="expression")return{};let a=(o=s.formula.geometry)==null?void 0:o.valueType;if(a===void 0)return{};if(__dcg_shared_module_exports__['vb'](a)&&(a=__dcg_shared_module_exports__['wb'](a)),!__dcg_shared_module_exports__['xb'](a))return{};switch(a){case __dcg_shared_module_exports__['Ra']:e.showPointLabels.push(s.showLabel),e.singleLabelableExpressionModel.push(s),s.formula.move_strategy&&e.draggableFreePoint.push(s.dragMode!=="NONE");break;case __dcg_shared_module_exports__['Za']:break;case __dcg_shared_module_exports__['db']:e.arrowMode.push(s.arrowMode);break;case __dcg_shared_module_exports__['bb']:break;case __dcg_shared_module_exports__['fb']:break;case __dcg_shared_module_exports__['hb']:break;case __dcg_shared_module_exports__['pb']:break;case __dcg_shared_module_exports__['$a']:e.singleLabelableExpressionModel.push(s),e.arrowMode.push(s.arrowMode);break;case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['lb']:e.singleLabelableExpressionModel.push(s);break;case __dcg_shared_module_exports__['nb']:break;default:return a}}let i={},n=t.length;for(let s in e){let a=s;switch(a){case"singleLabelableExpressionModel":{let c=e[a];n===1&&c.length===1&&(i[a]=c[0])}break;case"showPointLabels":{let c=e[a];c.length>0&&n>1&&(i[a]=__dcg_shared_module_exports__['o'](c,u=>!!u))}break;case"draggableFreePoint":{let c=e[a];c.length>0&&(i[a]=__dcg_shared_module_exports__['p'](c))}break;case"arrowMode":break;default:return a}}return i}getArrowModeDisplayName(){let e=this.sectionValues.arrowMode;if(!e)return"";switch(e){case"NONE":return this.controller.s("graphing-calculator-text-arrow-mode-none");case"DEFAULT":return this.controller.s("graphing-calculator-text-arrow-mode-default");case"POSITIVE":return this.controller.s("graphing-calculator-text-arrow-mode-positive");case"BOTH":return this.controller.s("graphing-calculator-text-arrow-mode-both")}}willUnmount(){xe(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMount(){xe(this.controller.s("graphing-calculator-narration-options-menu-open"))}};var Rn=__dcg_shared_module_exports__['h'](X());var kr=__dcg_shared_module_exports__['h'](X());var WL={};__dcg_shared_module_exports__['g'](WL,{CLCalculator:()=>k5,Label:()=>__dcg_shared_module_exports__['Mb'],applyDiff:()=>M5,applyLocalizationMap:()=>O5,blankGeometryCalculatorState:()=>GQ,blankGraphingCalculatorState:()=>kQ,builtInFrame:()=>DQ,calculateDiff:()=>V5,colorHelpers:()=>__dcg_shared_module_exports__['U'],context:()=>CQ,expressionParser:()=>$L,extractLocalizationMap:()=>L5,formatLatex:()=>F5,migrateToLatest:()=>Uc,numberToDecimalString:()=>__dcg_shared_module_exports__['lc'],numberToLatex:()=>__dcg_shared_module_exports__['kc'],parseNodes:()=>N5,parser:()=>xQ,policies:()=>EQ,replaceIdentifierWithLatex:()=>DT,treeQueries:()=>vQ,types:()=>SQ});function k5(r){let e=Uc(r);var t={},i=e.graph.degreeMode,n=e.randomSeed;let o=e.graph.product==="graphing"?"graphing":"geometry";function s(l){switch(l.type){case void 0:case"expression":{let u=__dcg_shared_module_exports__['Sc'](__dcg_shared_module_exports__['Oc'](l));t[u.id]=u}break;case"table":{let u=mS(gS(l));t[u.id]=u}break;case"folder":case"text":case"image":break;default:return l}}for(var a of e.expressions.list)s(a);return{setExpression(l){s(l)},getChangeSet(){return{statements:t,isCompleteState:!0,degreeMode:i,globalRandomSeed:n,evaluationMode:o}}}}function ny(r,e){switch(r.type){case"Mul":case"DotMul":case"CrossMul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Dot":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"Paren":case"Juxt":case"Superscript":case"Bang":case"Index":case"Equals":case"Inequality":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":case"RightArrow":case"For":case"With":{let i=0;for(let n of r.args)i+=ny(n,e);return i}case"Decimal":return e===void 0||parseFloat(r.val)===e?1:0;case"MixedNumber":{if(e===void 0)return 3;let i=0;return parseFloat(r.whole)===e&&(i+=1),parseFloat(r.num)===e&&(i+=1),parseFloat(r.den)===e&&(i+=1),i}case"Letter":case"EmptyPiecewise":case"Cmd":case"EmptyRangeEnd":return 0;case"Subscript":return ny(r.args[0],e);case"InequalityChain":{let i=0;i+=ny(r.first,e);for(let n of r.chain)i+=ny(n.args[0],e);return i}default:throw`Unexpected surface node ${r.type}.`}}function G5(r){let e=r.length,t=new Array(e),i=new Array(e+1),n=0;for(let a=0;a<e;a++){let l;if(r[i[n]]<r[a])l=n+1;else{let c=1,u=n-1;for(;c<=u;){let p=Math.ceil((c+u)/2);r[i[p]]<r[a]?c=p+1:u=p-1}l=c}t[a]=i[l-1],i[l]=a,l>n&&(n=l)}let o=new Array(n),s=i[n];for(let a=n-1;a>=0;a--)o[a]=r[s],s=t[s];return o}function V5(r,e){return Ik(r,e,0)}function Ik(r,e,t){let i={};for(let n in r){if(!r.hasOwnProperty(n))continue;if(!e.hasOwnProperty(n)){i[n]={d:1};continue}let o=r[n],s=e[n],a=rQ(o,s,t,n);a&&(i[n]=a)}for(let n in e)e.hasOwnProperty(n)&&!r.hasOwnProperty(n)&&(i[n]={s:e[n]});return i}function rQ(r,e,t,i){if(__dcg_shared_module_exports__['I'](r)&&__dcg_shared_module_exports__['I'](e)){if(t===1&&i==="list"||t===2&&i==="columns")return nQ(r,e);if(!__dcg_shared_module_exports__['G'](r,e))return{s:e}}else if(__dcg_shared_module_exports__['J'](r)&&__dcg_shared_module_exports__['J'](e)){let n=Ik(r,e,iQ(t,i));if(!__dcg_shared_module_exports__['H'](n))return{e:n}}else if(!__dcg_shared_module_exports__['G'](r,e))return{s:e}}function iQ(r,e){return r===0&&e==="expressions"?1:3}function nQ(r,e){let t={},i={};for(let a=0;a<r.length;a++){if(i[r[a].id]!==void 0)return{s:e};i[r[a].id]=a}let n={};for(let a=0;a<e.length;a++){if(n[e[a].id]!==void 0)return{s:e};n[e[a].id]=a}let o=oQ(r,e,i),s=0;for(let a=0;a<r.length;a++){let l=r[a];if(!o[l.id])t[a]={d:1};else{let c=n[l.id],u=e[c],p={};if(s!==c&&(p.a=e.slice(s,c).map(g=>I5(r,i,g))),!__dcg_shared_module_exports__['G'](l,u)){let g=l.type==="table"&&u.type==="table";p.e=Ik(l,u,g?2:3)}__dcg_shared_module_exports__['H'](p)||(t[a]=p),s=c+1}}if(s<e.length&&(t[r.length]={a:e.slice(s,e.length).map(a=>I5(r,i,a))}),!__dcg_shared_module_exports__['H'](t))return{l:t}}function I5(r,e,t){if(e[t.id]){let i=r[e[t.id]],n={f:e[t.id]};return __dcg_shared_module_exports__['G'](i,t)||(n.e=Ik(i,t,3)),{m:n}}return{s:t}}function oQ(r,e,t){let i={},n=e.filter(s=>t[s.id]!==void 0).map(s=>t[s.id]),o=G5(n);for(let s of o)i[r[s].id]=!0;return i}function M5(r,e){let t=__dcg_shared_module_exports__['j'](r);return Vk(t,e)}function Vk(r,e){for(let t of __dcg_shared_module_exports__['D'](e)){let i=e[t];aQ(i)?r[t]=i.s:lQ(i)?delete r[t]:cQ(i)?r[t]=sQ(r[t],i.l):dQ(i)&&(r[t]=Vk(r[t],i.e))}return r}function sQ(r,e){let t=[];for(let n=0;n<r.length;n++){let o=e[n];o&&o.a&&t.push(...T5(r,o.a)),o&&o.e?t.push(Vk(r[n],o.e)):(!o||!o.d)&&t.push(r[n])}let i=e[r.length];return i&&i.a&&t.push(...T5(r,i.a)),t}function T5(r,e){let t=[];for(let i of e)if(uQ(i))t.push(i.s);else if(pQ(i)){let n=r[i.m.f];i.m.e?t.push(Vk(n,i.m.e)):t.push(n)}return t}function aQ(r){return r.hasOwnProperty("s")}function lQ(r){return r.hasOwnProperty("d")}function cQ(r){return r.hasOwnProperty("l")}function dQ(r){return r.hasOwnProperty("e")}function uQ(r){return r.hasOwnProperty("s")}function pQ(r){return r.hasOwnProperty("m")}function A5(r){return r.location==="expression"||r.location==="object"?`${r.location}:${r.id}:${r.path}`:`${r.location}:${r.path}`}function KL(r){let e=()=>new Error(`Invalid key: ${r}`),t=r.split(":"),i=t[0];if(!i||i!="expression"&&i!="settings"&&i!="object")throw e();if(i=="settings"){if(t.length!=2)throw e();return{location:i,path:t[1]}}if(t.length!=3)throw e();return{location:i,id:t[1],path:t[2]}}function Tk(r,e,t){if(!r)return;let i=e.split("."),n=r;for(let o=0;o<i.length;o++){let s=i[o];if(!n[s])break;o==i.length-1&&typeof n[s]=="string"?n[s]=t:n=n[s]}}function UL(r,e){return(t,i,n,o)=>{if(t){let s=A5(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{path:i}));r[s]={value:t,type:n,context:o}}}}function hQ(r){var i,n;let e={},t=UL(e,{location:"expression",id:r.id});switch(r.type){case"expression":t(r.label,"label","interpolated-string","expression-list-expression-label"),t(r.description,"description","string","expression-list-expression-clickable-description");break;case"image":t(r.image_url,"image_url","image","expression-list-image-url"),t(r.description,"description","string","expression-list-image-clickable-description"),t((i=r.clickableInfo)==null?void 0:i.hoveredImage,"clickableInfo.hoveredImage","image","expression-list-image-clickable-hovered"),t((n=r.clickableInfo)==null?void 0:n.depressedImage,"clickableInfo.depressedImage","image","expression-list-image-clickable-depressed");break;case"text":t(r.text,"text","string","expression-list-note-text");break;case"folder":t(r.title,"title","string","expression-list-folder-title");break}return e}function gQ(r){let e={},t=UL(e,{location:"settings"});return t(r.graph.xAxisLabel,"xAxisLabel","string","settings-xaxis-label"),t(r.graph.yAxisLabel,"yAxisLabel","string","settings-yaxis-label"),e}function mQ(r){let e={},t=UL(e,{location:"object",id:r.id});return t(r.label,"label","string","geometry-object-label"),r.type==="image"&&t(r.url,"url","image","geometry-object-image-url"),e}function L5(r){let e={};if(r.type=="graph"){let t=r.graphState.expressions.list;for(let n of t){let o=hQ(n);for(let s in o)e[s]=o[s]}let i=gQ(r.graphState);for(let n in i)e[n]=i[n]}else{let t=r.geometryState.objects;for(let i in t){let n=mQ(t[i]);for(let o in n)e[o]=n[o]}}return e}function O5(r,e,t){var n;let i=__dcg_shared_module_exports__['j'](r);if(t==="graph"){let o={},s=(n=i.expressions)==null?void 0:n.list,a=Array.isArray(s)?s:[];for(let l of a)o[l.id]=l;for(let l in e){let c=KL(l);c.location=="expression"?Tk(o[c.id],c.path,e[l].value):Tk(i.graph,c.path,e[l].value)}}else if(i.objects)for(let o in e){let s=KL(o);s.location=="object"&&Tk(i.objects[s.id],s.path,e[o].value)}return i}function si(r){switch(r.type){case"Equals":return es(r.args,"=");case"Inequality":let e=r.symbol==="<="?"\\le":r.symbol===">="?"\\ge":r.symbol;return es(r.args,e);case"InequalityChain":return si(r.first)+r.chain.map(si).join("");case"TrailingInequalityPiece":return r.symbol+si(r.args[0]);case"Tilde":return es(r.args,"~");case"Pos":return"+"+si(r.args[0]);case"Neg":return"-"+si(r.args[0]);case"Add":return es(r.args,"+");case"Sub":return es(r.args,"-");case"Mul":return es(r.args,"*");case"DotMul":return es(r.args,"\\cdot ");case"CrossMul":return es(r.args,"\\times ");case"Div":return es(r.args,"/");case"Bang":return si(r.args[0])+"!";case"Call":let t=qL(r.args);return t?t.script+"\\left("+t.arg+"\\right)":si(r.args[0])+"\\left("+si(r.args[1])+"\\right)";case"Paren":return"\\left("+si(r.args[0])+"\\right)";case"List":return"\\left["+r.args.map(si).join(",")+"\\right]";case"Pipes":return"\\left|"+si(r.args[0])+"\\right|";case"Index":return si(r.args[0])+"\\left["+si(r.args[1])+"\\right]";case"Subscript":return es(r.args,"_",!0);case"Superscript":return es(r.args,"^",!0);case"Prime":if(r.args[0].type==="Call"){let s=qL(r.args[0].args);return s?s.script+HL(r.nprimes)+"\\left("+s.arg+"\\right)":si(r.args[0].args[0])+HL(r.nprimes)+"\\left("+si(r.args[0].args[1])+"\\right)"}return si(r.args[0])+HL(r.nprimes);case"Seq":return r.args.map(si).join(",");case"Sqrt":return"\\sqrt"+Jx(si(r.args[0]));case"Nthroot":return"\\sqrt["+si(r.args[0])+"]"+Jx(si(r.args[1]));case"Frac":return"\\frac{"+si(r.args[0])+"}{"+si(r.args[1])+"}";case"Derivative":return"\\frac{d}{d"+si(r.args[0])+"}"+si(r.args[1]);case"Integral":case"EmptyIntegral":if(r.args[0].type!=="Cmd")throw new Error("Expected first argument of an integral to be the variable");let i="d"+r.args[0].val;if(r.args.length===3)return Yx("int",r.args[1],r.args[2])+i;let n=si(r.args[3]);return Yx("int",r.args[1],r.args[2])+n+i;case"Sum":return P5(r.args,"sum");case"Product":return P5(r.args,"prod");case"Piecewise":return"\\{"+si(r.args[0])+"\\}";case"EmptyPiecewise":return"\\{\\}";case"Colon":return es(r.args,":");case"Ellipsis":return es(r.args,"...");case"For":return es(r.args,"\\for ");case"With":return es(r.args,"\\with ");case"Dot":return es(r.args,".");case"PercentOf":return es(r.args,"\\% \\of ");case"RightArrow":return es(r.args,"->");case"Juxt":return es(r.args,r.args[0].type==="Cmd"?" ":"");case"ImplicitCall":{let s=qL(r.args);return s?s.script+s.arg:es(r.args,"")}case"MixedNumber":return r.whole+"\\frac{"+r.num+"}{"+r.den+"}";case"Letter":case"Decimal":case"Alphanumeric":return r.val;case"Cmd":return"\\"+r.val;case"EmptyRangeEnd":return"EmptyRangeEnd";case"Err":throw r.error;default:return r}}function Jx(r){return r.length>1?"{"+r+"}":r}function Yx(r,e,t){let i=Jx(si(e));if(t){let n=Jx(si(t));return`\\${r}_${i}^${n}`}return`\\${r}_${i}`}function es(r,e,t=!1){let i=si(r[0]),n=t?Jx(si(r[1])):si(r[1]);return i+e+n}function P5(r,e){let t=si(r[0]);return Yx(e,r[1],r[2])+t}function HL(r){let e="";for(let t=0;t<r;t++)e+="'";return e}function _5(r){return r.type==="Cmd"&&r.val==="logbase"}function qL(r){let e=r[1],t;if(r[1].type==="Seq"&&r[1].args.length===2&&(e=r[1].args[1],t=r[1].args[0]),r[0].type==="Superscript"&&_5(r[0].args[0]))return{script:Yx("log",e,r[0].args[1]),arg:t?si(t):""};if(_5(r[0]))return{script:Yx("log",e),arg:t?si(t):""}}function F5(r){let e=$L.parse(r.latex);if(e.type=="Err")return;let t=ts(e);for(;t.type==="Paren";)t=t.args[0];return Kd(t)?{latex:r.latex}:{latex:si(t)}}function fQ(r){return r.isPseudoSurfaceNode}function Kd(r){switch(r.type){case"Letter":case"Decimal":case"Cmd":return r.val==="0";case"Paren":return Kd(r.args[0]);default:return!1}}function Jp(r){switch(r.type){case"Letter":case"Decimal":case"Cmd":return r.val==="1";case"Paren":return Jp(r.args[0]);default:return!1}}function R5(r){return r.type==="Neg"?Jp(r.args[0]):r.type==="Paren"?R5(r.args[0]):!1}function Mk(r){return{isPseudoSurfaceNode:!0,type:"Decimal",span:r,val:"0"}}function zL(r,e){return{isPseudoSurfaceNode:!0,type:"Neg",span:e,args:[r]}}function yQ(r,e){return{isPseudoSurfaceNode:!0,type:"Paren",span:e,args:[r]}}function Ya(r,e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{span:e})}function ts(r,e){let t;switch(r.type){case"Add":{let o=ts(r.args[0]),s=ts(r.args[1]);if(Kd(o))return Ya(s,r.span);if(Kd(s))return Ya(o,r.span);let a;if(s.type==="Neg"?a=ts(s.args[0]):s.type==="Paren"&&s.args[0].type==="Neg"&&(a=ts(s.args[0].args[0])),a!==void 0)return{isPseudoSurfaceNode:!0,type:"Sub",span:r.span,args:[o,a]};t=[o,s];break}case"Sub":{let o=ts(r.args[0]),s=ts(r.args[1]);if(Kd(o))return zL(s,r.span);if(Kd(s))return Ya(o,r.span);let a;if(s.type==="Neg"?a=s.args[0]:s.type==="Paren"&&s.args[0].type==="Neg"&&(a=s.args[0].args[0]),a)return{isPseudoSurfaceNode:!0,type:"Add",span:r.span,args:[o,a]};t=[o,s];break}case"Mul":{let o=ts(r.args[0]),s=ts(r.args[1]);if(Jp(o))return Ya(s,r.span);if(Jp(s))return Ya(o,r.span);if(Kd(o)||Kd(s))return Mk(r.span);t=[o,s];break}case"Juxt":{let o=ts(r.args[0],r),s=ts(r.args[1],r);if(Jp(o))return Ya(s,r.span);if(Jp(s))return Ya(o,r.span);if(R5(o))return zL(s,r.span);if(Kd(o)||Kd(s))return Mk(r.span);if(o.type==="Neg"){let a=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{type:"Juxt",isPseudoSurfaceNode:!0,args:[o.args[0],s]});return zL(a,r.span)}t=[o,s];break}case"Frac":case"Div":{let o=ts(r.args[0]),s=ts(r.args[1]);if(Jp(s))return Ya(o,r.span);t=[o,s];break}case"Superscript":let i=ts(r.args[0]),n=ts(r.args[1]);if(Jp(n))return Ya(i,r.span);(e==null?void 0:e.type)==="Juxt"&&e.args[0].type==="Decimal"&&i.type==="Decimal"&&(i=yQ(i,i.span)),t=[i,n];break;case"Paren":{let o=ts(r.args[0]);if((e==null?void 0:e.type)!=="Juxt"){if(__dcg_shared_module_exports__['ac'](o))return Ya(o,r.span);let s="args"in o?o.args:void 0;if((!s||s.length<=1)&&o.type!=="Neg")return Ya(o,r.span)}t=[o];break}case"Pos":{let o=ts(r.args[0]);return Ya(o,r.span)}case"Neg":{let o=ts(r.args[0]),s="args"in o?o.args[0]:void 0;if(o.type==="Paren"&&s&&s.type==="Neg"&&s.args[0])return Ya(ts(s.args[0]),r.span);if(o.type==="Neg"&&s)return Ya(s,r.span);t=[o];break}case"Cmd":case"Letter":case"Decimal":case"MixedNumber":case"EmptyRangeEnd":case"EmptyPiecewise":case"InequalityChain":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{isPseudoSurfaceNode:!0});default:t=r.args.map(o=>fQ(o)?o:o.type==="Alphanumeric"?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{isPseudoSurfaceNode:!0}):ts(o))}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{isPseudoSurfaceNode:!0,args:t})}function bQ(r,e){return r==null&&(r=""),__dcg_shared_module_exports__['gc'](r,e)}function wQ(r){if(r!=null)try{let e=__dcg_shared_module_exports__['$b'](r);return __dcg_shared_module_exports__['fc'](e)}catch(e){let t=e instanceof N5.Base?e.getInputSpan():void 0;t||(t=__dcg_shared_module_exports__['Na'](r,0,r.length));let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},__dcg_shared_module_exports__['cc']()),{originalError:e});return __dcg_shared_module_exports__['bc'](t,i)}}var xQ={parse:bQ},$L={parse:wQ},vQ={countNumbers:ny},CQ=__dcg_shared_module_exports__['cd'],DQ=__dcg_shared_module_exports__['Nb'],SQ=__dcg_shared_module_exports__['Ab'],N5=__dcg_shared_module_exports__['Qb'],EQ={graphing:new __dcg_shared_module_exports__['nc']({enableGeometry:!1,enable3d:!0,beta3d:!0,scales:void 0}),scientific:new __dcg_shared_module_exports__['bd']({singleExpression:!1}),fourFunction:new __dcg_shared_module_exports__['ad']({singleExpression:!1})},kQ=Ff,GQ=Uf;var{Switch:B5}=kr.Components,Ud=class extends kr.Class{template(){return kr.createElement(B5,{key:()=>this.getLatex().indexOf("\\token")>=0},e=>e?kr.createElement(Vd,{identifier:()=>this.getIdentifier(),insideMQ:()=>!1,controller:()=>this.props.controller(),insideGroup:()=>!1,putInTabOrder:()=>!1}):kr.createElement("span",null,kr.createElement(tt,{config:this.const({}),latex:()=>this.getLatex()})))}getLatex(){return this.props.latex()||"unknown"}getIdentifier(){let e=this.props.latex();return e?__dcg_shared_module_exports__['Mb'].latexToIdentifier(e):""}},Ak=class extends kr.Class{init(){this.controller=this.props.controller()}template(){return kr.createElement(B5,{key:this.bindFn(this.getTransformationType)},e=>{switch(e){case"translate":return this.getParents().length===1?kr.createElement("div",null,kr.const("Translate by"),kr.const(" "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getParents()[0]})):kr.createElement("div",null,kr.const("Translate from"),kr.const(" "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getParents()[0]}),kr.const(" "),kr.const("to"),kr.const(" "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case"reflect":return kr.createElement("div",null,kr.const("Reflect over"),kr.const(" "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getParents()[0]}));case"dilate":return kr.createElement("div",null,kr.const("Dilate at"),kr.const(" "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getParents()[0]}),kr.const(" by "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)}));case"rotate":return kr.createElement("div",null,kr.const("Rotate around"),kr.const(" "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getParents()[0]}),kr.const(" by "),kr.createElement(Ud,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)+(this.controller.getGraphSettings().degreeMode?"\xB0":"")}));case void 0:return kr.createElement("span",null)}})}getParents(){let e=this.getGeometry();return!e||!e.call?[]:e&&e.call?e.call.parents.map(t=>__dcg_shared_module_exports__['Mb'].geoParentToLatex(t)):[]}getRawParentLatex(e){var s;var t=(s=this.props.model())==null?void 0:s.latex;if(!t)return"";let n=__dcg_shared_module_exports__['gc'](t)._expression;if(!n)return"";let o=n.args[e];return!o||!o.getInputString?"":o.getInputString()||""}getGeometry(){var e;return(e=this.props.model())==null?void 0:e.formula.geometry}getTransformationType(){var i;let e=this.getGeometry(),t=(i=e==null?void 0:e.call)==null?void 0:i.symbol;switch(t){case"translate":case"dilate":case"reflect":case"rotate":return t}}};var{Each:K5,If:IQ}=Rn.Components,Lk=class extends Rn.Class{init(){this.controller=this.props.controller(),this.focusOrder=this.getTransformationFocusLocations(),this.cacheExistingTransformations()}willUpdate(){this.cacheExistingTransformations()}template(){return Rn.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-transformations-menu":!0}),role:Rn.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-transformations-menu")},Rn.createElement("div",{onKeydown:this.bindFn(this.handleKeydown),class:Rn.const("dcg-new-transformations-container"),role:Rn.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-new-transformation")},K5(()=>this.getTransformations(),{item:e=>Rn.createElement("div",{class:()=>({"dcg-new-transformation":!0,"dcg-disabled":!this.controller.isGeoToolEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(e)}),role:Rn.const("button"),tabindex:()=>this.getTransformations().indexOf(e)===0?0:-1,manageFocus:this.const(Vt({controller:this.controller,location:{type:"geo-basic-tool",tool:e}})),onTap:t=>{this.controller.dispatch({type:"select-geo-tool",tool:e}),t.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}},Rn.createElement("i",{class:()=>this.getTransformationIcon(e)}),()=>this.getTransformationName(e))})),Rn.createElement(IQ,{predicate:()=>this.cachedExistingTransformations.length>0},()=>Rn.createElement("div",{class:Rn.const("dcg-transformation-header")},()=>this.controller.s("graphing-calculator-label-recent-transformations"))),Rn.createElement("div",{role:Rn.const("group"),class:Rn.const("dcg-existing-transformations-container"),"aria-label":()=>this.controller.s("graphing-calculator-label-recent-transformations")},K5(()=>this.cachedExistingTransformations,{item:e=>Rn.createElement("div",{class:Rn.const("dcg-existing-transformation"),role:Rn.const("button"),tabindex:Rn.const("0"),onTap:()=>this.applyTransformation(e),onPointerOut:t=>this.onPointerOut(t,e),onPointerOver:t=>this.onPointerOver(t,e),willUnmount:()=>this.onImplicitMouseOut(e)},Rn.createElement(Ak,{controller:this.props.controller,model:()=>e})),key:e=>e.id})))}willUnmount(){xe(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMount(){xe(this.controller.s("graphing-calculator-narration-options-menu-open"))}handleKeydown(e){let t=Re(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let n=__dcg_shared_module_exports__['z'](this.focusOrder,i);if(n===-1)return;e.preventDefault(),e.stopPropagation();let o=n;t==="Left"?o=Math.max(0,n-1):t==="Right"?o=Math.min(this.focusOrder.length-1,n+1):t==="Home"?o=0:t==="End"&&(o=this.focusOrder.length-1),o!==n&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[o]})}computeExistingTransformations(){var t;let e=[];for(let i of this.controller.getAllItemModels()){if(i.type!=="expression"||!this.controller.isItemInGeoFolder(i.id))continue;let n=(t=i.formula.geometry)==null?void 0:t.call;n&&__dcg_shared_module_exports__['Xb'](n.symbol)&&e.push(i)}return e.reverse()}cacheExistingTransformations(){this.cachedExistingTransformations=this.computeExistingTransformations()}getTransformations(){return Hf.filter(e=>this.controller.isGeoToolVisible(e))}getTransformationIcon(e){switch(e){case"dilate":return"dcg-icon-dilation";case"reflect":return"dcg-icon-reflection";case"rotate":return"dcg-icon-rotation";case"translate":return"dcg-icon-translation"}}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name")}}getTransformationFocusLocations(){let e=[];return this.getTransformations().forEach(t=>{e.push({type:"geo-basic-tool",tool:t})}),e}onPointerOver(e,t){var n;if(e.pointerType!=="mouse")return;let i=(n=jo(t))==null?void 0:n.identifier;i&&(this.currentlyActiveTokenIdentifier=i,this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}))}onPointerOut(e,t){var n;if(e.pointerType!=="mouse")return;let i=(n=jo(t))==null?void 0:n.identifier;i&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===i&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}),this.currentlyActiveTokenIdentifier=void 0)}onImplicitMouseOut(e){var i;let t=(i=jo(e))==null?void 0:i.identifier;t&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===t&&this.controller.runAfterDispatch(()=>{let n=this.currentlyActiveTokenIdentifier;n&&(this.currentlyActiveTokenIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:n,style:"hovered"}))})}applyTransformation(e){var i;if(!((i=e.formula.geometry)!=null&&i.identifier))return;let t=__dcg_shared_module_exports__['Ib'](e.formula.geometry.identifier);this.controller.dispatch({type:"apply-transformation-to-selected",assignmentLatex:t})}};var Ga=__dcg_shared_module_exports__['h'](X());var{For:VQ}=Ga.Components,Ok=class extends Ga.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Ga.createElement("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:Ga.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),didMount:()=>{xe(this.controller.s("graphing-calculator-narration-options-menu-open"))},didUnmount:()=>{xe(this.controller.s("graphing-calculator-narration-options-menu-closed"))}},Ga.createElement(VQ,{each:this.bindFn(this.getSections)},Ga.createElement("div",null,e=>{switch(e){case"points":return Ga.createElement(ey,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")}));case"drag":return Ga.createElement(ry,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")}));case"lines":return Ga.createElement(Xf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")}))}})),Ga.createElement("div",{class:Ga.const("dcg-triangle")}))}getSections(){return this.model.draggable&&!this.controller.isThreeDMode()?["points","lines","drag"]:["points","lines"]}isFirstOpenSection(e){let t=this.getSections();for(let i of t){if(i===e)return this.isSectionOpen(e);if(this.isSectionOpen(i))return!1}return!1}isSectionOpen(e){switch(e){case"drag":return this.model.dragMode!=="NONE";case"lines":return!!this.model.lines;case"points":return!!this.model.points}}};var xr=__dcg_shared_module_exports__['h'](X());var{For:TQ,If:jL,Textarea:MQ}=xr.Components,Pk=class extends xr.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,xr.createElement("div",{class:xr.const("dcg-image-options-menu dcg-options-menu")},xr.createElement("div",{class:xr.const("dcg-triangle")}),xr.createElement("div",{class:xr.const("dcg-opacities-menu dcg-dividing-line-after")},xr.createElement("div",{role:xr.const("heading"),"aria-level":xr.const("2"),class:xr.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-image-opacity")),xr.createElement(TQ,{each:()=>this.controller.getImageOpacities()},xr.createElement("div",{class:xr.const("dcg-opacities-menu-flex"),role:xr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity")},e=>xr.createElement("span",{class:xr.const("dcg-opacity-option"),role:xr.const("button"),tabindex:xr.const(0),"aria-label":()=>`opacity: ${e}`,"aria-pressed":()=>this.isOpacitySelected(e),handleevent:xr.const("true"),onTap:()=>this.onSelectOpacity(e)},xr.createElement(Io,{backgroundImage:this.bindFn(this.getBackgroundImage),iconType:()=>this.isOpacitySelected(e)?"check":"none",backgroundOpacity:()=>parseFloat(e)}))))),xr.createElement("div",{class:xr.const("dcg-styles-div dcg-options-menu-section")},xr.createElement("div",{class:xr.const("dcg-styles-menu"),role:xr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-image-styles")},xr.createElement(Gt,{checked:()=>!this.model.foreground,onChange:this.bindFn(this.onToggleForeground)},()=>this.controller.s("graphing-calculator-button-place-image-behind-graphs"))),xr.createElement(jL,{predicate:()=>this.shouldShowDraggableCheckbox()},()=>xr.createElement("div",{class:xr.const("dcg-draggable-checkbox-container")},xr.createElement(Gt,{checked:()=>Cd(this.model),onChange:this.bindFn(this.onToggleDraggable)},()=>this.controller.s("graphing-calculator-button-draggable")))),xr.createElement(jL,{predicate:this.bindFn(this.shouldShowClickable)},()=>xr.createElement("div",{class:xr.const("dcg-clickable-image-controls")},xr.createElement(Qf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isOpen:()=>!!this.model.clickableInfo.enabled,isFirstOpenSection:this.const(!1)})))),xr.createElement(jL,{predicate:()=>Cd(this.model)||!!this.model.clickableInfo.enabled},()=>xr.createElement(MQ,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})}))))}onToggleDraggable(){Am(this.model)?this.controller.dispatch({type:"set-image-draggable",id:this.id,draggable:!this.model.draggable}):this.makeDraggable()}onToggleForeground(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.id,foreground:!e})}onSelectOpacity(e){this.controller.dispatch({type:"set-image-opacity",id:this.id,opacity:e})}isOpacitySelected(e){return this.model.opacity===e}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+nk(this.model.image_url)+'")',this.lastEncodedURL)}shouldShowClickable(){return this.controller.areActionsEnabled()}makeDraggable(){this.controller.dispatch({type:"convert-image-to-draggable",id:this.model.id})}shouldShowDraggableCheckbox(){if(this.controller.isThreeDMode())return!1;var e=Am(this.model);return e?TD(e):qF(this.model)}};var En=__dcg_shared_module_exports__['h'](X());var rs=__dcg_shared_module_exports__['h'](X());var _k=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],AQ=__dcg_shared_module_exports__['t'](_k),LQ=__dcg_shared_module_exports__['s'](_k),Xx=class extends rs.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return rs.createElement("div",{class:rs.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:rs.const("true")},rs.createElement("span",{class:()=>({"dcg-action-slower":!0,"dcg-disabled":this.isSlowerDisabled()}),onTap:()=>this.animateSlower(),role:rs.const("button"),"aria-label":()=>this.getSlowerAriaLabel(),tabindex:()=>this.isSlowerDisabled()?-1:0,"aria-disabled":()=>this.isSlowerDisabled()},rs.createElement("i",{class:rs.const("dcg-icon-show"),"aria-hidden":rs.const("true")})),rs.createElement("span",{class:rs.const("dcg-variable-speed")},this.bindFn(this.computeSpeed),rs.const("x")),rs.createElement("span",{class:()=>({"dcg-action-faster":!0,"dcg-disabled":this.isFasterDisabled()}),onTap:()=>this.animateFaster(),role:rs.const("button"),"aria-label":()=>this.getFasterAriaLabel(),tabindex:()=>this.isFasterDisabled()?-1:0,"aria-disabled":()=>this.isFasterDisabled()},rs.createElement("i",{class:rs.const("dcg-icon-show"),"aria-hidden":rs.const("true")})))}computeSpeed(){var e=__dcg_shared_module_exports__['Kc']/this.model.slider.animationPeriod;return e=Number(e.toFixed(3)),e}isSlowerDisabled(){return AQ>=this.computeSpeed()}isFasterDisabled(){return LQ<=this.computeSpeed()}animateSlower(){var e=this.computeSpeed(),t=__dcg_shared_module_exports__['n'](_k,function(i){return i<e});t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['s'](t))}animateFaster(){var e=this.computeSpeed(),t=__dcg_shared_module_exports__['n'](_k,function(i){return i>e});t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['t'](t))}setPeriodFromSpeed(e){var t=__dcg_shared_module_exports__['Kc']/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:t}),xe(this.controller.s("graphing-calculator-narration-slider-animating-at-speed",{speed:e+""}))}getSlowerAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-slower")}getFasterAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-faster")}};var Fk=class extends En.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return En.createElement("div",{class:En.const("dcg-slider-options-view dcg-options-menu")},En.createElement("div",{class:En.const("dcg-triangle")}),En.createElement("div",{class:En.const("dcg-slider-menu")},En.createElement("div",{role:En.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")},En.createElement("div",{role:En.const("heading"),"aria-level":En.const("2"),class:En.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")),En.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),staticConfig:this.bindFn(this.getAnimationOptions),theme:this.const("mini")}))),En.createElement("div",{class:En.const("dcg-slider-menu dcg-slider-speed-menu"),role:En.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-speed")},En.createElement("div",{role:En.const("heading"),"aria-level":En.const("2"),class:En.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-speed")),En.createElement("div",{class:En.const("dcg-slider-speed-container")},En.createElement(Xx,__dcg_shared_module_exports__['a']({},this.props)))))}getAnimationOptions(){return["LOOP_FORWARD_REVERSE","LOOP_FORWARD","PLAY_ONCE","PLAY_INDEFINITELY"].map((t,i)=>({key:t,icon:()=>__dcg_shared_module_exports__['Ma'](t),tooltip:()=>this.getTooltip(t),tooltipGravity:()=>i===0?"se":"s",selected:()=>this.isSelected(t),onSelect:()=>{this.props.controller().dispatch({type:"set-slider-loopmode",id:this.props.model().id,loopMode:t})}}))}getTooltip(e){let t=this.controller.s;switch(e){case"LOOP_FORWARD_REVERSE":return t("graphing-calculator-narration-slider-loop-forwards-and-backwards");case"LOOP_FORWARD":return t("graphing-calculator-narration-slider-repeat-one-direction");case"PLAY_ONCE":return t("graphing-calculator-narration-slider-play-once");case"PLAY_INDEFINITELY":return t("graphing-calculator-narration-slider-play-indefinitely")}}isSelected(e){return this.model.slider.loopMode===e}};var sr=__dcg_shared_module_exports__['h'](X());var Rk=__dcg_shared_module_exports__['h'](X());function H5(r,e,t){r.save();for(let i of t)switch(i.type){case"point":{let n;!i.color||i.color==="dark"?n=GS({isPoint:!0,color:e.point,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['Q'](e.point,.7):n=i.color;let o;switch(i.size){case"small":o=5;break;case"large":o=10;break;case"medium":default:o=5;break}i.hollow?(r.lineWidth=2,r.strokeStyle=n,r.beginPath(),r.arc(i.x,i.y,o-1,0,2*Math.PI),r.stroke()):(r.fillStyle=n,r.beginPath(),r.arc(i.x,i.y,o,0,2*Math.PI),r.fill())}break;case"circle":{let n;!i.color||i.color==="dark"?n=cw({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['Q'](e.circle,.7):n=i.color;let o;switch(i.lineWidth){case"small":o=2;break;case"large":o=7;break;case"medium":default:o=4;break}r.lineWidth=o,r.strokeStyle=n,r.beginPath(),r.arc(i.x,i.y,i.radius,0,2*Math.PI),r.stroke()}break;case"arc":{let n;!i.color||i.color==="dark"?n=cw({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['Q'](e.circle,.7):n=i.color;let o;switch(i.lineWidth){case"small":o=2;break;case"large":o=7;break;case"medium":default:o=4;break}r.lineWidth=o,r.strokeStyle=n,r.beginPath(),r.arc(i.x,i.y,i.radius,i.startAngle,i.endAngle),r.stroke()}break;case"stroked-path":{let n;!i.color||i.color==="dark"?n=cw({isPoint:!1,color:e.line,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['Q'](e.line,.7):n=i.color;let o=i.path,s;switch(i.lineWidth){case"small":s=1;break;case"large":s=5;break;case"medium":default:s=3;break}r.lineCap="round",r.lineJoin="round",r.strokeStyle=n,r.lineWidth=s,r.beginPath(),r.moveTo(o[0],o[1]);for(let a=2;a<o.length;a+=2)r.lineTo(o[a],o[a+1]);if(i.arrow){let a=[],l=o.length-1;PQ(a,o[l-3],o[l-2],o[l-1],o[l],s/2+9.5);for(let c=0;c<a.length;c+=2)r.lineTo(a[c],a[c+1])}r.stroke()}break;case"filled-polygon":{let n;i.color?n=i.color:n=GS({isPoint:!1,color:e.polygon,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});let o=i.path;r.fillStyle=n,r.beginPath(),r.moveTo(o[0],o[1]);for(let s=2;s<o.length;s+=2)r.lineTo(o[s],o[s+1]);r.fill()}break;case"angle":{let n=cw({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0}),o=GS({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});OQ(r,{type:"angle-indicator",lineWidth:4,strokeStyle:n,fillStyle:o,isRightAngle:!1,x:i.x,y:i.y,isDirected:i.isDirected,radius:i.radius,startAngle:i.startAngle,deltaAngle:i.deltaAngle})}break;default:return i}r.restore()}function OQ(r,e){r.beginPath(),U5(r,e),r.lineTo(e.x,e.y),r.lineTo(e.x+e.radius*Math.cos(e.startAngle),e.y+e.radius*Math.sin(e.startAngle)),e.isDirected||(r.fillStyle=e.fillStyle,r.fill()),r.strokeStyle=e.strokeStyle,r.lineWidth=e.lineWidth,r.beginPath(),U5(r,e),r.stroke()}function U5(r,e){let t=e.startAngle+e.deltaAngle;if(e.isRightAngle){let i=e.radius*Math.cos(e.startAngle),n=e.radius*Math.cos(t),o=e.radius*Math.sin(e.startAngle),s=e.radius*Math.sin(t);r.moveTo(e.x+i,e.y+o),r.lineTo(e.x+i+n,e.y+o+s),r.lineTo(e.x+n,e.y+s)}else r.arc(e.x,e.y,e.radius,e.startAngle,t)}function PQ(r,e,t,i,n,o=12){let s=Math.atan2(n-t,i-e),a=i-o*Math.cos(s-Math.PI/9),l=n-o*Math.sin(s-Math.PI/9),c=i-o*Math.cos(s+Math.PI/9),u=n-o*Math.sin(s+Math.PI/9),p=i-(o-2)*Math.cos(s-Math.PI/18),g=n-(o-2)*Math.sin(s-Math.PI/18),h=i-(o-2)*Math.cos(s+Math.PI/18),b=n-(o-2)*Math.sin(s+Math.PI/18);r.push(a,l,c,u,i,n,p,g,h,b,i,n)}var oy=class extends Rk.Class{template(){return Rk.createElement("canvas",{didMount:this.bindFn(this.didMountCanvas),width:()=>this.props.width(),height:()=>this.props.height(),style:()=>({width:this.props.width()/2+"px",height:this.props.height()/2+"px"})})}didMountCanvas(e){this.canvas=e,this.redraw()}didUpdate(){this.redraw()}redraw(){let e=this.props.instructions()||[],t=this.props.model().getNonObjectsState().ui.colors;if(__dcg_shared_module_exports__['G'](e,this.lastInstructions)&&__dcg_shared_module_exports__['G'](t,this.lastColors))return;this.lastInstructions=e,this.lastColors=t;let i=this.canvas.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height),H5(i,t,e)}};var{If:_Q,For:q5,Switch:FQ}=sr.Components,Nk=class extends sr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}template(){return sr.createElement("div",{role:sr.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:sr.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load")},sr.createElement(q5,{each:()=>this.controller.getGeoToolbarGroupKeys()},sr.createElement("span",{class:sr.const("dcg-icon-row")},e=>sr.createElement("span",{class:()=>({"dcg-icon-container":!0,"dcg-split-btn":!!this.getGroup(e).dropdown,"dcg-selected":this.isGroupSelected(e),"dcg-disabled":!this.isGroupEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(this.getGroup(e).current)}),"dcg-geo-tool":()=>this.getGroup(e).current,"dcg-geo-tool-group":this.const(e),onKeydown:t=>this.handleToolbarKeydown(t,this.getGroup(e)),role:sr.const("button"),tabindex:()=>this.isGroupSelected(e)?0:-1,"aria-label":()=>this.geoModel.getDisplayNameForTool(this.getGroup(e).current),"aria-disabled":()=>!this.isGroupEnabled(e),"aria-haspopup":()=>!!this.getGroup(e).dropdown,"aria-pressed":()=>this.isGroupSelected(e),onTap:t=>{t.wasHandled()||this.chooseTool(t,this.getGroup(e))},onLongHold:t=>this.openMenuFromLongHold(t,this.getGroup(e)),"dcg-open-menu-guid":()=>this.getGuid(this.getGroup(e)),manageFocus:()=>Vt({controller:this.controller,location:{type:"geo-basic-tool",tool:this.getGroup(e).current}})},sr.createElement("span",{class:()=>({"dcg-basic-tool-btn":!0,"dcg-icon":!0})},sr.createElement(oy,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(this.getGroup(e).current)})),sr.createElement(_Q,{predicate:()=>!!this.getGroup(e).dropdown},()=>sr.createElement(JL,{menuGuid:()=>this.getGuid(this.getGroup(e)),geoModel:()=>this.geoModel,spec:()=>this.getGroup(e),controller:this.props.controller}))))),sr.createElement(FQ,{key:()=>this.controller.getGeometryGettingStartedMessageState()},e=>{switch(e){case"hidden":return sr.createElement("span",null);case"construct":case"pick-a-tool":return sr.createElement("div",{class:()=>({"dcg-geo-getting-started-pointer":!0,"dcg-geo-getting-started-has-tool":this.controller.getGeometryGettingStartedMessageState()!=="pick-a-tool"})},this.bindFn(this.getPointerMessage),sr.createElement("span",{class:sr.const("dcg-curved-icon-container")},sr.createElement("i",{class:sr.const("dcg-icon-curved-arrow")})))}}))}isGroupSelected(e){return this.selectedTool()===this.getGroup(e).current}isGroupEnabled(e){return this.controller.isGeoToolEnabled(this.getGroup(e).current)}getGroup(e){let t=this.controller.getGeoToolbarItemsForGroup(e);if(!t)throw new Error("Programing error: "+e+" not found");return t}getPointerMessage(){return this.controller.getGeometryGettingStartedMessageState()==="pick-a-tool"?this.controller.s("geometry-label-pick-tool-instruction"):this.controller.s("geometry-label-construct-instruction")}handleToolbarKeydown(e,t){var u,p,g;let i=Re(e);if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right"&&i!=="Home"&&i!=="End"||(e.preventDefault(),e.stopPropagation(),!this.controller.getFocusLocation()))return;let o=this.controller.getAllVisibleGeoToolbarItems(),s=o.findIndex(h=>h.group===t.group),a=o[s];if(!a)return;let l=a.dropdown||[],c;if(i==="Home")c=(u=o[0])==null?void 0:u.current;else if(i==="End")c=(p=o[o.length-1])==null?void 0:p.current;else if(i==="Left"||i==="Right"){let h=i==="Left"?-1:1,b=Math.max(0,Math.min(o.length-1,s+h));c=(g=o[b])==null?void 0:g.current}else if(i==="Up"||i==="Down"){if(l.length===0)return;let h=l.indexOf(a.current),b=i==="Up"?-1:1,C=Math.max(0,Math.min(l.length-1,h+b));this.controller.isGeoToolEnabled(l[C])?c=l[C]:xe(this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.controller.getGeoModel().getDisplayNameForTool(l[C])}))}c&&(this.controller.dispatch({type:"select-geo-tool",tool:c}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:c}}))}selectedTool(){let e=this.controller.getActiveTool();return e==="expression-edit"?"selection":e}openDropdownMenu(e,t){t.dropdown&&this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(t),tools:t.dropdown,focusFirstOption:e.device==="keyboard"}})}getGuid(e){return e.dropdown?"geo-dropdown-"+e.dropdown[0]:""}openMenuFromLongHold(e,t){this.controller.dispatch({type:"select-geo-tool",tool:t.current}),this.openDropdownMenu(e,t)}chooseTool(e,t){e.wasLongheld()||(this.controller.dispatch({type:"select-geo-tool",tool:t.current,focusGraphPaper:e.device==="keyboard"}),e.shiftKey&&this.openDropdownMenu(e,t))}},Bk=class extends sr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}template(){return sr.createElement("div",{class:()=>({"dcg-options-menu":!0,"dcg-select-tools-dropdown":!0,"dcg-shift-menu-left":this.props.tools()[0]==="angle"}),role:sr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),didMount:this.bindFn(this.didMountContainer)},sr.createElement("div",{class:sr.const("dcg-options-menu-section")},sr.createElement(q5,{each:()=>this.props.tools()},sr.createElement("div",null,e=>sr.createElement("div",{role:sr.const("button"),tabindex:sr.const("0"),"aria-disabled":()=>!this.isToolEnabled(e),"aria-pressed":()=>this.controller.getActiveTool()===e,onTap:t=>{this.isToolEnabled(e)&&this.chooseTool({tool:e,focusIcon:t.device==="keyboard"})},"dcg-geo-tool":this.const(e),class:()=>({"dcg-dropdown-tool":!0,"dcg-selected-tool":this.controller.getActiveTool()===e,"dcg-disabled":!this.isToolEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(e)}),manageFocus:this.const(Vt({controller:this.controller,location:{type:"geo-basic-tool-menu-item",tool:e}}))},sr.createElement(oy,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(e)}),sr.createElement("span",null,()=>this.geoModel.getDisplayNameForTool(e)))))))}isToolEnabled(e){return this.controller.isGeoToolEnabled(e)}chooseTool(e){let t=this.props.controller();t.dispatch({type:"select-geo-tool",tool:e.tool}),e.focusIcon&&t.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.props.tools()[0]}})}willUnmount(){xe(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMountContainer(){xe(this.controller.s("graphing-calculator-narration-options-menu-open"))}},JL=class extends sr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.props.geoModel()}template(){return sr.createElement("span",{style:sr.const("position:relative;"),class:sr.const("dcg-tool-dropdown"),role:sr.const("button"),tabindex:sr.const("-1"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tool-options",{tool:this.geoModel.getDisplayNameForTool(this.props.spec().current)}),"aria-expanded":this.bindFn(this.getMenuOpen),onTap:this.bindFn(this.handleOnTap)},sr.createElement("span",{class:sr.const("dcg-dropdown-icon")},sr.createElement("i",{class:sr.const("dcg-icon-caret-down")})))}getMenuGUID(){var e=this.props.spec().dropdown||[];return"geo-dropdown-"+e[0]}getMenuOpen(){let e=this.controller.getOpenItemMenu();return e!==void 0&&e.type==="geo-tool-dropdown"&&e.guid===this.props.menuGuid()}handleOnTap(e){e.handle();let{current:t,dropdown:i=[]}=this.props.spec(),n=e.device==="keyboard";this.controller.getActiveTool()!==t&&!ux(t)&&this.controller.dispatch({type:"select-geo-tool",tool:t}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.props.menuGuid(),tools:i,focusFirstOption:n}})}getPrimaryToolName(){let e=this.props.spec().dropdown;return e!==void 0?e[0]:""}};var{Switch:RQ}=dn.Components,z5=':input, [role="textbox"], [tabindex="0"]:visible',Kk=class extends dn.Class{init(){this.controller=this.props.controller()}template(){return dn.createElement(RQ,{key:this.bindFn(this.getActiveGuid)},()=>{let e=this.controller.getOpenItemMenu();return this.registeredChildRepositionCb=void 0,e?e.type==="expression"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(iy,{controller:this.props.controller,model:()=>e.model,registerRepositionCb:i=>{this.registeredChildRepositionCb=i}})):e.type==="image"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(Pk,{controller:this.props.controller,model:()=>e.model})):e.type==="table-column"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(Ok,{controller:this.props.controller,model:()=>e.model})):e.type==="slider"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(Fk,{controller:this.props.controller,model:()=>e.model})):e.type==="multi-select-more"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(Gk,{controller:this.props.controller,registerRepositionCb:i=>{this.registeredChildRepositionCb=i}})):e.type==="multi-select-transformations"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(Lk,{controller:this.props.controller,registerRepositionCb:i=>{this.registeredChildRepositionCb=i}})):e.type==="geo-tool-dropdown"?dn.createElement("div",{class:dn.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},dn.createElement(Bk,{controller:this.props.controller,registerRepositionCb:i=>{this.registeredChildRepositionCb=i},tools:()=>e.tools})):e:dn.createElement("span",null)})}getActiveGuid(){let e=this.controller.getOpenItemMenu();if(e)return e.guid}didMountView(e){this.guid=__dcg_shared_module_exports__['M']("dcg-item-settings-view"),this.openView=e,this.positionMenu(),this.moveFocusIfAppropriate(),O(document.body).on(`keydown.${this.guid}`,t=>{let i=Re(t);i===Do?(t.preventDefault(),t.stopPropagation(),this.focusMenuIcon(),this.hideOptions()):i==="Tab"&&!t.altKey&&!t.ctrlKey&&!t.metaKey&&(t.shiftKey?t.shiftKey&&(this.isIconModelFocused()?(t.preventDefault(),t.stopPropagation(),this.focusLastOption()):this.isFirstOptionViewFocused()?(t.preventDefault(),t.stopPropagation(),this.focusIcon()):this.focusAnywhere()):this.isIconModelFocused()?(t.preventDefault(),t.stopPropagation(),this.focusFirstOption()):this.isLastOptionViewFocused()?(t.preventDefault(),t.stopPropagation(),this.focusIcon()):this.focusAnywhere())}),requestAnimationFrame(()=>{if(this.openView){let t=this.controller.getExppanelSelector(),i=this.controller.getOpenMenuIcon();t&&i&&t.contains(i)&&O(t).on("scroll."+this.guid,()=>{O(t).off("scroll."+this.guid),this.hideOptions()})}}),O(document.body).on(`dcg-tapstart.${this.guid}`,t=>{if(!this.openView)return;let i=O(t.target),n=this.controller.getOpenMenuIcon();if(!(n&&i.closest(n).length)){if(i.closest(this.openView).length){if(!i.is(z5))return;let{$first:o,$last:s}=this.getDOMTabStops();o!==void 0&&o.is(i)?this.focusFirstOption():s!==void 0&&s.is(i)?this.focusLastOption():!t.target.hasAttribute("dataLabelAttributeValue")&&t.target.getAttribute("dataLabelAttributeValue")!=="fill-opacity"&&this.focusAnywhere();return}i.closest(".dcg-keypad,.dcg-show-keypad-container").length||this.hideOptions()}})}didUnmountView(){O(document.body).off(`.${this.guid}`),this.openView=void 0}didUpdate(){this.positionMenu(),this.moveFocusIfAppropriate()}moveFocusIfAppropriate(){let{$first:e,$last:t}=this.getDOMTabStops();e===void 0||t===void 0||(this.shouldMoveFocusToFirstOption()?e.trigger("focus"):this.shouldMoveFocusToLastOption()&&t.trigger("focus"))}open(){return!!this.controller.getOpenItemMenu()}hideOptions(){if(!this.open())return;let e=this.controller.getFocusLocation(),t=this.controller.getOpenItemMenu();e&&t&&e.type==="expression-menu"&&"model"in t&&e.id===t.model.id&&this.controller.dispatch({type:"blur-focus-location",location:e}),this.controller.dispatch({type:"close-item-settings-menu"})}positionMenu(){let e=this.controller.getOpenMenuIcon();if(!e||!this.openView)return;var t=this.controller.findEl(".dcg-container");if(!t)return;var i=t.getBoundingClientRect();let n=e.getBoundingClientRect(),o={top:n.top-i.top,left:n.left-i.left},s=this.controller.computeMajorLayout(),a=s.list.top+s.list.height,l=s.keypad.top,u=Math.min(a,l)+i.top-n.top;Gc(this.openView,{top:o.top+"px",left:o.left+"px",display:"block"}),this.registeredChildRepositionCb&&this.registeredChildRepositionCb(u)}focusMenuIcon(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown"){this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:e.tools[0]}});return}else if(!("model"in e))return;this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}})}}isIconModelFocused(){let e=this.controller.getOpenItemMenu();if(e===void 0)return!1;if(e.type==="slider")return this.controller.isFocusLocationFocused({type:"slider-animation-properties-icon",id:e.model.id});if(e.type==="image")return this.controller.isFocusLocationFocused({type:"image-icon",id:e.model.id});if(e.type==="table-column")return this.controller.isFocusLocationFocused({type:"table-icon",id:e.model.table.id,columnId:e.model.id});if(e.type==="geo-tool-dropdown")return this.controller.isFocusLocationFocused({type:"geo-basic-tool",tool:e.tools[0]});if(e.type==="multi-select-more")return this.controller.isFocusLocationFocused({type:"multi-select-more-icon"});if(e.type==="multi-select-transformations")return this.controller.isFocusLocationFocused({type:"multi-select-transformations-icon"});var t=this.getModelForOpenMenu();if(t)return this.controller.isFocusLocationFocused({type:"expression-icon",id:t.id})}focusIcon(){this.controller.focusOpenMenuIcon()}isFirstOptionViewFocused(){let{$first:e}=this.getDOMTabStops();return e!==void 0&&e.is(":focus")}shouldMoveFocusToFirstOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown")return!this.isFirstOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"geo-basic-tool-menu-item",tool:e.tools[0]});if(e.type==="multi-select-more"||e.type==="multi-select-transformations")return!this.isFirstOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"generic-menu",where:"start"});var t=this.getModelForOpenMenu();if(t)return!this.isFirstOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"expression-menu",id:t.id,location:"start"})}}focusFirstOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown"){this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.tools[0]}});return}if(e.type==="multi-select-more"||e.type==="multi-select-transformations"){this.controller.dispatch({type:"set-focus-location",location:{type:"generic-menu",where:"start"}});return}var t=this.getModelForOpenMenu();t&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:t.id,location:"start"}})}}isLastOptionViewFocused(){let{$last:e}=this.getDOMTabStops();return e!==void 0&&e.is(":focus")}getModelForOpenMenu(){let e=this.controller.getOpenItemMenu();if(e&&"model"in e)return e.model}shouldMoveFocusToLastOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown")return!this.isLastOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"geo-basic-tool-menu-item",tool:e.tools[e.tools.length-1]});if(e.type==="multi-select-more"||e.type==="multi-select-transformations")return!this.isLastOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"generic-menu",where:"end"});var t=this.getModelForOpenMenu();if(t)return!this.isLastOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"expression-menu",id:t.id,location:"end"})}}focusLastOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown"){this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.tools[e.tools.length-1]}});return}if(e.type==="multi-select-more"||e.type==="multi-select-transformations"){this.controller.dispatch({type:"set-focus-location",location:{type:"generic-menu",where:"end"}});return}var t=this.getModelForOpenMenu();t&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:t.id,location:"end"}})}}focusAnywhere(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="multi-select-more"||e.type==="multi-select-transformations"){this.controller.dispatch({type:"set-focus-location",location:{type:"generic-menu",where:"anywhere"}});return}var t=this.getModelForOpenMenu();t&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:t.id,location:"anywhere"}})}}getDOMTabStops(){if(this.openView===void 0)return{};let t=O(this.openView).find(z5),i=t.first(),n=t.last();return{$first:i,$last:n}}};var er=__dcg_shared_module_exports__['h'](X());var $5=__dcg_shared_module_exports__['h'](X());var Qn=class extends $5.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};Qn.uuid=Md();var cy=__dcg_shared_module_exports__['h'](X());var Ku=__dcg_shared_module_exports__['h'](X()),Lr=class extends Ku.Class{template(){return Ku.createElement("div",{class:()=>({"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled()}),style:()=>({"flex-grow":this.getColSpan()})},Ku.createElement("span",{role:Ku.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),"aria-controls":this.props.ariaControls?this.props.ariaControls:this.const(void 0),"aria-expanded":this.props.ariaExpanded?this.bindFn(this.getAriaExpanded):this.const(void 0),onTap:()=>{this.isDisabled()||this.props.onTap()}},Ku.createElement("span",{class:Ku.const("dcg-keypad-btn-content")},this.children)))}getClasses(){let e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},t=this.props.style();switch(t){case"default":e["dcg-btn-light-on-gray"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;case"blue":e["dcg-btn-short-blue"]=!0;break;case"tall-blue":e["dcg-btn-tall-blue"]=!0;break;default:return t}return e}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}getAriaExpanded(){return this.props.ariaExpanded?this.props.ariaExpanded():void 0}};var re=__dcg_shared_module_exports__['h'](X()),{IfElse:J5,If:W5,Switch:NQ}=re.Components;function Nr(r,e){return r===void 0?re.const(e):typeof r=="function"?r:re.const(r)}function sy(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(r.command||r.typedText||r.keys[0]),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):r.typedText||r.keys[0],colspan:Nr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[0]})},J5(()=>r.keys[0]==="{"||r.keys[0]==="[",{true:()=>re.createElement("span",{class:re.const("dcg-mq-math-mode"),style:re.const("font-size: 120%")},re.const(r.keys[0]),re.const("\xA0"),re.createElement("span",{style:re.const("color: #999")},re.const(r.keys[1]))),false:()=>re.createElement("span",{class:re.const("dcg-either-or-btn")},re.createElement(tt,{config:re.const({}),latex:re.const(r.keys[0])}),re.createElement("span",{style:re.const("color: #999")},re.createElement(tt,{config:re.const({}),latex:re.const(r.keys[1])})))}))}function ay(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(r.command||r.typedText||r.keys[1]),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):r.typedText||r.keys[0],colspan:Nr(i.colspan,1),style:Nr(i.style,"default"),onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[1]})},J5(()=>r.keys[1]==="}"||r.keys[1]==="]",{true:()=>re.createElement("span",{class:re.const("dcg-mq-math-mode"),style:re.const("font-size: 120%")},re.createElement("span",{style:re.const("color: #999")},re.const(r.keys[0])),re.const("\xA0"),re.const(r.keys[1])),false:()=>re.createElement("span",null,re.createElement("span",{style:re.const("color: #999")},re.createElement(tt,{config:re.const({}),latex:re.const(r.keys[0])})),re.createElement(tt,{config:re.const({}),latex:re.const(r.keys[1])}))}))}function BQ(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(r.command),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):e,colspan:Nr(i.colspan,1),style:()=>i.style||"default",onTap:()=>{t({type:"keypad/audio-trace",command:r.command})}},re.createElement(W5,{predicate:re.const(r.iconClass!==void 0)},()=>re.createElement("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":r.contentKey===void 0})},re.createElement("i",{class:re.const(r.iconClass),"aria-hidden":re.const("true")}))),re.createElement(W5,{predicate:re.const(r.contentKey!==void 0)},()=>re.createElement("span",null,()=>n(r.contentKey)||e)))}function Fe(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):e,colspan:Nr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e})},re.createElement(tt,{config:re.const({}),latex:re.const(r.content||e)}))}function j5(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):e,colspan:Nr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e})},re.createElement("span",{class:re.const("dcg-mq-math-mode")},re.const(r.content||e)))}function ze(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(e),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):e,colspan:Nr(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:e+"("})},re.createElement(NQ,{key:()=>e.match(/^[a-z]{2,}$/)},o=>o?re.createElement("span",{class:re.const("dcg-mq-math-mode dcg-static-mathquill-view")},re.createElement("span",{class:re.const("dcg-mq-root-block")},re.createElement("span",{class:re.const("dcg-mq-operator-name")},()=>e))):re.createElement(tt,{config:re.const({}),latex:re.const(e)})))}function vs(r){return(e,t,i={},n)=>re.createElement(Lr,{command:re.const(r.command),ariaLabel:()=>r.ariaLabelKey?n(r.ariaLabelKey):r.command,colspan:Nr(i.colspan,1),style:()=>i.style||"default",onTap:()=>{t({type:"keypad/custom-command",command:r.command})}},re.createElement(tt,{config:re.const({}),latex:re.const(r.content)}))}var KQ={"{":j5({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":j5({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:Fe({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:Fe({content:"\xF7",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:Fe({content:"\xF7",typedText:"\xF7",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:Fe({content:"\xD7",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"\xB1":Fe({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-ans"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/type-text",text:r})},re.const("ans")),enter:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-enter"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Enter"})},re.createElement("i",{class:re.const("dcg-icon-arrow-enter"),"aria-hidden":re.const("true")})),shift:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-shift"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",active:Nr(t.active,!1),onTap:()=>e({type:"keypad/shift"})},re.createElement("i",{class:re.const("dcg-icon-shift"),"aria-hidden":re.const("true")})),left:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-left-arrow"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Left"})},re.createElement("i",{class:re.const("dcg-icon-arrow-left"),"aria-hidden":re.const("true")})),right:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-right-arrow"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Right"})},re.createElement("i",{class:re.const("dcg-icon-arrow-right"),"aria-hidden":re.const("true")})),123:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/123"})},re.const("1 2 3")),ABC:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-letters"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/abc"})},re.const("A B C")),Audio:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"on"})},re.createElement("i",{class:re.const("dcg-icon-volume"),"aria-hidden":re.const("true")})),backspace:(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-backspace"),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Backspace"})},re.createElement("i",{class:re.const("dcg-icon-delete"),"aria-hidden":re.const("true")})),pi:Fe({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:Fe({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:Fe({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:Fe({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:Fe({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),"a^2":vs({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":vs({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":vs({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":Fe({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:Fe({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":vs({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":vs({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":Fe({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":Fe({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:vs({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:vs({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),sec:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:vs({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:vs({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:vs({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:vs({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:vs({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:vs({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":Fe({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":Fe({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilate:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-dilate"}),rotate:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-rotate"}),translate:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-translate"}),reflect:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-reflect"}),vertices:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:ze({}),varp:ze({}),nCr:ze({}),loga:vs({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:ze({}),nPr:ze({}),total:ze({}),length:ze({}),for:ze({}),min:ze({}),max:ze({}),cov:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),mean:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:ze({}),"e^x":Fe({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":Fe({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":Fe({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:Fe({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:Fe({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":Fe({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":Fe({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:ze({}),gcd:ze({}),gcf:ze({}),ddx:vs({command:"ddx",content:"\\frac{d}{dx}"}),integral:vs({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":Fe({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":Fe({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:Fe({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:Fe({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:Fe({}),sign:ze({}),normaldist:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),pdf:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:ze({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:ze({}),rgb:ze({}),sort:ze({}),shuffle:ze({}),unique:ze({}),join:ze({}),"A^-1":vs({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":vs({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":vs({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":Fe({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:ze({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:ze({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:ze({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:Fe({}),b:Fe({}),c:Fe({}),d:Fe({}),e:Fe({}),f:Fe({}),g:Fe({}),h:Fe({}),i:Fe({}),j:Fe({}),k:Fe({}),l:Fe({}),m:Fe({}),n:Fe({}),o:Fe({}),p:Fe({}),q:Fe({}),r:Fe({}),s:Fe({}),t:Fe({}),u:Fe({}),v:Fe({}),w:Fe({}),x:Fe({}),boldX:Fe({content:"x",typedText:"x"}),y:Fe({}),boldY:Fe({content:"y",typedText:"y"}),z:Fe({}),A:Fe({}),B:Fe({}),C:Fe({}),D:Fe({}),E:Fe({}),F:Fe({}),G:Fe({}),H:Fe({}),I:Fe({}),J:Fe({}),K:Fe({}),L:Fe({}),M:Fe({}),N:Fe({}),O:Fe({}),P:Fe({}),Q:Fe({}),R:Fe({}),S:Fe({}),T:Fe({}),U:Fe({}),V:Fe({}),W:Fe({}),X:Fe({}),Y:Fe({}),Z:Fe({}),0:Fe({}),1:Fe({}),2:Fe({}),3:Fe({}),4:Fe({}),5:Fe({}),6:Fe({}),7:Fe({}),8:Fe({}),9:Fe({}),",":Fe({}),"=":Fe({}),"[":Fe({}),"]":Fe({}),"{}_left":sy({keys:["{","}"]}),"{}_right":ay({keys:["{","}"]}),"()_left":sy({keys:["(",")"]}),"()_right":ay({keys:["(",")"]}),"[]_left":sy({keys:["[","]"]}),"[]_right":ay({keys:["[","]"]}),",'_left":sy({keys:[",","\u2032"]}),",'_right":ay({keys:[",","\u2032"],typedText:"'"}),'"':Fe({}),"'":Fe({}),"~":Fe({}),":":Fe({}),">":Fe({}),"<":Fe({}),">=":Fe({content:"\\ge"}),"<=":Fe({content:"\\le"}),"!%_left":sy({keys:["!","{}^{%}"]}),"!%_right":ay({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":sy({keys:["~","{}^{:}"]}),"~:_right":ay({keys:["~","{}^{:}"],typedText:":"}),"audio-trace-off":BQ({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:Nr(t.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"hear-graph"})}},re.createElement("span",{class:re.const("dcg-play-icon-container")},re.createElement("i",{class:re.const("dcg-icon-play"),"aria-hidden":re.const("true")})),re.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-hear-graph"))),"stop-graph":(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:Nr(t.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"stop-graph"})}},re.createElement("span",{class:re.const("dcg-stop-icon-container")},re.createElement("span",{class:re.const("dcg-stop-icon")})),re.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-stop-graph"))),"volume-down":(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-down"),disabled:Nr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-down"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-volume-down"),"aria-hidden":re.const("true")}))),"volume-up":(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-up"),disabled:Nr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-up"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-volume-up"),"aria-hidden":re.const("true")}))),"speed-down":(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-down"),disabled:Nr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-down"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-hide"),"aria-hidden":re.const("true")}))),"speed-up":(r,e,t={},i)=>re.createElement(Lr,{command:re.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-up"),disabled:Nr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-up"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-show"),"aria-hidden":re.const("true")}))),"previous-point":(r,e,t={},i)=>re.createElement(Lr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-point"),command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-point"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-thin-arrow-left"),"aria-hidden":re.const("true")}))),"next-point":(r,e,t={},i)=>re.createElement(Lr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-point"),command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-point"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-thin-arrow-right"),"aria-hidden":re.const("true")}))),"previous-poi":(r,e,t={},i)=>re.createElement(Lr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-poi"),command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-poi"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-hide"),"aria-hidden":re.const("true")}))),"next-poi":(r,e,t={},i)=>re.createElement(Lr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-poi"),command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-poi"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-show"),"aria-hidden":re.const("true")}))),"previous-curve":(r,e,t={},i)=>re.createElement(Lr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-curve"),command:re.const(r),disabled:Nr(t.disabled,!1),colspan:Nr(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-curve"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-caret-up"),"aria-hidden":re.const("true")}))),"next-curve":(r,e,t={},i)=>re.createElement(Lr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-curve"),command:re.const(r),disabled:Nr(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-curve"})},re.createElement("span",{class:re.const("dcg-button-icon dcg-icon-only")},re.createElement("i",{class:re.const("dcg-icon-caret-down"),"aria-hidden":re.const("true")})))};function x(r,e,t={}){let i=r.dispatch;return KQ[e](e,i,t,r.s)}function ji(r=1){return re.createElement("div",{style:re.const(`flex-grow:${r}`)})}var Uk=__dcg_shared_module_exports__['h'](X());var Y5=__dcg_shared_module_exports__['h'](X()),Uu=class extends Y5.Class{init(){this.controller=this.props.controller()}};var wr=class extends Uu{template(){return Uk.createElement("div",{class:Uk.const("dcg-basic-keypad dcg-do-not-blur")},this.children)}};var ly=__dcg_shared_module_exports__['h'](X()),Ue=class extends ly.Class{template(){return ly.createElement("div",{class:ly.const("dcg-keypad-row")},this.children)}};var Hk=class extends Qn{template(){return cy.createElement(wr,{controller:this.props.controller},cy.createElement(Ue,null,x(this,"q"),x(this,"w"),x(this,"e"),x(this,"r"),x(this,"t"),x(this,"y"),x(this,"u"),x(this,"i"),x(this,"o"),x(this,"p")),cy.createElement(Ue,null,x(this,"a"),x(this,"s"),x(this,"d"),x(this,"f"),x(this,"g"),x(this,"h"),x(this,"j"),x(this,"k"),x(this,"l"),x(this,"theta")),cy.createElement(Ue,null,x(this,"shift",{colspan:1.364,style:"highlight"}),ji(.136),x(this,"z"),x(this,"x"),x(this,"c"),x(this,"v"),x(this,"b"),x(this,"n"),x(this,"m"),ji(.136),x(this,"backspace",{colspan:1.364,style:"highlight"})),cy.createElement(Ue,null,x(this,"123",{colspan:1.818,style:"highlight"}),ji(.182),x(this,"a_b"),x(this,"!%_left"),x(this,"[]_left"),x(this,"{}_left"),x(this,"~:_left"),x(this,",'_left"),ji(.182),x(this,"enter",{colspan:1.818,style:"blue"})))}};var dy=__dcg_shared_module_exports__['h'](X());var qk=class extends Qn{template(){return dy.createElement(wr,{controller:this.props.controller},dy.createElement(Ue,null,x(this,"Q"),x(this,"W"),x(this,"E"),x(this,"R"),x(this,"T"),x(this,"Y"),x(this,"U"),x(this,"I"),x(this,"O"),x(this,"P")),dy.createElement(Ue,null,x(this,"A"),x(this,"S"),x(this,"D"),x(this,"F"),x(this,"G"),x(this,"H"),x(this,"J"),x(this,"K"),x(this,"L"),x(this,"tau")),dy.createElement(Ue,null,x(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),ji(.136),x(this,"Z"),x(this,"X"),x(this,"C"),x(this,"V"),x(this,"B"),x(this,"N"),x(this,"M"),ji(.136),x(this,"backspace",{colspan:1.364,style:"highlight"})),dy.createElement(Ue,null,x(this,"123",{colspan:1.818,style:"highlight"}),ji(.182),x(this,"a^b"),x(this,"!%_right"),x(this,"[]_right"),x(this,"{}_right"),x(this,"~:_right"),x(this,",'_right"),ji(.182),x(this,"enter",{colspan:1.818,style:"blue"})))}};var Js=__dcg_shared_module_exports__['h'](X());var zk=class extends Qn{template(){return Js.createElement(wr,{controller:this.props.controller},Js.createElement(Ue,null,x(this,"boldX"),x(this,"boldY"),x(this,"a^2"),x(this,"a^b"),ji(.5),x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"division"),ji(.5),Js.createElement(Lr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${Qn.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),Js.createElement(Ue,null,x(this,"("),x(this,")"),x(this,"<"),x(this,">"),ji(.5),x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"multiplication"),ji(.5),x(this,"left",{style:"highlight"}),x(this,"right",{style:"highlight"})),Js.createElement(Ue,null,x(this,"|a|"),x(this,","),x(this,"<="),x(this,">="),ji(.5),x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"-"),ji(1),x(this,"backspace",{colspan:1.5,style:"highlight"})),Js.createElement(Ue,null,Js.createElement("div",{class:Js.const("dcg-abc-audio-container")},Js.createElement(Lr,{command:Js.const("ABC"),colspan:this.const(1),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),Js.createElement(Lr,{command:Js.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"})},Js.createElement("i",{class:Js.const("dcg-icon-volume"),"aria-hidden":Js.const("true")}))),x(this,"sqrt"),x(this,"pi"),ji(.5),x(this,"0",{style:"highlight"}),x(this,".",{style:"highlight"}),x(this,"="),x(this,"+"),ji(.5),x(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var uy=__dcg_shared_module_exports__['h'](X());var $k=class extends Qn{template(){return uy.createElement(wr,{controller:this.props.controller},uy.createElement(Ue,null,x(this,"a"),x(this,"b"),x(this,"c"),x(this,"d"),x(this,"e"),x(this,"f"),x(this,"g"),x(this,"h"),x(this,"i"),x(this,"j")),uy.createElement(Ue,null,x(this,"k"),x(this,"l"),x(this,"m"),x(this,"n"),x(this,"o"),x(this,"p"),x(this,"q"),x(this,"r"),x(this,"s"),x(this,"t")),uy.createElement(Ue,null,x(this,"shift",{style:"highlight"}),x(this,"u"),x(this,"v"),x(this,"w"),x(this,"x"),x(this,"y"),x(this,"z"),x(this,"theta"),x(this,"backspace",{colspan:2,style:"highlight"})),uy.createElement(Ue,null,x(this,"123",{colspan:2,style:"highlight"}),x(this,"a_b"),x(this,"!%_left"),x(this,"[]_left"),x(this,"{}_left"),x(this,"~:_left"),x(this,",'_left"),x(this,"enter",{colspan:2,style:"blue"})))}};var py=__dcg_shared_module_exports__['h'](X());var Wk=class extends Qn{template(){return py.createElement(wr,{controller:this.props.controller},py.createElement(Ue,null,x(this,"A"),x(this,"B"),x(this,"C"),x(this,"D"),x(this,"E"),x(this,"F"),x(this,"G"),x(this,"H"),x(this,"I"),x(this,"J")),py.createElement(Ue,null,x(this,"K"),x(this,"L"),x(this,"M"),x(this,"N"),x(this,"O"),x(this,"P"),x(this,"Q"),x(this,"R"),x(this,"S"),x(this,"T")),py.createElement(Ue,null,x(this,"shift",{style:"highlight"}),x(this,"U"),x(this,"V"),x(this,"W"),x(this,"X"),x(this,"Y"),x(this,"Z"),x(this,"tau"),x(this,"backspace",{colspan:2,style:"highlight"})),py.createElement(Ue,null,x(this,"123",{colspan:2,style:"highlight"}),x(this,"a^b"),x(this,"!%_right"),x(this,"[]_right"),x(this,"{}_right"),x(this,"~:_right"),x(this,",'_right"),x(this,"enter",{colspan:2,style:"blue"})))}};var Xe=__dcg_shared_module_exports__['h'](X());var{IfElse:UQ}=Xe.Components,jk=460,Jk=class extends Qn{template(){return Xe.createElement(wr,{controller:this.props.controller},Xe.createElement("div",{class:Xe.const("dcg-audio-keypad-container")},Xe.createElement("div",{class:Xe.const("dcg-audio-keypad-column dcg-playback-column")},Xe.createElement(Ke,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},Xe.createElement("div",{class:Xe.const("dcg-btn-playback")},UQ(()=>this.controller.isAudioTracing(),{true:()=>x(this,"stop-graph",{disabled:this.bindFn(this.isAudioDisabled)}),false:()=>x(this,"hear-graph",{disabled:this.bindFn(this.isAudioDisabled)})}))),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section-container")},Xe.createElement(Ke,{tooltip:this.bindFn(this.getDisabledTooltipText),class:this.const("dcg-volume-button-container"),gravity:this.const("s"),sticky:this.const(!1)},Xe.createElement("div",{class:Xe.const("dcg-key-nav-section")},x(this,"volume-down",{disabled:this.bindFn(this.isVolumeDownDisabled)}),Xe.createElement("div",{role:Xe.const("heading"),"aria-level":Xe.const("2"),class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()})},Xe.createElement("span",{class:Xe.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-volume")),Xe.createElement("span",{class:Xe.const("dcg-keypad-volume-value dcg-key-nav-section-value")},()=>this.getAudioTraceVolume())),x(this,"volume-up",{disabled:this.bindFn(this.isVolumeUpDisabled)})))),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section-container")},Xe.createElement(Ke,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},Xe.createElement("div",{class:Xe.const("dcg-key-nav-section")},x(this,"speed-down",{disabled:this.bindFn(this.isSpeedDownDisabled)}),Xe.createElement("div",{class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),role:Xe.const("heading"),"aria-level":Xe.const("2")},Xe.createElement("span",{class:Xe.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-speed")),Xe.createElement("span",{class:Xe.const("dcg-keypad-speed-value dcg-key-nav-section-value")},()=>this.getAudioTraceSpeed())),x(this,"speed-up",{disabled:this.bindFn(this.isSpeedUpDisabled)})))),x(this,"audio-trace-off",{style:"highlight"})),Xe.createElement("div",{class:Xe.const("dcg-audio-keypad-spacer")}),Xe.createElement("div",{class:Xe.const("dcg-audio-keypad-column dcg-navigation-column")},Xe.createElement("span",{class:Xe.const("dcg-key-section-title dcg-center-col"),role:Xe.const("heading"),"aria-level":Xe.const("2")},()=>this.controller.s("graphing-calculator-heading-audio-trace-navigation")),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section dcg-center-col")},x(this,"previous-point",{disabled:this.bindFn(this.isPrevPointDisabled)}),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section-title-container"),role:Xe.const("heading"),"aria-level":Xe.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-point")),x(this,"next-point",{disabled:this.bindFn(this.isNextPointDisabled)})),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section")},x(this,"previous-poi",{disabled:this.bindFn(this.isPrevPOIDisabled)}),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section-title-container dcg-poi-section-container"),role:Xe.const("heading"),"aria-level":Xe.const("2")},Xe.createElement(Wi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest")},Xe.createElement("span",{class:Xe.const("dcg-key-nav-section-value")},Xe.const("Point")),Xe.createElement("span",{class:Xe.const("dcg-key-nav-section-title")},Xe.const("of Interest")))),x(this,"next-poi",{disabled:this.bindFn(this.isNextPOIDisabled)})),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section dcg-center-col")},x(this,"previous-curve",{disabled:this.bindFn(this.isPrevCurveDisabled)}),Xe.createElement("div",{class:Xe.const("dcg-key-nav-section-title-container"),role:Xe.const("heading"),"aria-level":Xe.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-curve")),x(this,"next-curve",{disabled:this.bindFn(this.isNextCurveDisabled)}))),Xe.createElement("div",{class:Xe.const("dcg-audio-keypad-spacer")}),Xe.createElement("div",{class:Xe.const("dcg-audio-keypad-column dcg-screenreader-options")},Xe.createElement("span",{class:Xe.const("dcg-key-section-title"),role:Xe.const("heading"),"aria-level":Xe.const("2")},()=>this.layoutWidth()<=jk?this.controller.s("graphing-calculator-heading-audio-trace-describe"):this.controller.s("graphing-calculator-heading-audio-trace-screen-reader"),Xe.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-audio-trace-need-screen-reader"),gravity:this.const("s"),sticky:this.const(!0)},Xe.createElement("i",{class:Xe.const("dcg-icon-question-sign"),"aria-hidden":Xe.const("true")}))),Xe.createElement(Lr,{command:Xe.const("describe-point"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-point"})}},Xe.createElement("span",null,()=>this.layoutWidth()<=jk?this.controller.s("graphing-calculator-button-keypad-describe-point-short"):this.controller.s("graphing-calculator-button-keypad-describe-point"))),Xe.createElement(Lr,{command:Xe.const("describe-curve"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-curve"})}},Xe.createElement("span",null,()=>this.layoutWidth()<=jk?this.controller.s("graphing-calculator-button-keypad-describe-curve-short"):this.controller.s("graphing-calculator-button-keypad-describe-curve"))),Xe.createElement(Lr,{command:Xe.const("describe-axes"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-axes"})}},Xe.createElement("span",null,()=>this.layoutWidth()<=jk?this.controller.s("graphing-calculator-label-axes"):this.controller.s("graphing-calculator-button-keypad-describe-axes"))))))}layoutWidth(){return this.controller.getLayoutMeasurements().width}isPrevPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPoint():!0}isNextPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPoint():!0}isPrevPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPOI():!0}isNextPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPOI():!0}isPrevCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevCurve():!0}isNextCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextCurve():!0}isAudioDisabled(){return!this.controller.getAudio()}getAudioTraceVolume(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0%":`${r.tonegen.getAudioVolume()*100}%`}isVolumeDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.tonegen.getAudioVolume()<=0}isVolumeUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.tonegen.getAudioVolume()>=1}getAudioTraceSpeed(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0":Sw[r.getAudioSpeedIndex()].displayedSpeed}isSpeedDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()<=0}isSpeedUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()===Sw.length-1}getDisabledTooltipText(){return this.isAudioDisabled()?this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"):""}};var ci=__dcg_shared_module_exports__['h'](X());var{If:YL,For:X5}=ci.Components,Yk=class extends Qn{template(){return ci.createElement("div",{class:()=>({"dcg-functions-popover":!0,"dcg-popover":!0,"dcg-top":!0,"dcg-two-column":this.shouldRenderWithTwoColumns()}),id:this.const(`dcg-functions-popover-${Qn.uuid}`),role:ci.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-button-functions")},ci.createElement("div",{class:ci.const("dcg-popover-interior")},ci.createElement("div",{class:ci.const("dcg-interior-buttons")},ci.createElement(X5,{each:this.bindFn(this.getKeypadKeys),key:r=>r.id},ci.createElement("div",{class:ci.const("dcg-basic-keypad dcg-do-not-blur")},r=>ci.createElement("div",{class:ci.const("dcg-keypad-keys-section")},ci.createElement(YL,{predicate:()=>r.title!==void 0},()=>ci.createElement("div",{class:ci.const("dcg-section-heading"),role:ci.const("heading"),"aria-level":ci.const("2")},()=>r.title,ci.createElement(YL,{predicate:()=>!!r.helpLink},()=>ci.createElement("a",{href:()=>r.helpLink.url,target:ci.const("_blank"),"aria-label":()=>r.helpLink.tooltip},ci.createElement("i",{class:ci.const("dcg-icon-question-sign"),"aria-hidden":ci.const("true")}))))),ci.createElement(YL,{predicate:()=>r.title===void 0},()=>ci.createElement("div",{class:ci.const("dcg-popover-section-separator"),role:ci.const("separator")})),ci.createElement(X5,{each:()=>r.keys},ci.createElement("div",{class:ci.const("dcg-keypad-keys-buttons")},e=>this.b(e)))))))),ci.createElement("div",{class:ci.const("dcg-arrow")}))}shouldRenderWithTwoColumns(){let r=this.controller.getGraphSettings().config.projectorMode?410:375;return this.controller.getLayoutMeasurements().width<r}getInverseTrigSection(){let r=this.controller.areFunctionsRestricted()?["arcsin","arccos","arctan"]:["arcsin","arccos","arctan","arccsc","arcsec","arccot"];return{id:"inversetrig",title:this.controller.s("graphing-calculator-heading-inverse-trig"),keys:r}}getGeometryTools(){let r=["midpoint","intersection","segment","line","ray","parallel","perpendicular","circle","arc","angle","directedangle","polygon","glider"];return{id:"geometry-tools",title:this.controller.s("graphing-calculator-heading-geometry-tools"),keys:r}}getGeometryTransformations(){let r=["dilate","rotate","reflect","translate"];return{id:"geometry-transformations",title:this.controller.s("graphing-calculator-heading-geometry-transformations"),keys:r}}getGeometryMeasurements(){let r=["distance","length","area","perimeter","vertices","angles","directedangles","segments","radius","center","coterminal","supplement"];return{id:"geometry-measurements",title:this.controller.s("graphing-calculator-heading-geometry-measurements"),keys:r}}getCalculatorGeometryMethods(){let e=!this.controller.areFunctionsRestricted()||this.controller.areGeometryFunctionsForceEnabled()?["polygon","distance","midpoint"]:["polygon"];return{id:"geometry",title:this.controller.s("graphing-calculator-heading-geometry"),keys:e}}getTrigSection(){let r=this.controller.areFunctionsRestricted()?["sin","cos","tan"]:["sin","cos","tan","csc","sec","cot"];return{id:"trig",title:this.controller.s("graphing-calculator-heading-trig"),keys:r}}getHyperbolicTrigSection(){let r=this.controller.areFunctionsRestricted()?["sinh","cosh","tanh"]:["sinh","cosh","tanh","csch","sech","coth"];return{id:"hyperbtrig",title:this.controller.s("graphing-calculator-heading-hyperbolic-trig"),keys:r}}getListFunctions(){return{id:"lists",title:this.controller.s("graphing-calculator-heading-lists"),keys:["join","sort","shuffle","unique","for"]}}getStatTests(){return{id:"stat-tests",title:this.controller.s("graphing-calculator-heading-stat-tests"),keys:["ttest","tscore","ittest"]}}getStatsSection(){let r=["mean","median","min","max","quartile","quantile","stdev","stdevp","var"];return this.controller.areFunctionsRestricted()||(r=r.concat(["mad","cov","covp"])),r=r.concat(["corr","spearman","stats","length","total"]),{id:"stats",title:this.controller.s("graphing-calculator-heading-stats"),keys:r}}getMiscSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-number-theory"),id:"misc",keys:["lcm","gcd","mod","ceil","floor","round","sign","nthroot","nPr","nCr"]}}getVisualizationsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-visualizations"),id:"visualizations",keys:["histogram","dotplot","boxplot"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-visualizations")}}}getCalculusSection(){return{title:this.controller.s("graphing-calculator-heading-calculus"),id:"calculus",keys:["exp","ln","log","loga","ddx","prime","integral","sum","prod"]}}getDistributionsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-distributions"),id:"distributions",keys:["normaldist","tdist","poissondist","binomialdist","uniformdist","pdf","cdf","inversecdf","random"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022401451-Distributions",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-distributions")}}}getColorsSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-custom-colors"),id:"colors",keys:["rgb","hsv"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/4406795899533-Custom-Colors",tooltip:this.controller.s("graphing-calculator-button-functions-menu-custom-colors")}}}getAdvancedSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-advanced"),id:"advanced",keys:["->","with"],helpLink:{url:"https://help.desmos.com/hc/en-us/sections/4406370087053-Advanced-Features",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-advanced")}}}getKeypadKeys(){let r=[this.getTrigSection(),this.getInverseTrigSection(),this.getStatsSection(),this.getListFunctions()];return this.controller.areDistributionsEnabled()&&(r.push(this.getVisualizationsSection()),r.push(this.getDistributionsSection()),r.push(this.getStatTests())),r.push(this.getCalculusSection()),r.push(this.getHyperbolicTrigSection()),this.controller.isGeometry()?(r.push(this.getGeometryTools()),r.push(this.getGeometryMeasurements()),r.push(this.getGeometryTransformations())):r.push(this.getCalculatorGeometryMethods()),r.push(this.getColorsSection()),r.push(this.getMiscSection()),this.controller.areActionsEnabled()&&r.push(this.getAdvancedSection()),r}b(r){return x(this,r,{style:"popover"})}};ct();var{SwitchUnion:HQ,If:XL}=er.Components,Xk=class extends Qn{template(){return er.createElement("div",{class:er.const("dcg-keypad"),role:er.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad")},er.createElement("div",{class:()=>({"dcg-keys-container":!0,"dcg-smaller-functions-text":this.controller.getLayoutMeasurements().width<650,"dcg-small-ABC":this.controller.getLayoutMeasurements().width<490,"dcg-smaller-ABC":this.controller.getLayoutMeasurements().width<420,"dcg-smallest-ABC":this.controller.getLayoutMeasurements().width<380}),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer),"aria-hidden":()=>!this.controller.isKeypadOpen()},er.createElement("div",{class:er.const("dcg-keys-background dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()})},er.createElement("div",{class:er.const("dcg-keys")},HQ(()=>this.controller.getKeypadLayout(),{letters:()=>er.createElement(Hk,{controller:this.props.controller}),capitalLetters:()=>er.createElement(qk,{controller:this.props.controller}),mainNumbers:()=>er.createElement(zk,{controller:this.props.controller}),noQwertyLetters:()=>er.createElement($k,{controller:this.props.controller}),noQwertyCapitalLetters:()=>er.createElement(Wk,{controller:this.props.controller}),audio:()=>er.createElement(Jk,{controller:this.props.controller})}),er.createElement(XL,{predicate:()=>this.controller.isKeypadFunctionsPopoverOpen()},()=>er.createElement(Yk,{controller:this.props.controller}))),er.createElement(XL,{predicate:()=>this.controller.isHideKeypadButtonVisible()},()=>er.createElement("div",{class:er.const("dcg-minimize-keypad-container")},er.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-keypad"),gravity:this.const("ne"),offset:this.const({left:6})},er.createElement("div",{role:er.const("button"),"aria-expanded":er.const("true"),"aria-controls":this.const(Qn.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-keypad"),class:er.const("dcg-minimize-keypad"),style:()=>({"border-bottom-color":this.controller.getPillboxBackgroundColor(),background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!0})}},er.createElement("i",{class:er.const("dcg-icon-keyboard"),"aria-hidden":er.const("true")}),er.createElement("i",{class:er.const("dcg-icon-caret-down"),"aria-hidden":er.const("true")}))))))),er.createElement(XL,{predicate:this.bindFn(this.isShowKeypadButtonVisible)},()=>er.createElement("div",{class:er.const("dcg-show-keypad-container")},er.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-show-keypad"),gravity:this.const("ne")},er.createElement("div",{role:er.const("button"),"aria-expanded":er.const("false"),"aria-controls":this.const(Qn.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-show-keypad"),class:er.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})}},er.createElement("i",{class:er.const("dcg-icon-keyboard"),"aria-hidden":er.const("true")}),er.createElement("i",{class:er.const("dcg-icon-caret-up dcg-do-not-blur"),"aria-hidden":er.const("true")}))))))}didMountContainer(r){this.containerElt=r}isShowKeypadButtonVisible(){return this.controller.getBrailleMode()!=="none"?!1:!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&(this.controller.isListVisible()||this.controller.inAudioTraceMode())}didMount(){this.updatePopoverPosition()}didUpdate(){this.updatePopoverPosition()}computeStyles(){let r={};return this.controller.isNarrow()||(r.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(r.opacity="0",r.transform="translate3d(0, 255px, 0)"),r}updatePopoverPosition(){if(!this.controller.isKeypadFunctionsPopoverOpen()){this.__popoverCache=void 0;return}let r=this.controller.computeMajorLayout(),e={keypadTop:r.keypad.top,keypadWidth:r.keypad.width,keypadHeight:r.keypad.height,showToLeft:r.grapher.height<525};if(__dcg_shared_module_exports__['G'](e,this.__popoverCache))return;this.__popoverCache=e;let t=O(this.containerElt),i=t.find("[dcg-command=functions]"),n=t.find(".dcg-functions-popover"),o=t.find(".dcg-arrow");if(e.showToLeft){n.removeClass("dcg-top").addClass("dcg-left");var s=e.keypadHeight-(i.offset().top-t.offset().top),a=s-i.outerHeight()/2-2-10;o.css({left:"auto",bottom:a})}else n.removeClass("dcg-left").addClass("dcg-top"),o.css({left:n.width()-i.width()/2,bottom:"auto"})}};var Ao=__dcg_shared_module_exports__['h'](X());var Fi=__dcg_shared_module_exports__['h'](X()),{SwitchUnion:qQ}=Fi.Components,Qx=class extends Fi.Class{template(){return this.controller=this.props.controller(),qQ(()=>this.controller.getBrandingMode(),{"static-edit-link":()=>Fi.createElement("div",{class:Fi.const("dcg-graphpaper-branding")},Fi.createElement("a",{href:()=>this.controller.getEditLink(),target:Fi.const("_blank")},Fi.createElement("span",{class:Fi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),Fi.createElement("i",{class:Fi.const("dcg-icon-desmos"),"aria-hidden":Fi.const("true")}))),"edit-link":()=>Fi.createElement("div",{class:Fi.const("dcg-graphpaper-branding")},Fi.createElement("span",{class:Fi.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},Fi.createElement("span",{class:Fi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),Fi.createElement("i",{class:Fi.const("dcg-icon-desmos"),"aria-hidden":Fi.const("true")}))),"powered-by":()=>Fi.createElement("div",{class:Fi.const("dcg-graphpaper-branding dcg-unclickable")},Fi.createElement("span",{class:Fi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),Fi.createElement("i",{class:Fi.const("dcg-icon-desmos"),"aria-hidden":Fi.const("true")}))})}};var pe=__dcg_shared_module_exports__['h'](X());ct();var Os=__dcg_shared_module_exports__['h'](X());var{If:zQ}=Os.Components,$c=class extends Os.Class{init(){this.controller=this.props.controller()}template(){return Os.createElement(Ke,{tooltip:this.bindFn(this.getTooltip),gravity:this.const("w")},Os.createElement("div",{class:()=>({"dcg-action-settings":!0,"dcg-icon-btn":!0,"dcg-btn-flat-gray":this.isPillbox(),"dcg-settings-pillbox":this.isPillbox()}),style:()=>({background:this.isPillbox()?this.controller.getPillboxBackgroundColor():void 0}),role:Os.const("button"),tabindex:Os.const("0"),"aria-haspopup":Os.const("true"),"aria-expanded":()=>this.controller.isGraphSettingsOpen(),"aria-label":this.bindFn(this.getTooltip),onTap:this.bindFn(this.onTapSettingsButton),manageFocus:this.const(Vt({controller:this.controller,location:{type:"settings",location:"icon"}}))},Os.createElement("i",{class:Os.const("dcg-icon-wrench"),"aria-hidden":Os.const("true")}),Os.createElement(zQ,{predicate:()=>this.controller.getLockViewportUserSetting()},()=>Os.createElement("i",{class:Os.const("dcg-icon-lock"),"aria-hidden":Os.const("true")}))))}getTooltip(){return this.controller.isGeometry()?this.controller.s("graphing-calculator-label-tooltip-geometry-settings"):this.controller.s("graphing-calculator-label-tooltip-graph-settings")}isPillbox(){return this.props.isPillbox&&this.props.isPillbox()}onTapSettingsButton(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:e.device==="keyboard"})}};var Ri=__dcg_shared_module_exports__['h'](X());var Yp=__dcg_shared_module_exports__['h'](X());var xg=class extends Yp.Class{template(){return Yp.createElement("div",{class:Yp.const("dcg-checkbox-title dcg-lock-viewport-option")},Yp.createElement(Gt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport")),Yp.createElement(Wp,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller}))}};var{If:Qk}=Ri.Components,Zk=class extends Ri.Class{init(){this.controller=this.props.controller(),this.isOpen=this.getAxisScale("x")==="logarithmic"||this.getAxisScale("y")==="logarithmic"||this.props.controller().getLockViewportUserSetting()}template(){return Ri.createElement("div",{class:Ri.const("dcg-advanced-viewport-settings-view")},Ri.createElement(Qk,{predicate:()=>this.shouldShowLogScalesOption()},()=>Ri.createElement("div",null,Ri.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabindex:Ri.const(0),role:Ri.const("button"),"aria-pressed":()=>this.isOpen},Ri.createElement("div",{class:Ri.const("dcg-caret-container")},Ri.createElement("i",{class:Ri.const("dcg-icon-caret-down"),"aria-hidden":Ri.const("true")})),()=>this.controller.s("graphing-calculator-label-more-viewport-options")),Ri.createElement(Qk,{predicate:()=>this.isOpen},()=>Ri.createElement("div",{class:Ri.const("dcg-advanced-contents")},Ri.createElement("div",{class:Ri.const("dcg-log-axes-container")},Ri.createElement("div",null,()=>this.getAxisScaleLabel("x")),Ri.createElement(Rr,{ariaGroupLabel:()=>this.getAxisScaleLabel("x"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("x"))}),Ri.createElement("div",null,()=>this.getAxisScaleLabel("y")),Ri.createElement(Rr,{ariaGroupLabel:()=>this.getAxisScaleLabel("y"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("y"))})),Ri.createElement(Qk,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Ri.createElement(xg,__dcg_shared_module_exports__['a']({},this.props))))))),Ri.createElement(Qk,{predicate:()=>!this.controller.getLockViewportConfigSetting()&&!this.shouldShowLogScalesOption()},()=>Ri.createElement(xg,__dcg_shared_module_exports__['a']({},this.props))))}toggleOpen(){this.isOpen=!this.isOpen,this.update()}getAxisScaleLabel(e){return e==="x"?this.controller.s("graphing-calculator-label-settings-x-axis")+":":this.controller.s("graphing-calculator-label-settings-y-axis")+":"}getStaticConfigForAxis(e){return[{key:"linear",label:()=>"Linear",selected:()=>this.getAxisScale(e)==="linear",onSelect:()=>this.setAxisScale({axis:e,scale:"linear"})},{key:"logarithmic",label:()=>"Logarithmic",selected:()=>this.getAxisScale(e)==="logarithmic",onSelect:()=>this.setAxisScale({axis:e,scale:"logarithmic"})}]}shouldShowLogScalesOption(){return this.controller.getGraphSettings().config.logScales&&!this.controller.isThreeDMode()}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}setAxisScale({axis:e,scale:t}){return this.controller.dispatch({type:"set-graph-settings",[e==="x"?"xAxisScale":"yAxisScale"]:t})}};var vg=__dcg_shared_module_exports__['h'](X());var Xp=class extends vg.Class{init(){this.controller=this.props.controller()}template(){return vg.createElement("div",{class:vg.const("dcg-options-menu-section dcg-radiangroup")},vg.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),staticConfig:this.bindFn(this.getAngleModeOptions)}))}getAngleModeOptions(){return[{key:"radians",label:()=>this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"radian-mode"}}},{key:"degrees",label:()=>this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"degree-mode"}}}]}getDegreeMode(){return!!this.controller.getGraphSettings().degreeMode}setDegreeMode(e){this.controller.dispatch({type:"set-graph-settings",degreeMode:e})}};var Hu=__dcg_shared_module_exports__['h'](X());var Qp=class extends Hu.Class{init(){this.controller=this.props.controller()}template(){return Hu.createElement("div",null,Hu.createElement("div",{class:Hu.const("dcg-displaysizegroup")},Hu.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),Hu.createElement(Gt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(Vt({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"default-size"}}},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"large-size"}}}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"set-projector-mode",value:e})}getProjectorMode(){return!!this.controller.getGraphSettings().config.projectorMode}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}};var{Input:Q5,If:Ia,IfElse:Z5}=pe.Components,Hd=class extends pe.Class{template(){return pe.createElement(fr,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1),containerClass:()=>({"dcg-log-scale":this.props.axisScale()==="logarithmic"})})}},eG=class extends pe.Class{init(){this.controller=this.props.controller(),this.uuid=Md()}template(){return pe.createElement("div",{class:pe.const("dcg-settings-view-container")},pe.createElement($c,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!0)})),pe.createElement(Ia,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>pe.createElement("div",{class:pe.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},pe.createElement("div",{class:pe.const("dcg-popover-interior"),role:pe.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},pe.createElement("div",{class:pe.const("dcg-visual-settings")},pe.createElement(Qp,{controller:this.props.controller}),pe.createElement(Ia,{predicate:()=>this.controller.getBrailleControls()},()=>pe.createElement("div",{class:pe.const("dcg-braille-container dcg-braille-mode")},pe.createElement(Gt,{onChange:this.bindFn(this.toggleBrailleMode),checked:()=>this.controller.getBrailleMode()!=="none"},()=>this.controller.s("shared-calculator-narration-braille-mode")),pe.createElement(Ia,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>pe.createElement("div",{class:pe.const("dcg-braille-options-container")},pe.createElement("div",{class:pe.const("dcg-braille-options-buttons")},pe.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),pe.createElement("div",{class:pe.const("dcg-checkbox-title dcg-six-key-checkbox")},pe.createElement(Gt,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),pe.createElement("a",{href:pe.const("accessibility#braille"),"aria-label":()=>this.controller.s("graphing-calculator-link-learn-more"),class:pe.const("dcg-six-key-info"),target:pe.const("_blank")},pe.createElement("i",{class:pe.const("dcg-icon-question-sign"),"aria-hidden":pe.const("true")}))),pe.createElement("div",{class:pe.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",pe.createElement("a",{href:()=>"braille-examples?"+this.controller.getBrailleMode(),target:pe.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))))),pe.createElement("div",{class:pe.const("dcg-top-section-flex dcg-grid-settings-container")},pe.createElement("div",{class:pe.const("dcg-grid-settings")},pe.createElement(Gt,{class:this.const("dcg-settings-grid-toggle"),onChange:this.bindFn(this.toggleGrid),checked:this.bindFn(this.getShowGrid)},()=>this.controller.s("graphing-calculator-label-settings-grid")),pe.createElement(Ia,{predicate:this.bindFn(this.getShowGrid)},()=>pe.createElement("div",{class:pe.const("dcg-circle-icon-group dcg-grid-group")},pe.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-selected":!this.getPolarMode()}),role:pe.const("button"),tabindex:pe.const("0"),"aria-pressed":()=>!this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-cartesian-grid"),onTap:this.bindFn(this.setCartesianMode)},pe.createElement("i",{class:pe.const("dcg-icon-cartesian")})),pe.const("\xA0"),pe.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-selected":this.getPolarMode()}),role:pe.const("button"),tabindex:pe.const("0"),"aria-pressed":()=>this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-polar-grid"),onTap:this.bindFn(this.setPolarMode)},pe.createElement("i",{class:pe.const("dcg-icon-polar")})))),pe.createElement(Gt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")),pe.createElement(Ia,{predicate:()=>this.getAxisArrowMode()!=="NONE"},()=>pe.createElement("div",{class:pe.const("dcg-circle-icon-group dcg-arrow-group")},pe.createElement("div",{role:pe.const("button"),tabindex:pe.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="BOTH"}),"dcg-arrows":pe.const("BOTH"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-both"),"aria-pressed":()=>this.getAxisArrowMode()==="BOTH",onTap:()=>this.setAxisArrowMode("BOTH")},pe.createElement("i",{class:pe.const("dcg-icon-arrows-two"),"aria-hidden":pe.const("true")})),pe.const("\xA0"),pe.createElement("div",{role:pe.const("button"),tabindex:pe.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="POSITIVE"}),"dcg-arrows":pe.const("POSITIVE"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-positive"),"aria-pressed":()=>this.getAxisArrowMode()==="POSITIVE",onTap:()=>this.setAxisArrowMode("POSITIVE")},pe.createElement("i",{class:pe.const("dcg-icon-arrows-one"),"aria-hidden":pe.const("true")}))))),pe.createElement("div",{class:pe.const("dcg-top-checkboxes-container")},pe.createElement(Gt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),pe.createElement(Ia,{predicate:()=>this.getShowGrid()&&!this.getPolarMode()},()=>pe.createElement(Gt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines"))),pe.createElement(Ia,{predicate:()=>this.controller.canUseAdvancedStyling()&&!this.getPolarMode()},()=>pe.createElement(Gt,{checked:()=>this.controller.getGraphSettings().restrictGridToFirstQuadrant,onChange:e=>this.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e}),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-one-quadrant"))),pe.createElement(Ia,{predicate:this.bindFn(this.showZoomSquareButton)},()=>pe.createElement("div",{role:pe.const("button"),tabindex:pe.const("0"),class:pe.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square"))))),pe.createElement("div",{class:pe.const("dcg-axes-settings-container")},pe.createElement(Ia,{predicate:()=>!this.controller.isThreeDMode()},()=>pe.createElement("div",{class:pe.const("dcg-checkbox-title dcg-x-axis-title")},pe.createElement(Gt,{onChange:this.bindFn(this.toggleXAxis),checked:this.bindFn(this.getShowXAxis)},pe.createElement("span",{id:this.const(`x-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-x-axis"))),pe.createElement(Ia,{predicate:this.bindFn(this.getShowXAxis)},()=>pe.createElement("div",{class:pe.const("dcg-axis-label")},pe.createElement("label",{for:this.const(`x-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),pe.createElement(Q5,{class:this.const("dcg-x-axis-label"),disabled:()=>this.getShowXAxis()?void 0:!0,onInput:this.bindFn(this.onXAxisLabelInput),value:this.bindFn(this.getXAxisLabel),"aria-describedby":this.const(`x-axis-description-${this.uuid}`),id:this.const(`x-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-label-placeholder")}))))),pe.createElement("div",{class:pe.const("dcg-editable-mathquill-container dcg-x-axis-options")},pe.createElement(Hd,{limit:this.const("xmin"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),pe.createElement(tt,{config:this.const({}),latex:this.const("\\le x\\le")},pe.createElement("span",{class:pe.const("dcg-interval-interior")})),pe.createElement(Hd,{limit:this.const("xmax"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),pe.createElement(Ia,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>Z5(()=>this.getAxisScale("x")==="linear",{true:()=>pe.createElement("span",{class:pe.const("dcg-step-container")},pe.createElement("span",{class:pe.const("dcg-step-label"),"aria-hidden":pe.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),pe.createElement(Hd,{limit:this.const("xstep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>pe.createElement("span",{style:pe.const("display: none")})}))),pe.createElement(Ia,{predicate:()=>!this.controller.isThreeDMode()},()=>pe.createElement("div",{class:pe.const("dcg-checkbox-title dcg-y-axis-title")},pe.createElement(Gt,{onChange:this.bindFn(this.toggleYAxis),checked:this.bindFn(this.getShowYAxis)},pe.createElement("span",{id:this.const(`y-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-y-axis"))),pe.createElement(Ia,{predicate:this.bindFn(this.getShowYAxis)},()=>pe.createElement("div",{class:pe.const("dcg-axis-label")},pe.createElement("label",{for:this.const(`y-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),pe.createElement(Q5,{class:this.const("dcg-y-axis-label"),onInput:this.bindFn(this.onYAxisLabelInput),value:this.bindFn(this.getYAxisLabel),"aria-describedby":this.const(`y-axis-description-${this.uuid}`),id:this.const(`y-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-label-placeholder")}))))),pe.createElement("div",{class:pe.const("dcg-editable-mathquill-container dcg-y-axis-options")},pe.createElement(Hd,{limit:this.const("ymin"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),pe.createElement(tt,{config:this.const({}),latex:this.const("\\le y\\le")},pe.createElement("span",{class:pe.const("dcg-interval-interior")})),pe.createElement(Hd,{limit:this.const("ymax"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),pe.createElement(Ia,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>Z5(()=>this.getAxisScale("y")==="linear",{true:()=>pe.createElement("span",{class:pe.const("dcg-step-container")},pe.createElement("span",{class:pe.const("dcg-step-label"),"aria-hidden":pe.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),pe.createElement(Hd,{limit:this.const("ystep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>pe.createElement("span",{style:pe.const("display: none")})}))),pe.createElement(Ia,{predicate:()=>this.controller.isThreeDMode()},()=>pe.createElement("div",null,pe.createElement("div",{class:pe.const("dcg-editable-mathquill-container dcg-z-axis-options")},pe.createElement(Hd,{limit:this.const("zmin"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),pe.createElement(tt,{config:this.const({}),latex:this.const("\\le z\\le")},pe.createElement("span",{class:pe.const("dcg-interval-interior")})),pe.createElement(Hd,{limit:this.const("zmax"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})))),pe.createElement(Zk,{controller:this.props.controller})),pe.createElement(Xp,{controller:this.props.controller}),pe.createElement("div",{class:pe.const("dcg-arrow")})))))}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}didMountContainer(e){this.node=e,O(document).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),O(document).on("keydown.settings-view",t=>{let i=Re(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;t.shiftKey?t.shiftKey&&(n.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):n.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){O(document).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&O(document.activeElement).closest(this.node).length&&xa(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=O(e.target),i=!!t.closest(this.node).length,n=!!t.closest(".dcg-action-settings").length,o=this.isMathquillFocused()&&t.closest(".dcg-keypad").length,s=!!t.closest(".dcg-action-undo").length||!!t.closest(".dcg-action-redo").length;return!(i||n||o||s)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=Si(this.getLimitLatex("xmin"),e),i=Si(this.getLimitLatex("xmax"),e),n=Si(this.getLimitLatex("ymin"),e),o=Si(this.getLimitLatex("ymax"),e),s=this.getLimitLatex("xstep")===""?0:Si(this.getLimitLatex("xstep"),e),a=this.getLimitLatex("ystep")===""?0:Si(this.getLimitLatex("ystep"),e),l={},c=new hn(t,i,n,o);return isFinite(t)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(t),l.xmax=!isFinite(i)),isFinite(n)&&isFinite(o)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(n),l.ymax=!isFinite(o)),l.xstep=!bm(s),l.ystep=!bm(a),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}onXAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})}onYAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})}getXAxisLabel(){return this.controller.getGraphSettings().xAxisLabel}getYAxisLabel(){return this.controller.getGraphSettings().yAxisLabel}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleXAxis(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})}getShowYAxis(){return!!this.controller.getGraphSettings().showYAxis}toggleYAxis(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getPolarMode(){return!!this.controller.getGraphSettings().polarMode}setPolarMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!0})}setCartesianMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!1})}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}setAxisArrowMode(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}showZoomSquareButton(){let e=this.controller.getAxisScaleSettings();return!this.controller.isThreeDMode()&&e.xAxisScale===e.yAxisScale&&!this.controller.getGraphSettings().squareAxes}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}};var Or=__dcg_shared_module_exports__['h'](X());ct();var qt=__dcg_shared_module_exports__['h'](X());var{If:tG}=qt.Components,Zp=class extends qt.Class{template(){return qt.createElement(fr,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1)})}},rG=class extends qt.Class{init(){this.controller=this.props.controller(),this.isOpen=this.props.controller().getLockViewportUserSetting()||this.showZoomSquareButton()}template(){return qt.createElement("div",{class:qt.const("dcg-advanced-viewport-settings-view")},qt.createElement("div",null,qt.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabindex:qt.const(0),role:qt.const("button"),"aria-pressed":()=>this.isOpen},qt.createElement("div",{class:qt.const("dcg-caret-container")},qt.createElement("i",{class:qt.const("dcg-icon-caret-down"),"aria-hidden":qt.const("true")})),()=>this.controller.s("graphing-calculator-label-edit-graph-bounds"),qt.createElement(tG,{predicate:this.bindFn(this.showZoomSquareButton)},()=>qt.createElement("div",{role:qt.const("button"),tabindex:qt.const("0"),class:qt.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square")))),qt.createElement(tG,{predicate:()=>this.isOpen},()=>qt.createElement("div",{class:qt.const("dcg-advanced-contents")},qt.createElement("div",{class:qt.const("dcg-editable-mathquill-container dcg-x-axis-options")},qt.createElement(Zp,{limit:this.const("xmin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),qt.createElement(tt,{config:this.const({}),latex:this.const("\\le x\\le")},qt.createElement("span",{class:qt.const("dcg-interval-interior")})),qt.createElement(Zp,{limit:this.const("xmax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),qt.createElement("div",{class:qt.const("dcg-editable-mathquill-container dcg-y-axis-options")},qt.createElement(Zp,{limit:this.const("ymin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),qt.createElement(tt,{config:this.const({}),latex:this.const("\\le y\\le")},qt.createElement("span",{class:qt.const("dcg-interval-interior")})),qt.createElement(Zp,{limit:this.const("ymax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),qt.createElement("div",null,qt.createElement("div",{class:qt.const("dcg-editable-mathquill-container dcg-z-axis-options")},qt.createElement(Zp,{limit:this.const("zmin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),qt.createElement(tt,{config:this.const({}),latex:this.const("\\le z\\le")},qt.createElement("span",{class:qt.const("dcg-interval-interior")})),qt.createElement(Zp,{limit:this.const("zmax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),qt.createElement(tG,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>qt.createElement(Gt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-lock-graph-bounds"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-lock-graph-bounds"))),qt.createElement(tG,{predicate:()=>!!Ai("beta3d")},()=>qt.createElement(Gt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showBox3D:!this.controller.getGraphSettings().showBox3D})},checked:()=>!!this.controller.getGraphSettings().showBox3D},()=>this.controller.raw("Clip to box")))))))}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=Si(this.getLimitLatex("xmin"),e),i=Si(this.getLimitLatex("xmax"),e),n=Si(this.getLimitLatex("ymin"),e),o=Si(this.getLimitLatex("ymax"),e),s=Si(this.getLimitLatex("zmin"),e),a=Si(this.getLimitLatex("zmax"),e),l={},c=new hn(t,i,n,o,s,a);return isFinite(t)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(t),l.xmax=!isFinite(i)),isFinite(n)&&isFinite(o)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(n),l.ymax=!isFinite(o)),isFinite(s)&&isFinite(a)?(l.zmin=!c.isZValid(),l.zmax=l.zmin):(l.zmin=!isFinite(s),l.zmax=!isFinite(a)),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}toggleOpen(){this.isOpen=!this.isOpen,this.update()}showZoomSquareButton(){return!this.controller.getGraphSettings().squareAxes}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}};var kn=__dcg_shared_module_exports__['h'](X());var{If:e8}=kn.Components,hy=class extends kn.Class{init(){this.controller=this.props.controller()}template(){return kn.createElement(e8,{predicate:this.bindFn(this.shouldShowBrailleSection)},()=>kn.createElement("div",{class:kn.const("dcg-options-menu-section")},kn.createElement("div",{class:kn.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode"),kn.createElement(an,{ariaLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),onChange:this.bindFn(this.toggleBrailleMode),toggled:()=>this.controller.getBrailleMode()!=="none"})),kn.createElement(e8,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>kn.createElement("div",{class:kn.const("dcg-braille-options-container")},kn.createElement("div",{class:kn.const("dcg-braille-options-buttons")},kn.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),kn.createElement("div",{class:kn.const("dcg-checkbox-title dcg-six-key-checkbox")},kn.createElement(Gt,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),kn.createElement(Wp,{href:this.const("accessibility#braille"),controller:this.props.controller})),kn.createElement("div",{class:kn.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",kn.createElement("a",{href:()=>"braille-examples?"+this.controller.getBrailleMode(),class:kn.const("dcg-shared-blue-link"),target:kn.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))))}shouldShowBrailleSection(){return this.controller.getBrailleControls()&&this.controller.getGraphSettings().config.expressions}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}};var{If:iG}=Or.Components,nG=class extends Or.Class{init(){this.controller=this.props.controller()}template(){return Or.createElement("div",{class:Or.const("dcg-settings-view-container dcg-settings-view-3d-container")},Or.createElement($c,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!0)})),Or.createElement(iG,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>Or.createElement("div",{class:Or.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Or.createElement("div",{class:Or.const("dcg-popover-interior dcg-generic-options-menu"),role:Or.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},Or.createElement("div",{class:Or.const("dcg-options-menu-section")},Or.createElement(Qp,{controller:this.props.controller}),Or.createElement(rG,{controller:this.props.controller})),Or.createElement(iG,{predicate:()=>this.getThreeDMode()},()=>Or.createElement("div",{class:Or.const("dcg-options-menu-section")},Or.createElement("div",{class:Or.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Or.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxis3D:!this.controller.getGraphSettings().showAxis3D})},toggled:()=>!!this.controller.getGraphSettings().showAxis3D})),Or.createElement(iG,{predicate:()=>this.controller.getGraphSettings().showAxis3D},()=>Or.createElement("div",{class:Or.const("dcg-show-axis-labels-section")},Or.createElement("div",null,Or.createElement(Gt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxisLabels3D:!this.controller.getGraphSettings().showAxisLabels3D})},checked:()=>!!this.controller.getGraphSettings().showAxisLabels3D},()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d"))),Or.createElement("div",null,Or.createElement(Gt,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showPlane3D:!this.controller.getGraphSettings().showPlane3D})},checked:()=>!!this.controller.getGraphSettings().showPlane3D},()=>this.controller.s("graphing-calculator-label-settings-domain-plane"))))))),Or.createElement(hy,{controller:this.props.controller}),Or.createElement(iG,{predicate:()=>!!Ai("beta3d")},()=>Or.createElement("div",{class:Or.const("dcg-dimensiongroup dcg-options-menu-section")},Or.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-dimension"),staticConfig:this.bindFn(this.getDimensionOptions)}))),Or.createElement(Xp,{controller:this.props.controller}),Or.createElement("div",{class:Or.const("dcg-arrow")})))))}getDimensionOptions(){return[{key:"2d",label:()=>this.controller.s("graphing-calculator-button-settings-2d"),selected:()=>!this.getThreeDMode(),onSelect:()=>this.setTwoDMode(),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"2d-mode"}}},{key:"3d",label:()=>this.controller.s("graphing-calculator-button-settings-3d"),selected:()=>this.getThreeDMode(),onSelect:()=>this.setThreeDMode(),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"3d-mode"}}}]}didMountContainer(e){this.node=e,O(document).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),O(document).on("keydown.settings-view",t=>{let i=Re(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;t.shiftKey?t.shiftKey&&(n.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):n.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){O(document).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&O(document.activeElement).closest(this.node).length&&xa(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=O(e.target),i=!!t.closest(this.node).length,n=!!t.closest(".dcg-action-settings").length,o=this.isMathquillFocused()&&t.closest(".dcg-keypad").length,s=!!t.closest(".dcg-action-undo").length||!!t.closest(".dcg-action-redo").length;return!(i||n||o||s)}isMathquillFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="settings"}getThreeDMode(){return!!this.controller.isThreeDMode()}setTwoDMode(){this.controller.dispatch({type:"set-graph-settings",threeDMode:!1})}setThreeDMode(){this.controller.dispatch({type:"set-graph-settings",threeDMode:!0})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var Br=__dcg_shared_module_exports__['h'](X());var{If:$Q}=Br.Components,Zx=class extends Br.Class{init(){this.controller=this.props.controller()}template(){return Br.createElement("div",{class:Br.const("dcg-zoom-container")},Br.createElement("div",{class:Br.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group"),style:()=>({background:this.controller.getPillboxBackgroundColor()})},Br.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-in"),gravity:this.const("w")},Br.createElement("div",{class:Br.const("dcg-action-zoomin"),role:Br.const("button"),tabindex:Br.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-zoom-in"),onTap:this.bindFn(this.zoomIn)},Br.createElement("i",{class:Br.const("dcg-icon dcg-icon-plus"),"aria-hidden":Br.const("true")}))),Br.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-out"),gravity:this.const("w")},Br.createElement("div",{class:Br.const("dcg-option dcg-action-zoomout dcg-tooltip-e"),tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-out"),role:Br.const("button"),tabindex:Br.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-zoom-out"),onTap:this.bindFn(this.zoomOut)},Br.createElement("i",{class:Br.const("dcg-icon dcg-icon-minus"),"aria-hidden":Br.const("true")})))),Br.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-viewport-default"),gravity:this.const("w")},Br.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-option":!0,"dcg-action-zoomrestore":!0,"dcg-disabled":this.isDefaultViewportRestored()}),"aria-disabled":this.bindFn(this.isDefaultViewportRestored),role:Br.const("button"),tabindex:()=>this.isDefaultViewportRestored()?-1:0,"aria-label":()=>this.controller.s("graphing-calculator-narration-viewport-restore-default"),onTap:this.bindFn(this.setDefaultViewport),style:()=>({background:this.controller.getPillboxBackgroundColor()}),manageFocus:this.const(Vt({controller:this.controller,location:{type:"zoom-restore-btn"}}))},Br.createElement("i",{class:Br.const("dcg-icon dcg-icon-home"),"aria-hidden":Br.const("true")}))),Br.createElement($Q,{predicate:()=>this.controller.isThreeDMode()},()=>Br.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-default-orientation"),gravity:this.const("w")},Br.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-option":!0,"dcg-action-zoomrestore":!0,"dcg-disabled":this.isDefaultOrientation()}),"aria-disabled":this.bindFn(this.isDefaultOrientation),role:Br.const("button"),tabindex:()=>this.isDefaultOrientation()?-1:0,"aria-label":()=>this.controller.s("graphing-calculator-narration-orientation-restore-default"),onTap:this.bindFn(this.zoomRestoreOrientation),style:()=>({background:this.controller.getPillboxBackgroundColor()}),manageFocus:this.const(Vt({controller:this.controller,location:{type:"zoom-restore-btn"}}))},Br.createElement("i",{class:Br.const("dcg-icon dcg-icon-3d-reorient"),"aria-hidden":Br.const("true")})))))}zoomIn(){this.controller.dispatch({type:"zoom",direction:"in"})}zoomOut(){this.controller.dispatch({type:"zoom",direction:"out"})}setDefaultViewport(){this.controller.dispatch({type:"zoom",direction:"default"})}isDefaultViewportRestored(){return this.controller.isDefaultViewportRestored()}zoomRestoreOrientation(){this.controller.dispatch({type:"zoom",direction:"default3dOrientation"})}isDefaultOrientation(){let e=this.controller.getGrapher3d();return e?e.controls.isDefaultOrientation()||e.transition.isAnimating:!0}};var Xa=__dcg_shared_module_exports__['h'](X());var ev=class extends Xa.Class{init(){this.controller=this.props.controller()}template(){return Xa.createElement("div",{class:Xa.const("dcg-reset-container")},Xa.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-reset"),gravity:this.const("w")},Xa.createElement("div",{class:Xa.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray"),role:Xa.const("button"),tabindex:Xa.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-reset"),onTap:this.bindFn(this.reset),style:()=>({background:this.controller.getPillboxBackgroundColor()})},Xa.createElement("i",{class:Xa.const("dcg-icon dcg-icon-reset"),"aria-hidden":Xa.const("true")}))))}reset(){this.controller.dispatch({type:"reset-graph"})}};var{If:gy}=Ao.Components,oG=class extends Ao.Class{init(){this.controller=this.props.controller()}template(){return Ao.createElement("div",null,Ao.createElement(gy,{predicate:this.bindFn(this.shouldShowContainer)},()=>Ao.createElement("div",{class:()=>({"dcg-pillbox-container":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()}),role:()=>this.controller.isGeoUIActive()?void 0:"region","aria-label":()=>this.controller.isGeoUIActive()?void 0:this.controller.s("graphing-calculator-narration-graph-settings-controls")},Ao.createElement("div",{class:Ao.const("dcg-overgraph-pillbox-elements"),style:this.bindFn(this.getContainerStyle)},Ao.createElement(gy,{predicate:this.bindFn(this.shouldShowGraphSettings)},()=>Ao.createElement(eG,{controller:this.props.controller})),Ao.createElement(gy,{predicate:this.bindFn(this.shouldShow3DGraphSettings)},()=>Ao.createElement(nG,{controller:this.props.controller})),Ao.createElement(gy,{predicate:this.bindFn(this.shouldShowGeometrySettings)},()=>Ao.createElement($c,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!0)}))),Ao.createElement(gy,{predicate:this.bindFn(this.shouldShowResetButton)},()=>Ao.createElement(ev,{controller:this.props.controller})),Ao.createElement(gy,{predicate:this.bindFn(this.shouldShowZoomButtons)},()=>Ao.createElement(Zx,{controller:this.props.controller}))))),Ao.createElement(Qx,{controller:()=>this.props.controller()}))}getContainerStyle(){let e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?`bottom: ${e}px;`:"bottom: auto"}shouldShowContainer(){return this.shouldShowGeometrySettings()||this.shouldShowGraphSettings()||this.shouldShow3DGraphSettings()||this.shouldShowZoomButtons()||this.shouldShowResetButton()}shouldShow3DGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&this.controller.is3dProduct()}shouldShowGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isGeometry()&&!this.controller.is3dProduct()}shouldShowGeometrySettings(){return!this.controller.getGraphSettings().config.settingsMenu||!this.controller.isGeometry()?!1:this.controller.getGeoToolbarSuppressedByAuthor()||this.controller.isNarrowGeometryHeader()}shouldShowZoomButtons(){return this.controller.getGraphSettings().config.zoomButtons&&!this.isViewportLocked()}isViewportLocked(){return this.controller.getGraphSettings().config.lockViewport||this.controller.getGraphSettings().userLockedViewport}shouldShowResetButton(){return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper&&this.controller.hasDefaultState()}};var gr=__dcg_shared_module_exports__['h'](X());var Ni=__dcg_shared_module_exports__['h'](X());var{Each:WQ,SwitchUnion:jQ,If:JQ}=Ni.Components,sG=class extends Ni.Class{init(){this.controller=this.props.controller()}template(){return Ni.createElement("div",{role:Ni.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:Ni.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load dcg-complex-tool-instruction-view")},Ni.createElement(Df,{ariaLabel:()=>this.controller.s("account-shell-button-mygraphs-cancel"),controller:this.props.controller,message:()=>this.getTransformationName(this.controller.getActiveTool()),onBack:this.bindFn(this.onCancel)}),WQ(()=>this.getInputIndexes(),{item:e=>Ni.createElement(QL,{activeStep:this.bindFn(this.getInputIndex),controller:this.props.controller,toolSpec:()=>this.getToolSpec(),stepIdx:()=>e})}))}onCancel(){this.controller.dispatch({type:"select-geo-tool",tool:"selection"}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:"selection"}})}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");case"parallel":return this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");case"perpendicular":return this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");case"compass":return this.controller.s("graphing-calculator-text-geometry-tool-compass-display-name");default:return this.controller.s("shared-calculator-narration-item-unknown")}}getInputIndex(){return this.controller.getGeoModel().getNonObjectsState().ui.currentTool.inputIndex}getInputIndexes(){return this.getToolSpec().inputs.map((e,t)=>t)}getToolSpec(){return this.controller.getGeoModel().getCurrentTool().getSpec()}},QL=class extends Ni.Class{init(){this.controller=this.props.controller()}template(){return jQ(()=>this.getInputType(),{completed:()=>Ni.createElement("span",{class:Ni.const("dcg-step-completed")},Ni.createElement("i",{class:Ni.const("dcg-icon-check"),"aria-hidden":Ni.const("true")})),upcoming:()=>Ni.createElement("span",{class:Ni.const("dcg-step-upcoming")},Ni.createElement("span",null)),active:()=>Ni.createElement("span",{class:Ni.const("dcg-active-step")},Ni.createElement("span",{class:Ni.const("dcg-step-active-icon")},Ni.createElement("span",null,()=>this.props.stepIdx()+1)),this.bindFn(this.getActiveString),Ni.createElement(JQ,{predicate:this.bindFn(this.isNumberInputStep)},()=>Ni.createElement("span",{class:Ni.const("dcg-input-flex-container"),didMount:this.bindFn(this.didMountNumberInput)},Ni.createElement(fr,{containerClass:()=>({"dcg-suffix-degree":this.getNumberUnits()==="\xB0","dcg-suffix-radian":this.getNumberUnits()==="rad"}),readonly:()=>!1,latex:()=>this.getNumberInputLatex(),ariaLabel:this.bindFn(this.getActiveString),isFocused:()=>this.isNumberInputFocused(),handleFocusChanged:(e,t)=>this.handleFocusedChanged(e,t),hasError:this.bindFn(this.doesNumberInputHaveError),controller:this.props.controller,handlePressedKey:(e,t)=>{this.handlePressedKey(e,t)},handleLatexChanged:e=>{this.handleLatexChanged(e)},dataLabelAttributeValue:this.const("transformation-number")}),Ni.createElement("span",{class:()=>({"dcg-action-submit":!0,"dcg-disabled":this.isSubmitNumberDisabled(),"dcg-btn-blue":!0}),role:Ni.const("button"),tabindex:()=>this.isSubmitNumberDisabled()?-1:0,"aria-disabled":this.bindFn(this.isSubmitNumberDisabled),onTap:e=>this.submitNumberInput({device:e.device})},()=>this.controller.s("shared-calculator-button-go")))))})}getNumberUnits(){return this.controller.getActiveTool()==="rotate"?this.controller.isDegreeMode()?"\xB0":"rad":""}didMountNumberInput(){this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}})}isNumberInputFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="new-transformation-number")}doesNumberInputHaveError(){if(!this.getNumberInputLatex()||this.getNumberInputLatex()===this.getStep().defaultLatex)return!1;let t=this.props.toolSpec().outputs[0].id,{idMap:i}=this.controller.getGeoModel().getNonObjectsState().ui.currentTool,n=i[t];if(!n)return!0;let o=qm(this.controller.getListModel()).filter(l=>{var c;if(l.type==="expression")return n===((c=jo(l))==null?void 0:c.latex)}),s=o[0];if(!s||o.length===0||o.length>1||s.error)return!0;let a=s.formula.typed_constant_value;if(!a)return!0;if(__dcg_shared_module_exports__['zb'](a.valueType,__dcg_shared_module_exports__['nb'])){let l=__dcg_shared_module_exports__['vb'](a.valueType)?a.value:[a.value];for(let c of l){let[[u,p],[g,h]]=c;if(isNaN(u)||isNaN(p)||isNaN(g)||isNaN(h))return!0}return!1}return!0}handlePressedKey(e,t){let i=it.getFocusedMathquill();if(e==="Enter"){this.submitNumberInput({device:"keyboard"});return}i&&(i.keystroke(e,t),this.handleLatexChanged(i.latex()))}getNumberInputLatex(){return this.controller.getGeoModel().getCurrentTool().getNumberInputLatex()}isSubmitNumberDisabled(){return!!(this.doesNumberInputHaveError()||!this.getNumberInputLatex())}submitNumberInput(e){var a,l;if(this.isSubmitNumberDisabled())return;let t=this.controller.getGeoModel(),i=this.controller.getActiveTool(),n=t.getCurrentTool(),o=(a=n.getSpec)==null?void 0:a.call(n),s=n.tryCommitResults();s.committed&&(this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects"},s)),(l=this.controller.get2dPOIController())==null||l.speakGeoReleaseAction(i,o,s.committed),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}handleLatexChanged(e){this.getNumberInputLatex()!==e&&(this.controller.getGeoModel().getCurrentTool().onNumberInput(e),this.controller.getGeoModel().onPreviewChange())}handleFocusedChanged(e,t){e&&!this.isNumberInputFocused()?this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}}):this.isNumberInputFocused()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"new-transformation-number"}})}getActiveString(){let e=this.props.controller(),t=this.getStep().hint;return t?e.s(t):e.s("shared-calculator-narration-item-unknown")}isNumberInputStep(){return this.getStep().type==="number"}getStep(){return this.props.toolSpec().inputs[this.props.stepIdx()]}getInputType(){let e=this.props.activeStep(),t=this.props.stepIdx();return t<e?"completed":t>e?"upcoming":"active"}};var{SwitchUnion:YQ,If:aG}=gr.Components,lG=class extends gr.Class{constructor(){super(...arguments),this.afterInitialLoad=!1}init(){this.controller=this.props.controller()}template(){return gr.createElement("div",{class:()=>({"dcg-geometry-toolbar-view":!0,"dcg-after-initial-load":this.afterInitialLoad}),style:()=>({left:`${this.controller.computeMajorLayout().grapher.left}px`}),onTapStart:this.bindFn(this.onTapStart)},gr.createElement("div",{class:gr.const("dcg-header-left dcg-do-blur")},gr.createElement(aG,{predicate:this.bindFn(this.showHamburger)},()=>gr.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("se")},gr.createElement("div",{role:gr.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),tabindex:gr.const("0"),class:gr.const("dcg-action-opendrawer dcg-icon-btn dcg-in-api-action-opendrawer"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},gr.createElement("i",{class:gr.const("dcg-icon-hamburger"),"aria-hidden":gr.const("true")})))),gr.createElement(aG,{predicate:this.bindFn(this.showOpenExpressionsButton)},()=>gr.createElement("div",{class:gr.const("dcg-show-expressions-tab dcg-icon-btn"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:gr.const("button"),tabindex:gr.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(Vt({controller:this.controller,location:{type:"show-expression-list-btn"}}))},gr.createElement("i",{class:gr.const("dcg-icon-show"),"aria-hidden":gr.const("true")}))),gr.createElement(aG,{predicate:this.bindFn(this.showUndoRedo)},()=>gr.createElement("div",{class:()=>({"dcg-geo-undo-redo-container":!0,"dcg-overgraph-undo-redo":this.undoRedoOverGraph()})},gr.createElement(Jf,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{undoTooltipGravity:this.const("se"),redoTooltipGravity:this.const("s")}))))),gr.createElement("div",{class:gr.const("dcg-flex-spacer")}),YQ(this.bindFn(this.getViewToShow),{tools:()=>gr.createElement(Nk,{controller:this.props.controller}),selectedItems:()=>gr.createElement(lE,{controller:this.props.controller}),recentlyUsedComplexTool:()=>gr.createElement("div",{class:gr.const("dcg-complex-tool-success dcg-animate-in-after-initial-load"),role:gr.const("toolbar")},gr.createElement("i",{class:gr.const("dcg-icon-check")}),()=>this.controller.s("account-shell-label-success")),complexToolInstructions:()=>gr.createElement(sG,{controller:this.props.controller})}),gr.createElement("div",{class:gr.const("dcg-flex-spacer")}),gr.createElement("div",{class:gr.const("dcg-header-right dcg-do-blur")},gr.createElement(aG,{predicate:()=>this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isNarrowGeometryHeader()},()=>gr.createElement($c,__dcg_shared_module_exports__['a']({},this.props)))))}undoRedoOverGraph(){return this.controller.isNarrowGeometryHeader()}showUndoRedo(){return!this.controller.isListEnabled()}showHamburger(){return this.controller.getGraphSettings().config.showHamburger?!this.controller.isListEnabled()||!this.controller.isListVisible()||this.controller.isNarrow():!1}showOpenExpressionsButton(){return this.controller.isListEnabled()&&!this.controller.isListVisible()&&!this.controller.isNarrow()}willUpdate(){this.afterInitialLoad||this.getViewToShow()==="selectedItems"&&(this.afterInitialLoad=!0)}onTapStart(e){e.target.classList.contains("dcg-do-blur")&&this.controller.dispatch({type:"set-none-selected"})}getViewToShow(){let e=this.controller.getActiveTool();return __dcg_shared_module_exports__['Xb'](e)||ux(e)?this.controller.getComplexToolWasRecentlyUsed()?"recentlyUsedComplexTool":"complexToolInstructions":this.controller.shouldShowMultiSelectHeader()?"selectedItems":"tools"}};var vr=__dcg_shared_module_exports__['h'](X());var{If:tv}=vr.Components,ZL=class extends vr.Class{init(){this.controller=this.props.controller()}template(){return vr.createElement("span",{class:vr.const("dcg-toast")},vr.createElement("i",{class:vr.const("dcg-icon-error"),"aria-hidden":vr.const("true")}),vr.createElement(tv,{predicate:()=>!this.showUndo()},()=>vr.createElement("i",{class:vr.const("dcg-icon-remove"),onTap:()=>this.controller.dispatch({type:"toast/close"}),role:vr.const("link"),tabindex:vr.const(0),"aria-label":vr.const("Dismiss Notice")})),vr.createElement("span",{class:vr.const("dcg-msg"),"aria-atomic":()=>this.shouldLiveUpdateAria(),"aria-live":()=>this.shouldLiveUpdateAria()?"assertive":""},()=>this.controller.toastData.message),vr.createElement(tv,{predicate:this.bindFn(this.showUndo)},()=>vr.createElement("a",{role:vr.const("link"),tabindex:vr.const(0),class:vr.const("dcg-undo"),onTap:()=>this.controller.dispatch({type:"toast/undo"})},()=>this.controller.s("shared-calculator-label-toast-undo"))),vr.createElement(tv,{predicate:this.bindFn(this.showLearnMore)},()=>vr.createElement("a",{role:vr.const("link"),tabindex:vr.const(0),target:vr.const("_blank"),onTap:()=>this.controller.dispatch({type:"toast/learn-more"})},()=>this.controller.s("shared-calculator-label-toast-learn-more"))),vr.createElement(tv,{predicate:()=>!!this.controller.toastData.link},()=>vr.createElement("a",{role:vr.const("link"),tabindex:vr.const(0),target:vr.const("_blank"),href:()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.url)||""}},()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.text)||""})))}showUndo(){return!!this.controller.toastData.undoCallback}showLearnMore(){return!!this.controller.toastData.learnMoreCallback}shouldUpdate(){return!!this.controller.toastData.message}shouldLiveUpdateAria(){return!this.controller.toastData.noAria}},cG=class extends vr.Class{template(){return vr.createElement("div",{class:()=>({"dcg-toast-view":!0,"dcg-visible":!!this.props.controller().toastData.message,"dcg-below-geo-toolbar":this.isGeometryInCalculator()}),"toast-style":()=>this.props.controller().toastData.toastStyle},vr.createElement(tv,{predicate:()=>!!this.props.controller().toastData.message},()=>vr.createElement("div",{class:vr.const("dcg-toast-wrapper")},vr.createElement("div",{class:vr.const("dcg-toast-cover")}),vr.createElement(ZL,__dcg_shared_module_exports__['a']({},this.props)))))}isGeometryInCalculator(){var t;let e=this.props.controller();return(t=e.isGeometry)==null?void 0:t.call(e)}};ct();function rv(r){let e="drag dragend dragenter dragover dragleave drop";O(r).on(e,t=>{t.preventDefault(),t.stopPropagation()})}var Jr=__dcg_shared_module_exports__['h'](X());ct();var Bo=__dcg_shared_module_exports__['h'](X());var Gr=__dcg_shared_module_exports__['h'](X());var yi=__dcg_shared_module_exports__['h'](X());ct();ct();var e0=class{constructor(){this.handlers=[],O(document).on("keydown.delegator",e=>this.handleEvent(e))}push(e){let t=__dcg_shared_module_exports__['M']("delegator_");return this.handlers.push({token:t,handler:e}),()=>this.handlers=__dcg_shared_module_exports__['n'](this.handlers,i=>i.token!=t)}handleEvent(e){if(!e.isDefaultPrevented()&&this.handlers.length){let t=!1,i=()=>t=!0;for(let{handler:n}of this.handlers.slice().reverse())if(n(e,i),t)return}}},dG=new e0;var{If:t8}=yi.Components,Lo=class extends yi.Class{init(){this.i18n=this.props.i18n(),this.isMounted=!1}template(){return yi.createElement("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.didUnmount)},yi.createElement("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow"})},yi.createElement("div",{class:yi.const("dcg-shared-modal-background"),onTap:this.props.onClose}),yi.createElement("div",{class:yi.const("dcg-shared-modal-transition-container")},yi.createElement("div",{class:yi.const("dcg-shared-modal"),role:yi.const("dialog"),"aria-modal":yi.const("true"),"aria-label":()=>{let e="";return this.props.ariaLabel?e=this.props.ariaLabel():this.props.title&&(e=this.props.title()),e}},yi.createElement(t8,{predicate:()=>this.showX()},()=>yi.createElement("div",{class:yi.const("dcg-shared-close-cross-container")},yi.createElement(Ke,{tooltip:()=>this.i18n.s("shared-button-close-dialog")},yi.createElement("div",{role:yi.const("link"),tabindex:yi.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:yi.const("dcg-shared-close-cross"),onTap:this.props.onClose},yi.createElement("i",{class:yi.const("dcg-icon-remove"),"aria-hidden":yi.const("true")}))))),yi.createElement("div",{class:yi.const("dcg-shared-modal-contents-wrapper")},yi.createElement(t8,{predicate:()=>!!this.props.title&&!!this.props.title()},()=>yi.createElement("h1",{class:()=>({"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle()})},()=>this.props.title())),yi.createElement("div",{class:yi.const("dcg-shared-modal-scrollable-content")},this.children))))))}showX(){return!!this.props.showX&&this.props.showX()}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMount(){if(this.isMounted)return;this.isMounted=!0;let e=document.querySelector(".dcg-shared-modal-container"),t=HB(e);this.unsub=dG.push((i,n)=>{Re(i)==Do&&(this.onClose(),n());let o=i.altKey||i.shiftKey||i.metaKey||i.ctrlKey;this.props.onArrowKey&&Re(i)===hd&&!o&&this.props.onArrowKey("Left"),this.props.onArrowKey&&Re(i)===gd&&!o&&this.props.onArrowKey("Right"),t(i)})}didUpdate(){var t,i;if(this.handledInitialFocus)return;let e=(i=(t=this.props).setFocus)==null?void 0:i.call(t);e==="close"?this.showX()?O(".dcg-shared-modal-container:visible").find(".dcg-shared-close-cross").trigger("focus"):O(".dcg-shared-modal-container:visible").find(".dcg-shared-modal-scrollable-content").trigger("focus"):e==="content"&&O(".dcg-shared-modal-container:visible").find(".dcg-shared-modal-scrollable-content").trigger("focus"),this.handledInitialFocus=!0}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){this.isMounted&&(this.isMounted=!1,this.unsub())}};var{If:uG,Each:r8}=Gr.Components,pG=class extends Gr.Class{init(){this.controller=this.props.controller()}template(){return Gr.createElement(uG,{predicate:this.props.visible},()=>Gr.createElement(Lo,{size:this.const("medium"),onClose:this.props.onClose,i18n:this.const(this.controller),class:this.const("dcg-custom-toolbar-settings-modal")},Gr.createElement("div",{class:Gr.const("dcg-btn-blue dcg-done-btn"),"aria-role":Gr.const("button"),tabindex:Gr.const(0),didMount:e=>e.focus(),onTap:this.props.onClose},()=>this.controller.s("graphing-calculator-button-done")),Gr.createElement("h1",{class:Gr.const("dcg-shared-left-align-title")},()=>this.controller.s("shared-calculator-text-customize-toolbar")),r8(this.bindFn(this.getToolGroups),{key:e=>e.group,item:e=>Gr.createElement("div",null,Gr.createElement("div",{class:Gr.const("dcg-configuration-heading-row dcg-configuration-grid-row")},Gr.createElement("div",{class:Gr.const("dcg-first-column")},()=>e.group,Gr.const(" Tools")),Gr.createElement("div",{class:Gr.const("dcg-second-column")},Gr.const("Disabled when:"))),r8(()=>e.dropdown||[e.current],{item:t=>Gr.createElement("div",{class:Gr.const("dcg-configuration-grid-row"),"dcg-geo-tool":this.const(t)},Gr.createElement("div",{class:Gr.const("dcg-first-column")},Gr.createElement(Gt,{disabled:()=>!this.isToolCustomizable(t),checked:()=>this.getToolInfo(t).visible,onChange:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getToolInfo(t)),{visible:i})})}},()=>t)),Gr.createElement("div",{class:()=>({"dcg-disabled":!this.getToolInfo(t).visible||!this.isToolCustomizable(t),"dcg-mathquill-condition-container":!0,"dcg-second-column":!0})},Gr.createElement(uG,{predicate:()=>!!this.getToolLatexError(t)&&this.getToolInfo(t).visible},()=>Gr.createElement("div",{class:Gr.const("dcg-latex-error-container")},Gr.createElement(ms,{error:()=>this.getToolLatexError(t)||"",gravity:this.const("sw")}))),Gr.createElement(uG,{predicate:()=>this.isToolCustomizable(t)&&this.getToolInfo(t).visible},()=>Gr.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),brailleShouldFocus:()=>this.focusedLatexTool===t,onBrailleInput:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getToolInfo(t)),{disabledLatex:i})})},onBrailleFocusedChanged:i=>{this.focusedLatexTool===t&&!i?this.focusedLatexTool=void 0:i&&(this.focusedLatexTool=t)},onBrailleKeydown:()=>{}},go(this.controller)),Gr.createElement(it,{latex:()=>this.getToolLatex(t),getAriaLabel:()=>this.getToolAria(t),noFadeout:this.const(!0),getAriaPostLabel:()=>this.getToolLatexError(t)||"",isFocused:()=>this.focusedLatexTool===t,tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:()=>this.controller.getMathquillConfig({}),hasError:()=>!!this.getToolLatexError(t),onUserChangedLatex:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getToolInfo(t)),{disabledLatex:i})})},onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>{this.focusedLatexTool===t&&!i?this.focusedLatexTool=void 0:i&&(this.focusedLatexTool=t)},onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),Gr.createElement(uG,{predicate:()=>!this.getToolInfo(t).visible},()=>Gr.createElement("div",{class:Gr.const("dcg-disabled-condition-wrapper")},Gr.createElement(Cn,__dcg_shared_module_exports__['a']({latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),isStatic:this.const(!0),brailleShouldFocus:this.const(!1),onBrailleFocusedChanged:()=>{}},go(this.controller)),Gr.createElement(tt,{latex:()=>this.getToolLatex(t),config:()=>this.controller.getMathquillConfig({}),getAriaLabel:()=>this.getToolAria(t)}))))))}))})))}getToolAria(e){return this.controller.s("shared-calculator-narration-disable-tool",{tool:e})}autoOperatorNames(){return this.props.controller().getMathquillConfig({}).autoOperatorNames}getToolLatex(e){return this.getToolInfo(e).disabledLatex||""}isToolCustomizable(e){return e!=="selection"&&e!=="box-selection"}getToolGroups(){let e={group:"transformation",current:"translate",dropdown:Hf};return[...oM(),e]}getToolLatexError(e){let t=this.controller.getGeometryToolbarModel(),i=xR(t,e);if(i)return this.controller.unpack(i)}getToolInfo(e){let t=this.controller.getGeometryToolbarModel();return __dcg_shared_module_exports__['a']({tool:e},t.toolbarState[e])}};var{If:i8}=Bo.Components,hG=class extends Bo.Class{init(){this.controller=this.props.controller()}template(){return Bo.createElement(i8,{predicate:()=>this.shouldShowAuthorFeaturesSection()},()=>Bo.createElement("div",{class:Bo.const("dcg-options-menu-section dcg-author-mode-section")},Bo.createElement("div",{class:Bo.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-author-mode"),Bo.createElement(an,{ariaLabel:()=>this.controller.s("shared-calculator-narration-author-mode"),toggled:this.bindFn(this.isAuthorMode),onChange:()=>{this.controller.dispatch({type:"set-author-mode",enabled:!this.isAuthorMode()})}})),Bo.createElement(i8,{predicate:()=>this.isAuthorMode()},()=>Bo.createElement("div",{class:Bo.const("dcg-author-features-container")},Bo.createElement("div",{class:Bo.const("dcg-toolbar-customization")},Bo.createElement("span",null,Bo.const("Geometry Tools:")),Bo.createElement(Rr,{theme:this.const("mini"),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-configure-toolbar"),staticConfig:this.bindFn(this.getConfigurationOptions)})),Bo.createElement(pG,{controller:this.props.controller,onClose:()=>{this.customGeometryToolsSettingsModal=!1,this.controller.dispatch({type:"render"})},visible:()=>this.customGeometryToolsSettingsModal})))))}getToolbar(){return this.controller.getGeometryToolbarModel().toolbar}setToolbar(e){e==="custom"&&(this.customGeometryToolsSettingsModal=!0),this.controller.dispatch({type:"set-geometry-toolbar",toolbar:e})}getConfigurationOptions(){return[{key:"all",label:()=>this.controller.raw("All"),selected:()=>this.getToolbar()==="all",onSelect:()=>this.setToolbar("all")},{key:"none",label:()=>this.controller.raw("None"),selected:()=>this.getToolbar()==="none",onSelect:()=>this.setToolbar("none")},{key:"custom",label:()=>this.controller.raw("Custom"),selected:()=>this.getToolbar()==="custom",onSelect:()=>this.setToolbar("custom")}]}shouldShowAuthorFeaturesSection(){return this.controller.authorFeaturesAvailable()}isAuthorMode(){return this.controller.shouldShowAuthorFeatures()}};var{If:gG}=Jr.Components,iv=class extends Jr.Class{init(){this.controller=this.props.controller()}template(){return Jr.createElement("div",{class:()=>({"dcg-geometry-settings-container":!0,"dcg-popover":!0,"dcg-constrained-height-popover":!0,"dcg-generic-options-menu":!0,"dcg-narrow-geometry-header":this.controller.isNarrowGeometryHeader()}),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Jr.createElement("div",{class:Jr.const("dcg-popover-interior"),role:Jr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-geometry-settings")},Jr.createElement("div",{class:Jr.const("dcg-options-menu-section")},Jr.createElement(Qp,{controller:this.props.controller}),Jr.createElement(gG,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Jr.createElement(xg,{controller:this.props.controller})),Jr.createElement(gG,{predicate:()=>this.controller.getHiddenGeoItemCount()>0},()=>Jr.createElement(Gt,{onChange:this.bindFn(this.toggleGhostMode),checked:()=>this.controller.getGhostMode(),manageFocus:this.const(Vt({controller:this.controller,location:{type:"settings",location:"hidden-objects"}}))},()=>this.controller.s("graphing-calculator-label-settings-hidden-objects",{count:this.controller.getHiddenGeoItemCount()})))),Jr.createElement("div",{class:Jr.const("dcg-options-menu-section")},Jr.createElement("div",{class:Jr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-settings-grid"),Jr.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-grid"),toggled:this.bindFn(this.getShowGrid),onChange:this.bindFn(this.toggleGrid)})),Jr.createElement(gG,{predicate:this.bindFn(this.getShowGrid)},()=>Jr.createElement(Gt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")))),Jr.createElement("div",{class:Jr.const("dcg-options-menu-section")},Jr.createElement("div",{class:Jr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Jr.createElement(an,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),toggled:this.bindFn(this.getShowAxes),onChange:this.bindFn(this.toggleAxes)})),Jr.createElement(gG,{predicate:this.bindFn(this.getShowAxes)},()=>Jr.createElement("div",null,Jr.createElement(Gt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),Jr.createElement("div",null,Jr.createElement(Gt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")))))),Jr.createElement(hy,{controller:this.props.controller}),Jr.createElement(hG,{controller:this.props.controller}),Jr.createElement(Xp,{controller:this.props.controller})))}toggleGhostMode(){this.controller.dispatch({type:"set-ghost-mode",value:!this.controller.getGhostMode()})}didMountContainer(e){this.node=e,O(document).on("dcg-tapstart.geometry-settings-view wheel.geometry-settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),this.unsub=dG.push(t=>{let i=Re(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;t.shiftKey?t.shiftKey&&(n.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):n.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){O(document).off(".geometry-settings-view"),this.unsub()}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&O(document.activeElement).closest(this.node).length&&xa(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=O(e.target),i=!!t.closest(this.node).length,n=!!t.closest(".dcg-action-settings").length,o=this.isMathquillFocused()&&t.closest(".dcg-keypad").length,s=!!t.closest(".dcg-action-undo").length||!!t.closest(".dcg-action-redo").length;return!(i||n||o||s)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleAxes(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis(),showYAxis:!this.getShowXAxis()})}getShowAxes(){return!!this.controller.getGraphSettings().showXAxis}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var{If:Cg}=ar.Components,nv=class extends ar.Class{init(){this.controller=this.props.controller()}settings(){return this.controller.getGraphSettings()}template(){return ar.createElement("div",{class:ar.const("dcg-calculator-api-container"),style:ar.const("width: 100%; height: 100%; position: relative;")},ar.createElement("div",{class:()=>({"dcg-container":!0,"dcg-fullscreen":!this.controller.isListVisible(),"dcg-narrow":this.controller.isNarrow(),"dcg-PROJECTOR-MODE":this.settings().config.projectorMode,"dcg-inverted-colors":!!this.settings().config.invertedColors,"dcg-inverted-swatches":this.controller.invertSwatches(),"dcg-EDIT-LIST-MODE":this.controller.isInEditListMode(),"dcg-no-graphpaper":!this.settings().config.graphpaper,"dcg-no-branding":!this.settings().config.branding,"dcg-no-expression-topbar":!this.settings().config.expressionsTopbar,"dcg-default-border":!!this.settings().config.border,"dcg-no-hyperlinks":!this.settings().config.links,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-is-interactive":this.settings().config.expressions||!(this.settings().config.lockViewport||this.settings().userLockedViewport)}),style:()=>({"font-size":this.settings().config.fontSize+"px",background:this.getContainerBackgroundColor(),color:this.controller.getTextColor()}),role:ar.const("application"),"aria-label":()=>this.controller.isGeometry()?this.controller.s("graphing-calculator-narration-main-desmos-geometry"):this.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator"),"x-ms-format-detection":ar.const("none"),didMount:this.bindFn(this.didMountRoot)},ar.createElement(Cg,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>ar.createElement(qx,{controller:this.props.controller})),ar.createElement(Kk,{controller:this.props.controller}),ar.createElement(Cg,{predicate:()=>this.controller.isListEnabled()&&!this.controller.isListVisible()&&(!this.controller.isGeometry()||this.controller.isNarrow())},()=>ar.createElement("div",{class:()=>({"dcg-overgraph-icon-container":!0,"dcg-bottom-right":this.controller.isNarrow()})},ar.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),gravity:()=>this.controller.isNarrow()?"nw":"se"},ar.createElement("div",{class:()=>({"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:ar.const("button"),tabindex:ar.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(Vt({controller:this.controller,location:{type:"show-expression-list-btn"}}))},ar.createElement("i",{class:ar.const("dcg-icon-show"),"aria-hidden":ar.const("true")}))))),ar.createElement(Cg,{predicate:this.bindFn(this.showHamburger)},()=>ar.createElement("div",{class:ar.const("dcg-overgraph-icon-container")},ar.createElement(Ke,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("se")},ar.createElement("div",{role:ar.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),class:ar.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},ar.createElement("i",{class:ar.const("dcg-icon-hamburger"),"aria-hidden":ar.const("true")}))))),ar.createElement(oG,{controller:this.props.controller}),ar.createElement(Cg,{predicate:()=>this.controller.isGeoUIActive()&&this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGraphSettingsOpen()},()=>ar.createElement(iv,{controller:this.props.controller})),ar.createElement(Cg,{predicate:()=>this.controller.shouldShowGeoToolbar()},()=>ar.createElement(lG,{controller:this.props.controller})),ar.createElement(cG,{controller:this.props.controller}),ar.createElement("div",{class:ar.const("dcg-grapher dcg-grapher-2d"),style:()=>({visibility:this.controller.isThreeDMode()?"hidden":"visible","pointer-events":this.controller.isThreeDMode()?"none":"auto"})}),ar.createElement(Cg,{predicate:()=>this.controller.is3dProduct()},()=>ar.createElement("div",{class:ar.const("dcg-grapher dcg-grapher-3d"),style:()=>({visibility:this.controller.isThreeDMode()?"visible":"hidden","pointer-events":this.controller.isThreeDMode()?"auto":"none"})})),ar.createElement(Cg,{predicate:()=>this.controller.getGraphSettings().config.keypad},()=>ar.createElement(Xk,{controller:this.props.controller}))))}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isGeometry()?!1:this.controller.isNarrow()}getContainerBackgroundColor(){return this.controller.hasTransparentBackground()?"none":this.controller.getBackgroundColor()}didMountRoot(e){mp(e),this.controller.getGraphSettings().config.disableScrollFix||JE(e),this.setupFileDragDrop(e)}setupFileDragDrop(e){rv(e);let t=O(),i=this;function n(){t=O(),O(e).off(".filedraggedover"),i.controller.dispatch({type:"file-is-not-dragged-over"})}O(e).on("dragenter",o=>{this.controller.areImagesEnabled()&&(O(o.target).closest(".dcg-geo-getting-started-container")||(t.length===0&&O(e).on("dcg-tapstart.filedraggedover",n),t=t.add(o.target),this.controller.dispatch({type:"file-is-dragged-over"})))}).on("dragleave",o=>{t=t.not(o.target),t.length===0&&n()}).on("drop",n)}};var mG=class extends Wr{constructor(t){super();this.workerPool=t,this.guid=__dcg_shared_module_exports__['M']("worker-pool-connection"),this.worker=t.allocateWorker(),this.worker.__connections[this.guid]=this}destroy(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]}killWorker(){this.worker.__isFake||this.workerPool.killWorker(this.worker)}onWorkerKilled(){}onResponse(t){}sendMessage(t){this.worker.__isFake?this.worker.postMessage(t):this.worker.postMessage({connectionId:this.guid,originalMessage:t})}};function n8(r){var e={},t=new __dcg_shared_module_exports__['dd'](i);function i(n,o){r({type:n,payload:o})}return e.postMessage=function(n){setTimeout(function(){t.processChangeSet(n)},0)},e}Jh();var ov="";try{ov=vu(window.location.search,"workerThrottle"),ov==null&&(ov=vu(window.top.location.search,"workerThrottle"))}catch(r){}var o8=parseInt(ov,10),t0=0;function s8(r){return o8?function(e){t0=Math.max(Date.now(),t0)+o8,setTimeout(r,t0-Date.now(),e)}:r}var my=class extends Wr{constructor(t=1/0){super();this.workers=[],this.maxWorkers=t}allowedToSpawnWorker(){return!!__dcg_worker_source_exports__['createWorker']&&this.workers.length<this.maxWorkers}killWorker(t){var i=__dcg_shared_module_exports__['A'](this.workers,t);i!==-1&&(t.terminate(),this.workers=__dcg_shared_module_exports__['y'](this.workers,t),__dcg_shared_module_exports__['u'](__dcg_shared_module_exports__['E'](t.__connections)).forEach(function(n){n&&n.onWorkerKilled&&n.onWorkerKilled()}))}spawnWorker(){if(!__dcg_worker_source_exports__['createWorker'])return null;try{var t=__dcg_worker_source_exports__['createWorker']();return t.__connections={},t.__isFake=!1,t.onerror=function(i){__dcg_shared_module_exports__['k'].log(i)},t.addEventListener("message",s8(function(i){var n=i.data;if(!(n&&n.log)&&n&&n.connectionId){var o=t.__connections[n.connectionId];o&&o.onResponse(n.originalMessage)}})),this.workers.push(t),t}catch(i){return null}}spawnFakeWorker(){var t=n8(s8(function(i){var n=__dcg_shared_module_exports__['E'](t.__connections)[0];n&&n.onResponse(i)}));return t.__isFake=!0,t.__connections={},t}findLeastUsedWorker(){var t=function(n){return __dcg_shared_module_exports__['x'](n.__connections)},i=__dcg_shared_module_exports__['v'](this.workers,t)[0];return i}allocateWorker(){var t=null;return this.allowedToSpawnWorker()&&(t=this.spawnWorker()),t||(t=this.findLeastUsedWorker()),t||(t=this.spawnFakeWorker()),t}};var XQ=4e3,eh=class{constructor(e){this.__ticksEnabled=!0;this.listeners={processChangeSet(e){var t={},i={};for(var n in e.graphChanges){var o=e.graphChanges[n];o===void 0?i[n]=!0:(__dcg_shared_module_exports__['Vb'](o),t[n]=o)}var s={};for(var n in e.intersectionChanges)i[n]||(s[n]=e.intersectionChanges[n]);var a=!!this.changeSet;this.onEvaluatorResults({evaluationStates:e.statusChanges,graphData:{addedGraphs:t,removedGraphs:i,intersections:s},renderSlowly:!!e.isCompleteState,timingData:e.timingData,eventUpdates:e.eventUpdates});let l=e.syncId;for(;this.syncRequests.length&&l!==void 0&&this.syncRequests[0].id<=l;)this.syncRequests.shift().callback();this.markJobFinished(),a&&this._processChangeSet()}};this.__state={},this.changeSet=null,this.cumulativeChangeSet={},this.syncId=1,this.syncRequests=[],e||(e=new my),this.workerPool=e,this.createWorkerPoolConnection()}privateGetWorkerPool(){return this.workerPool}privateGetWorkerPoolConnection(){return this.workerPoolConnection}createWorkerPoolConnection(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=new mG(this.workerPool),this.markJobFinished(),this.workerPoolConnection.onResponse=e=>{this.shouldIgnoreWorkerMessage(e)?e.type==="processChangeSet"&&(this.markJobFinished(),this._processChangeSet()):this.listeners[e.type].call(this,e.payload)},this.workerPoolConnection.onWorkerKilled=()=>{var e=this.hasJobInWorker();this.createWorkerPoolConnection(),e?(this.changeSet=__dcg_shared_module_exports__['j'](this.cumulativeChangeSet),this.__state.changed=!0,this.__state.droppedMessage=!0):(this.changeSet=__dcg_shared_module_exports__['j'](this.cumulativeChangeSet),this.__state.changed=!1),this.processChangeSet()}}destroy(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())}shouldIgnoreWorkerMessage(e){return this.__suspendUntilSyncId?!e||!e.payload?!0:!(e.payload.syncId>=this.__suspendUntilSyncId):!1}suspend(){(!this.changeSet||!this.changeSet.syncId)&&(this.syncId++,this.applyToChangeSets(e=>{e.syncId=this.syncId})),this.__suspendUntilSyncId=this.changeSet.syncId}markJobFinished(){this.__state.droppedMessage=!1,this.__jobStartTime=-1,this.__suspendUntilSyncId=void 0}startJobTimer(){this.__jobStartTime=new Date().getTime()}hasJobInWorker(){return this.__jobStartTime!==-1}getJobElapsedTime(){return this.hasJobInWorker()?new Date().getTime()-this.__jobStartTime:NaN}setTicksEnabled(e){this.__ticksEnabled=e}tick(){this.__ticksEnabled&&this._processChangeSet()}processChangeSet(){this.__processChangeSetRequested=!0}_processChangeSet(){if(this._syncEvaluatorConfig(),!this.__processChangeSetRequested)return;let e=this.getJobElapsedTime()>=XQ;if(this.__state.droppedMessage&&e){this.workerPoolConnection.killWorker();return}if(this.__state.changed&&this.changeSet)if(this.changeSet.syncId||(this.syncId++,this.changeSet.syncId=this.syncId),this.hasJobInWorker())this.changeSet.isCompleteState&&e&&this.workerPoolConnection.killWorker();else{let t=this.changeSet;this.changeSet=null,this.__state.changed=!1,this.startJobTimer(),this.workerPoolConnection.sendMessage(t),this.__processChangeSetRequested=!1}}notifyWhenSynced(e){if(this._syncEvaluatorConfig(),!this.hasJobInWorker()&&!this.changeSet){setTimeout(e,0);return}this.syncId++,this.syncRequests.push({id:this.syncId,callback:e}),this.applyToChangeSets(t=>{t.syncId=this.syncId})}applyToChangeSets(e){this.__state.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.processChangeSet()}clearStatementsAndStartCompleteState(){this.hasJobInWorker()&&this.suspend(),this.applyToChangeSets(function(e){e.isCompleteState=!0,delete e.statements})}markUndoRedoState(){this.applyToChangeSets(function(e){e.isUndoRedoState=!0})}addStatement(e){this.applyToChangeSets(function(t){t.statements||(t.statements={}),t.statements[e.id]=__dcg_shared_module_exports__['j'](e)})}removeStatement(e){this.applyToChangeSets(function(t){t.statements||(t.statements={}),t.removes||(t.removes={}),delete t.statements[e],t.removes[e]=!0})}addActionStepEvent(e){this.applyToChangeSets(function(t){t.events||(t.events=[]),t.events.push({type:"step",expressionId:e})})}addClockTickEvent(e,t){this.applyToChangeSets(function(i){i.events||(i.events=[]),i.events.push({type:"clock-tick",id:e,isFirstTick:t})})}addClickEvent(e,t){this.applyToChangeSets(function(i){i.events||(i.events=[]),t===void 0&&(t=0),i.events.push({type:"click",expressionId:e,indexVar:t})})}_syncEvaluatorConfig(){if(this.readEvaluatorConfig){var e=this.readEvaluatorConfig();for(let t in e)this._applyIfChanged(e,t)}}_applyIfChanged(e,t){let i=this.cumulativeChangeSet&&this.cumulativeChangeSet[t],n=e[t];__dcg_shared_module_exports__['G'](i,n)||this.applyToChangeSets(function(o){o[t]=n})}};function qd(r){return r==="es-ES"?(__dcg_shared_module_exports__['k'].warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):r}uu();var QQ=0,sv=class{constructor(e,t,i,n){e||(e=document.createElement("div"));let o=document.createElement("div");o.className="dcg-wrapper",o.style.width="100%",o.style.height="100%",e.appendChild(o),this.__id=QQ++;let s=new wc;this.graphSettings=s;for(let h in i)s.config.setProperty(h,i[h]);let a=new hg(s);this.controller=a,n&&a.dispatch({type:"ui/container-resized",size:n}),this.rootElt=o,this.view=fy.mountToNode(nv,this.rootElt,{controller:fy.const(a)});let l=new eh(t);this.controller.setEvaluator(l),this.controller.setRootElt(this.rootElt);let c=this.controller.findEl(".dcg-grapher-2d"),u=new Mu(c,s,this.controller,l);this.controller.setGrapher2d(u),this.grapher=u,this.controller.initStateStack(),l.readEvaluatorConfig=()=>({product:s.config.product,beta3d:!!Ai("beta3d"),evaluationMode:a.isGeometry()?"geometry":this.controller.isThreeDMode()?"graphing_3d":"graphing",globalRandomSeed:s.randomSeed,degreeMode:s.degreeMode,viewState:a.getViewState(),selectedIds:a.getPropagatedSelectedIds(),restrictedFunctions:s.config.restrictedFunctions,forceEnableGeometryFunctions:s.config.forceEnableGeometryFunctions,distributions:s.config.distributions,pointsOfInterest:s.config.pointsOfInterest,plotSingleVariableImplicitEquations:s.config.plotSingleVariableImplicitEquations,plotImplicits:s.config.plotImplicits,plotInequalities:s.config.plotInequalities,sliders:s.config.sliders,actions:!!s.config.actions,substitutions:!!s.config.substitutions,dimensions:a.getGrapherDimensions(),logInternalErrors:!!Gs().logInternalErrors}),l.onEvaluatorResults=h=>{this.controller.dispatch({type:"on-evaluator-changes",changes:h.evaluationStates,timingData:h.timingData,graphData:h.graphData,eventUpdates:h.eventUpdates}),this.controller.requestRedrawGraph()},this.unsubFunc=this.controller.subToChanges(()=>{this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher=this.controller.isThreeDMode()?this.controller.getGrapher3d()||this.controller.getGrapher2d():this.controller.getGrapher2d(),this.grapher.update());var h=!1;g()&&(h=!0),h&&this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher.update())});let p=new Wr;p.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=p;let g=()=>{var h=!1,b=a.computeMajorLayout(),C={left:b.grapher.left,right:b.grapher.left+b.grapher.width,width:b.grapher.width,top:b.grapher.top,bottom:b.grapher.top+b.grapher.height,height:b.grapher.height},D=this.grapher.getCurrentViewport(),S={top:D.ymax,bottom:D.ymin,left:D.xmin,right:D.xmax,width:D.xmax-D.xmin,height:D.ymax-D.ymin};__dcg_shared_module_exports__['G'](S,p.mathCoordinates)||(p.setProperty("mathCoordinates",S),h=!0);var V=C.height>0&&C.width>0;return V&&!__dcg_shared_module_exports__['G'](C,p.pixelCoordinates)&&(p.setProperty("pixelCoordinates",C),h=!0),h};O(this.rootElt).on("keydown.calculator-"+this.__id,h=>{this.grapher instanceof Mu&&this.grapher.audioGraph.handleKeydown(h),this.instanceHotkeys.handleKeydown(h)}),O(window).on("dcg-tapstart.calculator-"+this.__id,h=>{var T;let b=O(h.target),C=!!b.closest(this.rootElt).length,D=h.wasHandled("create-expression-with-keyboard"),S=!!b.closest(".dcg-api-shared-keypad-root").length,V=!!b.hasClass("dcg-shell");!C&&!S&&!V&&!D&&a.dispatch({type:"set-none-selected"});let k=(T=this.controller.getGrapher2d())==null?void 0:T.traceLayer;if(!h.wasHandled("do-not-clear-poi-labels")&&k&&(k.clearOpenedPOI(),this.controller.requestRedrawGraph()),a.isInEditListMode()){let A=b.closest(".dcg-exppanel").length===0&&b.closest(".dcg-options-menu").length===0&&b.closest(".dcg-expression-top-bar").length===0&&b.closest(".dcg-keypad").length===0;(!C||A)&&a.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1})}}),this.evaluator=l,this.controller.dispatch({type:"set-blank",degreeMode:!!i.degreeMode}),s.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),s.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),s.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:s.config.pointsOfInterest}),s.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:s.config.backgroundColor}),s.config.hasOwnProperty("textColor")&&this.setOptions({textColor:s.config.textColor}),s.config.observe("language",()=>{let h=this.controller.getState();this.controller.dispatch({type:"set-state",state:h})}),s.config.observe("forceLogModeRegressions",()=>{s.config.forceLogModeRegressions&&this.controller.setAllRegressionsToLogMode()}),this.instanceHotkeys=new px(a)}initializeGrapher3d(e){let t=this.controller.findEl(".dcg-grapher-3d"),i=new e(t,this.controller.getGraphSettings(),this.controller,this.controller.getEvaluator());this.controller.setGrapher3d(i),this.grapher=i,this.controller.dispatch({type:"set-blank"}),this.controller.clearUndoRedoHistory()}setOption(e,t){this.controller.getGraphSettings().config.setProperty(e,t)}setOptions(e){let t,i=this.controller.getGraphSettings().config,n=__dcg_shared_module_exports__['a']({},e);e.hasOwnProperty("backgroundColor")&&(__dcg_shared_module_exports__['P'](e.backgroundColor)||(__dcg_shared_module_exports__['k'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete n.backgroundColor)),e.hasOwnProperty("textColor")&&(__dcg_shared_module_exports__['P'](e.textColor)||(__dcg_shared_module_exports__['k'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete n.textColor)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['k'].warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(n.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(n.expressionsTopbar=!!e.menus),delete n.menus),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['k'].warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(n.pointsOfInterest=!!e.solutions),delete n.solutions),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['k'].warn("Deprecated option: administerSecretFolders. Setting authorFeatures instead."),e.hasOwnProperty("authorFeatures")||(n.authorFeatures=!!e.administerSecretFolders),delete n.administerSecretFolders),e.hasOwnProperty("singleVariableSolutions")&&(__dcg_shared_module_exports__['k'].warn("Deprecated option: singleVariableSolutions has been removed."),delete n.singleVariableSolutions),e.graphpaper===!1&&(e.expressionsCollapsed&&(n.expressionsCollapsed=!1,__dcg_shared_module_exports__['k'].warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),i.expressionsCollapsed&&(n.expressionsCollapsed=!1,__dcg_shared_module_exports__['k'].warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__['k'].warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(n.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['k'].warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")),i.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__['k'].warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")),i.showResetButtonOnGraphpaper&&(n.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['k'].warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))),i.graphpaper===!1&&(e.expressionsCollapsed||e.zoomButtons||e.showResetButtonOnGraphpaper)&&(n.graphpaper=!0,__dcg_shared_module_exports__['k'].warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__['k'].warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),i.lockViewport&&e.zoomButtons&&(n.lockViewport=!1,__dcg_shared_module_exports__['k'].warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),i.zoomButtons&&e.lockViewport&&(n.zoomButtons=!1,__dcg_shared_module_exports__['k'].warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false."));function o(u){let{notes:p,folders:g,images:h}=u;return p===!1||g===!1||h===!1}let s=o(e),a=o(__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},i),e)),l=i.pasteGraphLink,c=e.pasteGraphLink;s?(c||l)&&(n.pasteGraphLink=!1,__dcg_shared_module_exports__['k'].warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")):c&&a&&(n.notes=!0,n.folders=!0,n.images=!0,__dcg_shared_module_exports__['k'].warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")),e.language&&(n.language=qd(e.language)),e.logScales&&this.controller.isGeometry()&&(__dcg_shared_module_exports__['k'].warn("Cannot set logScales: true in the geometry calculator"),delete n.logScales);for(t in n)if(n.hasOwnProperty(t))switch(t){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!n.expressionsCollapsed),n.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}):this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!n.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!n.degreeMode),this.controller.dispatch({type:"set-graph-settings",degreeMode:!!n.degreeMode});break;case"actions":{let p=n[t];if(p===void 0||p===this.controller.getGraphSettings().config.actions)break;this.setOption(t,p),this.setState(this.getState(),{allowUndo:!0});break}case"substitutions":{let p=n[t];if(p===void 0||p===this.controller.getGraphSettings().config.substitutions)break;this.setOption(t,p),this.setState(this.getState(),{allowUndo:!0});break}case"product":case"beta3d":{__dcg_shared_module_exports__['k'].warn(`Cannot update '${t}' setting.`);break}case"logScales":{let p=n[t];p!==void 0&&(p===!1&&this.controller.dispatch({type:"set-graph-settings",xAxisScale:"linear",yAxisScale:"linear"}),this.setOption(t,p));break}case"keypad":case"graphpaper":case"expressions":case"settingsMenu":case"zoomButtons":case"showResetButtonOnGraphpaper":case"expressionsTopbar":case"pointsOfInterest":case"trace":case"border":case"lockViewport":case"authorFeatures":case"authorMode":case"advancedStyling":case"images":case"imageUploadCallback":case"folders":case"notes":case"sliders":case"links":case"restrictedFunctions":case"forceEnableGeometryFunctions":case"distributions":case"pasteGraphLink":case"pasteTableData":case"clearIntoDegreeMode":case"autosize":case"plotSingleVariableImplicitEquations":case"plotImplicits":case"plotInequalities":case"colors":case"branding":case"disableScrollFix":case"invertedColors":case"fontSize":case"projectorMode":case"ghostMode":case"language":case"onlyTraceSelected":case"disableMouseInteractions":case"nativeOnscreenKeypad":case"functionDefinition":case"plaidMode":case"pasteGraphLinkCallback":case"editOnWeb":case"crossOriginSaveTest":case"backgroundColor":case"textColor":case"enableTabindex":case"audioTraceReverseExpressions":case"showHamburger":case"decimalToFraction":case"capExpressionSize":case"transparentBackground":case"pauseWhenOffscreen":case"hideGeoUI":case"brailleMode":case"sixKeyInput":case"brailleControls":case"zoomFit":case"forceLogModeRegressions":case"audio":{let p=n[t];p!==void 0&&this.setOption(t,p);break}default:return t}}setViewport(e){let t=new hn(e[0],e[1],e[2],e[3]);this.grapher.viewportController.setViewport(t),this.controller.dispatch({type:"commit-user-requested-viewport",viewport:t})}resize(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})}interceptTouch(){let e=O(this.rootElt),t=e.find(".dcg-expression-top-bar");t.add(e.find(".dcg-keypad")),t.length&&(t.on("touchstart",i=>{O(i.target).is("input, textarea")||i.preventDefault()}),t.on("touchend",i=>{O(i.target).closest(".dcg-do-not-blur").length>0||kL()}))}destroy(){O(window).off(".calculator-"+this.__id);let e=O(this.rootElt);e.off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.evaluator&&this.evaluator.destroy(),this.grapher&&this.grapher.remove(),fy.unmountFromNode(this.rootElt),e.remove()}tick(e,t){t||(this.controller.handleTick(e),this.controller.updateRenderShellsAfterDispatch()),this.evaluator.tick(),this.grapher&&this.grapher.tick(e)}getState(e){return this.controller.getState(e)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}};function ZQ(){var r=O('<div style="z-index:99999; position: absolute; left: 0; top: 0;background:#FFF">waiting...</div>').appendTo("body"),e=window,t=[],i=[];e.Calc.controller.onEvaluatorChangesSpy=function(){t.push(Date.now())};let n;e.Calc.controller.isThreeDMode()&&(n=e.Calc.controller.grapher3d.webglLayer,n.onRenderSpy=function(){i.push(Date.now())}),setInterval(function(){for(var o=Date.now();o-t[0]>1e3;)t.shift();for(;o-i[0]>1e3;)i.shift();let s=e.Calc.controller.isThreeDMode()?`compute: ${t.length} fps, 3d render: ${i.length} fps, ${n.renderer.info.render.triangles} triangles`:`${t.length} fps`;r.text(s)},100)}function eZ(){var r=O('<div style="z-index:99999; position: absolute; left: 0; top: 0;background:#FFF">waiting...</div>').appendTo("body"),e=window,t=[],i=0;e.Calc.controller.onEvaluatorChangesSpy=function(a,l){let{timeInWorker:c}=l;t[i%100]=c,i+=1};function n(){let a=0;for(let c of t)a+=c;let l=a/t.length;r.text(l.toFixed(1)+" ms")}let o;function s(){cancelAnimationFrame(o),o=requestAnimationFrame(s),n()}s()}var tZ=!!Gs().simulationFPS;tZ&&(av=setInterval(function(){var r=window.Calc;r&&(clearInterval(av),setTimeout(ZQ,1e3))},1));var av,rZ=!!Gs().timeInWorker;rZ&&(av=setInterval(function(){var e=window.Calc;e&&(clearInterval(av),setTimeout(eZ,1e3))},1));var av;ct();var a8=1,yy={},lv=!1;function c8(){lv=!0,requestAnimationFrame(iZ)}var l8={};function iZ(){l8.rafSPY&&l8.rafSPY(),lv=!1;for(let r in yy)yy[r].detectAndEnqueueEvent(),lv=!0;if(lv){c8();for(let r in yy)yy[r].dispatchQueuedEvent()}}var Dg=class{constructor(e,t){this.elt=e;this.cb=t;this.destroyed=!1;this.lastOffscreen=!1;this.id=a8.toString(),this.appliedScale={x:1,y:1},a8++}stopWatching(){delete yy[this.id]}startWatching(){this.checkForChanges(),yy[this.id]=this,lv||c8()}resetAppliedScalingAndGetBoundingClientRect(){var e=this.elt.getBoundingClientRect(),t={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(t.x===this.appliedScale.x&&t.y===this.appliedScale.y)return e;let i=O(this.elt).children(".dcg-wrapper")[0];return i&&(this.appliedScale=t,O(i).css({transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%","transform-origin":"0 0"})),e}detectAndEnqueueEvent(){if(this.destroyed)return;let e=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let i=this.resetAppliedScalingAndGetBoundingClientRect();e=i.top>window.innerHeight||i.bottom<0||i.left>window.innerWidth||i.right<0,this.lastSize?(i.width!==this.lastSize.width||i.height!==this.lastSize.height||window.devicePixelRatio!==this.lastSize.pixelRatio)&&(this.lastSize.width=i.width,this.lastSize.height=i.height,this.lastSize.pixelRatio=window.devicePixelRatio,this.queuedEvent={type:"resized",target:this.elt,size:__dcg_shared_module_exports__['a']({},this.lastSize),isOffscreen:e}):(this.lastSize={width:i.width,height:i.height,pixelRatio:window.devicePixelRatio},this.queuedEvent={type:"added",target:this.elt,size:__dcg_shared_module_exports__['a']({},this.lastSize),isOffscreen:e})}e!==this.lastOffscreen&&(this.lastOffscreen=e,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:e}))}dispatchQueuedEvent(){let e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(var e in this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0}};function d8(r){var e=r.mode,t=r.width,i=r.height,n=r.currentBounds,o=r.graphpaperAspectRatio,s=r.mathAspectRatio,a=r.mathBounds,l=t/i,c={x:n.left+n.width/2,y:n.bottom+n.height/2};if(a.left===void 0!=(a.right===void 0)||a.bottom===void 0!=(a.top===void 0))return __dcg_shared_module_exports__['k'].warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+a),n;var u=a.left!==void 0&&a.right!==void 0,p=a.bottom!==void 0&&a.top!==void 0,g=u&&p,h,b,C,D,S,V,k,T,A,R;switch(e){case"stretch":return g?a:u?{left:a.left,right:a.right,bottom:n.bottom,top:n.top}:p?{left:n.left,right:n.right,bottom:a.bottom,top:a.top}:n;case"contain":return g?(D=a.right-a.left,S=a.top-a.bottom,V={x:a.left+D/2,y:a.bottom+S/2},C=D/S,l>C?(b=S/i,h=b*s,{left:V.x-h*t/2,right:V.x+h*t/2,bottom:a.bottom,top:a.top}):(h=D/t,b=h/s,{left:a.left,right:a.right,bottom:V.y-b*i/2,top:V.y+b*i/2})):u?(k=a.right-a.left,T=a.left+k/2,C=k/n.height,l>C?(b=n.height/i,h=b*s,{left:T-h*t/2,right:T+h*t/2,bottom:n.bottom,top:n.top}):(h=k/t,b=h/s,{left:a.left,right:a.right,bottom:c.y-b*i/2,top:c.y+b*i/2})):p?(A=a.top-a.bottom,R=a.bottom+A/2,C=n.width/A,l>C?(b=A/i,h=b*s,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:a.bottom,top:a.top}):(h=n.width/t,b=h/s,{left:n.left,right:n.right,bottom:R-b*i/2,top:R+b*i/2})):l>o?(b=n.height/i,h=b*s,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:n.bottom,top:n.top}):(h=n.width/t,b=h/s,{left:n.left,right:n.right,bottom:c.y-b*i/2,top:c.y+b*i/2});case"preserveX":return g?(D=a.right-a.left,S=a.top-a.bottom,V={x:a.left+D/2,y:a.bottom+S/2},C=D/S,h=D/t,b=h/s,{left:a.left,right:a.right,bottom:V.y-b*i/2,top:V.y+b*i/2}):p?(A=a.top-a.bottom,R=a.bottom+A/2,C=n.width/A,h=n.width/t,b=h/s,{left:n.left,right:n.right,bottom:R-b*i/2,top:R+b*i/2}):u?(k=a.right-a.left,h=k/t,b=h/s,{left:a.left,right:a.right,bottom:c.y-b*i/2,top:c.y+b*i/2}):(k=n.right-n.left,h=k/t,b=h/s,{left:n.left,right:n.right,bottom:c.y-b*i/2,top:c.y+b*i/2});case"preserveY":return g?(D=a.right-a.left,S=a.top-a.bottom,V={x:a.left+D/2,y:a.bottom+S/2},C=D/S,b=S/i,h=b*s,{left:V.x-h*t/2,right:V.x+h*t/2,bottom:a.bottom,top:a.top}):u?(k=a.right-a.left,T=a.left+k/2,C=k/n.height,b=n.height/i,h=b*s,{left:T-h*t/2,right:T+h*t/2,bottom:n.bottom,top:n.top}):p?(A=a.top-a.bottom,b=A/i,h=b*s,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:a.bottom,top:a.top}):(A=n.top-n.bottom,b=A/i,h=b*s,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:n.bottom,top:n.top});default:return n}}function dv(r,e){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===r)return!0;return!1}function r0(r){return dv(r,n0)}function i0(r){return dv(r,o0)}function u8(r){return dv(r,s0)}function nZ(r){return dv(r,cv)}function oZ(r){return dv(r,a0)}var n0={OPEN:"OPEN",CROSS:"CROSS",POINT:"POINT"},o0={SOLID:"SOLID",DASHED:"DASHED",DOTTED:"DOTTED"},s0={NONE:"NONE",AUTO:"AUTO",X:"X",Y:"Y",XY:"XY"},cv={POINTS:"POINTS",LINES:"LINES",POINTS_AND_LINES:"POINTS_AND_LINES"},a0={DEFAULT:"default",CENTER:"center",CENTER_AUTO:"center_auto",AUTO_CENTER:"auto_center",ABOVE:"above",ABOVE_LEFT:"above_left",ABOVE_RIGHT:"above_right",ABOVE_AUTO:"above_auto",BELOW:"below",BELOW_LEFT:"below_left",BELOW_RIGHT:"below_right",BELOW_AUTO:"below_auto",LEFT:"left",AUTO_LEFT:"auto_left",RIGHT:"right",AUTO_RIGHT:"auto_right"};function sZ(r){return{id:r.id,type:r.type,columns:r.columns.map(aZ)}}function aZ(r){return{id:r.id,latex:r.latex,color:r.color,hidden:r.hidden,pointStyle:r.pointStyle,pointSize:r.pointSize,pointOpacity:r.pointOpacity,lineStyle:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,points:r.points,lines:r.lines,dragMode:r.dragMode,values:r.values.slice()}}function lZ(r){var e=["latex","color","lineStyle","lineWidth","lineOpacity","pointStyle","pointSize","pointOpacity","points","lines","fill","fillOpacity","hidden","secret","dragMode","label","showLabel","labelSize","labelOrientation","interactiveLabel","readonly"],t={id:r.id,type:r.type};return e.forEach(function(i){r.hasOwnProperty(i)&&(t[i]=r[i])}),r.hasOwnProperty("parametricDomain")&&(t.parametricDomain={min:r.parametricDomain.min,max:r.parametricDomain.max}),r.hasOwnProperty("parametricDomain3Du")&&(t.parametricDomain3Du={min:r.parametricDomain3Du.min,max:r.parametricDomain3Du.max}),r.hasOwnProperty("parametricDomain3Dv")&&(t.parametricDomain3Dv={min:r.parametricDomain3Dv.min,max:r.parametricDomain3Dv.max}),r.hasOwnProperty("polarDomain")&&(t.polarDomain={min:r.polarDomain.min,max:r.polarDomain.max}),r.hasOwnProperty("domain")&&(t.domain={min:r.domain.min,max:r.domain.max}),r.slider&&(r.slider.hardMin&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.min=r.slider.min),r.slider.hardMax&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.max=r.slider.max),r.slider.step&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.step=r.slider.step),t.playing=!!r.slider.isPlaying),t}function cZ(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function dZ(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function uZ(r){return{id:r.id,type:r.type,secret:r.secret}}function yG(r){switch(r.type){case"expression":return lZ(r);case"table":return sZ(r);case"folder":return dZ(r);case"image":return cZ(r);case"text":return uZ(r);default:return r}}function by(r,e){return r.hasOwnProperty("id")?r.id+"":e.generateId()}function pZ(r,e){var t={type:"expression",id:by(r,e)};if(t.type="expression",t.id=by(r,e),r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("surfaces")&&(t.surfaces=!!r.surfaces),r.hasOwnProperty("style")&&(__dcg_shared_module_exports__['k'].warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."),r0(r.style)?t.pointStyle=r.style:i0(r.style)?t.lineStyle=r.style:__dcg_shared_module_exports__['k'].warn("Invalid style: '"+r.style+"'.")),r.hasOwnProperty("pointStyle")&&(r0(r.pointStyle)?t.pointStyle=r.pointStyle:__dcg_shared_module_exports__['k'].warn("Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(i0(r.lineStyle)?t.lineStyle=r.lineStyle:__dcg_shared_module_exports__['k'].warn("Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("readonly")&&(t.readonly=!!r.readonly),r.hasOwnProperty("secret")&&(t.secret=!!r.secret),r.hasOwnProperty("sliderBounds")&&r.sliderBounds&&(t.slider={min:__dcg_shared_module_exports__['kc'](r.sliderBounds.min),max:__dcg_shared_module_exports__['kc'](r.sliderBounds.max),step:__dcg_shared_module_exports__['kc'](r.sliderBounds.step)},t.slider.min&&(t.slider.hardMin=!0),t.slider.max&&(t.slider.hardMax=!0)),r.hasOwnProperty("playing")){let{playing:i}=r;typeof i!="boolean"?__dcg_shared_module_exports__['k'].warn(`Invalid value for 'playing'. Expected a boolean but got '${i}'.`):(t.slider||(t.slider={}),t.slider.isPlaying=i)}return r.hasOwnProperty("parametricDomain3Du")&&r.parametricDomain3Du&&(t.parametricDomain3Du={min:__dcg_shared_module_exports__['kc'](r.parametricDomain3Du.min),max:__dcg_shared_module_exports__['kc'](r.parametricDomain3Du.max)}),r.hasOwnProperty("parametricDomain3Dv")&&r.parametricDomain3Dv&&(t.parametricDomain3Dv={min:__dcg_shared_module_exports__['kc'](r.parametricDomain3Dv.min),max:__dcg_shared_module_exports__['kc'](r.parametricDomain3Dv.max)}),r.hasOwnProperty("parametricDomain")&&r.parametricDomain?(t.parametricDomain={min:__dcg_shared_module_exports__['kc'](r.parametricDomain.min),max:__dcg_shared_module_exports__['kc'](r.parametricDomain.max)},r.hasOwnProperty("domain")&&__dcg_shared_module_exports__['k'].warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")):r.hasOwnProperty("domain")&&(__dcg_shared_module_exports__['k'].warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),t.parametricDomain={min:__dcg_shared_module_exports__['kc'](r.domain.min),max:__dcg_shared_module_exports__['kc'](r.domain.max)}),r.hasOwnProperty("polarDomain")&&r.polarDomain&&(t.polarDomain={min:__dcg_shared_module_exports__['kc'](r.polarDomain.min),max:__dcg_shared_module_exports__['kc'](r.polarDomain.max)}),r.hasOwnProperty("dragMode")&&(u8(r.dragMode)?t.dragMode=r.dragMode:__dcg_shared_module_exports__['k'].warn("Invalid dragMode: '"+r.dragMode+"'.")),r.hasOwnProperty("label")&&(t.label=r.label+""),r.hasOwnProperty("showLabel")&&(t.showLabel=!!r.showLabel),r.hasOwnProperty("showAngleLabel")&&(t.showAngleLabel=!!r.showAngleLabel),r.hasOwnProperty("labelSize")&&(typeof r.labelSize=="string"?t.labelSize=r.labelSize:__dcg_shared_module_exports__['k'].warn("Invalid labelSize: "+r.labelSize)),r.hasOwnProperty("labelOrientation")&&(oZ(r.labelOrientation)?t.labelOrientation=r.labelOrientation:__dcg_shared_module_exports__['k'].warn("Invalid labelOrientation: "+r.labelOrientation)),r.hasOwnProperty("fill")&&(t.fill=!!r.fill),r.hasOwnProperty("fillOpacity")&&(t.fillOpacity=""+r.fillOpacity),t}function hZ(r,e){var t={id:by(r,e)};return r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("values")&&r.values&&(t.values=r.values.map(function(i){return i+""})),r.hasOwnProperty("pointStyle")&&(r0(r.pointStyle)?t.pointStyle=r.pointStyle:__dcg_shared_module_exports__['k'].warn("Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(i0(r.lineStyle)?t.lineStyle=r.lineStyle:__dcg_shared_module_exports__['k'].warn("Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("columnMode")&&(__dcg_shared_module_exports__['k'].warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),r.columnMode===cv.POINTS_AND_LINES?(t.points=!0,t.lines=!0):r.columnMode===cv.LINES?(t.points=!1,t.lines=!0):(t.points=!0,t.lines=!1),t.lines&&!t.points&&r.hasOwnProperty("dragMode")&&r.dragMode!=="NONE"&&(__dcg_shared_module_exports__['k'].warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),t.points=!0),nZ(r.columnMode)&&__dcg_shared_module_exports__['k'].warn("Invalid columnMode: '"+r.columnMode+"'.")),r.hasOwnProperty("dragMode")&&(u8(r.dragMode)?t.dragMode=r.dragMode==="AUTO"?"NONE":r.dragMode:__dcg_shared_module_exports__['k'].warn("Invalid dragMode: '"+r.dragMode+"'.")),t}function gZ(r,e){var t={type:"table",id:by(r,e)};return r.hasOwnProperty("columns")&&r.columns&&(t.columns=r.columns.map(function(i){return hZ(i,e)})),t}function mZ(r,e){var t={type:"folder",id:by(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function fZ(r,e){var t={type:"image",id:by(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function bG(r,e,t){var i=r.type;if(e&&i&&i!==e){__dcg_shared_module_exports__['k'].warn("Cannot change type of expression from '"+e+"' to '"+i+"'.");return}switch(i){case void 0:case"expression":return pZ(r,t);case"image":return fZ(r,t);case"table":return gZ(r,t);case"folder":return mZ(r,t);default:if(e){__dcg_shared_module_exports__['k'].warn("Cannot modify expressions of type: '"+e+"' through the API.");return}else{__dcg_shared_module_exports__['k'].warn("Invalid expression type: '"+i+"'.");return}}}var wG=class{constructor(e){this.mq=e,this.id=e.id,this.data=e.data}simulateUserChangedLatex(){it.simulateUserChangedLatex(this.mq)}simulateKeypress(e){it.simulateKeypress(this.mq,e)}latex(e){return e===void 0?this.mq.latex():(this.mq.latex(e),this.simulateUserChangedLatex(),this)}reflow(){this.mq.reflow()}el(){return this.mq.el()}getAriaLabel(){return this.mq.getAriaLabel()}setAriaLabel(e){return this.mq.setAriaLabel(e)}html(){return this.mq.html()}mathspeak(){return this.mq.mathspeak()}text(){return this.mq.text()}selection(){return this.mq.selection()}select(){return this.mq.select(),this}moveToRightEnd(){return this.mq.moveToRightEnd(),this}moveToLeftEnd(){return this.mq.moveToLeftEnd(),this}cmd(e){return this.mq.cmd(e),this.simulateUserChangedLatex(),this}write(e){return this.mq.write(e),this.simulateUserChangedLatex(),this}keystroke(e){return this.simulateKeypress(e),this}typedText(e){return this.mq.typedText(e),this.simulateUserChangedLatex(),this}clearSelection(){return this.mq.clearSelection(),this}getAriaPostLabel(){return this.mq.getAriaPostLabel()}setAriaPostLabel(e,t){return this.mq.setAriaPostLabel(e,t),this}blur(){return this.mq.blur(),this}focus(){return this.mq.focus(),this}revert(){return this.mq.revert()}ignoreNextMousedown(e){return this.mq.ignoreNextMousedown(e),this}clickAt(e,t,i){return this.mq.clickAt(e,t,i),this}};uu();function yZ(r){function e(t){requestAnimationFrame(e),r(t)}requestAnimationFrame(e)}function bZ(r){function e(){setTimeout(e,wy),r(Date.now())}setTimeout(e,wy)}var p8=Gs().timeoutLoop,wy=0;typeof p8=="string"&&(wy=parseFloat(p8),isNaN(wy)&&(wy=1e3/60));var h8=wy>0?bZ:yZ;var c0=new Wr;h8(function(r){c0.triggerEvent("tick",r)});var l0=0;function qu(r){return l0+=1,c0.observeEvent("tick."+l0,function(e,t){r(t)}),l0}function Sg(r){c0.unobserveEvent("tick."+r)}Jh();var g8=vu(location.search,"nworkers"),m8=4;g8&&(m8=parseInt(g8,10));var xy=new my(m8);var vG={};__dcg_shared_module_exports__['g'](vG,{LARGE:()=>vZ,MEDIUM:()=>d0,SMALL:()=>xZ,VERY_LARGE:()=>CZ,VERY_SMALL:()=>wZ});var wZ=9,xZ=12,d0=16,vZ=20,CZ=24;var Tt=function(r,e,t){var i=document.createElement("img"),n,o;if(i.onerror=e,i.onload=function(){o&&!(t&&t.noRevoke)&&Tt.revokeObjectURL(o),e&&e(Tt.scale(i,t))},Tt.isInstanceOf("Blob",r)||Tt.isInstanceOf("File",r))n=o=Tt.createObjectURL(r),i._type=r.type;else if(typeof r=="string")n=r,t&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin);else return!1;return n?(i.src=n,i):Tt.readFile(r,function(s){var a=s.target;a&&a.result?i.src=a.result:e&&e(s)})},CG=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;Tt.isInstanceOf=function(r,e){return Object.prototype.toString.call(e)==="[object "+r+"]"};Tt.transformCoordinates=function(){};Tt.getTransformedOptions=function(r){return r};Tt.renderImageToCanvas=function(r,e,t,i,n,o,s,a,l,c){return r.getContext("2d").drawImage(e,t,i,n,o,s,a,l,c),r};Tt.hasCanvasOption=function(r){return r.canvas||r.crop};Tt.scale=function(r,e){e=e||{};var t=document.createElement("canvas"),i=r.getContext||Tt.hasCanvasOption(e)&&t.getContext,n=r.naturalWidth||r.width,o=r.naturalHeight||r.height,s=n,a=o,l,c,u,p,g,h,b,C,D,S=function(){var k=Math.max((u||s)/s,(p||a)/a);k>1&&(s=Math.ceil(s*k),a=Math.ceil(a*k))},V=function(){var k=Math.min((l||s)/s,(c||a)/a);k<1&&(s=Math.ceil(s*k),a=Math.ceil(a*k))};return i&&(e=Tt.getTransformedOptions(e),b=e.left||0,C=e.top||0,e.sourceWidth?(g=e.sourceWidth,e.right!==void 0&&e.left===void 0&&(b=n-g-e.right)):g=n-b-(e.right||0),e.sourceHeight?(h=e.sourceHeight,e.bottom!==void 0&&e.top===void 0&&(C=o-h-e.bottom)):h=o-C-(e.bottom||0),s=g,a=h),l=e.maxWidth,c=e.maxHeight,u=e.minWidth,p=e.minHeight,i&&l&&c&&e.crop?(s=l,a=c,D=g/h-l/c,D<0?(h=c*g/l,e.top===void 0&&e.bottom===void 0&&(C=(o-h)/2)):D>0&&(g=l*h/c,e.left===void 0&&e.right===void 0&&(b=(n-g)/2))):((e.contain||e.cover)&&(u=l=l||u,p=c=c||p),e.cover?(V(),S()):(S(),V())),i?(t.width=s,t.height=a,Tt.transformCoordinates(t,e),Tt.renderImageToCanvas(t,r,b,C,g,h,0,0,s,a)):(r.width=s,r.height=a,r)};Tt.createObjectURL=function(r){return CG?CG.createObjectURL(r):!1};Tt.revokeObjectURL=function(r){return CG?CG.revokeObjectURL(r):!1};Tt.readFile=function(r,e,t){if(window.FileReader){var i=new FileReader;if(i.onload=i.onerror=e,t=t||"readAsDataURL",i[t])return i[t](r),i}return!1};(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))&&(f8=Tt.renderImageToCanvas,Tt.detectSubsampling=function(r){var e,t;return r.width*r.height>1024*1024?(e=document.createElement("canvas"),e.width=e.height=1,t=e.getContext("2d"),t.drawImage(r,-r.width+1,0),t.getImageData(0,0,1,1).data[3]===0):!1},Tt.detectVerticalSquash=function(r,e){var t=r.naturalHeight||r.height,i=document.createElement("canvas"),n=i.getContext("2d"),o,s,a,l,c;for(e&&(t/=2),i.width=1,i.height=t,n.drawImage(r,0,0),o=n.getImageData(0,0,1,t).data,s=0,a=t,l=t;l>s;)c=o[(l-1)*4+3],c===0?a=l:s=l,l=a+s>>1;return l/t||1},Tt.renderImageToCanvas=function(r,e,t,i,n,o,s,a,l,c){if(e._type==="image/jpeg"){var u=r.getContext("2d"),p=document.createElement("canvas"),g=1024,h=p.getContext("2d"),b,C,D,S;if(p.width=g,p.height=g,u.save(),b=Tt.detectSubsampling(e),b&&(t/=2,i/=2,n/=2,o/=2),C=Tt.detectVerticalSquash(e,b),b||C!==1){for(i*=C,l=Math.ceil(g*l/n),c=Math.ceil(g*c/o/C),a=0,S=0;S<o;){for(s=0,D=0;D<n;)h.clearRect(0,0,g,g),h.drawImage(e,t,i,n,o,-D,-S,n,o),u.drawImage(p,0,0,g,g,s,a,l,c),D+=g,s+=l;S+=g,a+=c}return u.restore(),r}}return f8(r,e,t,i,n,o,s,a,l,c)});var f8,DZ=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);Tt.blobSlice=DZ&&function(){var r=this.slice||this.webkitSlice||this.mozSlice;return r.apply(this,arguments)};Tt.metaDataParsers={jpeg:{65505:[]}};Tt.parseMetaData=function(r,e,t){t=t||{};var i=this,n=t.maxMetaDataSize||262144,o={},s=!(window.DataView&&r&&r.size>=12&&r.type==="image/jpeg"&&Tt.blobSlice);(s||!Tt.readFile(Tt.blobSlice.call(r,0,n),function(a){var l=a.target.result,c=new DataView(l),u=2,p=c.byteLength-4,g=u,h,b,C,D;if(c.getUint16(0)===65496){for(;u<p&&(h=c.getUint16(u),h>=65504&&h<=65519||h===65534);){if(b=c.getUint16(u+2)+2,u+b>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(C=Tt.metaDataParsers.jpeg[h],C)for(D=0;D<C.length;D+=1)C[D].call(i,c,u,b,o,t);u+=b,g=u}!t.disableImageHead&&g>6&&(l.slice?o.imageHead=l.slice(0,g):o.imageHead=new Uint8Array(l).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");e(o)},"readAsArrayBuffer"))&&e(o)};var SZ=Tt.hasCanvasOption;Tt.hasCanvasOption=function(r){return SZ(r)||r.orientation};Tt.transformCoordinates=function(r,e){var t=r.getContext("2d"),i=r.width,n=r.height,o=e.orientation;if(o)switch(o>4&&(r.width=n,r.height=i),o){case 2:t.translate(i,0),t.scale(-1,1);break;case 3:t.translate(i,n),t.rotate(Math.PI);break;case 4:t.translate(0,n),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-n);break;case 7:t.rotate(.5*Math.PI),t.translate(i,-n),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-i,0);break}};Tt.getTransformedOptions=function(r){if(!r.orientation||r.orientation===1)return r;var e={},t;for(t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);switch(r.orientation){case 2:e.left=r.right,e.right=r.left;break;case 3:e.left=r.right,e.top=r.bottom,e.right=r.left,e.bottom=r.top;break;case 4:e.top=r.bottom,e.bottom=r.top;break;case 5:e.left=r.top,e.top=r.left,e.right=r.bottom,e.bottom=r.right;break;case 6:e.left=r.top,e.top=r.right,e.right=r.bottom,e.bottom=r.left;break;case 7:e.left=r.bottom,e.top=r.right,e.right=r.top,e.bottom=r.left;break;case 8:e.left=r.bottom,e.top=r.left,e.right=r.top,e.bottom=r.right;break}return r.orientation>4&&(e.maxWidth=r.maxHeight,e.maxHeight=r.maxWidth,e.minWidth=r.minHeight,e.minHeight=r.minWidth,e.sourceWidth=r.sourceHeight,e.sourceHeight=r.sourceWidth),e};Tt.ExifMap=function(){return this};Tt.ExifMap.prototype.map={Orientation:274};Tt.ExifMap.prototype.get=function(r){return this[r]||this[this.map[r]]};Tt.getExifThumbnail=function(r,e,t){var i,n,o;if(!t||e+t>r.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}for(i=[],n=0;n<t;n+=1)o=r.getUint8(e+n),i.push((o<16?"0":"")+o.toString(16));return"data:image/jpeg,%"+i.join("%")};Tt.exifTagTypes={1:{getValue:function(r,e){return r.getUint8(e)},size:1},2:{getValue:function(r,e){return String.fromCharCode(r.getUint8(e))},size:1,ascii:!0},3:{getValue:function(r,e,t){return r.getUint16(e,t)},size:2},4:{getValue:function(r,e,t){return r.getUint32(e,t)},size:4},5:{getValue:function(r,e,t){return r.getUint32(e,t)/r.getUint32(e+4,t)},size:8},9:{getValue:function(r,e,t){return r.getInt32(e,t)},size:4},10:{getValue:function(r,e,t){return r.getInt32(e,t)/r.getInt32(e+4,t)},size:8}};Tt.exifTagTypes[7]=Tt.exifTagTypes[1];Tt.getExifValue=function(r,e,t,i,n,o){var s=Tt.exifTagTypes[i],a,l,c,u,p,g;if(!s){console.log("Invalid Exif data: Invalid tag type.");return}if(a=s.size*n,l=a>4?e+r.getUint32(t+8,o):t+8,l+a>r.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(n===1)return s.getValue(r,l,o);for(c=[],u=0;u<n;u+=1)c[u]=s.getValue(r,l+u*s.size,o);if(s.ascii){for(p="",u=0;u<c.length&&(g=c[u],g!=="\0");u+=1)p+=g;return p}return c};Tt.parseExifTag=function(r,e,t,i,n){var o=r.getUint16(t,i);n.exif[o]=Tt.getExifValue(r,e,t,r.getUint16(t+2,i),r.getUint32(t+4,i),i)};Tt.parseExifTags=function(r,e,t,i,n){var o,s,a;if(t+6>r.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(o=r.getUint16(t,i),s=t+2+12*o,s+4>r.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(a=0;a<o;a+=1)this.parseExifTag(r,e,t+2+12*a,i,n);return r.getUint32(s,i)};Tt.parseExifData=function(r,e,t,i,n){if(!n.disableExif){var o=e+10,s,a,l;if(r.getUint32(e+4)===1165519206){if(o+8>r.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(r.getUint16(e+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(r.getUint16(o)){case 18761:s=!0;break;case 19789:s=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(r.getUint16(o+2,s)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}a=r.getUint32(o+4,s),i.exif=new Tt.ExifMap,a=Tt.parseExifTags(r,o,o+a,s,i),a&&!n.disableExifThumbnail&&(l={exif:{}},a=Tt.parseExifTags(r,o,o+a,s,l),l.exif[513]&&(i.exif.Thumbnail=Tt.getExifThumbnail(r,o+l.exif[513],l.exif[514]))),i.exif[34665]&&!n.disableExifSub&&Tt.parseExifTags(r,o,o+i.exif[34665],s,i),i.exif[34853]&&!n.disableExifGps&&Tt.parseExifTags(r,o,o+i.exif[34853],s,i)}}};Tt.metaDataParsers.jpeg[65505].push(Tt.parseExifData);Tt.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"};Tt.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}};Tt.ExifMap.prototype.getText=function(r){var e=this.get(r);switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[r][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[r][e[0]]+this.stringValues[r][e[1]]+this.stringValues[r][e[2]]+this.stringValues[r][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)};(function(r){var e=r.tags,t=r.map,i;for(i in e)e.hasOwnProperty(i)&&(t[e[i]]=i)})(Tt.ExifMap.prototype);Tt.ExifMap.prototype.getAll=function(){var r={},e,t;for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(r[t]=this.getText(t)));return r};function y8(r,e){for(var t=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],i,n=0;n<t.length;n++)if(i=r.toDataURL("image/jpeg",t[n]),i.length<e)return i;return i}function EZ(r,e){for(var t=r.toDataURL().length,i=r.width,n=r.height,o=document.createElement("canvas"),s,a=0;a<2;a++){var l=Math.sqrt(e/t);i=Math.round(l*i),n=Math.round(l*n),o.height=n,o.width=i;var c=o.getContext("2d");if(c.drawImage(r,0,0,i,n),s=o.toDataURL(),t=s.length,t<e)return s}return s}function kZ(r){for(var e=r.getContext("2d"),t=e.getImageData(0,0,r.width,r.height).data,i=3;i<t.length;i+=4)if(t[i]!==255)return!0;return!1}function DG(r,e){var t={orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600};Tt(r,function(i){if(!i.toDataURL){e(!0);return}var n=2e5,o;if(r.type==="image/jpeg")o=y8(i,n);else if(o=i.toDataURL(),o.length>n){var s=o.length>.75*i.width*i.height,a=s&&!kZ(i);o=a?y8(i,n):EZ(i,n)}e(null,o)},t)}var u0={keypad:!0,graphpaper:!0,expressions:!0,settingsMenu:!0,zoomButtons:!0,showResetButtonOnGraphpaper:!1,expressionsTopbar:!0,capExpressionSize:!1,pointsOfInterest:!0,trace:!0,border:!0,lockViewport:!1,expressionsCollapsed:!1,authorFeatures:!1,authorMode:!0,advancedStyling:!0,images:!0,imageUploadCallback:DG,folders:!0,notes:!0,sliders:!0,links:!0,qwertyKeyboard:!0,restrictedFunctions:!0,forceEnableGeometryFunctions:!0,pasteGraphLink:!1,pasteTableData:!0,degreeMode:!1,clearIntoDegreeMode:!1,autosize:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,colors:{RED:nS,BLUE:oS,GREEN:sS,ORANGE:lS,PURPLE:aS,BLACK:cS},invertedColors:!1,functionDefinition:!0,projectorMode:!1,decimalToFraction:!0,fontSize:16,language:"en",backgroundColor:"#fff",textColor:"#000",distributions:!0,brailleMode:"none",sixKeyInput:!1,brailleControls:!0,zoomFit:!0,forceLogModeRegressions:!1,actions:"auto",audio:!0,logScales:!0},b8=Object.keys(u0),w8={product:"graphing-3d",showHamburger:!1,disableScrollFix:!1,branding:!0,onlyTraceSelected:!1,disableMouseInteractions:!1,nativeOnscreenKeypad:!1,plaidMode:!1,pasteGraphLinkCallback:void 0,editOnWeb:!1,crossOriginSaveTest:!1,enableTabindex:!0,audioTraceReverseExpressions:!1,transparentBackground:!1,pauseWhenOffscreen:!1,hideGeoUI:!1,substitutions:!0,beta3d:!0,ghostMode:!1},GZ={solutions:!0,menus:!0,singleVariableSolutions:!0,clickableObjects:!0,administerSecretFolders:!1},SG=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},u0),w8);function x8(r){return!!(u0.hasOwnProperty(r)||w8.hasOwnProperty(r)||GZ.hasOwnProperty(r))}function EG(r){var e=__dcg_shared_module_exports__['j'](SG);for(var t in r)e.hasOwnProperty(t)&&(e[t]=r[t]);return __dcg_shared_module_exports__['P'](e.backgroundColor)||(e.backgroundColor=SG.backgroundColor,__dcg_shared_module_exports__['k'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")),__dcg_shared_module_exports__['P'](e.textColor)||(e.textColor=SG.textColor,__dcg_shared_module_exports__['k'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")),e.actions!==!0&&e.actions!==!1&&e.actions!=="auto"&&(e.actions=SG.actions,__dcg_shared_module_exports__['k'].warn("Invalid actions setting. Must be true, false, or 'auto'.")),r.zoomButtons===void 0&&(!e.graphpaper||e.lockViewport)&&(e.zoomButtons=!1),r.images===void 0&&(e.graphpaper||(e.images=!1)),r.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['k'].warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),r.hasOwnProperty("settingsMenu")||(e.settingsMenu=!!r.menus),r.hasOwnProperty("expressionsTopbar")||(e.expressionsTopbar=!!r.menus)),r.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['k'].warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),r.hasOwnProperty("pointsOfInterest")||(e.pointsOfInterest=!!r.solutions)),r.hasOwnProperty("singleVariableSolutions")&&__dcg_shared_module_exports__['k'].warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),r.hasOwnProperty("clickableObjects")&&(__dcg_shared_module_exports__['k'].warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."),r.clickableObjects===!0&&!r.hasOwnProperty("actions")&&(e.actions=!0)),r.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['k'].warn("As of API v1.8, the 'administerSecretFolders' option is deprecated and has been subsumed under 'authorFeatures'."),r.administerSecretFolders===!0&&!r.hasOwnProperty("authorFeatures")&&(e.authorFeatures=!0)),e.graphpaper||(e.expressionsCollapsed&&(e.expressionsCollapsed=!1,__dcg_shared_module_exports__['k'].warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['k'].warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(e.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['k'].warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))),e.lockViewport&&e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['k'].warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),(e.notes===!1||e.folders===!1||e.images===!1)&&e.pasteGraphLink===!0&&(e.pasteGraphLink=!1,__dcg_shared_module_exports__['k'].warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")),e.language&&(e.language=qd(e.language)),e}function v8(r,e){var t={},i={};for(var n in r)x8(n)?t[n]=r[n]:e_(n)?i[n]=r[n]:e||__dcg_shared_module_exports__['k'].warn("Unrecognized setting: "+n+". Ignoring.");return{configOptions:t,settingsOptions:i}}function C8(r,e){var t={};return e.hasOwnProperty("x")&&(t.x=r.mapX(e.x)),e.hasOwnProperty("y")&&(t.y=r.mapY(e.y)),t}var S8=[],p0=!1,D8=new Map;function IZ(r){let e=D8.get(r);return e||(e=new r,D8.set(r,e)),e}function E8(r){if(!r||p0)return;let e;for(;(e=S8.shift())&&e.api._destroyed;);if(!e)return;let t=e;p0=!0;let{options:i,mathBounds:n,state:o,callback:s}=t;var a=IZ(r);a.setState(o),a.setMathBounds(n),["majorAxisOpacity","minorAxisOpacity","axisLineOffset","axisLineWidth","labelSize","graphLineWidth","pointLineWidth"].forEach(h=>{h==="axisLineWidth"?a._calc.grapher.settings.setProperty(h,t.api._calc.grapher.settings[h]):a._calc.grapher.settings[h]=t.api._calc.grapher.settings[h]});var c=a._calc.evaluator,u=()=>{a._calc.grapher.asyncScreenshot(i,h=>{p0=!1,E8(r),s(h)})},p=t.api._calc.controller,g=qu(function(){p.areAnyImagesLoading()||(Sg(g),c.notifyWhenSynced(u))})}var Eg=class extends Wr{constructor(t,i,n){super();this._destroyed=!1;this.isOffscreen=!1;var o=v8(i||{},!0),s=EG(o.configOptions),a=o.settingsOptions;this._calc=new sv(t,xy,s),this._calc.interceptTouch(),this.controller=this._calc.controller,this.controller.onEventsEmitted=l=>{let c=this.controller.getSelectedItem();this.setProperty("isAnyExpressionSelected",!!c),this.setProperty("selectedExpressionId",c?c.id:void 0),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());var u=it.getFocusedMathquill();this.setProperty("focusedMathQuill",u?new wG(u):void 0);for(var p in l){if(!l.hasOwnProperty(p))continue;let g=l[p];g&&this.triggerEvent(p,g)}},this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(a),this._sharedClockBusToken=qu(l=>this.withControllerInAPIMode(()=>{var c=this._calc.grapher.settings.config.pauseWhenOffscreen&&this.isOffscreen;this._calc.tick(l,c)})),this.domChangeDetector=new Dg(t,l=>this.withControllerInAPIMode(()=>{switch(this.isOffscreen=l.isOffscreen,l.type){case"offscreen-noop":break;case"added":this._calc.resize(l.size);break;case"removed":break;case"resized":this._calc.resize(l.size);break}})),s.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),typeof n=="function"&&n(this)}destroy(){this.controller.onEventsEmitted=function(){},this._calc.destroy(),Sg(this._sharedClockBusToken),this.domChangeDetector.destroy();function t(s){__dcg_shared_module_exports__['k'].warn("You've destroyed this API instance. You can no longer call ."+s+"()")}for(var i={},n=this;n;)Object.getOwnPropertyNames(n).forEach(a=>i[a]=!0),n=Object.getPrototypeOf(n);for(var o in i)typeof this[o]=="function"?this[o]=t.bind(this,o):this.hasOwnProperty(o)&&delete this[o];this.destroy=function(){},this._destroyed=!0}withControllerInAPIMode(t){try{return this.controller.pushAPIMethodCall(),t()}finally{this.controller.popAPIMethodCall()}}_syncGraphpaperBounds(){return this.withControllerInAPIMode(()=>{this.controller.runAfterDispatch(()=>{this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})})})}_initGraphSettings(){return this.withControllerInAPIMode(()=>{var t=new Wr;this.settings=this.graphSettings=t,ZP.forEach(i=>{this._calc.grapher.settings.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(i,this._calc.grapher.settings[i])})})}),b8.forEach(i=>{this._calc.grapher.settings.config.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(i,this._calc.grapher.settings.config[i])})})})})}updateSettings(t){return this.withControllerInAPIMode(()=>{var i=v8(t,!1),n=i.configOptions,o=i.settingsOptions;__dcg_shared_module_exports__['H'](n)||this._calc.setOptions(n),__dcg_shared_module_exports__['H'](o)||this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"set-graph-settings"},this.controller.getGraphSettings().validateSettings(o))),this.notifyControllerOfAPICall()})}setGraphSettings(t){return this.withControllerInAPIMode(()=>{__dcg_shared_module_exports__['k'].warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(t),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()})}setDefaultState(t){return this.withControllerInAPIMode(()=>{this._calc.grapher.settings.setProperty("defaultState",t),this.notifyControllerOfAPICall()})}mathToPixels(t){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['xc'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale});return C8(i,t)})}pixelsToMath(t){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['xc'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale}).inverse();return C8(i,t)})}notifyControllerOfAPICall(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"render"})})}setExpression(t){return this.withControllerInAPIMode(()=>{var i=this.controller,n=i.getItemModel(t.id),o=n&&n.type,s=bG(t,o,this.controller);if(s)if(o)this.controller.dispatch({type:"set-expression-properties-from-api",id:s.id,properties:s});else{if(s.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:s})}})}setExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.setExpression.bind(this))})}removeExpression(t){return this.withControllerInAPIMode(()=>{var i=t.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:i})})}removeExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.removeExpression.bind(this))})}removeSelected(){return this.withControllerInAPIMode(()=>{var t=this.controller.getSelectedItem();if(!t)return;let{id:i}=t;return this.controller.dispatch({type:"remove-item-by-id",id:i}),i})}setMathBounds(t){return this.withControllerInAPIMode(()=>{t&&t.left<t.right&&t.bottom<t.top?(this._calc.setViewport([t.left,t.right,t.bottom,t.top]),this._calc.controller.unmarkLastChangedAxis(),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['k'].warn("Invalid bounds argument. Expected a bounds object with bounds.bottom < bounds.top, and bounds.left < bounds.right. Got "+JSON.stringify(t)),this.notifyControllerOfAPICall()})}setViewport(t){return this.withControllerInAPIMode(()=>{t.length==4&&t[1]>t[0]&&t[3]>t[2]?(this._calc.setViewport(t),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['k'].warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+t),this.notifyControllerOfAPICall()})}resize(){return this.withControllerInAPIMode(()=>{this.domChangeDetector.checkForChanges()})}getState(t){return this.withControllerInAPIMode(()=>this.controller.getState(t))}getExpressions(){return this.withControllerInAPIMode(()=>{var t=this.getState({stripDefaults:!1}).expressions.list;return t.map(yG)})}setBlank(t){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-blank",opts:t||{}})})}setState(t,i){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-state",state:t,opts:i||{}})})}undo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"undo"})})}redo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"redo"})})}clearHistory(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"clear-undoredo-history"})})}newRandomSeed(){return this.withControllerInAPIMode(()=>{this.updateSettings({randomSeed:Rd()})})}screenshot(t){return this.withControllerInAPIMode(()=>(t||(t={}),t=this._validateBrailleScreenshotOptions(t),this._calc.grapher.screenshot(t)))}_getMathAspectRatio(){return this.withControllerInAPIMode(()=>{var t=this.graphpaperBounds.mathCoordinates,i=this._calc.grapher.getProjection().pixelCoordinates,n=i.right-i.left,o=i.bottom-i.top,s=t.width/n,a=t.height/o;return s/a})}isProjectionUniform(){return this.withControllerInAPIMode(()=>!!this._calc.grapher.getProjection().settings.squareAxes)}_validateBrailleScreenshotOptions(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['j'](t);var i=t.braille;if(i){let n=i.embosserModel;if(!n)return __dcg_shared_module_exports__['k'].warn("Screenshot braille options requires an embosser model to be specified. "),__dcg_shared_module_exports__['k'].warn("Continuing with non-braille screenshot."),delete t.braille,t;if(n==="etc"&&(i.embosserModel="etc11"),n==="vpmax"&&(i.embosserModel="vpmax11"),i.embosserModel!=="etc8"&&i.embosserModel!=="etc11"&&i.embosserModel!=="vpmax8"&&i.embosserModel!=="vpmax11")return __dcg_shared_module_exports__['k'].warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'),__dcg_shared_module_exports__['k'].warn("Continuing with non-braille screenshot."),delete t.braille,t;i.brailleMode!=="nemeth"&&i.brailleMode!=="ueb"&&(__dcg_shared_module_exports__['k'].warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."),i.brailleMode="nemeth"),t.width&&(__dcg_shared_module_exports__['k'].warn("Screenshot width option is ignored when exporting Braille."),delete t.width),t.height&&(__dcg_shared_module_exports__['k'].warn("Screenshot height option is ignored when exporting Braille."),delete t.height),t.targetPixelRatio&&(__dcg_shared_module_exports__['k'].warn("Screenshot targetPixelRatio option is ignored when exporting Braille."),delete t.targetPixelRatio),t.preserveAxisNumbers&&(__dcg_shared_module_exports__['k'].warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."),delete t.preserveAxisNumbers)}return t})}_validateAsyncScreenshotOpts(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['j'](t);let i=t.mode||"contain",n=t.width||t.height||this.graphpaperBounds.pixelCoordinates.width,o=t.height||t.width||this.graphpaperBounds.pixelCoordinates.height,s=t.targetPixelRatio||1;s<1&&(s=1);let a=t.preserveAxisNumbers;t.hasOwnProperty("format")||(t.svg?(t.format="svg",delete t.svg):t.format="png");let l=t.mathBounds||{},c=this._getMathAspectRatio(),u=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height,p=d8({mode:i,width:n,height:o,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:u,mathAspectRatio:c,mathBounds:l});return{opts:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{width:n,height:o,targetPixelRatio:s,preserveAxisNumbers:a}),mathBounds:p}})}asyncScreenshot(t,i){if(!arguments.length){__dcg_shared_module_exports__['k'].warn("asyncScreenshot expects a callback");return}if(arguments.length===1)if(typeof t!="function"){__dcg_shared_module_exports__['k'].warn("asyncScreenshot expects a callback");return}else i=t,t={};return this.withControllerInAPIMode(()=>{t||(t={}),t=this._validateBrailleScreenshotOptions(t);let{opts:n,mathBounds:o}=this._validateAsyncScreenshotOpts(t);S8.push({api:this,options:n,mathBounds:o,state:this.getState(),callback:i}),E8(this.constructor)})}setOptions(t){return this.withControllerInAPIMode(()=>{var i=this._calc.setOptions(t);return this.notifyControllerOfAPICall(),i})}focusFirstExpression(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"focus-first-expression"})})}openKeypad(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})})}HelperExpression(t){return this.withControllerInAPIMode(()=>{var i=t&&t.latex||"",n=new Wr;return n.latex=i,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:i,proxy:n}}),n})}};var Qa=class extends Eg{constructor(e,t,i){super(e,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{product:"graphing-3d"}),i)}};ct();function k8(r){let e={};return O.extend(!0,e,r),O.param(e)}var kG="";function th(){return kG}var G8=[];function I8(r){G8.push(r)}function VZ(r){if(r.status===401)for(let e of G8)e()}async function TZ(r){if(r&&r.routeDeprecated)throw r.js&&new Function(r.js)(),r}function MZ(){throw{status:0,responseJSON:{errors:[{message:"Connection failed. Check your internet connection?"}]}}}async function h0(r){let e=await r.catch(MZ);if(VZ(e),!e.ok){let i;try{i=await e.json()}catch(n){}throw{status:e.status,responseJSON:i}}let t=await e.json();return await TZ(t),t}async function yo(r,e){let t={method:"POST",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}};return e!==void 0&&(t.body=k8(e),t.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),await h0(fetch(kG+r,t))}async function V8(r,e){let t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript, */*; q=0.01"},body:JSON.stringify(e||null)};return await h0(fetch(kG+r,t))}async function tc(r,e){e===void 0&&(e={}),e=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},e),fd);let t={method:"GET",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}},i=/\?/.test(r)?"&":"?";return await h0(fetch(`${kG}${r}${i}${new URLSearchParams(e)}`,t))}function g0(){return yo("/account/logout_xhr")}function T8(r){let e=function(){return yo("/account/login_xhr",r)};return g0().then(e,e).then(()=>kg({lang:r.lang}))}function kg(r){return tc("/account/user_info",r)}async function M8(){let r=await tc("/account/user_info?no401");if(r.loggedIn===!1)throw r;return r}function A8(r){return yo("/account/check_account_status",r)}function L8(r){return yo("/account/register_xhr",r).then(()=>kg({lang:r.lang}))}function O8(r){r===void 0&&(r={});let e="?source="+(r.fromUI||"");return r.teacher&&(e+="&teacher=true"),th()+"/drive_api/calculator/login"+e}function P8(r){r===void 0&&(r={});let e="?source="+(r.fromUI||"");return r.teacher&&(e+="&teacher=true"),th()+"/apple_api/calculator/login"+e}function _8(r){return yo("/account/change_name",r).then(()=>kg({lang:r.lang}))}function F8(r){return yo("/account/change_name_detail",{lang:r.lang,userProvidedName:{given:r.given,family:r.family}}).then(()=>kg({lang:r.lang}))}function R8(r){return yo("/account/recover_xhr",r)}function N8(r){return tc("/account/initiate_delete_account",r)}function B8(r){return tc("/account/initiate_email_change",r)}function K8(r){return yo("/account/set_email",r).then(()=>kg({lang:r.lang}))}function U8(r){return V8("/account/update_feature_flags",r).then(()=>kg({lang:r.lang}))}function H8(r){return yo("/account/set_privacy_consent",r).then(()=>kg({lang:r.lang}))}function q8(r){return yo("/account/submit_art_contest_entry",r)}function z8(){return yo("/account/check_art_contest_entry",{})}function W8(r,e){r.closed?e.askServerIfLoggedIn():setTimeout(()=>{W8(r,e)},1e3)}function $8(r){var e=window.open(r.url,"login_window","width=650,height=530,resizable,scrollbars");e?W8(e,r.userController):alert(r.blockedMessage)}function j8(r,e){window.userController=r,r.observeEvent("googleLogin",function(t,i){$8({url:O8(i),userController:r,blockedMessage:e("account-shell-text-login-window-blocked-google")})}),r.observeEvent("appleLogin",function(t,i){$8({url:P8(i),userController:r,blockedMessage:e("account-shell-text-login-window-blocked-apple")})})}var LZ=50,Cy=class{constructor(e,t){this.apiUrl=e;this.staticData=t;this.throttledFlushBatchedLogs=__dcg_shared_module_exports__['B'](async()=>{if(this.requestInFlight||this.batchedLogs.length==0)return;let e=this.batchedLogs.splice(0,LZ);this.requestInFlight=!0;try{await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:e})})}catch(t){}this.requestInFlight=!1,this.throttledFlushBatchedLogs()},1e3,{leading:!1});this.batchedLogs=[],this.requestInFlight=!1}log(e){this.batchedLogs.push(__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.staticData),e)),this.throttledFlushBatchedLogs()}};var OZ={eventType:"eventType",pageLoadId:window.pageLoadId||Md(),source:"browser",app:"knox",userAgent:navigator.userAgent};var PZ=new Cy("data-events",OZ);function _Z(r){PZ.log(__dcg_shared_module_exports__['a']({url:document.location.href},r))}function Ei(r,e){_Z({eventType:r,payloadJSON:JSON.stringify(e)})}var J8,Y8=!0;function X8(r){let e=document.location.href,t=navigator.userLanguage||navigator.language,i=document.referrer,n=__dcg_shared_module_exports__['a']({browserLang:t,referrer:i},r);J8!==e&&(J8=e,Y8?(Ei("page-load",n),Y8=!1):(delete n.referrer,Ei("page-spa-load",n)))}var FZ={eventType:"eventType",pageLoadId:window.pageLoadId||Md(),source:"browser",app:"knox",userAgent:navigator.userAgent},RZ=new Cy("/usage-stats",FZ);function Q8(r,e){RZ.log({eventType:r,url:document.location.href,payloadJSON:JSON.stringify(e)})}var f0={};__dcg_shared_module_exports__['g'](f0,{isDegreeMode:()=>BZ,isProjectorMode:()=>NZ});function NZ(r){return r.isProjectorMode()}function BZ(r){return r.model.getDegreeMode()}var y0={};__dcg_shared_module_exports__['g'](y0,{isLoggedIn:()=>KZ});function KZ(r){return r.userController.isLoggedIn()}var b0={};__dcg_shared_module_exports__['g'](b0,{expressionCount:()=>WZ,expressionErrors:()=>QZ,folderCount:()=>jZ,hasAction:()=>qZ,hasCustomColors:()=>$Z,hasMovablePoints:()=>zZ,hasRegression:()=>HZ,hasSlider:()=>UZ,imageCount:()=>JZ,tableCount:()=>YZ,textCount:()=>XZ});function UZ(r){return r.getAllModelsWithSliders().length>0}function HZ(r){for(let e of r.getAllItemModels())if(e.type==="expression"&&Vm(e))return!0;return!1}function qZ(r){if(r.getListModel().ticker.open)return!0;for(let e of r.getAllItemModels())if(e&&"formula"in e&&e.formula){if(e.type!=="expression"&&e.type!=="image")continue;let{formula:t}=e;if(t.hasOwnProperty("action_value")||t.hasOwnProperty("click_handler"))return!0}return!1}function zZ(r){return r.getAllItemModels().some(e=>e.type==="expression"&&rn(e)!=="NONE")}function $Z(r){for(let e of r.getAllItemModels()){if(e.type!=="expression"||!po(e))continue;let i=r.getEvaluationValueForItem(e.id);if(typeof i=="string"||Array.isArray(i)&&typeof i[0]=="string")return!0}return!1}function WZ(r){return r.getAllItemModels().filter(e=>e.type==="expression").length}function jZ(r){return r.getAllItemModels().filter(e=>e.type==="folder").length}function JZ(r){return r.getAllItemModels().filter(e=>e.type==="image").length}function YZ(r){return r.getAllItemModels().filter(e=>e.type==="table").length}function XZ(r){return r.getAllItemModels().filter(e=>e.type==="text").length}function QZ(r){let e=[];for(let t of r.getAllItemModels())if(t.type==="expression"&&t.error){let{key:i}=t.error;i!=="shared-calculator-error-blank-expression"&&e.push(i)}return e}var ZZ="usage-ping",Z8=60*1e3,eH=1/60,uv=class{constructor(e={}){this.samplingInterval=Z8,this.samplingProbability=eH,this.lastConsideredTime=Date.now(),this.pageLoadTime=Date.now(),this.graphLoadTime=Date.now(),this.basicController=e.basicController,this.frontendController=e.frontendController,this.calcController=e.calcController,this.graphsController=e.graphsController,this.featureQueryMap={"basic-controller-feature":[],"frontend-controller-feature":[],"graph-feature":[]},this.focused=!0,this.focusIntervalStart=Date.now(),this.totalTimeFocused=0,window.addEventListener("focus",()=>{this.focused=!0,this.focusIntervalStart=Date.now()}),window.addEventListener("blur",()=>{this.focused=!1,this.addTimeFocused()}),this.visibleIntervalStart=Date.now(),this.totalTimeVisible=0,document.addEventListener("visibilitychange",()=>{document.hidden?this.addTimeVisible():this.visibleIntervalStart=Date.now()}),this.graphsController&&this.graphsController.observeEvent("onLoadGraph",()=>{this.graphLoadTime=Date.now()})}getUsageData(){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.getBasicUsageData()),this.getBasicControllerUsageData()),this.getFrontendControllerUsageData()),this.getGraphFeatureUsageData())}getBasicUsageData(){let e={timeSincePageload:this.getTimeSincePageload(),totalTimeFocused:this.getTotalTimeFocused(),totalTimeVisible:this.getTotalTimeVisible(),samplingInterval:Z8,samplingProbability:eH};return this.graphsController&&(e.timeSinceGraphLoaded=Date.now()-this.graphLoadTime),e}getDataFromController(e,t,i){let n={};for(let o of this.featureQueryMap[e]){let s=t[o];if(!s)throw new Error(`'${o}' is not a valid feature name.`);let a=s(i);(Array.isArray(a)&&a.length>0||typeof a=="boolean"&&a||typeof a=="number")&&(n[o]=a)}return n}getBasicControllerUsageData(){return this.getDataFromController("basic-controller-feature",f0,this.basicController)}getFrontendControllerUsageData(){return this.getDataFromController("frontend-controller-feature",y0,this.frontendController)}getGraphFeatureUsageData(){return this.getDataFromController("graph-feature",b0,this.calcController)}callLogger(){let e=Date.now();e-this.lastConsideredTime>this.samplingInterval&&(this.lastConsideredTime=e,Math.random()<this.samplingProbability&&Q8(ZZ,this.getUsageData()))}addTimeFocused(){let e=Date.now()-this.focusIntervalStart;this.totalTimeFocused+=e}addTimeVisible(){let e=Date.now()-this.visibleIntervalStart;this.totalTimeVisible+=e}getTotalTimeFocused(){return this.focused?(this.addTimeFocused(),this.focusIntervalStart=Date.now(),this.totalTimeFocused):this.totalTimeFocused}getTotalTimeVisible(){return document.hidden?this.totalTimeVisible:(this.addTimeVisible(),this.visibleIntervalStart=Date.now(),this.totalTimeVisible)}start(){setInterval(this.callLogger.bind(this))}trackFeatureUsage(e,t){if(!this.calcController)throw new Error("Monitoring graph feature usage requires a calculator controller.");this.featureQueryMap[e].push(t)}getTimeSincePageload(){return Date.now()-this.pageLoadTime}};var qy=__dcg_shared_module_exports__['h'](X());var tl=__dcg_shared_module_exports__['h'](X());var It=__dcg_shared_module_exports__['h'](X());ct();var rc=__dcg_shared_module_exports__['h'](X());var GG=class extends rc.Class{template(){return rc.createElement("span",{role:rc.const("button"),tabindex:rc.const(0),"aria-label":()=>this.openGraphText(),class:rc.const("dcg-header-btn dcg-action-opendrawer dcg-tooltip"),tooltip:()=>this.openGraphText(),onTap:e=>this.props.controller().dispatch({type:"open-mygraphs",device:e.device})},rc.createElement(Ke,{tooltip:()=>this.openGraphText(),disabled:()=>!this.props.tooltip(),gravity:this.const("se"),offset:()=>({top:12})},rc.createElement("i",{class:rc.const("dcg-icon-hamburger"),"aria-hidden":rc.const("true")})))}openGraphText(){let e=this.props.controller().getOpenText();return di?this.props.controller().s("account-shell-label-open-graph-mac",{open_graph:e}):this.props.controller().s("account-shell-label-open-graph-pc",{open_graph:e})}};var Ir=__dcg_shared_module_exports__['h'](X());ct();var{If:IG}=Ir.Components,VG=class extends Ir.Class{template(){let e=this.props.controller().userController;return Ir.createElement("span",null,Ir.createElement(IG,{predicate:()=>e.isLoggedIn()&&!this.props.disableAccounts()},()=>Ir.createElement("span",null,Ir.createElement(IG,{predicate:()=>e.isLoggingOut()},()=>Ir.createElement("span",{class:Ir.const("logout-progress-notice")},Ir.createElement("span",{class:Ir.const("dcg-spinner-dark")}))),Ir.createElement(IG,{predicate:()=>!e.isLoggingOut()&&!this.props.disableAccounts()},()=>Ir.createElement("span",{class:Ir.const("dcg-account-link"),"dcg-menu-button":Ir.const("account"),role:Ir.const("button"),tabindex:Ir.const(0),"aria-haspopup":Ir.const("true"),"aria-expanded":Ir.const("false"),"aria-label":Ir.const("Account Information"),onTap:t=>{if(this.props.controller().dispatch({type:"toggle-menu",payload:"account"}),t.device=="keyboard"){let n=this.props.controller().getOpenMenu()==="account"?".dcg-action-accountsettings":".dcg-account-link";O(n).trigger("focus")}}},Ir.createElement("span",{class:Ir.const("email")},Ir.createElement("div",{class:Ir.const("header-account-name dcg-variable-name")},()=>e.getFirstName()),Ir.createElement("i",{class:Ir.const("dcg-icon-caret-down"),"aria-hidden":Ir.const("true")})))))),Ir.createElement(IG,{predicate:()=>!e.isLoggedIn()&&!this.props.disableAccounts()},()=>Ir.createElement("span",{class:Ir.const("dcg-login")},Ir.createElement("a",{role:Ir.const("link"),tabindex:Ir.const(0),class:Ir.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:t=>{this.props.controller().dispatch({type:"show-modal",modal:"login",device:t.device})}},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),Ir.createElement("a",{role:Ir.const("link"),tabindex:Ir.const(0),class:Ir.const("dcg-create-account dcg-btn dcg-btn-primary dcg-action-createaccount"),onTap:t=>{this.props.controller().dispatch({type:"show-modal",modal:"signup",device:t.device})}},()=>this.props.controller().s("account-shell-button-sign-up")))))}};var Wc=__dcg_shared_module_exports__['h'](X());var Dy=class extends Wc.Class{init(){this.controller=this.props.controller()}template(){return this.controller=this.props.controller(),Wc.createElement(Ke,{tooltip:this.props.tooltip,gravity:this.bindFn(this.getGravity),offset:()=>({top:12})},Wc.createElement("span",{role:Wc.const("button"),tabindex:Wc.const("0"),"aria-haspopup":Wc.const("true"),"aria-label":()=>this.props.label(),"aria-expanded":()=>this.isMenuOpen(),class:()=>({"dcg-header-btn":!0,[this.getBtnClass()]:!0,"dcg-tooltip":!0,"dcg-active":this.isMenuOpen()}),"dcg-menu-button":this.props.name,onTap:this.props.onTap},Wc.createElement("i",{class:this.props.icon,"aria-hidden":Wc.const("true")})))}getBtnClass(){switch(this.props.name()){case"help":return"dcg-action-help";case"language":return"dcg-action-language";case"share":return"dcg-action-share"}}getGravity(){return this.props.gravity?this.props.gravity():"s"}isMenuOpen(){return this.controller.getOpenMenu()===this.props.label().toLowerCase()}};var Uo=__dcg_shared_module_exports__['h'](X());var Ko=__dcg_shared_module_exports__['h'](X());var{SwitchUnion:eee}=Ko.Components,TG=class extends Ko.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getSaveStatus(){return this.graphsController.isSaving()?"saving":this.graphsController.didSaveSucceed()?"save-success":"default"}template(){return Ko.createElement("span",null,eee(()=>this.getSaveStatus(),{saving:()=>Ko.createElement("span",{class:Ko.const("dcg-if-user save-btn-container")},Ko.createElement("span",{class:Ko.const("saving-notice")},Ko.createElement("span",{class:Ko.const("dcg-spinner-dark")}))),"save-success":()=>Ko.createElement("span",{class:Ko.const("dcg-save-success")},Ko.createElement("i",{class:Ko.const("dcg-icon-check")}),()=>this.controller.s("shared-calculator-label-saved")),default:()=>Ko.createElement("span",{class:()=>({"dcg-if-user save-btn-container":!0})},Ko.createElement(Ke,{tooltip:()=>this.controller.isSaveEnabled()?this.saveChangesText():this.controller.s("account-shell-label-no-unsaved-changes"),offset:()=>({top:7})},Ko.createElement("span",{role:Ko.const("button"),class:()=>({"dcg-action-save":!0,"tooltip-offset":!0,"dcg-btn-primary":this.controller.isSaveEnabled(),"dcg-disabled":!this.controller.isSaveEnabled()}),onTap:e=>{this.controller.isSaveEnabled()&&this.controller.simpleSave(e.device)}},()=>this.controller.s("account-shell-button-save"))))}))}saveChangesText(){return di?this.controller.s("account-shell-label-save-changes-mac"):this.controller.s("account-shell-label-save-changes-pc")}};var{If:tH}=Uo.Components,MG=class extends Uo.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.graphsController=this.controller.graphsController}template(){return Uo.createElement("span",{class:Uo.const("title-div")},Uo.createElement("span",{role:Uo.const("button"),class:Uo.const("dcg-variable-title-container"),"dcg-menu-button":()=>this.shouldShowDropdown()?"graph-actions":void 0,tabindex:Uo.const(0),onTap:e=>{this.shouldShowDropdown()?this.openGraphActionsDropdown(e):this.shouldOpenSaveDialog()&&this.controller.dispatch({type:"edit-title"})},"aria-haspopup":()=>this.shouldShowDropdown(),"aria-expanded":()=>this.props.controller().getOpenMenu()=="graph-actions","aria-label":()=>this.shouldShowDropdown()?this.controller.s("account-shell-label-graph-actions"):void 0},Uo.createElement("span",{class:()=>({"dcg-variable-title dcg-tooltip":!0,"dcg-action-savedialog":this.shouldOpenSaveDialog()})},()=>this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()),Uo.createElement(tH,{predicate:this.bindFn(this.shouldShowDropdown)},()=>Uo.createElement("span",{class:Uo.const("dcg-graph-actions-dropdown-anchor")},Uo.createElement("i",{class:Uo.const("dcg-icon-caret-down"),"aria-hidden":Uo.const("true")})))),Uo.createElement(tH,{predicate:()=>this.userController.isLoggedIn()&&!this.controller.getPreviewParams()&&!this.controller.isInMaintenanceMode()},()=>Uo.createElement(TG,{controller:this.props.controller})))}shouldOpenSaveDialog(){return this.controller.product==="geometry"}shouldShowDropdown(){return this.controller.product!=="geometry"&&this.graphsController.wasCurrentGraphEverSaved()}openGraphActionsDropdown(e){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"}),e&&e.device==="keyboard"&&this.controller.getOpenMenu()!=="share"&&document.querySelectorAll(".dcg-graph-actions-container .dropdown-choice:not(.dropdown-choice-disabled)")[0].focus()}};var LG=__dcg_shared_module_exports__['h'](X());var AG=class extends LG.Class{template(){return LG.createElement("span",{onMount:this.bindFn(this.addSVGLogo)})}addSVGLogo(e){e.innerHTML=`
    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 909.3 188.4" xml:space="preserve">
    <title>${pn("frontpage-narration-shared-desmos-logo")}</title>
    <g>
      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8
        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7
        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6
        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>
      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8
        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5
        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1
        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1
        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>
      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2
        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7
        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1
        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6
        c8.2-9.3,20-14.6,32.4-14.4"/>
      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8
        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4
        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3
        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9
        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4
        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3
        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>
      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3
        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2
        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385
        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>
      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2
        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4
        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0
        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>
    </g>
    </svg>
    `}};var{If:Gg}=It.Components,OG=class extends It.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){let e=this.controller.isInMaintenanceMode(),t=this.controller.getPreviewParams();return It.createElement("div",{class:It.const("dcg-header")},It.createElement("div",{class:It.const("dcg-header-desktop")},It.createElement("div",{class:It.const("align-left-container")},It.createElement(GG,{controller:this.props.controller,tooltip:It.const(!0)}),It.createElement(MG,{controller:this.props.controller})),It.createElement("div",{class:It.const("align-center-container")},It.createElement("a",{href:It.const("/"),target:It.const("_blank"),class:It.const("dcg-home-link")},It.createElement(AG,null))),It.createElement(Gg,{predicate:()=>this.userController.didLogoutFail()},()=>It.createElement("div",{class:It.const("dcg-toast-container")},It.createElement("div",{class:It.const("dcg-toast")},()=>this.controller.s("account-shell-error-logging-out")))),It.createElement("div",{class:It.const("align-right-container")},It.createElement(VG,{controller:this.props.controller,disableAccounts:()=>t!=null||e}),It.createElement(Gg,{predicate:()=>this.controller.isArtContestEnabled()},()=>It.createElement(Ke,{tooltip:()=>pn("account-shell-label-math-art-contest"),gravity:this.const("s"),offset:()=>({top:12})},It.createElement("span",{role:It.const("button"),tabindex:It.const(0),"aria-haspopup":It.const("true"),"aria-label":()=>pn("account-shell-label-math-art-contest"),class:It.const("dcg-header-btn dcg-action-contest dcg-tooltip"),onTap:i=>this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:i.device})},It.const("\u{1F3C6}")))),It.createElement(Dy,{controller:this.props.controller,label:()=>pn("account-shell-label-share"),tooltip:()=>this.controller.s("account-shell-label-share-graph"),icon:It.const("dcg-icon-share"),name:()=>"share",onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"share"}),i&&i.device==="keyboard"&&this.controller.getOpenMenu()!=="share")return this.focusElement(".dcg-action-share")}}),It.createElement(Dy,{controller:this.props.controller,label:()=>pn("account-shell-label-help"),tooltip:()=>this.controller.s("account-shell-label-help"),icon:It.const("dcg-icon-question-sign"),name:It.const("help"),onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"help"}),i.device==="keyboard"){let o=this.controller.getOpenMenu()==="help"?'.dcg-feature[href="/calculator?tour=sliders"]':".dcg-action-help";return this.focusElement(o)}}}),It.createElement(Dy,{controller:this.props.controller,gravity:this.const("sw"),label:()=>pn("account-shell-label-language"),tooltip:()=>this.controller.s("account-shell-label-language"),icon:It.const("dcg-icon-world"),name:It.const("language"),onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"language"}),i.device==="keyboard"){let o=this.controller.getOpenMenu()==="language"?".dcg-language-option.dcg-selected":".dcg-action-language";return this.focusElement(o)}}}))),It.createElement(Gg,{predicate:()=>t!=null||e},()=>It.createElement("div",{class:It.const("dcg-toast-container")},It.createElement("span",{class:It.const("dcg-toast dcg-maintenance-toast")},It.createElement("span",{class:It.const("dcg-msg")},It.createElement(Gg,{predicate:()=>e},()=>It.createElement("span",null,()=>this.controller.s("account-shell-text-maintenance-mode"))),It.createElement(Gg,{predicate:()=>t!=null},()=>It.createElement("span",null,()=>t!=null?t.message:void 0))),It.createElement(Gg,{predicate:()=>e},()=>It.createElement("a",{class:It.const("undo"),target:It.const("_blank"),href:It.const("http://desmos.zendesk.com/entries/25429616-What-is-Maintenance-Mode-/")},()=>this.controller.s("account-shell-link-learn-more"))),It.createElement(Gg,{predicate:()=>t!=null},()=>It.createElement("a",{class:It.const("undo"),target:It.const("_blank"),href:()=>t!=null?t.url:void 0},()=>this.controller.s("account-shell-link-share-thoughts")))))))}focusElement(e){O(e).trigger("focus")}};var rh=__dcg_shared_module_exports__['h'](X());var Va=__dcg_shared_module_exports__['h'](X());ct();var{If:tee}=Va.Components,Za=class extends Va.Class{init(){this.controller=this.props.controller()}getTypeClass(){switch(this.props.type()){case"account":return"dcg-account-container";case"graph-actions":return"dcg-graph-actions-container";case"help":return"dcg-help-container";case"language":return"dcg-language-container";case"share":return"dcg-share-container"}}getProductClass(){switch(this.props.controller().getProduct()){case"geometry":return"dcg-product-geometry";case"geometry-calculator":return"dcg-product-geometry-calculator";case"graphing":return"dcg-product-graphing";case"graphing-3d":return"dcg-product-graphing-3d"}}template(){return Va.createElement("div",{class:()=>({"dcg-popover":!0,"dcg-bottom":!0,"dcg-constrained-height-popover":!0,[this.getTypeClass()]:!0,[this.getProductClass()]:!0}),style:()=>this.props.left?{display:"block",left:this.props.left(),right:"auto"}:{display:"block"},role:Va.const("region"),label:()=>this.props.label()},Va.createElement("div",{class:Va.const("dcg-popover-interior")},Va.createElement(tee,{predicate:()=>!!(typeof this.props.title=="function"&&this.props.title())},()=>Va.createElement("div",{class:Va.const("dcg-popover-title")},()=>this.props.title())),this.children),Va.createElement("div",{class:Va.const("dcg-arrow"),style:()=>this.props.arrowLeft?{left:this.props.arrowLeft(),right:"auto"}:{}}))}didMount(){let e=this.props.type();this.guid=`menu-${e}`,O(document.body).on(`dcg-tapstart.${this.guid}`,t=>{let i=t.target,n=!!i.closest(".dcg-popover"),o=!!i.closest(`[dcg-menu-button=${e}]`);!n&&!o&&this.controller.dispatch({type:"toggle-menu",payload:"none"})})}didUnmount(){O(document.body).off(`dcg-tapstart.${this.guid}`)}};var is=__dcg_shared_module_exports__['h'](X());var{For:ree,If:iee}=is.Components,PG=class extends is.Class{init(){this.i18n=this.props.i18n()}template(){return is.createElement("div",{class:()=>({"dcg-language-picker":!0,"dcg-two-columns":this.getLanguages().length>7})},is.createElement("div",{class:is.const("dcg-language-header"),role:is.const("heading"),"aria-level":is.const("2")},()=>this.i18n.s("shared-title-language-menu")),is.createElement(ree,{each:()=>this.getLanguages()},is.createElement("ul",{class:is.const("dcg-unstyled-list dcg-languages-list")},e=>is.createElement("li",{class:()=>({"dcg-listitem":!0,"dcg-language-option":!0,"dcg-selected":this.isLanguageSelected(e)}),lang:this.const(this.getLangCode(e)),role:is.const("menuitem"),tabindex:is.const("0"),"aria-current":()=>this.isLanguageSelected(e),onTap:()=>this.updateLang(e)},()=>this.i18n.raw(this.getLanguageDisplayName(e))))),is.createElement(iee,{predicate:()=>this.shouldShowFooterLink()},()=>is.createElement("a",{class:is.const("dcg-language-footer-link dcg-shared-blue-link"),href:()=>this.getFooterLinkURL()},()=>this.getFooterLinkText())))}shouldShowFooterLink(){return!!(this.props.footerLink&&this.props.footerLink())}getFooterLinkURL(){let e=this.props.footerLink&&this.props.footerLink();if(e)return e.url}getFooterLinkText(){let e=this.props.footerLink&&this.props.footerLink();return e?e.text:this.i18n.raw("")}getCurrentLang(){return this.props.currentLang()}getLanguages(){return Object.keys(this.props.getAllLangs())}getLanguageDisplayName(e){return this.props.getAllLangs()[e].display_name}updateLang(e){let t=this.props.getAllLangs()[e].code;return this.props.onLangChosen(t)}getLangCode(e){return this.props.getAllLangs()[e].code}isLanguageSelected(e){return this.getLangCode(e)===this.getCurrentLang()}};var nee=PP(),_G=class extends rh.Class{init(){this.controller=this.props.controller(),this.languageController=this.controller.languageController}template(){return rh.createElement(Za,{type:()=>"language",label:()=>this.controller.s("account-shell-narration-language-menu"),controller:this.props.controller},rh.createElement("div",{class:rh.const("dcg-popover-content")},rh.createElement(PG,{getAllLangs:()=>nee,currentLang:()=>this.languageController.getLanguage(),onLangChosen:e=>{this.languageController.fetchAndSetLanguage(e),this.controller.dispatch({type:"toggle-menu",payload:"none"})},i18n:this.props.controller})))}};var el=__dcg_shared_module_exports__['h'](X());var jc={};__dcg_shared_module_exports__['g'](jc,{ANIMATING_SLIDER:()=>S0,COMPLEX_EXP:()=>Sy,DEFINES:()=>BG,DEPENDS_ON:()=>nh,EVALUATION:()=>C0,EXP:()=>RG,EXP_NOT_RESTRICTED_LINE:()=>qG,FOCUSED_EXP:()=>pv,FOCUSED_OR_EMPTY_EXP:()=>zu,GRAPHABLE_EXP:()=>ih,HAS_DATA_COLUMN:()=>gv,HAS_DEPENDENT_Y:()=>D0,HAS_ERROR:()=>NG,HAS_FUNCTION_COLUMN:()=>k0,HAS_N_DEPENDENCIES:()=>KG,NONCONSTANT_LINE:()=>UG,PARABOLA:()=>Ey,REGRESSION:()=>$G,RESTRICTED:()=>hv,RESTRICTED_LINE:()=>HG,SHIFTED_PARABOLA:()=>v0,SLIDER:()=>zG,SLID_SLIDER:()=>E0,TABLE:()=>Ig,TABLEABLE_EXP:()=>x0});function FG(r,e){return __dcg_shared_module_exports__['ba'](1/__dcg_shared_module_exports__['Wc'](__dcg_shared_module_exports__['Vc'](r)),0,e)}function oee(r,e,t,i,n,o){return FG([[r,e,1],[t,i,1],[n,o,1]])}function see(r,e,t,i,n,o,s,a){return FG([[r*r+e*e,r,e,1],[t*t+i*i,t,i,1],[n*n+o*o,n,o,1],[s*s+a*a,s,a,1]])}function aee(r,e,t,i,n,o,s,a,l,c,u,p){return FG([[r*r,e*e,2*r*e,r,e,1],[t*t,i*i,2*t*i,t,i,1],[n*n,o*o,2*n*o,n,o,1],[s*s,a*a,2*s*a,s,a,1],[l*l,c*c,2*l*c,l,c,1],[u*u,p*p,2*u*p,u,p,1]])}function lee(r,e,t,i,n,o,s,a,l,c){return{a:__dcg_shared_module_exports__['Uc'].det([[e*e,2*r*e,r,e,1],[i*i,2*t*i,t,i,1],[o*o,2*n*o,n,o,1],[a*a,2*s*a,s,a,1],[c*c,2*l*c,l,c,1]]),b:__dcg_shared_module_exports__['Uc'].det([[r*r,e*e,r,e,1],[t*t,i*i,t,i,1],[n*n,o*o,n,o,1],[s*s,a*a,s,a,1],[l*l,c*c,l,c,1]]),c:-__dcg_shared_module_exports__['Uc'].det([[r*r,2*r*e,r,e,1],[t*t,2*t*i,t,i,1],[n*n,2*n*o,n,o,1],[s*s,2*s*a,s,a,1],[l*l,2*l*c,l,c,1]])}}function cee(r,e,t,i,n,o,s,a,l,c,u,p){if(oee(r,e,n,o,u,p))return"line";if(see(r,e,t,i,l,c,u,p))return"circle";if(!aee(r,e,t,i,n,o,s,a,l,c,u,p))return"none";var g=lee(r,e,t,i,n,o,s,a,l,c);return FG([[g.a,g.b],[g.b,g.c]],20)?"parabola":g.b*g.b>g.a*g.c?"hyperbola":"ellipse"}function rH(r){var e,t;if(r.length===1&&r[0].length===4)return"line";for(var i=0;i<r.length;i++){var n=r[i],o=n.length;if(o<12)return"unknown";if(t=cee(n[0],n[1],n[2*Math.floor(1*o/12)],n[2*Math.floor(1*o/12)+1],n[2*Math.floor(2*o/12)],n[2*Math.floor(2*o/12)+1],n[2*Math.floor(3*o/12)],n[2*Math.floor(3*o/12)+1],n[2*Math.floor(4*o/12)],n[2*Math.floor(4*o/12)+1],n[o-2],n[o-1]),t==="none"||e&&t!==e)return"none";e=t}return e}function pv(r){return ba(r)&&r.type==="expression"}function zu(r,e){return ba(r)&&r.type==="expression"?!0:r.type==="expression"&&Na(r)}function w0(r){return rH(r)}function Sy(r,e){return r.type==="expression"&&Nl(r)&&e&&e.branches[0]&&w0(e.branches[0].segments)!=="line"}function x0(r,e){return r.type==="expression"&&Nl(r)&&!!r.formula.is_tableable}function RG(r,e){return r.type==="expression"}function ih(r,e){return r.type==="expression"&&Nl(r)}function NG(r,e){return r.type==="expression"&&!!r.error&&!Na(r)}function nh(r){return function(e,t){if(e.type!=="expression"||!e.latex)return!1;var i=__dcg_shared_module_exports__['gc'](e.latex);return i.getDependencies().indexOf(r)>=0}}function BG(r){return function(e,t){if(e.type!=="expression"||!e.latex)return!1;var i=__dcg_shared_module_exports__['gc'](e.latex);return i.getExports(__dcg_shared_module_exports__['Ob']).indexOf(r)>=0}}function KG(r){return function(e,t){return e.type==="expression"&&e.formula&&e.formula.variables&&e.formula.variables.length>=r}}function iH(r){if(r.type!=="expression"||!r.formula||!r.formula.constant_value)return!1;let e=r.formula.constant_value;return typeof e=="number"&&isFinite(e)}function UG(r,e){return e&&w0(e.branches[0].segments)==="line"&&!iH(r)}function HG(r,e){return UG(r,e)&&hv(r,e)}function qG(r,e){return RG(r,e)&&!HG(r,e)}function Ey(r,e){return e&&e.branches&&e.branches.some(function(t){return w0(t.segments)==="parabola"})}function hv(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{(.+)\\right\\}/)}function v0(r,e){if(!Ey(r,e))return!1;var t=e.branches[0].compiled.fn;return t(0)!==0||t(1)!==1}function C0(r,e){return r.type==="expression"&&!!r.formula&&!!r.formula.is_evaluable&&iH(r)}function D0(r,e){return r.type==="expression"&&r.formula.assignment==="y"}function zG(r,e){return r.type==="expression"&&!!r.sliderExists&&!Nl(r)}function S0(r,e){return r.type==="expression"&&!!r.sliderExists&&r.slider.isPlaying}function E0(r,e){return r.type==="expression"&&!!r.sliderExists&&!Nl(r)&&ma(r)!==1}function Ig(r,e){return r.type==="table"}function $G(r,e){return r.type==="expression"&&!!r.formula&&!!r.formula.regression}function gv(r,e){if(r.type!=="table")return!1;for(var t=1;t<r.columnModels.length;t++)if(r.columnModels[t].discrete)return!0;return!1}function k0(r,e){if(r.type!=="table")return!1;for(var t=1;t<r.columnModels.length;t++)if(r.columnModels[t].discrete===!1)return!0;return!1}var WG=class{constructor(e,t){this.color="#000000",this.showHighlight=!1,this.selected=!1,this.id=e,this.branches=t!==void 0?t:[]}updateFrom(e){e&&(this.showHighlight=e.showHighlight,this.selected=e.selected)}};var Ps=class{constructor(e){this.Calc=e,this.controller=this.Calc.controller}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),sel:document.querySelector(".dcg-show-expressions-tab"),delayBeforeEnter:400,delayBeforeExit:400}}resourcesOpen(){var e;return(e=document.querySelector("body"))==null?void 0:e.classList.contains("resources-open")}requireResourcesNotOpen(){return{position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),sel:document.querySelector(".dcg-action-opendrawer"),delayBeforeEnter:400,delayBeforeExit:400}}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),sel:document.querySelector(".dcg-action-toggle-edit")}}expressionCount(){return this.controller.getItemCount()}getExpSketch(e){var t=this.Calc.grapher.graphSketches[e.id];if(t instanceof WG)throw new Error("Unimplemented: tours cannot work with 3d sketches");return t}getAvailableExp(e){var t=this.getMatchingExpSelector(zu,e);return t||document.querySelector(".dcg-new-math-div")}expList(){return this.Calc.rootElt.querySelector(".dcg-exppanel")}getSelectorById(e){if(e)return this.controller.getItemSelectorById(e)}getModelById(e){if(e)return this.controller.getItemModel(e)}expMatches(e,t){if(!e)return!1;if(typeof t=="function")return t.call(jc,e,this.getExpSketch(e));for(var i=0;i<t.length;i++)if(!t[i].call(jc,e,this.getExpSketch(e)))return!1;return!0}getMatchingExpId(e,t){var i={},n,o,s=this.controller.getAllItemModels();for(n=0;n<s.length;n++)o=s[n],pS(o)==="render"&&(i[o.id]=!0);for(var a in t)delete i[a];var l=this.controller.getSelectedItem();if(l&&i[l.id]&&this.expMatches(l,e))return l.id;for(n=0;n<s.length;n++)if(o=s[n],i[o.id]&&this.expMatches(o,e))return o.id}getMatchingExpSelector(e,t){var i=this.getMatchingExpId(e,t);return i?this.getSelectorById(i):void 0}getMatchingExpModel(e,t){var i=this.getMatchingExpId(e,t);return i?this.getModelById(i):void 0}};var jG=class extends Ps{shouldPopup(){return!!this.getMatchingExpSelector(zG)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpSelector(ih),t=this.getMatchingExpSelector(zG),i=this.getMatchingExpSelector(S0),n=this.getMatchingExpSelector(E0);if(e&&i)return{type:"final",position:"s",endingMsg:this.controller.s("graphing-tours-label-sliders-pro"),sel:i.querySelector(".dcg-circular-icon")};if(e&&n)return n.querySelector(".dcg-depressed")?{type:"do-not-update"}:{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-sliders-hands-free")+"</b><br>"+this.controller.s("graphing-tours-label-sliders-press-play"),sel:n.querySelector(".dcg-circular-icon")};if(e&&t){var o=t.querySelector(".dcg-thumb .dcg-graphic");return o?{position:"s",content:this.controller.s("graphing-tours-label-sliders-drag-handle"),sel:o}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-change-value"),sel:t}}var s;return this.expressionCount()>1?s=this.getMatchingExpSelector(KG(1)):s=this.getMatchingExpSelector(KG(2)),s?{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b> "+this.controller.s("graphing-tours-label-sliders-add"),sel:s.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue")}:(s=this.getMatchingExpSelector(zu),s?{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-sliders-make-sliders")+"</b><br>"+this.controller.s("graphing-tours-label-sliders-try-typing",{sample_expression:'<span class="trip-math">y=mx+b</span>'}),sel:s,delayBeforeExit:600}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-blank-expression"),sel:document.querySelector(".dcg-action-newmath")})}};var JG=class extends Ps{shouldPopup(){return!!this.getMatchingExpSelector(Ig)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpId(gv),t=this.getSelectorById(e),i=this.getModelById(e),n=i;if(!t||!n||n.type!=="table"){let C=document.querySelector(".dcg-action-newtable");return C?{position:"e",content:this.controller.s("graphing-tours-label-tables-select-table"),sel:C,delayBeforeExit:300}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-tables-start")+"</b><br>"+this.controller.s("graphing-tours-label-new-item"),sel:document.querySelector(".dcg-add-expression-btn")}}for(var o=Jo(n),s=wa(n),a=0,l=0;l<s&&l<3;l++){let C=t.querySelector(".dcg-row:nth-of-type("+(l+2)+") .dcg-cell:nth-of-type(1)"),D=t.querySelector(".dcg-row:nth-of-type("+(l+2)+") .dcg-cell:nth-of-type(2)");C&&D&&C.matches(":not(.dcg-empty):not(.dcg-error)")&&D.matches(":not(.dcg-empty):not(.dcg-error)")&&a++}if(a===3){var c=n.columnModels[1].points&&n.columnModels[1].lines,u=!!document.querySelector(".dcg-table-column-menu");return c&&!u?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-tables-whiz"),sel:t}:c?{position:"e",content:this.controller.s("graphing-tours-label-tables-close-options"),sel:t}:u?{content:this.controller.s("graphing-tours-label-tables-dots"),position:"e",sel:document.querySelectorAll(".dcg-toggle-switch")[1]}:{content:["<b>"+this.controller.s("graphing-tours-label-tables-last-trick")+"</b><br>",this.controller.s("graphing-tours-label-tables-open-options")].join(""),position:"e",sel:t.querySelector(".dcg-row:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}var p,g,h;for(p=0;p<s;p++)for(g=0;g<2;g++)if(h=t.querySelector(".dcg-row:nth-of-type("+(p+2)+") .dcg-cell:nth-of-type("+(g+1)+")"),h&&h.matches(".dcg-error"))return{position:"e",content:this.controller.s("graphing-tours-label-tables-valid-number"),sel:h};if(!o)return{position:"e",content:this.controller.s("graphing-tours-label-tables-back"),sel:t.querySelector(".dcg-row:nth-of-type("+p+") .dcg-cell:nth-of-type(2)")};if(s===2&&a===1&&o&&o.row===1)return{position:"e",content:this.controller.s("graphing-tours-label-tables-next-row"),sel:t.querySelector(".dcg-row:nth-of-type("+(o.row+1)+") .dcg-cell:nth-of-type(2)")};if(s===3&&a===2&&o&&o.row!==3)return{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b><br>"+this.controller.s("graphing-tours-label-tables-enter"),sel:t.querySelector(".dcg-row:nth-of-type("+(o.row+1)+") .dcg-cell:nth-of-type(2)")};for(p=0;p<s;p++)for(g=0;g<2;g++)if(h=t.querySelector(".dcg-row:nth-of-type("+(p+2)+") .dcg-cell:nth-of-type("+(g+1)+")"),h&&h.matches(".dcg-empty")){var b=this.controller.s("graphing-tours-label-tables-fill-row");return p===2&&g===1&&(b=this.controller.s("graphing-tours-label-tables-fill-another")),p===0&&g===1&&(b="<b>"+this.controller.s("graphing-tours-label-tables-fill-cell")+"</b><br>"+this.controller.s("graphing-tours-label-tables-type-number")),{position:"e",content:b,sel:t.querySelector(".dcg-row:nth-of-type("+(p+2)+") .dcg-cell:nth-of-type(2)")}}return{type:"do-not-update"}}};var YG=class extends Ps{shouldPopup(){return!!this.getMatchingExpSelector(Ig)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();var e=this.getMatchingExpId(k0),t=this.getSelectorById(e),i=this.getModelById(e),n=this.getMatchingExpSelector(zu),o=this.getMatchingExpSelector([Sy,x0]);if(t&&i&&i.type==="table"){var s=i,a=s.columnModels[1].points,l=!!document.querySelector(".dcg-table-column-menu"),c=s.columnModels.length>3&&s.columnModels[2].discrete===!1,u=Jo(s);return c?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-advanced-tables-wizard"),sel:t}:u&&u.row===0&&u.column===2?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-type-function",{sample_expression:'<span class="trip-math">cos\\left(x\\right)</span>'}),sel:t.querySelector("tr:nth-of-type(1) .dcg-cell:nth-of-type(3)")}:u&&(u.row!==0||u.column!==2)?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-new-column"),sel:t.querySelector("tr:nth-of-type(1) .dcg-cell:nth-of-type(3)")}:a&&!u?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-continue"),sel:t.querySelector("tr:nth-of-type(1) .dcg-cell:nth-of-type(2)")}:l?{content:this.controller.s("graphing-tours-label-advanced-tables-dots"),position:"e",sel:document.querySelector(".dcg-table-points")}:{content:this.controller.s("graphing-tours-label-advanced-tables-options"),position:"e",sel:t.querySelector("tr:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}return o?this.editListMode()?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-create"),sel:document.querySelector(".dcg-action-createtable"),delayBeforeExit:400}:{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-advanced-tables-convert")+"</b><br>"+this.controller.s("graphing-tours-label-advanced-tables-edit-list"),sel:document.querySelector(".dcg-action-toggle-edit")}:n?{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-advanced-tables-graph")+"</b><br>",this.controller.s("graphing-tours-label-advanced-tables-type-function",{sample_expression:'<span class="trip-math">y=sin\\left(x\\right)</span>'})].join(""),sel:n}:{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-start"),sel:document.querySelector(".dcg-new-math-div")}}};var XG=class extends Ps{shouldPopup(){return!!this.getMatchingExpSelector(hv)}restrictedLineTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();var t=this.getMatchingExpSelector(HG),i=this.getMatchingExpSelector(qG);if(t)return i?(this.completedPhase1=!0,this.update()):{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-brilliant")+"</b><br>"+this.controller.s("graphing-tours-label-restrictions-new-expression"),sel:document.querySelector(".dcg-new-math-div")};var n=this.getMatchingExpId(zu),o=this.getSelectorById(n),s=this.getModelById(n);if(o&&s){var a=this.expMatches(s,UG),l=this.expMatches(s,NG);return l?{type:"do-not-update"}:a?{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-awesome")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-domain",{sample_expression:'<span class="trip-math">\\left\\{x<0\\right\\}</span>'}),"<br><i>"+this.controller.s("graphing-tours-label-restrictions-abc",{buttons:"{ }"})+"</i>"].join(""),sel:o}:{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-restrictions-start")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-straight-line",{sample_expression:'<span class="trip-math">y=2x</span>'})].join(""),sel:o}}return{position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),sel:document.querySelector(".dcg-new-math-div")}}restrictedParabolaTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();var t=this.getMatchingExpSelector([hv,Ey]);if(t)return{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-restrictions-star"),sel:document.querySelector(".dcg-exppanel-container")};var i=this.getMatchingExpId([qG,pv]),n=this.getSelectorById(i),o=this.getModelById(i);if(n&&o){var s=this.expMatches(o,[Ey,D0]),a=this.expMatches(o,v0),l=this.expMatches(o,Ey),c=this.expMatches(o,NG);return c?{type:"do-not-update"}:l?s?a?{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-nice")+"</b><br>"+this.controller.s("graphing-tours-label-restrictions-range",{sample_expression:'<span class="trip-math">\\left\\{y<4\\right\\}</span>'})].join(""),sel:n}:{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-restrictions-move-parabola")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-change-equation",{sample_expression:'<span class="trip-math">y=x^2-2</span>'})].join(""),sel:n}:{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-restrictions-dont-forget")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-type-all",{sample_expression:'<span class="trip-math">y=x^2</span>'})].join(""),sel:n}:{position:"e",content:[this.controller.s("graphing-tours-label-restrictions-graph-parabola",{sample_expression:'<span class="trip-math">y=x^2</span>'})+"<br><i>"+this.controller.s("graphing-tours-label-restrictions-typing-hint",{suggestion1:"y=x^2",suggestion2:'<span class="trip-math">a^2</span>'})+"</i>"].join(""),sel:n}}return{position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),sel:document.querySelector(".dcg-new-math-div")}}update(){return this.completedPhase1?this.restrictedParabolaTour():this.restrictedLineTour()}};var QG=class extends Ps{constructor(){super(...arguments);this.hasCreatedLinearRegression=!1;this.hasInitiallyRenderedSampleDataLink=!1}shouldPopup(){return!!this.getMatchingExpSelector(Ig)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var t=this.getMatchingExpId($G)||this.getMatchingExpId(RG),i=this.getSelectorById(t),n=this.getModelById(t),o=this.getMatchingExpId(gv),s=this.getSelectorById(o),a=this.getModelById(o);if(!s||!a||a.type!=="table"||!a.columnModels[1]){var l=document.querySelector(".dcg-action-newtable"),c=!dl&&!_l;return!l&&c?this.hasInitiallyRenderedSampleDataLink?{type:"do-not-update"}:(this.hasInitiallyRenderedSampleDataLink=!0,{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-regressions-data")+"</div>"+this.controller.s("graphing-tours-label-regressions-docs",{sample_data_link:'<a class="trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">'+this.controller.s("graphing-tours-label-regressions-sample-data")+"</a>"})+' <div class="trip-hint"><br>'+this.controller.s("graphing-tours-label-regressions-own-data",{plus_icon:'<i class="dcg-icon-plus" aria-hidden="true"></i>'})+"</div>",sel:i||document.querySelector(".dcg-exppanel")}):l?{position:"e",content:this.controller.s("graphing-tours-label-regressions-new-table"),sel:l,delayBeforeExit:250}:{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-regressions-data-2")+"</div>"+this.controller.s("graphing-tours-label-new-item"),sel:document.querySelector(".dcg-add-expression-btn"),delayBeforeExit:150}}var u=s.querySelectorAll(".dcg-row .dcg-cell:nth-of-type(2):not(.dcg-table-header):not(.dcg-empty)");if(u.length<5)return{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-regressions-fill-sample-data")+"</div><table class='dcg-regression-tour-table'><tr><td><span class='trip-math'>x_1</span></td><td><span class='trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>",sel:s.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")};var p=this.getMatchingExpModel($G)||this.getMatchingExpModel(pv)||this.controller.getItemModelByIndex(0);if(!p||p.type!=="expression"){var g=document.querySelector(".dcg-action-newexpression");return g?{position:"e",content:this.controller.s("graphing-tours-label-regressions-expression-option"),sel:g,delayBeforeExit:150}:{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-awesome")+"</div>"+this.controller.s("graphing-tours-label-new-item"),sel:document.querySelector(".dcg-add-expression-btn"),delayBeforeExit:150}}var h=n&&n.type==="expression"&&n.formula,b=h?h.regression:void 0,C=b?b.statistics:void 0,D=b?b.parameters:void 0;if(C&&C.r&&(this.hasCreatedLinearRegression=!0),!this.hasCreatedLinearRegression&&i)return{position:"e",content:this.controller.s("graphing-tours-label-regressions-equation",{equation:"<span class='trip-math'>y_1\\sim mx_1+b</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-1",{y_1:"<span class='trip-math'>y_1</span>",y1:"<span class='trip-math'>y1</span>"})+"</div><div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-2",{twiddle:"<span class='trip-math'>~</span>"})+"</div>",sel:i,delayBeforeExit:150};var S=document.querySelector(".dcg-residual-suggestion");return S?{position:"e",content:"<div class='trip-title'>"+this.controller.s("graphing-tours-label-regressions-check-model")+"</div>"+this.controller.s("graphing-tours-label-regressions-residuals"),sel:S,delayBeforeExit:250}:C&&(C.Rsquared>=.99||C.r>=.99||D&&D.a&&D.k&&D.h)?{type:"final",position:"e",endingMsg:"<div class='trip-title'>"+this.controller.s("graphing-tours-label-regressions-keep-exploring")+"</div>",sel:document.querySelector(".dcg-exppanel")}:i?{position:"e",content:"<div class='trip-title'>"+this.controller.s("graphing-tours-label-regressions-new-model")+"</div>"+this.controller.s("graphing-tours-label-regressions-better-fit",{equation:"<span class='trip-math'>y_1~a(x_1-h)^2+b</span>"}),sel:i,delayBeforeExit:300}:{type:"do-not-update"}}};var uee=new __dcg_shared_module_exports__['nc']({enableGeometry:!1,enable3d:!0,beta3d:!0,scales:void 0});function ZG(r){return function(e,t){if(e.type!=="expression"||!e.latex)return!1;var i=__dcg_shared_module_exports__['gc'](e.latex);if(!i._expression||i._expression.type!=="List"&&i._expression.type!=="Range"||r.dependent&&r.dependent!==po(e))return!1;var n=i.getConcreteTree(uee,{});return!(r.minLength&&(n.length===void 0||n.length<r.minLength))}}var nH=ZG({}),oH=ZG({dependent:"a",minLength:3}),sH=ZG({dependent:"b",minLength:5}),aH=ZG({dependent:"c",minLength:10});function lH(r,e){return ih(r,e)&&nh("a")(r,e)}function cH(r,e){return ih(r,e)&&nh("b")(r,e)}function dH(r,e){return nh("c")(r,e)&&C0(r,e)}var eI=class extends Ps{shouldPopup(){return!!this.getMatchingExpSelector(nH)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpId(oH),t=this.getMatchingExpId(sH),i=this.getMatchingExpId(aH),n=this.getMatchingExpId(lH),o=this.getMatchingExpId(cH),s=this.getMatchingExpSelector(dH);return e?n?t?i?o?s?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-great-job"),sel:s.querySelector(".dcg-evaluation"),scrollContainer:this.expList()}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-last-thing")+"</b> "+this.controller.s("graphing-tours-label-list-computation",{equation:"<span class='trip-math'>total\\left(c\\right)</span>"})+"<div class='trip-hint'>",sel:this.getAvailableExp([e,t,n,i,o]),scrollContainer:this.expList(),delayBeforeExit:600}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-lists-graph-points")+"</b> "+this.controller.s("graphing-tours-label-lists-point-equation",{equation:"<span class='trip-math'>\\left(b, sin\\left(b\\right)\\right)</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-lists-hint-plot-points")+"</div>",sel:this.getAvailableExp([e,t,n,i]),scrollContainer:this.expList()}:{position:"e",content:this.controller.s("graphing-tours-label-lists-count-by",{equation:"<span class='trip-math'>c=\\left[10, 15, ..., 95\\right]</span>"}),sel:this.getAvailableExp([e,t,n]),scrollContainer:this.expList(),delayBeforeExit:600}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b> "+this.controller.s("graphing-tours-label-lists-create-range",{equation:"<span class='trip-math'>b=\\left[0...8\\right]</span>"}),sel:this.getAvailableExp([e,n]),scrollContainer:this.expList(),delayBeforeExit:600}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-lists-put-to-work")+"</b> "+this.controller.s("graphing-tours-label-lists-graph-equation",{equation:"<span class='trip-math'>y=x^2+a</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-lists-hint-superscript",{suggestion1:"y=x^2+a",suggestion2:"a<sup>2</sup>"})+"</div>",sel:this.getAvailableExp([e]),scrollContainer:this.expList()}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-lists-are-powerful")+"</b><br>"+this.controller.s("graphing-tours-label-lists-begin-equation",{equation:"<span class='trip-math'>a=\\left[1,2,3\\right]</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-lists-hint-abc"),sel:this.getAvailableExp(),scrollContainer:this.expList(),delayBeforeExit:600}}};var uH=function(r,e){return r.type=="folder"},hee=function(r,e){return r.type==="expression"&&Nl(r)&&!r.folderId},tI=class extends Ps{shouldPopup(){return!!this.getMatchingExpSelector(uH)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var t=this.getMatchingExpId(uH),i=this.getSelectorById(t),n=this.getModelById(t),o=this.getMatchingExpSelector(hee);if(!n||n.type!=="folder"||!i){var s=document.querySelector(".dcg-action-newfolder");return s?{position:"e",content:this.controller.s("graphing-tours-label-folders-option"),sel:s}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-folders-start")+"</b><br>"+this.controller.s("graphing-tours-label-new-item"),sel:document.querySelector(".dcg-add-expression-btn")}}return this.cachedTitle!==n.title&&(this.cachedTitle=n.title,this.lastChange=new Date().getSeconds()),!this.cachedTitle||new Date().getSeconds()-this.lastChange<1e3?{position:"e",content:this.controller.s("graphing-tours-label-folders-name"),sel:i}:n.controller.getNumberOfItemsInFolder(n.id)===0?o?{position:"e",content:this.controller.s("graphing-tours-label-folders-grab")+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-folders-indicator")+"</div>",scrollContainer:this.expList(),sel:o}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b> "+this.controller.s("graphing-tours-label-folders-new-equation",{equation:"<span class='trip-math'>x+y=3</span>"}),scrollContainer:this.expList(),sel:this.getAvailableExp(),delayBeforeExit:500}:n.collapsed?n.hidden?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-great-job"),sel:document.querySelector(".dcg-exppanel-container"),scrollContainer:this.expList()}:{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-folders-did-you-know")+"</b>"+this.controller.s("graphing-tours-label-folders-hide"),scrollContainer:this.expList(),sel:i.querySelector(".dcg-circular-icon")}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-folders-great-start")+"</b> "+this.controller.s("graphing-tours-label-folders-collapse"),scrollContainer:this.expList(),sel:i.querySelector(".dcg-caret-container")}}};var pH=function(r,e){return r.type==="expression"&&r.latex.indexOf("\\frac{d}{dx}")>=0};function hH(r,e){return!(!BG("f")(r,e)||!Sy(r,e))}function gH(r,e){return!BG("g")(r,e)||!nh("f")(r,e)||!ih(r,e)?!1:pH(r,e)}function mH(r,e){return!Sy(r,e)||nh("f")(r,e)?!1:pH(r,e)}var rI=class extends Ps{shouldPopup(){return!1}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpId(hH),t=this.getMatchingExpId(gH),i=this.getMatchingExpSelector(mH);return e?t?i?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-great-job"),sel:i,scrollContainer:this.expList()}:{position:"e",content:this.controller.s("graphing-tours-label-derivative-one-more",{equation:"<span class='trip-math'>\\frac{d}{dx}\\ln \\left(x\\right)</span>"}),sel:this.getAvailableExp([e,t]),scrollContainer:this.expList()}:{position:"e",content:this.controller.s("graphing-tours-label-derivative-graph-derivative",{equation:"<span class='trip-math'>g\\left(x\\right)=\\frac{d}{dx}f\\left(x\\right)</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-derivative-hint-type-derivative")+"</div>",sel:this.getAvailableExp([e]),scrollContainer:this.expList()}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-derivative-start-graph")+"</b><br>"+this.controller.s("graphing-tours-label-derivative-start-function",{equation:"<span class='trip-math'>f\\left(x\\right)=x\\sin \\left(x\\right)</span>"}),sel:this.getAvailableExp(),scrollContainer:this.expList()}}};var $u={sliders:{tour:jG,titleKey:"graphing-tours-heading-sliders"},tables:{tour:JG,titleKey:"graphing-tours-heading-tables"},restrictions:{tour:XG,titleKey:"graphing-tours-heading-restrictions"},functiontable:{tour:YG,hideInHelp:!0,titleKey:"graphing-tours-heading-advanced-tables"},regressions:{tour:QG,titleKey:"graphing-tours-heading-regressions"},lists:{tour:eI,titleKey:"graphing-tours-heading-lists",hideInHelp:!0},folders:{tour:tI,titleKey:"graphing-tours-heading-folders",hideInHelp:!0},derivatives:{tour:rI,titleKey:"graphing-tours-heading-derivatives",hideInHelp:!0}};var Ys=__dcg_shared_module_exports__['h'](X());var{For:mee,If:fee}=Ys.Components,G0=class extends Ys.Class{init(){this.controller=this.props.controller(),this.tourController=this.controller.tourController}template(){return Ys.createElement("a",{class:Ys.const("dcg-feature"),href:()=>`/calculator?tour=${this.props.name()}`,target:Ys.const("_blank"),ignoreRealClick:()=>!this.tourController.shouldPopupTour(this.props.name()),onTap:e=>{if(!this.tourController.shouldPopupTour(this.props.name()))return e.originalEvent.preventDefault(),this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.tourController.startTour(this.props.name(),"help")}},Ys.createElement("span",{class:()=>({"dcg-thumb":!0,[this.getTourClassName()]:!0})}),()=>this.controller.s(this.props.titleKey()))}getTourClassName(){switch(this.props.name()){case"regressions":return"dcg-regressions-thumb";case"restrictions":return"dcg-restrictions-thumb";case"sliders":return"dcg-sliders-thumb";case"tables":return"dcg-tables-thumb";default:return"dcg-unknown-thumb"}}},iI=class extends Ys.Class{init(){this.controller=this.props.controller()}template(){return Ys.createElement(mee,{each:()=>__dcg_shared_module_exports__['D']($u)},Ys.createElement("div",{class:Ys.const("dcg-popover-content dcg-tours-content"),role:Ys.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-tours")},e=>Ys.createElement(fee,{predicate:()=>!$u[e].hideInHelp},()=>Ys.createElement(G0,{name:()=>e,titleKey:()=>$u[e]?$u[e].titleKey:"",controller:this.props.controller}))))}};var hi=__dcg_shared_module_exports__['h'](X());var Wu=class extends hi.Class{template(){return hi.createElement("a",{href:()=>this.props.href(),target:hi.const("_blank"),class:hi.const("dcg-resource-link")},hi.createElement("i",{class:()=>this.props.icon(),"aria-hidden":hi.const("true")}),hi.createElement("span",null,()=>this.props.title(),hi.const(" ")))}},nI=class extends hi.Class{init(){this.controller=this.props.controller()}template(){return hi.createElement("div",{class:hi.const("dcg-popover-content dcg-resources-content"),role:hi.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources")},hi.createElement(Wu,{href:hi.const("https://help.desmos.com/hc/en-us/articles/4406040715149-Getting-Started-Desmos-Graphing-Calculator"),icon:hi.const("dcg-icon-rocket"),title:()=>this.controller.s("account-shell-link-getting-started")}),hi.createElement(Wu,{href:hi.const("https://www.youtube.com/playlist?list=PLfM6zMGnbgOGLZc-_Yj3QVK3Vz_L4Cw59"),icon:hi.const("dcg-icon-film"),title:()=>this.controller.s("account-shell-link-video-tutorials")}),hi.createElement(Wu,{href:()=>{let e=this.controller.languageController.getLanguage();return ml[e]?ml[e].userGuideURL:ml.en.userGuideURL},icon:hi.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-user-guide")}),hi.createElement(Wu,{href:hi.const("https://help.desmos.com/"),icon:hi.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),hi.createElement("div",{class:hi.const("dcg-resource-link dcg-action-show-hotkeys"),role:hi.const("link"),tabindex:hi.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},hi.createElement("i",{class:hi.const("dcg-icon-keyboard"),"aria-hidden":hi.const("true")}),hi.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts"))))}};var ki=__dcg_shared_module_exports__['h'](X());var fH=["i18nKey","title","thumbURL","stateURL","hash","parentHash","recovery","recoveryParentHash","graphData","access","created","example","draft","easterEgg"],Oo=class extends Wr{constructor(t){super();t&&fH.forEach(i=>{t.hasOwnProperty(i)&&this.setProperty(i,t[i])}),this.access&&this.setProperty("access","all"),this.example||this.setProperty("example",!1),this.draft||this.setProperty("draft",!1),this.now=new Date}copy(){return new Oo(this)}getCollectionKey(){var t="";return this.example?t="example-":this.draft&&(t="draft-"),t+this.hash}displayDate(){var t=Date.now(),i=(t-this.created.getTime())/1e3,n=i/60,o=n/60,s=o/24,a=s/7,l=[__dcg_shared_module_exports__['Oa']("account-shell-label-month-jan"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-feb"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-mar"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-apr"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-may"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-jun"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-jul"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-aug"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-sep"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-oct"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-nov"),__dcg_shared_module_exports__['Oa']("account-shell-label-month-dec")];return a>=5?__dcg_shared_module_exports__['Oa']("account-shell-label-created-on-date",{month:l[this.created.getMonth()],day:this.created.getDate(),year:this.created.getFullYear()}):a>=2?__dcg_shared_module_exports__['Oa']("account-shell-label-created-weeks-ago",{number:String(Math.floor(a))}):s>=7?__dcg_shared_module_exports__['Oa']("account-shell-label-created-last-week"):s>=2?__dcg_shared_module_exports__['Oa']("account-shell-label-created-days-ago",{number:String(Math.floor(s))}):o>=24?__dcg_shared_module_exports__['Oa']("account-shell-label-created-yesterday"):o>=2?__dcg_shared_module_exports__['Oa']("account-shell-label-created-hours-ago",{number:String(Math.floor(o))}):n>=60?__dcg_shared_module_exports__['Oa']("account-shell-label-created-one-hour-ago"):n>=2?__dcg_shared_module_exports__['Oa']("account-shell-label-created-minutes-ago",{number:String(Math.floor(n))}):n>=1?__dcg_shared_module_exports__['Oa']("account-shell-label-created-one-minute-ago"):__dcg_shared_module_exports__['Oa']("account-shell-label-created-seconds-ago")}plainObject(){var t={};return fH.forEach(i=>{t[i]=this[i]}),t}getURL(){var t;if(window.location.protocol==="file:"){var i="/calculator";if(!th())return i;t=th()+i}else{var n="/"+document.location.pathname.split("/")[1];t=window.location.href.split(n)[0]+n}return t+(this.hash&&!this.recovery?"/"+this.hash:"")}static fromAjax(t){return new Oo({i18nKey:t.i18nKey,title:t.title,thumbURL:t.thumbUrl,stateURL:t.stateUrl,graphData:t.state,hash:t.hash,parentHash:t.parent_hash,recoveryParentHash:t.recovery_parent_hash,access:t.access,created:new Date(t.created),example:!!t.example,draft:!!t.draft,easterEgg:t.easterEgg})}static toAjax(t){return{title:t.title,thumbUrl:t.thumbURL,stateUrl:t.stateURL,state:t.graphData,hash:t.hash,parent_hash:t.parentHash,recovery_parent_hash:t.recoveryParentHash,access:t.access,created:t.created.toString()}}static updateFromSync(t,i){t.setProperty("title",i.title),t.setProperty("hash",i.hash),t.setProperty("parentHash",i.parent_hash),t.setProperty("recoveryParentHash",i.recovery_parent_hash),t.setProperty("graphData",t.graphData),t.setProperty("thumbURL",i.thumbUrl),t.setProperty("stateURL",i.stateUrl),t.setProperty("created",new Date(i.created))}};function oI(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");let t={parent_hash:r.parentHash,recovery_parent_hash:r.recoveryParentHash,thumb_data:r.thumbURL,graph_hash:r.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,recovery:e.recovery,title:r.title||void 0,calc_state:r.graphData,lang:e.lang,product:e.product};return yo("/api/v1/calculator/save",t).then(i=>(Oo.updateFromSync(r,i),r))}function yH(r){return yo("/api/v1/calculator/email_feedback",r)}function bH(r){return tc("/api/v1/calculator/my_graphs",r)}function wH(r){return tc("/api/v1/calculator/recovery_graphs",r)}function xH(r){return yo("/api/v1/calculator/my_graphs/remove",r)}function vH(){return yo("/api/v1/calculator/recovery_graphs/clear")}var Kt=__dcg_shared_module_exports__['h'](X());ct();function I0(r){var t;let e=(t=r==null?void 0:r.responseJSON)==null?void 0:t.errors;return Array.isArray(e)?e:[{message:"Unexpected server error. Try again, or e-mail calculator@desmos.com."}]}function sI(r){return I0(r).map(e=>e.message)}var{If:mv,For:yee,Input:bee,Textarea:wee}=Kt.Components,aI=class extends Kt.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.formErrors=[],this.feedbackInProgress=!1,this.feedbackFromName=this.userController.getEmail(),this.didSendFeedbackEmail=!1}template(){return Kt.createElement("div",{class:Kt.const("dcg-suggestions")},Kt.createElement("div",{class:Kt.const("template-errors")},Kt.createElement(mv,{predicate:()=>!!this.formErrors.length},()=>Kt.createElement(yee,{each:()=>this.formErrors},Kt.createElement("span",null,e=>Kt.createElement("div",{class:Kt.const("errors")},Kt.createElement("span",null,()=>e)))))),Kt.createElement("form",{didMount:this.bindFn(this.didMountContactForm),class:Kt.const("dcg-action-submit")},Kt.createElement("div",{class:Kt.const("dcg-feedback-message-label")},()=>this.controller.s("account-shell-label-feedback-message")),Kt.createElement(wee,{placeholder:()=>this.controller.s("account-shell-label-feedback-placeholder"),didMount:this.bindFn(this.didMountTextArea),disabled:()=>!this.shouldAllowSubmission(),class:Kt.const("dcg-shared-input-blue-outline"),name:Kt.const("message"),value:()=>this.controller.getFeedbackMessage(),onInput:e=>{if(this.controller.setFeedbackMessage(e),!this.unmounted)return this.update()}}),Kt.createElement("div",{class:Kt.const("dcg-suggestions-expansion")},Kt.createElement("div",{class:Kt.const("dcg-feedback-email-label")},()=>this.controller.s("account-shell-label-feedback-email")),Kt.createElement(bee,{name:Kt.const("anonymous-email"),class:Kt.const("dcg-anonymous-email dcg-shared-input-blue-outline"),placeholder:()=>this.controller.s("account-shell-label-email-placeholder"),disabled:()=>!this.shouldAllowSubmission(),type:Kt.const("email"),value:()=>this.feedbackFromName,onInput:e=>{if(this.feedbackFromName=e,!this.unmounted)return this.update()}}),Kt.createElement("div",{class:Kt.const("dcg-feedback-action-container")},Kt.createElement(mv,{predicate:()=>this.feedbackInProgress},()=>Kt.createElement("div",{class:Kt.const("dcg-template-processing")},Kt.createElement("span",{class:Kt.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-feedback-sending"))),Kt.createElement(mv,{predicate:()=>this.didSendFeedbackEmail},()=>Kt.createElement("div",{class:Kt.const("dcg-template-sent")},Kt.createElement("i",{class:Kt.const("dcg-icon-check"),"aria-hidden":Kt.const("true")}),()=>this.controller.s("account-shell-text-feedback-sent"))),Kt.createElement(mv,{predicate:this.bindFn(this.shouldAllowSubmission)},()=>Kt.createElement("span",{class:Kt.const("dcg-feedback-btns")},Kt.createElement(mv,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>Kt.createElement("a",{role:Kt.const("link"),tabindex:Kt.const("0"),class:Kt.const("dcg-action-closesuggestion"),onTap:this.bindFn(this.onCancel)},()=>this.controller.s("account-shell-button-cancel"))),Kt.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.submitDisabled()}),name:Kt.const("submit"),type:Kt.const("submit")},()=>this.controller.s("account-shell-button-contact-us"))))))))}submitDisabled(){let e=document.querySelector('textarea[name="message"]');return!e||e.value.trim().length===0}didMountContactForm(e){return O(e).on("submit",t=>(t.preventDefault(),this.submitForm()))}didMountTextArea(e){this.unmounted||e.focus()}didUnmount(){this.unmounted=!0}shouldAllowSubmission(){return!this.feedbackInProgress&&!this.didSendFeedbackEmail}onCancel(){this.controller.setFeedbackMessage(""),this.controller.dispatch({type:"show-contact-form",showForm:!1})}async submitForm(){if(this.submitDisabled())return;this.didSendFeedbackEmail=!1,this.feedbackInProgress=!0,this.formErrors=[];let e=document.querySelector('textarea[name="message"]').value.trim(),t=this.controller.product;if(t!=="graphing"&&t!=="graphing-3d"&&t!=="geometry-calculator")throw new Error(`Unexpected product: ${t}`);let i=document.querySelector('input[name="anonymous-email"]'),n={message:e,state:JSON.stringify(this.controller.api.getState()),userAgent:navigator.userAgent,"anonymous-email":i?i.value:"",product:t,lang:this.controller.getLanguage()};this.unmounted||this.update();try{await yH(n),this.didSendFeedbackEmail=!0,this.controller.setFeedbackMessage(""),this.feedbackFromName=this.userController.getEmail(),setTimeout(()=>{this.didSendFeedbackEmail=!1,this.unmounted||this.update()},2e3)}catch(o){this.formErrors=sI(o).map(s=>this.controller.raw(s))}finally{this.feedbackInProgress=!1,this.unmounted||this.update()}}};var{IfElse:xee,If:vee}=ki.Components,ky=class extends ki.Class{handleClick(){this.props.controller().dispatch({type:"show-contact-form",showForm:!0})}template(){return ki.createElement("div",{class:ki.const("dcg-popover-content dcg-hide-on-mobile"),role:ki.const("form"),"aria-label":()=>this.props.controller().s("account-shell-label-feedback")},ki.createElement(vee,{predicate:()=>this.props.controller().product==="geometry-calculator"},()=>ki.createElement("div",{class:ki.const("dcg-geometry-beta-warning")},ki.createElement(Wi,{i18n:this.props.controller,key:this.const("account-shell-text-geometry-beta-notice")},ki.const("Thank you for visiting our Beta Geometry Tool! Please share any bugs, questions, or suggestions with us at"),ki.const(" "),ki.createElement("a",{href:ki.const("mailto:feedback@desmos.com")},ki.const("feedback@desmos.com")),ki.const(". You can also use the form below:")))),xee(()=>this.props.controller().requestedContactForm(),{true:()=>ki.createElement("div",{class:ki.const("dcg-resources-content dcg-feedback-content")},ki.createElement(aI,{controller:this.props.controller})),false:()=>ki.createElement("div",{class:ki.const("dcg-contact-us")},ki.createElement("a",{class:ki.const("dcg-contact-link"),role:ki.const("link"),tabindex:ki.const("0"),onTap:this.bindFn(this.handleClick)},ki.createElement("i",{class:ki.const("dcg-icon-mail"),"aria-hidden":ki.const("true")}),ki.createElement("span",null,()=>this.props.controller().s("account-shell-link-email-support"))))}))}};var lI=class extends el.Class{init(){this.controller=this.props.controller()}template(){return el.createElement(Za,{title:()=>this.controller.s("account-shell-heading-tours"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},el.createElement(iI,{controller:this.props.controller}),el.createElement("div",{class:el.const("dcg-popover-title"),"aria-hidden":el.const("true")},()=>this.controller.s("account-shell-heading-resources")),el.createElement(nI,{controller:this.props.controller}),el.createElement("div",{class:el.const("dcg-popover-title dcg-interior-title dcg-hide-on-mobile"),"aria-hidden":el.const("true")},()=>this.controller.s("account-shell-heading-contact-us")),el.createElement(ky,{controller:this.props.controller}))}};var Nn=__dcg_shared_module_exports__['h'](X());var cI=class extends Nn.Class{init(){this.controller=this.props.controller()}template(){return Nn.createElement(Za,{title:()=>this.controller.s("account-shell-heading-resources"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},Nn.createElement("div",{class:Nn.const("dcg-popover-content dcg-resources-content"),role:Nn.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources")},Nn.createElement(Wu,{href:()=>"https://docs.google.com/document/d/1u4fhQsXWzdCWRGfTdJSuAg9xtyiDk-wmkIAsUkb2L20/preview",icon:Nn.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-geometry-user-guide")}),Nn.createElement(Wu,{href:Nn.const("https://help.desmos.com/"),icon:Nn.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),Nn.createElement("div",{class:Nn.const("dcg-resource-link dcg-action-show-hotkeys"),role:Nn.const("link"),tabindex:Nn.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},Nn.createElement("i",{class:Nn.const("dcg-icon-keyboard"),"aria-hidden":Nn.const("true")}),Nn.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts")))),Nn.createElement("div",{class:Nn.const("dcg-popover-title dcg-interior-title dcg-hide-on-mobile"),"aria-hidden":Nn.const("true")},()=>this.controller.s("account-shell-heading-contact-us")),Nn.createElement(ky,{controller:this.props.controller}))}};var nt=__dcg_shared_module_exports__['h'](X());ct();var Zn=__dcg_shared_module_exports__['h'](X());ct();var{Input:Cee,Switch:Dee}=Zn.Components,dI=class extends Zn.Class{constructor(){super(...arguments),this.unmounted=!1}didUnmount(){this.unmounted=!0}template(){return Zn.createElement("div",{class:Zn.const("dcg-selectable-input-container")},Zn.createElement(Cee,{class:this.const("dcg-permalink select-all dcg-variable-permalink"),"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link"),name:()=>this.props.controller().s("graphing-calculator-text-share-graph-link"),value:this.props.link,didMount:e=>{this.inputEl=e,_l||this.inputEl.focus()},onTap:()=>this.inputEl.select(),onInput:()=>{}}),Zn.createElement("div",{role:Zn.const("button"),tabindex:Zn.const(0),class:Zn.const("dcg-copy-button"),onTap:this.bindFn(this.copyLink)},Zn.createElement(Dee,{key:()=>this.copyStatus},e=>e=="success"?Zn.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-copied")},Zn.createElement("i",{class:Zn.const("dcg-icon-check"),"aria-hidden":Zn.const("true")})):e=="error"?Zn.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-unable-to-copy")},Zn.createElement("i",{class:Zn.const("dcg-icon-error"),"aria-hidden":Zn.const("true")})):Zn.createElement("span",{class:Zn.const("dcg-copy-text")},()=>this.props.controller().s("graphing-calculator-button-share-graph-link-copy")))))}copyLink(){if(this.inputEl){O(this.inputEl).trigger("focus").trigger("select"),this.copyStatus="success";try{document.execCommand("copy")}catch(e){this.copyStatus="error"}this.unmounted||(this.update(),clearTimeout(this.copyStatusTimeout),this.copyStatusTimeout=setTimeout(()=>{this.copyStatus=null,!this.unmounted&&this.update()},2500))}}};var{If:oh,Textarea:See}=nt.Components,uI=class extends nt.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.graph=null,this.shareInProgress=!0,this.didSharingFail=!1,Ei("user-action::open-share-dropdown",{})}template(){return nt.createElement(Za,{title:()=>this.controller.s("account-shell-heading-share-graph"),type:nt.const("share"),label:()=>this.controller.s("account-shell-narration-share-options"),controller:this.props.controller},nt.createElement("div",{class:nt.const("dcg-popover-content")},nt.createElement(oh,{predicate:()=>this.shareInProgress},()=>nt.createElement("div",{class:nt.const("dcg-loading")},nt.createElement("span",{class:nt.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),nt.createElement(oh,{predicate:()=>this.didSharingFail},()=>nt.createElement("div",{class:nt.const("dcg-failed")},nt.createElement("span",{"aria-live":nt.const("assertive"),"aria-atomic":nt.const(!0)},()=>this.controller.s("account-shell-error-sharing-link")+" "),nt.createElement("span",{role:nt.const("button"),tabindex:nt.const("0"),class:nt.const("dcg-action-retry"),onTap:()=>(this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.dispatch({type:"toggle-menu",payload:"share"}))},()=>this.controller.s("account-shell-button-retry-now")),()=>` ${this.controller.s("account-shell-text-or")} `,nt.createElement("span",{role:nt.const("button"),tabindex:nt.const("0"),class:nt.const("dcg-action-close"),onTap:()=>this.controller.dispatch({type:"toggle-menu",payload:"share"})},()=>this.controller.s("account-shell-button-cancel")),nt.const("."))),nt.createElement(oh,{predicate:()=>!this.shareInProgress&&!this.didSharingFail},()=>nt.createElement("div",{class:nt.const("dcg-loaded"),didMount:this.bindFn(this.didMountLoaded)},()=>this.controller.s("account-shell-label-share-link"),nt.createElement(dI,{controller:this.props.controller,link:()=>this.getGraphPath()}),nt.createElement(oh,{predicate:()=>!this.controller.shouldDisablePrintAndExport()},()=>nt.createElement("div",{class:nt.const("dcg-share-actions")},nt.createElement(oh,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>nt.createElement("span",{class:nt.const("dcg-print-link"),onTap:this.bindFn(this.print),tabindex:nt.const("0"),role:nt.const("link")},nt.createElement("i",{class:nt.const("dcg-icon-print"),"aria-hidden":nt.const("true")}),nt.createElement("span",null,()=>this.controller.s("account-shell-button-print")))),nt.createElement("span",{class:nt.const("dcg-export-image-link"),onTap:this.bindFn(this.exportImage),tabindex:nt.const("0"),role:nt.const("link")},nt.createElement("i",{class:nt.const("dcg-icon-export"),"aria-hidden":nt.const("true")}),nt.createElement("span",null,()=>this.controller.s("account-shell-button-export-image"))),nt.createElement(oh,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>nt.createElement("span",{class:()=>({"dcg-embed-link":!0,"dcg-selected":this.embedVisible}),onTap:this.bindFn(this.toggleEmbedVisible),tabindex:nt.const("0"),role:nt.const("button"),"aria-pressed":()=>this.embedVisible},nt.createElement("i",{class:nt.const("dcg-icon-embed"),"aria-hidden":nt.const("true")}),nt.createElement("span",null,()=>this.controller.s("account-shell-button-embed")))))),nt.createElement(oh,{predicate:()=>this.embedVisible},()=>nt.createElement("div",{class:nt.const("dcg-embed-div share-div"),didMount:this.bindFn(this.didMountTextarea)},nt.createElement(See,{rows:nt.const("6"),class:nt.const("select-all first-input dcg-variable-htmlembedcode"),value:()=>this.getGraphEmbedCode(),onInput:()=>{}}))),nt.createElement(oh,{predicate:()=>this.controller.shouldShowArtContestNudge()},()=>nt.createElement("div",{class:nt.const("dcg-art-contest-container")},nt.createElement("span",{class:nt.const("dcg-trophy-icon")},nt.const("\u{1F3C6}")),nt.createElement(Wi,{i18n:this.const(this.controller),key:this.const("account-shell-text-share-submit-to-contest")},nt.createElement("span",{class:nt.const("dcg-contest-submit-message")},nt.const("Submit this graph to the"),nt.const(" "),nt.createElement("span",{class:nt.const("dcg-bold-text")},nt.const("Global Math Art Contest!")))),nt.createElement("div",{class:nt.const("dcg-enter-btn"),role:nt.const("button"),tabindex:nt.const("0"),onTap:e=>(this.controller.state.artContestURLFromShareMenu=this.getGraphPath(),this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device}))},()=>this.controller.s("account-shell-button-submit"))))))))}didMountTextarea(e){let t=e.querySelector("textarea");O(t).trigger("focus").trigger("select")}toggleEmbedVisible(){this.embedVisible=!this.embedVisible,this.unmounted||this.update()}didMountLoaded(){this.embedVisible=!1}print(){window.print()}exportImage(e){this.controller.dispatch({type:"show-modal",modal:"export-image",device:e.device})}getGraphPath(){return this.graph!=null?this.graph.getURL():void 0}getGraphEmbedCode(){return this.graph?`<iframe src="${`${this.getGraphPath()}?embed`}" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>`:""}didUnmount(){this.unmounted=!0}async didMount(){try{let e=await this.graphsController.shareGraph();this.graph=e}catch(e){this.didSharingFail=!0}finally{this.shareInProgress=!1,this.unmounted||this.update()}}};var Po=__dcg_shared_module_exports__['h'](X());var{If:Eee}=Po.Components,Gy=class extends Po.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){return Po.createElement(Eee,{predicate:()=>this.userController.isLoggedIn()},()=>Po.createElement(Za,{type:()=>"account",label:()=>this.controller.s("account-shell-label-account-information"),left:this.props.left,arrowLeft:this.props.arrowLeft,controller:this.props.controller},Po.createElement("div",{class:Po.const("user-info")},Po.createElement("span",{class:Po.const("account-name")},()=>this.userController.getFullName()),Po.createElement("span",{class:Po.const("account-email")},()=>this.userController.getEmail()),Po.createElement("a",{class:Po.const("dcg-action-accountsettings"),role:Po.const("link"),tabindex:Po.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e.device})},()=>this.controller.s("account-shell-link-account-settings"))),Po.createElement("a",{class:Po.const("dcg-action-logout"),role:Po.const("link"),tabindex:Po.const(0),onTap:()=>this.logout()},()=>this.controller.s("account-shell-link-sign-out"))))}logout(){this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.userController.logout()}};var yv=__dcg_shared_module_exports__['h'](X());var Cr=__dcg_shared_module_exports__['h'](X());var fv=__dcg_shared_module_exports__['h'](X());ct();var{If:R2e}=fv.Components;var{For:DH,If:pI,IfDefined:kee,Switch:Gee}=Cr.Components,hI=class extends Cr.Class{template(){return Cr.createElement(DH,{each:this.props.options,key:e=>`${e.key?e.key:e.title()}${e.disabled?"-disabled":""}`},Cr.createElement("div",{role:Cr.const("list"),class:()=>({"dcg-shared-options-dropdown":!0,[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0})},e=>Cr.createElement("div",{role:Cr.const("listitem"),class:Cr.const("dropdown-option-container")},Cr.createElement(Gee,{key:()=>e},t=>"href"in t?Cr.createElement("a",{"aria-disabled":()=>t.disabled,class:()=>({[t.class||""]:!!t.class,"dropdown-choice":!0,"dropdown-choice-disabled":t.disabled}),onTap:()=>!t.disabled&&this.props.onTap(t),href:()=>t.href,target:()=>t.target!==void 0?t.target:"",rel:()=>t.noreferrer?"noreferrer noopener":""},Cr.createElement(pI,{predicate:()=>t.icon!=null},()=>Cr.createElement("div",{class:Cr.const("option-icon-container")},Cr.createElement("i",{"aria-hidden":Cr.const("true"),class:()=>`${t.icon} option-icon`}))),t.title):Cr.createElement("div",{role:Cr.const("link"),tabindex:Cr.const(0),"aria-disabled":()=>t.disabled,class:()=>({[t.class||""]:!!t.class,"dropdown-choice":!0,"dropdown-choice-disabled":t.disabled}),onTap:()=>!t.disabled&&this.props.onTap(t)},Cr.createElement(pI,{predicate:()=>t.icon!=null},()=>Cr.createElement("div",{class:Cr.const("option-icon-container")},Cr.createElement("i",{"aria-hidden":Cr.const("true"),class:()=>`${t.icon} option-icon`}))),Cr.createElement("span",{class:Cr.const("option-title")},t.title),kee(()=>t.subtitle&&t.subtitle(),i=>Cr.createElement("span",{class:Cr.const("option-subtitle")},i)))),Cr.createElement(pI,{predicate:()=>!!e.explanations},()=>Cr.createElement(DH,{each:()=>e.explanations||[],key:t=>t.flag},Cr.createElement("div",{class:Cr.const("dropdown-explanations")},t=>Cr.createElement("div",{class:Cr.const("explanation")},()=>t.explanation,Cr.const(" "),Cr.createElement(pI,{predicate:()=>!!t.link},()=>Cr.createElement("a",{class:Cr.const("learn-more"),href:()=>t.link!==void 0?t.link:"",target:Cr.const("_blank")},()=>t.linkText?t.linkText:pn("shared-button-learn-more-capitalized"))))))))))}};var Iee=28,Vee=10,V0=4,gI=class extends yv.Class{template(){return yv.createElement(Za,{type:this.const("graph-actions"),label:()=>this.props.controller().s("account-shell-label-graph-actions"),controller:this.props.controller,left:()=>this.left,arrowLeft:()=>this.arrowLeft},yv.createElement(hI,{class:this.const("dcg-graph-actions-list"),options:this.bindFn(this.getOptions),onTap:this.bindFn(this.tapOption)}))}didMount(){var o,s,a,l;let e=document.querySelector(".dcg-graph-actions-dropdown-anchor"),t=((s=(o=Ul(e))==null?void 0:o.left)!=null?s:0)+((a=e.getBoundingClientRect().width)!=null?a:0)/2,n=((l=document.querySelector(".dcg-graph-actions-container").getBoundingClientRect().width)!=null?l:0)-Iee/2-Vee;t<=n+V0?(this.left=`${V0}px`,this.arrowLeft=`${t-V0}px`):(this.left=`${t-n}px`,this.arrowLeft=`${n}px`),this.update()}getOptions(){let e=[];return e.push({title:()=>this.props.controller().s("account-shell-button-rename"),icon:"dcg-icon-pencil",class:"blue-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"rename",device:"mouse"})}}),this.props.controller().graphsController.wasCurrentGraphEverSaved()&&e.push({title:()=>this.props.controller().s("account-shell-button-duplicate"),icon:"dcg-icon-duplicate",action:()=>this.props.controller().dispatch({type:"show-modal",modal:"duplicate",device:"mouse"})},{title:()=>this.props.controller().s("account-shell-button-delete"),icon:"dcg-icon-remove",class:"red-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"delete",device:"mouse"})}}),e}tapOption(e){e.action!==void 0&&e.action(),!e.preventClose&&("href"in e?e.isDeepLink&&setTimeout(()=>this.closeMenu()):this.closeMenu())}closeMenu(){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"})}};var{SwitchUnion:Tee}=tl.Components,mI=class extends tl.Class{init(){this.controller=this.props.controller()}template(){return tl.createElement("div",null,tl.createElement(OG,{controller:this.props.controller}),Tee(()=>this.getMenu(),{language:()=>tl.createElement(_G,{controller:this.props.controller}),help:()=>this.props.controller().product==="geometry-calculator"?tl.createElement(cI,{controller:this.props.controller}):tl.createElement(lI,{controller:this.props.controller}),share:()=>tl.createElement(uI,{controller:this.props.controller}),account:()=>tl.createElement(Gy,{controller:this.props.controller}),"graph-actions":()=>tl.createElement(gI,{controller:this.props.controller}),none:()=>tl.createElement("span",null)}))}getMenu(){return this.controller.mygraphsController.isMygraphsOpen()?"none":this.controller.getOpenMenu()}};var Bt=__dcg_shared_module_exports__['h'](X());var Gi=__dcg_shared_module_exports__['h'](X());var fI=__dcg_shared_module_exports__['h'](X()),ic=class extends fI.Class{template(){return fI.createElement("div",{class:()=>({modal_section:!0,"dcg-hotkeys-dialog":this.props.controller().getOpenModal()==="hotkeys"})},this.children)}};ct();var{Input:Mee,Checkbox:Aee,If:Lee}=Gi.Components,Iy=class extends Gi.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.lastSavedTitle=this.graphsController.getCurrentGraphTitle(),this.controller.getOpenModal()==="duplicate"?this.newSaveTitle=this.controller.s("account-shell-text-copy-of-title",{originalTitle:this.lastSavedTitle}):this.newSaveTitle=this.lastSavedTitle||this.graphsController.getUntitledString(),this.controller.state.saveDialog==null&&(this.controller.state.saveDialog={copyOnSave:!0})}template(){return Gi.createElement(ic,{controller:this.props.controller},Gi.createElement("div",{id:Gi.const("save-dialog")},Gi.createElement("h1",null,()=>this.getTitle()),Gi.createElement("div",{class:Gi.const("dcg-clear")}),Gi.createElement("form",{didMount:this.bindFn(this.didMountForm)},Gi.createElement("label",{class:Gi.const("input-label")},Gi.createElement("div",{class:Gi.const("graph-title-title")},()=>this.controller.s("account-shell-label-graph-title"),Gi.const("\xA0")),Gi.createElement(Mee,{class:Gi.const("title-input dcg-input-blue-outline"),name:Gi.const("title"),placeholder:()=>this.graphsController.getUntitledString(),value:()=>this.newSaveTitle,maxlength:Gi.const("140"),onInput:e=>this.newSaveTitle=e,didMount:e=>O(e).trigger("focus").trigger("select")})),Gi.createElement("div",null,Gi.createElement("button",{type:Gi.const("submit"),class:Gi.const("dcg-btn dcg-btn-primary pull-right dcg-action-save")},()=>this.controller.s("account-shell-button-save")),Gi.createElement(Lee,{predicate:()=>this.shouldShowDuplicateOption()&&this.graphsController.wasCurrentGraphEverSaved()},()=>Gi.createElement("label",{class:Gi.const("dcg-new-copy pull-right")},Gi.createElement(Aee,{checked:()=>this.controller.state.saveDialog.copyOnSave,onChange:e=>{if(this.controller.state.saveDialog.copyOnSave=e,!this.unmounted)return this.update()}}),Gi.createElement("span",{class:Gi.const("duplicate-label")},()=>this.getDuplicateLabel())))))))}didUnmount(){this.unmounted=!0}didMountForm(e){O(e).on("submit",t=>{t.preventDefault(),this.newSaveTitle===""&&(this.newSaveTitle="Untitled Graph");let i;this.shouldShowDuplicateOption()?i=this.controller.state.saveDialog.copyOnSave:i=this.controller.getOpenModal()!=="rename",this.controller.dispatch({type:"save-graph",payload:{title:this.newSaveTitle,saveAs:i},device:"mouse"})})}getTitle(){if(this.controller.product==="geometry")return this.controller.s("account-shell-heading-save-construction");switch(this.controller.getOpenModal()){case"rename":return this.controller.s("account-shell-heading-rename-graph");case"save":return this.controller.s("account-shell-heading-save-graph");case"duplicate":return this.controller.s("account-shell-heading-duplicate-graph");default:return""}}getDuplicateLabel(){return this.controller.product==="geometry"?this.controller.s("account-shell-heading-duplicate-construction"):this.controller.s("account-shell-heading-duplicate-graph")}shouldShowDuplicateOption(){if(this.controller.product==="geometry")return!0;let e=this.controller.getModalState();return!!(e.modal==="save"&&e.fromSaveInProgress)}};var ke=__dcg_shared_module_exports__['h'](X());ct();var Ho=__dcg_shared_module_exports__['h'](X());var Vg=class extends Ho.Class{template(){return Ho.createElement("div",{class:Ho.const("dcg-shared-cookie-notice")},Ho.createElement(Wi,{key:this.const("shared-message-cookie-notice"),i18n:this.props.i18n},Ho.createElement("b",null,Ho.const("Note:")),Ho.const(" "),Ho.const("Desmos uses cookies to enable persistence when you are signed"),Ho.const(" "),Ho.const("in. If you do not wish to use cookies, please use Desmos without"),Ho.const(" "),Ho.const("logging in."),Ho.const(" "),Ho.createElement("a",{class:Ho.const("dcg-shared-cookie-notice-learn-more dcg-shared-dark-gray-link"),href:Ho.const("/privacy"),target:Ho.const("_blank")},Ho.const("Learn More."))))}};var Vl=__dcg_shared_module_exports__['h'](X());var{If:Oee,For:Pee}=Vl.Components,ns=class extends Vl.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Vl.createElement(Oee,{predicate:()=>!!this.props.errors().length},()=>Vl.createElement(Pee,{each:this.props.errors},Vl.createElement("span",null,e=>Vl.createElement("div",{class:Vl.const("dcg-shared-account-modal-errors"),role:Vl.const("alert")},Vl.createElement("span",null,()=>this.i18n.raw(e))))))}};var{If:bv,Input:yI,Switch:_ee}=ke.Components,bI=0,T0=1,wI=class extends ke.Class{template(){return ke.createElement("span",{class:ke.const("dcg-shared-terms-notice")},ke.createElement(Wi,{key:this.const("shared-message-privacy-notice"),i18n:this.props.i18n},ke.const("I have read, understand, and accept the"),ke.const(" "),ke.createElement("a",{href:ke.const("/terms"),target:ke.const("_blank"),class:ke.const("dcg-shared-blue-link")},ke.const("Terms of Service")),ke.const(" "),ke.const("and"),ke.const(" "),ke.createElement("a",{href:ke.const("/privacy"),target:ke.const("_blank"),class:ke.const("dcg-shared-blue-link")},ke.const("Privacy Policy")),ke.const(".")))}},xI=class extends ke.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.selectedView=bI,this.givenName="",this.familyName="",this.email="",this.password="",this.consentChecked=!1,this.isSubmittingForm=!1,this.formErrors=[],this.breakPoint=660,this.measureWindow(),this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return ke.createElement(Lo,{title:()=>this.i18n.s("shared-title-signup"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},ke.createElement("div",{class:()=>({"dcg-shared-signup-dialog":!0,"dcg-shared-account-dialog":!0})},ke.createElement("div",{class:ke.const("dcg-shared-switch-account-message")},()=>this.i18n.s("shared-prompt-already-have-account"),this.const(this.i18n.raw(" ")),ke.createElement("a",{role:ke.const("link"),tabindex:ke.const("0"),class:ke.const("dcg-shared-dark-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"login",device:e.device})},()=>this.i18n.s("shared-button-login")),ke.const(".")),ke.createElement("div",{class:ke.const("dcg-shared-navigation-tabs"),role:ke.const("tablist")},ke.createElement("div",{role:ke.const("tab"),tabindex:ke.const("0"),"aria-selected":this.bindFn(this.isGoogleSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-profile-view-button":!0,"dcg-selected":this.isGoogleSelected()}),onTap:()=>this.updateView(bI)},this.bindFn(this.externalTitle)),ke.createElement("div",{role:ke.const("tab"),tabindex:ke.const("0"),"aria-selected":this.bindFn(this.isDesmosSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-password-view-button":!0,"dcg-selected":this.isDesmosSelected()}),onTap:()=>this.updateView(T0)},this.bindFn(this.desmosTitle))),ke.createElement("div",{class:ke.const("dcg-shared-account-content-container")},ke.createElement(_ee,{key:()=>this.selectedView},e=>e===bI?ke.createElement("div",{class:ke.const("dcg-shared-notice-checkbox-google")},ke.createElement(Gt,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,!this.unmounted)return this.update()}},this.bindFn(this.consentText)),ke.createElement(Gt,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,!this.unmounted)return this.update()}},ke.createElement(wI,{i18n:this.const(this.i18n)})),ke.createElement(bv,{predicate:()=>window.googleAuthConnectionFailed},()=>ke.createElement("div",{class:ke.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),ke.createElement(bv,{predicate:()=>!window.googleAuthConnectionFailed},()=>ke.createElement("div",{class:()=>({"dcg-shared-btn-gray-outline":!0,"dcg-shared-google-login":!0,"dcg-disabled":this.hasNotConsented()}),role:ke.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.googleLogin()},ke.createElement("div",{class:ke.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),ke.createElement("span",null,this.bindFn(this.getGoogleLoginText)))),ke.createElement(bv,{predicate:()=>this.controller.allowSignInWithApple()},()=>ke.createElement("div",{class:()=>({"dcg-shared-btn-gray-outline":!0,"dcg-shared-apple-login":!0,"dcg-disabled":this.hasNotConsented()}),role:ke.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.appleLogin()},ke.createElement("div",{class:ke.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),ke.createElement("span",null,this.bindFn(this.getAppleLoginText))))):e===T0?ke.createElement("div",null,ke.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),ke.createElement("form",{class:ke.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit),didMount:this.bindFn(this.didMountForm)},ke.createElement("div",{class:ke.const("dcg-shared-email-form-container")},ke.createElement("label",null,ke.createElement("span",{class:ke.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),ke.createElement(yI,{type:ke.const("email"),name:ke.const("email"),class:ke.const("dcg-shared-input-blue-outline"),required:ke.const("true"),"aria-describedby":ke.const("email-description"),didMount:t=>{fc||t.focus()},value:()=>this.email,onInput:t=>{if(this.email=t,!this.unmounted)return this.update()}})),ke.createElement("div",{class:ke.const("dcg-shared-name-container")},ke.createElement("div",{class:ke.const("dcg-shared-name-input")},ke.createElement("label",null,ke.createElement("span",{class:ke.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-given-name-or-nickname")),ke.createElement(yI,{type:ke.const("text"),name:ke.const("given-name"),class:ke.const("dcg-shared-input-blue-outline"),required:ke.const("true"),"aria-describedby":ke.const("given-name-description"),value:()=>this.givenName,onInput:t=>{if(this.givenName=t,!this.unmounted)return this.update()}}))),ke.createElement("div",{class:ke.const("dcg-shared-name-input")},ke.createElement("label",null,ke.createElement("span",{class:ke.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-family-name")),ke.createElement(yI,{type:ke.const("text"),name:ke.const("family-name"),class:ke.const("dcg-shared-input-blue-outline"),"aria-describedby":ke.const("family-name-description"),value:()=>this.familyName,onInput:t=>{if(this.familyName=t,!this.unmounted)return this.update()}})))),ke.createElement("label",null,ke.createElement("span",null,()=>this.i18n.s("shared-label-password")),ke.createElement(yI,{type:ke.const("password"),class:ke.const("dcg-shared-input-blue-outline"),name:ke.const("password"),required:ke.const("true"),value:()=>this.password,onInput:t=>{if(this.password=t,!this.unmounted)return this.update()}})),ke.createElement("div",{class:ke.const("dcg-shared-notice-checkbox-email")},ke.createElement(Gt,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,!this.unmounted)return this.update()}},this.bindFn(this.consentText))),ke.createElement(Gt,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,!this.unmounted)return this.update()}},ke.createElement(wI,{i18n:this.const(this.i18n)})),ke.createElement("div",{class:ke.const("dcg-shared-sign-in-options")},ke.createElement(bv,{predicate:()=>this.isSubmittingForm},()=>ke.createElement("div",{class:ke.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},ke.createElement("div",{class:ke.const("dcg-shared-spinner")}))),ke.createElement(bv,{predicate:()=>!this.isSubmittingForm},()=>ke.createElement("div",{class:ke.const("dcg-shared-submit-container")},ke.createElement("button",{type:ke.const("submit"),class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-create-account")))))))):ke.createElement("span",null)),ke.createElement(Vg,{i18n:this.const(this.i18n)}))))}canSwitchRoles(){return!this.controller.getLimitedSignupRole()}didMountForm(e){this.form=e}submitEnabled(){var n,o,s;if(!this.consentChecked||!this.privacyChecked||!this.form)return!1;let e=(n=this.form.querySelector('[name="password"]'))==null?void 0:n.value,t=(o=this.form.querySelector('[name="email"]'))==null?void 0:o.value,i=(s=this.form.querySelector('[name="given-name"]'))==null?void 0:s.value;return!!(e&&t&&i)}onSubmit(e){e.preventDefault(),this.submitEnabled()&&this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"create"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"create"})}getGoogleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-google"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-google")}getAppleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-apple"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-apple")}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0,this.unmounted||this.update();try{if(await this.controller.userController.createAccount({userProvidedName:{given:this.givenName,family:this.familyName.length?this.familyName:void 0},email:this.email,password:this.password,teacher:!1,lang:this.controller.getLanguage()}),!this.unmounted)return this.controller.dispatch({type:"close-modal"})}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}finally{this.isSubmittingForm=!1,this.unmounted||this.update()}}updateView(e){this.selectedView=e,this.unmounted||this.update()}externalTitle(){return this.controller.allowSignInWithApple()?this.windowWidth>this.breakPoint?this.i18n.s("shared-button-external-account-wide"):this.i18n.s("shared-button-external-account-narrow"):this.windowWidth>this.breakPoint?this.i18n.s("shared-button-google-account-wide"):this.i18n.s("shared-button-google-account-narrow")}desmosTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-button-email-address-wide"):this.i18n.s("shared-button-email-address-narrow")}measureWindow(){return this.windowWidth=O(window).width()}didMount(){O(window).on("resize.create-account",__dcg_shared_module_exports__['B'](()=>{this.measureWindow(),this.update()},200))}didUnmount(){O(window).off("resize.create-account"),this.unmounted=!0}consentText(){return this.i18n.s("shared-message-consent-text")}isGoogleSelected(){return this.selectedView===bI}isDesmosSelected(){return this.selectedView===T0}hasNotConsented(){return!this.consentChecked||!this.privacyChecked}};var $e=__dcg_shared_module_exports__['h'](X());var{If:wv,Input:SH,IfElse:Fee}=$e.Components,vI=class extends $e.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email="",this.password="",this.isSubmittingForm=!1,this.formErrors=[],this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return $e.createElement(Lo,{title:()=>this.i18n.s("shared-title-login"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},$e.createElement("div",{class:$e.const("dcg-shared-login-dialog dcg-shared-account-dialog")},Fee(()=>this.canChooseRole(),{true:()=>$e.createElement("div",{class:$e.const("dcg-shared-switch-account-message")},$e.createElement(Wi,{key:this.const("shared-prompt-new-to-desmos-teacher-or-student"),i18n:this.props.controller},$e.const("New to Desmos?"),$e.const(" "),$e.createElement("a",{role:$e.const("link"),tabindex:$e.const("0"),class:$e.const("dcg-shared-dark-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},$e.const("Sign up!")))),false:()=>$e.createElement("div",{class:$e.const("dcg-shared-switch-account-message")},$e.createElement(Wi,{key:this.const("shared-prompt-new-to-desmos-sign-up-here"),i18n:this.props.controller},$e.const("New to Desmos?"),$e.const(" "),$e.createElement("a",{role:$e.const("link"),tabindex:$e.const("0"),class:$e.const("dcg-shared-dark-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},$e.const("Sign up")),$e.const(".")))}),$e.createElement("div",{class:$e.const("dcg-shared-account-content-container")},$e.createElement(wv,{predicate:()=>window.googleAuthConnectionFailed},()=>$e.createElement("div",{class:$e.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),$e.createElement(wv,{predicate:()=>!window.googleAuthConnectionFailed},()=>$e.createElement("div",{class:$e.const("dcg-shared-btn-gray-outline dcg-shared-google-login"),role:$e.const("button"),tabindex:$e.const("0"),onTap:()=>this.googleLogin()},$e.createElement("div",{class:$e.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),$e.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-google")))),$e.createElement(wv,{predicate:()=>this.controller.allowSignInWithApple()},()=>$e.createElement("div",{class:$e.const("dcg-shared-btn-gray-outline dcg-shared-apple-login"),role:$e.const("button"),tabindex:$e.const("0"),onTap:()=>this.appleLogin()},$e.createElement("div",{class:$e.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),$e.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-apple"))))),$e.createElement("div",{class:$e.const("dcg-shared-bg-line")},$e.createElement("span",null,()=>this.i18n.s("shared-message-or-login-with-desmos"))),$e.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),$e.createElement("form",{class:$e.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit)},$e.createElement("div",{class:$e.const("dcg-shared-email-form-container")},$e.createElement("label",null,$e.createElement("span",{class:$e.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),$e.createElement(SH,{type:$e.const("email"),name:$e.const("email"),class:$e.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:$e.const("required"),didMount:e=>{fc||e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this.unmounted||this.update()}})),$e.createElement("div",{class:$e.const("dcg-shared-password-container")},$e.createElement("label",{for:$e.const("password")},$e.createElement("span",null,()=>this.i18n.s("shared-label-password")),$e.createElement(SH,{type:$e.const("password"),class:$e.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:$e.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,!this.unmounted)return this.update()}}),$e.createElement("span",{class:$e.const("dcg-shared-password-recovery-link")},$e.createElement("a",{role:$e.const("link"),tabindex:$e.const(0),class:$e.const("dcg-shared-action-password"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device})},()=>this.i18n.s("shared-prompt-forgot-your-password"))))),$e.createElement("div",{class:$e.const("dcg-shared-sign-in-options")},$e.createElement(wv,{predicate:()=>this.isSubmittingForm},()=>$e.createElement("div",{class:$e.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},$e.createElement("div",{class:$e.const("dcg-shared-spinner")}))),$e.createElement(wv,{predicate:()=>!this.isSubmittingForm},()=>$e.createElement("div",{class:$e.const("dcg-shared-submit-container")},$e.createElement("button",{type:$e.const("submit"),class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-login-capitalized"))))),$e.createElement(Vg,{i18n:this.const(this.i18n)})))))}canChooseRole(){return!this.controller.getLimitedSignupRole()}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"login"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"login"})}submitEnabled(){return!!(this.email&&this.password)}async submitForm(){if(this.submitEnabled()){this.isSubmittingForm=!0,this.formErrors=[];try{let e=await this.controller.userController.checkPendingDeletion({email:this.email,lang:this.controller.getLanguage()});this._pendingDeletion=e.pendingDeletion}catch(e){this._pendingDeletion=!1}if(!this.unmounted){this.unmounted||this.update();try{if(await this.controller.userController.desmosLogin({email:this.email,password:this.password,lang:this.controller.getLanguage()}),this.unmounted)return;this._pendingDeletion?this.controller.dispatch({type:"show-modal",modal:"account-reenabled",device:"mouse"}):this.controller.dispatch({type:"close-modal"})}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}this.unmounted||(this.isSubmittingForm=!1,this.controller.dispatch({type:"render"}))}}}};var Vr=__dcg_shared_module_exports__['h'](X());var{If:CI,Input:Ree}=Vr.Components,DI=class extends Vr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email=this.controller.userController.getEmail(),this.formErrors=[],this.isSubmittingForm=!1,this.didSendRecoveryEmail=!1}template(){return Vr.createElement(Lo,{title:()=>this.i18n.s("shared-title-recover-password"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Vr.createElement("div",{class:Vr.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},Vr.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),Vr.createElement(CI,{predicate:()=>this.didSendRecoveryEmail},()=>Vr.createElement("div",{role:Vr.const("alert"),class:Vr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-check-email-for-password-recovery-link"),Vr.const(" "),Vr.createElement("a",{href:Vr.const("#"),class:Vr.const("dcg-shared-blue-link"),onTap:e=>(this.didSendRecoveryEmail=!1,this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device}))},()=>this.i18n.s("shared-button-try-again")))),Vr.createElement(CI,{predicate:()=>!this.didSendRecoveryEmail},()=>Vr.createElement("form",{class:Vr.const("dcg-shared-email-form-container"),onSubmit:this.bindFn(this.onSubmit)},Vr.createElement("div",{class:Vr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-prompt-enter-email-for-password-recovery-link")),Vr.createElement("label",null,Vr.createElement("span",{class:Vr.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),Vr.createElement(Ree,{type:Vr.const("email"),name:Vr.const("email"),class:Vr.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:Vr.const("true"),didMount:e=>{fc&&e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this.unmounted||this.update()}})),Vr.createElement("div",{class:Vr.const("dcg-shared-sign-in-options")},Vr.createElement(CI,{predicate:()=>this.isSubmittingForm},()=>Vr.createElement("div",{class:Vr.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},Vr.createElement("div",{class:Vr.const("dcg-shared-spinner")}))),Vr.createElement(CI,{predicate:()=>!this.isSubmittingForm},()=>Vr.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0}),type:Vr.const("submit")},()=>this.i18n.s("shared-button-recover-password"))))))))}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitForm()}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0;try{await this.controller.userController.recoverPassword({email:this.email,lang:this.controller.getLanguage()}),this.didSendRecoveryEmail=!0}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}finally{this.isSubmittingForm=!1,this.unmounted||this.update()}}};var Mt=__dcg_shared_module_exports__['h'](X());var EH={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-braille",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-nemeth-mode",standard:"<key>ALT</key> + <key>N</key>",apple:"<key>CTRL</key> + <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-ueb-mode",standard:"<key>ALT</key> + <key>U</key>",apple:"<key>CTRL</key> + <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-mode",standard:"<key>ALT</key> + <key>Q</key>",apple:"<key>CTRL</key> + <key>Q</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-braille-typing",standard:"<key>ALT</key> + <key>6</key>",apple:"<key>CTRL</key> + <key>6</key>"}]};var SI=function(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-expression",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-expression",standard:"<key>DOWN ARROW</key>, <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-remove-empty-expression",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-character",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-character",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-numerator",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-denominator",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-exit-block",standard:"<key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-block",standard:"<key>Home</key>",apple:"<key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-block",standard:"<key>End</key>",apple:"<key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-expression",standard:"<key>CTRL</key> + <key>Home</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-expression",standard:"<key>CTRL</key> + <key>End</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-left",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-right",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-selection",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-select-all",standard:"<key>CTRL</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-parent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>UP ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-focused-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>LEFT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>RIGHT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-selection",standard:"<key>CTRL</key> + <key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-answer",standard:"<key>CTRL</key> + <key>ALT</key> + <key>=</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>RIGHT ARROW</key>"}]};return r.decimalToFraction&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>A</key>"}),e};var nc={common:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-symbols",shortcuts:[{latex:"a^b",standard:"<key>^</key> (<key>SHIFT</key> + <key>6</key>)"},{latex:"a_b",standard:"<key>_</key> (<key>SHIFT</key> + <key>-</key>)"},{latex:"\\le",standard:"<key><</key><key>=</key>"},{latex:"\\ge",standard:"<key>></key><key>=</key>"},{latex:"a'",standard:"<key>'</key>"},{latex:"\\frac{a}{b}",standard:"<key>f</key><key>r</key><key>a</key><key>c</key>"},{latex:"\\sqrt{a}",standard:"<key>s</key><key>q</key><key>r</key><key>t</key>"},{latex:"\\sqrt[3]{a}",standard:"<key>c</key><key>b</key><key>r</key><key>t</key>"},{latex:"\\sqrt[n]{a}",standard:"<key>n</key><key>t</key><key>h</key><key>r</key><key>o</key><key>o</key><key>t</key>"},{latex:"\\sum_{n=a}^b",standard:"<key>s</key><key>u</key><key>m</key>"},{latex:"\\int_a^b",standard:"<key>i</key><key>n</key><key>t</key>"},{latex:"\\prod_{n=a}^b",standard:"<key>p</key><key>r</key><key>o</key><key>d</key>"},{latex:"\\pi",standard:"<key>p</key><key>i</key>"},{latex:"\\theta",standard:"<key>t</key><key>h</key><key>e</key><key>t</key><key>a</key>"},{latex:"\\to",standard:"<key>-</key><key>></key>"}]},tables:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-tables",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-cell",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-cell",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-row",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-row",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-column",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-column",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-row",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-row",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-column",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-column",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-speak-column-header",standard:"<key>CTRL</key> + <key>H</key>"}]},sliders:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-sliders",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-minimum",standard:"<key>HOME</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-maximum",standard:"<key>END</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key>"}]},audiotrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-audio-tracing",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-audio-trace",standard:"<key>ALT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-summarize-graph",standard:"<key>ALT</key> + <key>S</key>",apple:"<key>OPTION</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-describe-axes",standard:"<key>ALT</key> + <key>G</key>",apple:"<key>OPTION</key> + <key>G</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-point",standard:"<key>LEFT ARROW</key>, <key>UP ARROW</key>, <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-point",standard:"<key>RIGHT ARROW</key>, <key>DOWN ARROW</key>, <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-poi",standard:"<key>PAGE UP</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>",apple:"<key>FN</key> + <key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-poi",standard:"<key>PAGE DOWN</key>, <key>TAB</key>, <key>I</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>, <key>TAB</key>, <key>I</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-first-point",standard:"<key>HOME</key>, <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>, <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-last-point",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-poi-count",standard:"<key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-branch",standard:"<key>B</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-point-type",standard:"<key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-origin",standard:"<key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-curve",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>OPTION</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-curve",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>OPTION</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-graph",standard:"<key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-specific-branch",standard:"<key>1</key> - <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-adjust-playback-speed",standard:"<key>ALT</key> + <key>1</key> - <key>5</key>",apple:"<key>OPTION</key> + <key>1</key> - <key>5</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-volume",standard:"<key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-volume",standard:"<key>SHIFT</key> + <key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-announce-slider-animations",standard:"<key>A</key>"}]},slidertrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-slider-trace",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-slider-trace",standard:"<key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease",standard:"<key>LEFT ARROW</key> <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase",standard:"<key>RIGHT ARROW</key> <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-minimum",standard:"<key>HOME</key> <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key> <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-maximum",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-next-slider",standard:"<key>DOWN ARROW</key>, <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>I</key>"}]},interactivepoints:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-interactive-points",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-first-interactive-point",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-interactive-point",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-interactive-point",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x-larger",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x-larger",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y-larger",standard:"<key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y-larger",standard:"<key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-label",standard:"<key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"}]},commonactions:Nee({folders:!0,notes:!0,images:!0}),desmoscomonly:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-desmos-com-only",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog",standard:"<key>CTRL</key> + <key>/</key>",apple:"<key>COMMAND</key> + <key>/</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-a-graph",standard:"<key>CTRL</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-save-a-graph",standard:"<key>CTRL</key> + <key>S</key>",apple:"<key>COMMAND</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-a-graph",standard:"<key>CTRL</key> + <key>P</key>",apple:"<key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-account-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>A</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-help-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>H</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-language-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>L</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-share-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>S</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>S</key>"}]},braille:EH,mathquill:SI({decimalToFraction:!0})};function Nee(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-actions",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-close-a-dialog",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>E</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-expression-list",standard:"<key>CTRL</key> + <key>ALT</key> + <key>E</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-expression-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-expression",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-degrees-toggle",standard:"<key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-keypad-toggle",standard:"<key>ALT</key> + <key>K</key>",apple:"<key>CTRL</key> + <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-add-expression",standard:"<key>CTRL</key> + <key>ALT</key> + <key>X</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>X</key>"}]};return r.notes&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-note",standard:"<key>CTRL</key> + <key>ALT</key> + <key>O</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>O</key>"}),r.folders&&(e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-folder",standard:"<key>CTRL</key> + <key>ALT</key> + <key>F</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>F</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-folder",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-folder",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"}])),r.images&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-image",standard:"<key>CTRL</key> + <key>ALT</key> + <key>I</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>I</key>"}),e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-table",standard:"<key>CTRL</key> + <key>ALT</key> + <key>T</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-undo",standard:"<key>CTRL</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-redo",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-in",standard:"<key>ALT</key> + <key>+</key>",apple:"<key>CTRL</key> + <key>+</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-out",standard:"<key>ALT</key> + <key>-</key>",apple:"<key>CTRL</key> + <key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-restore-default",standard:"<key>ALT</key> + <key>0</key>",apple:"<key>CTRL</key> + <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-fit",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>Z</key>",apple:"<key>SHIFT</key> + <key>OPTION</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode",standard:"<key>CTRL</key> + <key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>OPTION</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>G</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>G</key>"}]),e}var EI=__dcg_shared_module_exports__['a']({toolSelection:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool",standard:"<key>ESC</key>"}]},graphNavigation:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-describe-object",standard:"<key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt",standard:"<key>?</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number",standard:"<key>1</key>, <key>2</key>, <key>3</key>, ..., <key>6</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-category",standard:"<key>=</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-category",standard:"<key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category",standard:"<key>]</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category",standard:"<key>[</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects",standard:"<key>ESC</key>"}]},tokenNavigator:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator",standard:"<key>CTRL</key> + <key>ALT</key> + <key>C</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>M</key>",apple:"<key>OPTION</key> + <key>SHIFT</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection",standard:"<key>SHIFT</key> + <key>ENTER</key>",apple:"<key>SHIFT</key> + <key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"}]}},nc);var _s=__dcg_shared_module_exports__['h'](X());var{For:M0,If:Bee}=_s.Components,da=class extends _s.Class{template(){return _s.createElement("table",{class:_s.const("dcg-shortcuts-table")},_s.createElement(M0,{each:this.bindFn(this.getCols)},_s.createElement("tr",null,e=>_s.createElement("th",null,()=>this.getHeader(e)))),_s.createElement(M0,{each:()=>__dcg_shared_module_exports__['D'](this.props.section().shortcuts)},_s.createElement("tbody",null,e=>_s.createElement(M0,{each:this.bindFn(this.getCols)},_s.createElement("tr",null,t=>_s.createElement("td",{didMount:i=>this.populateContent(i,e,t)},_s.createElement(Bee,{predicate:()=>!!this.getLatex(e)},()=>_s.createElement(tt,{latex:()=>this.getLatex(e),config:this.const({})}))))))))}getLatex(e){return this.props.section().shortcuts[e].latex||""}populateContent(e,t,i){let n=this.props.section().shortcuts[t];switch(i){case"heading":if(n.latex)return;n.i18nKey&&(e.innerHTML=this.props.controller().s(n.i18nKey));return;case"windows":e.innerHTML=this.replaceKey(n.standard);return;case"mac":e.innerHTML=this.replaceKey(n.apple||n.standard);return}}getHeader(e){let t=this.props.controller().s;switch(e){case"heading":return t("shared-calculator-heading-function-table-column-header");case"windows":return t("shared-calculator-heading-windows-chrome-table-column-header");case"mac":return t("shared-calculator-heading-mac-table-column-header")}}getCols(){return this.props.os?this.props.os()==="windows"?["heading","windows"]:["heading","mac"]:["heading","windows","mac"]}replaceKey(e){return e.replace(/\<key\>/g,"<span class='dcg-key-command'>").replace(/\<\/key\>/g,"</span>")}};var{If:Vy}=Mt.Components,kI=class extends Mt.Class{init(){this.controller=this.props.controller(),this.controller.state.hotkeysDialog==null&&(this.controller.state.hotkeysDialog={shortcutOS:di?"mac":"windows"})}showGeoShortcuts(){return this.controller.product==="geometry-calculator"}template(){return Mt.createElement(ic,{controller:this.props.controller},Mt.createElement("div",{id:Mt.const("dcg-hotkeys-dialog")},Mt.createElement("h1",null,()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts")),Mt.createElement("div",{class:Mt.const("dcg-hotkeys-toggle-container")},Mt.createElement(Rr,{staticConfig:this.bindFn(this.getOSOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-label-os")})),Mt.createElement("div",{class:Mt.const("dcg-hotkey-container")},Mt.createElement("div",{class:Mt.const("dcg-hotkey-section")},Mt.createElement(Vy,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection"))),Mt.createElement(Vy,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Mt.createElement(da,{controller:this.props.controller,section:this.const(EI.toolSelection),os:this.bindFn(this.getShortcutOS)})),Mt.createElement(Vy,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator"))),Mt.createElement(Vy,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Mt.createElement(da,{controller:this.props.controller,section:this.const(EI.tokenNavigator),os:this.bindFn(this.getShortcutOS)})),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-common-actions")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.commonactions),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-desmos-com-only")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.desmoscomonly),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation")),Mt.createElement(da,{controller:this.props.controller,section:()=>SI({decimalToFraction:this.controller.isDecimalToFractionEnabled()}),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-interactive-points")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.interactivepoints),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-braille")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.braille),os:this.bindFn(this.getShortcutOS)})),Mt.createElement("div",{class:Mt.const("dcg-hotkey-section")},Mt.createElement(Vy,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-text-keyboard-shortcut-geometry-navigate-graph"))),Mt.createElement(Vy,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Mt.createElement(da,{controller:this.props.controller,section:this.const(EI.graphNavigation),os:this.bindFn(this.getShortcutOS)})),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-symbols")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.common),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-audio-tracing")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.audiotrace),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-slider-trace")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.slidertrace),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-sliders")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.sliders),os:this.bindFn(this.getShortcutOS)}),Mt.createElement("h2",{class:Mt.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-tables")),Mt.createElement(da,{controller:this.props.controller,section:this.const(nc.tables),os:this.bindFn(this.getShortcutOS)})))))}getOSOptions(){return[{key:"windows",label:()=>this.controller.s("shared-calculator-button-windows-chrome"),selected:()=>this.getShortcutOS()==="windows",onSelect:()=>this.setShortcutOS("windows")},{key:"mac",label:()=>this.controller.s("shared-calculator-button-mac"),selected:()=>this.getShortcutOS()==="mac",onSelect:()=>this.setShortcutOS("mac")}]}getShortcutOS(){return this.controller.state.hotkeysDialog.shortcutOS}setShortcutOS(e){this.controller.state.hotkeysDialog.shortcutOS=e,this.unmounted||this.update()}didMount(){this.updateVisibleShortcuts()}didUnmount(){this.unmounted=!0}didUpdate(){this.updateVisibleShortcuts()}updateVisibleShortcuts(){let e=this.getShortcutOS(),t=document.querySelector(".dcg-os-mac"),i=document.querySelector(".dcg-os-windows");!t||!i||(e==="mac"?(t.style.display="block",i.style.display="none"):e==="windows"&&(t.style.display="none",i.style.display="block"))}};var eo=__dcg_shared_module_exports__['h'](X());var GI=class extends eo.Class{init(){this.controller=this.props.controller()}template(){return eo.createElement(ic,{controller:this.props.controller},eo.createElement("div",{id:eo.const("unsupported-browser")},eo.createElement("div",{id:eo.const("unsupported-browser-title"),style:eo.const("color:black; font-size:150%;")},()=>this.controller.s("account-shell-heading-unsupported-browser")),eo.createElement("div",{style:eo.const("padding:20px 0px; color:#666")},()=>this.controller.s("account-shell-text-unsupported-browser-android"),eo.createElement("br",null),eo.createElement("br",null),eo.createElement("a",{href:eo.const("https://play.google.com/store/apps/details?id=com.android.chrome")},()=>this.controller.s("account-shell-link-download-chrome"),eo.createElement("br",null),eo.createElement("br",null)),eo.createElement("div",{style:eo.const("text-align: center; margin-top: 25px; margin-bottom:-16px")},eo.createElement("a",{role:eo.const("link"),tabindex:eo.const("0"),class:eo.const("dcg-btn dcg-action-hide dcg-do-not-blur"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-hide-browser-warning"))))))}};var to=__dcg_shared_module_exports__['h'](X());var je=__dcg_shared_module_exports__['h'](X());var ai=__dcg_shared_module_exports__['h'](X());var II=class extends ai.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return ai.createElement("div",{class:ai.const("dcg-shared-delete-account dcg-shared-account-settings-section")},ai.createElement("h1",{class:ai.const("dcg-shared-left-align-title")},()=>this.i18n.s("shared-title-delete-account")),ai.createElement("div",{class:ai.const("dcg-shared-account-paragraph")},ai.createElement(Wi,{key:this.const("shared-message-delete-account-notice"),i18n:this.props.controller},ai.const("When you delete your account,"),ai.const(" "),ai.createElement("b",null,ai.const("we will retain your data for 30 days.")),ai.const(" "),ai.const("You can reactivate your account at any time during those 30 days by logging back in."),ai.const(" "),ai.const("If there's something about Desmos we can improve, please"),ai.const(" "),ai.createElement("a",{href:ai.const("mailto:support@desmos.com"),class:ai.const("dcg-shared-blue-link")},ai.const("let us know.")))),ai.createElement("div",{class:ai.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-delete-account-will-send-email",{email:this.i18n.raw(this.controller.userController.getEmail())})),ai.createElement("form",{onSubmit:this.bindFn(this.onSubmit)},ai.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),ai.createElement("div",{class:ai.const("dcg-shared-modal-actions-container")},ai.createElement("div",{role:ai.const("link"),tabindex:ai.const(0),class:ai.const("dcg-shared-dark-gray-link"),onTap:()=>(this.controller.logJSON("shared-delete-account",{action:"cancel-delete-account"}),this.props.hideForm())},()=>this.i18n.s("shared-button-cancel")),ai.createElement("button",{class:()=>({"dcg-shared-btn-red":!0,"dcg-disabled":this.disabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:ai.const("submit")},()=>this.i18n.s("shared-button-send-delete-account-email")))))}onAccountDeleted(){return this.props.submitForm()}onAccountDeletionFailed(){if(this.formErrors=[this.controller.getSomethingWentWrongText()],!this.unmounted)return this.update()}doDeleteAccount(){this.disabled||(this.controller.logJSON("shared-delete-account",{action:"send-delete-account-email"}),this.controller.userController.initiateAccountDeletion({lang:this.controller.getLanguage()}).then(this.bindFn(this.onAccountDeleted),this.bindFn(this.onAccountDeletionFailed)))}didUnmount(){return this.unmounted=!0}onSubmit(e){e.preventDefault(),this.doDeleteAccount()}};var Zt=__dcg_shared_module_exports__['h'](X());var{If:A0}=Zt.Components,Ty=0,kH=1,Kee=2,GH=3,VI=class extends Zt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formStatus=Ty,this.emailDisabled=null}template(){return Zt.createElement("div",{class:Zt.const("dcg-shared-email-field-container")},Zt.createElement(A0,{predicate:()=>this.formStatus===Ty},()=>Zt.createElement("div",{class:Zt.const("dcg-shared-email-field")},Zt.createElement("div",{class:Zt.const("dcg-shared-profile-info-container")},Zt.createElement("span",{class:Zt.const("dcg-shared-profile-info-title"),role:Zt.const("heading"),"aria-level":Zt.const("1")},()=>this.i18n.s("shared-title-email-settings")),Zt.createElement("div",{class:Zt.const("dcg-shared-profile-info-content")},()=>this.i18n.raw(this.controller.userController.getEmail()),Zt.createElement("div",{class:Zt.const("dcg-shared-message-container")},Zt.createElement("div",{role:Zt.const("link"),tabindex:Zt.const(0),class:Zt.const("dcg-shared-blue-link"),onTap:()=>this.setFormStatus(kH)},()=>this.i18n.s("shared-button-change-email-address"))))))),Zt.createElement(A0,{predicate:()=>this.formStatus===kH},()=>Zt.createElement("div",{class:Zt.const("dcg-shared-change-email-container")},Zt.createElement("div",{class:Zt.const("dcg-shared-change-email-description")},()=>this.i18n.s("shared-message-email-settings-will-send-email",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),Zt.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),Zt.createElement("div",{class:Zt.const("dcg-shared-modal-actions-container")},Zt.createElement("span",{role:Zt.const("link"),tabindex:Zt.const(0),class:Zt.const("dcg-shared-dark-gray-link"),onTap:()=>this.setFormStatus(Ty)},()=>this.i18n.s("shared-button-cancel")),Zt.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.emailDisabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:Zt.const("submit"),onTap:()=>this.emailDisabled||this.sendChangeEmail()},()=>this.i18n.s("shared-button-send-email"))))),Zt.createElement(A0,{predicate:()=>this.formStatus===GH},()=>Zt.createElement("div",{"aria-live":Zt.const("assertive"),"aria-atomic":Zt.const("true"),class:Zt.const("dcg-shared-confirmation-message-container")},Zt.createElement("div",{class:Zt.const("dcg-shared-confirmation-message")},Zt.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Zt.const("true")}),()=>this.i18n.s("shared-message-email-sent")),Zt.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}didUnmount(){this.unmounted=!0}setToast(e){this.toastMessage||(this.toastMessage=e,this.unmounted||this.update(),setTimeout(()=>{this.toastMessage=null,this.unmounted||this.update()},5e3),this.formStatus===Kee&&setTimeout(()=>{this.setFormStatus(Ty),this.unmounted||this.update()},5200))}setFormStatus(e){this.formStatus=e,this.toastMessage=null,this.formErrors=[],this.update()}onEmailSent(){this.formStatus=GH,this.emailDisabled=null,this.unmounted||this.update(),setTimeout(()=>{this.formStatus=Ty,this.unmounted||this.update()},5e3),setTimeout(()=>{this.formStatus=Ty,this.unmounted||this.update()},5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.emailDisabled=null,this.unmounted||this.update()}sendChangeEmail(){this.emailDisabled=!0,this.unmounted||this.update(),this.controller.userController.initiateEmailChange({lang:this.controller.getLanguage()}).then(this.bindFn(this.onEmailSent),this.bindFn(this.onEmailSendingFailed))}};var{If:VH,Input:P0,Switch:Uee,SwitchUnion:Hee}=je.Components,L0=0,IH=1,O0=2,TI=class extends je.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.deleteAccount=L0}template(){return je.createElement("div",{class:je.const("dcg-shared-profile-info dcg-shared-account-settings-section")},je.createElement(Uee,{key:()=>this.deleteAccount},e=>{switch(e){case L0:return je.createElement("div",null,je.createElement("div",{class:je.const("dcg-shared-email-form-container")},je.createElement(_0,{controller:this.props.controller})),je.createElement(VI,{controller:this.props.controller}),je.createElement("div",{role:je.const("link"),tabindex:je.const(0),class:je.const("dcg-shared-dark-gray-link dcg-shared-delete-link"),onTap:()=>this.confirmDeletion()},()=>this.i18n.s("shared-button-delete-account-question")));case IH:return je.createElement(II,{hideForm:()=>this.setDeleteAccount(L0),submitForm:()=>this.setDeleteAccount(O0),controller:this.props.controller});case O0:return je.createElement("div",{"aria-live":je.const("assertive"),"aria-atomic":je.const("true"),class:je.const("dcg-shared-confirmation-message-container")},je.createElement("div",{class:je.const("dcg-shared-confirmation-message")},je.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":je.const("true")}),()=>this.i18n.s("shared-message-email-sent")),je.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-delete-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))}}))}didUnmount(){this.unmounted=!0}setDeleteAccount(e){this.deleteAccount=e,e===O0&&setTimeout(()=>{this.controller.userController.logout().then(()=>this.controller.dispatch({type:"close-modal"}))},5e3),this.unmounted||this.update()}confirmDeletion(){this.controller.logJSON("shared-profile-info",{action:"delete-account"}),this.setDeleteAccount(IH),this.unmounted||this.update()}},_0=class extends je.Class{init(){this.controller=this.props.controller();let e=this.controller.userController.getNameDetail();e.source=="legacy"?this.state={state:"legacy",name:e.given,previousName:e.given}:e.source=="parsed"?this.state={state:"name-detail",confirm:!0,given:e.given,family:e.family||"",previousGiven:"",previousFamily:""}:this.state={state:"name-detail",confirm:!1,given:e.given,family:e.family||"",previousGiven:e.given,previousFamily:e.family||""}}template(){return Hee("state",()=>this.state)({legacy:e=>je.createElement(F0,{state:e,controller:this.props.controller,onSaveName:this.bindFn(this.onSaveName),showSavedNotice:()=>this.showSavedNotice,updateState:t=>{this.state.state=="legacy"&&(this.state=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.state),t),this.unmounted||this.update())}}),"name-detail":e=>je.createElement(R0,{state:e,controller:this.props.controller,showSavedNotice:()=>this.showSavedNotice,onSaveName:this.bindFn(this.onSaveName),updateState:t=>{this.state.state=="name-detail"&&(this.state=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.state),t),this.unmounted||this.update())}})})}onSaveName(){switch(this.state.state){case"legacy":this.controller.userController.setNameLegacy({name:this.state.name,lang:this.controller.getLanguage()}).then(this.bindFn(this.onSaved));break;case"name-detail":this.controller.userController.setNameDetail({given:this.state.given,family:this.state.family,lang:this.controller.getLanguage()}).then(this.bindFn(this.onSaved));break}}maybeUpdate(){this.unmounted||this.update()}onSaved(){switch(this.state.state){case"legacy":this.state.previousName=this.state.name;break;case"name-detail":this.state.previousGiven=this.state.given,this.state.previousFamily=this.state.family,this.state.confirm=!1;break}this.showSavedNotice=!0,this.maybeUpdate(),setTimeout(()=>{this.showSavedNotice=!1,this.maybeUpdate()},3e3)}willUnmount(){this.unmounted=!0}didMount(){this.unmounted=!1}},F0=class extends je.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return je.createElement("div",{class:je.const("dcg-shared-name-field")},je.createElement("div",{class:je.const("dcg-shared-profile-info-container")},je.createElement("span",{class:je.const("dcg-shared-profile-info-title"),role:je.const("heading"),"aria-level":je.const("1")},()=>this.i18n.s("shared-label-name")),je.createElement(P0,{type:je.const("text"),name:je.const("name"),class:je.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:this.bindFn(this.onNameInput),"aria-label":()=>this.i18n.s("shared-label-name"),value:()=>this.props.state().name,autocomplete:je.const("off")})),je.createElement("div",{class:je.const("dcg-shared-modal-actions-container")},je.createElement(MI,{showSavedNotice:this.props.showSavedNotice,i18n:this.props.controller}),je.createElement("div",{role:je.const("button"),"aria-disabled":this.bindFn(this.nameFieldDisabled),tabindex:()=>this.nameFieldDisabled()?"-1":"0",class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.nameFieldDisabled()}),onTap:this.bindFn(this.onSaveName)},()=>this.i18n.s("shared-button-save"))))}onNameInput(e){this.props.updateState({name:e})}didMountName(e){fc||e.focus()}onSaveName(){this.nameFieldDisabled()||this.props.onSaveName()}nameFieldDisabled(){let e=this.props.state();return!e.name||e.name===e.previousName}},R0=class extends je.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return je.createElement("div",{class:je.const("dcg-shared-name-field")},je.createElement("div",{class:()=>({"dcg-shared-confirm-name":this.props.state().confirm})},je.createElement(VH,{predicate:()=>this.props.state().confirm},()=>je.createElement("span",null,()=>this.i18n.s("shared-message-please-review-name"))),je.createElement("div",{class:je.const("dcg-shared-profile-info-container")},je.createElement("div",{class:je.const("dcg-shared-name-input")},je.createElement("span",{class:je.const("dcg-shared-profile-info-title"),role:je.const("heading"),"aria-level":je.const("1")},()=>this.i18n.s("shared-label-given-name-or-nickname")),je.createElement(P0,{type:je.const("text"),name:je.const("given-name"),class:je.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:e=>this.props.updateState({given:e}),"aria-label":()=>this.i18n.s("shared-label-given-name-or-nickname"),value:()=>this.props.state().given,autocomplete:je.const("off")})),je.createElement("div",{class:je.const("dcg-shared-name-input")},je.createElement("span",{class:je.const("dcg-shared-profile-info-title"),role:je.const("heading"),"aria-level":je.const("1")},()=>this.i18n.s("shared-label-family-name")),je.createElement(P0,{type:je.const("text"),name:je.const("family-name"),class:je.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),onInput:e=>this.props.updateState({family:e}),"aria-label":()=>this.i18n.s("shared-label-family-name"),value:()=>this.props.state().family,autocomplete:je.const("off")}))),je.createElement("div",{class:je.const("dcg-shared-modal-actions-container")},je.createElement(MI,{i18n:this.props.controller,showSavedNotice:this.props.showSavedNotice}),je.createElement("div",{role:je.const("button"),"aria-disabled":()=>!this.canSubmit(),tabindex:()=>this.canSubmit()?"0":"-1",class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.canSubmit()}),onTap:this.bindFn(this.onSaveName)},()=>this.props.state().confirm?this.i18n.s("shared-button-confirm-name"):this.i18n.s("shared-button-save")))))}didMountName(e){fc||e.focus()}onSaveName(){this.canSubmit()&&this.props.onSaveName()}canSubmit(){let e=this.props.state();return e.given?e.confirm?!0:!(e.given===e.previousGiven&&e.family===e.previousFamily):!1}},MI=class extends je.Class{template(){return je.createElement(VH,{predicate:()=>this.props.showSavedNotice()},()=>je.createElement("span",{"aria-live":je.const("assertive"),"aria-atomic":je.const("true"),class:je.const("dcg-shared-confirmation-message")},je.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":je.const("true")}),()=>this.props.i18n().s("shared-message-information-saved")))}};var fn=__dcg_shared_module_exports__['h'](X());var{If:TH}=fn.Components,qee=0,N0=1,MH=2,AI=class extends fn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.mode=N0,this.formErrors=[]}template(){return fn.createElement("div",{class:fn.const("dcg-shared-change-password dcg-shared-account-settings-section")},fn.createElement(TH,{predicate:()=>this.mode===N0},()=>fn.createElement("div",{class:fn.const("dcg-shared-reset-by-email")},fn.createElement("div",{class:fn.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-change-password-email-sent",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),fn.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),fn.createElement("div",{class:fn.const("dcg-shared-modal-actions-container")},fn.createElement("div",{role:fn.const("button"),"aria-disabled":()=>this.emailDisabled,tabindex:()=>this.emailDisabled?"-1":"0",class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.emailDisabled}),onTap:()=>this.sendResetPasswordEmail()},()=>this.i18n.s("shared-button-send-email"))))),fn.createElement(TH,{predicate:()=>this.mode===MH},()=>fn.createElement("div",{"aria-live":fn.const("assertive"),"aria-atomic":fn.const("true"),class:fn.const("dcg-shared-confirmation-message-container")},fn.createElement("div",{class:fn.const("dcg-shared-confirmation-message")},fn.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":fn.const("true")}),()=>this.i18n.s("shared-message-email-sent")),fn.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-password-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}didUnmount(){this.unmounted=!0}onEmailSent(){this.mode=MH,this.unmounted||this.update(),setTimeout(()=>{this.mode=qee,this.unmounted||this.update()},5e3),setTimeout(()=>{this.mode=N0,this.unmounted||this.update()},5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.unmounted||this.update()}sendResetPasswordEmail(){this.controller.userController.recoverPassword({email:this.controller.userController.getEmail(),lang:this.controller.getLanguage()}).then(this.bindFn(this.onEmailSent),this.bindFn(this.onEmailSendingFailed))}};ct();var{For:zee,Switch:$ee}=to.Components,LI="profile-info",B0="change-password",OI=class extends to.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.settingsView=this.props.initialTab&&this.props.initialTab()||LI,this.breakPoint=660,this.measureWindow()}template(){return to.createElement(Lo,{title:()=>this.i18n.s("shared-title-account-settings"),size:this.const("wide"),showX:this.const(!0),leftAlignTitle:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},to.createElement("div",{class:to.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog")},to.createElement(zee,{each:()=>this.getTabs(),key:e=>""+e.key},to.createElement("div",{class:to.const("dcg-shared-navigation-tabs"),role:to.const("tablist")},e=>to.createElement("div",{role:to.const("tab"),tabindex:to.const("0"),"aria-selected":()=>this.settingsView===e.key,class:()=>({"dcg-shared-tab-gray-underline":!0,[e.class]:!0,"dcg-selected":this.settingsView===e.key}),onTap:()=>this.updateSettingsView(e.key)},e.label))),to.createElement("div",{class:to.const("dcg-shared-content-container")},to.createElement($ee,{key:()=>this.settingsView},e=>e===LI?to.createElement(TI,{controller:this.props.controller}):e===B0?to.createElement(AI,{controller:this.props.controller}):this.props.extraTabs?to.createElement("div",{class:to.const("dcg-shared-profile-info dcg-shared-account-settings-section")},this.props.extraTabs().createView(e)):to.createElement("span",null)))))}getTabs(){let e=[{key:LI,label:this.bindFn(this.profileTitle),class:"profile-view-button"},{key:B0,label:this.bindFn(this.passwordTitle),class:"change-password-view-button"}];return this.props.extraTabs?[...e,...this.props.extraTabs().tabs.map(({key:t,narrowLabel:i,wideLabel:n,class:o})=>({key:t,label:()=>this.windowWidth>this.breakPoint?i():n(),class:`${o}-button`}))]:e}updateSettingsView(e){this.settingsView=e,this.unmounted||this.update()}profileTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-profile-information-wide"):this.i18n.s("shared-title-profile-information-narrow")}passwordTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-change-password-wide"):this.i18n.s("shared-title-change-password-narrow")}measureWindow(){return this.windowWidth=O(window).width()}didMount(){O(window).on("resize.account-dialog",__dcg_shared_module_exports__['B'](()=>{this.measureWindow(),this.unmounted||this.update()},200))}didUnmount(){O(window).off("resize.account-dialog"),this.unmounted=!0}isProfileSelected(){return this.settingsView===LI}isChangePasswordSelected(){return this.settingsView===B0}};var gi=__dcg_shared_module_exports__['h'](X());var{Input:AH}=gi.Components,PI=class extends gi.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return gi.createElement(Lo,{title:()=>this.i18n.s("shared-title-change-email-address"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},gi.createElement("div",{class:gi.const("dcg-shared-change-email dcg-shared-account-dialog")},gi.createElement("div",{class:gi.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-set-new-email-address")),gi.createElement("form",{onSubmit:this.bindFn(this.onSubmit),method:gi.const("post"),class:gi.const("dcg-shared-email-form-container")},gi.createElement("label",null,gi.createElement("span",{class:gi.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-new-email-address")),gi.createElement(AH,{type:gi.const("email"),name:gi.const("newEmail"),class:gi.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-new-email-address"),required:gi.const("true"),didMount:e=>{fc||e.focus()},value:()=>this.newEmail,onInput:e=>{this.newEmail=e,this.unmounted||this.update()}})),gi.createElement("label",{for:gi.const("password")},gi.createElement("span",null,()=>this.i18n.s("shared-label-password")),gi.createElement(AH,{type:gi.const("password"),class:gi.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:gi.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,!this.unmounted)return this.update()}})),gi.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),gi.createElement("div",{class:gi.const("dcg-shared-sign-in-options")},gi.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1",type:gi.const("submit")},()=>this.i18n.s("shared-button-change-email-and-password"))))))}submitEnabled(){return!!(this.password&&this.newEmail)}didUnmount(){this.unmounted=!0}async onSubmit(e){if(e.preventDefault(),this.submitEnabled())try{await this.controller.userController.setEmail({changeToken:this.getChangeToken(),password:this.password,newEmail:this.newEmail,lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"}),history.replaceState(null,null,document.location.pathname)}catch(t){t.status===409?this.formErrors=["Sorry, someone has already registered with this email address."]:this.formErrors=[this.controller.getSomethingWentWrongText()],this.unmounted||this.update()}}getChangeToken(){return this.controller.userController.getEmailChangeToken()||""}};var LH="v1.9";var _I=class{constructor(e,t){var i=new wc;for(var n in t)i.config.setProperty(n,t[n]);this.controller=new hg(i);var o=new eh(e);this.controller.setEvaluator(o),o.readEvaluatorConfig=()=>({product:this.controller.getGraphSettings().config.product,beta3d:t.beta3d,evaluationMode:this.controller.isGeometry()?"geometry":"graphing",globalRandomSeed:i.randomSeed,degreeMode:i.degreeMode,restrictedFunctions:i.config.restrictedFunctions,distributions:i.config.distributions,pointsOfInterest:i.config.pointsOfInterest,plotSingleVariableImplicitEquations:i.config.plotSingleVariableImplicitEquations,plotImplicits:i.config.plotImplicits,plotInequalities:i.config.plotInequalities,sliders:i.config.sliders,actions:i.config.actions}),o.onEvaluatorResults=a=>{this.controller.dispatch({type:"on-evaluator-changes",changes:a.evaluationStates,timingData:a.timingData,eventUpdates:a.eventUpdates})};var s=new Wr;s.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=s,this.evaluator=o,this.setBlank()}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e})}tick(){this.evaluator.tick()}destroy(){this.evaluator.destroy()}};var My=class{constructor(e){this._calc=new _I(xy,EG(__dcg_shared_module_exports__['a']({},e))),this.controller=this._calc.controller,this._sharedClockBusToken=qu(()=>{this._calc.tick()})}destroy(){this._calc.destroy(),Sg(this._sharedClockBusToken);function e(o){__dcg_shared_module_exports__['k'].warn("You've destroyed this API instance. You can no longer call ."+o+"()")}for(var t={},i=this;i;)Object.getOwnPropertyNames(i).forEach(s=>t[s]=!0),i=Object.getPrototypeOf(i);for(var n in t)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){}}setExpression(e){var t=this.controller,i=t.getItemModel(e.id),n=i&&i.type,o=bG(e,n,this.controller);if(o)if(n)this.controller.dispatch({type:"set-expression-properties-from-api",id:o.id,properties:o});else{if(o.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:o})}}setExpressions(e){e.forEach(this.setExpression.bind(this))}removeExpression(e){var t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})}removeExpressions(e){e.forEach(this.removeExpression.bind(this))}getState(e){return this.controller.getState(e)}getExpressions(){var e=this.getState({stripDefaults:!1}).expressions.list;return e.map(yG)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}HelperExpression(e){var t=e&&e.latex||"",i=new Wr;return i.latex=t,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:i}}),i}resize(){}};var Ry=__dcg_shared_module_exports__['h'](X());var Tg=class{constructor(e){if(this.rootElt=e,this.eventModel=new Wr,!e)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(e){this.autoSize=e,JE(this.rootElt),this.domChangeDetector=new Dg(this.rootElt,t=>{switch(t.type){case"added":this.view=this.onCreateView(),this.onResizeView(t.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(t.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){__dcg_shared_module_exports__['k'].warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function e(o){__dcg_shared_module_exports__['k'].warn("You've destroyed this API instance. You can no longer call ."+o+"()")}for(var t={},i=this;i;)Object.getOwnPropertyNames(i).forEach(s=>t[s]=!0),i=Object.getPrototypeOf(i);for(var n in t)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(e,t){this.eventModel.triggerEvent(e,t)}observeEvent(e,t){this.eventModel.observeEvent(e,t)}unobserveEvent(e){this.eventModel.unobserveEvent(e)}};var xv=class{constructor({evaluationMode:e,additionalFunctions:t,functionDefinition:i,replaceRoundWithReciprocal:n,workerPool:o}){this._evaluations={};this._nextObjectId=0;this.store=new Kc({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1},ui:{focus:void 0}});this.evaluationMode=e,this.additionalFunctions=t,this.functionDefinition=i,this.replaceRoundWithReciprocal=n,this.workerPool=o,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=qu(()=>{this._evaluator.tick()})}isSingleExpression(){return this.evaluationMode==="singleExpressionScientific"||this.evaluationMode==="singleExpressionFourFunction"}destroy(){Sg(this._sharedClockBusToken)}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let e=this.store.getState().order;this._nextObjectId=0;let t=/^[0-9]+$/;for(let i of e)if(t.test(i)){let n=parseInt(i,10);n>=this._nextObjectId&&(this._nextObjectId=n+1)}}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearCachedBrailleValues(){for(let e of this.getExpressionOrder())this.store.set(["expressions",e,"braille"],"")}getState(){return this.store.getState()}getPersistedState(){let{expressions:e,order:t,settings:i}=this.getState();return{expressions:{list:t.map(n=>{var o=e[n];return{id:o.id,latex:o.latex,displayAsFraction:o.displayAsFraction}})},settings:i}}setState(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()}setStateFromAPI(e){let t=[],i={};e.expressions.list.forEach(n=>{t.push(n.id),i[n.id]={id:n.id,latex:n.latex,braille:"",type:"latex",displayAsFraction:!!n.displayAsFraction}}),this.setState({expressions:i,order:t,settings:e.settings,ui:{focus:void 0}})}canClear(){if(this.getNumberOfExpressions()>1)return!0;let e=this.getExpressionOrder()[0];return this.getExpressionLatex(e)!==""}clear(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})}getExpressionOrder(){return this.store.getState().order}getNumberOfExpressions(){return this.getExpressionOrder().length}getExpressionById(e){return this.getState().expressions[e]}getExpressionIndex(e){return this._indexes[e]}_getExpressionByIndex(e){let t=this.getExpressionOrder()[e];return this.getExpressionById(t)}_updateIndexes(){this._indexes={};let e=0;for(let t of this.getExpressionOrder())this._indexes[t]=e,e+=1;this._evaluate()}_usesAnsById(e){return this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")!==-1}_getPreviousExpById(e){let t=this.getExpressionIndex(e);return this._getExpressionByIndex(t-1)}createBlankAfterId(e){if(this.isSingleExpression()||!this.getExpressionById(e).latex)return;let t=this.getExpressionIndex(e),i=this.generateObjectId();this.store.shallowMutate("order",n=>{n.splice(t+1,0,i)}),this.store.shallowMutate("expressions",n=>{n[i]={id:i,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(i,!0)}conditionallyCopyPrevious(e){let t=this._getPreviousExpById(e),i=this.getExpressionById(e);t!=null&&i.latex===""&&this._usesAnsById(t.id)&&this.setLatexById(e,t.latex)}backspaceAtFrontOfId(e){if(this.getExpressionById(e).latex!==""||this.getNumberOfExpressions()===1)return;let i=this.getExpressionIndex(e);this.store.shallowMutate("order",n=>{n.splice(i,1)}),this.store.shallowMutate("expressions",n=>{delete n[e]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(i-1,0),!0)}setLatexById(e,t){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],""),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setLatexAndBrailleById(e,t,i){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],i),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setFractionEvaluation(e,t){this.store.set(["expressions",e,"displayAsFraction"],t)}setLatexOfFocusedExpression(e){let t=this.getFocusedExpressionId();t&&this.setLatexById(t,e)}isExpressionFocused(e){return this.getFocusedExpressionId()===e}getExpressionLatex(e){return this.getExpressionById(e).latex}getExpressionError(e){let t=this._evaluations[e];return t?t.error:""}getExpressionValue(e){let t=this._evaluations[e];if(t)return t.value}getExpressionAns(e){let t=this._evaluations[e];if(t)return t.ans}getExpressionAnsId(e){let t=this._evaluations[e];if(t)return t.ansId}shouldShowEvaluationForExpression(e){let t=this._evaluations[e];return t?t.showEvaluation:!1}isRationalizableConstant(e){let t=this._evaluations[e];return t?t.isRationalizableConstant:!1}canDisplayEvaluationAsFraction(e){let t=this.getExpressionValue(e);return t?__dcg_shared_module_exports__['Eb'](t):!1}_setFocusedByIndex(e,t){let i=this._getExpressionByIndex(e),n=this.store.getState().ui.focus,o=t?{type:"latex-expression",id:i.id}:void 0;if(!__dcg_shared_module_exports__['G'](n,o)){if(n){let s=n.id;this.store.deepMutate("expressions",a=>{var l=a[s];l&&(l.braille="")})}!t&&this.getFocusedExpressionId()!==i.id||this.store.shallowMutate("ui",s=>{s.focus=o})}}setFocusedById(e,t){let i=this.getExpressionIndex(e);this._setFocusedByIndex(i,t)}focusPrevById(e){let t=this.getExpressionIndex(e)-1;t>=0&&this._setFocusedByIndex(t,!0)}focusNextById(e){let t=this.getExpressionIndex(e)+1;t<this.getNumberOfExpressions()?this._setFocusedByIndex(t,!0):this.createAtEnd()}getFocusedExpression(){let e=this.getFocusedExpressionId();if(e)return this.getExpressionById(e)}getFocusedExpressionId(){let e=this.getState().ui.focus;return e&&e.id}clearFocusedExpression(){let e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let e=this.getFocusedExpression();return!!e&&!!e.latex}getLastExpression(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)}isLastExpressionEmpty(){return!!this.getLastExpression().latex}createAtEnd(){this.createBlankAfterId(this.getLastExpression().id)}focusLastExpression(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)}focusFirstExpression(){this._setFocusedByIndex(0,!0)}getDegreeMode(){return this.getState().settings.degreeMode}setDegreeMode(e){this.store.set(["settings","degreeMode"],!!e),this._evaluate()}_cleanupLatex(e){return e=__dcg_shared_module_exports__['Lb'](e),e.substr(e.length-1)==="="&&(e=e.substr(0,e.length-1)),e}_evaluate(){this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(e=>this._evaluator.addStatement({id:e,index:this.getExpressionIndex(e),latex:this._cleanupLatex(this.getExpressionLatex(e)),shouldGraph:!1,type:"statement"}))}_setupEvaluator(){this._evaluator=new eh(this.workerPool),this._evaluator.readEvaluatorConfig=()=>({degreeMode:this.getDegreeMode(),evaluationMode:this.evaluationMode,additionalFunctions:this.additionalFunctions,functionDefinition:this.functionDefinition,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,actions:!1}),this._evaluator.onEvaluatorResults=e=>{let t=e.evaluationStates;this._evaluations={};for(let o in t){let s=t[o];if(!this.getExpressionById(o))continue;let l=s.constant_value;l===void 0&&s.zero_values&&s.zero_values.length&&(l=s.zero_values[0].val);let c=s.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['Eb'](s.constant_value),u=!s.is_evaluable&&c,p=!!s.is_evaluable||u||Array.isArray(l);this._evaluations[o]={error:s.error,ans:void 0,ansId:void 0,value:l,showEvaluation:p,isRationalizableConstant:u}}let i,n;for(let o of this.getExpressionOrder()){let s=this._evaluations[o];if(i&&s){let a=i.value;typeof a=="number"?(s.ans=a,s.ansId=n):Array.isArray(a)&&(s.ans="[...]")}i=s,n=o}typeof this.onEvaluationUpdate=="function"&&this.onEvaluationUpdate()}}reloadState(){this.setState(this.getState())}getFunctionDefinition(){return!!this.functionDefinition}enableFunctionDefinition(){this.functionDefinition=!0,this.reloadState()}disableFunctionDefinition(){this.functionDefinition=!1,this.reloadState()}getReplaceRoundWithReciprocal(){return!!this.replaceRoundWithReciprocal}enableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!0,this.reloadState()}disableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!1,this.reloadState()}};zl();var vv=class{constructor(e,t){this.keyboardMode="main";this.fontSize=16;this.invertedColors=!1;this.backgroundColor="";this.textColor="";this.projectorMode=!1;this.capExpressionSize=!1;this.decimalToFraction=!0;this.settingsMenu=!0;this.settingsMenuOpen=!1;this.language="en";this.brailleMode="none";this.sixKeyInput=!1;this.brailleControls=!0;this.brailleExpressionDownload=!0;this.replaceCommaWith10Exp=!1;this.typingAsteriskWritesTimesSymbol=!1;this.stateStack=new Au;this.dispatcher=new Fd;this.s=bc(()=>this.language);this.dispatch=e=>{jh("dispatch",{type:e.type}),this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];this.stateStack=new Au,this.dispatcher=new Fd,this.options=e,this.model=new xv({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,functionDefinition:this.options.functionDefinition,replaceRoundWithReciprocal:this.options.replaceRoundWithReciprocal,workerPool:t.workerPool}),this.model=this.model,this.model.setDegreeMode(e.degreeMode),this.setLanguage(e.language),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setBrailleControls(e.brailleControls),this.setBrailleExpressionDownload(e.brailleExpressionDownload),this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp),this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFraction(e.decimalToFraction),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=()=>this.dispatch({type:"render"}),this.settingsProxy=t.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getFunctionDefinition(){return this.options.functionDefinition}getSettingsMenu(){return this.settingsMenu}getBrailleMode(){return this.brailleMode}renderAsBraille(){return this.brailleMode!=="none"}setBrailleMode(e){this.brailleMode=e}getSixKeyInput(){return this.sixKeyInput}setSixKeyInput(e){this.sixKeyInput=e}getBrailleControls(){return this.brailleControls}setBrailleControls(e){this.brailleControls=e}getBrailleExpressionDownload(){return this.brailleExpressionDownload}setBrailleExpressionDownload(e){this.brailleExpressionDownload=e}getRestrictedEditing(){return this.options.restrictedEditing}getKeyboardMode(){return this.keyboardMode}getFontSize(){return this.fontSize}getInvertedColors(){return this.invertedColors}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){let e=__dcg_shared_module_exports__['O'](this.backgroundColor||"#fff");return this.getInvertedColors()&&e!=="#ffffff"?__dcg_shared_module_exports__['R'](e):e}getTextColor(){let e=__dcg_shared_module_exports__['O'](this.textColor||"#000");return this.getInvertedColors()&&e!=="#000000"?__dcg_shared_module_exports__['R'](e):e}getAdditionalFunctions(){return this.options.additionalFunctions}getTypingSlashWritesDivisionSymbol(){return this.options.typingSlashWritesDivisionSymbol}setTypingAsteriskWritesTimesSymbol(e){this.typingAsteriskWritesTimesSymbol=e}getTypingAsteriskWritesTimesSymbol(){return this.typingAsteriskWritesTimesSymbol}setProjectorMode(e){this.projectorMode=e}isProjectorMode(){return this.projectorMode}getReplaceCommaWith10Exp(){return this.replaceCommaWith10Exp}setReplaceCommaWith10Exp(e){this.replaceCommaWith10Exp=e}getReplaceRoundWithReciprocal(){return this.model.getReplaceRoundWithReciprocal()}setReplaceRoundWithReciprocal(e){e?this.model.enableReplaceRoundWithReciprocal():this.model.disableReplaceRoundWithReciprocal()}setCapExpressionSize(e){this.capExpressionSize=e}getCapExpressionSize(){return this.capExpressionSize}setDecimalToFraction(e){this.decimalToFraction=e}setLanguage(e){e!=="en"&&!QC(e)?__dcg_shared_module_exports__['k'].warn(`Translation for '${e}' isn't currently available. Using '${this.language}' instead.`):this.language=e}getLanguage(){return this.language}getDecimalToFraction(){return this.decimalToFraction}isScientificCalc(){let e=this.options.evaluationMode;return e==="scientific"||e==="singleExpressionScientific"}isFourFunctionCalc(){return this.options.evaluationMode==="fourFunction"||this.options.evaluationMode==="singleExpressionFourFunction"}getAllowLinks(){return this.options.links}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}undo(e){if(!this.canUndo())return;this.stateStack.undo();let t=this.stateStack.getState();if(!e.restoreFocus){let i={focus:void 0};t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{ui:i})}this.model.setState(t),this.enqueueEvent("change")}redo(e){if(!this.canRedo())return;this.stateStack.redo();let t=this.stateStack.getState();if(!e.restoreFocus){let i={focus:void 0};t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{ui:i})}this.model.setState(t),this.enqueueEvent("change")}clearHistory(){this.stateStack.clear()}canBackspace(){let e=this.model.getFocusedExpression();return e&&(e.latex.length>0||this.model.getNumberOfExpressions()>1)}focusLastExpression(){this.model.focusLastExpression()}shouldRender(){return this.containerSize.width>0&&this.containerSize.height>0}canClear(){return this.model.canClear()}shouldShowClear(){return this.model.shouldShowClear()}enableSettingsMenu(){this.settingsMenu=!0}disableSettingsMenu(){this.closeSettingsMenu(),this.settingsMenu=!1}closeSettingsMenu(){this.settingsMenuOpen=!1}toggleSettingsMenu(){this.settingsMenuOpen=!this.settingsMenuOpen}isSettingsMenuOpen(){return this.settingsMenuOpen}isLastExpressionEmpty(){return this.model.isLastExpressionEmpty()}createAtEnd(){this.model.createAtEnd()}clearFocusedExpression(){this.model.clearFocusedExpression()}setLatexById(e,t){this.model.setLatexById(e,t)}setLatexAndBrailleById(e,t,i){this.model.setLatexAndBrailleById(e,t,i)}setLatexOfFocusedExpression(e){this.model.setLatexOfFocusedExpression(e)}toggleFractionEvaluationById(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)}conditionallyCopyPrevious(e){this.model.conditionallyCopyPrevious(e)}createBlankAfterId(e){this.model.createBlankAfterId(e)}backspaceAtFrontOfId(e){this.model.backspaceAtFrontOfId(e)}areStatesDifferentEnoughForUndoRedo(e,t){let i={focus:void 0};return __dcg_shared_module_exports__['G'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{ui:i}),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{ui:i}))}commitUndoRedoDebounced(){let e=this.model.getState(),t=this.stateStack.getState();if(this.areStatesDifferentEnoughForUndoRedo(e,t))return;let i=new Date().getTime();i-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=i,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let e=this.model.getState(),t=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,t)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))}updateKeyboardMode(e){this.keyboardMode=e}getFocusedMathquill(){if(this.model.getFocusedExpressionId())return it.getFocusedMathquill()}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let e=this.getFocusedMathquill();return e||(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),this.getFocusedMathquill())}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&it.canAcceptText(t,this.getCapExpressionSize(),e)&&(t.typedText(e),this.setLatexOfFocusedExpression(t.latex()),this.model.markShouldDebounceUndoRedo())}pressKeyInFocusedMathquill(e,t){if(this.getBrailleMode()!=="none")return;let i=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();i&&(e==="Up"||e==="Down"||e==="Left"||e==="Right"?it.applyArrowKeyAndReturnIfWasAtBounds(i,e,t)&&this.moveFocusInDirection(e):e==="Enter"?(t&&(t.preventDefault(),t.stopPropagation()),this.handleEnter()):e==="Backspace"?this.attemptToMoveFocusWithBackspace()||(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())):e==="Delete"?(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())):(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())))}moveFocusInDirection(e){let t=this.model.getFocusedExpressionId();t&&(e==="Up"?this.model.focusPrevById(t):e==="Down"&&this.model.focusNextById(t))}handleEnter(){if(this.model.isSingleExpression())return;let e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}attemptToMoveFocusWithBackspace(){let e=this.model.getFocusedExpression();if(!e)return!1;let{latex:t,id:i}=e;return t===""?(this.backspaceAtFrontOfId(i),!0):!1}executeCommandInFocusedMathquill(e){let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&(Rf(t,e),this.setLatexOfFocusedExpression(t.latex()))}syncPublicSettings(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("brailleControls",this.brailleControls),this.settingsProxy.setProperty("brailleExpressionDownload",this.brailleExpressionDownload),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFraction",this.decimalToFraction),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition()),this.settingsProxy.setProperty("replaceCommaWith10Exp",this.replaceCommaWith10Exp),this.settingsProxy.setProperty("replaceRoundWithReciprocal",this.model.getReplaceRoundWithReciprocal()),this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol",this.typingAsteriskWritesTimesSymbol)}hookUpDispatcher(){this.dispatcher.register(e=>{this.enqueueEvent("render");let t=!1,i=this.getRestrictedEditing();switch(e.type){case"update-options":{this.options=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.options),e.options);break}case"keypad/shift":{let a;switch(this.keyboardMode){case"qwerty":a="capitalQwerty";break;case"capitalQwerty":a="qwerty";break;case"letters":a="capitalLetters";break;case"capitalLetters":a="letters";break;default:a="qwerty"}this.updateKeyboardMode(a)}break;case"undo":i||(this.undo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"redo":i||(this.redo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"clear-history":this.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||this.clearHistory(),this.model.setStateFromAPI(e.state);break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.options.qwertyKeyboard?this.updateKeyboardMode("qwerty"):this.updateKeyboardMode("letters");break;case"functions":this.updateKeyboardMode("functions");break;case"degrees":this.model.setDegreeMode(!this.model.getDegreeMode());break;case"update-degree-mode":this.model.setDegreeMode(!!e.mode);break;case"update-font-size":var n=e.size;if(typeof n!="number"&&(n=parseInt(n,10)),isNaN(n))return;this.fontSize=n;break;case"update-inverted-colors":this.invertedColors=!!e.mode;break;case"update-background-color":this.backgroundColor=e.color;break;case"update-text-color":this.textColor=e.color;break;case"update-projector-mode":this.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":this.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":this.setDecimalToFraction(!!e.mode);break;case"update-language":this.setLanguage(e.language);break;case"set-blank":e.opts.allowUndo||this.clearHistory(),this.model.clear(),this.focusLastExpression();break;case"clear":this.model.clearFocusedExpression();break;case"set-braille-mode":let o=e.mode;o!=="nemeth"&&o!=="ueb"&&o!=="none"?__dcg_shared_module_exports__['k'].warn(`Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '${o}'.`):(this.model.clearCachedBrailleValues(),this.setBrailleMode(e.mode));break;case"set-six-key-input":this.setSixKeyInput(!!e.mode);break;case"set-braille-controls":this.setBrailleControls(!!e.value);break;case"set-braille-expression-download":this.setBrailleExpressionDownload(!!e.mode);break;case"set-replace-comma-with-10-exp":this.setReplaceCommaWith10Exp(!!e.replace);break;case"set-replace-round-with-reciprocal":this.setReplaceRoundWithReciprocal(!!e.replace);break;case"set-typing-asterisk-writes-times-symbol":this.setTypingAsteriskWritesTimesSymbol(!!e.mode);break;case"update-latex":this.model.markShouldDebounceUndoRedo(),this.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":this.model.markShouldDebounceUndoRedo(),this.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":this.model.setFocusedById(e.id,!0);break;case"focusout":this.model.setFocusedById(e.id,!1);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-prev-expression":this.moveFocusInDirection("Up");break;case"focus-next-expression":this.moveFocusInDirection("Down");break;case"focus-last-expression":this.model.focusLastExpression();break;case"insert-blank-expression":this.handleEnter();break;case"backspace-from-braille":this.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"enable-settings-menu":this.enableSettingsMenu();break;case"disable-settings-menu":this.disableSettingsMenu();break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"close-settings-menu":this.closeSettingsMenu();break;case"render":break;case"ui/container-resized":this.containerSize=e.size;break;case"toggle-fraction-evaluation":this.toggleFractionEvaluationById(e.id);break;default:return e}this.runAfterDispatch(()=>this.syncPublicSettings()),t||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously())})}getMathquillConfig(){let e=this.getAdditionalFunctions(),t=this.isFourFunctionCalc()&&(!e||e.indexOf("fraction")===-1);return{typingAsteriskWritesTimesSymbol:this.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:this.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:this.getRestrictedEditing(),autoCommands:Id({disallowFrac:t}),autoOperatorNames:$a()}}};var Tr=__dcg_shared_module_exports__['h'](X());var OH=__dcg_shared_module_exports__['h'](X()),Dr=class extends OH.Class{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}};ct();var Gn=__dcg_shared_module_exports__['h'](X());var Mg=__dcg_shared_module_exports__['h'](X());var Tl=class extends Uu{template(){return Mg.createElement("div",{class:Mg.const("dcg-keypad-control-bar dcg-do-not-blur"),role:Mg.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar")},Mg.createElement("div",{class:Mg.const("dcg-keypad-control-bar-contents")},this.children))}};var Ay=__dcg_shared_module_exports__['h'](X()),bi=class extends Ay.Class{template(){return Ay.createElement("div",{class:()=>({"dcg-keypad-control-btn":!0,"dcg-disabled":this.isDisabled(),"dcg-selected":!this.isDisabled()&&this.isSelected(),"dcg-selectable-btn":!this.isDisabled()&&this.isSelectable(),"dcg-narrow-control-btn":this.props.narrowButton&&this.props.narrowButton()}),didMount:this.bindFn(this.didMount),role:Ay.const("button"),"aria-disabled":()=>this.isDisabled()||void 0,"aria-label":()=>this.getAriaLabel(),"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":()=>!this.hasPopup()&&!this.isDisabled()&&this.isSelectable()?this.isSelected():void 0,"aria-expanded":()=>this.hasPopup()&&!this.isDisabled()?this.isSelected():void 0,tabindex:this.bindFn(this.getTabIndex)},this.children)}getTabIndex(){if(!this.isDisabled())return this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0}handleTap(e){this.isDisabled()||this.props.onTap(e)}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}hasPopup(){return this.props.ariaPopup?this.props.ariaPopup():!1}isDisabled(){return this.props.disabled?this.props.disabled():!1}isSelected(){return this.props.selected?this.props.selected():!1}isSelectable(){return this.props.selectable?this.props.selectable():!1}didMount(e){this.props.didMount&&this.props.didMount(e)}};var oc=__dcg_shared_module_exports__['h'](X());var Pr=__dcg_shared_module_exports__['h'](X());ct();var zd=__dcg_shared_module_exports__['h'](X());function Wee(){if(!kP)return!1;let r=navigator.userAgent.match(/Version\/(\d+)/);return!r||!r[1]?!1:parseFloat(r[1])<11}function PH(){return!GP&&!Wee()&&typeof document.createElement("a").download!="undefined"}function FI(){return PH()||navigator.msSaveBlob!==void 0}var ju=class extends zd.Class{init(){this.supportsDirectDownload=PH()}template(){return zd.createElement("a",{role:zd.const("button"),tabindex:()=>this.props.enabled()?0:-1,"aria-disabled":()=>!this.props.enabled(),class:()=>({"dcg-download-button":!0,"dcg-disabled":!this.props.enabled(),"dcg-braille-equations":this.props.isBraille,"dcg-svg-button":this.props.isSvg}),didMount:this.bindFn(this.didMountDownload),didUnmount:this.bindFn(this.didUnmountDownload),didUpdate:this.bindFn(this.didUpdate),download:()=>this.supportsDirectDownload?this.props.filename():void 0,onTap:e=>{if(this.supportsDirectDownload||!navigator.msSaveOrOpenBlob)return;let t=this.props.data();t&&(navigator.msSaveOrOpenBlob(t,this.props.filename()),e.preventDefault())}},zd.createElement("i",{class:zd.const("dcg-icon-download"),"aria-hidden":zd.const("true")}),zd.createElement("span",null,()=>this.props.text()))}didMountDownload(e){this.downloadLink=e,this.didUpdate()}didUnmountDownload(){this.revokeBlobURL()}didUpdate(){this.updateDownloadURL(),this.cachedObjectURL&&(this.downloadLink.href=this.cachedObjectURL)}updateDownloadURL(){if(this.revokeBlobURL(),!this.supportsDirectDownload)return;let e=this.props.data();e&&(this.cachedObjectURL=URL.createObjectURL(e))}revokeBlobURL(){this.cachedObjectURL&&URL.revokeObjectURL(this.cachedObjectURL)}};function Bn(r,e,t=!1){if(t&&(r=r.replace(/ /g,"\\ ")),e==="none")return r;let i=e==="nemeth"?Gu(r):Iu(r);return i.isError?"":qs.toBrailleAscii(i.value)}function _H(r,e){if(e==="none")return"";let t=[];t.push(Bn("Expression List",e,!0)),t.push(""),t.push("");let i="",n=r.getItemCount();for(let o=0;o<n;o++){let s=r.getItemModelByIndex(o);if(s&&!s.secret){i!==""&&s.type!=="folder"&&i!==s.folderId&&(t.push(Cv(Bn("End Folder",e,!0))),i="");let a="";switch(s.type){case"expression":if(!s.hidden){let c=RH(s.displayIndex,e);a=s.latex;let u=[],p=s.formula;if(p&&!Na(s)){if(r.shouldShowEvaluationForItem(s.id)){let g=p.zero_values&&p.zero_values.length?p.zero_values[0].val:p.constant_value;Array.isArray(g)?a+=`\\ ${g.length}\\ element\\ list`:a+=`=${g}`}else if(wd(s))u.push(Bn(`Min=${Hb(s)}`,e,!1)),u.push(Bn(`Max=${qb(s)}`,e,!1)),$b(s)&&zb(s)&&u.push(Bn(`CDF=${VD(s)}`,e,!1));else if(DD(s)){let g=xm(s);g&&(u.push(Bn(`<${__dcg_shared_module_exports__['mc'](g.lessThan,5)}`,e,!1)),u.push(Bn(`>${__dcg_shared_module_exports__['mc'](g.greaterThan,5)}`,e,!1)),u.push(Bn(`\\ne${__dcg_shared_module_exports__['mc'](g.notEqual,5)}`,e,!1)))}else if(p.is_regression&&p.regression){let g=p.regression,h=g.statistics,b=g.parameters;h.hasOwnProperty("Rsquared")&&u.push(Bn(`R^2=${Gl(g,"Rsquared")}`,e,!1)),h.hasOwnProperty("rsquared")&&u.push(Bn(`r^2=${Gl(g,"rsquared")}`,e,!1)),h.hasOwnProperty("r")&&u.push(Bn(`r=${Gl(g,"r")}`,e,!1)),h.hasOwnProperty("RMSE")&&u.push(Bn(`\\operatorname{RMSE}=${Gl(g,"RMSE")}`,e,!1));for(let C in b)u.push(Bn(`${C}=${tk(g,C)}`,e,!1))}}t.push(`${c}  ${Bn(a,e,!1)}`),t.push.apply(t,u)}break;case"text":t.push(Bn(s.text,e,!0));break;case"folder":s.collapsed?a=`Collapsed Folder ${s.title}`:(a=`Start Folder ${s.title}`,i=s.id),t.push(Cv(Bn(a,e,!0)));break;case"image":t.push(Bn("Image",e,!1));break;case"table":t.push(Cv(Bn("Start Table",e,!0)));for(let c=0;c<wa(s);c++){let u=[],p;for(let h=0;h<ef(s);h++)c===0?p=s.columnModels[h].latex||"":p=tw(s,c-1,h),u.push(Bn(p,e));let g=u.join("	");/^\t/.test(g)||t.push(g)}t.push(Cv(Bn("End Table",e,!0)));break;default:return s}}}return i!==""&&t.push(Cv(Bn("End Folder",e,!0))),t.join(`
`)}function FH(r,e){if(e==="none")return"";let t=[];t.push(Bn("Expression List",e,!0)),t.push(""),t.push("");for(let i of r.getExpressionOrder()){let n=RH(r.getExpressionIndex(i)+1,e),o=r.getExpressionLatex(i),s=r.getExpressionValue(i);s!==void 0&&(o+=`=${s}`),t.push(`${n}  ${Bn(o,e,!1)}`)}return t.join(`
`)}function Cv(r){let e="--------------------";return`${e}
${r}
${e}`}function RH(r,e){let t=""+r;return e==="nemeth"?`${Bn(t,e,!1)}_4`:e==="ueb"?Bn(`${t}.`,e,!1):""}var{If:RI}=Pr.Components,NI=class extends Dr{template(){return Pr.createElement("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-point-left":this.controller.containerSize.height<=420}),role:Pr.const("region"),"aria-label":Pr.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},Pr.createElement("div",{class:Pr.const("dcg-popover-interior"),style:()=>({background:this.controller.getBackgroundColor()})},Pr.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0})},Pr.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),Pr.createElement(Gt,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast")},Pr.createElement("span",{class:Pr.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-reverse-contrast"))),Pr.createElement(RI,{predicate:()=>this.controller.getBrailleControls()},()=>Pr.createElement("div",null,Pr.createElement(Gt,{onChange:this.bindFn(this.onToggleBrailleMode),checked:()=>this.controller.renderAsBraille(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-braille-mode")},Pr.createElement("span",{class:Pr.const("dcg-checkbox-label")},()=>this.controller.s("shared-calculator-narration-braille-mode"))),Pr.createElement(RI,{predicate:()=>this.controller.renderAsBraille()},()=>Pr.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-braille-container":!0})},Pr.createElement(Rr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)}),Pr.createElement("div",{class:Pr.const("dcg-braille-options-container")},Pr.createElement(Gt,{onChange:()=>this.onToggleSixKeyInput(),checked:()=>this.controller.getSixKeyInput(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-six-key-checkbox")},Pr.createElement("span",{class:Pr.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-six-key-input"))),Pr.createElement("a",{href:Pr.const("accessibility#braille"),class:Pr.const("dcg-six-key-info"),target:Pr.const("_blank")},Pr.createElement("i",{class:Pr.const("dcg-icon-question-sign"),"aria-hidden":Pr.const("true")})),Pr.createElement(RI,{predicate:()=>!_l&&FI()&&this.controller.getBrailleExpressionDownload()},()=>Pr.createElement(ju,{data:()=>{let e=FH(this.model,this.controller.getBrailleMode());return new Blob([e],{type:"text/plain"})},enabled:this.const(!0),filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("basic-calculator-link-download-braille-equations"),isBraille:this.const(!0)}))))))),Pr.createElement(RI,{predicate:()=>!!this.getVersionNumber()},()=>Pr.createElement("div",{class:Pr.const("dcg-version-number")},Pr.const("Version: "),()=>this.getVersionNumber()))))}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.isNemeth(),onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>!this.isNemeth(),onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"update-projector-mode",mode:e})}getVersionNumber(){let e=window;if(e&&e.AppBridge)return e.AppBridge.versionNumber}didUnmountSettingsDropdown(){O(document).off(".dcg-settings-view")}didMountSettingsDropdown(e){this.settingsGroupNode=e,O(document).on("dcg-tapstart.dcg-settings-view",t=>{t.target.closest(".dcg-basic-settings-container")||this.controller.dispatch({type:"close-settings-menu"})}),O(document).on("keydown.dcg-settings-view",t=>{if(Re(t)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),Re(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=document.activeElement,n=this.props.settingsButtonNode(),o=[...this.settingsGroupNode.querySelectorAll(".dcg-settings-menu-option")].slice(-1)[0];!t.shiftKey&&i===o?(n.focus(),t.preventDefault(),t.stopPropagation()):t.shiftKey&&i===n&&(o.focus(),t.preventDefault(),t.stopPropagation())}})}onToggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.renderAsBraille()?"none":"nemeth"})}isNemeth(){return this.controller.getBrailleMode()==="nemeth"}isUEB(){return this.controller.getBrailleMode()==="ueb"}isLatex(){return this.controller.getBrailleMode()==="none"}onToggleSixKeyInput(){let e=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",mode:e})}onToggleInvertedColors(){let e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})}getProjectorMode(){return this.controller.isProjectorMode()}};var{If:jee}=oc.Components,Ly=class extends Dr{template(){let r=this.props.controller();return oc.createElement("div",{class:oc.const("dcg-basic-settings-container")},oc.createElement(bi,{didMount:e=>this.settingsButtonNode=e,command:this.const("settings"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),selected:()=>this.controller.isSettingsMenuOpen(),ariaPopup:this.const(!0)},oc.createElement("i",{class:oc.const("dcg-icon-wrench"),"aria-hidden":oc.const("true")})),oc.createElement(jee,{predicate:()=>this.controller.isSettingsMenuOpen()},()=>oc.createElement(NI,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var{If:Dv,IfElse:Jee}=Gn.Components,BI=class extends Dr{template(){let r=this.props.controller();return Gn.createElement(Tl,{controller:this.props.controller},Gn.createElement(Dv,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Gn.createElement(bi,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Gn.createElement("i",{class:Gn.const("dcg-icon-undo"),"aria-hidden":Gn.const("true")}))),Gn.createElement(Dv,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Gn.createElement(bi,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Gn.createElement("i",{class:Gn.const("dcg-icon-redo"),"aria-hidden":Gn.const("true")}))),Jee(()=>r.shouldShowClear(),{true:()=>Gn.createElement(bi,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),false:()=>Gn.createElement(bi,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>r.s("basic-calculator-button-controlbar-clear-all"))}),Gn.createElement(Dv,{predicate:()=>this.controller.getRestrictedEditing()},()=>Gn.createElement("div",{class:Gn.const("dcg-spacer-2")})),Gn.createElement(Dv,{predicate:()=>r.getBrailleMode()==="none"},()=>Gn.createElement(bi,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},Gn.createElement("i",{class:Gn.const("dcg-icon-delete"),"aria-hidden":Gn.const("true")}))),Gn.createElement(Dv,{predicate:()=>this.props.controller().getSettingsMenu()},()=>Gn.createElement(Ly,{controller:this.props.controller})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var ro=__dcg_shared_module_exports__['h'](X());var{If:KI}=ro.Components,UI=class extends Dr{template(){let r=this.props.controller();return ro.createElement(Tl,{controller:this.props.controller},ro.createElement(KI,{predicate:()=>!this.controller.getRestrictedEditing()},()=>ro.createElement(bi,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},ro.createElement("i",{class:ro.const("dcg-icon-undo"),"aria-hidden":ro.const("true")}))),ro.createElement(KI,{predicate:()=>!this.controller.getRestrictedEditing()},()=>ro.createElement(bi,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},ro.createElement("i",{class:ro.const("dcg-icon-redo"),"aria-hidden":ro.const("true")}))),ro.createElement(bi,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),ro.createElement(KI,{predicate:()=>this.controller.getRestrictedEditing()},()=>ro.createElement("div",{class:ro.const("dcg-spacer-2")})),ro.createElement(KI,{predicate:()=>r.getBrailleMode()==="none"},()=>ro.createElement(bi,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},ro.createElement("i",{class:ro.const("dcg-icon-delete"),"aria-hidden":ro.const("true")}))))}};var bo=__dcg_shared_module_exports__['h'](X());var Jc=__dcg_shared_module_exports__['h'](X());var Ag=class extends Uu{template(){return Jc.createElement("div",{class:()=>({"dcg-keypad-control-toggle":!0,"dcg-toggled":this.props.toggled()}),role:Jc.const("button"),tabindex:Jc.const("0"),"aria-label":this.bindFn(this.getAriaLabel),onTap:this.bindFn(this.handleTap)},Jc.createElement("div",{class:Jc.const("dcg-ctrl-toggle-option")},this.props.defaultOption),Jc.createElement("div",{class:Jc.const("dcg-ctrl-toggle-option")},this.props.toggledOption),Jc.createElement("div",{class:Jc.const("dcg-ctrl-toggle-cover"),style:()=>({background:__dcg_shared_module_exports__['Q'](this.controller.getBackgroundColor(),-.1)})}))}getAriaLabel(){let e={toggled:this.props.toggledAriaLabel(),default:this.props.defaultAriaLabel()};return this.props.toggled()?this.controller.s("shared-calculator-narration-control-toggle-switch-to-default",e):this.controller.s("shared-calculator-narration-control-toggle-switch-to-toggled",e)}handleTap(){this.props.toggled()?xe(this.props.defaultAriaLabel()):xe(this.props.toggledAriaLabel()),this.props.onTap(this.props.command())}};var{If:K0,IfElse:Yee}=bo.Components,HI=class extends Dr{template(){let r=this.props.controller();return bo.createElement(Tl,{controller:this.props.controller},bo.createElement(bi,{command:this.const("main"),selected:()=>r.getKeyboardMode()==="main",disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"}),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-main")},()=>r.s("basic-calculator-button-controlbar-main")),bo.createElement(bi,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty","letters"].indexOf(r.getKeyboardMode())!==-1,disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"})},()=>r.s("basic-calculator-button-controlbar-abc")),bo.createElement(bi,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"})},()=>r.s("basic-calculator-button-controlbar-func")),bo.createElement(Ag,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>r.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>r.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>r.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>r.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>r.dispatch({type:"degrees"}),controller:this.props.controller}),bo.createElement(K0,{predicate:()=>!this.controller.getRestrictedEditing()},()=>bo.createElement(bi,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},bo.createElement("i",{class:bo.const("dcg-icon-undo"),"aria-hidden":bo.const("true")}))),bo.createElement(K0,{predicate:()=>!this.controller.getRestrictedEditing()},()=>bo.createElement(bi,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},bo.createElement("i",{class:bo.const("dcg-icon-redo"),"aria-hidden":bo.const("true")}))),Yee(()=>r.shouldShowClear(),{true:()=>bo.createElement(bi,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),false:()=>bo.createElement(bi,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>r.s("basic-calculator-button-controlbar-clear-all"))}),bo.createElement(K0,{predicate:()=>this.props.controller().getSettingsMenu()},()=>bo.createElement(Ly,{controller:this.props.controller})))}};var Kn=__dcg_shared_module_exports__['h'](X());var{If:BH}=Kn.Components,qI=class extends Dr{template(){let r=this.props.controller();return Kn.createElement(Tl,{controller:this.props.controller},Kn.createElement(Ag,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>r.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>r.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>r.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>r.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>r.dispatch({type:"degrees"}),controller:this.props.controller}),Kn.createElement("div",{class:Kn.const("dcg-spacer")}),Kn.createElement(BH,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Kn.createElement(bi,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Kn.createElement("i",{class:Kn.const("dcg-icon-undo"),"aria-hidden":Kn.const("true")}))),Kn.createElement(BH,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Kn.createElement(bi,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Kn.createElement("i",{class:Kn.const("dcg-icon-redo"),"aria-hidden":Kn.const("true")}))),Kn.createElement("div",{class:Kn.const("dcg-spacer")}),Kn.createElement(bi,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),Kn.createElement(bi,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},Kn.createElement("i",{class:Kn.const("dcg-icon-delete"),"aria-hidden":Kn.const("true")})))}};var $d=__dcg_shared_module_exports__['h'](X());var Sv=class extends Dr{template(){return $d.createElement("div",{role:$d.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},$d.createElement(wr,{controller:this.props.controller},$d.createElement(Ue,null,x(this,"(",{colspan:this.parenColspan()}),x(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),x(this,"division")),$d.createElement(Ue,null,x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"multiplication")),$d.createElement(Ue,null,x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"-")),$d.createElement(Ue,null,x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"+")),$d.createElement(Ue,null,x(this,"0",{style:"highlight"}),x(this,".",{style:"highlight"}),x(this,"ans"),x(this,"enter",{style:"blue"}))))}parenColspan(){return this.controller.getAdditionalFunctions().length>1?.5:1}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?x(this,"a^b"):t==="percent"?x(this,"%"):t==="sqrt"?x(this,"sqrt"):t==="fraction"?x(this,"a/b"):void 0}};var Wd=__dcg_shared_module_exports__['h'](X());var Ev=class extends Dr{template(){return Wd.createElement("div",{role:Wd.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Wd.createElement(wr,{controller:this.props.controller},Wd.createElement(Ue,null,x(this,"(",{colspan:this.parenColspan()}),x(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(1)),Wd.createElement(Ue,null,x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"division")),Wd.createElement(Ue,null,x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"multiplication")),Wd.createElement(Ue,null,x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"-")),Wd.createElement(Ue,null,x(this,"0",{style:"highlight"}),x(this,".",{style:"highlight",colspan:this.dotColspan()}),this.makeAdditionalFunctionKey(0),x(this,"+"))))}parenColspan(){return this.controller.getAdditionalFunctions().length===2?1.5:2}dotColspan(){return this.controller.getAdditionalFunctions().length?1:2}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?x(this,"a^b"):t==="percent"?x(this,"%"):t==="sqrt"?x(this,"sqrt"):void 0}};var Fs=__dcg_shared_module_exports__['h'](X());var kv=class extends Dr{template(){return Fs.createElement(wr,{controller:this.props.controller},Fs.createElement(Ue,null,x(this,"("),x(this,")"),x(this,"x^2"),x(this,"sqrt"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),x(this,"x^3"),x(this,"x^y"),x(this,"ythroot")),Fs.createElement(Ue,null,x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"division"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),x(this,"pi"),x(this,"e^x"),x(this,"!")),Fs.createElement(Ue,null,x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"multiplication"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),x(this,"log"),x(this,"ln"),x(this,"|x|")),Fs.createElement(Ue,null,x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"-"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),x(this,"sin"),x(this,"cos"),x(this,"tan")),Fs.createElement(Ue,null,x(this,"0",{style:"highlight"}),x(this,".",{style:"highlight"}),x(this,"x/y"),x(this,"+"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),x(this,"arcsin"),x(this,"arccos"),x(this,"arctan")))}};var sc=__dcg_shared_module_exports__['h'](X());var Un=__dcg_shared_module_exports__['h'](X());var{IfElse:Xee}=Un.Components,Gv=class extends Dr{template(){return Un.createElement(wr,{controller:this.props.controller},Un.createElement(Ue,null,x(this,"a^2"),x(this,"a^b"),x(this,"|a|"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"division"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"%"),x(this,"a/b")),Un.createElement(Ue,null,x(this,"sqrt"),x(this,"nthroot"),x(this,"pi"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"multiplication"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"left",{style:"highlight"}),x(this,"right",{style:"highlight"})),Un.createElement(Ue,null,x(this,"sin"),x(this,"cos"),x(this,"tan"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"-"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),ji(.5),x(this,"backspace",{style:"highlight",colspan:1.5})),Un.createElement(Ue,null,x(this,"("),x(this,")"),Xee(()=>this.controller.getReplaceCommaWith10Exp(),{true:()=>x(this,"10^n"),false:()=>x(this,",")}),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"0",{style:"highlight"}),x(this,".",{style:"highlight"}),x(this,"ans"),x(this,"+"),Un.createElement("div",{class:Un.const("dcg-partition-placeholder")}),x(this,"enter",{style:"blue",colspan:2})))}};var Yc=__dcg_shared_module_exports__['h'](X());var Iv=class extends Dr{template(){return Yc.createElement(wr,{controller:this.props.controller},Yc.createElement(Ue,null,x(this,"q"),x(this,"w"),x(this,"e"),x(this,"r"),x(this,"t"),x(this,"y"),x(this,"u"),x(this,"i"),x(this,"o"),x(this,"p")),Yc.createElement(Ue,null,Yc.createElement("div",{class:Yc.const("dcg-half-width-placeholder")}),x(this,"a"),x(this,"s"),x(this,"d"),x(this,"f"),x(this,"g"),x(this,"h"),x(this,"j"),x(this,"k"),x(this,"l"),Yc.createElement("div",{class:Yc.const("dcg-half-width-placeholder")})),Yc.createElement(Ue,null,x(this,"=",{style:"highlight"}),x(this,"z"),x(this,"x"),x(this,"c"),x(this,"v"),x(this,"b"),x(this,"n"),x(this,"m"),x(this,","),x(this,"backspace",{style:"highlight"})),Yc.createElement(Ue,null,x(this,"shift",{style:"highlight",colspan:1.5}),x(this,"("),x(this,")"),x(this,"["),x(this,"]"),x(this,"!"),x(this,"'"),x(this,"pi"),x(this,"enter",{style:"blue",colspan:1.5})))}};var Oy=__dcg_shared_module_exports__['h'](X());var Vv=class extends Dr{template(){return Oy.createElement(wr,{controller:this.props.controller},Oy.createElement(Ue,null,x(this,"a"),x(this,"b"),x(this,"c"),x(this,"d"),x(this,"e"),x(this,"f"),x(this,"g"),x(this,"h"),x(this,"i"),x(this,"j")),Oy.createElement(Ue,null,x(this,"k"),x(this,"l"),x(this,"m"),x(this,"n"),x(this,"o"),x(this,"p"),x(this,"q"),x(this,"r"),x(this,"s"),x(this,"t")),Oy.createElement(Ue,null,x(this,"=",{style:"highlight"}),x(this,","),x(this,"u"),x(this,"v"),x(this,"w"),x(this,"x"),x(this,"y"),x(this,"z"),x(this,"pi"),x(this,"backspace",{style:"highlight"})),Oy.createElement(Ue,null,x(this,"shift",{style:"highlight",colspan:2}),x(this,"("),x(this,")"),x(this,"["),x(this,"]"),x(this,"!"),x(this,"'"),x(this,"enter",{style:"blue",colspan:2})))}};var Xc=__dcg_shared_module_exports__['h'](X());var Tv=class extends Dr{template(){return Xc.createElement(wr,{controller:this.props.controller},Xc.createElement(Ue,null,x(this,"Q"),x(this,"W"),x(this,"E"),x(this,"R"),x(this,"T"),x(this,"Y"),x(this,"U"),x(this,"I"),x(this,"O"),x(this,"P")),Xc.createElement(Ue,null,Xc.createElement("div",{class:Xc.const("dcg-half-width-placeholder")}),x(this,"A"),x(this,"S"),x(this,"D"),x(this,"F"),x(this,"G"),x(this,"H"),x(this,"J"),x(this,"K"),x(this,"L"),Xc.createElement("div",{class:Xc.const("dcg-half-width-placeholder")})),Xc.createElement(Ue,null,x(this,"=",{style:"highlight"}),x(this,"Z"),x(this,"X"),x(this,"C"),x(this,"V"),x(this,"B"),x(this,"N"),x(this,"M"),x(this,","),x(this,"backspace",{style:"highlight"})),Xc.createElement(Ue,null,x(this,"shift",{style:"highlight",colspan:1.5}),x(this,"("),x(this,")"),x(this,"["),x(this,"]"),x(this,"!"),x(this,"'"),x(this,"pi"),x(this,"enter",{style:"blue",colspan:1.5})))}};var Py=__dcg_shared_module_exports__['h'](X());var Mv=class extends Dr{template(){return Py.createElement(wr,{controller:this.props.controller},Py.createElement(Ue,null,x(this,"A"),x(this,"B"),x(this,"C"),x(this,"D"),x(this,"E"),x(this,"F"),x(this,"G"),x(this,"H"),x(this,"I"),x(this,"J")),Py.createElement(Ue,null,x(this,"K"),x(this,"L"),x(this,"M"),x(this,"N"),x(this,"O"),x(this,"P"),x(this,"Q"),x(this,"R"),x(this,"S"),x(this,"T")),Py.createElement(Ue,null,x(this,"=",{style:"highlight"}),x(this,","),x(this,"U"),x(this,"V"),x(this,"W"),x(this,"X"),x(this,"Y"),x(this,"Z"),x(this,"pi"),x(this,"backspace",{style:"highlight"})),Py.createElement(Ue,null,x(this,"shift",{style:"highlight",colspan:2}),x(this,"("),x(this,")"),x(this,"["),x(this,"]"),x(this,"!"),x(this,"'"),x(this,"enter",{style:"blue",colspan:2})))}};var Cs=__dcg_shared_module_exports__['h'](X());var{IfElse:Qee}=Cs.Components,Av=class extends Dr{template(){return Cs.createElement("div",{class:Cs.const("dcg-sci-func-keypad")},Cs.createElement(wr,{controller:this.props.controller},Cs.createElement(Ue,null,x(this,"sin"),x(this,"cos"),x(this,"tan"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),x(this,"a^b"),x(this,"sqrt"),x(this,"nthroot")),Cs.createElement(Ue,null,x(this,"arcsin"),x(this,"arccos"),x(this,"arctan"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),x(this,"e^x"),x(this,"abs"),Qee(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>x(this,"a^{-1}"),false:()=>x(this,"round")})),Cs.createElement(Ue,null,x(this,"mean"),x(this,"stdev"),x(this,"stdevp"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),x(this,"ln"),x(this,"log"),x(this,"backspace",{style:"highlight"})),Cs.createElement(Ue,null,x(this,"nPr"),x(this,"nCr"),x(this,"!"),Cs.createElement("div",{class:Cs.const("dcg-partition-placeholder")}),x(this,"e"),x(this,"pi"),x(this,"enter",{style:"blue"}))))}};var{SwitchUnion:Zee}=sc.Components,Lv=class extends Dr{template(){return sc.createElement("div",{role:sc.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},Zee(()=>this.controller.getKeyboardMode(),{qwerty:()=>sc.createElement(Iv,{controller:this.props.controller}),letters:()=>sc.createElement(Vv,{controller:this.props.controller}),capitalQwerty:()=>sc.createElement(Tv,{controller:this.props.controller}),capitalLetters:()=>sc.createElement(Mv,{controller:this.props.controller}),functions:()=>sc.createElement(Av,{controller:this.props.controller}),main:()=>sc.createElement(Gv,{controller:this.props.controller})}))}};var Ji=__dcg_shared_module_exports__['h'](X());var Ta=__dcg_shared_module_exports__['h'](X());var{For:ete}=Ta.Components,_y=class extends Ta.Class{template(){return Ta.createElement("tr",null,Ta.createElement(ete,{each:()=>this.getBrailleAscii(this.props.latex()),key:e=>e.key},Ta.createElement("td",null,e=>Ta.createElement("span",{class:Ta.const("dcg-key-press")},()=>e.char))),Ta.createElement("td",{class:Ta.const("dcg-braille-font")},()=>this.getBrailleUnicode(this.props.latex())),Ta.createElement("td",null,Ta.createElement(tt,{config:this.const({}),latex:()=>this.props.latex()})))}getBrailleAscii(e){let t=qs.toExpandedBrailleAscii(this.getBrailleUnicode(e)),i=[];for(let n=0;n<t.length;n++)i.push({char:t[n],key:n+")"+t[n]});return i}getBrailleUnicode(e){let t;return this.props.brailleMode()==="nemeth"?t=Gu(e):this.props.brailleMode()==="ueb"&&(t=Iu(e)),t&&t.value?t.value:""}};var Lg=class extends Dr{template(){return Ji.createElement("div",{class:()=>({"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor()})},Ji.createElement("div",{class:Ji.const("dcg-braille-io-keypad")},Ji.createElement("div",{class:Ji.const("dcg-braille-description")},Ji.createElement("div",{class:Ji.const("dcg-braille-title")},()=>this.controller.s("basic-calculator-text-braille-mode-is-on",{mode:this.brailleType()})),Ji.createElement("div",{class:Ji.const("dcg-braille-info-text")},()=>this.controller.s("basic-calculator-text-how-to-type-braille")),Ji.createElement("div",{class:Ji.const("dcg-btn-primary"),role:Ji.const("button"),tabindex:Ji.const(0),onTap:()=>this.controller.dispatch({type:"set-braille-mode",mode:"none"})},()=>this.controller.s("basic-calculator-button-turn-braille-mode-off",{mode:this.brailleType()}))),Ji.createElement("div",{class:Ji.const("dcg-braille-examples-table-container")},Ji.createElement("table",{class:Ji.const("dcg-braille-examples-table")},Ji.createElement("tr",null,Ji.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-type-this")),Ji.createElement("th",null,()=>this.brailleType()),Ji.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-typeset"))),Ji.createElement(_y,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("2+2")}),Ji.createElement(_y,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\frac{1}{2}")}),Ji.createElement(_y,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\sqrt{4}")})),Ji.createElement("div",{class:Ji.const("dcg-more-examples-link")},Ji.createElement("a",{href:()=>"braille-examples?"+this.controller.getBrailleMode(),target:Ji.const("_blank")},()=>this.controller.s("basic-calculator-link-view-braille-examples"))))))}brailleType(){return this.controller.getBrailleMode()==="nemeth"?"Nemeth":this.controller.getBrailleMode()==="ueb"?"UEB":""}};var Xs=__dcg_shared_module_exports__['h'](X());var zt=__dcg_shared_module_exports__['h'](X());var{If:Ju,Input:tte,Textarea:rte}=zt.Components,Ov=class extends Dr{constructor(){super(...arguments),this.lastBrailleModeDuringFocusChange="none"}getAriaLabel(){let e=this.getIndex()+1+"";return this.s("shared-calculator-narration-expression-index",{index:e})}didUpdate(){this.renderAnsValue()}didMountMQ(e){this.mq=e}getExp(){return this.model.getExpressionById(this.props.id())}getAns(){return this.model.getExpressionAns(this.props.id())}getAnsId(){return this.model.getExpressionAnsId(this.props.id())}getLatex(){return this.getExp().latex}getValue(){return this.model.getExpressionValue(this.props.id())}getBraille(){let e=this.getExp().braille;if(e!=="")return e;{let t=Nf(this.getLatex(),this.controller.getBrailleMode());return t.isError?"":qs.toExpandedBrailleAscii(t.value)}}getIndex(){return this.model.getExpressionIndex(this.props.id())}getShowEvaluation(){return this.model.shouldShowEvaluationForExpression(this.props.id())}isFractionEvaluation(){return this.getExp().displayAsFraction}canDisplayEvaluationAsFraction(){return this.controller.getDecimalToFraction()&&this.model.canDisplayEvaluationAsFraction(this.props.id())}shouldDisplayEvaluationAsFraction(){return this.canDisplayEvaluationAsFraction()&&this.getExp().displayAsFraction}toggleFractionEvaluation(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})}getFractionDisplayAriaLabel(){return this.shouldDisplayEvaluationAsFraction()?this.controller.s("basic-calculator-narration-convert-to-decimal"):this.controller.s("basic-calculator-narration-convert-to-fraction")}getError(){let e=this.model.getExpressionError(this.props.id());return e&&this.getLatex().length>0?md(e,this.controller.getLanguage()):""}showError(){return!!this.getError()}getFractionMessage(){return this.shouldDisplayEvaluationAsFraction()?this.s("basic-calculator-label-convert-to-decimal"):this.s("basic-calculator-label-convert-to-fraction")}getIsFocused(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())}onFocusedChanged(e){let t=this.controller.getBrailleMode(),i=t!==this.lastBrailleModeDuringFocusChange;this.lastBrailleModeDuringFocusChange=t,!(!this.getExp()||i)&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))}onMQReflow(){this.renderedAnsData=void 0,this.renderAnsValue()}renderAnsValue(){if(!this.mq)return;let e=this.getAns(),t=!1,i=this.getAnsId();if(i){let n=this.model.getExpressionById(i);t=n&&n.displayAsFraction}this.renderedAnsData&&this.renderedAnsData.value==e&&this.renderedAnsData.displayAsFraction===t||(this.renderedAnsData={value:e,displayAsFraction:t},this.mq.querySelectorAll(".dcg-mq-ans").forEach(n=>{let o=n,s;typeof e=="number"?s=__dcg_shared_module_exports__['Gb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:t}):typeof e=="string"&&(s=e),s?(o.classList.remove("dcg-invalid"),o.innerText=s):(o.classList.add("dcg-invalid"),o.innerHTML='<i class="dcg-icon-error" aria-hidden="true"></i>')}))}getEvaluationLatex(){let e=this.getValue();if(e===void 0&&(e=NaN),this.model.isRationalizableConstant(this.props.id())&&!this.shouldDisplayEvaluationAsFraction())return"";let t;if(Array.isArray(e))t=`\\mathrm{${e.length}\\ element\\ list}`;else{var i=__dcg_shared_module_exports__['Hb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()});return i==="undefined"?"=\\mathrm{undefined}":"="+i}return t}getEvaluationBraille(){let e=this.getEvaluationLatex(),t=Nf(e,this.controller.getBrailleMode());return t.isError?"":qs.toExpandedBrailleAscii(t.value)}didMountBrailleInput(e){this.brailleInputNode=e}didUnmountBrailleInput(){this.brailleInputNode=void 0}handleBrailleFocus(e){let t=e.target;t&&setTimeout(()=>{t.setSelectionRange(0,0)})}handleBrailleKeydown(e){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(Re(e)===So?(this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),e.preventDefault()):Re(e)===Eo?(this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),e.preventDefault()):Re(e)===Fl?(this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),e.preventDefault()):Re(e)===ul&&document.activeElement===this.brailleInputNode&&this.getBraille()===""&&(this.dispatch({type:"backspace-from-braille"}),e.preventDefault()))}forceModelFocus(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)}focusBrailleInput(){this.brailleInputNode&&document.activeElement!==this.brailleInputNode&&this.brailleInputNode.focus()}getPostLabel(){if(this.showError())return this.getError();if(this.getShowEvaluation()){let e=this.getValue();return e===void 0&&(e=NaN),Array.isArray(e)?`${e.length} element list`:"equals "+Hs(__dcg_shared_module_exports__['Hb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()}))}return""}onBrailleInput(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});let t=WE(qs.coerceToSixDotCells(e),this.controller.getBrailleMode()),i=t.isError?"":t.value;(!this.controller.getCapExpressionSize()||wf(i)<=xf)&&this.controller.dispatch({type:"update-latex-from-braille",latex:i,braille:e,id:this.props.id()})}getIndexSubscript(){return`_{${this.getIndex()+1}}`}getEvaluationDigits(){return this.controller.isScientificCalc()?10:7}onMountContainer(e){this.containerNode=e}onTapContainer(e){e.target===this.containerNode&&!this.getShowEvaluation()&&!this.showError()&&this.forceModelFocus()}template(){return zt.createElement("div",{class:()=>({"dcg-basic-expression":!0,"dcg-focused":this.getIsFocused(),"dcg-braille-io":this.controller.renderAsBraille()}),onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer)},zt.createElement(Ju,{predicate:()=>this.controller.renderAsBraille()},()=>zt.createElement("div",{class:zt.const("dcg-braille-input")},zt.createElement(pg,{ariaLabel:()=>{let e=Nf(`eq${this.getIndexSubscript()}`,this.controller.getBrailleMode());return e.isError?"":qs.toExpandedBrailleAscii(e.value)},didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.onFocusedChanged),shouldFocus:this.bindFn(this.getIsFocused),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:this.bindFn(this.onBrailleInput),sixKeyInput:()=>this.controller.getSixKeyInput(),value:()=>this.getBraille(),isStatic:this.const(!1)}))),zt.createElement(Ju,{predicate:()=>this.controller.renderAsBraille()},()=>zt.createElement("div",{class:zt.const("dcg-braille-evaluation-container")},zt.createElement(Ju,{predicate:()=>this.getShowEvaluation()},()=>zt.createElement("div",{class:zt.const("dcg-braille-evaluation")},zt.createElement(tte,{readonly:this.const("true"),class:this.const("dcg-braille-evaluation-inner"),value:()=>this.getEvaluationBraille(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))),zt.createElement(Ju,{predicate:()=>this.showError()},()=>zt.createElement("div",{class:zt.const("dcg-braille-error")},zt.createElement("div",{class:zt.const("dcg-basic-expression-error")},zt.createElement("i",{class:zt.const("dcg-icon-error"),"aria-hidden":zt.const("true")})),zt.createElement(rte,{readonly:this.const("true"),class:this.const("dcg-braille-error-inner"),value:()=>this.getError(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))))),zt.createElement(Ju,{predicate:()=>this.controller.renderAsBraille()},()=>zt.createElement("div",{class:zt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),onTap:this.bindFn(this.forceModelFocus)},zt.createElement(tt,{latex:()=>this.getLatex(),config:this.const({}),onReflow:this.bindFn(this.onMQReflow)}))),zt.createElement(Ju,{predicate:()=>!this.controller.renderAsBraille()},()=>zt.createElement("div",{class:zt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ)},zt.createElement(it,{latex:()=>this.getLatex(),onReflow:this.bindFn(this.onMQReflow),isFocused:this.bindFn(this.getIsFocused),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel(),getAriaPostLabel:()=>this.getPostLabel(),hasError:()=>!1,onUserPressedKey:(e,t)=>{this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"}),this.dispatch({type:"keypad/press-key",key:e,evt:t})},onUserTypedText:e=>this.dispatch({type:"keypad/type-text",text:e}),onUserChangedLatex:e=>{this.dispatch({type:"update-latex",id:this.props.id(),latex:e})},onFocusedChanged:this.bindFn(this.onFocusedChanged),disableSpace:()=>this.controller.getRestrictedEditing()}))),zt.createElement("div",{class:zt.const("dcg-exp-output-container")},zt.createElement(Ju,{predicate:()=>this.showError()&&!this.controller.renderAsBraille()},()=>zt.createElement(Ke,{tooltip:this.bindFn(this.getError),gravity:this.const("w"),sticky:this.const(!0)},zt.createElement("div",{class:zt.const("dcg-basic-expression-error")},zt.createElement("i",{class:zt.const("dcg-icon-error"),"aria-hidden":zt.const("true")})))),zt.createElement(Ju,{predicate:()=>this.getShowEvaluation()},()=>zt.createElement("div",{class:()=>({"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":Array.isArray(this.getValue())})},zt.createElement(tt,{config:this.const({}),latex:()=>this.getEvaluationLatex()}),zt.createElement(Ju,{predicate:this.bindFn(this.canDisplayEvaluationAsFraction)},()=>zt.createElement(Ke,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("sw")},zt.createElement("span",{role:zt.const("button"),tabindex:zt.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation)},zt.createElement("i",{class:zt.const("dcg-icon-fraction"),"aria-hidden":zt.const("true")}))))))))}getMQConfig(){return this.controller.getMathquillConfig()}};ct();var{For:ite,If:nte}=Xs.Components,Pv=class extends Dr{constructor(){super(...arguments),this.didShowAnswerHint=!1,this.didHideAnswerHint=!1}template(){return Xs.createElement("div",{class:Xs.const("dcg-basic-list-container"),role:Xs.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list"),didMount:this.bindFn(this.didMountContainer)},Xs.createElement("div",{class:Xs.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder)},Xs.createElement(nte,{predicate:this.bindFn(this.showAnswerHint)},()=>Xs.createElement("div",{class:Xs.const("dcg-answer-hint")},()=>this.controller.s("basic-calculator-label-answer-hint"),Xs.createElement("i",{class:Xs.const("dcg-icon-curved-arrow")})))),Xs.createElement(ite,{each:()=>this.model.getExpressionOrder()},Xs.createElement("div",{class:()=>({"dcg-basic-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()})},e=>Xs.createElement(Ov,{controller:this.props.controller,id:this.const(e)}))))}didMountPlaceholder(e){O(e).on("dcg-tap",pi)}showAnswerHint(){if(this.didHideAnswerHint)return!1;let e=this.model.getExpressionOrder()[0];return this.model.shouldShowEvaluationForExpression(e)||this.didShowAnswerHint?(this.didShowAnswerHint=!0,this.model.getNumberOfExpressions()>1||this.model.getExpressionLatex(e)===""?(this.didHideAnswerHint=!0,!1):!0):!1}didUpdate(){if(!this.container)return;let e=this.container.querySelector(".dcg-focused");e&&xa(e,this.container,50)}didMountContainer(e){this.container=e}};var{If:_v,IfElse:zI}=Tr.Components,Fv=class extends Dr{template(){return Tr.createElement(_v,{predicate:()=>this.controller.shouldRender()},()=>Tr.createElement("div",{class:Tr.const("dcg-calculator-api-container"),style:Tr.const("width: 100%; height: 100%; position: relative;")},Tr.createElement("div",{class:()=>({"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":this.controller.containerSize.width<570,"dcg-short":this.controller.containerSize.height<=540,"dcg-scientific-calculator":this.controller.isScientificCalc(),"dcg-four-function-calculator":this.controller.isFourFunctionCalc(),"dcg-container":!0}),onKeydown:this.bindFn(this.handleRootKeydown),didMount:this.bindFn(this.didMountRoot),"x-ms-format-detection":Tr.const("none")},Tr.createElement("div",{role:Tr.const("application"),"aria-label":()=>this.controller.isScientificCalc()?this.controller.s("basic-calculator-narration-calc-description-scientific"):this.controller.isFourFunctionCalc()?this.controller.s("basic-calculator-narration-calc-description-fourfunction"):"",class:()=>({"dcg-calc-basic-main":!0,"dcg-inverted-colors":this.controller.getInvertedColors(),"dcg-projector-mode":this.controller.isProjectorMode(),"dcg-ipad":dl,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!this.controller.getAllowLinks()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`,background:this.controller.getBackgroundColor(),color:this.controller.getTextColor(),filter:this.controller.getInvertedColors()?"invert(100%)":"none"})},Tr.createElement(Pv,{controller:this.props.controller}),Tr.createElement(_v,{predicate:()=>this.controller.isScientificCalc()&&this.model.isSingleExpression()},()=>Tr.createElement("div",null,Tr.createElement(qI,{controller:this.props.controller}),Tr.createElement("div",{class:Tr.const("dcg-basic-keypad-container")},zI(()=>this.controller.renderAsBraille(),{true:()=>Tr.createElement(Lg,{controller:this.props.controller}),false:()=>Tr.createElement(kv,{controller:this.props.controller})})))),Tr.createElement(_v,{predicate:()=>this.controller.isScientificCalc()&&!this.model.isSingleExpression()},()=>Tr.createElement("div",null,Tr.createElement(HI,{controller:this.props.controller}),Tr.createElement("div",{class:Tr.const("dcg-basic-keypad-container")},zI(()=>this.controller.renderAsBraille(),{true:()=>Tr.createElement(Lg,{controller:this.props.controller}),false:()=>Tr.createElement(Lv,{controller:this.props.controller})})))),Tr.createElement(_v,{predicate:()=>this.controller.isFourFunctionCalc()&&this.model.isSingleExpression()},()=>Tr.createElement("div",null,Tr.createElement(UI,{controller:this.props.controller}),Tr.createElement("div",{class:Tr.const("dcg-basic-keypad-container")},zI(()=>this.controller.renderAsBraille(),{true:()=>Tr.createElement(Lg,{controller:this.props.controller}),false:()=>Tr.createElement(Ev,{controller:this.props.controller})})))),Tr.createElement(_v,{predicate:()=>this.controller.isFourFunctionCalc()&&!this.model.isSingleExpression()},()=>Tr.createElement("div",null,Tr.createElement(BI,{controller:this.props.controller}),Tr.createElement("div",{class:Tr.const("dcg-basic-keypad-container")},zI(()=>this.controller.renderAsBraille(),{true:()=>Tr.createElement(Lg,{controller:this.props.controller}),false:()=>Tr.createElement(Sv,{controller:this.props.controller})}))))))))}didMountRoot(e){mp(e)}handleRootKeydown(e){let t=Di(e),i=this.controller.model;if(Th(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(Mh(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(e.altKey!==di&&e.metaKey===di&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.getDecimalToFraction()){let n=i.getFocusedExpression();n&&i.canDisplayEvaluationAsFraction(n.id)&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:n.id}),this.controller.runAfterDispatch(()=>{i.getFocusedExpression().displayAsFraction?xe(this.controller.s("shared-calculator-narration-show-as-fraction")):xe(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.metaKey&&!e.shiftKey){if(!e.ctrlKey&&!e.altKey&&Re(e)===ul){if(!document.activeElement||gp(O(document.activeElement)))return!1}else if(e.ctrlKey===di&&e.altKey===!di){if(t==="N")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"nemeth"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth")),!1):void 0;if(t==="U")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"ueb"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb")),!1):void 0;if(t==="Q"||t==="X")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"none"}),xe(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off")),!1):void 0;if(t==="6"){if(!this.controller.getBrailleControls())return;let n=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",mode:n}),xe(n?this.controller.s("basic-calculator-narration-hotkey-six-key-input-on"):this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")),!1}else if(t==="D")return this.controller.isScientificCalc()?(e.preventDefault(),this.controller.dispatch({type:"degrees"}),xe(i.getDegreeMode()?this.controller.s("basic-calculator-narration-controlbar-degrees"):this.controller.s("basic-calculator-narration-controlbar-radians")),!1):void 0}}return!0}};var Fy=class extends Tg{constructor(t){super(t)}init(t){t=__dcg_shared_module_exports__['j'](t),t.backgroundColor&&!__dcg_shared_module_exports__['P'](t.backgroundColor)&&(__dcg_shared_module_exports__['k'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete t.backgroundColor),t.textColor&&!__dcg_shared_module_exports__['P'](t.textColor)&&(__dcg_shared_module_exports__['k'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete t.textColor);let i=__dcg_shared_module_exports__['a']({language:"en",qwertyKeyboard:!0,links:!0,degreeMode:!1,settingsMenu:!0,invertedColors:!1,backgroundColor:"#fff",textColor:"#000",brailleMode:"none",sixKeyInput:!1,brailleControls:!0,brailleExpressionDownload:!0,projectorMode:!1,capExpressionSize:!1,functionDefinition:!0,autosize:!0,evaluationMode:"scientific",restrictedEditing:!1,additionalFunctions:["sqrt"],typingSlashWritesDivisionSymbol:!1,typingAsteriskWritesTimesSymbol:!1,decimalToFraction:!0,replaceCommaWith10Exp:!1,replaceRoundWithReciprocal:!1},t);this.settings=new Wr;let n={workerPool:xy,settingsProxy:this.settings};this.controller=new vv(i,n),this.controller.onEventEmitted=o=>{o==="render"&&this.updateView(),this.triggerEvent(o,void 0)},this.setupDomChangeDetector(i.autosize)}onCreateView(){return Ry.mountToNode(Fv,this.rootElt,{controller:Ry.const(this.controller)})}setState(t,i){i||(i={}),this.controller.dispatch({type:"set-state-from-api",state:t,opts:{allowUndo:!!i.allowUndo}})}getState(){return __dcg_shared_module_exports__['j'](this.controller.model.getPersistedState())}undo(){this.controller.dispatch({type:"undo",source:"api"})}redo(){this.controller.dispatch({type:"redo",source:"api"})}clearHistory(){this.controller.dispatch({type:"clear-history"})}setBlank(t){t||(t={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!t.allowUndo}})}updateSettings(t){if(t!=null)for(let i in t)switch(i){case"fontSize":let n=t[i];if(n===void 0)continue;this.controller.dispatch({type:"update-font-size",size:n});break;case"invertedColors":let o=t[i];if(o===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",mode:o});break;case"backgroundColor":let s=t[i];if(s===void 0||!__dcg_shared_module_exports__['P'](s)){__dcg_shared_module_exports__['k'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:s});break;case"textColor":let a=t[i];if(a===void 0||!__dcg_shared_module_exports__['P'](a)){__dcg_shared_module_exports__['k'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:a});break;case"degreeMode":let l=t[i];if(l===void 0)continue;this.controller.dispatch({type:"update-degree-mode",mode:l});break;case"brailleMode":let c=t[i];this.controller.dispatch({type:"set-braille-mode",mode:c});break;case"sixKeyInput":let u=t[i];if(u===void 0)continue;this.controller.dispatch({type:"set-six-key-input",mode:u});break;case"brailleControls":{let k=t[i];if(k===void 0)continue;this.controller.dispatch({type:"set-braille-controls",value:k});break}case"brailleExpressionDownload":let p=t[i];if(p===void 0)continue;this.controller.dispatch({type:"set-braille-expression-download",mode:p});break;case"projectorMode":let g=t[i];if(g===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:g});break;case"capExpressionSize":let h=t[i];if(h===void 0)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:h});break;case"language":let b=t[i];if(b===void 0)continue;this.controller.dispatch({type:"update-language",language:qd(b)});break;case"settingsMenu":t.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":{this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!t.qwertyKeyboard}});let k=this.controller.getKeyboardMode();(k==="qwerty"||k==="letters")&&this.controller.dispatch({type:"ABC"})}break;case"functionDefinition":t.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!t.links}});break;case"decimalToFraction":let C=t[i];if(C===void 0)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:C});break;case"replaceCommaWith10Exp":let D=t[i];if(D===void 0)continue;this.controller.dispatch({type:"set-replace-comma-with-10-exp",replace:D});break;case"replaceRoundWithReciprocal":let S=t[i];if(S===void 0)continue;this.controller.dispatch({type:"set-replace-round-with-reciprocal",replace:S});break;case"restrictedEditing":{this.controller.dispatch({type:"update-options",options:{restrictedEditing:!!t.restrictedEditing}});break}case"typingAsteriskWritesTimesSymbol":let V=t[i];if(V===void 0)continue;this.controller.dispatch({type:"set-typing-asterisk-writes-times-symbol",mode:V});break}}focusFirstExpression(){this.controller.dispatch({type:"focus-first-expression"})}onResizeView(t){this.controller.dispatch({type:"ui/container-resized",size:t})}onDestroyView(){Ry.unmountFromNode(this.rootElt)}destroy(){this.controller.model.destroy(),super.destroy()}};var Ny=class extends Fy{constructor(e,t){super(e),this.init(ote(t||{}))}};function ote(r){if(r=__dcg_shared_module_exports__['j'](r),r.hasOwnProperty("typingSlashWritesDivisionSymbol")||(r.typingSlashWritesDivisionSymbol=!0),r.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(r.typingAsteriskWritesTimesSymbol=!0),r.exponentButtonForSquareRoot&&(__dcg_shared_module_exports__['k'].warn(`As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: "exponent"' instead.`),r.additionalFunctions=["exponent"]),r.additionalFunctions){var e=r.additionalFunctions;typeof e=="string"&&(e=[e]),e.length>2&&(__dcg_shared_module_exports__['k'].warn("additionalFunctions can only take up to 2 new functions. Using the first two."),e=e.slice(0,2));let i=!0;for(var t=0;t<e.length;t++)["sqrt","exponent","percent","fraction"].indexOf(e[t])===-1&&(__dcg_shared_module_exports__['k'].warn("Unrecognized value: '"+e[t]+`' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default ("sqrt")`),i=!1);r.additionalFunctions=i?e:["sqrt"]}return(!r.additionalFunctions||!r.additionalFunctions.length)&&(r.additionalFunctions=["sqrt"]),r.singleExpression?r.evaluationMode="singleExpressionFourFunction":r.evaluationMode="fourFunction",delete r.singleExpression,r.hasOwnProperty("decimalToFraction")||(r.decimalToFraction=!1),r.language&&(r.language=qd(r.language)),r}var By=class extends Fy{constructor(e,t){super(e),this.init(ste(t||{}))}};function ste(r){return r=__dcg_shared_module_exports__['j'](r),r.singleExpression?r.evaluationMode="singleExpressionScientific":r.evaluationMode="scientific",delete r.singleExpression,r.language&&(r.language=qd(r.language)),r}var Uy=__dcg_shared_module_exports__['h'](X());var Rv=class{constructor(e){this.keypadType="scientific";this.projectorMode="none";this.scientificKeyboardMode="main";this.dispatcher=new Fd;this.s=bc(()=>"en");this.dispatch=e=>{this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];var t,i;this.keypadType=(t=e==null?void 0:e.keypadType)!=null?t:"scientific",this.projectorMode=(i=e==null?void 0:e.projectorMode)!=null?i:"none",this.dispatcher=new Fd,this.hookUpDispatcher()}getBackgroundColor(){return"does-not-matter"}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getKeypadType(){return this.keypadType}getProjectorMode(){return this.projectorMode}getScientificKeyboardMode(){return this.scientificKeyboardMode}updateKeyboardMode(e){this.scientificKeyboardMode=e}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.activeMQ;t&&(t.typedText(e),it.simulateUserChangedLatex(t))}pressKeyInFocusedMathquill(e,t){let i=this.activeMQ;if(i){if(e==="Enter"){t&&(t.preventDefault(),t.stopPropagation()),this.enqueueEvent("enter");return}i.keystroke(e,t)}}executeCommandInFocusedMathquill(e){let t=this.activeMQ;t&&Rf(t,e)}hookUpDispatcher(){this.dispatcher.register(e=>{switch(this.enqueueEvent("render"),e.type){case"hide-keypad":this.enqueueEvent("hide-keypad");break;case"set-active-mq":this.activeMQ=e.mq;break;case"set-keypad-type":this.keypadType=e.keypadType;break;case"keypad/shift":this.updateKeyboardMode(this.scientificKeyboardMode==="capitalQwerty"?"qwerty":"capitalQwerty");break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.updateKeyboardMode("qwerty");break;case"functions":this.updateKeyboardMode("functions");break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;default:return e}})}};var io=__dcg_shared_module_exports__['h'](X());var KH=__dcg_shared_module_exports__['h'](X()),Ds=class extends KH.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var wo=__dcg_shared_module_exports__['h'](X());var $I=class extends Ds{template(){return wo.createElement(wr,{controller:this.props.controller},wo.createElement(Ue,null,x(this,"a^2"),x(this,"a^b"),x(this,"|a|"),x(this,"a/b"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"/"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"x"),x(this,"y")),wo.createElement(Ue,null,x(this,"("),x(this,")"),x(this,"<"),x(this,">"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"*"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"left",{style:"highlight"}),x(this,"right",{style:"highlight"})),wo.createElement(Ue,null,x(this,"sqrt"),x(this,","),x(this,"<="),x(this,">="),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"-"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),ji(.5),x(this,"backspace",{style:"highlight",colspan:1.5})),wo.createElement(Ue,null,x(this,"nthroot"),x(this,"pi"),x(this,"%"),x(this,"a_b"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"0",{style:"highlight"}),x(this,".",{style:"highlight"}),x(this,"="),x(this,"+"),wo.createElement("div",{class:wo.const("dcg-partition-placeholder")}),x(this,"enter",{colspan:2,style:"blue"})))}};var Qc=__dcg_shared_module_exports__['h'](X());var WI=class extends Ds{template(){return Qc.createElement(wr,{controller:this.props.controller},Qc.createElement(Ue,null,x(this,"q"),x(this,"w"),x(this,"e"),x(this,"r"),x(this,"t"),x(this,"y"),x(this,"u"),x(this,"i"),x(this,"o"),x(this,"p")),Qc.createElement(Ue,null,Qc.createElement("div",{class:Qc.const("dcg-half-width-placeholder")}),x(this,"a"),x(this,"s"),x(this,"d"),x(this,"f"),x(this,"g"),x(this,"h"),x(this,"j"),x(this,"k"),x(this,"l"),Qc.createElement("div",{class:Qc.const("dcg-half-width-placeholder")})),Qc.createElement(Ue,null,x(this,"shift",{style:"highlight"}),x(this,"z"),x(this,"x"),x(this,"c"),x(this,"v"),x(this,"b"),x(this,"n"),x(this,"m"),x(this,":"),x(this,"backspace",{style:"highlight"})),Qc.createElement(Ue,null,x(this,"~"),x(this,"{"),x(this,"}"),x(this,"["),x(this,"]"),x(this,"\xB1"),x(this,"'"),x(this,"obelus"),x(this,"enter",{style:"blue"})))}};var Zc=__dcg_shared_module_exports__['h'](X());var jI=class extends Ds{template(){return Zc.createElement(wr,{controller:this.props.controller},Zc.createElement(Ue,null,x(this,"Q"),x(this,"W"),x(this,"E"),x(this,"R"),x(this,"T"),x(this,"Y"),x(this,"U"),x(this,"I"),x(this,"O"),x(this,"P")),Zc.createElement(Ue,null,Zc.createElement("div",{class:Zc.const("dcg-half-width-placeholder")}),x(this,"A"),x(this,"S"),x(this,"D"),x(this,"F"),x(this,"G"),x(this,"H"),x(this,"J"),x(this,"K"),x(this,"L"),Zc.createElement("div",{class:Zc.const("dcg-half-width-placeholder")})),Zc.createElement(Ue,null,x(this,"shift",{style:"highlight"}),x(this,"Z"),x(this,"X"),x(this,"C"),x(this,"V"),x(this,"B"),x(this,"N"),x(this,"M"),x(this,","),x(this,"backspace",{style:"highlight"})),Zc.createElement(Ue,null,x(this,"="),x(this,"("),x(this,")"),x(this,"["),x(this,"]"),x(this,"\xB1"),x(this,"'"),x(this,"obelus"),x(this,"enter",{style:"blue"})))}};var Ma=__dcg_shared_module_exports__['h'](X());var JI=class extends Ds{template(){return Ma.createElement(wr,{controller:this.props.controller},Ma.createElement(Ue,null,x(this,"sin"),x(this,"cos"),x(this,"tan"),Ma.createElement("div",{class:Ma.const("dcg-partition-placeholder")}),x(this,"ln"),x(this,"log"),x(this,"backspace",{style:"highlight"})),Ma.createElement(Ue,null,x(this,"arcsin"),x(this,"arccos"),x(this,"arctan"),Ma.createElement("div",{class:Ma.const("dcg-partition-placeholder")}),x(this,"e^x"),x(this,"abs"),x(this,"round")),Ma.createElement(Ue,null,x(this,"mean"),x(this,"stdev"),x(this,"stdevp"),Ma.createElement("div",{class:Ma.const("dcg-partition-placeholder")}),x(this,"a^b"),x(this,"sqrt"),x(this,"nthroot")),Ma.createElement(Ue,null,x(this,"nPr"),x(this,"nCr"),x(this,"!"),Ma.createElement("div",{class:Ma.const("dcg-partition-placeholder")}),x(this,"e"),x(this,"%"),x(this,"enter",{style:"blue"})))}};var ua=__dcg_shared_module_exports__['h'](X());var YI=class extends Ds{template(){return ua.createElement(wr,{controller:this.props.controller},ua.createElement(Ue,null,x(this,"1",{style:"highlight"}),x(this,"2",{style:"highlight"}),x(this,"3",{style:"highlight"}),x(this,"4",{style:"highlight"}),x(this,"5",{style:"highlight"}),x(this,"6",{style:"highlight"}),x(this,"7",{style:"highlight"}),x(this,"8",{style:"highlight"}),x(this,"9",{style:"highlight"}),x(this,"0",{style:"highlight"}),ua.createElement("div",{class:ua.const("dcg-partition-placeholder")}),x(this,"left",{style:"highlight"}),x(this,"right",{style:"highlight"}),ua.createElement("div",{class:ua.const("dcg-inline-hide-keypad-button"),"dcg-command":ua.const("hide-keypad"),onTap:()=>this.props.controller().dispatch({type:"hide-keypad"})},ua.createElement("div",{class:ua.const("dcg-inline-hide-keypad-button-inner")},ua.createElement("i",{class:ua.const("dcg-icon-hide"),"aria-hidden":ua.const("true")})))),ua.createElement(Ue,null,ji(2),x(this,"."),x(this,"="),x(this,"+"),x(this,"-"),x(this,"multiplication"),x(this,"obelus"),ji(3),x(this,"backspace",{style:"highlight",colspan:1.5}),ji(1)),ua.createElement(Ue,null,ji(2),x(this,"a/b"),x(this,","),x(this,"("),x(this,")"),x(this,"<"),x(this,">"),ji(2.5),x(this,"enter",{colspan:2,style:"blue"}),ji(1)))}};var ac=__dcg_shared_module_exports__['h'](X());var XI=class extends Ds{template(){let r=this.props.controller();return ac.createElement(Tl,{controller:this.props.controller},ac.createElement(bi,{command:this.const("main"),selected:()=>r.getScientificKeyboardMode()==="main",ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"})},()=>r.s("basic-calculator-button-controlbar-main")),ac.createElement(bi,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty"].indexOf(r.getScientificKeyboardMode())!==-1,ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"})},()=>r.s("basic-calculator-button-controlbar-abc")),ac.createElement(bi,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getScientificKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"})},()=>r.s("shared-calculator-button-controlbar-functions")),ac.createElement("div",{class:ac.const("dcg-hide-keypad-button"),"dcg-command":ac.const("hide-keypad"),onTap:()=>r.dispatch({type:"hide-keypad"})},ac.createElement("i",{class:ac.const("dcg-icon-hide"),"aria-hidden":ac.const("true")})))}};var{Switch:ate,SwitchUnion:lte}=io.Components,QI=class extends Ds{template(){return io.createElement("div",{class:io.const("dcg-calculator-api-container"),style:()=>"width: 100%; height: 100%; position: relative;"},io.createElement("div",{class:io.const("dcg-do-not-blur dcg-container dcg-api-shared-keypad-root"),didMount:this.bindFn(this.didMountRoot)},this.children))}didMountRoot(e){mp(e)}},U0=class extends Ds{template(){return io.createElement(QI,__dcg_shared_module_exports__['a']({},this.props),io.createElement("div",{class:()=>({"dcg-fourfunction-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"}),role:io.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},io.createElement(YI,{controller:this.props.controller})))}},H0=class extends Ds{template(){return io.createElement(QI,__dcg_shared_module_exports__['a']({},this.props),io.createElement("div",{class:()=>({"dcg-scientific-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"})},io.createElement(XI,{controller:this.props.controller}),io.createElement("div",{role:io.const("group"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},io.createElement(ate,{key:()=>this.controller.getScientificKeyboardMode()},e=>{switch(e){case"qwerty":return io.createElement(WI,{controller:this.props.controller});case"capitalQwerty":return io.createElement(jI,{controller:this.props.controller});case"functions":return io.createElement(JI,{controller:this.props.controller});default:return io.createElement($I,{controller:this.props.controller})}}))))}},ZI=class extends Ds{template(){return lte(()=>this.controller.getKeypadType(),{fourfunction:()=>io.createElement(U0,__dcg_shared_module_exports__['a']({},this.props)),scientific:()=>io.createElement(H0,__dcg_shared_module_exports__['a']({},this.props))})}};var Ky=class extends Tg{constructor(t,i){super(t);this.init(i)}init(t){this.controller=new Rv(t),this.controller.onEventEmitted=i=>{i==="render"&&this.updateView(),this.triggerEvent(i,void 0)},this.setupDomChangeDetector(!0)}setActiveMathquill(t){this.controller.dispatch({type:"set-active-mq",mq:t})}setKeypadType(t){this.controller.dispatch({type:"set-keypad-type",keypadType:t})}onCreateView(){return Uy.mountToNode(ZI,this.rootElt,{controller:Uy.const(this.controller)})}onResizeView(t){}onDestroyView(){Uy.unmountFromNode(this.rootElt)}destroy(){super.destroy()}};var sh=class extends Eg{constructor(e,t,i){super(e,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{product:"geometry-calculator"}),i),this.setState(Uf),this.clearHistory()}};var cte=__dcg_shared_module_exports__['h'](X());uu();var Nv;typeof Desmos!="undefined"?Nv=Desmos:(Nv={},window.Desmos=Nv);var dte={SMALL:"0.85",MEDIUM:"1",LARGE:"1.35"};function q0(...r){return new Qa(...r)}q0.prototype=Qa.prototype;function UH(...r){return new sh(...r)}UH.prototype=sh.prototype;function z0(...r){return new My(...r)}z0.prototype=My.prototype;function HH(...r){return new Ny(...r)}HH.prototype=Ny.prototype;function qH(...r){return new By(...r)}qH.prototype=By.prototype;function zH(...r){return new Ky(...r)}zH.prototype=Ky.prototype;var Og={version:LH,Colors:{RED:nS,BLUE:oS,GREEN:sS,ORANGE:lS,PURPLE:aS,BLACK:cS},imageFileToDataURL:DG,supportedLanguages:["en"].concat(typeof desmosLocaleData=="object"?Object.keys(desmosLocaleData):[]),Styles:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},o0),n0),ColumnModes:cv,DragModes:s0,AxisArrowModes:__dcg_shared_module_exports__['N'],FontSizes:vG,LabelSizes:dte,LabelOrientations:a0,GraphingCalculator:q0,Calculator:q0,FourFunctionCalculator:HH,ScientificCalculator:qH,Abraham:_d,Private:{Abraham:_d,Mathtools:WL,Graphtools:{ScalePair:__dcg_shared_module_exports__['xc'],getClippingGraphType:nw,mapSegmentToCanvas:bu,computeDrawingCommandsForDOMLabel:YS,drawCommandsToCtx:XS},MathquillConfig:{getAutoCommands:Id,getAutoOperators:$a},Parser:__dcg_shared_module_exports__['Xc'],extractSliderValueFromLatex:vb,__compareBranches:{getSliderMin:yl,getSliderMax:vc},GeometryBeta:UH,HeadlessGraphingCalculator:z0,Fragile:{DCGView:cte,PromptSliderView:qc,Checkbox:Gt,SegmentedControl:Rr,MathquillView:it,InlineMathInputView:fr,StaticMathquillView:tt,Tooltip:Ke,ExpressionOptionsMenuView:iy,evaluateLatex:Si,Keys:$r,jQuery,getQueryParams:Gs,getReconciledExpressionProps:__dcg_shared_module_exports__['yc'],List:{moveItemsTo:Ip,removeItemById:Jm},currentLanguage:fb}},TestInternal:{subscribeToSharedClockBus:r=>qu(r),getCalcConfigAll:()=>zC(),fetchLanguage:r=>ym(r)},MathQuill:$l,PillowKeypad:zH,HeadlessGraphingCalculator:z0};function $0(r){var e=Nv.enabledFeatures;return!e||e[r]}function tV(r){Og[r]=function(){throw new Error("The Desmos "+r+" is not enabled for this API key.")}}$0("GraphingCalculator")||(tV("GraphingCalculator"),tV("Calculator"));$0("FourFunctionCalculator")||tV("FourFunctionCalculator");$0("ScientificCalculator")||tV("ScientificCalculator");for(eV in Og)Og.hasOwnProperty(eV)&&(Nv[eV]=Og[eV]);var eV;var qe=__dcg_shared_module_exports__['h'](X());ct();function $H(r){let e=r.split(","),t=e[0].match(/:(.*?);/),i=t!==null?t[1]:"",n=e[1]!==null?atob(e[1]):"",o=n.length,s=new Uint8Array(o);for(;o--;)s[o]=n.charCodeAt(o);return new Blob([s],{type:i})}function WH(r){if(r.indexOf("xmlns=")===-1)throw new Error('Programming error: <svg> elements require the "xmlns" attribute to render properly');return new Blob([r],{type:"image/xml+svg;charset=utf-8"})}var Yr=__dcg_shared_module_exports__['h'](X());ct();var{If:ute}=Yr.Components,ed=class extends Yr.Class{template(){return Yr.createElement("div",{role:Yr.const("button"),tabindex:Yr.const("0"),"aria-pressed":()=>this.isSelected(),class:()=>({"dcg-option":!0,"dcg-selected":this.isSelected()}),onTap:()=>this.selectSize()},()=>rl[this.props.size()].name(this.props.controller()))}isSelected(){this.props.selectedSize(),this.props.size()}selectSize(){this.props.onSelectSize(this.props.size())}},Bv=class extends Yr.Class{init(){this.menuOpen=!1,this.unmounted=!1}template(){return Yr.createElement("div",{class:Yr.const("dcg-export-image-size-options")},Yr.createElement("div",{role:Yr.const("button"),tabindex:Yr.const("0"),"aria-haspopup":Yr.const("true"),"aria-expanded":()=>this.menuOpen,class:Yr.const("dcg-selected-option"),didMount:e=>{this.menuElement=e,this.props.controller().getModalDevice()==="keyboard"&&setTimeout(()=>{this.menuElement.focus()},0)},onTap:this.bindFn(this.toggleMenu)},()=>this.selected().name(this.props.controller()),Yr.createElement("i",{class:Yr.const("dcg-icon-caret-down"),"aria-hidden":Yr.const("true")})),Yr.createElement(ute,{predicate:()=>this.menuOpen},()=>Yr.createElement("div",{class:Yr.const("dcg-options-positioning-container")},Yr.createElement("div",{class:Yr.const("dcg-options-container"),role:Yr.const("group"),"aria-label":()=>this.props.controller().s("account-shell-narration-size-options")},Yr.createElement(ed,{controller:this.props.controller,size:this.const("small_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("medium_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("large_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("medium_rectangle"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("large_rectangle"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement("h3",{class:Yr.const("dcg-embosser-title")},()=>this.props.controller().s("account-shell-heading-embossers")),Yr.createElement(ed,{controller:this.props.controller,size:this.const("vpmax8"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("vpmax11"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("etc8"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Yr.createElement(ed,{controller:this.props.controller,size:this.const("etc11"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)})))))}closeMenu(){O(document).off(".export-image-size-options"),this.menuOpen=!1,this.unmounted||this.update()}didUnmount(){O(document).off(".export-image-size-options"),this.unmounted=!0}toggleMenu(){if(this.menuOpen){this.closeMenu();return}this.menuOpen=!0,O(document).on("dcg-tap.export-image-size-options",e=>{O(e.target).closest(".dcg-export-image-size-options").length||this.closeMenu()}),this.unmounted||this.update()}selectSize(e){this.menuOpen=!1,this.props.selectSize(e),this.menuElement!==void 0&&this.props.controller().getModalDevice()==="keyboard"&&this.menuElement.focus()}selected(){return rl[this.props.selectedSize()]}};var{If:td,IfElse:pte}=qe.Components,rl={},Uv={left:0,top:0,right:0,bottom:0};rl.small_square={width:160,height:160,margins:Uv,name:r=>r.s("account-shell-label-export-size-small-square")};rl.medium_square={width:400,height:400,margins:Uv,name:r=>r.s("account-shell-label-export-size-medium-square")};rl.large_square={width:1e3,height:1e3,margins:Uv,name:r=>r.s("account-shell-label-export-size-large-square")};rl.medium_rectangle={width:600,height:400,margins:Uv,name:r=>r.s("account-shell-label-export-size-medium-rectangle")};rl.large_rectangle={width:1200,height:800,margins:Uv,name:r=>r.s("account-shell-label-export-size-large-rectangle")};rl=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},rl),qp);var Kv=class extends qe.Class{init(){this.controller=this.props.controller(),this.thickness="thin",this.size="medium_square";let e=this.controller.api.controller.getBrailleMode();this.brailleMode=e!=="none"?e:"nemeth",this.showDownloadButton=FI(),this.unmounted=!1,this.svgDropdownOpen=!1,this.markImagesDirty(),this.loaded=!1}template(){return qe.createElement(ic,{controller:this.props.controller},qe.createElement("div",{id:qe.const("export-image-dialog")},qe.createElement("h1",null,()=>this.controller.s("account-shell-heading-export-graph")),qe.createElement("div",{class:qe.const("dcg-offscreen-calculator"),didMount:this.bindFn(this.didMountOffscreenCalc),willUnmount:this.bindFn(this.willUnmountOffscreenCalc),"aria-hidden":qe.const("true")}),qe.createElement("div",{class:qe.const("dcg-columns")},qe.createElement("div",{class:qe.const("dcg-left-column")},qe.createElement("div",{class:()=>({"dcg-graph-preview":!0,"dcg-preview-loading":this.pngDirty})},qe.createElement(td,{predicate:()=>this.loaded},()=>qe.createElement("img",{class:qe.const("dcg-graph-image"),didMount:this.bindFn(this.didMountGraphPreview),src:()=>this.previewDataURL,alt:()=>this.controller.s("account-shell-narration-graph-preview")})),qe.createElement(td,{predicate:()=>this.pngDirty},()=>qe.createElement("span",{class:qe.const("dcg-loading-message")},qe.createElement("span",{class:qe.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),qe.createElement(td,{predicate:()=>!this.pngDirty&&!this.isExportingBraille()},()=>qe.createElement("span",{class:qe.const("dcg-zoom-percentage")},this.bindFn(this.getZoom))))),qe.createElement("div",{class:qe.const("dcg-right-column")},qe.createElement("div",{role:qe.const("heading"),"aria-level":qe.const("2"),class:qe.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-export-size")),qe.createElement(Bv,{controller:this.props.controller,selectedSize:()=>this.size,selectSize:this.bindFn(this.selectSize)}),qe.createElement(td,{predicate:()=>!this.isExportingBraille()},()=>qe.createElement(Rr,{staticConfig:this.bindFn(this.getLineThicknessOptions),ariaGroupLabel:()=>this.controller.s("account-shell-heading-line-thickness")})),qe.createElement(td,{predicate:()=>this.isExportingBraille()},()=>qe.createElement("div",{class:qe.const("braille-container")},qe.createElement("div",{role:qe.const("heading"),"aria-level":qe.const("2"),class:qe.const("dcg-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode")),qe.createElement(Rr,{staticConfig:this.bindFn(this.getBrailleOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode")}),qe.createElement("div",{class:qe.const("braille-instructions")},qe.createElement("div",{role:qe.const("heading"),"aria-level":qe.const("2"),class:qe.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-embossing-instructions")),qe.createElement(td,{predicate:()=>this.size==="vpmax8"||this.size==="vpmax11"},()=>qe.createElement("ul",null,qe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-save")),qe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-print",{size:jH(this.size)})))),qe.createElement(td,{predicate:()=>this.size==="etc8"||this.size==="etc11"},()=>qe.createElement("ul",null,qe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-save")),qe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-print",{size:jH(this.size)})))),qe.createElement("div",{class:qe.const("dcg-feedback-link")},qe.createElement(Wi,{i18n:this.const(this.controller),key:this.const("graphing-calculator-text-export-braille-email-accessibility")},qe.const("Feedback? Email"),qe.const(" "),qe.createElement("a",{class:qe.const("blue-link"),href:qe.const("mailto:accessibility@desmos.com")},qe.const("accessibility@desmos.com")),qe.const(".")))))),pte(this.const(this.showDownloadButton),{true:()=>qe.createElement("div",null,qe.createElement("div",{role:qe.const("group"),"aria-label":()=>this.controller.s("account-shell-narration-image-download"),class:()=>({"dcg-download-button-group":!0,"dcg-download-button-group-singleton":this.isExportingBraille()})},qe.createElement(ju,{data:()=>this.previewBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-graph.png"),text:()=>this.controller.s("account-shell-button-download-png")}),qe.createElement(td,{predicate:()=>!this.isExportingBraille()},()=>qe.createElement("div",{role:qe.const("button"),tabindex:()=>this.svgDirty?-1:0,"aria-disabled":()=>this.svgDirty,"aria-expanded":()=>this.svgDropdownOpen,"aria-label":()=>this.controller.s("account-shell-button-svg-options"),class:()=>({"dcg-svg-dropdown":!0,"dcg-button":!0,"dcg-disabled":this.svgDirty}),onTap:this.bindFn(this.toggleSvgDropdown)},qe.createElement("i",{class:qe.const("dcg-icon-caret-down"),"aria-hidden":qe.const("true")})))),qe.createElement(td,{predicate:()=>this.isExportingBraille()&&!_l},()=>qe.createElement(ju,{data:()=>this.brailleBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("account-shell-button-download-braille"),isBraille:this.const(!0)})),qe.createElement(td,{predicate:()=>this.svgDropdownOpen},()=>qe.createElement("div",{class:qe.const("dcg-svg-popover dcg-popover dcg-top"),didMount:this.bindFn(this.didMountSvgDropdown),willUnmount:this.bindFn(this.willUnmountSvgDropdown)},qe.createElement("div",{class:qe.const("dcg-popover-interior")},qe.createElement(ju,{data:()=>this.svgBlob,enabled:()=>!this.svgDirty,filename:this.const("desmos-graph.svg"),text:()=>this.controller.s("account-shell-button-download-svg"),isSvg:this.const(!0)}),qe.createElement("div",{class:qe.const("dcg-beta-tag")},()=>this.controller.s("account-shell-label-beta"))),qe.createElement("div",{class:qe.const("dcg-arrow")})))),false:()=>qe.createElement(td,{predicate:()=>!this.isExportingBraille()},()=>qe.createElement("div",{class:qe.const("dcg-download-not-enabled-notice")},qe.createElement("div",{role:qe.const("heading"),"aria-level":qe.const("2"),class:qe.const("dcg-title")},()=>this.controller.s("account-shell-heading-download-instructions")),()=>this.controller.s("account-shell-text-download-instructions")))})))))}getLineThicknessOptions(){return[{key:"thin",label:()=>this.controller.s("account-shell-button-line-thin"),selected:()=>this.thickness==="thin",onSelect:()=>this.selectThickness("thin")},{key:"medium",label:()=>this.controller.s("account-shell-button-line-medium"),selected:()=>this.thickness==="medium",onSelect:()=>this.selectThickness("medium")},{key:"thick",label:()=>this.controller.s("account-shell-button-line-thick"),selected:()=>this.thickness==="thick",onSelect:()=>this.selectThickness("thick")}]}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.brailleMode==="nemeth",onSelect:()=>this.selectBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.brailleMode==="ueb",onSelect:()=>this.selectBrailleMode("ueb")}]}didMountSvgDropdown(e){O(document).on("dcg-tap.svg-dropdown",({target:t})=>{let i=document.querySelector(".dcg-svg-dropdown");!e||!i||!i.contains(t)&&!e.contains(t)&&this.closeSvgDropdown()})}willUnmountSvgDropdown(){O(document).off(".svg-dropdown")}didMountOffscreenCalc(e){let i=this.controller.api.controller.isGeometry()?Og.Private.GeometryBeta:Og.GraphingCalculator;i&&(this.calculator=i(e,{expressions:!1,keypad:!1,branding:!1,border:!1,enableTabindex:!1}),this.calculator._calc.evaluator.notifyWhenSynced(()=>{this.markImagesDirty(),this.updateIfMounted()}),this.calculator.setState(this.controller.api.getState()))}willUnmountOffscreenCalc(){this.calculator&&this.calculator.destroy()}markImagesDirty(){this.pngDirty=!0,this.svgDirty=!0}selectSize(e){this.size=e,this.markImagesDirty(),this.updateIfMounted()}selectBrailleMode(e){this.brailleMode=e,this.markImagesDirty(),this.updateIfMounted()}getZoom(){return this.controller.s("account-shell-label-zoom",{value:Math.min(100,Math.round(100*400/this.getWidth()))})}selectThickness(e){this.thickness=e,this.markImagesDirty(),this.updateIfMounted()}didMountGraphPreview(e){this.previewImg=e}getGridOpacity(){switch(this.thickness){case"thick":return 1;case"medium":return .6;case"thin":return .4;default:return this.thickness}}getAxisWeight(){switch(this.thickness){case"thick":return 2;case"medium":return 2;case"thin":return 1.5;default:return this.thickness}}getGraphThickness(){switch(this.thickness){case"thick":return 5;case"medium":return 3.5;case"thin":return 2.5;default:return this.thickness}}getLabelSize(){if(this.size==="small_square")switch(this.thickness){case"thick":return 14;case"medium":return 12;case"thin":return 10;default:return this.thickness}else switch(this.thickness){case"thick":return 20;case"medium":return 17;case"thin":return 14;default:return this.thickness}}updateViewSettings(){if(this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;let e=this.calculator._calc.grapher.settings;this.isExportingBraille()||(e.majorAxisOpacity=this.getGridOpacity(),e.minorAxisOpacity=this.getGridOpacity()/2,e.axisLineOffset=0,e.setProperty("axisLineWidth",this.getAxisWeight()),e.labelSize=this.getLabelSize(),e.graphLineWidth=this.getGraphThickness(),e.pointLineWidth=this.getGraphThickness()*3)}getBackgroundSize(){switch(this.size){case"medium_rectangle":case"large_rectangle":return"contain";case"small_square":return`${rl.small_square.width}px ${rl.small_square.height}px`;default:return"cover"}}getHeight(){return rl[this.size].height}getWidth(){return rl[this.size].width}didUnmount(){this.unmounted=!0}updateIfMounted(){this.unmounted||this.update()}updateGraphPreview(){if(!this.pngDirty&&!this.svgDirty||this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;this.updateViewSettings();let e={width:this.getWidth(),height:this.getHeight(),preserveAxisNumbers:!0,showLabels:!0,targetPixelRatio:2},t={braille:{embosserModel:this.size,brailleMode:this.brailleMode}};if(this.pngDirty){let n=this.isExportingBraille()?t:e;this.calculator.asyncScreenshot(n,o=>{typeof o=="string"&&(this.previewDataURL=o,this.previewBlob=$H(this.previewDataURL),this.pngDirty=!1,this.loaded=!0,this.updateIfMounted(),this.resizePreviewImg())})}if(this.svgDirty){var i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{svg:!0});let n=Ai("worksheetSVG");n&&(i.targetPixelRatio=1),this.calculator.asyncScreenshot(i,o=>{typeof o=="string"&&(n&&(o=gte(o)),o!==void 0&&(this.svgBlob=WH(o),this.svgDirty=!1,this.updateIfMounted(),this.resizePreviewImg()))})}}updateBrailleEquations(){if(this.isExportingBraille()){let e=_H(this.controller.api.controller,this.brailleMode);this.brailleBlob=new Blob([e],{type:"text/plain"})}}resizePreviewImg(){if(!this.previewImg)return;let e=1;(this.size==="etc8"||this.size==="etc11")&&(e=2),(this.size==="vpmax8"||this.size==="vpmax11")&&(e=1.5);let t=Math.min(this.getWidth(),400),n=this.getHeight()/this.getWidth()*t;this.previewImg.width=t*e,this.previewImg.height=n*e}willUpdate(){this.updateGraphPreview(),this.updateBrailleEquations()}isExportingBraille(){return hte(this.size)}closeSvgDropdown(){this.svgDropdownOpen=!1,this.updateIfMounted()}toggleSvgDropdown(){this.svgDropdownOpen=!this.svgDropdownOpen,this.updateIfMounted()}};function hte(r){return r==="vpmax8"||r==="vpmax11"||r==="etc8"||r==="etc11"}function jH(r){switch(r){case"etc8":return"8.5 x 11.0";case"etc11":return"11.5 x 11.0";case"vpmax8":return"8.5 x 11";case"vpmax11":return"11.5 x 11";default:return r}}function gte(r){var e=new DOMParser,t=e.parseFromString(r,"text/xml");function i(n,o){t.querySelectorAll(n).forEach(o)}return i(".dcg-svg-region",function(n){n.setAttribute("fill","black")}),i(".dcg-svg-label *",function(n){n.setAttribute("stroke","none"),n.setAttribute("fill","black")}),i(".dcg-svg-axis-value text",function(n){n.getAttribute("stroke")!=="none"?n.parentElement&&n.parentElement.removeChild(n):(n.setAttribute("font-family","Helvetica Neue"),n.setAttribute("font-weight","bold"))}),i(".dcg-svg-offcenter-axis-value",function(n){n.parentElement&&n.parentElement.removeChild(n)}),i(".dcg-svg-curve",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","5"),n.setAttribute("stroke-opacity","1")}),i(".dcg-svg-point",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","10"),n.setAttribute("stroke-opacity","1")}),i(".dcg-svg-background",function(n){var o=parseFloat(n.getAttribute("width")),s=parseFloat(n.getAttribute("height")),a=3,l=t.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",`M${o-a},${a}v${s-2*a}H${a}V${a}H${o-a} M${o},0H0v${s}h${o}V0L${o},0z`),n.parentElement.appendChild(l)}),i(".dcg-svg-axis-line",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","4"),n.setAttribute("stroke-opacity","1")}),i(".dcg-svg-minor-gridline, .dcg-svg-major-gridline",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","1"),n.setAttribute("stroke-opacity","1")}),t.firstChild.outerHTML}var os=__dcg_shared_module_exports__['h'](X());var rV=class extends os.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.openTime=Date.now(),this.formErrors=[],this.controller.logJSON("shared-consent-modal",{action:"show-consent-modal"})}template(){return os.createElement(Lo,{title:()=>this.i18n.s("shared-title-consent"),size:this.const("narrow"),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},os.createElement("div",{class:os.const("dcg-shared-consent-modal-container dcg-shared-account-dialog")},os.createElement("div",{class:os.const("dcg-shared-consent-contents")},()=>this.i18n.s("shared-message-consent-information")),os.createElement("div",{class:os.const("dcg-shared-consent-contents")},()=>this.i18n.s("shared-message-consent-delete-information")),os.createElement("div",{class:os.const("dcg-shared-modal-actions-container")},os.createElement("span",{role:os.const("button"),tabindex:os.const("0"),class:os.const("dcg-shared-dark-gray-link"),onTap:e=>this.openAccountSettings(e.device)},()=>this.i18n.s("shared-button-go-to-account-settings")),os.createElement("div",{role:os.const("button"),tabindex:()=>this.isConsentingToCollection()?-1:0,"aria-disabled":()=>this.isConsentingToCollection(),class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.isConsentingToCollection()}),onTap:this.bindFn(this.consentToCollection)},()=>this.i18n.s("shared-button-accept")),os.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}))))}willUpdate(){this.formErrors=[],this.controller.userController.didPrivacyConsentFail()&&(this.formErrors=[this.controller.getSomethingWentWrongText()])}isConsentingToCollection(){return this.controller.userController.isConsentingToPrivacy()}didPrivacyConsentFail(){return this.controller.userController.didPrivacyConsentFail()}openAccountSettings(e){this.controller.logJSON("shared-consent-modal",{action:"edit-account",ts:Date.now()-this.openTime}),this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e})}consentToCollection(){this.controller.logJSON("shared-consent-modal",{action:"consent",ts:Date.now()-this.openTime}),this.controller.userController.setPrivacyConsent({lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"})}};var JH=`[
  "Afganistan",
  "Albania",
  "Algeria",
  "American Samoa",
  "Andorra",
  "Angola",
  "Anguilla",
  "Antigua & Barbuda",
  "Argentina",
  "Armenia",
  "Aruba",
  "Australia",
  "Austria",
  "Azerbaijan",
  "Bahamas",
  "Bahrain",
  "Bangladesh",
  "Barbados",
  "Belarus",
  "Belgium",
  "Belize",
  "Benin",
  "Bermuda",
  "Bhutan",
  "Bolivia",
  "Bonaire",
  "Bosnia & Herzegovina",
  "Botswana",
  "Brazil",
  "British Indian Ocean Ter",
  "Brunei",
  "Bulgaria",
  "Burkina Faso",
  "Burundi",
  "Cambodia",
  "Cameroon",
  "Canada",
  "Canary Islands",
  "Cape Verde",
  "Cayman Islands",
  "Central African Republic",
  "Chad",
  "Channel Islands",
  "Chile",
  "China",
  "Christmas Island",
  "Cocos Island",
  "Colombia",
  "Comoros",
  "Congo",
  "Cook Islands",
  "Costa Rica",
  "Cote DIvoire",
  "Croatia",
  "Cuba",
  "Curaco",
  "Cyprus",
  "Czech Republic",
  "Denmark",
  "Djibouti",
  "Dominica",
  "Dominican Republic",
  "East Timor",
  "Ecuador",
  "Egypt",
  "El Salvador",
  "Equatorial Guinea",
  "Eritrea",
  "Estonia",
  "Ethiopia",
  "Falkland Islands",
  "Faroe Islands",
  "Fiji",
  "Finland",
  "France",
  "French Guiana",
  "French Polynesia",
  "French Southern Ter",
  "Gabon",
  "Gambia",
  "Georgia",
  "Germany",
  "Ghana",
  "Gibraltar",
  "Great Britain",
  "Greece",
  "Greenland",
  "Grenada",
  "Guadeloupe",
  "Guam",
  "Guatemala",
  "Guinea",
  "Guyana",
  "Haiti",
  "Hawaii",
  "Honduras",
  "Hong Kong",
  "Hungary",
  "Iceland",
  "Indonesia",
  "India",
  "Iran",
  "Iraq",
  "Ireland",
  "Isle of Man",
  "Israel",
  "Italy",
  "Jamaica",
  "Japan",
  "Jordan",
  "Kazakhstan",
  "Kenya",
  "Kiribati",
  "Korea North",
  "Korea Sout",
  "Kuwait",
  "Kyrgyzstan",
  "Laos",
  "Latvia",
  "Lebanon",
  "Lesotho",
  "Liberia",
  "Libya",
  "Liechtenstein",
  "Lithuania",
  "Luxembourg",
  "Macau",
  "Macedonia",
  "Madagascar",
  "Malaysia",
  "Malawi",
  "Maldives",
  "Mali",
  "Malta",
  "Marshall Islands",
  "Martinique",
  "Mauritania",
  "Mauritius",
  "Mayotte",
  "Mexico",
  "Midway Islands",
  "Moldova",
  "Monaco",
  "Mongolia",
  "Montserrat",
  "Morocco",
  "Mozambique",
  "Myanmar",
  "Nambia",
  "Nauru",
  "Nepal",
  "Netherland Antilles",
  "Netherlands",
  "Nevis",
  "New Caledonia",
  "New Zealand",
  "Nicaragua",
  "Niger",
  "Nigeria",
  "Niue",
  "Norfolk Island",
  "Norway",
  "Oman",
  "Pakistan",
  "Palau Island",
  "Palestine",
  "Panama",
  "Papua New Guinea",
  "Paraguay",
  "Peru",
  "Phillipines",
  "Pitcairn Island",
  "Poland",
  "Portugal",
  "Puerto Rico",
  "Qatar",
  "Republic of Montenegro",
  "Republic of Serbia",
  "Reunion",
  "Romania",
  "Russia",
  "Rwanda",
  "St Barthelemy",
  "St Eustatius",
  "St Helena",
  "St Kitts-Nevis",
  "St Lucia",
  "St Maarten",
  "St Pierre & Miquelon",
  "St Vincent & Grenadines",
  "Saipan",
  "Samoa",
  "Samoa American",
  "San Marino",
  "Sao Tome & Principe",
  "Saudi Arabia",
  "Senegal",
  "Seychelles",
  "Sierra Leone",
  "Singapore",
  "Slovakia",
  "Slovenia",
  "Solomon Islands",
  "Somalia",
  "South Africa",
  "Spain",
  "Sri Lanka",
  "Sudan",
  "Suriname",
  "Swaziland",
  "Sweden",
  "Switzerland",
  "Syria",
  "Tahiti",
  "Taiwan",
  "Tajikistan",
  "Tanzania",
  "Thailand",
  "Togo",
  "Tokelau",
  "Tonga",
  "Trinidad & Tobago",
  "Tunisia",
  "Turkey",
  "Turkmenistan",
  "Turks & Caicos Is",
  "Tuvalu",
  "Uganda",
  "United Kingdom",
  "Ukraine",
  "United Arab Erimates",
  "United States",
  "Uraguay",
  "Uzbekistan",
  "Vanuatu",
  "Vatican City State",
  "Venezuela",
  "Vietnam",
  "Virgin Islands (Brit)",
  "Virgin Islands (USA)",
  "Wake Island",
  "Wallis & Futana Is",
  "Yemen",
  "Zaire",
  "Zambia",
  "Zimbabwe"
]
`;var J=__dcg_shared_module_exports__['h'](X());var Yi=__dcg_shared_module_exports__['h'](X());var{If:iV,For:fte,Input:yte}=Yi.Components,Hv=class extends Yi.Class{constructor(){super(...arguments),this.filter=void 0,this.focusLocation=void 0,this.lastResultCount=0}init(){this.controller=this.props.controller()}template(){return Yi.createElement("div",{class:Yi.const("dcg-search-container"),onKeydown:this.bindFn(this.onKeydown)},Yi.createElement(iV,{predicate:this.props.renderWithInput},()=>Yi.createElement("div",{role:Yi.const("search"),class:Yi.const("dcg-searchable-dropdown")},Yi.createElement(yte,{class:()=>({"dcg-results-hidden":!this.showResults()}),didMount:this.bindFn(this.didMountInput),onInput:this.bindFn(this.onInputChange),value:this.bindFn(this.getFilterString),placeholder:()=>this.props.placeholder(),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFilterBeFocused),onFocusedChanged:this.bindFn(this.onFilterFocusChange)})}),Yi.createElement(iV,{predicate:()=>this.shouldShowDeleteX()},()=>Yi.createElement("i",{class:Yi.const("dcg-icon-remove dcg-remove-x dcg-do-not-blur"),role:Yi.const("button"),tabindex:Yi.const("0"),"aria-label":()=>this.controller.s("shared-calculator-button-clear"),onTap:this.bindFn(this.onDeleteXTapped)})))),Yi.createElement(iV,{predicate:()=>this.getFilteredOptions().length>0&&this.showResults()},()=>Yi.createElement("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}}},Yi.createElement(fte,{each:()=>this.getFilteredOptions(),key:e=>e.id+"-"+e.label},Yi.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-do-not-blur":!0,"dcg-no-input":!this.props.renderWithInput()}),role:Yi.const("listbox"),"aria-label":()=>this.controller.s("shared-calculator-label-search-results")},e=>Yi.createElement("div",{class:Yi.const("dcg-searchable-dropdown-option"),role:Yi.const("option"),onTap:t=>this.selectOption(e,t.device==="keyboard"),manageFocus:this.const({shouldBeFocused:()=>this.shouldOptionBeFocused(e),onFocusedChanged:t=>this.onOptionFocusChange(e,t)}),tabindex:Yi.const(0)},this.const(e.label)))))),Yi.createElement(iV,{predicate:()=>this.getFilteredOptions().length===0&&this.showResults()},()=>Yi.createElement("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}}},Yi.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-no-search-results":!0})},()=>this.controller.s("shared-calculator-text-search-results",{count:new uo(0)})))))}showResults(){var e,t;return(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)?!!this.focusLocation:!0}didMountInput(){var e,t;(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)||this.focusFilter()}shouldShowDeleteX(){return!!this.getFilterString()}onDeleteXTapped(e){this.onInputChange(""),this.props.externalControl?(this.props.externalControl().onClear(),e.device==="keyboard"&&this.focusFilter()):(this.focusFilter(),this.update())}shouldFilterBeFocused(){return this.focusLocation&&this.focusLocation.type==="filter"}onFilterFocusChange(e){e?this.focusFilter():(this.focusLocation=void 0,this.update())}shouldOptionBeFocused(e){return this.focusLocation&&this.focusLocation.type==="option"&&this.focusLocation.id===e.id}focusFilter(){this.focusLocation={type:"filter"},this.update()}focusOption(e){this.focusLocation={type:"option",id:e.id},this.update()}getFocusedOptionIndex(){if(!this.focusLocation||this.focusLocation.type!=="option")return-1;for(var e=this.focusLocation.id,t=this.getFilteredOptions(),i=0;i<t.length;i++){var n=t[i];if(n.id===e)return i}return-1}onOptionFocusChange(e,t){t?this.focusOption(e):(this.focusLocation=void 0,this.update())}onKeydown(e){switch(Re(e)){case Fl:if(this.shouldFilterBeFocused()){var t=this.getFilteredOptions();t.length===1&&this.selectOption(t[0],!0)}break;case So:this.moveFocusInDirection(-1)&&e.preventDefault();break;case Eo:this.moveFocusInDirection(1)&&e.preventDefault();break;case hp:e.preventDefault(),this.focusFirstOption();break;case pp:e.preventDefault(),this.focusLastOption();break;case Do:this.props.onCancel();break;case pl:e.shiftKey?this.moveFocusInDirection(-1)&&e.preventDefault():this.moveFocusInDirection(1)&&e.preventDefault();break}}moveFocusInDirection(e){var t=this.getFilteredOptions(),i=this.getFocusedOptionIndex(),n=i+e;if(n==-1&&this.props.renderWithInput())return this.focusFilter(),!0;var o=t[n];return o?(this.focusOption(o),!0):!1}focusFirstOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[0])}focusLastOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[e.length-1])}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){return this.props.externalControl?this.props.externalControl().getValue():this.filter||""}selectOption(e,t){var i,n;(n=(i=this.props).popoverOptionsOnFocus)!=null&&n.call(i)?this.onInputChange(e.label):this.onInputChange(""),this.focusLocation=void 0,this.update(),this.props.onChange({value:e.id,fromKeyboard:t})}getFilteredOptions(){var e=this.props.options(),t=this.getFilterString().toLowerCase().trim();return t&&(e=e.filter(function(i){return i.label.toLowerCase().indexOf(t)!==-1})),e}onUpdate(){let e=this.getFilteredOptions().length;this.focusLocation&&this.focusLocation.type==="filter"&&e!==this.lastResultCount&&xe(this.controller.s("shared-calculator-text-search-results",{count:new uo(e)})),this.lastResultCount=e}};var{If:ah,IfElse:YH,Input:XH,SwitchUnion:bte,Textarea:wte}=J.Components,xte=JSON.parse(JH).map(function(r){return{id:r,label:r}}),QH=[];for(qv=2020;qv>=1900;qv--)QH.push({id:qv+"",label:qv+""});var qv,vte={China:14,"Hong Kong":18,India:18,Indonesia:18,Phillipines:18,Russia:18,Austria:14,Belgium:13,Bulgaria:14,Croatia:16,Cyprus:14,"Czech Republic":15,Denmark:13,Estonia:13,Finland:13,France:15,Germany:16,Greece:15,Hungary:16,Ireland:16,Italy:14,Latvia:13,Lithuania:14,Luxembourg:16,Malta:13,Netherlands:16,Norway:13,Poland:16,Portugal:13,Romania:16,Slovakia:16,Slovenia:15,Spain:14,Sweden:13,Switzerland:16,"United Kingdom":13,Canada:13,"United States":13},zv=class extends J.Class{didUnmount(){this.unmounted=!0}init(){this.controller=this.props.controller(),this.selectedData={},this.userOwnsGraph=!1,this.isSubmittingEntry=!1,this.isVerifyingEligility=!1,this.controller.state.artContestURLFromShareMenu&&(this.overwriteGraphURL=this.controller.state.artContestURLFromShareMenu,this.controller.state.artContestURLFromShareMenu=void 0),Ei("art-contest::open-modal",{from:this.overwriteGraphURL?"share":"top-bar"}),this.checkForExistingSubmission()}getScreen(){return this.isCheckingSubmission?"checking-submission":this.currentSubmission?"showing-submission":this.shouldShowSaveAnimation()?"saving":this.shouldShowSaveFailed()?"save-failed":this.didSubmissionFail?"submit-failed":this.isSubmittingEntry?"submitting":this.didSubmissionSucceed?"submitted":this.isVerifyingEligility?"form":!this.userOwnsGraph||!this.isLoggedIn()?"ask-intention":"form"}template(){return J.createElement(ic,{controller:this.props.controller},J.createElement("div",{class:J.const("dcg-contest-submission-dialog")},bte(()=>this.getScreen(),{"checking-submission":()=>J.createElement("div",{class:J.const("dcg-save-animation-container dcg-contest-checking-submission-screen")},J.createElement("div",{class:J.const("dcg-saving")},J.createElement("div",{class:J.const("dcg-save-animation"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},J.createElement("span",{class:J.const("dcg-spinner")}),()=>"Checking submission"))),"check-failed":()=>J.createElement("div",{class:J.const("dcg-save-animation-container")},J.createElement("div",{class:J.const("dcg-saving")},J.createElement("div",{class:J.const("dcg-save-animation"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},()=>"Check failed"))),"showing-submission":()=>J.createElement("div",{class:J.const("dcg-art-contest-info-container")},J.createElement("div",{class:J.const("dcg-art-contest-world-image dcg-art-contest-submission-thumbnail")},J.createElement("img",{src:()=>{var e;return(e=this.currentSubmission)==null?void 0:e.thumbURL},alt:()=>this.controller.s("account-shell-label-submission-received")})),J.createElement("div",{class:J.const("dcg-contest-about")},J.createElement("div",{role:J.const("heading"),"aria-level":J.const("1"),class:J.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-label-submission-already-received")),J.createElement("div",{class:J.const("dcg-contest-text")},J.createElement(Wi,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-submission-already-received")},J.createElement("div",null,J.const("Your previous submission to the Global Math Art Contest was successfully received! You can click the link below to update your submission, any time before January 15th."))),J.createElement("div",{class:J.const("dcg-submission-section")},J.createElement("div",{class:J.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-name")),J.createElement("div",{class:J.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.name})),J.createElement("div",{class:J.const("dcg-submission-section")},J.createElement("div",{class:J.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-email")),J.createElement("div",{class:J.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.email})),J.createElement("div",{class:J.const("dcg-submission-section")},J.createElement("div",{class:J.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-artist-statement")),J.createElement("div",{class:J.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.artistStatement}))),J.createElement("div",null,J.createElement("div",{class:J.const("dcg-resubmit-link"),onTap:this.bindFn(this.submitANewGraph),tabindex:J.const(0),role:J.const("button")},()=>this.controller.s("account-shell-button-update-graph"))))),saving:()=>J.createElement("div",{class:J.const("dcg-save-animation-container")},J.createElement("div",{class:J.const("dcg-saving")},J.createElement("div",{class:J.const("dcg-save-animation"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},J.createElement("span",{class:J.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-saving-graph")))),"save-failed":()=>J.createElement("div",{class:J.const("dcg-save-animation-container")},J.createElement("div",{class:J.const("dcg-saving")},J.createElement("div",{class:J.const("dcg-save-animation"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},()=>this.controller.s("account-shell-error-save-art-contest")))),submitting:()=>J.createElement("div",{class:J.const("dcg-save-animation-container")},J.createElement("div",{class:J.const("dcg-saving")},J.createElement("div",{class:J.const("dcg-save-animation"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},J.createElement("span",{class:J.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-submitting")))),"submit-failed":()=>J.createElement("div",{class:J.const("dcg-save-animation-container")},J.createElement("div",{class:J.const("dcg-saving")},J.createElement("div",{class:J.const("dcg-save-animation"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},()=>this.controller.s("account-shell-error-submitting")))),submitted:()=>J.createElement("div",{class:J.const("dcg-save-animation-container")},J.createElement("div",{class:J.const("dcg-art-contest-success-image")},J.createElement("img",{src:J.const("/assets/img/contest/submitted.jpg"),alt:()=>this.controller.s("account-shell-text-alt-text-success")})),J.createElement("div",{class:J.const("dcg-save-success"),"aria-live":J.const("polite"),"aria-atomic":J.const("true")},()=>this.controller.s("account-shell-label-submission-received"),J.createElement("div",{class:J.const("dcg-save-animation-content")},J.createElement("div",null,J.createElement("div",{class:J.const("dcg-congrats-message")},J.createElement(Wi,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-success-paragraph")},J.const("If you'd like to revise your submission, feel free to resubmit anytime before"),J.createElement("span",{class:J.const("bold-text")},J.const(" January 15th")),J.const(". We'll only look at the most recent submission."))),J.createElement("div",{class:J.const("dcg-congrats-message")},()=>this.controller.s("account-shell-text-art-contest-congratulations")))))),"ask-intention":()=>J.createElement("div",{class:J.const("dcg-art-contest-info-container")},J.createElement("div",{class:J.const("dcg-art-contest-world-image")},J.createElement("img",{src:J.const("/assets/img/contest/globe.png"),alt:()=>this.controller.s("account-shell-text-alt-text-art-contest")})),J.createElement("div",{class:J.const("dcg-contest-about")},J.createElement("div",{role:J.const("heading"),"aria-level":J.const("1"),class:J.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-heading-math-art-contest")),J.createElement("div",{class:J.const("dcg-contest-text")},J.createElement(Wi,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-about-paragraph")},J.const("Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before"),J.createElement("span",{class:J.const("bold-text")},J.const(" January 15th ")),J.const("for a chance to be featured on our website and win other prizes!"),J.const(" "),J.createElement("a",{class:J.const("dcg-shared-blue-link"),href:()=>this.getBlogPostURL(),target:J.const("_blank"),didMount:e=>e.focus()},J.const("Learn more")))),J.createElement("div",null,J.createElement(ah,{predicate:()=>!this.getCannotSubmitReason()},()=>J.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-submit-this-graph-btn":!0,"dcg-disabled":this.shouldDisableSubmitThisGraph()}),onTap:this.bindFn(this.chooseSubmitThisGraph),tabindex:J.const(0),role:J.const("button")},()=>this.controller.s("account-shell-button-submit-graph"))),J.createElement(ah,{predicate:()=>!!this.getCannotSubmitReason()},()=>J.createElement("div",{class:J.const("dcg-cannot-submit-reason")},()=>this.getCannotSubmitReason())),J.createElement("div",{class:J.const("age-check-container")},()=>this.controller.s("account-shell-text-contest-under-16"),J.const(" "),J.createElement("a",{class:J.const("dcg-shared-blue-link"),onTap:this.bindFn(this.chooseVerifyEligibility)},()=>this.controller.s("account-shell-text-contest-verify-eligibility")))))),form:()=>J.createElement("div",null,J.createElement("div",{role:J.const("heading"),"aria-level":J.const("1"),class:J.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-heading-submit-graph")),J.createElement("div",{class:J.const("dcg-submission-form")},J.createElement("div",{class:J.const("dcg-country-and-year")},J.createElement("div",{class:J.const("dcg-form-section")},J.createElement("div",{class:J.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-country")),J.createElement(ah,{predicate:()=>!!this.getSelectedCountry()},()=>J.createElement("span",{class:J.const("dcg-shared-blue-link dcg-clear-country"),onTap:()=>this.setSelectedCountry(void 0),tabindex:J.const(0),role:J.const("button"),"aria-label":()=>this.controller.s("account-shell-narration-clear-selected-country")},()=>this.controller.s("account-shell-button-clear"))),YH(()=>!!this.getSelectedCountry(),{true:()=>J.createElement("div",{class:J.const("dcg-your-country-name")},()=>this.getSelectedCountry()),false:()=>J.createElement(Hv,{controller:this.const(this.controller),options:()=>this.getListOfCountries(),onChange:e=>this.setSelectedCountry(e.value),onCancel:()=>this.setSelectedCountry(void 0),renderWithInput:()=>!0,placeholder:()=>this.controller.s("account-shell-label-country-placeholder")})})),J.createElement(ah,{predicate:()=>this.shouldShowAgeOptions()},()=>J.createElement("div",{class:J.const("dcg-form-section")},J.createElement("div",{class:J.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-birth-year")),YH(()=>!!this.getSelectedYear(),{true:()=>J.createElement("div",{class:J.const("dcg-your-birth-year")},()=>this.getSelectedYear()),false:()=>J.createElement(Hv,{controller:this.const(this.controller),options:()=>this.getListOfYears(),onChange:e=>this.setSelectedYear(e.value),onCancel:()=>this.setSelectedYear(void 0),renderWithInput:()=>!0,placeholder:()=>this.controller.s("account-shell-label-birth-year-placeholder")})})))),J.createElement(ah,{predicate:()=>this.shouldShowEligible()&&!this.getCannotSubmitReason()},()=>J.createElement("div",{class:J.const("dcg-eligible-message dcg-teal-notice")},J.const("\u{1F389} "),()=>this.controller.s("account-shell-label-you-are-eligible"))),J.createElement(ah,{predicate:()=>this.shouldShowConsentOptions()},()=>J.createElement("div",null,J.createElement("div",{class:J.const("dcg-form-section-flex")},J.createElement("div",{class:J.const("dcg-form-section")},J.createElement("div",{class:J.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-name")),J.createElement("div",{class:J.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-heading-name-details")),J.createElement(XH,{class:this.const("dcg-shared-input-blue-outline"),onInput:e=>this.setUserName(e),value:this.bindFn(this.getUserName),placeholder:()=>this.controller.s("account-shell-label-full-name"),disabled:()=>!1})),J.createElement("div",{class:J.const("dcg-form-section")},J.createElement("div",{class:J.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-email")),J.createElement("div",{class:J.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-heading-email-details")),J.createElement(XH,{class:this.const("dcg-shared-input-blue-outline"),onInput:e=>this.setUserEmail(e),value:this.bindFn(this.getUserEmail),placeholder:()=>this.controller.s("account-shell-label-email-address"),disabled:()=>!1}))),J.createElement("div",{class:J.const("dcg-form-section")},J.createElement("div",{class:J.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-artist-statement")),J.createElement("div",{class:J.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-label-artiist-statement-description")),J.createElement(wte,{class:this.const("dcg-shared-input-blue-outline dcg-artist-statement-input"),onInput:e=>this.setArtistStatement(e),value:this.bindFn(this.getArtistStatement),maxlength:this.const(900),placeholder:()=>this.controller.s("account-shell-label-artist-statement-placeholder")})),J.createElement(Gt,{checked:this.bindFn(this.getConsentTicked),onChange:this.bindFn(this.toggleConsent)},()=>this.controller.s("account-shell-text-art-contest-copyright-agreement")),J.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isSubmitButtonDisabled(),"dcg-submit-this-graph-btn":!0}),onTap:this.bindFn(this.submitEntry),tabindex:J.const(0)},()=>this.controller.s("account-shell-button-submit-graph")),J.createElement("div",{class:J.const("dcg-disclaimer")},()=>this.controller.s("account-shell-text-art-contest-legal-disclaimer")))),J.createElement(ah,{predicate:()=>this.shouldShowEligible()&&!!this.getCannotSubmitReason()},()=>J.createElement("div",{class:J.const("dcg-login-notice dcg-teal-notice")},J.const("\u{1F389} "),()=>this.controller.s("account-shell-label-you-are-eligible"),J.const(" "),()=>this.getCannotSubmitReason())),J.createElement(ah,{predicate:()=>this.shouldShowIneligible()},()=>J.createElement("div",{class:J.const("dcg-ineligible-container")},J.createElement("i",{class:J.const("dcg-icon-error"),"aria-hidden":J.const("true")}),J.createElement(Wi,{i18n:this.const(this.controller),key:this.const("account-shell-text-artcontest-ineligible")},J.createElement("div",{class:J.const("dcg-ineligible-text-container")},J.createElement("div",{class:J.const("dcg-ineligible-text")},J.const("Based on your age and location, we aren\u2019t able to accept a graph submission from you this year.")),J.createElement("div",{class:J.const("dcg-ineligible-text")},J.const("Keep up the awesome graphing! There will be new contests every year."))))))))})))}getABActivityURL(){return"https://teacher.desmos.com/activitybuilder/custom/618be410b284c40a2c7b9111"}getBlogPostURL(){return"https://blog.desmos.com/articles/art-contest-launch-2022/"}returnToOpeningScreen(){this.isVerifyingEligility=!1,this.userOwnsGraph=!1,this.selectedData={email:this.selectedData.email,name:this.selectedData.name},this.update()}getGraphURL(){if(this.overwriteGraphURL)return this.overwriteGraphURL;var e=this.controller.graphsController.currentGraph,t=e&&e.hash||"";return"calculator/"+t}overwriteEntry(){this.selectedData.overwrite=!0,this.submitEntry()}async checkForExistingSubmission(){if(this.isLoggedIn()){this.isCheckingSubmission=!0,this.currentSubmission=void 0,Ei("art-contest::checking-submission",{});try{let e=await z8();e.thumbURL?(this.currentSubmission=e,Ei("art-contest::found-submission",{})):e.notFound?Ei("art-contest::found-no-submission",{}):(Ei("art-contest::check-failed",e),xe(this.controller.s("account-shell-error-submitting")))}catch(e){xe(this.controller.s("account-shell-error-submitting")),Ei("art-contest::check-failed",e)}finally{this.isCheckingSubmission=!1,this.unmounted||this.update()}}}async submitEntry(){if(this.isSubmitButtonDisabled())return;this.didSubmissionFail=!1,this.isSubmittingEntry=!0;let e={name:this.getUserName(),email:this.getUserEmail(),url:this.getGraphURL(),year:this.getSelectedYear(),ageGroup:this.getSelectedAgeGroup(),country:this.getSelectedCountry(),artistStatement:this.getArtistStatement(),overwrite:!0,lang:this.controller.getLanguage()};this.update(),Ei("art-contest::submit-sending",e);try{let t=await q8(e);t.previousSubmissionURL||(t.success?(this.didSubmissionSucceed=!0,Ei("art-contest::submit-success",{})):(this.didSubmissionFail=!0,Ei("art-contest::submit-failed",{}),xe(this.controller.s("account-shell-error-submitting"))))}catch(t){xe(this.controller.s("account-shell-error-submitting")),this.didSubmissionFail=!0,Ei("art-contest::submit-failed",{})}finally{this.isSubmittingEntry=!1,this.unmounted||this.update()}}shouldShowSaveAnimation(){return!!this.saveInProgress}shouldShowSaveFailed(){return!!this.didSaveFail}chooseVerifyEligibility(){this.isVerifyingEligility=!0,this.update()}submitANewGraph(){this.currentSubmission=void 0,this.update()}async chooseSubmitThisGraph(){if(!this.shouldDisableSubmitThisGraph()){if(this.isVerifyingEligility=!1,this.overwriteGraphURL||!this.controller.graphsController.hasUnsavedChanges()){this.userOwnsGraph=!0,this.update(),Ei("art-contest::choose-form",{});return}this.saveInProgress=!0,Ei("art-contest::save-sending",{}),this.update();try{let e=await this.controller.graphsController.shareGraph();this.didSaveFail=!1,this.saveInProgress=!1,this.userOwnsGraph=!0,this.overwriteGraphURL="calculator/"+e.hash,Ei("art-contest::save-success",{url:this.overwriteGraphURL})}catch(e){this.didSaveFail=!0,Ei("art-contest::save-failed",{})}finally{this.saveInProgress=!1,this.unmounted||this.update()}}}isLoggedIn(){return this.controller.isLoggedIn()}getCannotSubmitReason(){return this.isLoggedIn()?this.controller.isGraphComplexEnoughForContest()?"":this.controller.s("account-shell-text-art-contest-notice-default"):this.controller.s("account-shell-text-art-contest-notice-login")}shouldDisableSubmitThisGraph(){return!!this.getCannotSubmitReason()}shouldShowSubmissionOptions(){return this.isVerifyingEligility?!1:!this.userOwnsGraph||!this.isLoggedIn()}shouldShowCountryOptions(){return!this.shouldShowSubmissionOptions()}shouldShowAgeOptions(){return!(!this.shouldShowCountryOptions()||!this.getSelectedCountry())}shouldShowIneligible(){return!this.getSelectedCountry()||!this.getSelectedYear()?!1:!this.isSubmissionEligible()}shouldShowEligible(){return this.isVerifyingEligility?this.isSubmissionEligible():!1}setArtistStatement(e){this.selectedData.artistStatement=e,this.update()}setSelectedYear(e){this.selectedData.year!==e&&(this.selectedData.year=e,this.update(),Ei("art-contest::select-year",{year:e}))}setSelectedCountry(e){this.selectedData={country:e,name:this.controller.userController.name,email:this.controller.userController.email},this.update(),Ei("art-contest::select-country",{country:e})}getArtistStatement(){return this.selectedData.artistStatement||""}getSelectedCountry(){return this.selectedData.country}getSelectedYear(){return this.selectedData.year}getUserAgeInYears(){return 2022-parseFloat(this.selectedData.year||"")}getSelectedAgeGroup(){var e=this.getUserAgeInYears();return e>=19?"19+":e>=17?"17-18":e>=15?"15-16":e>=13?"13-14":""}getUserName(){return this.selectedData.name||""}setUserName(e){this.selectedData.name=e,this.update()}getUserEmail(){return this.selectedData.email||""}setUserEmail(e){this.selectedData.email=e,this.update()}getConsentTicked(){return!!this.selectedData.consent}getOverwriteTicked(){return!!this.selectedData.overwrite}toggleConsent(){this.selectedData.consent=!this.selectedData.consent,this.update(),Ei("art-contest::toggle-consent",{consent:this.selectedData.consent})}isSubmitButtonDisabled(){return!!(this.isSubmittingEntry||!this.selectedData.country||!this.selectedData.year||!this.selectedData.email||!this.selectedData.artistStatement||!this.selectedData.name||!this.selectedData.consent)}isSubmissionEligible(){if(!this.selectedData.country||!this.selectedData.year)return!1;var e=vte[this.selectedData.country]||16,t=this.getUserAgeInYears();return t>=e}shouldShowConsentOptions(){return this.isVerifyingEligility&&this.getCannotSubmitReason()?!1:this.isSubmissionEligible()}getListOfCountries(){return xte}getListOfYears(){return QH}};var lc=__dcg_shared_module_exports__['h'](X());var nV=class extends lc.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return lc.createElement(Lo,{title:()=>this.i18n.s("shared-title-account-reactivated"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},lc.createElement("div",{class:lc.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},lc.createElement("div",{class:lc.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-account-reactivated")),lc.createElement("div",{class:lc.const("dcg-shared-modal-actions-container")},lc.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0}),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.i18n.s("shared-button-continue-to-desmos")))))}};var Xi=__dcg_shared_module_exports__['h'](X());zl();var{IfDefined:Cte,For:Dte}=Xi.Components,oV={"dcg-actions":{label:"account-shell-label-feature-flag-actions",description:"account-shell-text-feature-flag-actions-description",learnMoreLink:"https://help.desmos.com/hc/en-us/articles/4407725009165"}},sV=class extends Xi.Class{init(){this.formErrors=[]}template(){return Xi.createElement("div",{class:Xi.const("dcg-advanced-settings")},Xi.createElement("div",{class:Xi.const("dcg-shared-account-paragraph")},()=>this.props.controller().s("account-shell-text-advanced-preferences-instructions")),Xi.createElement(Dte,{each:()=>__dcg_shared_module_exports__['D'](oV)},Xi.createElement("div",{class:Xi.const("dcg-feature-flag-list")},e=>Xi.createElement("div",null,Xi.createElement(Gt,{checked:()=>this.isFeatureFlagEnabled(e),disabled:()=>!!this.updateInFlight,onChange:t=>this.toggleFeatureFlag(e,t)},Xi.createElement("span",{class:Xi.const("dcg-feature-flag-label")},()=>this.label(e))),Xi.createElement("div",{class:Xi.const("dcg-feature-flag-description")},()=>this.description(e),Xi.const(" "),Xi.createElement("a",{href:()=>this.learnMoreLink(e),class:Xi.const("dcg-shared-blue-link"),target:Xi.const("_blank")},()=>this.props.controller().s("graphing-calculator-link-learn-more")))))),Xi.createElement(ns,{controller:this.props.controller,errors:()=>this.formErrors}),Cte(this.bindFn(this.getSaveProgress),e=>Xi.createElement("span",{"aria-live":Xi.const("assertive"),"aria-atomic":Xi.const("true"),class:Xi.const("dcg-shared-confirmation-message")},Xi.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0,"dcg-saving":e()==="saving"}),"aria-hidden":Xi.const("true")}),()=>e()==="saving"?this.props.controller().s("shared-calculator-label-saving"):this.props.controller().s("shared-message-information-saved"))))}getSaveProgress(){if(this.updateInFlight)return"saving";if(this.showSuccessConfirmation)return"saved"}isFeatureFlagEnabled(e){return this.updateInFlight&&e in this.updateInFlight?this.updateInFlight[e]:this.props.controller().userController.getFeatureFlags().indexOf(e)!==-1}async toggleFeatureFlag(e,t){this.updateInFlight={[e]:t},this.props.controller().dispatch({type:"render"});try{await this.props.controller().userController.updateFeatureFlags({featureFlagsUpdate:this.updateInFlight,lang:this.props.controller().getLanguage()}),this.showSuccessConfirmation=!0,setTimeout(()=>{this.showSuccessConfirmation=!1,this.props.controller().dispatch({type:"render"})},3e3)}catch(i){Yo(i),this.formErrors=[this.props.controller().s("account-shell-error-unknown")]}finally{this.updateInFlight=void 0,this.props.controller().dispatch({type:"render"})}}learnMoreLink(e){return oV[e].learnMoreLink}label(e){return this.props.controller().s(oV[e].label)}description(e){return this.props.controller().s(oV[e].description)}};var qo=__dcg_shared_module_exports__['h'](X());var{IfDefined:Ste}=qo.Components,aV=class extends qo.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return qo.createElement(Lo,{size:this.const("narrow"),onClose:()=>{this.controller.dispatch({type:"close-modal"})},i18n:this.const(this.controller),title:()=>this.controller.s("account-shell-label-delete-graph-modal-title"),class:this.const("dcg-delete-modal")},qo.createElement("div",{class:qo.const("dcg-delete-modal-contents")},qo.createElement("div",{class:qo.const("dcg-delete-confirmation-message")},this.bindFn(this.getConfirmationMessage)),Ste(()=>this.errorMessage,e=>qo.createElement("div",{class:qo.const("dcg-error-message")},e)),qo.createElement("div",{class:qo.const("dcg-action-buttons")},qo.createElement("span",{class:qo.const("dcg-shared-dark-gray-link"),role:qo.const("button"),tabindex:qo.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-cancel")),qo.createElement("div",{class:()=>({"dcg-shared-btn-red dcg-action-delete":!0,"dcg-disabled":!!this.deleteInProgress}),role:qo.const("button"),tabindex:()=>this.deleteInProgress?-1:0,"aria-label":this.bindFn(this.getButtonText),"aria-disabled":()=>!!this.deleteInProgress,onTap:this.bindFn(this.deleteGraph)},this.bindFn(this.getButtonText)))))}async deleteGraph(){this.deleteInProgress=!0;try{await this.graphsController._deleteGraph(this.graphsController.currentGraph),this.graphsController.clearGraphByUserAction(),this.controller.dispatch({type:"close-modal"})}catch(e){this.deleteInProgress=!1,this.errorMessage=this.controller.s("account-shell-error-deletion-error"),this.controller.dispatch({type:"render"})}}getConfirmationMessage(){return this.controller.s("account-shell-text-delete-graphs-confirmation",{count:this.getGraphCount(),title:this.getTitle()})}getButtonText(){return this.controller.s("account-shell-button-confirm-delete",{count:this.getGraphCount()})}getGraphCount(){return new uo(1)}getTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}};var{If:Ete,SwitchUnion:kte}=Bt.Components,lV=class extends Bt.Class{init(){this.controller=this.props.controller()}template(){return kte("modal",()=>this.controller.getModalState())({save:()=>Bt.createElement(lh,{controller:this.props.controller},Bt.createElement(Iy,{controller:this.props.controller})),rename:()=>Bt.createElement(lh,{controller:this.props.controller},Bt.createElement(Iy,{controller:this.props.controller})),duplicate:()=>Bt.createElement(lh,{controller:this.props.controller},Bt.createElement(Iy,{controller:this.props.controller})),"export-image":()=>Bt.createElement(lh,{controller:this.props.controller},Bt.createElement(Kv,{controller:this.props.controller})),login:()=>Bt.createElement(vI,{controller:this.props.controller}),signup:()=>Bt.createElement(xI,{controller:this.props.controller}),"recover-password":()=>Bt.createElement(DI,{controller:this.props.controller}),hotkeys:()=>Bt.createElement(lh,{controller:this.props.controller},Bt.createElement(kI,{controller:this.props.controller}),Bt.const(";")),"unsupported-browser":()=>Bt.createElement(lh,{controller:this.props.controller},Bt.createElement(GI,{controller:this.props.controller})),"account-settings":e=>Bt.createElement(OI,{controller:this.props.controller,extraTabs:this.bindFn(this.getAccountSettingsExtraTabs),initialTab:()=>e().initialTab}),"change-email":()=>Bt.createElement(PI,{controller:this.props.controller}),"account-reenabled":()=>Bt.createElement(nV,{controller:this.props.controller}),consent:()=>Bt.createElement(rV,{controller:this.props.controller}),"contest-submission":()=>Bt.createElement(Lo,{title:()=>"",size:this.const("wide"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Bt.createElement(zv,{controller:this.props.controller})),delete:()=>Bt.createElement(aV,{controller:this.props.controller}),none:()=>Bt.createElement("div",null)})}getAccountSettingsExtraTabs(){return{tabs:[{key:"advanced",wideLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),narrowLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),class:"advanced"}],createView:e=>e?e=="advanced"?Bt.createElement(sV,{controller:this.props.controller}):e:Bt.createElement("span",null)}}},lh=class extends Bt.Class{init(){this.controller=this.props.controller()}template(){return Bt.createElement("div",{role:Bt.const("dialog"),class:()=>({"dcg-modal-container":!0,"dcg-wide-modal":this.controller.getOpenModal()==="hotkeys","dcg-fixed-width-height":this.shouldBeFixedWidthHeight(),"dcg-export-modal":this.controller.getOpenModal()==="export-image"})},Bt.createElement("div",{class:Bt.const("dcg-modal-background"),onTap:()=>this.controller.dispatch({type:"close-modal"})}),Bt.createElement("div",{class:Bt.const("modal dcg-state-modals")},Bt.createElement(Ete,{predicate:()=>this.controller.getOpenModal()!=="consent"},()=>Bt.createElement("span",{role:Bt.const("link"),tabindex:Bt.const(0),"aria-label":Bt.const("Close Dialog"),class:Bt.const("action-close-modal close-modal internal-close"),onTap:()=>this.controller.dispatch({type:"close-modal"}),didMount:e=>{if(this.controller.getOpenModal()==="hotkeys")return e.focus()}},Bt.createElement("i",{class:Bt.const("dcg-icon-remove"),"aria-hidden":Bt.const("true")}))),this.children),Bt.createElement("span",{role:Bt.const("link"),tabindex:Bt.const(0),onTap:()=>this.controller.dispatch({type:"close-modal"}),"aria-label":Bt.const("Close Dialog"),class:Bt.const("action-close-modal close-modal external-close")},Bt.createElement("i",{class:Bt.const("dcg-icon-remove"),"aria-hidden":Bt.const("true")})))}shouldBeFixedWidthHeight(){var e=this.controller.getOpenModal();return e==="export-image"||e==="contest-submission"}};ct();var Yu=function(e,t,i,n){this.type=e,this.bubbles=t,this.cancelable=i,this.target=n};Yu.prototype={stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}};var Gte={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function Ite(r){var e;if(typeof DOMParser!="undefined"){var t=new DOMParser;e=t.parseFromString(r,"text/xml")}else e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(r);return e}var Vte={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};function Tte(r,e){e.addEventListener(r,function(t){var i=e["on"+r];i&&typeof i=="function"&&i.call(t.target,t)})}function cV(){this._eventListeners={};for(var r=["loadstart","progress","load","error","abort","loadend"],e=r.length-1;e>=0;e--)Tte(r[e],this)}cV.prototype={addEventListener:function(e,t){this._eventListeners[e]=this._eventListeners[e]||[],this._eventListeners[e].push(t)},removeEventListener:function(e,t){for(var i=this._eventListeners[e]||[],n=0,o=i.length;n<o;++n)if(i[n]==t)return i.splice(n,1)},dispatchEvent:function(e){for(var t=e.type,i=this._eventListeners[t]||[],n=0;n<i.length;n++)typeof i[n]=="function"?i[n].call(this,e):i[n].handleEvent(e);return!!e.defaultPrevented},_progress:function(e,t,i){var n=new Yu("progress");n.target=this,n.lengthComputable=e,n.loaded=t,n.total=i,this.dispatchEvent(n)}};function Bi(){cV.call(this),this.readyState=Bi.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new cV}Bi.prototype=new cV;Bi.UNSENT=0;Bi.OPENED=1;Bi.HEADERS_RECEIVED=2;Bi.LOADING=3;Bi.DONE=4;var ZH={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,async:!0,withCredentials:!1,open:function(e,t,i,n,o){this.method=e,this.url=t,this.async=typeof i=="boolean"?i:!0,this.username=n,this.password=o,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,this._readyStateChange(Bi.OPENED)},setRequestHeader:function(e,t){if(eq(this),Vte[e]||/^(Sec-|Proxy-)/.test(e))throw new Error('Refused to set unsafe header "'+e+'"');this.requestHeaders[e]?this.requestHeaders[e]+=","+t:this.requestHeaders[e]=t},send:function(e){if(eq(this),!/^(get|head)$/i.test(this.method)){var t=!1;Object.keys(this.requestHeaders).forEach(function(i){i.toLowerCase()==="content-type"&&(t=!0)}),!t&&!(e||"").toString().match("FormData")&&(this.requestHeaders["Content-Type"]="text/plain;charset=UTF-8"),this.requestBody=e}this.errorFlag=!1,this.sendFlag=this.async,this._readyStateChange(Bi.OPENED),typeof this.onSend=="function"&&this.onSend(this),this.dispatchEvent(new Yu("loadstart",!1,!1,this)),Bi.onSend&&Bi.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>Bi.UNSENT&&this.sendFlag&&(this._readyStateChange(Bi.DONE),this.sendFlag=!1),this.readyState=Bi.UNSENT,this.dispatchEvent(new Yu("abort",!1,!1,this)),typeof this.onerror=="function"&&this.onerror()},error:function(){this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>Bi.UNSENT&&this.sendFlag&&(this.sendFlag=!1),this.readyState=Bi.DONE,this.dispatchEvent(new Yu("error",!1,!1,this)),typeof this.onerror=="function"&&this.onerror()},getResponseHeader:function(e){if(this.readyState<Bi.HEADERS_RECEIVED||/^Set-Cookie2?$/i.test(e))return null;e=e.toLowerCase();for(var t in this.responseHeaders)if(t.toLowerCase()==e)return this.responseHeaders[t];return null},getAllResponseHeaders:function(){if(this.readyState<Bi.HEADERS_RECEIVED)return"";var e="";for(var t in this.responseHeaders)this.responseHeaders.hasOwnProperty(t)&&!/^Set-Cookie2?$/i.test(t)&&(e+=t+": "+this.responseHeaders[t]+`\r
`);return e},overrideMimeType:function(e){typeof e=="string"&&(this.forceMimeType=e.toLowerCase())},_readyStateChange:function(e){this.readyState=e,typeof this.onreadystatechange=="function"&&this.onreadystatechange(new Yu("readystatechange")),this.dispatchEvent(new Yu("readystatechange")),this.readyState==Bi.DONE&&(this.dispatchEvent(new Yu("load",!1,!1,this)),this.dispatchEvent(new Yu("loadend",!1,!1,this)))},_setResponseHeaders:function(e){this.responseHeaders={};for(var t in e)e.hasOwnProperty(t)&&(this.responseHeaders[t]=e[t]);this.forceMimeType&&(this.responseHeaders["Content-Type"]=this.forceMimeType),this.async?this._readyStateChange(Bi.HEADERS_RECEIVED):this.readyState=Bi.HEADERS_RECEIVED},_setResponseBody:function(e){Mte(this),Ate(this),Lte(e);var t=this.chunkSize||10,i=0;this.responseText="";do this.async&&this._readyStateChange(Bi.LOADING),this.responseText+=e.substring(i,i+t),i+=t;while(i<e.length);var n=this.getResponseHeader("Content-Type");if(this.responseText&&(!n||/(text\/xml)|(application\/xml)|(\+xml)/.test(n)))try{this.responseXML=Ite(this.responseText)}catch(o){}this.async?this._readyStateChange(Bi.DONE):this.readyState=Bi.DONE},respond:function(e,t,i){this._setResponseHeaders(t||{}),this.status=typeof e=="number"?e:200,this.statusText=Gte[this.status],this._setResponseBody(i||"")}};for(W0 in ZH)Bi.prototype[W0]=ZH[W0];var W0;function eq(r){if(r.readyState!==Bi.OPENED)throw new Error("INVALID_STATE_ERR");if(r.sendFlag)throw new Error("INVALID_STATE_ERR")}function Mte(r){if(r.readyState==Bi.DONE)throw new Error("Request done")}function Ate(r){if(r.async&&r.readyState!=Bi.HEADERS_RECEIVED)throw new Error("No headers received")}function Lte(r){if(typeof r!="string"){var e=new Error("Attempted to respond to fake XMLHttpRequest with "+r+", which is not a string.");throw e.name="InvalidBodyException",e}}var cc=null,Wv=null,Y0=!1,j0={},tq=0;function Ote(){window.XMLHttpRequest=Bi,Bi.onSend=function(r){var e=tq+"";tq+=1,j0[e]=r,cc.methods.proxyXHR(JSON.stringify({id:e,url:r.url,method:r.method,headers:r.requestHeaders,body:r.requestBody}))}}function Pte(r){var e=O(r.target).closest("a[href]")[0];if(e&&e.protocol==="file:"){var t=e.getAttribute("href");t[0]!=="/"&&(t="/"+t),e.setAttribute("href",th()+t)}}dp?($v=[],dV=[],rq=function(r){var e=dV.length?dV.pop():$v.length;return $v[e]=r,e},iq=function(r){var e=$v[r];return $v[r]=null,dV.push(r),e},cc={loaded:!1,methods:{},queuedMethodCalls:[]},O(function(){var r=[];window.ObjC_callback=function(t){cc.loaded=!0,t.split(" ").forEach(function(i){cc.methods[i]=function(n,o){var s=o?rq(o):-1;r.push("desmos:"+i+"/"+s+"/"+encodeURIComponent(n)),r.length===1&&e.attr("src",r[0])}}),this.ObjC_callback=function(i,n){try{i!==-1&&iq(i)(n)}finally{r.shift(),r.length>0&&e.attr("src",r[0])}},cc.methods.proxyXHR&&Ote(),cc.queuedMethodCalls.forEach(function(i){jv[i.methodName].apply(jv,i.args)})};var e=O('<iframe id="objc-bridge" style="position:absolute; left: -1000px; z-index: -1" src="desmos:loaded"/>').appendTo(document.body)})):up?Wv=window.Android:Y0=!0;var $v,dV,rq,iq,_te=["hideLoadingScreen","gaEvent","openGoogleLogin","openAppleLogin","logout","saveCookies","deleteCookies","startSingleAppMode","endSingleAppMode","setWWWSubdomain","sendSerializedAnalyticsEvent","sendStoredLogsToDesmos"],J0=class extends Wr{constructor(){super();this.heartbeatTimeout=void 0,this.observeEvent("started resumed",t=>{this.gaEvent(t+":"+this.versionNumber),this.incrementHeartbeat(0)}),document.location.search.indexOf("simulateVersionNumber")!==-1&&(this.versionNumber="?.?.?");for(let t of _te)this[t]=function(){Y0||(Wv?Wv[t]?Wv[t].apply(Wv,arguments):__dcg_shared_module_exports__['k'].log("call to missing Android method",t,arguments):cc&&(cc.loaded?cc.methods[t]?cc.methods[t].apply(cc,arguments):__dcg_shared_module_exports__['k'].log("call to missing ObjC method",t,arguments):cc.queuedMethodCalls.push({methodName:t,args:arguments})))}}heartbeat(t){clearTimeout(this.heartbeatTimeout),this.gaEvent("heartbeat-"+10*t),this.incrementHeartbeat(t)}incrementHeartbeat(t){clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(()=>{this.heartbeat(t+1)},600*1e3)}_started(t,i){this.appId=t,this.versionNumber=i,this.triggerEvent("started",void 0)}_resumed(){this.triggerEvent("resumed",void 0)}handleAndroidBackButtonAndReturnIfShouldMoveToBackground(){var t=window.Calc&&window.Calc.controller;return t&&t.isKeypadOpen()?(pi(),"false"):(t=window.MainController,t&&t.handleAndroidBackButton()?"false":"true")}isInApp(){return window.platform&&window.platform!=="www"}onGoogleAuthResult(t){this.triggerEvent("onGoogleAuthResult",t)}onAppleAuthResult(t){this.triggerEvent("onAppleAuthResult",t)}onObjCXHRProxyResult(t){var i=t.id,n=j0[i];delete j0[i],t.status===0?n.error():n.respond(t.status,t.headers,t.body)}sendAnalyticsEvent(t,i){this.sendSerializedAnalyticsEvent(JSON.stringify({type:t,payload:i}))}},jv=new J0;Y0||(window.AppBridge=jv,document.addEventListener("click",Pte,!0));window.__dcgAppBridgeDefined=!0;var DV=__dcg_shared_module_exports__['h'](X());var me=__dcg_shared_module_exports__['h'](X());ct();var Nt=__dcg_shared_module_exports__['h'](X());ct();var{If:Jv}=Nt.Components,Hy=class extends Nt.Class{template(){return Nt.createElement("div",{role:Nt.const("listitem"),class:()=>({"saved-graph":!0,"graph-link-container":!0,"dcg-selected":this.props.isSelected()}),onTap:e=>{e.wasHandled()||this.props.onTap(e)}},Nt.createElement(Jv,{predicate:()=>!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>Nt.createElement("div",{role:Nt.const("link"),tabindex:Nt.const(0),class:()=>({"graph-link":!0,"dcg-action-preview-graph":!0,"example-graph":this.props.isExample()}),didMount:this.bindFn(this.didMount)},Nt.createElement("span",{class:Nt.const("dcg-thumb"),style:this.const({"background-image":`url(${this.props.getThumbURL()})`})}),Nt.createElement("div",{class:Nt.const("dcg-graph-details")},Nt.createElement("div",{class:Nt.const("dcg-title")},this.props.getTitle),Nt.createElement("div",{class:Nt.const("dcg-subtitle dcg-graph-date")},()=>this.props.isExample()?this.props.s("account-shell-label-mygraphs-example"):this.props.getDisplayDate())))),Nt.createElement(Jv,{predicate:this.props.isDeletingGraph},()=>Nt.createElement("div",{"aria-live":Nt.const("assertive"),"aria-atomic":Nt.const("true"),class:Nt.const("deleting"),handleEvent:Nt.const("true"),onTap:()=>{this.props.canCancelDelete()&&this.props.cancelDeleteGraph()}},()=>this.props.s("account-shell-text-mygraphs-deleting"),Nt.createElement(Jv,{predicate:this.props.canCancelDelete},()=>Nt.createElement("div",{role:Nt.const("button"),tabindex:Nt.const(0),class:Nt.const("cancel-delete")},()=>this.props.s("account-shell-button-mygraphs-cancel"))))),Nt.createElement(Jv,{predicate:this.props.didDeleteGraphFail},()=>Nt.createElement("div",{"aria-live":Nt.const("assertive"),"aria-atomic":Nt.const("true"),class:Nt.const("retry-delete"),handleEvent:Nt.const("true")},()=>this.props.s("account-shell-error-mygraphs-error-deleting"),Nt.createElement("a",{role:Nt.const("button"),tabindex:Nt.const(0),class:Nt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-try-again")),()=>this.props.s("account-shell-text-mygraphs-or"),Nt.createElement("a",{role:Nt.const("button"),tabindex:Nt.const(0),class:Nt.const("dcg-action-cancelremovegraph"),onTap:this.props.cancelDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-cancel")))),Nt.createElement(Jv,{predicate:()=>!this.props.isExample()&&!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>Nt.createElement("span",{class:Nt.const("actions"),handleEvent:Nt.const("true")},Nt.createElement("span",{role:Nt.const("button"),tabindex:Nt.const(0),"aria-label":()=>this.props.s("account-shell-button-mygraphs-delete-title",{graphTitle:this.props.getTitle()}),class:Nt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},Nt.createElement(Ke,{tooltip:()=>this.props.s("account-shell-button-mygraphs-delete-graph"),gravity:this.const("e")},Nt.createElement("i",{class:Nt.const("dcg-icon-remove"),"aria-hidden":Nt.const("true")}))))))}didUpdate(){this.props.isSelected()&&O(this.node).trigger("focus")}didMount(e){this.node=e,O(this.node).on("focus",()=>{this.props.isSelected()||this.props.onFocus()})}};var Rs=__dcg_shared_module_exports__['h'](X());var Ii=__dcg_shared_module_exports__['h'](X());var{If:uV}=Ii.Components,pV=class extends Ii.Class{shouldShowSaveButton(){return!this.props.isSaving()&&!this.props.didSaveRecentlySucceed()&&!this.props.didSaveRecentlyFail()}template(){return Ii.createElement("div",{class:Ii.const("save-btn-container")},Ii.createElement(uV,{predicate:()=>this.shouldShowSaveButton()},()=>Ii.createElement("div",{role:Ii.const("button"),onTap:this.props.onTap,class:()=>({"dcg-action-save":!0,"dcg-btn-primary":this.props.enabled(),"dcg-disabled":!this.props.enabled()}),"aria-disabled":()=>!this.props.enabled(),tabindex:()=>this.props.enabled()?0:-1},()=>this.props.s("account-shell-button-mygraphs-save"))),Ii.createElement(uV,{predicate:this.props.isSaving},()=>Ii.createElement("div",{class:Ii.const("save-saving")},Ii.createElement("span",{class:Ii.const("dcg-spinner-dark")}))),Ii.createElement(uV,{predicate:this.props.didSaveRecentlyFail},()=>Ii.createElement("div",{class:Ii.const("save-error"),"aria-live":Ii.const("assertive"),"aria-atomic":Ii.const("true")},Ii.createElement("i",{class:Ii.const("dcg-icon-remove"),"aria-hidden":Ii.const("true")}),Ii.const(" "),()=>this.props.s("account-shell-text-error"))),Ii.createElement(uV,{predicate:this.props.didSaveRecentlySucceed},()=>Ii.createElement("div",{class:Ii.const("save-success")},Ii.createElement("i",{class:Ii.const("dcg-icon-check"),"aria-hidden":Ii.const("true")}),Ii.const(" "),()=>this.props.s("account-shell-text-saved"))))}};var hV=class extends Rs.Class{template(){return Rs.createElement("div",{class:Rs.const("graph-link-container graph-in-progress")},Rs.createElement("div",{role:Rs.const("link"),"aria-label":()=>this.props.s("account-shell-button-mygraphs-save"),class:Rs.const("graph-link dcg-action-preview-graph"),onTap:this.props.openSaveDialog},Rs.createElement("span",{class:Rs.const("dcg-thumb"),style:()=>({"background-image":`url(${this.props.getThumbnail()})`})}),Rs.createElement("div",{class:Rs.const("dcg-graph-details")},Rs.createElement("div",{class:Rs.const("dcg-title")},this.props.getTitle),Rs.createElement("div",{class:Rs.const("dcg-subtitle dcg-save-status")},()=>this.props.isSaveEnabled()?this.props.wasCurrentGraphEverSaved()?this.props.s("account-shell-label-mygraphs-last-saved",{date:this.props.getDisplayDate()}):this.props.s("account-shell-label-mygraphs-unsaved-graph"):this.props.s("account-shell-label-mygraphs-no-unsaved-changes"))),Rs.createElement(pV,{enabled:this.props.isSaveEnabled,isSaving:this.props.isSaving,didSaveRecentlySucceed:this.props.didSaveRecentlySucceed,didSaveRecentlyFail:this.props.didSaveRecentlyFail,onTap:()=>{},s:this.props.s})))}shouldUpdate(){return this.props.isOpen()}};var lr=__dcg_shared_module_exports__['h'](X());ct();var{Input:Fte,If:gV}=lr.Components,nq=4,mV=class extends lr.Class{willUpdate(){this.props.isSearching()||this.setSearchValue("")}setSearchValue(e){this.searchValue!==e&&(this.searchValue=e,this.props.updateFilter(e))}init(){this.controller=this.props.controller(),this.searchValue=""}template(){return lr.createElement("div",{class:lr.const("dcg-user-bar")},lr.createElement(gV,{predicate:()=>!this.props.isSearching()},()=>lr.createElement("div",{class:lr.const("dcg-account-link-container")},lr.createElement("div",{class:lr.const("dcg-account-link"),"dcg-menu-button":lr.const("account"),role:lr.const("button"),tabindex:lr.const(0),"aria-haspopup":lr.const("true"),"aria-expanded":()=>this.controller.getOpenMenu()==="account","aria-label":lr.const("Account Information"),onTap:e=>{if(this.measureAccountDropdownArrowOffset(),this.props.controller().dispatch({type:"toggle-menu",payload:"account"}),e.device=="keyboard"){let i=this.props.controller().getOpenMenu()==="account"?".dcg-action-accountsettings":".dcg-account-link";O(i).trigger("focus")}}},lr.createElement("span",{class:lr.const("dcg-variable-name")},()=>this.controller.userController.getFirstName()),lr.createElement("i",{class:lr.const("dcg-icon-caret-down"),"aria-hidden":lr.const("true")})),lr.createElement(gV,{predicate:()=>this.controller.getOpenMenu()==="account"&&this.controller.mygraphsController.isMygraphsOpen()},()=>lr.createElement(Gy,{controller:this.const(this.controller),left:()=>`${nq}px`,arrowLeft:()=>`${this.accountDropdownArrowOffset-nq}px`})))),lr.createElement(gV,{predicate:()=>!this.props.isSearching()},()=>lr.createElement("div",{role:lr.const("link"),tabindex:lr.const("0"),class:lr.const("dcg-search-btn"),onTap:e=>{e.preventDefault(),this.props.openSearch(),O(".search-container").find("input").trigger("focus")}},lr.createElement("i",{class:lr.const("dcg-icon-search search-icon"),"aria-hidden":lr.const("true")}),lr.createElement("span",{class:lr.const("dcg-menu-title")},()=>this.props.s("account-shell-heading-title-mygraphs-search")))),lr.createElement(gV,{predicate:()=>this.props.isSearching()},()=>lr.createElement("div",{role:lr.const("search"),class:lr.const("search-container search-open")},lr.createElement("i",{class:lr.const("dcg-icon-search search-icon"),"aria-hidden":lr.const("true")}),lr.createElement(Fte,{placeholder:()=>this.props.s("account-shell-text-mygraphs-search-by-title"),onInput:this.bindFn(this.setSearchValue),onFocus:this.props.openSearch,value:()=>this.searchValue,didMount:this.bindFn(this.didMountSearch)}),lr.createElement("span",{role:lr.const("button"),tabindex:lr.const(0),"aria-label":()=>this.props.s("account-shell-heading-title-mygraphs-search"),class:lr.const("dcg-icon-remove dcg-action-close-search"),onTap:e=>{e.preventDefault(),this.props.closeSearch()}}))))}didMountDropdown(e){O(e).on("touchstart",t=>t.preventDefault())}didMountSearch(e){O(e).on("blur",()=>{O(e).val()||this.props.closeSearch()})}measureAccountDropdownArrowOffset(){var i,n,o;let e=O(".dcg-user-bar .dcg-account-link i"),t=((n=(i=e.offset())==null?void 0:i.left)!=null?n:0)+((o=e.width())!=null?o:0)/2;this.accountDropdownArrowOffset=t}};var wi=__dcg_shared_module_exports__['h'](X());var Kr=__dcg_shared_module_exports__['h'](X());var{If:fV}=Kr.Components,ch=class extends Kr.Class{template(){return Kr.createElement("div",{class:Kr.const("dcg-loading-container")},Kr.createElement(fV,{predicate:()=>!this.props.didDataLoadFail()},()=>Kr.createElement("div",{class:Kr.const("dcg-graph-loading")},Kr.createElement("div",{class:Kr.const("pulsing-message")},()=>this.props.s("account-shell-text-mygraphs-loading")),Kr.createElement("div",{role:Kr.const("link"),tabindex:Kr.const("0"),class:Kr.const("dcg-cancel-while-loading"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))),Kr.createElement(fV,{predicate:()=>this.props.didDataLoadFail()},()=>Kr.createElement("div",{class:Kr.const("dcg-graph-loading-error"),"aria-live":Kr.const("assertive"),"aria-atomic":Kr.const("true")},Kr.createElement("div",{class:Kr.const("dcg-graph-loading-error-title")},()=>this.props.s("account-shell-error-mygraphs-error-loading")),Kr.createElement("div",{class:Kr.const("dcg-graph-loading-error-subtitle")},()=>this.props.s("account-shell-error-mygraphs-check-connection")),Kr.createElement("div",{class:Kr.const("dcg-graph-loading-error-options")},Kr.createElement("span",{role:Kr.const("button"),tabindex:Kr.const("0"),class:Kr.const("dcg-action-try-again dcg-btn-blue dcg-btn-medium"),onTap:this.props.requestLoadGraphData},()=>this.props.s("account-shell-button-mygraphs-try-again")),Kr.createElement(fV,{predicate:()=>!!this.props.onCancel},()=>Kr.createElement("span",null,()=>this.props.s("account-shell-text-mygraphs-or"))),Kr.createElement(fV,{predicate:()=>!!this.props.onCancel},()=>Kr.createElement("span",{role:Kr.const("button"),tabindex:Kr.const("0"),class:Kr.const("dcg-action-cancel dcg-btn-light-gray dcg-btn-medium"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))))))}};var{If:Rte}=wi.Components,yV=class extends wi.Class{didMountGraphPreview(e){return this.graphPreview=e,this.updateGraphPreviewTop()}didMountArrow(e){return this.arrow=e,this.updateArrowTop()}didMountCalc(e){return this.previewCalc=this.props.makeAPI(e),this.updatePreviewCalc()}willUnmountCalc(){this.previewCalc&&this.previewCalc.destroy&&this.previewCalc.destroy()}didUpdate(){return this.updateGraphPreviewTop(),this.updateArrowTop(),this.updatePreviewCalc()}updateGraphPreviewTop(){this.graphPreview.style.top=this.getTopOffset()+"px"}updateArrowTop(){this.arrow.style.top=this.getArrowOffset()+"px"}updatePreviewCalc(){let e=this.props.getGraphData();e!==this.cachedGraphData&&(this.cachedGraphData=e,this.previewCalc.setState(e),this.previewCalc.resize())}getMaxTop(){return window.innerHeight-this.graphPreview.offsetHeight-10}getIdealTop(){let e=this.props.alignToNode();return e==null?null:Ul(e).top+.5*e.offsetHeight-60}getTopOffset(){let e=this.getIdealTop();if(e==null)return 0;let t=this.getMaxTop();return Math.min(e,t)}getArrowOffset(){let e=this.getIdealTop();if(e==null)return 60;let t=this.getTopOffset();return 60+e-t}template(){return wi.createElement("div",{class:wi.const("graph-preview"),didMount:this.bindFn(this.didMountGraphPreview)},wi.createElement("div",{class:wi.const("dcg-graph-preview-info")},wi.createElement("h4",{class:wi.const("dcg-title")},this.props.getTitle),wi.createElement("span",{role:wi.const("button"),tabindex:wi.const("0"),class:wi.const("dcg-action-cancel"),onTap:this.props.onCancel},wi.createElement("i",{class:wi.const("dcg-icon-remove"),"aria-hidden":wi.const("true")}))),wi.createElement("div",{class:wi.const("preview-graph-area")},wi.createElement(Rte,{predicate:()=>!this.props.getGraphData()},()=>wi.createElement(ch,{didDataLoadFail:this.props.didDataLoadFail,onCancel:this.props.onCancel,requestLoadGraphData:this.props.requestLoadGraphData,s:this.props.s.bind(this.props)})),wi.createElement("div",{didMount:this.bindFn(this.didMountCalc),willUnmount:this.bindFn(this.willUnmountCalc),class:()=>({"dcg-preview-calculator":!0,"dcg-visible":this.props.getGraphData()})}),wi.createElement("div",{class:()=>({"screenshot-clickjack":!0,"dcg-action-open-graph":!0,"dcg-visible":this.props.getGraphData()})},wi.createElement("span",{role:wi.const("button"),tabindex:wi.const("0"),class:wi.const("dcg-action-open-graph dcg-open-graph-btn dcg-btn-primary"),onTap:this.props.onOpenGraph},this.props.getOpenText))),wi.createElement("div",{class:wi.const("active-arrow"),didMount:this.bindFn(this.didMountArrow)},wi.createElement("div",{class:wi.const("dcg-graphic")})))}};var _o=__dcg_shared_module_exports__['h'](X());var{If:X0}=_o.Components,bV=class extends _o.Class{template(){return _o.createElement("div",{class:()=>({"syncing-status-bar":!0,visible:this.props.isSyncingGraphs()||this.props.didSyncFail()})},_o.createElement(X0,{predicate:this.props.isSyncingGraphs},()=>_o.createElement("div",{class:_o.const("syncing-status-text")},_o.createElement("span",{class:_o.const("dcg-pulse")},()=>this.props.s("account-shell-text-mygraphs-updating-graphs")))),_o.createElement(X0,{predicate:()=>!this.props.isSyncingGraphs()&&!this.props.didSyncFail()},()=>_o.createElement("div",{class:_o.const("success-status-text")},_o.createElement("i",{class:_o.const("dcg-icon-check"),"aria-hidden":_o.const("true")}),_o.const(" "),()=>this.props.s("account-shell-text-mygraphs-synced"))),_o.createElement(X0,{predicate:this.props.didSyncFail},()=>_o.createElement("div",{class:_o.const("error-status-text"),onTap:this.props.requestSyncGraphs},()=>this.props.s("account-shell-button-mygraphs-offline-try-again"))))}};var Qs=__dcg_shared_module_exports__['h'](X());var wV=class extends Qs.Class{init(){this.controller=this.props.controller()}template(){return Qs.createElement("div",{class:Qs.const("dcg-account-reminder")},Qs.createElement("span",{class:Qs.const("dcg-login")},Qs.createElement("a",{role:Qs.const("link"),tabindex:Qs.const(0),class:Qs.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:this.props.onSignIn},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),Qs.createElement("a",{role:Qs.const("link"),tabindex:Qs.const(0),class:Qs.const("dcg-create-account dcg-btn dcg-btn-primary dcg-tool-color dcg-action-createaccount"),onTap:this.props.onCreateAccount},()=>this.props.controller().s("account-shell-button-sign-up"))),Qs.createElement("div",null,()=>this.getToSaveYourText()))}getToSaveYourText(){return this.controller.product==="graphing"?this.controller.s("account-shell-text-mygraphs-to-save-graphs"):this.controller.product==="geometry"?this.controller.s("account-shell-text-mygraphs-to-save-constructions"):""}};var jd=__dcg_shared_module_exports__['h'](X()),Pg=class extends jd.Class{template(){return jd.createElement("div",{class:jd.const("dcg-mygraphs-section-title-container")},jd.createElement("span",{role:jd.const("heading"),"aria-level":jd.const("1"),class:jd.const("dcg-mygraphs-section-title")},()=>this.props.title()))}};var{If:zo,For:Q0,IfElse:oq}=me.Components,xV="default",dh="search",Nte=50,vV=class extends me.Class{constructor(){super(...arguments),this.state="default"}didUpdate(){this.previewGraph&&xa(this.getSelectedNode(),this.scrollableNode,60)&&this.update()}didMountScrollable(e){this.scrollableNode=e,O(this.scrollableNode).on("focusin",i=>{if(this.previewGraph&&!O(i.target).hasClass("graph-link"))return this.previewItem(void 0)}),O(window).on("keydown",i=>{if(!this.props.isOpen())return!0;switch(Re(i)){case So:return this.selectUp(i);case Eo:return this.selectDown(i)}});let t=__dcg_shared_module_exports__['B'](this.hidePreviewIfTooScrolled.bind(this),200);O(this.scrollableNode).on("scroll",t),this.debouncedFetchSelectedGraph=__dcg_shared_module_exports__['C'](this.fetchSelectedGraph.bind(this),200)}fetchSelectedGraph(){return this.props.graphsController().loadDataForGraph(this.previewGraph)}hidePreviewIfTooScrolled(){if(!this.previewGraph)return;let e=O(this.getSelectedNode()),t=O(this.findRootNode()).find(".active-arrow"),i=e.offset(),n=e.height(),o=t.offset();if(i===void 0||n===void 0||o===void 0)return;let s=i.top+.5*n,a=o.top;Math.abs(s-a)>10&&this.previewItem(void 0)}openSearch(){this.state=dh,this.previewItem(void 0)}closeSearch(){this.state=xV,this.previewItem(void 0)}updateFilter(e){this.filter=e,this.update()}getMaxGraphs(){return this.maxGraphs||Nte}getCountRemaining(){return this.getSavedGraphs().length-this.getMaxGraphs()}showMoreGraphs(e){let t=this.getMaxGraphs();if(this.getCountRemaining()<2*t?this.maxGraphs=1/0:this.maxGraphs=2*t,this.update(),(e!=null?e.device:void 0)==="keyboard"){let i=this.getSavedAndExampleGraphs(),n=i?i[t]:void 0;n&&this.previewItem(n)}}getSelectedNode(){return O(".dcg-mygraphs .graph-link-container.dcg-selected")[0]}selectUp(e){if(!this.previewGraph)return;e.preventDefault();let t=this.getSavedAndExampleGraphs();if(!t.length)return;let i=this.previewGraph?this.previewGraph.hash:void 0,n=__dcg_shared_module_exports__['A'](__dcg_shared_module_exports__['r'](t,"hash"),i),o=t?t[n-1]:void 0;o?o&&this.previewItem(o):this.newGraph&&O(this.newGraph).trigger("focus")}selectDown(e){if(!this.previewGraph)return;let t=this.getSavedAndExampleGraphs();if(!t.length)return;e.preventDefault();let i=this.previewGraph?this.previewGraph.hash:void 0,n=__dcg_shared_module_exports__['A'](__dcg_shared_module_exports__['r'](t,"hash"),i),o=t?t[n+1]:void 0;o&&(!o.example&&n+1>=this.getMaxGraphs()&&this.showMoreGraphs(),this.previewItem(o))}getFilter(){return this.state===dh&&this.filter?this.filter:""}getRecoveryGraphs(){return this.props.graphsController().getRecoveryGraphs()}attemptRecovery(){this.logRecoveryClientEvent("ask"),this.controller.mygraphsController.recoveryAttempted=!0,this.controller.graphsController.fetchRecoveryGraphs(),this.update()}hasAttemptedRecovery(){return this.controller.mygraphsController.hasAttemptedRecovery()&&!this.isAttemptingRecovery()}isAttemptingRecovery(){return this.controller.graphsController.isLoadingRecoveryGraphs}shouldShowAttemptRecoveryText(){return this.graphsController.isRecoveryUIEnabledForProduct()?!this.hasAttemptedRecovery():!1}getSavedGraphs(){return this.props.graphsController().getSavedGraphs()}getExampleGraphs(){return this.props.graphsController().getExampleGraphs()}getSavedAndExampleGraphs(){return this.props.graphsController().getSavedAndExampleGraphs()}filterGraphs(e){let t=this.getFilter().toLowerCase();return t?e.filter(i=>this.sanitizeTitle(i).toLowerCase().indexOf(t)>=0):e}sliceGraphs(e){return e.slice(0,this.getMaxGraphs())}canShowMore(e){return e.length>this.getMaxGraphs()}onFocusGraph(e){this.skipPreview()||this.previewItem(e)}onTapGraph(e,t){this.skipPreview()||t.device==="keyboard"?this.openGraphWithCover(e):this.previewGraph!==e&&this.previewItem(e)}previewItem(e){this.previewGraph&&(this.previewGraph=void 0),e&&(this.previewGraph=e,this.debouncedFetchSelectedGraph()),this.update()}skipPreview(){let e=window.platform;return O("body").width()<650||e==="ios"||e==="android"}onOpenPreviewGraph(){if(!this.previewGraph)return;let{previewGraph:e}=this;this.previewItem(void 0),this.props.onOpenGraph(e)}openGraphWithCover(e){if(this.graphWithCover=e,this.previewItem(void 0),e!==void 0)return setTimeout(async()=>{try{if(await this.props.graphsController().loadGraphImmediately(e),!this.graphWithCover)return;this.props.openGraphBehindCover(e).then(()=>{this.graphWithCover=void 0,this.update()})}finally{this.update()}},250)}cancelLoadGraphWithCover(){this.graphWithCover=void 0,this.update()}didDataLoadFail(e){return e?this.props.graphsController().didDataLoadFail(e):!1}willUpdate(){(!this.props.isOpen()||!this.controller.userController.isLoggedIn())&&(this.state=xV)}didMountNewGraph(e){return this.newGraph=e,O(this.newGraph).on("keydown",t=>{if(Re(t)!==Eo)return;let i=this.getSavedAndExampleGraphs();return this.previewItem(i[0]),t.preventDefault(),t.stopPropagation()})}sanitizeTitle(e){return e.i18nKey?this.controller.s(e.i18nKey):e.title||this.graphsController.getUntitledString()}init(){this.state=xV,this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return me.createElement("div",{class:()=>({"dcg-mygraphs":!0,"logged-in":this.controller.userController.isLoggedIn(),"preview-mode":!!this.props.previewMode(),"maintenance-mode":!!this.props.maintenanceMode()})},me.createElement("div",{class:me.const("dcg-resources-container")},me.createElement(zo,{predicate:()=>this.props.accountsEnabled()&&!this.controller.userController.isLoggedIn()&&!this.props.previewMode()&&!this.props.maintenanceMode()},()=>me.createElement(wV,{onCreateAccount:this.props.onCreateAccount,onSignIn:this.props.onSignIn,controller:this.props.controller})),me.createElement(zo,{predicate:()=>this.controller.userController.isLoggedIn()},()=>me.createElement("div",null,me.createElement(zo,{predicate:()=>this.controller.userController.isLoggedIn()&&this.state===xV},()=>me.createElement(bV,{isSyncingGraphs:()=>this.props.graphsController().isSyncing(),didSyncFail:()=>this.props.graphsController().didSyncFail(),requestSyncGraphs:this.props.refreshGraphs,s:this.controller.s})),me.createElement(mV,{controller:this.props.controller,openSearch:this.bindFn(this.openSearch),closeSearch:this.bindFn(this.closeSearch),updateFilter:this.bindFn(this.updateFilter),isSearching:()=>this.state===dh,s:this.controller.s}))),me.createElement("div",{class:me.const("dcg-scrollable"),didMount:this.bindFn(this.didMountScrollable)},me.createElement("div",{class:me.const("dcg-scrollable-interior")},me.createElement(zo,{predicate:this.props.maintenanceMode},()=>me.createElement("div",{class:me.const("maintenance-mode")},()=>this.controller.s("account-shell-text-mygraphs-maintenance-mode"))),me.createElement(zo,{predicate:this.props.previewMode},()=>me.createElement("div",{class:me.const("maintenance-mode")},()=>{var e;return(e=this.props.previewMode())==null?void 0:e.message},me.createElement("br",null),me.createElement("a",{tabindex:me.const("0"),class:me.const("dcg-btn-primary"),href:()=>{var e;return(e=this.props.previewMode())==null?void 0:e.url},target:me.const("_blank")},()=>this.controller.s("account-shell-text-mygraphs-share-thoughts")))),me.createElement(zo,{predicate:()=>this.state!==dh&&this.controller.shouldShowArtContestNudge()},()=>me.createElement("div",{onTap:e=>{this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device})},class:me.const("dcg-sidebar-contest-submit")},me.createElement("span",{class:me.const("dcg-trophy-icon")},me.const("\u{1F3C6}")),me.createElement(Wi,{i18n:this.const(this.controller),key:this.const("account-shell-text-mygraphs-submit-to-contest")},me.createElement("span",{class:me.const("dcg-contest-submit-message")},me.const("Submit this graph to the"),me.const(" "),me.createElement("span",{class:me.const("dcg-bold-text")},me.const("Global Math Art Contest!")))))),me.createElement(zo,{predicate:()=>this.state!==dh},()=>me.createElement("div",{role:me.const("link"),tabindex:me.const("0"),class:me.const("new-blank-graph dcg-action-newblankgraph"),onTap:()=>(this.previewItem(void 0),this.props.openBlankGraph()),didMount:this.bindFn(this.didMountNewGraph)},me.createElement("div",{class:me.const("new-blank-graph-inner")},me.createElement("span",{class:me.const("dcg-add-blank")},me.createElement("i",{class:me.const("dcg-icon-plus"),"aria-hidden":me.const("true")})),me.createElement("span",{class:me.const("dcg-new-graph-title")},()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-new-construction"):this.controller.s("account-shell-text-mygraphs-new-blank-graph"))))),me.createElement(zo,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.state!==dh},()=>me.createElement("div",null,me.createElement(Pg,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-current-construction"):this.controller.s("account-shell-text-mygraphs-current-graph")}),me.createElement(hV,{getTitle:()=>this.getPreviewTitle(),getDisplayDate:()=>this.controller.unpack(this.props.graphsController().getCurrentDisplayDate()),isOpen:this.props.isOpen,getThumbnail:this.props.getThumbnail,isSaveEnabled:this.props.isSaveEnabled,simpleSave:()=>(this.props.simpleSave(),this.previewItem(void 0)),openSaveDialog:()=>(this.props.openSaveDialog(),this.previewItem(void 0)),wasCurrentGraphEverSaved:()=>this.props.graphsController().wasCurrentGraphEverSaved(),isSaving:()=>this.props.graphsController().isSaving(),didSaveRecentlySucceed:()=>this.props.graphsController().didSaveSucceed(),didSaveRecentlyFail:()=>this.props.graphsController().didSaveFail(),s:this.controller.s}),me.createElement(zo,{predicate:this.bindFn(this.shouldShowAttemptRecoveryText)},()=>me.createElement("div",{class:me.const("dcg-lost-work-link")},oq(()=>this.isAttemptingRecovery(),{true:()=>me.createElement("span",null,me.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-attempting-recovery")),me.createElement("span",{class:me.const("dcg-spinner-dark")})),false:()=>me.createElement("span",null,me.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-lost-work")+" "),me.createElement("span",{tabIndex:me.const("0"),role:me.const("link"),class:me.const("dcg-attempt-recovery"),onTap:this.bindFn(this.attemptRecovery)},()=>this.controller.s("account-shell-button-mygraphs-attempt-recovery")))}))))),me.createElement(zo,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==dh},()=>me.createElement("div",null,oq(()=>this.getRecoveryGraphs().length>0,{true:()=>me.createElement("div",{class:me.const("dcg-recovery-graphs-list")},me.createElement(Pg,{title:()=>this.controller.s("account-shell-heading-mygraphs-recovered-work")}),me.createElement(Q0,{each:()=>this.getRecoveryGraphs(),key:e=>e.getCollectionKey()},me.createElement("div",{role:me.const("list")},e=>me.createElement(Hy,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.logRecoveryClientEvent("delete"),this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:me.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s})))),false:()=>me.createElement("div",{class:me.const("dcg-no-recovery-graphs")},()=>this.controller.s("account-shell-text-mygraphs-no-unsaved-graphs"))}))),me.createElement(zo,{predicate:()=>this.controller.userController.isLoggedIn()},()=>me.createElement(Pg,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-heading-mygraphs-saved-constructions"):this.controller.s("account-shell-heading-mygraphs-saved-graphs")})),me.createElement(Q0,{each:()=>this.sliceGraphs(this.filterGraphs(this.getSavedGraphs())),key:e=>e.getCollectionKey()},me.createElement("div",{class:me.const("dcg-saved-graphs-list"),role:me.const("list")},e=>me.createElement(Hy,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:me.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),me.createElement(zo,{predicate:()=>this.controller.userController.isLoggedIn()&&this.filterGraphs(this.getSavedGraphs()).length===0},()=>me.createElement("div",{"aria-live":me.const("assertive"),"aria-atomic":me.const("true"),class:me.const("no-matches")},()=>this.state===dh?this.controller.s("account-shell-text-mygraphs-no-search-results"):this.controller.s("account-shell-text-mygraphs-no-saved-graphs"))),me.createElement(zo,{predicate:()=>this.canShowMore(this.filterGraphs(this.getSavedGraphs()))},()=>me.createElement("div",{class:me.const("dcg-show-more-graphs"),onTap:this.bindFn(this.showMoreGraphs),role:me.const("button"),tabindex:me.const("0")},()=>this.controller.s("account-shell-text-mygraphs-count-more",{count:this.getCountRemaining()}))),me.createElement(zo,{predicate:()=>this.getExampleGraphs().length>0},()=>me.createElement(Pg,{title:()=>this.controller.s("account-shell-heading-mygraphs-examples")})),me.createElement(Q0,{each:()=>this.filterGraphs(this.getExampleGraphs()),key:e=>e.getCollectionKey()},me.createElement("div",{role:me.const("list")},e=>me.createElement(Hy,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>{},requestDeleteGraph:()=>{},isDeletingGraph:me.const(!1),didDeleteGraphFail:me.const(!1),canCancelDelete:me.const(!1),isSelected:()=>e===this.previewGraph,isExample:me.const(!0),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),me.createElement(zo,{predicate:()=>this.getFilter()?this.filterGraphs(this.getExampleGraphs()).length===0:!1},()=>me.createElement("div",{"aria-live":me.const("assertive"),"aria-atomic":me.const("true"),class:me.const("no-matches")},()=>this.controller.s("account-shell-text-mygraphs-no-examples-match-search"))),me.createElement("div",{class:me.const("dcg-mygraphs-legal")},me.createElement("a",{href:me.const("/terms"),target:me.const("_blank")},()=>this.controller.s("account-shell-link-terms")),me.const("|"),me.createElement("a",{href:me.const("/privacy"),target:me.const("_blank")},()=>this.controller.s("account-shell-link-privacy")),me.createElement(zo,{predicate:()=>!!this.props.versionNumber()},()=>me.createElement("div",{class:me.const("dcg-version")},()=>this.controller.s("account-shell-text-mygraphs-version"),me.const(" "),this.props.versionNumber))))),me.createElement(zo,{predicate:()=>!!this.previewGraph},()=>me.createElement(yV,{alignToNode:()=>this.getSelectedNode(),getTitle:()=>this.previewGraph?this.sanitizeTitle(this.previewGraph):"",getGraphData:()=>this.previewGraph?this.previewGraph.graphData:void 0,onCancel:()=>this.previewItem(void 0),didDataLoadFail:()=>this.didDataLoadFail(this.previewGraph),requestLoadGraphData:this.bindFn(this.fetchSelectedGraph),onOpenGraph:this.bindFn(this.onOpenPreviewGraph),s:this.controller.s,makeAPI:this.props.makeAPI,getOpenText:()=>this.controller.getOpenText()}))),me.createElement(zo,{predicate:this.props.isOpen},()=>me.createElement("div",{role:me.const("link"),tabindex:me.const("0"),class:me.const("dcg-resources-cover dcg-action-close-resources"),style:()=>({opacity:this.previewGraph?.6:0}),onTap:()=>this.previewGraph?this.previewItem(void 0):this.props.closeDrawer(),"aria-label":()=>this.previewGraph?this.controller.s("account-shell-button-mygraphs-close-graph-preview"):this.controller.s("account-shell-button-mygraphs-close-graph-list")})),me.createElement(zo,{predicate:()=>!!this.graphWithCover},()=>me.createElement("div",{class:me.const("dcg-fullscreen-loading-container")},me.createElement(zo,{predicate:()=>{var e;return(e=this.graphWithCover)==null?void 0:e.graphData}},()=>me.createElement("div",{"aria-live":me.const("assertive"),"aria-atomic":me.const("true"),class:me.const("dcg-graph-loading")},me.createElement("div",{class:me.const("pulsing-message")},()=>this.controller.s("account-shell-text-mygraphs-opening")),me.createElement("div",{class:me.const("slow-loading")},()=>this.getSlowLoadingText()))),me.createElement(zo,{predicate:()=>{var e;return(e=this.graphWithCover)==null?void 0:e.graphData}},()=>me.createElement(ch,{didDataLoadFail:()=>this.didDataLoadFail(this.graphWithCover),onCancel:this.bindFn(this.cancelLoadGraphWithCover),requestLoadGraphData:()=>this.openGraphWithCover(this.graphWithCover),s:this.controller.s})))))}getPreviewTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}getSlowLoadingText(){return this.graphsController.product==="graphing"?this.controller.s("account-shell-text-mygraphs-slow-big-graphs"):this.graphsController.product==="geometry"?this.controller.s("account-shell-text-mygraphs-slow-big-constructions"):""}logRecoveryClientEvent(e){Ei("recovered-graph",{product:this.controller.graphsController.product,timeSincePageload:Date.now()-this.controller.mygraphsController.pageLoadTime,payloadJSON:{action:e}})}};var CV=class extends DV.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.mygraphsController=this.controller.mygraphsController}template(){return DV.createElement(vV,{isOpen:()=>this.mygraphsController.isMygraphsOpen(),graphsController:()=>this.graphsController,maintenanceMode:()=>this.controller.isInMaintenanceMode(),previewMode:()=>this.controller.getPreviewParams(),accountsEnabled:this.const(!0),controller:()=>this.controller,closeDrawer:()=>this.controller.dispatch({type:"close-mygraphs"}),openBlankGraph:()=>this.mygraphsController.openBlankGraph(),onOpenGraph:e=>this.mygraphsController.onOpenGraph(e),openGraphBehindCover:e=>this.mygraphsController.openGraphBehindCover(e),onLogout:()=>this.controller.userController.logout(),onEditAccount:()=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:"mouse"}),onCreateAccount:()=>this.controller.dispatch({type:"show-modal",modal:"signup",device:"mouse"}),onSignIn:()=>this.controller.dispatch({type:"show-modal",modal:"login",device:"mouse"}),refreshGraphs:()=>this.graphsController.refreshGraphs(),getThumbnail:()=>this.mygraphsController.getThumbnail(),simpleSave:()=>this.controller.simpleSave(),openSaveDialog:()=>this.controller.openSaveDialog({fromSaveInProgress:!0}),versionNumber:()=>jv.versionNumber,isSaveEnabled:()=>this.controller.isSaveEnabled(),makeAPI:this.props.makeAPI})}};var sq=__dcg_shared_module_exports__['h'](X());function Bte(r,e){var t=document.createElement("div");t.style.zIndex="999999",t.style.position="fixed",t.style.bottom="50px",t.style.left="0",t.style.right="0",document.body.append(t),sq.mountToNode(ch,t,{s:e,didDataLoadFail:function(){return!0},requestLoadGraphData:function(){t.remove(),r()}})}function aq(r,e){return new Promise(t=>{if(r&&r.state)t(r);else if(r&&typeof r.stateUrl=="string"){var i=!1;let n=async()=>{if(!i){i=!0;try{let o=await fetch(`${r.stateUrl}?${new URLSearchParams(fd)}`,{headers:{Accept:"application/json"}});if(!o.ok)throw void 0;let s=await o.json();r.state=s,t(r)}catch(o){Bte(n,e)}finally{i=!1}}};n()}else t(void 0)})}zl();Jh();var SV=class extends Wr{constructor(){super();this.loggedIn=!1;this.logoutFailed=!1;this.loggingOut=!1;this.consentingToPrivacy=!1;this.privacyConsentFailed=!1;this.userId="";this.name="";this.email="";this.teacher=!1;this.featureFlags=[];this.verificationStatus="";this.subscriptions=[];this.privacyConsent=null;I8(()=>this.logout())}desmosLogin(t){return T8(t).then(this.completeLogin.bind(this))}googleLogin(t){this.triggerEvent("googleLogin",t)}appleLogin(t){this.triggerEvent("appleLogin",t)}askServerIfLoggedIn(){return M8().then(this.completeLogin.bind(this),this.logout.bind(this))}driveCallback(){return this.askServerIfLoggedIn()}createAccount(t){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{name:t.userProvidedName.given});return i.teacher===!1&&delete i.teacher,L8(i).then(this.completeLogin.bind(this))}checkPendingDeletion(t){return A8(t)}isTeacher(){return!!this.teacher}setNameLegacy(t){return _8(t).then(i=>{this.name=i.name||"",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}setNameDetail(t){return F8(t).then(i=>{this.name=i.name||"",this.nameDetail=i.nameDetail,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}recoverPassword(t){return R8(t)}completeLogin(t){this.loggedIn=!0,this.userId=t.userId||"",this.name=t.name||"",this.nameDetail=t.nameDetail,this.email=t.email||"",this.featureFlags=t.featureFlags||[],this.subscriptions=t.subscriptions||[],this.verificationStatus=t.verificationStatus||"",this.privacyConsent=t.privacyConsent,this.teacher=!!t.isTeacher,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}async logout(){this.loggingOut=!0,this.triggerEvent("logout",void 0),this.triggerEvent("triggerRender",void 0);try{await g0(),this.completeLogout()}catch(t){this._onLogoutFailure()}finally{this.loggingOut=!1,this.triggerEvent("triggerRender",void 0)}}completeLogout(){this.loggedIn=!1,this.logoutFailed=!1,this.userId="",this.email="",this.name="",this.subscriptions=[],this.featureFlags=[],this.verificationStatus="",this.privacyConsent=null,this.teacher=!1,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}_onLogoutFailure(){this.logoutFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.logoutFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}initiateAccountDeletion(t){return N8(t)}getEmailChangeToken(){return vu(location.search,"changeToken")}initiateEmailChange(t){return B8(t)}setEmail(t){return K8(t).then(()=>{this.email=t.newEmail||"",this.verificationStatus="VERIFYING",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}async setPrivacyConsent(t){this.consentingToPrivacy=!0,this.triggerEvent("triggerRender",void 0);try{let i=await H8(t);this.completePrivacyConsent(i)}catch(i){this.onPrivacyConsentFailure()}finally{this.consentingToPrivacy=!1,this.triggerEvent("triggerRender",void 0)}}completePrivacyConsent(t){this.privacyConsent=t.privacyConsent,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}onPrivacyConsentFailure(){this.privacyConsentFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.privacyConsentFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}updateFeatureFlags(t){return U8(t).then(i=>{this.featureFlags=i.featureFlags,this.triggerEvent("userUpdated",void 0)})}getFeatureFlags(){return this.featureFlags}hasFeatureFlag(t){return this.featureFlags.some(i=>i===t)}didPrivacyConsentFail(){return!!this.privacyConsentFailed}isConsentingToPrivacy(){return!!this.consentingToPrivacy}isLoggedIn(){return!!this.loggedIn}isLoggingOut(){return!!this.loggingOut}didLogoutFail(){return!!this.logoutFailed}getEmail(){return this.email}getFirstName(){return Kte(this.name)}getFullName(){return this.name}getNameDetail(){return this.nameDetail||{given:this.name,source:"legacy"}}getUserId(){return this.userId}getSubscriptions(){return this.subscriptions}getVerificationStatus(){return this.verificationStatus}hasConsentedToCollection(){return!!this.privacyConsent}getUserAsJSON(){if(this.isLoggedIn())return{email:this.email,name:this.name,verificationStatus:this.verificationStatus,subscriptions:this.subscriptions,privacyConsent:this.privacyConsent}}};function Kte(r){if(!r)return"";if(r.match(/[\d@_&\.\']/))return r;var e=r.split(" ");return e[0].length>=3?e[0]:r}var r1={};__dcg_shared_module_exports__['g'](r1,{init:()=>jte,next:()=>$te,nextSeed:()=>Wte});var Z0=class{constructor(e){this.bauArc4=new e1(Ute(e))}g(e){for(var t=Array(e),i=0;i<e;i++)t[i]=this.bauArc4.g(1);return t}},Yv=256;function Jd(r){return r&Yv-1}function Ute(r){var e=r+"",t=[],i=0,n;for(n=0;n<e.length;n++)t[Jd(n)]=Jd((i^=t[Jd(n)]*19)+e.charCodeAt(n));return t}var e1=class{constructor(e){this.S=[];this.c=[];this.i=0;this.j=0;this.m=0;var t,i,n=e.length,o=0,s=0;for(n||(e=[n++]);o<Yv;)this.S[o]=o++;for(o=0;o<Yv;o++)t=this.S[o],s=Jd(s+t+e[o%n]),i=this.S[s],this.S[o]=i,this.S[s]=t;this.g(Yv)}g(e){var t=this.S,i=Jd(this.i+1),n=t[i],o=Jd(this.j+n),s=t[o];t[i]=s,t[o]=n;for(var a=t[Jd(n+s)];--e;)i=Jd(i+1),n=t[i],o=Jd(o+n),s=t[o],t[i]=s,t[o]=n,a=a*Yv+t[Jd(n+s)];return this.i=i,this.j=o,a}},Hte="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",qte=Hte.toLowerCase(),zte=62,lq=10,t1=class{constructor(e){if(!e||!e.length||e.length<32)throw new Error("You must supply a seed to RandomHashFactory. It should have at least 128 bits of entropy, but was "+e);this.arc4=new Z0(e)}next(){for(var e=Array(lq),t=0,i;t<lq;)i=this.arc4.g(1)[0]>>2,i<zte&&(e[t]=qte[i],t++);return e.join("")}nextSeed(){for(var e=16,t=this.arc4.g(e),i=Array(e),n=0;n<e;n++)i[n]=t[n].toString(16),i[n].length===1&&(i[n]="0"+i[n]);return i.join("")}},Xv;function $te(){if(!Xv)throw"Random Hash Factory not initialized";return Xv.next()}function Wte(){if(!Xv)throw"Random Hash Factory not initialized";return Xv.nextSeed()}function jte(r){Xv=new t1(r)}zl();function i1(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");var t={parent_hash:r.parentHash,thumb_data:r.thumbURL,graph_hash:r.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,title:r.title||void 0};return t.state=r.graphData,yo("/api/v1/calculator_3d/save",t).then(function(i){return Oo.updateFromSync(r,i),r})}function cq(){return tc("/api/v1/calculator_3d/my_graphs")}function dq(r){return yo("/api/v1/calculator_3d/my_graphs/remove",{hash:r.hash})}function n1(r,e){if(!e.hasOwnProperty("myConstructions"))throw new Error("Argument Error: saveConstruction options must specify myConstructions");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveConstruction options must specify isUpdate");var t={state:r.graphData,parent_hash:r.parentHash,thumb_data:r.thumbURL,hash:r.hash,my_constructions:e.myConstructions,is_update:e.isUpdate,title:r.title||void 0};return yo("/api/v1/geometry/save",t).then(function(i){return Oo.updateFromSync(r,i),r})}function uq(){return tc("/api/v1/geometry/my_constructions")}function pq(r){return yo("/api/v1/geometry/my_constructions/remove",{hash:r.hash})}var EV=class extends Wr{constructor({api:t,s:i,getLanguage:n,examplesJSON:o,randomSeed:s,product:a}){super();this.product=a,this.api=t,this.s=i,this.getLanguage=n,this.previousGraph=void 0,this.recoveryParentHash=void 0,this.randomHash=r1,this._seedRandom(s),this.__savedGraphs=[],this.__recoveryGraphs=[];let l=o.map(Oo.fromAjax);this.__exampleGraphs=__dcg_shared_module_exports__['n'](l,c=>!c.easterEgg),this.__easterEggGraphs=__dcg_shared_module_exports__['n'](l,c=>!!c.easterEgg),this.__graphInfoCache={},this.__exampleGraphs.forEach(c=>{this._addGraphToCache(c)}),this.__easterEggGraphs.forEach(c=>{this._addGraphToCache(c)}),this.lastSync=void 0,this.lastSaveFailureMessage="",this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.saving=!1,this.syncError=!1,this.isLoadingGraphs=!1,this.currentGraph=new Oo,this._enableLoadingGraphStates(),this.pageLoadTime=Date.now()}_seedRandom(t){if(!t){alert(this.s("account-shell-error-something-went-wrong",{error_num:"77361"}));return}let i=new Date,n=""+t+i.getTime()+i.getMilliseconds();this.randomHash.init(n)}requestDeleteGraph(t){let i=this._getCachedGraphInfo(t);i.canCancelDelete=!0,i.deleteTimeout=setTimeout(this._deleteGraph.bind(this,t),3e3),i.isDeletingGraph=!0,i.didDeleteGraphFail=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}_removeSavedGraphByHash(t){this.__savedGraphs=__dcg_shared_module_exports__['n'](this.__savedGraphs,i=>i.hash!==t)}_removeRecoveryGraphByHash(t){this.__recoveryGraphs=__dcg_shared_module_exports__['n'](this.__recoveryGraphs,i=>i.hash!==t)}async _deleteGraph(t){let i=t.hash,n=this._getCachedGraphInfo(t);n.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0);let o;switch(this.product){case"graphing":case"geometry-calculator":{o=xH({hash:i,lang:this.getLanguage()});break}case"graphing-3d":{o=dq(t);break}case"geometry":{o=pq(t);break}}try{await o,this._removeSavedGraphByHash(i),this._removeRecoveryGraphByHash(i)}catch(s){n.didDeleteGraphFail=!0}finally{n.isDeletingGraph=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}}cancelDeleteGraph(t){let i=this._getCachedGraphInfo(t);clearTimeout(i.deleteTimeout),i.isDeletingGraph=!1,i.didDeleteGraphFail=!1,i.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}millisecondsSinceSync(){return this.lastSync?Date.now()-this.lastSync:1/0}clear(){this.lastSync=void 0,this.setSavedGraphsFromJSON([]),this.setRecoveryGraphsFromJSON([])}dismissSaveError(){this.recentSaveFailure=!1,this.triggerEvent("triggerRender",void 0)}_triggerSaveSuccess(){this.saving=!1,this.recentSaveSuccess=!0,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),this.recentSaveTimeout=setTimeout(()=>{this.recentSaveSuccess=!1,this.triggerEvent("triggerRender",void 0)},3e3)}_triggerSaveError(t){let i=t.length&&t[0].message?t[0].message:this.s("account-shell-error-unexpected-error");this.saving=!1,this.recentSaveFailure=!0,this.lastSaveFailureMessage=i,this.triggerEvent("triggerRender",void 0),this.toast(i,{}),this.recentSaveTimeout=setTimeout(this.dismissSaveError.bind(this),3e3)}_updateGraphData(t){let i=JSON.stringify(this.api.getState());t.setProperty("graphData",i),t.setProperty("parentHash",t.hash),t.setProperty("recoveryParentHash",this.recoveryParentHash);let n=this.randomHash.next();t.setProperty("hash",n),this.recoveryParentHash=n;let o=this.api.screenshot({width:200,height:200,targetPixelRatio:2});t.setProperty("thumbURL",o)}_clearSaveTimeout(){this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),clearTimeout(this.recentSaveTimeout)}async save(t){let i=t&&t.newTitle,n=!!(t&&t.saveCopy);i&&(this.currentGraph.title=i),this._clearSaveTimeout(),this.saving=!0,this.triggerEvent("triggerRender",void 0);let o=this.currentGraph.copy();o.recovery&&(o.recovery=!1,Ei("recovered-graph",{product:this.product,timeSincePageload:Date.now()-this.pageLoadTime,payloadJSON:{action:"save"}})),this._updateGraphData(o);let s=!n&&this.wasCurrentGraphEverSaved(),a;switch(this.product){case"graphing":case"geometry-calculator":{a=oI(o,{myGraphs:!0,isUpdate:s,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{a=i1(o,{myGraphs:!0,isUpdate:s});break}case"geometry":{a=n1(o,{myConstructions:!0,isUpdate:s});break}}try{let l=await a;this.currentGraph=l.copy(),this._onCurrentGraphChanged(),this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),s&&this._removeSavedGraphByHash(l.parentHash),l.draft&&this._removeRecoveryGraphByHash(l.parentHash),this.__savedGraphs.unshift(l),this._addGraphToCache(l),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0),this._triggerSaveSuccess()}catch(l){let c=(l==null?void 0:l.status)===413?[{message:this.s("account-shell-error-graph-too-large")}]:I0(l);this._triggerSaveError(c)}}shareGraph(){let t=this.currentGraph.copy();this._updateGraphData(t);let i;switch(this.product){case"graphing":case"geometry-calculator":{i=oI(t,{myGraphs:!1,isUpdate:!1,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{i=i1(t,{myGraphs:!1,isUpdate:!1});break}case"geometry":{i=n1(t,{myConstructions:!1,isUpdate:!1});break}}return i}saveRecoveryGraph(){switch(this.product){case"graphing":case"geometry-calculator":{let t=this.currentGraph.copy(),i=JSON.stringify(this.api.getState());t.setProperty("graphData",i),t.setProperty("parentHash",t.hash),t.setProperty("recoveryParentHash",this.recoveryParentHash);let n=this.randomHash.next()+this.randomHash.next();t.setProperty("hash",n),this.recoveryParentHash=n;let o=this.api.screenshot({width:200,height:200,targetPixelRatio:2});return t.setProperty("thumbURL",o),oI(t,{myGraphs:!1,isUpdate:!1,recovery:!0,product:this.product,lang:this.getLanguage()})}case"geometry":case"graphing-3d":throw new Error(`Programming Error: ${this.product} cannot save recovery graphs`)}}isCurrentGraphTitled(){return!!this.currentGraph.title}isCurrentGraphARecoveryGraph(){let t=this.currentGraph;if(!t||!t.hash)return!1;let i=t.hash;return __dcg_shared_module_exports__['p'](this.__recoveryGraphs,n=>n.hash===i)}wasCurrentGraphEverSaved(){let t=this.currentGraph;if(!t||!t.hash)return!1;let i=t.hash;return __dcg_shared_module_exports__['p'](this.__savedGraphs,n=>n.hash===i)}isSaveEnabled(){var t;return this.hasUnsavedChanges()?!0:(t=this.currentGraph)!=null&&t.hash?!this.wasCurrentGraphEverSaved():!1}isRecoveryUIEnabledForProduct(){return this.product==="graphing"||this.product==="geometry-calculator"}async fetchRecoveryGraphs(){let i=Date.now(),n;switch(this.isLoadingRecoveryGraphs=!0,clearTimeout(this.fetchDurationTimeout),this.triggerEvent("triggerRender",void 0),this.product){case"graphing":case"geometry-calculator":{n=wH({product:this.product,lang:this.getLanguage()});break}case"graphing-3d":throw new Error("code error: should not fetchRecoveryGraphs for 3d");case"geometry":throw new Error("code error: should not fetchRecoveryGraphs for geometry")}try{let o=await n;this.setRecoveryGraphsFromJSON(o.recoveryGraphs||o.recoveryConstructions)}catch(o){this.triggerEvent("onRecoveryGraphsError",void 0)}finally{let s=2e3-(Date.now()-i);this.isLoadingRecoveryGraphs=!1,s>0?this.fetchDurationTimeout=setTimeout(()=>{this.triggerEvent("triggerRender",void 0)},s):this.triggerEvent("triggerRender",void 0)}}clearRecoveryGraphsForTests(){return vH()}async refreshGraphs(){this.isLoadingGraphs=!0,this.syncError=!1,this.triggerEvent("triggerRender",void 0);let t;switch(this.product){case"graphing":case"geometry-calculator":{t=bH({product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{t=cq();break}case"geometry":{t=uq();break}}try{let i=await t;this.lastSync=Date.now(),this.setSavedGraphsFromJSON(i.myGraphs||i.myConstructions)}catch(i){this.syncError=!0,this.triggerEvent("onSyncError",void 0)}finally{this.isLoadingGraphs=!1,this.triggerEvent("triggerRender",void 0)}}getRecoveryGraphs(){return this.__recoveryGraphs.slice(0)}getSavedGraphs(){return this.__savedGraphs.slice(0)}getExampleGraphs(){return this.__exampleGraphs.slice(0)}getEasterEggGraphs(t){return __dcg_shared_module_exports__['n'](this.__easterEggGraphs,i=>i.easterEgg===t)}getSavedAndExampleGraphs(){return this.__savedGraphs.concat(this.__exampleGraphs)}setSavedGraphsFromJSON(t){t||(t=[]),this.__savedGraphs=t.map(i=>{let n=Oo.fromAjax(i),o=this._getCachedGraphInfo(n);return o?o.graph:(this._addGraphToCache(n),n)}),this._lazyLoadGraphStates(),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}setRecoveryGraphsFromJSON(t){t||(t=[]),this.__recoveryGraphs=t.map(i=>{let n=Oo.fromAjax(i);n.draft=!0,n.recovery=!0;let o=this._getCachedGraphInfo(n);return o?o.graph:(this._addGraphToCache(n),n)}),this._lazyLoadGraphStates(),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}getSavedGraphsAsJSON(){return this.__savedGraphs.map(Oo.toAjax)}_enableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout);let t=()=>{this._loadNextGraphState(),this.__loadNextGraphStateTimeout=setTimeout(t,50)};t()}_disableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout)}async _loadNextGraphState(){if(this.__currentAjaxRequest)return;let t=this._dequeueGraphInfo();if(t){this.__currentAjaxRequest=this.loadGraphImmediately(t.graph);try{await this.__currentAjaxRequest}finally{this.__currentAjaxRequest=void 0}}}async loadGraphImmediately(t){if(t.graphData)return;let i=t.stateURL,n=this._getCachedGraphInfo(t);n.isDataLoading=!0;try{let o=await fetch(`${i}?${new URLSearchParams(fd)}`),s=await o.json();if(!o.ok)throw s;return t.graphData=s,n.didDataLoadFail=!1,s}catch(o){throw n.didDataLoadFail=!0,o}finally{n.isDataLoading=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}}_getCachedGraphInfo(t){return t&&this.__graphInfoCache[t.getCollectionKey()]}_addGraphToCache(t){this.__graphInfoCache[t.getCollectionKey()]={graph:t}}_enqueueGraphInfo(t){this.__nextAjaxRequestPriority||(this.__nextAjaxRequestPriority=0),t.ajaxPriority=++this.__nextAjaxRequestPriority}_dequeueGraphInfo(){let t=-1/0,i;for(let n in this.__graphInfoCache){let o=this.__graphInfoCache[n],s=o.ajaxPriority;s!==void 0&&s>t&&(t=s,i=o)}return!__dcg_shared_module_exports__['J'](i)||i===void 0?null:(delete i.ajaxPriority,i)}loadDataForGraph(t){if(!t)return;let i=this._getCachedGraphInfo(t);if(!i)throw new Error('graphsController does not have a reference to graph with hash "'+t.hash+'"');i.graph.graphData||(i.isDataLoading=!0,i.didDataLoadFail=!1,this._enqueueGraphInfo(i),this.triggerEvent("triggerRender",void 0))}_lazyLoadGraphStates(){let i=this.getSavedAndExampleGraphs();for(let n=Math.min(20,i.length)-1;n>=0;n--)this.loadDataForGraph(i[n])}didDataLoadFail(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.didDataLoadFail)}didDeleteGraphFail(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.didDeleteGraphFail)}isDeletingGraph(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.isDeletingGraph)}canCancelDelete(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.canCancelDelete)}loadGraph(t,i){this.previousGraph=this.currentGraph?this.currentGraph.copy():new Oo,this.previousGraph.graphData=JSON.stringify(this.api.getState());let n=t.copy();delete n.example,this.api.setState(n.graphData,{forceExpressionsOpen:!0,forceUnsavedChanges:!!n.recovery,allowUndo:i&&i.allowUndo}),this.currentGraph=n,this._onCurrentGraphChanged(),this.recoveryParentHash=this.currentGraph.hash,(!i||!i.allowUndo)&&this.triggerEvent("clearUndoRedo",void 0),n.recovery||this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),this.triggerEvent("onLoadGraph",void 0)}restorePreviousGraph(){this.loadGraph(this.previousGraph||new Oo)}clearGraph(t){this.loadGraph(new Oo,t),this.triggerEvent("onClearGraph",void 0)}defaultTitle(){switch(this.product){case"graphing":return this.s("account-shell-heading-graphingcalc-page-title");case"graphing-3d":return this.s("account-shell-heading-3dcalc-page-title");case"geometry-calculator":return this.s("account-shell-heading-geometry-beta-page-title");case"geometry":return this.s("account-shell-heading-geometry-page-title")}}_onCurrentGraphChanged(){let t=this.currentGraph;t.title?document.title=t.title:document.title=this.defaultTitle(),this._replaceState(t)}_replaceState(t){if(!(window.history&&history.replaceState))return;let i=t.getURL();i&&(window.location.search&&(i+=window.location.search),i!==window.location.href&&history.replaceState(t.hash,t.title,i))}toast(t,i){this.triggerEvent("toast",{message:t,opts:i})}clearGraphByUserAction(){let t;if(this.currentGraph.hash){this.clearGraph(),t=this.product==="geometry"?this.s("account-shell-text-new-construction-created"):this.s("account-shell-text-new-graph-created"),this.toast(t,{undoCallback:()=>{this.restorePreviousGraph(),this._replaceState(this.currentGraph)}});return}let i=this.api.getState();this.clearGraph({allowUndo:!0}),t=this.product==="geometry"?this.s("account-shell-text-construction-cleared"):this.s("account-shell-text-graph-cleared"),this.toast(t,{undoCallback:()=>{this.api.setState(i,{forceExpressionsOpen:!0,allowUndo:!0})}})}getSaveFailureMessage(){return this.lastSaveFailureMessage||""}isSaving(){return!!this.saving}didSaveFail(){return!!this.recentSaveFailure}didSaveSucceed(){return!!this.recentSaveSuccess}isSyncing(){return!!this.isLoadingGraphs}didSyncFail(){return!!this.syncError}getCurrentDisplayDate(){return this.currentGraph.displayDate()}getCurrentGraphTitle(){return this.currentGraph.title}getUntitledString(){return this.product==="geometry"?this.s("account-shell-text-untitled"):this.product==="graphing"?this.s("account-shell-text-untitled-graph"):this.product==="graphing-3d"?this.s("account-shell-text-untitled-graph"):this.product==="geometry-calculator"?this.s("account-shell-text-untitled"):(Yo("Unknown product: "+this.product),"Untitled")}hasUnsavedChanges(){return this.api.hasUnsavedChanges()}};Jh();var Qv=class{constructor(e){this.s=bc(()=>this._language);this._language=bb(),this.Calc=e}raw(e,t){return Fa(e,t)}unpack(e){return md(e,this._language)}getLanguage(){return this._language}updateUrl(e){if(!(window.history&&history.replaceState))return;let{origin:t,pathname:i,search:n,hash:o}=location,s=BS(n,"lang",e),a=`${t}${i}${s}${o}`;history.replaceState(null,"",a)}setHeaderController(e){this.headerController=e}fetchAndSetLanguage(e){ym(e).then(()=>{this._language=e,this.Calc.updateSettings({language:e}),this.updateUrl(e),this.headerController&&this.headerController.triggerRender()})}};ct();zl();uu();var hq=5*60*1e3;Gs().fastAutoSave&&(hq=5*1e3);var kV=class{constructor(e){this.defaultModalDevice="mouse";this.userControllerState="uninitialized";this.lastIsShowingActionsUI=!1;if(e.graphsController.product!==e.product)throw new Error("Programming error: mismatched product between graphsController and calculator-shell controller");this.userController=e.userController,this.graphsController=e.graphsController,this.tourController=e.tourController,this.languageController=e.languageController,this.mygraphsController=e.mygraphsController,this.api=e.api,this.raw=e.raw,this.s=e.s,this.getLanguage=e.getLanguage,this.unpack=e.unpack,this.product=e.product,this.SOMETHING_WENT_WRONG=this.s("account-shell-error-unknown"),this._openMenu="none",this._requestedContactForm=!1,this._feedbackMessage="",this.state={},this.languageController&&this.languageController.setHeaderController(this),this.hookupControllers(),this.hookupHotkeys(),this.dispatcher=new Fd,this.dispatch=t=>(jh("dispatch::header-controller",{type:t.type}),this.dispatcher.dispatch(t)),this.dispatcher.register(t=>{switch(t.type){case"save-graph":this.saveGraph(t.device,t.payload);break;case"edit-title":this.launchEditTitle();break;case"close-modal":this.closeModal();break;case"toggle-menu":this.setOpenMenu(t.payload);break;case"open-mygraphs":this.mygraphsController.openMygraphs(t);break;case"close-mygraphs":this.mygraphsController.closeMygraphs();break;case"render":break;case"show-modal":this.showModal(t);break;case"show-contact-form":this._requestedContactForm=t.showForm;break;default:return t}return this.triggerRender()}),this.lastRecoveryState={},this.checkRecoveryState()}triggerRender(){}hookupControllers(){this.mygraphsController.observeEvent("onOpenMygraphs",()=>{this.isLoggedIn()&&this.graphsController.millisecondsSinceSync()>2*60*1e3&&this.graphsController.refreshGraphs()}),this.mygraphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.userController.observeEvent("loginChanged",()=>{this.userControllerState="initialized",this.mygraphsController.recoveryAttempted=!1,this.isLoggedIn()?this.graphsController.refreshGraphs():this.graphsController.clear(),this.mustConsentToCollection()&&this.showModal({modal:"consent",device:this.defaultModalDevice})}),this.userController.observeEvent("userUpdated",()=>{this.getOpenModal()==="consent"&&this.closeModal(),Ai("actions")===void 0&&(this.api instanceof Qa||this.api instanceof sh)&&this.api._calc.setOption("actions",this.isActionsFlagEnabled()?!0:"auto")}),this.userController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.graphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.api instanceof Qa&&this.api._calc.controller.subToChanges(()=>this.maybeShowAdvancedFeaturesToast())}hookupHotkeys(){O(document).on("keydown",e=>{let t,{altKey:i,ctrlKey:n,metaKey:o,shiftKey:s}=e;if(di?t=!n&&o&&!i&&!s:t=n&&!o&&!i&&!s,t)switch(Di(e)){case"S":return this.simpleSave("keyboard"),!1;case"O":return this.dispatch({type:"open-mygraphs",device:"keyboard"}),!1}})}disablePrintAndExport(){this._disablePrintAndExport=!0}shouldDisablePrintAndExport(){return!!this._disablePrintAndExport}getOpenMenu(){return this._openMenu}getModalState(){return this._openModal||{modal:"none"}}getOpenModal(){var e,t;return(t=(e=this._openModal)==null?void 0:e.modal)!=null?t:"none"}hasOpenModal(){return!!this._openModal}getModalDevice(){var e;return(e=this._openModal)==null?void 0:e.device}getModalStartingError(){var e;return((e=this._openModal)==null?void 0:e.error)||""}closeModal(){this._openModal=this.mustConsentToCollection()?{modal:"consent",device:this.defaultModalDevice}:void 0,this.triggerRender()}closeMenu(){this._openMenu="none",this.maybeResetContactForm()}showModal(e){this.closeMenu(),this._openModal=e,this.defaultModalDevice=e.device}setOpenMenu(e){let t=this.getOpenMenu();this._openMenu=e===t?"none":e,this.maybeResetContactForm()}getFeedbackMessage(){return this._feedbackMessage}setFeedbackMessage(e){this._feedbackMessage=e}maybeResetContactForm(){this.getOpenMenu()!=="help"&&(this.getFeedbackMessage().trim().length||(this.setFeedbackMessage(""),this._requestedContactForm=!1))}getProduct(){return this.product}saveRecoveryState(){let e=this.graphsController.api.getState();var t=this.graphsController.saveRecoveryGraph();return this.lastRecoveryState=e,t}shouldSaveRecoveryState(){if(!this.userController.isLoggedIn()||!this.graphsController.hasUnsavedChanges())return!1;let e=this.graphsController.api.getState();return!__dcg_shared_module_exports__['G'](e,this.lastRecoveryState)}checkRecoveryState(){this.graphsController.isRecoveryUIEnabledForProduct()&&setTimeout(()=>{this.checkRecoveryState(),this.shouldSaveRecoveryState()&&this.saveRecoveryState()},hq)}isLoggedIn(){return this.userController.isLoggedIn()}hasConsentedToCollection(){return this.userController.hasConsentedToCollection()}isInMaintenanceMode(){return!!Ai("maintenance")}getPreviewParams(){return Ai("previewMode")?{url:Ai("previewFeedbackUrl"),message:Ai("previewMessage")}:null}isDecimalToFractionEnabled(){return!!Ai("decimalToFraction")}isSaveEnabled(){return this.graphsController.isSaveEnabled()}saveGraph(e,t){this.isLoggedIn()?(this.graphsController.save({newTitle:t==null?void 0:t.title,saveCopy:!!(t!=null&&t.saveAs)}),this.closeModal(),this.closeMenu()):this.showModal({modal:"signup",device:e})}simpleSave(e=this.defaultModalDevice){this.graphsController.isCurrentGraphTitled()?(this.saveGraph(e||"mouse"),this.dispatch({type:"render"})):this.openSaveDialog({device:e})}openSaveDialog(e={}){this.showModal({modal:"save",device:e.device||this.defaultModalDevice,fromSaveInProgress:e.fromSaveInProgress}),this.dispatch({type:"render"})}launchEditTitle(){this.closeMenu(),!(this.getPreviewParams()!=null||this.isInMaintenanceMode())&&(this.isLoggedIn()?this.product==="geometry"?this.showModal({modal:"save",device:this.defaultModalDevice}):this.showModal({modal:"rename",device:this.defaultModalDevice}):this.showModal({modal:"signup",device:this.defaultModalDevice}))}getOpenText(){switch(this.product){case"graphing":case"geometry-calculator":case"graphing-3d":return this.s("account-shell-button-open-graph");case"geometry":return this.s("account-shell-button-open-construction")}}isConsentingToCollection(){return this.userController.isConsentingToPrivacy()}privacyConsentFailed(){return this.userController.didPrivacyConsentFail()}mustConsentToCollection(){return this.isLoggedIn()&&!this.hasConsentedToCollection()}isArtContestEnabled(){return!1}isGraphComplexEnoughForContest(){if(!(this.api instanceof Qa))return!1;let e=this.api.getState(),{list:t}=e.expressions;return!!(t.length!==1||t[0].type!=="expression"||t[0].latex)}shouldShowArtContestNudge(){return this.isArtContestEnabled()?this.isGraphComplexEnoughForContest()&&this.isLoggedIn():!1}getLimitedSignupRole(){return"student"}wasModalOpenedWithKeyboard(){var e;return((e=this._openModal)==null?void 0:e.device)==="keyboard"}allowSignInWithApple(){return!0}getSomethingWentWrongText(){return this.s("account-shell-error-unknown")}logJSON(e,t){Ei(e,t)}parseJSONErrors(e){return sI(e)}requestedContactForm(){return this.product==="geometry-calculator"?!0:this._requestedContactForm}isActionsFlagEnabled(){return this.userController.hasFeatureFlag("dcg-actions")}maybeShowAdvancedFeaturesToast(){let e=this.api;if(!(e instanceof Qa))return;let t=e._calc.controller.areActionsEnabled();if(t&&this.userControllerState==="uninitialized"){this.userControllerState="loading",this.userController.askServerIfLoggedIn().then(()=>{this.userControllerState="initialized",this.maybeShowAdvancedFeaturesToast()});return}else if(this.userControllerState==="loading")return;this.isActionsFlagEnabled()||(t&&!this.lastIsShowingActionsUI&&this.userController.isLoggedIn()&&e._calc.controller.runAfterDispatch(()=>{e._calc.controller.dispatch({type:"toast/show",toast:{message:pn("account-shell-text-graph-uses-advanced-features"),hideAfter:0,learnMoreCallback:()=>{this.dispatch({type:"show-modal",modal:"account-settings",initialTab:"advanced",device:this.defaultModalDevice})}}})}),this.lastIsShowingActionsUI=t)}};ct();var Xte=0,Zv=class{constructor(e,t,i){this.__id=Xte++,this.controller=e,this.headerController=t,this.userController=t.userController,this.mygraphsController=t.mygraphsController,this.instanceHotkeys=i,this.startListening()}remove(){this.stopListening()}startListening(){this.isListening||(O(document).on("keydown.dcg-global-keyboard-listener-"+this.__id,e=>this.handleGlobalKeydown(e)),this.isListening=!0)}stopListening(){this.isListening&&(O(document).off("keydown.dcg-global-keyboard-listener-"+this.__id),this.isListening=!1)}handleGlobalKeydown(e){let t=!1;if(Th(e)||Mh(e))(!this.controller.getRootElt()||document.activeElement&&document.activeElement!=document.body&&!document.activeElement.closest(".dcg-wrapper"))&&(t=!0);else if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey&&Re(e)===Do)t=this.handleEscape(e);else if(sT(e))e.preventDefault(),e.stopPropagation(),t=!0,this.headerController.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"});else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey)if(Di(e)==="A")if(e.preventDefault(),e.stopPropagation(),t=!0,this.userController.isLoggedIn())this.focusElement(document.querySelector(".dcg-header .dcg-account-link"),this.controller.s("graphing-calculator-narration-unable-to-activate-account-menu"));else{let i=document.querySelector(".dcg-sign-in");this.triggerKeyboardTapEvent(i)}else Di(e)==="L"?(e.preventDefault(),e.stopPropagation(),t=!0,this.focusElement(document.querySelector(".dcg-action-language"),this.controller.s("graphing-calculator-narration-unable-to-activate-language-menu"))):Di(e)==="H"?(e.preventDefault(),e.stopPropagation(),t=!0,this.focusElement(document.querySelector(".dcg-action-help"),this.controller.s("graphing-calculator-narration-unable-to-activate-help-menu"))):Di(e)==="S"&&(e.preventDefault(),e.stopPropagation(),t=!0,this.focusElement(document.querySelector(".dcg-action-share"),this.controller.s("graphing-calculator-narration-unable-to-activate-share-menu")));t||this.instanceHotkeys.handleKeydown(e)}handleEscape(e){let t=!1,i=this.headerController.getModalState().modal!=="none",n=this.headerController.getOpenMenu()!=="none",o=!!document.querySelector(".graph-preview"),s=this.mygraphsController.isMygraphsOpen(),a=!1;if(i)this.headerController.dispatch({type:"close-modal"}),a=!0;else if(n)this.headerController.dispatch({type:"toggle-menu",payload:"none"}),a=!0;else if(o){let l=document.querySelector(".dcg-action-close-resources");B2(l)&&this.triggerKeyboardTapEvent(l),a=!0}else s&&(this.headerController.dispatch({type:"close-mygraphs"}),a=!0);if(a){if(!_l)if(!o&&!(i&&s)){let l=this.controller.getSelectedItem();if(l)this.controller.dispatch({type:"move-focus-to-item",id:l.id});else{let c=this.controller.getItemModelByIndex(0);c&&this.controller.dispatch({type:"move-focus-to-item",id:c.id})}}else i&&s&&document.querySelector(".new-blank-graph").focus();e.preventDefault(),e.stopPropagation(),t=!0}return t}triggerKeyboardTapEvent(e){if(!e)return;let t=O.Event("dcg-tap");t.device="keyboard",O(e).trigger(t)}focusElement(e,t){e?this.triggerKeyboardTapEvent(e):t&&xe(t)}};Jh();var GV=class{constructor(e,t){this.Calc=e,this.tourManager=t,this.tourManager.closingMsg=(i,n)=>"<b>"+i+"</b><br>"+this.Calc.controller.s("graphing-tours-label-self-destruct",{seconds:n})}shouldPopupTour(e){if(this.Calc.controller.getItemCount()>3)return!0;var t=new $u[e].tour(this.Calc);return t.shouldPopup?t.shouldPopup():!1}startTour(e){if(!(!e||!$u[e])){var t=new $u[e].tour(this.Calc);this.tourManager.currentTour&&this.tourManager.stopTour(),this.tourManager.startTour(t)}}startTourFromUrl(){if(document.querySelectorAll(".dcg-expressionitem").length<2){setTimeout(this.startTourFromUrl.bind(this),100);return}var e=vu(location.search,"tour");e&&this.startTour(e)}setCalc(e){this.Calc=e}};ct();var IV=class extends Wr{constructor(t,i,n){super();this.recoveryAttempted=!1;this.isOpen=!1;this.graphsController=t,this.api=i,this.s=n,this.pageLoadTime=Date.now()}isMygraphsOpen(){return this.isOpen}hasAttemptedRecovery(){return this.recoveryAttempted}openMygraphs(t){this.recoveryAttempted=!1,this.isOpen=!0,O("body").addClass("resources-open"),Ei("user-action::open-my-graphs",{product:this.graphsController.product}),xe(this.s("account-shell-narration-mygraphs-open-graph")),pi(),t&&t.device==="keyboard"&&O(".dcg-action-newblankgraph").focus(),this.triggerEvent("onOpenMygraphs",void 0)}closeMygraphs(){this.isOpen=!1,O("body").removeClass("resources-open")}openBlankGraph(){this.closeMygraphs(),this.graphsController.clearGraphByUserAction(),this.triggerEvent("triggerRender",void 0)}onOpenGraph(t){t.example||(t.recovery?Ei("recovered-graph",{product:this.graphsController.product,timeSincePageload:Date.now()-this.pageLoadTime,payloadJSON:{action:"open"}}):Ei("user-action::open-saved",{product:this.graphsController.product,timeSincePageload:Date.now()-this.pageLoadTime}));var i=this.copyGraphWithTranslation(t);this.graphsController.loadGraph(i),this._concludeOpenGraph(i)}toast(t,i){this.triggerEvent("toast",{message:t,opts:i})}_concludeOpenGraph(t){var i=t.title||this.graphsController.getUntitledString(),n=this.s("account-shell-text-mygraphs-opened-graph",{graphTitle:i});this.toast(n,{undoCallback:()=>{this.graphsController.restorePreviousGraph()}}),this.closeMygraphs(),this.triggerEvent("triggerRender",void 0)}copyGraphWithTranslation(t){var i=t.copy();return t.i18nKey&&(i.title=this.s(t.i18nKey)),i}openGraphBehindCover(t){var i=this.copyGraphWithTranslation(t);return this.graphsController.loadGraph(i),new Promise(n=>{this.graphsController.product==="graphing"||this.graphsController.product==="graphing-3d"||this.graphsController.product==="geometry-calculator"?(this.api._calc.evaluator.notifyWhenSynced(function(){n()}),setTimeout(function(){n()},6e3)):this.graphsController.product==="geometry"&&n()}).then(()=>{this._concludeOpenGraph(i)})}getThumbnail(){return this.api.screenshot({width:200,height:200,targetPixelRatio:2})}};ct();zl();var VV=class{constructor(e){this.settings=e}ensureTripBlock(){var i;if(this.tripBlock)return;let e=document.createElement("div");e.classList.add("trip-block"),e.innerHTML='<div class="trip-interior"><a class="trip-close">&times;</a><div class="trip-content"></div></div><div class="trip-arrow"></div>';let t=this.tripBlock=e;t.style.top="-100px",(i=document.querySelector("body"))==null||i.append(t),O(t).find(".trip-close").on("dcg-tap",n=>{n.preventDefault(),this.stop()}),this.bindKeyEvents()}cleanup(){return this.unbindKeyEvents(),this.hideTripBlock(),!1}bindKeyEvents(){O(document).on({"keydown.Trip":e=>{this.keyEvent(e)}})}unbindKeyEvents(){O(document).off("keydown.Trip")}keyEvent(e){e.which===27&&this.stop()}stop(){this.hideTripBlock(),this.settings.onTripStop()}exitTourBecauseOfError(e,t){var i="",n=t;do i=n.selector+i;while(n=n.prevObject);this.stop(),Yo("TourError: could not find $sel.offset()",{metaData:{message:e,selector:i}})}showTripBlock(e,t){if(this.ensureTripBlock(),e.type==="do-not-update"||!e.sel)return;let i=e.sel;e.scrollContainer&&xa(i,e.scrollContainer,0);let n=this.tripBlock,o=n.querySelector(".trip-content");o&&(e.type==="final"?o.innerHTML=t||"":o.innerHTML=e.content),n.classList.toggle("trip-hidden",!!e.hidden);let s=i.offsetWidth||0,a=i.offsetHeight||0,l=n.offsetWidth||0,c=n.offsetHeight||0,u=10,p=10,g=O(window).width()||0,h=Ul(i);if(h)this.__cachedMissingSelTime=void 0;else{this.__cachedMissingSelTime?Date.now()-this.__cachedMissingSelTime>1e3&&(e.type==="final"?this.stop():this.exitTourBecauseOfError(e.content,O(i))):this.__cachedMissingSelTime=Date.now();return}n.classList.remove("trip-e","trip-s","trip-w","trip-n");let b=0;switch(e.position){case"e":n.classList.add("trip-e"),Gc(n,{left:`${h.left+s+p}px`,top:`${h.top-(c-a)/2}px`});break;case"s":n.classList.add("trip-s");let D=h.left+(s-l)/2;Gc(n,{left:`${D}px`,top:`${h.top+a+u}px`}),D+l>g-1&&(b=g-1-D-l),D<1&&(b=1-D);break;case"w":n.classList.add("trip-w"),Gc(n,{left:`${h.left-(p+l)}px`,top:`${h.top-(c-a)/2}px`});break;default:n.classList.add("trip-n"),Gc(n,{left:`${h.left+(s-l)/2}px`,top:`${h.top-u-c}px`});break}let C=n.querySelector(".trip-interior");C&&(C.style.transform="translate("+b+"px, 0)"),n.style.display="inline-block",n.querySelectorAll(".trip-math:not(.dcg-mq-math-mode)").forEach(D=>{$l.StaticMath(D)})}fadeInTripBlock(){this.ensureTripBlock();let e=this.tripBlock;setTimeout(function(){e.classList.add("trip-is-loaded")},0)}hideTripBlock(){this.tripBlock&&this.tripBlock.classList.remove("trip-is-loaded")}};var TV=class{constructor(){this.tripManager=new VV({onTripStop:this.stopTour.bind(this)}),this.currentStep=void 0,this.currentTour=void 0}_tripLoop(){clearTimeout(this.__tripLoopTimeout),this.running&&(this._advanceTrip(),this.__tripLoopTimeout=setTimeout(this._tripLoop.bind(this),200))}getContent(e){return e.type==="do-not-update"?"":e.type==="final"?e.endingMsg:e.content}_advanceTrip(){var e=this.currentTour.update(),t=new Date().getTime();if(e&&this.currentStep&&this.currentStep.type!=="do-not-update"&&e.type!=="do-not-update"&&this.getContent(e)!==this.getContent(this.currentStep)){if(this.currentStep.delayBeforeExit){if(this.throttleTimer&&t-this.throttleTimer<this.currentStep.delayBeforeExit)return;if(!this.throttleTimer){this.throttleTimer=t;return}}e.delayBeforeEnter&&(this.currentStep=e,this.throttleTimer=t)}if(!(e&&this.currentStep&&this.getContent(this.currentStep)===this.getContent(e)&&this.throttleTimer&&this.throttleTimer<this.currentStep.delayBeforeEnter)&&(this.throttleTimer=null,e&&e.type!=="do-not-update")){if(this.currentStep=e,e.type==="final"){this.finishTour(e,5);return}this.tripManager.showTripBlock(e)}}startTour(e){this.running||(this.currentTour=e,this.running=!0,this._tripLoop(),this.tripManager.fadeInTripBlock())}closingMsg(e,t){return"<b>"+e+"</b><br>This message will self-destruct in "+t+"..."}finishTour(e,t){if(clearTimeout(this.__tripLoopTimeout),this.running=!1,t<0){this.tripManager.stop();return}e.type==="final"?this.tripManager.showTripBlock(e,this.closingMsg(e.endingMsg,t)):this.tripManager.showTripBlock(e),setTimeout(()=>this.finishTour(e,t-1),1e3)}stopTour(){this.running=!1,this.currentStep=void 0,this.currentTour=void 0}};function gq(r){let e=JSON.parse(r.exampleGraphsRaw),t=r.api;t.hasUnsavedChanges=function(){return t._calc.controller.hasUnsavedChanges()};let i=new TV,n=new GV(t._calc,i);window.tourController=n,t._calc.controller.getGraphSettings().config.observe("language",()=>{i.closingMsg=(C,D)=>"<b>"+C+"</b><br>"+t._calc.controller.s("graphing-tours-label-self-destruct",{seconds:D})});let o=new Qv(t),s=new SV,a=o.s.bind(o),l=o.raw.bind(o),c=o.unpack.bind(o),u=new EV({api:t,s:a,getLanguage:o.getLanguage.bind(o),examplesJSON:e,randomSeed:r.seed,product:r.product}),p=new IV(u,t,a);u.observeEvent("onClearGraph",function(){t.focusFirstExpression()}),p.observeEvent("toast",function(C,D){if(!D)return;let S={message:D.message};for(let V in D.opts)D.opts.hasOwnProperty(V)&&(S[V]=D.opts[V]);t._calc.controller.dispatch({type:"toast/show",toast:S})}),u.observeEvent("toast",function(C,D){if(!D)return;let S={message:D.message};for(let V in D.opts)D.opts.hasOwnProperty(V)&&(S[V]=D.opts[V]);t._calc.controller.dispatch({type:"toast/show",toast:S})}),u.observeEvent("clearUnsavedChanges",function(){t._calc.controller.dispatch({type:"clear-unsaved-changes"})}),u.observeEvent("clearUndoRedo",function(){t._calc.controller.dispatch({type:"clear-undoredo-history"})});let g=!1;t._calc.controller.subToChanges(function(){let C=t._calc.controller.hasUnsavedChanges();C!==g&&b.triggerRender(),g=C});let h;t._calc.controller.triggerEasterEgg=function(C){let D=C==="betchacant"?t._calc.controller.s("account-shell-label-betchacant-loading"):t._calc.controller.s("account-shell-label-loading"),S=u.getEasterEggGraphs(C);S.length!==0&&(h=Math.floor(Math.random()*S.length),t._calc.controller.dispatch({type:"toast/show",toast:{message:D,hideAfter:0,toastStyle:"cover"}}),u.loadGraphImmediately(S[h]).then(function(){p.openGraphBehindCover(S[h])}))},Ai("expressions")!==!1&&(t._calc.controller.triggerClearGraph=function(){u.clearGraphByUserAction()},t.observeEvent("openDrawer",function(){b.dispatch({type:"open-mygraphs"})}));let b=new kV({userController:s,graphsController:u,tourController:n,languageController:o,mygraphsController:p,api:t,s:a,raw:l,unpack:c,getLanguage:o.getLanguage.bind(o),product:r.product});return t._calc.globalHotkeys=new Zv(t._calc.controller,b,t._calc.instanceHotkeys),t._calc.controller.setCanShowKeyboardShortcuts(!0),t.observeEvent("showHotkeysModal",function(){b.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"})}),window.userController=s,window.headerController=b,{userController:s,graphsController:u,tourController:n,headerController:b}}ct();var uh=O("body").data("load-data");var wq=__dcg_shared_module_exports__['h'](fq());Ai("testing")||rB(wq.default);function yq(r){let e=zC();e.disableScrollFix||FU(),e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{border:!1,disableScrollFix:!0,showHamburger:!0,pasteGraphLink:!0,onlyTraceSelected:!1});let t=document.getElementById("graph-container"),i=new Qa(t,e),n=gq({api:i,seed:uh.seed,exampleGraphsRaw:OP,product:"graphing"}),o=i._calc.controller;o.setBugsnagContext("main-controller"),i.updateSettings({language:r});let s=n.userController,a=n.graphsController,l=n.tourController,c=n.headerController,u=o.s.bind(o);iB(function(C){let D=o.stateStack;D&&D.serializeForBugsnag&&(C.metaData.states=D.serializeForBugsnag())});let p=new uv({calcController:o,graphsController:a});p.trackFeatureUsage("graph-feature","hasSlider"),p.trackFeatureUsage("graph-feature","hasRegression"),p.trackFeatureUsage("graph-feature","hasAction"),p.trackFeatureUsage("graph-feature","expressionErrors"),p.trackFeatureUsage("graph-feature","expressionCount"),p.trackFeatureUsage("graph-feature","folderCount"),p.trackFeatureUsage("graph-feature","imageCount"),p.trackFeatureUsage("graph-feature","tableCount"),p.trackFeatureUsage("graph-feature","textCount"),p.start(),j8(s,u),Ai("no_navigation_warning")||O(window).on("beforeunload",function(){if(i.hasUnsavedChanges())return u("account-shell-text-confirm-leave")}),uh.user&&s.completeLogin(uh.user),uh.graph||(a.clearGraph(),uh.latex&&i.setExpression({latex:uh.latex})),X8({userId:s.getUserId(),desmosLang:r}),l.startTourFromUrl(),s.getEmailChangeToken()&&c.dispatch({type:"show-modal",modal:"change-email",device:"mouse"}),c.triggerRender=function(){g.update(),h.update(),b.update(),s.getEmailChangeToken()&&c.getOpenModal()!=="change-email"&&history.replaceState(null,"",document.location.pathname)};let g=qy.mountToNode(mI,document.getElementById("dcg-header-container"),{controller:function(){return c}}),h=qy.mountToNode(lV,document.getElementById("dcg-modal-container"),{controller:function(){return c}}),b=qy.mountToNode(CV,document.getElementById("mygraphs-container"),{controller:qy.const(c),makeAPI:function(C){return new Qa(C,{settingsMenu:!1,keypad:!1,zoomButtons:!1,branding:!1,border:!1,disableScrollFix:!0,expressions:!1,hideGeoUI:!0})}});return up&&!IP&&!VP&&c.dispatch({type:"show-modal",modal:"unsupported-browser",device:"touch"}),document.location.search.match(/(\?|\&)create_account/)?(history.replaceState(null,"",document.location.pathname),s.isLoggedIn()?o.dispatch({type:"toast/show",toast:{message:u("account-shell-text-logged-in")}}):c.dispatch({type:"show-modal",modal:"signup",device:"mouse"})):document.location.search.match(/(\?|\&)login/)?(history.replaceState(null,"",document.location.pathname),s.isLoggedIn()?o.dispatch({type:"toast/show",toast:{message:u("account-shell-text-logged-in")}}):c.dispatch({type:"show-modal",modal:"login",device:"mouse"})):document.location.search.match(/(\?|\&)reset_password/)&&(history.replaceState(null,"",document.location.pathname),c.dispatch({type:"show-modal",modal:"recover-password",device:"mouse"})),window.matchMedia&&window.matchMedia("print").addListener(function(D){D.matches?o.dispatch({type:"enter-printmode"}):o.dispatch({type:"exit-printmode"})}),rv(document),aq(uh.graph,pn).then(function(C){return C&&C.state&&(C.state.graph.product==="geometry-calculator"?window.location.replace(document.location.href.split("/calculator/").join("/geometry-beta/")):a.loadGraph(Oo.fromAjax(C))),i})}var bq=bb(),xq=ym(bq).then(function(){return yq(bq)},function(){return yq("en")});ct();typeof Desmos=="undefined"&&(Desmos={});function vq(){Desmos.$=O,Desmos.$.noConflict(!0)}mp(document.body);vq();xq.then(function(r){O(".dcg-loading-div-container").hide(),window.Calc=r,RO()});
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 *
 *  Modifications by Desmos:
 *  - wrapped in AMD pattern
 *  - added ctx.ellipse() method
 *  - fixed image opacity bug
 *  - added ability to add classNames to exported svg elements
 *  - added ability to add named groups
 *  - removed dominant-basline attribute. Editors appear to ignore it. Must solve baseline issues using transformations
 */
/**
 * Minimal Event interface implementation
 *
 * Original implementation by Sven Fuchs: https://gist.github.com/995028
 * Modifications and tests by Christian Johansen.
 *
 * @author Sven Fuchs (svenfuchs@artweb-design.de)
 * @author Christian Johansen (christian@cjohansen.no)
 * @license BSD
 *
 * Copyright (c) 2011 Sven Fuchs, Christian Johansen
 */
})()

dcg.isEqual = dcgSharedModule.G;
dcg.clamp = dcgSharedModule.ma;
dcg.commitFunction = dcgSharedModule.C;

dcg.$ = Desmos.$;
dcg.View = Desmos.Private.Fragile.DCGView;
dcg.MathTools = Desmos.Private.Mathtools;
dcg.GraphTools = Desmos.Private.Graphtools;

dcg.GraphMode = {
    CURVE_X_BASED: 1,
    CURVE_Y_BASED: 2,
    POINT: 3,
    POINT_DRAGGABLE: 4,
    CURVE_PARAMETRIC: 5,
    CURVE_POLAR: 6,
    POLYGON_INTERIOR: 7,
    CURVE_IMPLICIT: 8,
    ERROR: 15,
    SEGMENT: 17,
    LINE: 18,
    RAY: 19,
    CIRCLE: 20,
    ARC: 21,
    ANGLE_LABEL: 22,
    ANGLE: 23,
    VECTOR: 24,
    CURVE_3D_PARAMETRIC: 100,
    UNKNOWN_101: 101,
    UNKNOWN_102: 102,
    SURFACE_PARAMETRIC: 103,
    SURFACE_Z_BASED: 106,
    SURFACE_X_BASED: 107,
    SURFACE_Y_BASED: 108,
    SURFACE_IMPLICIT: 112,
    POINT_3D: 113,
    UNKNOWN_114: 114,
    UNKNOWN_115: 115,
    TRIANGLE_3D: 116,
    SPHERE: 117,
    SEGMENT_3D: 118,
    UNKNOWN_119: 119,
    UNKNOWN_120: 120,
    UNKNOWN_121: 121,
    UNKNOWN_122: 122,
    UNKNOWN_123: 123,
    UNKNOWN_124: 124,
    UNKNOWN_125: 125,
    CURVE_3D_XY_GRAPH: 126,
};